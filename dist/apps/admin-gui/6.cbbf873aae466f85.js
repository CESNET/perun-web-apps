"use strict";(self.webpackChunkadmin_gui=self.webpackChunkadmin_gui||[]).push([[6],{62023:(ie,W,o)=>{o.d(W,{G:()=>E});var r=o(65879);let E=(()=>{class n{constructor(){this.entityDetailChange=new r.vpe}reloadEntityDetail(){this.entityDetailChange.emit()}static#e=this.\u0275fac=function(s){return new(s||n)};static#t=this.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})()},34535:(ie,W,o)=>{o.d(W,{y:()=>X});var r=o(87824),E=o(38106),n=o(73615),S=o(80874),b=o(56223),s=o(78337),t=o(65879),e=o(44112),M=o(96814),K=o(23680),a=o(64170),B=o(98525),F=o(55959),C=o(62481),y=o(61917),w=o(2730),Q=o(69755),I=o(71365),V=o(47777);function Z(H,ae){if(1&H&&(t.TgZ(0,"mat-option",10),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&H){const R=ae.$implicit;t.Q6J("value",R),t.xp6(1),t.hij(" ",t.lcZ(2,2,"CONSENTS.STATUS_"+R)," ")}}function j(H,ae){if(1&H){const R=t.EpF();t.TgZ(0,"mat-form-field",7)(1,"mat-label"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"mat-select",8),t.NdJ("closed",function(){t.CHM(R);const p=t.oxw();return t.KtG(p.changeConsentStatuses())}),t.TgZ(5,"mat-select-trigger"),t._uU(6),t.ALo(7,"selectedConsentStatuses"),t.qZA(),t.YNc(8,Z,3,4,"mat-option",9),t.qZA()()}if(2&H){const R=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,4,"RESOURCE_DETAIL.ASSIGNED_MEMBERS.FILTER_CONSENT_STATUS")),t.xp6(2),t.Q6J("formControl",R.consentStatuses),t.xp6(2),t.hij(" ",t.Dn7(7,6,R.selectedConsentStatuses,R.consentStatusList,R.consentStatuses.value)," "),t.xp6(2),t.Q6J("ngForOf",R.consentStatusList)}}function L(H,ae){1&H&&t._UZ(0,"perun-web-apps-loading-table")}function Y(H,ae){if(1&H){const R=t.EpF();t.TgZ(0,"perun-web-apps-members-list",11),t.NdJ("updateTable",function(){t.CHM(R);const p=t.oxw();return t.KtG(p.refreshTable())}),t.qZA()}if(2&H){const R=t.oxw();t.Q6J("displayedColumns",R.columns)("disableRouting",!R.routeAuth)("filter",R.filterValue)("members",R.members)("tableId",R.tableId)}}let X=(()=>{class H{constructor(R,x,p,G,m,N,U){this.route=R,this.resourceService=x,this.authResolver=p,this.entityStorageService=G,this.storeService=m,this.consentService=N,this.consentStatusPipe=U,this.loading=!1,this.filterValue="",this.tableId=E.iQ,this.members=[],this.columns=["id","fullName"],this.includeConsents=!1,this.consents=[],this.consentStatuses=new b.NI,this.consentStatusList=["UNSIGNED","GRANTED","REVOKED"],this.selectedConsentStatuses=[],this.selection=new s.Ov(!0,[])}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.resourceService.getAssignedRichMembers(this.resource.id).subscribe(R=>{this.setAuthRights(R),this.consentService.getConsentHubByResource(this.resource.id).subscribe(x=>{this.includeConsents=this.storeService.getProperty("enforce_consents")&&x.enforceConsents,this.includeConsents?(this.columns=["id","fullName","consentStatus"],this.consentService.getConsentsForConsentHubByResource(this.resource.id).subscribe(p=>{this.consents=p,this.members=this.getConsentsForMembers(R).filter(G=>!this.selectedConsentStatuses||0===this.selectedConsentStatuses.length||this.selectedConsentStatuses.includes(G.consent))})):this.members=R,this.loading=!1})})}setAuthRights(R){0!==R.length&&(this.routeAuth=this.authResolver.isAuthorized("getMemberById_int_policy",[R[0]]))}applyFilter(R){this.filterValue=R}getConsentsForMembers(R){const x=[];return R.forEach(p=>{const G=p;G.consent=this.consentStatusPipe.transform(p.userId,this.consents),x.push(G)}),x}changeConsentStatuses(){this.selection.clear(),this.selectedConsentStatuses=this.consentStatuses.value,this.refreshTable()}static#e=this.\u0275fac=function(x){return new(x||H)(t.Y36(e.gz),t.Y36(r.xk),t.Y36(n.x4),t.Y36(n.fb),t.Y36(n.d6),t.Y36(r.WY),t.Y36(S.m2))};static#t=this.\u0275cmp=t.Xpm({type:H,selectors:[["app-resource-assigned-members"]],features:[t._Bn([S.m2,S.Qh])],decls:10,vars:7,consts:[[1,"page-subtitle"],[3,"refresh"],["class","me-2 fix-select",4,"ngIf"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative"],[3,"displayedColumns","disableRouting","filter","members","tableId","updateTable",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[1,"me-2","fix-select"],["multiple","",3,"formControl","closed"],["class","resource-theme",3,"value",4,"ngFor","ngForOf"],[1,"resource-theme",3,"value"],[3,"displayedColumns","disableRouting","filter","members","tableId","updateTable"]],template:function(x,p){if(1&x&&(t.TgZ(0,"h1",0),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.TgZ(3,"perun-web-apps-refresh-button",1),t.NdJ("refresh",function(){return p.refreshTable()}),t.qZA(),t.YNc(4,j,9,10,"mat-form-field",2),t.TgZ(5,"perun-web-apps-debounce-filter",3),t.NdJ("filter",function(m){return p.applyFilter(m)}),t.qZA(),t.YNc(6,L,1,0,"ng-template",null,4,t.W1O),t.TgZ(8,"div",5),t.YNc(9,Y,1,5,"perun-web-apps-members-list",6),t.qZA()),2&x){const G=t.MAs(7);t.xp6(1),t.Oqu(t.lcZ(2,5,"RESOURCE_DETAIL.ASSIGNED_MEMBERS.TITLE")),t.xp6(3),t.Q6J("ngIf",p.includeConsents),t.xp6(1),t.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_MEMBERS.FILTER"),t.xp6(4),t.Q6J("perunWebAppsLoader",p.loading)("perunWebAppsLoaderIndicator",G)}},dependencies:[M.sg,M.O5,K.ey,a.KE,a.hX,b.JJ,b.oH,B.gD,B.$L,F.K,C.t,y.O,w.P,Q.e,I.X$,V.Q]})}return H})()},90068:(ie,W,o)=>{o.d(W,{D:()=>_e});var r=o(87824),E=o(38106),n=o(78337),S=o(64124),b=o(17700),s=o(73615),t=o(65879),e=o(71365),M=o(96814),K=o(32296),a=o(74104),B=o(12207),F=o(2730),C=o(52839),y=o(69755),w=o(49496);function Q(f,q){1&f&&t._UZ(0,"perun-web-apps-loading-dialog")}const I=function(){return["id","name","enabled","description"]};function V(f,q){if(1&f&&t._UZ(0,"app-services-list",15),2&f){const l=t.oxw(2);t.Q6J("disableRouting",!0)("services",l.filteredServices)("displayedColumns",t.DdM(5,I))("selection",l.selection)("tableId",l.tableId)}}const Z=function(){return["select","id","name","enabled","description"]};function j(f,q){if(1&f){const l=t.EpF();t.TgZ(0,"div")(1,"h1",2),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",3)(5,"mat-tab-group",4),t.NdJ("selectedTabChange",function(){t.CHM(l);const g=t.oxw();return t.KtG(g.tabChanged())}),t.TgZ(6,"mat-tab",5),t.ALo(7,"translate"),t.TgZ(8,"div",6)(9,"perun-web-apps-debounce-filter",7),t.NdJ("filter",function(g){t.CHM(l);const A=t.oxw();return t.KtG(A.applyFilter(g))}),t.ALo(10,"translate"),t.qZA()(),t._UZ(11,"app-services-list",8),t.qZA(),t.TgZ(12,"mat-tab",5),t.ALo(13,"translate"),t.TgZ(14,"div",9)(15,"perun-web-apps-service-package-search-select",10),t.NdJ("packageSelected",function(g){t.CHM(l);const A=t.oxw();return t.KtG(A.servicePackageSelected(g))}),t.qZA()(),t.YNc(16,V,1,6,"app-services-list",11),t.qZA()()(),t.TgZ(17,"div",12)(18,"button",13),t.NdJ("click",function(){t.CHM(l);const g=t.oxw();return t.KtG(g.onCancel())}),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.TgZ(21,"button",14),t.NdJ("click",function(){t.CHM(l);const g=t.oxw();return t.KtG(g.onAdd())}),t._uU(22),t.ALo(23,"translate"),t.qZA()()()}if(2&f){const l=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,18,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.TITLE")),t.xp6(4),t.s9C("label",t.lcZ(7,20,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SELECT_SERVICE")),t.Q6J("disabled",l.loading),t.xp6(3),t.s9C("placeholder",t.lcZ(10,22,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.FILTER_DESCRIPTION")),t.xp6(2),t.Q6J("services",l.unAssignedServices)("disableRouting",!0)("displayedColumns",t.DdM(30,Z))("filterValue",l.filterValue)("selection",l.selection)("tableId",l.tableId),t.xp6(1),t.s9C("label",t.lcZ(13,24,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SELECT_PACKAGE")),t.Q6J("disabled",l.loading),t.xp6(3),t.Q6J("selectedPackage",l.selectedPackage)("servicePackages",l.servicePackages),t.xp6(1),t.Q6J("ngIf",-1!==l.selectedPackage.id),t.xp6(3),t.hij(" ",t.lcZ(20,26,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.CANCEL_BUTTON")," "),t.xp6(2),t.Q6J("disabled",0===l.selection.selected.length&&-1===l.selectedPackage.id||l.loading),t.xp6(1),t.hij(" ",t.lcZ(23,28,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE."+(-1===l.selectedPackage.id?"ADD_SERVICES":"ADD_PACKAGE"))," ")}}let L=(()=>{class f{constructor(l,u,g,A,D,J){this.dialogRef=l,this.data=u,this.notificator=g,this.translate=A,this.resourceManager=D,this.servicesManager=J,this.loading=!1,this.unAssignedServices=[],this.filteredServices=[],this.servicePackages=[],this.selectedPackage={name:"Not selected",description:"",id:-1,beanName:"ServicePackage"},this.selection=new n.Ov(!0,[]),this.tableId=E.DR,this.filterValue=""}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resourceManager.getAssignedServicesToResource(this.data.resourceId).subscribe(l=>{this.servicesManager.getServices().subscribe(u=>{this.servicesManager.getServicesPackages().subscribe(g=>{this.servicePackages.push(this.selectedPackage),this.servicePackages=this.servicePackages.concat(g),this.unAssignedServices=u;for(const A of l)for(const D of u)A.id===D.id&&this.unAssignedServices.splice(this.unAssignedServices.indexOf(D),1);this.loading=!1})})})}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0,-1!==this.selectedPackage.id?this.addServicePackage():this.addServices()}applyFilter(l){this.filterValue=l}servicePackageSelected(l){this.selectedPackage=l,-1!==l.id?this.servicesManager.getServicesFromServicesPackage(l.id).subscribe(u=>{this.filteredServices=u}):this.filteredServices=[]}tabChanged(){this.selection.clear(),this.filterValue="",this.selectedPackage=this.servicePackages[0]}addServicePackage(){this.resourceManager.assignServicesPackage(this.data.resourceId,this.selectedPackage.id).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.PACKAGE_SUCCESS_MESSAGE").subscribe(l=>{this.notificator.showSuccess(l),0!==this.selection.selected.length?this.addServices():this.dialogRef.close(!0)})},()=>this.loading=!1)}addServices(){const l=[];for(const u of this.selection.selected)l.push(u.id);this.resourceManager.assignServices(this.data.resourceId,l).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SERVICE_SUCCESS_MESSAGE").subscribe(u=>{this.notificator.showSuccess(u),this.dialogRef.close(!0)})},()=>this.loading=!1)}static#e=this.\u0275fac=function(u){return new(u||f)(t.Y36(b.so),t.Y36(b.WI),t.Y36(s.V6),t.Y36(e.sK),t.Y36(r.xk),t.Y36(r.KK))};static#t=this.\u0275cmp=t.Xpm({type:f,selectors:[["app-perun-web-apps-assign-service-to-resource-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],["mat-stretch-tabs","false",3,"selectedTabChange"],[3,"disabled","label"],[1,"mt-2"],[3,"placeholder","filter"],[3,"services","disableRouting","displayedColumns","filterValue","selection","tableId"],[1,"mt-3"],[3,"selectedPackage","servicePackages","packageSelected"],[3,"disableRouting","services","displayedColumns","selection","tableId",4,"ngIf"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"disabled","click"],[3,"disableRouting","services","displayedColumns","selection","tableId"]],template:function(u,g){if(1&u&&(t.YNc(0,Q,1,0,"ng-template",null,0,t.W1O),t.TgZ(2,"div"),t.YNc(3,j,24,31,"div",1),t.qZA()),2&u){const A=t.MAs(1);t.xp6(2),t.Gre("",g.theme," position-relative"),t.xp6(1),t.Q6J("perunWebAppsLoader",g.loading)("perunWebAppsLoaderIndicator",A)}},dependencies:[M.O5,K.lW,a.uX,a.SP,b.uh,b.xY,b.H8,B.b,F.P,C.F,y.e,w.Q,e.X$]})}return f})();var Y=o(25313);function X(f,q){1&f&&t._UZ(0,"perun-web-apps-loading-dialog")}function H(f,q){1&f&&t._UZ(0,"th",14)}function ae(f,q){if(1&f&&(t.TgZ(0,"td",15),t._uU(1),t.qZA()),2&f){const l=q.$implicit;t.xp6(1),t.Oqu(l.name)}}function R(f,q){1&f&&t._UZ(0,"tr",16)}function x(f,q){1&f&&t._UZ(0,"tr",17)}function p(f,q){if(1&f){const l=t.EpF();t.TgZ(0,"div")(1,"h1",2),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",3)(5,"p"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"div",4),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"table",5),t.ynx(12,6),t.YNc(13,H,1,0,"th",7),t.YNc(14,ae,2,1,"td",8),t.BQk(),t.YNc(15,R,1,0,"tr",9),t.YNc(16,x,1,0,"tr",10),t.qZA()(),t.TgZ(17,"div",11)(18,"button",12),t.NdJ("click",function(){t.CHM(l);const g=t.oxw();return t.KtG(g.onCancel())}),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.TgZ(21,"button",13),t.NdJ("click",function(){t.CHM(l);const g=t.oxw();return t.KtG(g.onSubmit())}),t._uU(22),t.ALo(23,"translate"),t.qZA()()()}if(2&f){const l=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,9,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.TITLE")),t.xp6(4),t.hij(" ",t.lcZ(7,11,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DESCRIPTION")," "),t.xp6(3),t.hij(" ",t.lcZ(10,13,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.ASK")," "),t.xp6(2),t.Q6J("dataSource",l.dataSource),t.xp6(4),t.Q6J("matHeaderRowDef",l.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",l.displayedColumns),t.xp6(3),t.hij(" ",t.lcZ(20,15,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.CANCEL")," "),t.xp6(2),t.Q6J("disabled",l.loading),t.xp6(1),t.hij(" ",t.lcZ(23,17,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DELETE")," ")}}let G=(()=>{class f{constructor(l,u,g,A,D){this.dialogRef=l,this.data=u,this.notificator=g,this.translate=A,this.resourcesManager=D,this.displayedColumns=["name"]}ngOnInit(){this.theme=this.data.theme,this.dataSource=new Y.by(this.data.services)}onSubmit(){this.loading=!0;const l=[];for(const u of this.data.services)l.push(u.id);this.resourcesManager.removeServices(this.data.resourceId,l).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.SUCCESS").subscribe(u=>{this.notificator.showSuccess(u),this.dialogRef.close(!0)})},()=>this.loading=!1)}onCancel(){this.dialogRef.close()}static#e=this.\u0275fac=function(u){return new(u||f)(t.Y36(b.so),t.Y36(b.WI),t.Y36(s.V6),t.Y36(e.sK),t.Y36(r.xk))};static#t=this.\u0275cmp=t.Xpm({type:f,selectors:[["app-perun-web-apps-remove-service-from-resource-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"disabled","click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(u,g){if(1&u&&(t.YNc(0,X,1,0,"ng-template",null,0,t.W1O),t.TgZ(2,"div"),t.YNc(3,p,24,19,"div",1),t.qZA()),2&u){const A=t.MAs(1);t.xp6(2),t.Gre("",g.theme," position-relative"),t.xp6(1),t.Q6J("perunWebAppsLoader",g.loading)("perunWebAppsLoaderIndicator",A)}},dependencies:[K.lW,Y.BZ,Y.fO,Y.as,Y.w1,Y.Dz,Y.nj,Y.ge,Y.ev,Y.XQ,Y.Gk,b.uh,b.xY,b.H8,B.b,y.e,e.X$]})}return f})();var m=o(44112),N=o(55959),U=o(62481);function ee(f,q){if(1&f){const l=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(l);const g=t.oxw();return t.KtG(g.addService())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&f&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_SERVICES.ADD_SERVICE"),"\n"))}function oe(f,q){if(1&f){const l=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(l);const g=t.oxw();return t.KtG(g.removeServices())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&f){const l=t.oxw();t.Q6J("disabled",0===l.selected.selected.length),t.xp6(1),t.hij(" ",t.lcZ(2,2,"RESOURCE_DETAIL.ASSIGNED_SERVICES.REMOVE_SERVICE"),"\n")}}function le(f,q){1&f&&t._UZ(0,"perun-web-apps-loading-table")}function ce(f,q){if(1&f&&t._UZ(0,"app-services-list",10),2&f){const l=t.oxw();t.Q6J("disableRouting",!l.serviceRoutingAuth)("selection",l.selected)("displayedColumns",l.displayedColumns)("filterValue",l.filterValue)("services",l.assignedServices)("tableId",l.tableId)}}let _e=(()=>{class f{constructor(l,u,g,A,D){this.route=l,this.resourcesManager=u,this.dialog=g,this.guiAuthResolver=A,this.entityStorageService=D,this.assignedServices=[],this.selected=new n.Ov(!0,[]),this.tableId=E.uC,this.filterValue="",this.displayedColumns=["select","id","name","enabled","script","description"]}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.getDataForAuthorization(),this.loadAllServices()}loadAllServices(){this.loading=!0,this.resourcesManager.getAssignedServicesToResource(this.resource.id).subscribe(l=>{this.assignedServices=l,this.selected.clear(),this.loading=!1})}addService(){const l=(0,S.kZ)();l.width="800px",l.data={theme:"resource-theme",resourceId:this.resource.id},this.dialog.open(L,l).afterClosed().subscribe(g=>{g&&this.loadAllServices()})}removeServices(){const l=(0,S.kZ)();l.width="500px",l.data={theme:"resource-theme",resourceId:this.resource.id,services:this.selected.selected},this.dialog.open(G,l).afterClosed().subscribe(g=>{g&&this.loadAllServices()})}applyFilter(l){this.filterValue=l}getDataForAuthorization(){this.assignServiceAuth=this.guiAuthResolver.isAuthorized("assignServices_Resource_List<Service>_policy",[this.resource]),this.removeServiceAuth=this.guiAuthResolver.isAuthorized("removeServices_Resource_List<Service>_policy",[this.resource]),this.displayedColumns=this.removeServiceAuth?["select","id","name","enabled","script","description"]:["id","name","enabled","script","description"],this.serviceRoutingAuth=this.guiAuthResolver.isPerunAdminOrObserver()}static#e=this.\u0275fac=function(u){return new(u||f)(t.Y36(m.gz),t.Y36(r.xk),t.Y36(b.uw),t.Y36(s.x4),t.Y36(s.fb))};static#t=this.\u0275cmp=t.Xpm({type:f,selectors:[["app-perun-web-apps-resource-assigned-services"]],decls:11,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["class","action-button me-2","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","me-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative"],[3,"disableRouting","selection","displayedColumns","filterValue","services","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"action-button","me-2",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"disableRouting","selection","displayedColumns","filterValue","services","tableId"]],template:function(u,g){if(1&u&&(t.TgZ(0,"h1",0),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.TgZ(3,"perun-web-apps-refresh-button",1),t.NdJ("refresh",function(){return g.loadAllServices()}),t.qZA(),t.YNc(4,ee,3,3,"button",2),t.YNc(5,oe,3,4,"button",3),t.TgZ(6,"perun-web-apps-debounce-filter",4),t.NdJ("filter",function(D){return g.applyFilter(D)}),t.qZA(),t.YNc(7,le,1,0,"ng-template",null,5,t.W1O),t.TgZ(9,"div",6),t.YNc(10,ce,1,6,"app-services-list",7),t.qZA()),2&u){const A=t.MAs(8);t.xp6(1),t.Oqu(t.lcZ(2,6,"RESOURCE_DETAIL.ASSIGNED_SERVICES.TITLE")),t.xp6(3),t.Q6J("ngIf",g.assignServiceAuth),t.xp6(1),t.Q6J("ngIf",g.removeServiceAuth),t.xp6(1),t.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_SERVICES.FILTER_SERVICES"),t.xp6(4),t.Q6J("perunWebAppsLoader",g.loading)("perunWebAppsLoaderIndicator",A)}},dependencies:[M.O5,K.lW,w.Q,N.K,U.t,F.P,y.e,e.X$]})}return f})()},11800:(ie,W,o)=>{o.d(W,{X:()=>Q});var r=o(73615),E=o(87824),n=o(65879),S=o(96814),b=o(74104),s=o(95845),t=o(5786),e=o(71365);function M(I,V){1&I&&(n._uU(0),n.ALo(1,"translate")),2&I&&n.hij(" ",n.lcZ(1,1,"RESOURCE_DETAIL.ENTITY")," ")}function K(I,V){if(1&I&&n._UZ(0,"app-one-entity-attribute-page",5),2&I){const Z=n.oxw();n.Q6J("entityId",Z.resource.id)("entity","resource")}}function a(I,V){1&I&&(n._uU(0),n.ALo(1,"translate"),n.ALo(2,"translate")),2&I&&n.AsE(" ",n.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",n.lcZ(2,4,"MEMBER_DETAIL.ENTITY")," ")}function B(I,V){if(1&I&&n._UZ(0,"app-two-entity-attribute-page",6),2&I){const Z=n.oxw(2);n.Q6J("firstEntity","resource")("firstEntityId",Z.resource.id)("secondEntity","member")}}function F(I,V){1&I&&(n.TgZ(0,"mat-tab"),n.YNc(1,a,3,6,"ng-template",2),n.YNc(2,B,1,3,"ng-template",3),n.qZA())}function C(I,V){1&I&&(n._uU(0),n.ALo(1,"translate"),n.ALo(2,"translate")),2&I&&n.AsE(" ",n.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",n.lcZ(2,4,"GROUP_DETAIL.ENTITY")," ")}function y(I,V){if(1&I&&n._UZ(0,"app-two-entity-attribute-page",6),2&I){const Z=n.oxw(2);n.Q6J("firstEntity","resource")("firstEntityId",Z.resource.id)("secondEntity","group")}}function w(I,V){1&I&&(n.TgZ(0,"mat-tab"),n.YNc(1,C,3,6,"ng-template",2),n.YNc(2,y,1,3,"ng-template",3),n.qZA())}let Q=(()=>{class I{constructor(Z,j,L){this.authResolver=Z,this.resourceManager=j,this.entityStorageService=L}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.resourceGroupAttAuth=this.authResolver.isAuthorized("getGroupAssignments_Resource_policy",[this.resource]),this.resourceMemberAttAuth=this.authResolver.isAuthorized("getAssignedMembersWithStatus_Resource_policy",[this.resource])}static#e=this.\u0275fac=function(j){return new(j||I)(n.Y36(r.x4),n.Y36(E.xk),n.Y36(r.fb))};static#t=this.\u0275cmp=n.Xpm({type:I,selectors:[["app-resource-attributes"]],hostVars:2,hostBindings:function(j,L){2&j&&n.ekj("router-component",L.true)},decls:10,vars:5,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(j,L){1&j&&(n.TgZ(0,"div")(1,"h1",0),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"mat-tab-group",1)(5,"mat-tab"),n.YNc(6,M,2,3,"ng-template",2),n.YNc(7,K,1,2,"ng-template",3),n.qZA(),n.YNc(8,F,3,0,"mat-tab",4),n.YNc(9,w,3,0,"mat-tab",4),n.qZA()()),2&j&&(n.xp6(2),n.Oqu(n.lcZ(3,3,"RESOURCE_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),n.xp6(6),n.Q6J("ngIf",L.resourceMemberAttAuth),n.xp6(1),n.Q6J("ngIf",L.resourceGroupAttAuth))},dependencies:[S.O5,b.Vc,b.uD,b.uX,b.SP,s.Y,t.t,e.X$]})}return I})()},61618:(ie,W,o)=>{o.d(W,{b:()=>_e});var r=o(53117),E=o(67582),n=o(87824),S=o(64124),b=o(73615),s=o(80874),t=o(37073),e=o(25387),M=o(56684),K=o(59773),a=o(65879),B=o(44112),F=o(39743),C=o(17700),y=o(62023),w=o(96814),Q=o(30617),I=o(32296),V=o(55940),Z=o(92596),j=o(11712),L=o(41419),Y=o(92738),X=o(52269),H=o(71365);function ae(f,q){1&f&&a._UZ(0,"mat-spinner",3)}function R(f,q){if(1&f){const l=a.EpF();a.TgZ(0,"button",14),a.NdJ("click",function(){a.CHM(l);const g=a.oxw(2);return a.KtG(g.editResource())}),a.ALo(1,"translate"),a.TgZ(2,"mat-icon"),a._uU(3,"edit"),a.qZA()()}2&f&&a.s9C("matTooltip",a.lcZ(1,1,"RESOURCE_DETAIL.EDIT"))}function x(f,q){if(1&f){const l=a.EpF();a.TgZ(0,"button",15),a.NdJ("click",function(){a.CHM(l);const g=a.oxw(2);return a.KtG(g.deleteResource())}),a.ALo(1,"translate"),a.TgZ(2,"mat-icon"),a._uU(3,"delete_forever"),a.qZA()()}2&f&&a.s9C("matTooltip",a.lcZ(1,1,"RESOURCE_DETAIL.DELETE"))}const p=function(f){return["/organizations",f]};function G(f,q){if(1&f&&(a.TgZ(0,"a",8),a.NdJ("auxclick",function(u){return u.preventDefault()}),a._uU(1),a.qZA()),2&f){const l=a.oxw(2);a.Q6J("perunWebAppsMiddleClickRouterLink",a.VKq(4,p,l.resource.vo.id.toString()))("routerLink",a.VKq(6,p,l.resource.vo.id)),a.uIk("data-cy",l.resource.vo.name),a.xp6(1),a.Oqu(l.resource.vo.name)}}function m(f,q){if(1&f&&(a.TgZ(0,"span"),a._uU(1),a.qZA()),2&f){const l=a.oxw(2);a.xp6(1),a.hij(" ",l.resource.vo.name," ")}}const N=function(f){return["/facilities",f]};function U(f,q){if(1&f&&(a.TgZ(0,"a",8),a.NdJ("auxclick",function(u){return u.preventDefault()}),a._uU(1),a.qZA()),2&f){const l=a.oxw(2);a.Q6J("perunWebAppsMiddleClickRouterLink",a.VKq(4,N,l.resource.facilityId.toString()))("routerLink",a.VKq(6,N,l.resource.facilityId)),a.uIk("data-cy",l.resource.facility.name),a.xp6(1),a.Oqu(l.resource.facility.name)}}function ee(f,q){if(1&f&&(a.TgZ(0,"span"),a._uU(1),a.qZA()),2&f){const l=a.oxw(2);a.xp6(1),a.hij(" ",l.resource.facility.name," ")}}const oe=function(){return{color:"black"}},le=function(f){return[f]};function ce(f,q){if(1&f&&(a.TgZ(0,"div")(1,"div",4),a._UZ(2,"mat-icon",5),a.ALo(3,"translate"),a.TgZ(4,"div",6)(5,"div",7)(6,"a",8),a.NdJ("auxclick",function(u){return u.preventDefault()}),a._uU(7),a.qZA(),a.TgZ(8,"span",9),a._uU(9),a.qZA(),a.YNc(10,R,4,3,"button",10),a.YNc(11,x,4,3,"button",11),a.qZA(),a.TgZ(12,"div"),a._uU(13),a.ALo(14,"translate"),a.qZA(),a.TgZ(15,"span",12),a._uU(16),a.ALo(17,"translate"),a.ALo(18,"translate"),a.YNc(19,G,2,8,"a",13),a.YNc(20,m,2,1,"span",2),a._uU(21),a.ALo(22,"translate"),a.YNc(23,U,2,8,"a",13),a.YNc(24,ee,2,1,"span",2),a._uU(25),a.ALo(26,"translate"),a.qZA()()(),a._UZ(27,"app-animated-router-outlet"),a.qZA()),2&f){const l=a.oxw();a.xp6(2),a.s9C("matTooltip",a.lcZ(3,21,"RESOURCE_DETAIL.ENTITY")),a.Q6J("ngStyle",a.DdM(33,oe)),a.xp6(4),a.Q6J("perunWebAppsMiddleClickRouterLink",a.VKq(34,le,l.baseUrl))("routerLink",a.VKq(36,le,l.baseUrl)),a.xp6(1),a.hij(" ",l.resource.name," "),a.xp6(2),a.hij(" \xa0#",l.resource.id," "),a.xp6(1),a.Q6J("ngIf",l.editResourceAuth),a.xp6(1),a.Q6J("ngIf",l.deleteAuth),a.xp6(2),a.AsE("",a.lcZ(14,23,"RESOURCE_DETAIL.UUID"),": ",l.resource.uuid,""),a.xp6(3),a.AsE(" ",a.lcZ(17,25,"RESOURCE_DETAIL.ENTITY"),", ",a.lcZ(18,27,"RESOURCE_DETAIL.VO"),": "),a.xp6(3),a.Q6J("ngIf",l.voLinkAuth),a.xp6(1),a.Q6J("ngIf",!l.voLinkAuth),a.xp6(1),a.AsE(" #",l.resource.voId,", ",a.lcZ(22,29,"RESOURCE_DETAIL.FACILITY"),": "),a.xp6(2),a.Q6J("ngIf",l.facilityLinkAuth),a.xp6(1),a.Q6J("ngIf",!l.facilityLinkAuth),a.xp6(1),a.lnq(" #",l.resource.facilityId,", ",a.lcZ(26,31,"RESOURCE_DETAIL.DESCRIPTION"),": ",l.resource.description," ")}}let _e=(()=>{class f extends((0,M.T)()){constructor(l,u,g,A,D,J,te,re,T,se,_){super(),this.route=l,this.facilityManager=u,this.vosManagerService=g,this.resourcesManager=A,this.sideMenuService=D,this.sideMenuItemService=J,this.dialog=te,this.guiAuthResolver=re,this.router=T,this.entityStorageService=se,this.reloadEntityDetail=_,this.underVoUrl=!1,this.deleteAuth=!1,this.baseUrl="",this.loading=!1}ngOnInit(){this.reloadData(),this.reloadEntityDetail.entityDetailChange.pipe((0,K.R)(this.destroyed$)).subscribe(()=>{this.reloadData()})}reloadData(){this.loading=!0,this.route.params.subscribe(l=>{const u=Number(l.resourceId);this.resourcesManager.getRichResourceById(u).subscribe(g=>{this.resource=g,this.entityStorageService.setEntity({id:g.id,voId:g.voId,facilityId:g.facilityId,beanName:"Resource"}),this.setAuth(),"facilities"===this.route.parent.snapshot.url[0].path?(this.baseUrl=(new s.r5).transform(g,!1),this.facilityManager.getFacilityById(g.facilityId).subscribe(A=>{this.facility=A,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)):(this.baseUrl=(new s.r5).transform(g,!0),this.vosManagerService.getVoById(g.voId).subscribe(A=>{this.vo=A,this.underVoUrl=!0,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)),(0,S.sF)("resources",this.resource)})})}setMenuItems(){let l;const u=this.sideMenuItemService.parseResource(this.resource,this.underVoUrl);this.underVoUrl?(l=this.sideMenuItemService.parseVo(this.vo),this.sideMenuService.setAccessMenuItems([l,u])):(l=this.sideMenuItemService.parseFacility(this.facility),this.sideMenuService.setFacilityMenuItems([l,u]))}editResource(){let l;this.resourcesManager.getResourceById(this.resource.id).subscribe(u=>{l=u;const g=(0,S.kZ)();g.width="450px",g.data={theme:"resource-theme",resource:l,dialogType:t.Eg.RESOURCE},this.dialog.open(t.rd,g).afterClosed().subscribe(D=>{D&&this.resourcesManager.getRichResourceById(this.resource.id).subscribe(J=>{this.resource=J,this.setMenuItems()})})})}deleteResource(){const l=(0,S.kZ)();l.width="500px",l.data={theme:"resource-theme",resources:[this.resource]},this.dialog.open(e.f,l).afterClosed().subscribe(g=>{g&&this.router.navigate(["../"],{relativeTo:this.route,queryParamsHandling:"preserve"})})}setAuth(){this.facilityLinkAuth=this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.resource]),this.editResourceAuth=this.guiAuthResolver.isAuthorized("updateResource_Resource_policy",[this.resource]),this.voLinkAuth=this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.resource]),this.deleteAuth=this.guiAuthResolver.isAuthorized("deleteResource_Resource_policy",[this.resource])}static#e=this.\u0275fac=function(u){return new(u||f)(a.Y36(B.gz),a.Y36(n.IQ),a.Y36(n.YF),a.Y36(n.xk),a.Y36(F.D),a.Y36(E.V),a.Y36(C.uw),a.Y36(b.x4),a.Y36(B.F0),a.Y36(b.fb),a.Y36(y.G))};static#t=this.\u0275cmp=a.Xpm({type:f,selectors:[["app-resource-detail-page"]],features:[a.qOj],decls:4,vars:2,consts:[[1,"container-fluid","ps-xl-5","pe-xl-5","resource-theme"],["class","me-auto ms-auto",4,"ngIf"],[4,"ngIf"],[1,"me-auto","ms-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-resource-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"resource-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],[1,"text-muted"],["aria-label","Edit resource","mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],[1,"mt-1","entity-info"],["class","resource-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick",4,"ngIf"],["aria-label","Edit resource","mat-icon-button","",3,"matTooltip","click"],["mat-icon-button","",3,"matTooltip","click"]],template:function(u,g){1&u&&(a.TgZ(0,"div",0),a._UZ(1,"perun-web-apps-back-button"),a.YNc(2,ae,1,0,"mat-spinner",1),a.YNc(3,ce,28,38,"div",2),a.qZA()),2&u&&(a.xp6(2),a.Q6J("ngIf",g.loading),a.xp6(1),a.Q6J("ngIf",!g.loading&&void 0!==g.resource))},dependencies:[w.O5,w.PC,B.rH,Q.Hw,I.RK,V.Ou,Z.gM,j.A,L.W,Y.Y,X.Q,H.X$],styles:[".break-line[_ngcontent-%COMP%]{display:inline-block}"],data:{animation:[r.Ji]}})}return f})()},79286:(ie,W,o)=>{o.d(W,{K:()=>re});var r=o(87824),E=o(78337),n=o(17700),S=o(25313),b=o(73615),s=o(65879),t=o(71365),e=o(32296),M=o(12207),K=o(69755);function a(T,se){1&T&&s._UZ(0,"perun-web-apps-loading-dialog")}function B(T,se){1&T&&s._UZ(0,"th",14)}function F(T,se){if(1&T&&(s.TgZ(0,"td",15),s._uU(1),s.qZA()),2&T){const _=se.$implicit;s.xp6(1),s.Oqu(_.name)}}function C(T,se){1&T&&s._UZ(0,"tr",16)}function y(T,se){1&T&&s._UZ(0,"tr",17)}function w(T,se){if(1&T){const _=s.EpF();s.TgZ(0,"div")(1,"h1",2),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.TgZ(4,"div",3)(5,"p"),s._uU(6),s.ALo(7,"translate"),s.qZA(),s.TgZ(8,"div",4),s._uU(9),s.ALo(10,"translate"),s.qZA(),s.TgZ(11,"table",5),s.ynx(12,6),s.YNc(13,B,1,0,"th",7),s.YNc(14,F,2,1,"td",8),s.BQk(),s.YNc(15,C,1,0,"tr",9),s.YNc(16,y,1,0,"tr",10),s.qZA()(),s.TgZ(17,"div",11)(18,"button",12),s.NdJ("click",function(){s.CHM(_);const v=s.oxw();return s.KtG(v.onCancel())}),s._uU(19),s.ALo(20,"translate"),s.qZA(),s.TgZ(21,"button",13),s.NdJ("click",function(){s.CHM(_);const v=s.oxw();return s.KtG(v.onSubmit())}),s._uU(22),s.ALo(23,"translate"),s.qZA()()()}if(2&T){const _=s.oxw();s.xp6(2),s.Oqu(s.lcZ(3,9,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.TITLE")),s.xp6(4),s.hij(" ",s.lcZ(7,11,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DESCRIPTION")," "),s.xp6(3),s.hij(" ",s.lcZ(10,13,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.ASK")," "),s.xp6(2),s.Q6J("dataSource",_.dataSource),s.xp6(4),s.Q6J("matHeaderRowDef",_.displayedColumns),s.xp6(1),s.Q6J("matRowDefColumns",_.displayedColumns),s.xp6(3),s.hij(" ",s.lcZ(20,15,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.CANCEL")," "),s.xp6(2),s.Q6J("disabled",_.loading),s.xp6(1),s.hij(" ",s.lcZ(23,17,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DELETE")," ")}}let Q=(()=>{class T{constructor(_,O,v,k,z){this.dialogRef=_,this.data=O,this.notificator=v,this.translate=k,this.resourceManager=z,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.dataSource=new S.by(this.data.groups)}onCancel(){this.dialogRef.close()}onSubmit(){const _=[];for(const O of this.data.groups)_.push(O.id);this.loading=!0,this.resourceManager.removeGroupsFromResource(_,this.data.resourceId).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUP_FROM_RESOURCE.SUCCESS").subscribe(O=>{this.notificator.showSuccess(O),this.dialogRef.close(!0)})},()=>this.loading=!1)}static#e=this.\u0275fac=function(O){return new(O||T)(s.Y36(n.so),s.Y36(n.WI),s.Y36(b.V6),s.Y36(t.sK),s.Y36(r.xk))};static#t=this.\u0275cmp=s.Xpm({type:T,selectors:[["app-perun-web-apps-remove-group-from-resource-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","","data-cy","delete-button",1,"ms-2",3,"disabled","click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(O,v){if(1&O&&(s.YNc(0,a,1,0,"ng-template",null,0,s.W1O),s.TgZ(2,"div"),s.YNc(3,w,24,19,"div",1),s.qZA()),2&O){const k=s.MAs(1);s.xp6(2),s.Gre("",v.theme," position-relative"),s.xp6(1),s.Q6J("perunWebAppsLoader",v.loading)("perunWebAppsLoaderIndicator",k)}},dependencies:[e.lW,S.BZ,S.fO,S.as,S.w1,S.Dz,S.nj,S.ge,S.ev,S.XQ,S.Gk,n.uh,n.xY,n.H8,M.b,K.e,t.X$]})}return T})();var I=o(38106),V=o(96814),Z=o(56223),j=o(82599),L=o(61545),Y=o(97500),X=o(2730);const H=["stepper"];function ae(T,se){1&T&&s._UZ(0,"perun-web-apps-loading-dialog")}function R(T,se){1&T&&(s._uU(0),s.ALo(1,"translate")),2&T&&s.Oqu(s.lcZ(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.GROUPS"))}function x(T,se){1&T&&(s._uU(0),s.ALo(1,"translate")),2&T&&s.Oqu(s.lcZ(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.OPTIONS"))}const p=function(){return["select","id","name","description"]};function G(T,se){if(1&T){const _=s.EpF();s.TgZ(0,"div",5)(1,"mat-stepper",6,7)(3,"mat-step",8),s.YNc(4,R,2,3,"ng-template",9),s.TgZ(5,"perun-web-apps-debounce-filter",10),s.NdJ("filter",function(v){s.CHM(_);const k=s.oxw(2);return s.KtG(k.applyFilter(v))}),s.ALo(6,"translate"),s.qZA(),s._UZ(7,"perun-web-apps-groups-list",11),s.qZA(),s.TgZ(8,"mat-step"),s.YNc(9,x,2,3,"ng-template",9),s.TgZ(10,"mat-slide-toggle",12),s.NdJ("toggleChange",function(){s.CHM(_);const v=s.oxw(2);return s.KtG(v.changeSubgroupsMessage())})("ngModelChange",function(v){s.CHM(_);const k=s.oxw(2);return s.KtG(k.autoAssignSubgroups=v)}),s._uU(11),s.ALo(12,"translate"),s.qZA(),s.TgZ(13,"div",13),s._UZ(14,"i",14),s.qZA(),s.TgZ(15,"mat-slide-toggle",12),s.NdJ("toggleChange",function(){s.CHM(_);const v=s.oxw(2);return s.KtG(v.changeInactiveMessage())})("ngModelChange",function(v){s.CHM(_);const k=s.oxw(2);return s.KtG(k.asActive=v)}),s._uU(16),s.ALo(17,"translate"),s.qZA(),s.TgZ(18,"div",13),s._uU(19),s.qZA(),s.TgZ(20,"mat-slide-toggle",12),s.NdJ("toggleChange",function(){s.CHM(_);const v=s.oxw(2);return s.KtG(v.changeAsyncMessage())})("ngModelChange",function(v){s.CHM(_);const k=s.oxw(2);return s.KtG(k.async=v)}),s._uU(21),s.ALo(22,"translate"),s.qZA(),s.TgZ(23,"div",13),s._uU(24),s.qZA()()()()}if(2&T){const _=s.oxw(2);s.xp6(1),s.Q6J("linear",!0),s.xp6(2),s.Q6J("completed",0!==_.selection.selected.length&&_.canAddGroups()),s.xp6(2),s.s9C("placeholder",s.lcZ(6,19,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.FILTER_DESCRIPTION")),s.xp6(2),s.Q6J("disableMembers",!1)("groups",_.unAssignedGroups)("selection",_.selection)("disableRouting",!0)("displayedColumns",s.DdM(27,p))("filter",_.filterValue)("tableId",_.tableId),s.xp6(3),s.Q6J("ngModel",_.autoAssignSubgroups),s.xp6(1),s.hij(" ",s.lcZ(12,21,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS")," "),s.xp6(3),s.Q6J("innerHTML",_.autoAssignHint,s.oJD),s.xp6(1),s.Q6J("ngModel",_.asActive),s.xp6(1),s.hij(" ",s.lcZ(17,23,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AS_ACTIVE")," "),s.xp6(3),s.hij(" ",_.asActiveHint," "),s.xp6(1),s.Q6J("ngModel",_.async),s.xp6(1),s.hij(" ",s.lcZ(22,25,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OPT")," "),s.xp6(3),s.hij(" ",_.asyncHint," ")}}function m(T,se){if(1&T){const _=s.EpF();s.TgZ(0,"button",20),s.NdJ("click",function(){s.CHM(_);const v=s.oxw(3);return s.KtG(v.stepperPrevious())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&T&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.BACK")," "))}function N(T,se){if(1&T){const _=s.EpF();s.TgZ(0,"button",21),s.NdJ("click",function(){s.CHM(_);const v=s.oxw(3);return s.KtG(v.stepperNext())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}if(2&T){const _=s.oxw(3);s.ekj("ms-2",void 0!==_.stepper&&0!==_.stepper.selectedIndex)("ms-auto",!(void 0!==_.stepper&&0!==_.stepper.selectedIndex)),s.Q6J("disabled",0===_.selection.selected.length||!_.canAddGroups()),s.xp6(1),s.hij(" ",s.lcZ(2,6,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.NEXT")," ")}}function U(T,se){if(1&T){const _=s.EpF();s.TgZ(0,"button",22),s.NdJ("click",function(){s.CHM(_);const v=s.oxw(3);return s.KtG(v.onAdd())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&T&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ADD_BUTTON")," "))}function ee(T,se){if(1&T){const _=s.EpF();s.TgZ(0,"div",15)(1,"div")(2,"button",16),s.NdJ("click",function(){s.CHM(_);const v=s.oxw(2);return s.KtG(v.onCancel())}),s._uU(3),s.ALo(4,"translate"),s.qZA(),s.YNc(5,m,3,3,"button",17),s.YNc(6,N,3,8,"button",18),s.YNc(7,U,3,3,"button",19),s.qZA()()}if(2&T){const _=s.oxw(2);s.xp6(3),s.hij(" ",s.lcZ(4,4,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.CANCEL_BUTTON")," "),s.xp6(2),s.Q6J("ngIf",void 0!==_.stepper&&0!==_.stepper.selectedIndex),s.xp6(1),s.Q6J("ngIf",void 0!==_.stepper&&_.stepper.selectedIndex!==_.stepper._steps.length-1),s.xp6(1),s.Q6J("ngIf",void 0!==_.stepper&&_.stepper.selectedIndex===_.stepper._steps.length-1)}}function oe(T,se){if(1&T&&(s.TgZ(0,"div")(1,"h1",2),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.YNc(4,G,25,28,"div",3),s.YNc(5,ee,8,6,"div",4),s.qZA()),2&T){const _=s.oxw();s.xp6(2),s.Oqu(s.lcZ(3,3,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.TITLE")),s.xp6(2),s.Q6J("ngIf",_.unAssignedGroups),s.xp6(1),s.Q6J("ngIf",_.stepper)}}let le=(()=>{class T{constructor(_,O,v,k,z,ue,ge,Ae){this.dialogRef=_,this.data=O,this.notificator=v,this.translate=k,this.resourceManager=z,this.groupService=ue,this.guiAuthResolver=ge,this.cd=Ae,this.loading=!1,this.unAssignedGroups=null,this.async=!0,this.autoAssignSubgroups=!1,this.asActive=!0,this.selection=new E.Ov(!0,[]),this.filterValue="",this.tableId=I.cL}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resource=this.data.resource,this.autoAssignHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT"),this.asActiveHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT"),this.asyncHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT"),this.resourceManager.getAssignedGroups(this.resource.id).subscribe({next:_=>{this.groupService.getAllGroups(this.resource.voId).subscribe({next:O=>{this.unAssignedGroups=this.data.onlyAutoAssignedGroups;for(const v of O)-1===_.findIndex(k=>k.id===v.id)&&this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,v])&&this.unAssignedGroups.push(v);this.loading=!1,this.cd.detectChanges()},error:()=>this.loading=!1})},error:()=>this.loading=!1})}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0;const _=[];for(const O of this.selection.selected)_.push(O.id);this.resourceManager.assignGroupsToResource(_,this.resource.id,this.async,!this.asActive,this.autoAssignSubgroups).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.SUCCESS_MESSAGE").subscribe(O=>{this.notificator.showSuccess(O),this.dialogRef.close(!0)})},()=>this.loading=!1)}applyFilter(_){this.filterValue=_}canAddGroups(){let _=!0;return this.selection.selected.forEach(O=>{this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,O])||(_=!1)}),_}changeSubgroupsMessage(){this.autoAssignHint=this.translate.instant(this.autoAssignSubgroups?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_ON_HINT")}changeInactiveMessage(){this.asActiveHint=this.translate.instant(this.asActive?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT")}changeAsyncMessage(){this.asyncHint=this.translate.instant(this.async?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT")}stepperPrevious(){this.stepper.previous()}stepperNext(){this.stepper.next()}static#e=this.\u0275fac=function(O){return new(O||T)(s.Y36(n.so),s.Y36(n.WI),s.Y36(b.V6),s.Y36(t.sK),s.Y36(r.xk),s.Y36(r.ff),s.Y36(b.x4),s.Y36(s.sBO))};static#t=this.\u0275cmp=s.Xpm({type:T,selectors:[["app-perun-web-apps-assign-group-to-resource-dialog"]],viewQuery:function(O,v){if(1&O&&s.Gf(H,5),2&O){let k;s.iGM(k=s.CRH())&&(v.stepper=k.first)}},decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["class","dialog-container","mat-dialog-content","",4,"ngIf"],["mat-dialog-actions","","class","justify-content-end",4,"ngIf"],["mat-dialog-content","",1,"dialog-container"],[3,"linear"],["stepper",""],[3,"completed"],["matStepLabel",""],[3,"placeholder","filter"],[3,"disableMembers","groups","selection","disableRouting","displayedColumns","filter","tableId"],["labelPosition","before",1,"mt-3","slide-text",3,"ngModel","toggleChange","ngModelChange"],[1,"text-muted","new-line","mt-2"],[3,"innerHTML"],["mat-dialog-actions","",1,"justify-content-end"],["mat-stroked-button","",1,"me-2",3,"click"],["class","ms-auto","mat-stroked-button","",3,"click",4,"ngIf"],["color","accent","mat-flat-button","","type","button","data-cy","next-button",3,"ms-2","ms-auto","disabled","click",4,"ngIf"],["class","ms-2","color","accent","mat-flat-button","","type","button","data-cy","assign-button",3,"click",4,"ngIf"],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","","type","button","data-cy","next-button",3,"disabled","click"],["color","accent","mat-flat-button","","type","button","data-cy","assign-button",1,"ms-2",3,"click"]],template:function(O,v){if(1&O&&(s.YNc(0,ae,1,0,"ng-template",null,0,s.W1O),s.TgZ(2,"div"),s.YNc(3,oe,6,5,"div",1),s.qZA()),2&O){const k=s.MAs(1);s.xp6(2),s.Gre("",v.theme," position-relative"),s.xp6(1),s.Q6J("perunWebAppsLoader",v.loading)("perunWebAppsLoaderIndicator",k)}},dependencies:[V.O5,Z.JJ,Z.On,e.lW,n.uh,n.xY,n.H8,j.Rr,L.C0,L.VY,L.Vq,M.b,Y.W,X.P,K.e,t.X$],styles:[".slide-text[_ngcontent-%COMP%]{font-size:1.1rem}"]})}return T})();var ce=o(64124),_e=o(1385),f=o(44112),q=o(92596),l=o(55959),u=o(62481);function g(T,se){if(1&T){const _=s.EpF();s.TgZ(0,"button",9),s.NdJ("click",function(){s.CHM(_);const v=s.oxw();return s.KtG(v.addGroup())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&T&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_GROUPS.ADD_GROUP"),"\n"))}function A(T,se){1&T&&s._UZ(0,"perun-web-apps-loading-table")}const D=function(T){return[T]},J=function(){return["select","id","indirectGroupAssigment","name","status","description"]};function te(T,se){if(1&T){const _=s.EpF();s.TgZ(0,"perun-web-apps-groups-list",10),s.NdJ("refreshTable",function(){s.CHM(_);const v=s.oxw();return s.KtG(v.loadAllGroups())}),s.qZA()}if(2&T){const _=s.oxw();s.Q6J("disableGroups",!0)("groupsToDisableCheckbox",_.groupsToDisable)("disableMembers",!1)("groups",_.assignedGroups)("disableRouting",!!_.assignedGroups[0]&&!_.guiAuthResolver.isAuthorized("getGroupById_int_policy",s.VKq(10,D,_.assignedGroups[0])))("displayedColumns",s.DdM(12,J))("filter",_.filteredValue)("resourceId",_.resource.id)("selection",_.selected)("tableId",_.tableId)}}let re=(()=>{class T{constructor(_,O,v,k,z){this.route=_,this.resourcesManager=O,this.dialog=v,this.guiAuthResolver=k,this.entityStorageService=z,this.assignedGroups=[],this.selected=new E.Ov(!0,[]),this.filteredValue="",this.tableId=I.Ad}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.loadAllGroups()}loadAllGroups(){this.loading=!0,this.resourcesManager.getGroupAssignments(this.resource.id,[_e.r.GROUP_SYNC_ENABLED]).subscribe(_=>{this.assignedGroups=_.map(z=>{const ue=z.enrichedGroup.group;return ue.status=z.status,ue.failureCause=z.failureCause,ue.sourceGroupId=z.sourceGroupId,ue});const O=this.assignedGroups.map(z=>z.id),v=this.assignedGroups.filter((z,ue)=>O.indexOf(z.id)===ue),k=this.assignedGroups.filter((z,ue)=>{const ge=O.indexOf(z.id);return ge!==ue&&(null===z.sourceGroupId||null===this.assignedGroups[ge].sourceGroupId)}).map(z=>z.id);v.forEach(z=>{k.includes(z.id)&&(z.moreTypesOfAssignment=!0)}),this.assignedGroups=v,this.groupsToDisable=new Set(this.assignedGroups.filter(z=>!!z.sourceGroupId&&!z.moreTypesOfAssignment).map(z=>z.id)),this.selected.clear(),this.loading=!1})}addGroup(){const _=(0,ce.kZ)();_.width="1000px",_.data={theme:"resource-theme",resource:this.resource,onlyAutoAssignedGroups:this.assignedGroups.filter(v=>this.groupsToDisable.has(v.id))},this.dialog.open(le,_).afterClosed().subscribe(v=>{v&&this.loadAllGroups()})}removeGroups(){const _=(0,ce.kZ)();_.width="500px",_.data={resourceId:this.resource.id,groups:this.selected.selected,theme:"resource-theme"},this.dialog.open(Q,_).afterClosed().subscribe(v=>{v&&this.loadAllGroups()})}canRemoveGroups(){let _=!0;return this.selected.selected.forEach(O=>{this.guiAuthResolver.isAuthorized("removeGroupsFromResource_List<Group>_Resource_policy",[this.resource,O])||(_=!1)}),_}applyFilter(_){this.filteredValue=_}static#e=this.\u0275fac=function(O){return new(O||T)(s.Y36(f.gz),s.Y36(r.xk),s.Y36(n.uw),s.Y36(b.x4),s.Y36(b.fb))};static#t=this.\u0275cmp=s.Xpm({type:T,selectors:[["app-perun-web-apps-resource-groups"]],decls:15,vars:17,consts:[[1,"page-subtitle"],[3,"refresh"],["class","action-button","color","accent","mat-flat-button","","data-cy","add-group-button",3,"click",4,"ngIf"],["color","warn","mat-flat-button","","data-cy","remove-group-button",1,"ms-2","me-2",3,"disabled","click"],[3,"matTooltipDisabled","matTooltip"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative"],[3,"disableGroups","groupsToDisableCheckbox","disableMembers","groups","disableRouting","displayedColumns","filter","resourceId","selection","tableId","refreshTable",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","","data-cy","add-group-button",1,"action-button",3,"click"],[3,"disableGroups","groupsToDisableCheckbox","disableMembers","groups","disableRouting","displayedColumns","filter","resourceId","selection","tableId","refreshTable"]],template:function(O,v){if(1&O&&(s.TgZ(0,"h1",0),s._uU(1),s.ALo(2,"translate"),s.qZA(),s.TgZ(3,"perun-web-apps-refresh-button",1),s.NdJ("refresh",function(){return v.loadAllGroups()}),s.qZA(),s.YNc(4,g,3,3,"button",2),s.TgZ(5,"button",3),s.NdJ("click",function(){return v.removeGroups()}),s.TgZ(6,"span",4),s.ALo(7,"translate"),s._uU(8),s.ALo(9,"translate"),s.qZA()(),s.TgZ(10,"perun-web-apps-debounce-filter",5),s.NdJ("filter",function(z){return v.applyFilter(z)}),s.qZA(),s.YNc(11,A,1,0,"ng-template",null,6,s.W1O),s.TgZ(13,"div",7),s.YNc(14,te,1,13,"perun-web-apps-groups-list",8),s.qZA()),2&O){const k=s.MAs(12);s.xp6(1),s.Oqu(s.lcZ(2,9,"RESOURCE_DETAIL.ASSIGNED_GROUPS.TITLE")),s.xp6(3),s.Q6J("ngIf",v.guiAuthResolver.isAuthorized("getAllGroups_Vo_policy",s.VKq(15,D,v.resource))),s.xp6(1),s.Q6J("disabled",0===v.selected.selected.length||!v.canRemoveGroups()),s.xp6(1),s.s9C("matTooltip",s.lcZ(7,11,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_TOOLTIP")),s.Q6J("matTooltipDisabled",v.canRemoveGroups()),s.xp6(2),s.hij(" ",s.lcZ(9,13,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_GROUP")," "),s.xp6(2),s.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_GROUPS.FILTER_GROUPS"),s.xp6(4),s.Q6J("perunWebAppsLoader",v.loading)("perunWebAppsLoaderIndicator",k)}},dependencies:[V.O5,e.lW,q.gM,l.K,Y.W,u.t,X.P,K.e,t.X$]})}return T})()},33473:(ie,W,o)=>{o.d(W,{H:()=>a});var r=o(87824),E=o(73615),n=o(65879),S=o(44112),b=o(96814),s=o(55940),t=o(39518),e=o(19218);function M(B,F){1&B&&n._UZ(0,"mat-spinner",2)}function K(B,F){if(1&B&&(n.TgZ(0,"div"),n._UZ(1,"perun-web-apps-menu-buttons-field",3)(2,"perun-web-apps-expandable-tiles",4),n.qZA()),2&B){const C=n.oxw();n.xp6(1),n.Q6J("items",C.items),n.xp6(1),n.Q6J("items",C.settingsItems)("title","MENU_ITEMS.RESOURCE.SETTINGS")("sectionId","settings")}}let a=(()=>{class B{constructor(C,y,w,Q,I){this.resourcesManager=C,this.route=y,this.guiAuthResolver=w,this.entityStorageService=Q,this.routePolicyService=I,this.items=[],this.settingsItems=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity();const C="facilities"===this.route.parent.parent.snapshot.url[0].path;this.setItems(C),this.setSettingsItems(C),this.loading=!1}setItems(C){const y=C?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`;this.items=[],this.routePolicyService.canNavigate("resources-groups",this.resource)&&this.items.push({cssIcon:"perun-group",url:`${y}/resources/${this.resource.id}/groups`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_GROUPS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-services",this.resource)&&this.items.push({cssIcon:"perun-service",url:`${y}/resources/${this.resource.id}/services`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_SERVICES",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-members",this.resource)&&this.items.push({cssIcon:"perun-user",url:`${y}/resources/${this.resource.id}/members`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_MEMBERS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-tags",this.resource)&&this.items.push({cssIcon:"perun-resource-tags",url:`${y}/resources/${this.resource.id}/tags`,label:"MENU_ITEMS.RESOURCE.RESOURCE_TAGS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-attributes",this.resource)&&this.items.push({cssIcon:"perun-attributes",url:`${y}/resources/${this.resource.id}/attributes`,label:"MENU_ITEMS.RESOURCE.ATTRIBUTES",style:"resource-btn"})}setSettingsItems(C){this.settingsItems=[],this.routePolicyService.canNavigate("resources-settings-managers",this.resource)&&this.settingsItems.push({cssIcon:"perun-manager",url:`${C?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/managers`,label:"MENU_ITEMS.RESOURCE.MANAGERS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-settings-bans",this.resource)&&this.settingsItems.push({cssIcon:"perun-ban",url:`${C?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/bans`,label:"MENU_ITEMS.RESOURCE.BANS",style:"resource-btn"})}static#e=this.\u0275fac=function(y){return new(y||B)(n.Y36(r.xk),n.Y36(S.gz),n.Y36(E.x4),n.Y36(E.fb),n.Y36(E.Ip))};static#t=this.\u0275cmp=n.Xpm({type:B,selectors:[["app-resource-overview"]],hostVars:2,hostBindings:function(y,w){2&y&&n.ekj("router-component",w.true)},decls:2,vars:2,consts:[["class","me-auto ms-auto",4,"ngIf"],[4,"ngIf"],[1,"me-auto","ms-auto"],[3,"items"],[3,"items","title","sectionId"]],template:function(y,w){1&y&&(n.YNc(0,M,1,0,"mat-spinner",0),n.YNc(1,K,3,4,"div",1)),2&y&&(n.Q6J("ngIf",w.loading),n.xp6(1),n.Q6J("ngIf",!w.loading))},dependencies:[b.O5,s.Ou,t.L,e.A]})}return B})()},67114:(ie,W,o)=>{o.d(W,{I:()=>x});var r=o(87824),E=o(78337),n=o(73615),S=o(64124),b=o(37073),s=o(38106),t=o(17700),e=o(65879),M=o(61917),K=o(2730),a=o(69190);const B=function(){return["checkbox","id","fullName"]};let F=(()=>{class p{constructor(m,N,U,ee,oe){this.data=m,this.dialogRef=N,this.store=U,this.resourceService=ee,this.notificator=oe,this.selection=new E.Ov(!1,[]),this.loading=!1,this.displayedColumns=["checkbox","id","fullName","organization","email","logins"],this.members=[],this.tableId=s.bj,this.filter=""}ngOnInit(){this.loading=!0,this.resourceService.getAssignedRichMembers(this.data.entityId).subscribe({next:m=>{this.members=m,this.loading=!1},error:()=>this.loading=!1}),this.selection.changed.subscribe(m=>{this.ban=this.data.bans.find(N=>N.memberId===m.source.selected[0]?.id)})}cancel(){this.dialogRef.close(!1)}submitBan(m){this.ban?this.updateBan(m):this.banMember(m)}banMember(m){this.loading=!0,this.resourceService.setResourceBan({banOnResource:{memberId:this.selection.selected[0].id,resourceId:this.data.entityId,description:m.description,validityTo:m.validity,id:0,beanName:"BanOnResource"}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.ADD_BAN.SUCCESS_MEMBER"),this.dialogRef.close(!0)},error:()=>this.loading=!1})}updateBan(m){this.loading=!0,this.resourceService.updateResourceBan({banOnResource:{id:this.ban.id,beanName:"BanOnFacility",resourceId:this.ban.resourceId,memberId:this.ban.memberId,description:m.description,validityTo:m.validity}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.UPDATE_BAN.SUCCESS"),this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}static#e=this.\u0275fac=function(N){return new(N||p)(e.Y36(t.WI),e.Y36(t.so),e.Y36(n.d6),e.Y36(r.xk),e.Y36(n.V6))};static#t=this.\u0275cmp=e.Xpm({type:p,selectors:[["app-add-resource-ban-dialog"]],decls:3,vars:13,consts:[[3,"loading","disabled","theme","ban","add","cancel"],[3,"placeholder","filter"],[3,"displayedColumns","selection","disableRouting","allowCheckboxDisabled","filter","members","tableId"]],template:function(N,U){1&N&&(e.TgZ(0,"app-add-ban-dialog",0),e.NdJ("add",function(oe){return U.submitBan(oe)})("cancel",function(){return U.cancel()}),e.TgZ(1,"perun-web-apps-debounce-filter",1),e.NdJ("filter",function(oe){return U.filter=oe}),e.qZA(),e._UZ(2,"perun-web-apps-members-list",2),e.qZA()),2&N&&(e.Q6J("loading",U.loading)("disabled",0===U.selection.selected.length)("theme",U.data.theme)("ban",U.ban),e.xp6(1),e.Q6J("placeholder","DIALOGS.ADD_BAN.FILTER"),e.xp6(1),e.Q6J("displayedColumns",e.DdM(12,B))("selection",U.selection)("disableRouting",!0)("allowCheckboxDisabled",!1)("filter",U.filter)("members",U.members)("tableId",U.tableId))},dependencies:[M.O,K.P,a.u]})}return p})();var C=o(1385),y=o(52260),w=o(80874),Q=o(96814),I=o(32296),V=o(55959),Z=o(62481),j=o(6849),L=o(69755),Y=o(71365);function X(p,G){if(1&p){const m=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){e.CHM(m);const U=e.oxw();return e.KtG(U.add())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&p&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"RESOURCE_DETAIL.SETTINGS.BANS.ADD"),"\n"))}function H(p,G){if(1&p){const m=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(m);const U=e.oxw();return e.KtG(U.remove())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&p){const m=e.oxw();e.Q6J("disabled",0===m.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"RESOURCE_DETAIL.SETTINGS.BANS.REMOVE"),"\n")}}function ae(p,G){if(1&p){const m=e.EpF();e.TgZ(0,"perun-web-apps-ban-on-entity-list",10),e.NdJ("updateBan",function(U){e.CHM(m);const ee=e.oxw();return e.KtG(ee.update(U))}),e.qZA()}if(2&p){const m=e.oxw();e.Q6J("bans",m.bans)("selection",m.selection)("displayedColumns",m.displayedColumns)("filter",m.filter)("updatePolicy","updateBan_BanOnResource_policy")}}function R(p,G){1&p&&e._UZ(0,"perun-web-apps-loading-table")}let x=(()=>{class p{constructor(m,N,U,ee,oe,le,ce){this.resourceService=m,this.entityService=N,this.authResolver=U,this.dialog=ee,this.notificator=oe,this.store=le,this.userName=ce,this.loading=!1,this.bans=[],this.removeAuth=!1,this.filter="",this.selection=new E.Ov(!1,[]),this.attrNames=[C.r.MEMBER_DEF_MAIL,C.r.USER_DEF_PREFERRED_MAIL].concat(this.store.getLoginAttributeNames()),this.displayedColumns=["select","banId","subjectId","subjectName","description","expiration","edit"]}ngOnInit(){this.loading=!0,this.resource=this.entityService.getEntity(),this.addAuth=this.authResolver.isAuthorized("setBan_BanOnResource_policy",[this.resource]),this.removeAuth=this.authResolver.isAuthorized("resource-removeBan_int_policy",[this.resource]),this.refresh()}refresh(){this.loading=!0,this.resourceService.getEnrichedBansForResource(this.resource.id,this.attrNames).subscribe({next:m=>{this.bans=m,this.selection.clear(),this.loading=!1},error:()=>this.loading=!1})}add(){const m=(0,S.kZ)();m.width="850px",m.data={entityId:this.resource.id,theme:"resource-theme",bans:this.bans.map(U=>U.ban)},this.dialog.open(F,m).afterClosed().subscribe(U=>{U&&this.refresh()})}remove(){const m=(0,S.kZ)();m.width="550px",m.data={theme:"resource-theme",title:"DIALOGS.REMOVE_BAN.TITLE",description:"DIALOGS.REMOVE_BAN.DESCRIPTION",items:[this.userName.transform(this.selection.selected[0].member.user)],type:"remove",showAsk:!0},this.dialog.open(b.Ts,m).afterClosed().subscribe(U=>{U&&this.resourceService.removeResourceBanById(this.selection.selected[0].ban.id).subscribe(()=>{this.notificator.showSuccess("DIALOGS.REMOVE_BAN.SUCCESS"),this.refresh()})})}update(m){const N=(0,S.kZ)();N.width="600px",N.data={ban:m.ban,theme:"facility-theme"},this.dialog.open(y.e,N).afterClosed().subscribe(ee=>{ee&&this.refresh()})}static#e=this.\u0275fac=function(N){return new(N||p)(e.Y36(r.xk),e.Y36(n.fb),e.Y36(n.x4),e.Y36(t.uw),e.Y36(n.V6),e.Y36(n.d6),e.Y36(w.dp))};static#t=this.\u0275cmp=e.Xpm({type:p,selectors:[["app-resource-settings-bans"]],features:[e._Bn([w.dp])],decls:11,vars:8,consts:[[1,"page-subtitle"],[3,"click"],["class","me-2 action-button","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","class","me-2","mat-flat-button","",3,"disabled","click",4,"ngIf"],[1,"mt-2","search-field",3,"placeholder","filter"],[1,"position-relative"],[3,"bans","selection","displayedColumns","filter","updatePolicy","updateBan",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["spinner",""],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"bans","selection","displayedColumns","filter","updatePolicy","updateBan"]],template:function(N,U){if(1&N&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("click",function(){return U.refresh()}),e.qZA(),e.YNc(4,X,3,3,"button",2),e.YNc(5,H,3,4,"button",3),e.TgZ(6,"perun-web-apps-debounce-filter",4),e.NdJ("filter",function(oe){return U.filter=oe}),e.qZA(),e.TgZ(7,"div",5),e.YNc(8,ae,1,5,"perun-web-apps-ban-on-entity-list",6),e.qZA(),e.YNc(9,R,1,0,"ng-template",null,7,e.W1O)),2&N){const ee=e.MAs(10);e.xp6(1),e.hij(" ",e.lcZ(2,6,"RESOURCE_DETAIL.SETTINGS.BANS.TITLE"),"\n"),e.xp6(3),e.Q6J("ngIf",U.addAuth),e.xp6(1),e.Q6J("ngIf",U.removeAuth),e.xp6(1),e.Q6J("placeholder","RESOURCE_DETAIL.SETTINGS.BANS.FILTER"),e.xp6(2),e.Q6J("perunWebAppsLoader",U.loading)("perunWebAppsLoaderIndicator",ee)}},dependencies:[Q.O5,I.lW,V.K,Z.t,K.P,j.s,L.e,Y.X$]})}return p})()},40945:(ie,W,o)=>{o.d(W,{O:()=>S});var r=o(73615),E=o(65879),n=o(27738);let S=(()=>{class b{constructor(t,e){this.guiAuthResolver=t,this.entityStorageService=e,this.availableRoles=[],this.type="Resource",this.theme="resource-theme"}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Resource")}static#e=this.\u0275fac=function(e){return new(e||b)(E.Y36(r.x4),E.Y36(r.fb))};static#t=this.\u0275cmp=E.Xpm({type:b,selectors:[["app-resource-settings-managers"]],decls:1,vars:4,consts:[[3,"complementaryObject","availableRoles","complementaryObjectType","theme"]],template:function(e,M){1&e&&E._UZ(0,"app-managers-page",0),2&e&&E.Q6J("complementaryObject",M.resource)("availableRoles",M.availableRoles)("complementaryObjectType",M.type)("theme",M.theme)},dependencies:[n.s]})}return b})()},72263:(ie,W,o)=>{o.d(W,{h:()=>K});var r=o(87824),E=o(73615),n=o(65879),S=o(44112),b=o(96814),s=o(55940),t=o(39518);function e(a,B){1&a&&n._UZ(0,"mat-spinner",2)}function M(a,B){if(1&a&&(n.TgZ(0,"div"),n._UZ(1,"perun-web-apps-menu-buttons-field",3),n.qZA()),2&a){const F=n.oxw();n.xp6(1),n.Q6J("items",F.items)}}let K=(()=>{class a{constructor(F,C,y,w,Q){this.route=F,this.resourceManager=C,this.authResolver=y,this.entityStorageService=w,this.routePolicyService=Q,this.items=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.initItems("facilities"!==this.route.parent.parent.parent.snapshot.url[0].path),this.loading=!1}initItems(F){this.items=[],this.routePolicyService.canNavigate("resources-settings-managers",this.resource)&&this.items.push({cssIcon:"perun-manager",url:`${F?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/managers`,label:"MENU_ITEMS.RESOURCE.MANAGERS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-settings-bans",this.resource)&&this.items.push({cssIcon:"perun-ban",url:`${F?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/bans`,label:"MENU_ITEMS.RESOURCE.BANS",style:"resource-btn"})}static#e=this.\u0275fac=function(C){return new(C||a)(n.Y36(S.gz),n.Y36(r.xk),n.Y36(E.x4),n.Y36(E.fb),n.Y36(E.Ip))};static#t=this.\u0275cmp=n.Xpm({type:a,selectors:[["app-resource-settings-overview"]],hostVars:2,hostBindings:function(C,y){2&C&&n.ekj("router-component",y.true)},decls:2,vars:2,consts:[["class","me-auto ms-auto",4,"ngIf"],[4,"ngIf"],[1,"me-auto","ms-auto"],[3,"items"]],template:function(C,y){1&C&&(n.YNc(0,e,1,0,"mat-spinner",0),n.YNc(1,M,2,1,"div",1)),2&C&&(n.Q6J("ngIf",y.loading),n.xp6(1),n.Q6J("ngIf",!y.loading))},dependencies:[b.O5,s.Ou,t.L]})}return a})()},93296:(ie,W,o)=>{o.d(W,{t:()=>S});var r=o(53117),E=o(65879),n=o(11712);let S=(()=>{class b{static#e=this.\u0275fac=function(e){return new(e||b)};static#t=this.\u0275cmp=E.Xpm({type:b,selectors:[["app-resource-settings"]],hostVars:2,hostBindings:function(e,M){2&e&&E.ekj("router-component",M.true)},decls:1,vars:0,template:function(e,M){1&e&&E._UZ(0,"app-animated-router-outlet")},dependencies:[n.A],data:{animation:[r.Ji]}})}return b})()},72501:(ie,W,o)=>{o.d(W,{v:()=>ae});var r=o(87824),E=o(78337),n=o(38106),S=o(64124),b=o(73615),s=o(37073),t=o(17700),e=o(65879),M=o(32296),K=o(55959),a=o(69755),B=o(26946),F=o(71365);function C(R,x){1&R&&e._UZ(0,"perun-web-apps-loading-table")}function y(R,x){if(1&R&&e._UZ(0,"app-resources-tags-list",8),2&R){const p=e.oxw();e.Q6J("selection",p.selection)("displayedColumns",p.displayedColumns)("entity","resource")("filterValue",p.filterValue)("resourceTags",p.resourceTags)("tableId",p.tableId)}}let w=(()=>{class R{constructor(p,G,m){this.dialogRef=p,this.data=G,this.resourcesManager=m,this.tableId=n.g,this.selection=new E.Ov(!0,[]),this.resourceTags=[],this.displayedColumns=["select","id","name"]}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.voId=this.data.voId,this.resourceId=this.data.resourceId,this.assignedTags=this.data.assignedTags,this.resourcesManager.getAllResourcesTagsForVo(this.voId).subscribe(p=>{this.resourceTags=p.filter(G=>!this.assignedTags.map(m=>m.id).includes(G.id)),this.loading=!1})}onCancel(){this.dialogRef.close(!1)}onSubmit(p){this.resourcesManager.assignResourceTagsToResource({resource:this.resourceId,resourceTags:p}).subscribe(()=>{this.dialogRef.close(!0)})}applyFilter(p){this.filterValue=p}static#e=this.\u0275fac=function(G){return new(G||R)(e.Y36(t.so),e.Y36(t.WI),e.Y36(r.xk))};static#t=this.\u0275cmp=e.Xpm({type:R,selectors:[["app-add-resource-tag-to-resource-dialog"]],decls:16,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["spinner",""],[1,"position-relative"],[3,"selection","displayedColumns","entity","filterValue","resourceTags","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"disabled","click"],[3,"selection","displayedColumns","entity","filterValue","resourceTags","tableId"]],template:function(G,m){if(1&G&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1),e.YNc(5,C,1,0,"ng-template",null,2,e.W1O),e.TgZ(7,"div",3),e.YNc(8,y,1,6,"app-resources-tags-list",4),e.qZA()(),e.TgZ(9,"div",5)(10,"button",6),e.NdJ("click",function(){return m.onCancel()}),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"button",7),e.NdJ("click",function(){return m.onSubmit(m.selection.selected)}),e._uU(14),e.ALo(15,"translate"),e.qZA()()()),2&G){const N=e.MAs(6);e.Tol(m.theme),e.xp6(2),e.Oqu(e.lcZ(3,9,"RESOURCE_DETAIL.TAGS.ADD_TAGS")),e.xp6(6),e.Q6J("perunWebAppsLoader",m.loading)("perunWebAppsLoaderIndicator",N),e.xp6(3),e.hij(" ",e.lcZ(12,11,"RESOURCE_DETAIL.TAGS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",m.loading||0===m.resourceTags.length),e.xp6(1),e.hij(" ",e.lcZ(15,13,"RESOURCE_DETAIL.TAGS.ADD_BUTTON")," ")}},dependencies:[M.lW,t.uh,t.xY,t.H8,K.K,a.e,B.o,F.X$]})}return R})();var Q=o(80098),I=o(96814),V=o(62481),Z=o(2730);function j(R,x){if(1&R){const p=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){e.CHM(p);const m=e.oxw();return e.KtG(m.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&R&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.CREATE_BUTTON"),"\n"))}function L(R,x){if(1&R){const p=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){e.CHM(p);const m=e.oxw();return e.KtG(m.addTag())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&R&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"RESOURCE_DETAIL.TAGS.ADD_BUTTON"),"\n"))}function Y(R,x){if(1&R){const p=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(p);const m=e.oxw();return e.KtG(m.removeTags())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&R){const p=e.oxw();e.Q6J("disabled",0===p.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"RESOURCE_DETAIL.TAGS.REMOVE_BUTTON"),"\n")}}function X(R,x){1&R&&e._UZ(0,"perun-web-apps-loading-table")}function H(R,x){if(1&R&&e._UZ(0,"app-resources-tags-list",10),2&R){const p=e.oxw();e.Q6J("displayedColumns",p.displayedColumns)("entity","resource")("resourceTags",p.resourceTags)("filterValue",p.filterValue)("selection",p.selection)("tableId",p.tableId)}}let ae=(()=>{class R{constructor(p,G,m,N,U,ee){this.authResolver=p,this.resourcesManager=G,this.dialog=m,this.notificator=N,this.translate=U,this.entityStorageService=ee,this.loading=!1,this.resourceTags=[],this.selection=new E.Ov(!0,[]),this.tableId=n.M8,this.displayedColumns=[]}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.setAuthRights(),this.updateData()}removeTags(){const p=(0,S.kZ)();p.width="450px",p.data={items:this.selection.selected.map(m=>m.tagName),title:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_TITLE",description:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_DESCRIPTION",theme:"resource-theme",type:"remove",showAsk:!0},this.dialog.open(s.Ts,p).afterClosed().subscribe(m=>{m&&this.resourcesManager.removeResourceTagsFromResource({resource:this.resource.id,resourceTags:this.selection.selected}).subscribe(()=>(this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.REMOVED_SUCCESSFULLY")),this.updateData()))})}addTag(){const p=(0,S.kZ)();p.width="600px",p.data={voId:this.resource.voId,resourceId:this.resource.id,assignedTags:this.resourceTags,theme:"resource-theme"},this.dialog.open(w,p).afterClosed().subscribe(m=>{m&&(this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.ADDED_SUCCESSFULLY")),this.updateData())})}create(){const p=(0,S.kZ)();p.width="450px",p.data={voId:this.resource.voId,theme:"resource-theme"},this.dialog.open(Q.p,p).afterClosed().subscribe(m=>{m&&(this.notificator.showSuccess(this.translate.instant("VO_DETAIL.RESOURCES.TAGS.CREATE_SUCCESS")),this.updateData())})}updateData(){this.loading=!0,this.selection.clear(),this.resourcesManager.getAllResourcesTagsForResource(this.resource.id).subscribe(p=>{this.resourceTags=p,this.selection.clear(),this.loading=!1})}setAuthRights(){const p={id:this.resource.voId,beanName:"Vo"};this.displayedColumns=[],this.createAuth=this.authResolver.isAuthorized("createResourceTag_ResourceTag_Vo_policy",[p]),this.addAuth=this.authResolver.isAuthorized("assignResourceTagToResource_ResourceTag_Resource_policy",[this.resource]),this.removeAuth=this.authResolver.isAuthorized("removeResourceTagFromResource_ResourceTag_Resource_policy",[this.resource]),this.displayedColumns=this.removeAuth?["select","id","name"]:["id","name"]}applyFilter(p){this.filterValue=p}static#e=this.\u0275fac=function(G){return new(G||R)(e.Y36(b.x4),e.Y36(r.xk),e.Y36(t.uw),e.Y36(b.V6),e.Y36(b.Te),e.Y36(b.fb))};static#t=this.\u0275cmp=e.Xpm({type:R,selectors:[["app-perun-web-apps-resource-tags"]],decls:12,vars:9,consts:[[1,"page-subtitle"],[3,"refresh"],["class","me-2 action-button","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","me-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative"],[3,"displayedColumns","entity","resourceTags","filterValue","selection","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"displayedColumns","entity","resourceTags","filterValue","selection","tableId"]],template:function(G,m){if(1&G&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){return m.updateData()}),e.qZA(),e.YNc(4,j,3,3,"button",2),e.YNc(5,L,3,3,"button",2),e.YNc(6,Y,3,4,"button",3),e.TgZ(7,"perun-web-apps-debounce-filter",4),e.NdJ("filter",function(U){return m.applyFilter(U)}),e.qZA(),e.YNc(8,X,1,0,"ng-template",null,5,e.W1O),e.TgZ(10,"div",6),e.YNc(11,H,1,6,"app-resources-tags-list",7),e.qZA()),2&G){const N=e.MAs(9);e.xp6(1),e.Oqu(e.lcZ(2,7,"RESOURCE_DETAIL.TAGS.TITLE")),e.xp6(3),e.Q6J("ngIf",m.createAuth),e.xp6(1),e.Q6J("ngIf",m.addAuth),e.xp6(1),e.Q6J("ngIf",m.removeAuth),e.xp6(1),e.Q6J("placeholder","RESOURCE_DETAIL.TAGS.SEARCH"),e.xp6(4),e.Q6J("perunWebAppsLoader",m.loading)("perunWebAppsLoaderIndicator",N)}},dependencies:[I.O5,M.lW,B.o,K.K,V.t,Z.P,a.e,F.X$]})}return R})()},69190:(ie,W,o)=>{o.d(W,{u:()=>V});var r=o(65879),E=o(78932),n=o(96814),S=o(32296),b=o(17700),s=o(61545),t=o(11186),e=o(12207),M=o(88185),K=o(69755),a=o(71365);function B(Z,j){1&Z&&r._UZ(0,"perun-web-apps-loading-dialog")}function F(Z,j){1&Z&&(r.TgZ(0,"perun-web-apps-alert",15),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&Z&&(r.Q6J("alert_type","info"),r.xp6(1),r.hij(" ",r.lcZ(2,2,"DIALOGS.ADD_BAN.ALREADY_BANNED")," "))}function C(Z,j){if(1&Z){const L=r.EpF();r.TgZ(0,"button",16),r.NdJ("click",function(){r.CHM(L),r.oxw();const X=r.MAs(6);return r.KtG(X.next())}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&Z){const L=r.oxw(2);r.Q6J("disabled",L.disabled),r.xp6(1),r.hij(" ",r.lcZ(2,2,"DIALOGS.ADD_BAN.NEXT")," ")}}function y(Z,j){if(1&Z){const L=r.EpF();r.TgZ(0,"button",17),r.NdJ("click",function(){r.CHM(L),r.oxw();const X=r.MAs(6);return r.KtG(X.previous())}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&Z&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"DIALOGS.ADD_BAN.BACK")," "))}function w(Z,j){if(1&Z){const L=r.EpF();r.TgZ(0,"button",18),r.NdJ("click",function(){r.CHM(L);const X=r.oxw(2);return r.KtG(X.addBan())}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&Z){const L=r.oxw(2);r.xp6(1),r.hij(" ",r.lcZ(2,1,L.ban?"DIALOGS.ADD_BAN.UPDATE":"DIALOGS.ADD_BAN.ADD")," ")}}function Q(Z,j){if(1&Z){const L=r.EpF();r.TgZ(0,"div")(1,"h1",2),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"div",3)(5,"mat-stepper",4,5)(7,"mat-step",6),r.ALo(8,"translate"),r.Hsn(9),r.qZA(),r.TgZ(10,"mat-step",7),r.ALo(11,"translate"),r.YNc(12,F,3,4,"perun-web-apps-alert",8),r._UZ(13,"perun-web-apps-ban-specification",9),r.qZA()()(),r.TgZ(14,"div",10)(15,"button",11),r.NdJ("click",function(){r.CHM(L);const X=r.oxw();return r.KtG(X.cancel.emit())}),r._uU(16),r.ALo(17,"translate"),r.qZA(),r.YNc(18,C,3,4,"button",12),r.YNc(19,y,3,3,"button",13),r.YNc(20,w,3,3,"button",14),r.qZA()()}if(2&Z){const L=r.MAs(6),Y=r.oxw();r.xp6(2),r.Oqu(r.lcZ(3,12,"DIALOGS.ADD_BAN.TITLE")),r.xp6(3),r.Q6J("linear",!0),r.xp6(2),r.Q6J("completed",!Y.disabled)("label",r.lcZ(8,14,"DIALOGS.ADD_BAN.SELECTION")),r.xp6(3),r.Q6J("label",r.lcZ(11,16,"DIALOGS.ADD_BAN.SPECIFICATION")),r.xp6(2),r.Q6J("ngIf",Y.ban),r.xp6(1),r.Q6J("description",null==Y.ban?null:Y.ban.description)("validity",null==Y.ban?null:Y.ban.validityTo),r.xp6(3),r.hij(" ",r.lcZ(17,18,"DIALOGS.ADD_BAN.CANCEL")," "),r.xp6(2),r.Q6J("ngIf",L.selectedIndex!==(null==L||null==L._steps?null:L._steps.length)-1),r.xp6(1),r.Q6J("ngIf",L.selectedIndex===(null==L||null==L._steps?null:L._steps.length)-1),r.xp6(1),r.Q6J("ngIf",L.selectedIndex===(null==L||null==L._steps?null:L._steps.length)-1)}}const I=["*"];let V=(()=>{class Z{constructor(){this.loading=!1,this.disabled=!1,this.add=new r.vpe,this.cancel=new r.vpe}addBan(){this.add.emit({description:this.banForm.getDescription(),validity:this.banForm.getValidity()})}static#e=this.\u0275fac=function(Y){return new(Y||Z)};static#t=this.\u0275cmp=r.Xpm({type:Z,selectors:[["app-add-ban-dialog"]],viewQuery:function(Y,X){if(1&Y&&r.Gf(E.CZ,5),2&Y){let H;r.iGM(H=r.CRH())&&(X.banForm=H.first)}},inputs:{loading:"loading",disabled:"disabled",theme:"theme",ban:"ban"},outputs:{add:"add",cancel:"cancel"},ngContentSelectors:I,decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[3,"linear"],["stepper",""],[3,"completed","label"],[3,"label"],[3,"alert_type",4,"ngIf"],[3,"description","validity"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto","me-2",3,"click"],["mat-flat-button","","class","me-2","color","accent",3,"disabled","click",4,"ngIf"],["mat-stroked-button","","class","me-2",3,"click",4,"ngIf"],["mat-flat-button","","color","accent",3,"click",4,"ngIf"],[3,"alert_type"],["mat-flat-button","","color","accent",1,"me-2",3,"disabled","click"],["mat-stroked-button","",1,"me-2",3,"click"],["mat-flat-button","","color","accent",3,"click"]],template:function(Y,X){if(1&Y&&(r.F$t(),r.YNc(0,B,1,0,"ng-template",null,0,r.W1O),r.TgZ(2,"div"),r.YNc(3,Q,21,20,"div",1),r.qZA()),2&Y){const H=r.MAs(1);r.xp6(2),r.Gre("",X.theme," position-relative"),r.xp6(1),r.Q6J("perunWebAppsLoader",X.loading)("perunWebAppsLoaderIndicator",H)}},dependencies:[n.O5,S.lW,b.uh,b.xY,b.H8,s.C0,s.Vq,t.w,e.b,M.C,K.e,a.X$]})}return Z})()},80098:(ie,W,o)=>{o.d(W,{p:()=>F});var r=o(17700),E=o(87824),n=o(65879),S=o(24516),b=o(64170),s=o(56223),t=o(32296),e=o(12207),M=o(69755),K=o(71365);function a(C,y){1&C&&n._UZ(0,"perun-web-apps-loading-dialog")}function B(C,y){if(1&C){const w=n.EpF();n.TgZ(0,"div")(1,"h1",2),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"div",3)(5,"mat-form-field")(6,"mat-label"),n._uU(7),n.ALo(8,"translate"),n.qZA(),n.TgZ(9,"input",4),n.NdJ("ngModelChange",function(I){n.CHM(w);const V=n.oxw();return n.KtG(V.name=I)}),n.qZA(),n.TgZ(10,"mat-error"),n._uU(11),n.ALo(12,"translate"),n.qZA()()(),n.TgZ(13,"div",5)(14,"button",6),n.NdJ("click",function(){n.CHM(w);const I=n.oxw();return n.KtG(I.onCancel())}),n._uU(15),n.ALo(16,"translate"),n.qZA(),n.TgZ(17,"button",7),n.NdJ("click",function(){n.CHM(w);const I=n.oxw();return n.KtG(I.onSubmit())}),n._uU(18),n.ALo(19,"translate"),n.qZA()()()}if(2&C){const w=n.oxw();n.xp6(2),n.Oqu(n.lcZ(3,7,"DIALOGS.CREATE_RESOURCE_TAG.TITLE")),n.xp6(5),n.Oqu(n.lcZ(8,9,"DIALOGS.CREATE_RESOURCE_TAG.NAME")),n.xp6(2),n.Q6J("ngModel",w.name),n.xp6(2),n.Oqu(n.lcZ(12,11,"DIALOGS.CREATE_RESOURCE_TAG.EMPTY_NAME")),n.xp6(4),n.hij(" ",n.lcZ(16,13,"DIALOGS.CREATE_RESOURCE_TAG.CANCEL")," "),n.xp6(2),n.Q6J("disabled",w.loading),n.xp6(1),n.hij(" ",n.lcZ(19,15,"DIALOGS.CREATE_RESOURCE_TAG.CREATE")," ")}}let F=(()=>{class C{constructor(w,Q,I){this.dialogRef=w,this.data=Q,this.resourceManager=I,this.name="",this.loading=!1}ngOnInit(){this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){""!==this.name&&(this.loading=!0,this.resourceManager.createResourceTagWithTagName(this.name,this.data.voId).subscribe(()=>{this.dialogRef.close(!0)},()=>this.loading=!1))}static#e=this.\u0275fac=function(Q){return new(Q||C)(n.Y36(r.so),n.Y36(r.WI),n.Y36(E.xk))};static#t=this.\u0275cmp=n.Xpm({type:C,selectors:[["app-create-resource-tag-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],["matInput","","required","",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"disabled","click"]],template:function(Q,I){if(1&Q&&(n.YNc(0,a,1,0,"ng-template",null,0,n.W1O),n.TgZ(2,"div"),n.YNc(3,B,20,17,"div",1),n.qZA()),2&Q){const V=n.MAs(1);n.xp6(2),n.Gre("",I.theme," position-relative"),n.xp6(1),n.Q6J("perunWebAppsLoader",I.loading)("perunWebAppsLoaderIndicator",V)}},dependencies:[S.Nt,b.KE,b.hX,b.TO,s.Fj,s.JJ,s.Q7,s.On,t.lW,r.uh,r.xY,r.H8,e.b,M.e,K.X$]})}return C})()},27738:(ie,W,o)=>{o.d(W,{s:()=>Qe});var r=o(78337),E=o(17700),n=o(73615),S=o(87824),b=o(38106),s=o(1385),t=o(56223),e=o(65879),M=o(71365),K=o(44112),a=o(96814),B=o(23680),F=o(24516),C=o(64170),y=o(32296),w=o(98525),Q=o(55959),I=o(33317),V=o(69755),Z=o(16921),j=o(25743);function L(c,P){if(1&c&&(e.TgZ(0,"mat-option",14),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&c){const i=P.$implicit;e.Q6J("value",i.roleName),e.xp6(1),e.hij(" ",e.lcZ(2,2,i)," ")}}function Y(c,P){1&c&&e._UZ(0,"perun-web-apps-loading-table")}const X=function(){return["select","id","name","email","logins","organization"]};function H(c,P){if(1&c&&e._UZ(0,"app-users-list",17),2&c){const i=e.oxw(2);e.Q6J("disableRouting",!0)("selection",i.selection)("displayedColumns",e.DdM(5,X))("tableId",i.tableId)("users",i.users)}}function ae(c,P){if(1&c&&(e.TgZ(0,"div",15),e.YNc(1,H,1,6,"app-users-list",16),e.qZA()),2&c){const i=e.oxw(),h=e.MAs(24);e.xp6(1),e.Q6J("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",h)}}let R=(()=>{class c{constructor(i,h,d,$,ne,pe,de,Ee,be){this.dialogRef=i,this.data=h,this.authzService=d,this.usersService=$,this.translate=ne,this.notificator=pe,this.storeService=de,this.route=Ee,this.router=be,this.selection=new r.Ov(!0,[]),this.users=[],this.firstSearchDone=!1,this.tableId=b.H2,ne.get("DIALOGS.ADD_MANAGERS.TITLE").subscribe(me=>this.title=me),ne.get("DIALOGS.ADD_MANAGERS.SUCCESS").subscribe(me=>this.successMessage=me)}ngOnInit(){this.theme=this.data.theme,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.searchCtrl=new t.p4("",[t.kI.required,t.kI.pattern(".*[\\S]+.*")])}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.setRoleWithUserComplementaryObject({role:this.selectedRole,users:this.selection.selected.map(i=>i.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}onSearchByString(){if(this.searchCtrl.invalid)return void this.searchCtrl.markAllAsTouched();this.loading=!0,this.firstSearchDone=!0,this.selection.clear();let i=[s.r.USER_DEF_ORGANIZATION,s.r.USER_DEF_PREFERRED_MAIL];i=i.concat(this.storeService.getLoginAttributeNames()),this.usersService.findRichUsersWithAttributes(this.searchCtrl.value,i).subscribe({next:h=>{this.users=h,this.loading=!1},error:()=>this.loading=!1})}static#e=this.\u0275fac=function(h){return new(h||c)(e.Y36(E.so),e.Y36(E.WI),e.Y36(S.Ct),e.Y36(S.Fv),e.Y36(M.sK),e.Y36(n.V6),e.Y36(n.d6),e.Y36(K.gz),e.Y36(K.F0))};static#t=this.\u0275cmp=e.Xpm({type:c,selectors:[["app-add-manager-dialog"]],decls:33,vars:30,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"me-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"me-2","w-100"],["matInput","","autocomplete","false","data-cy","search-manager-input","perunWebAppsAutoFocus","",3,"formControl","keyup.enter"],["color","accent","data-cy","search-manager-button","mat-flat-button","",1,"ms-auto",3,"disabled","click"],["spinner",""],["class","position-relative mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","data-cy","add-manager-button-dialog","mat-flat-button","",1,"ms-2",3,"disabled","click"],[3,"value"],[1,"position-relative","mt-3"],[3,"disableRouting","selection","displayedColumns","tableId","users",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"disableRouting","selection","displayedColumns","tableId","users"]],template:function(h,d){1&h&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1)(5,"div",2)(6,"mat-form-field",3)(7,"mat-label"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"mat-select",4),e.NdJ("valueChange",function(ne){return d.selectedRole=ne}),e.YNc(11,L,3,4,"mat-option",5),e.qZA()(),e.TgZ(12,"mat-form-field",6)(13,"mat-label"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"input",7),e.NdJ("keyup.enter",function(){return d.onSearchByString()}),e.qZA(),e.TgZ(17,"mat-error"),e._uU(18),e.ALo(19,"translate"),e.qZA()()(),e.TgZ(20,"button",8),e.NdJ("click",function(){return d.onSearchByString()}),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.YNc(23,Y,1,0,"ng-template",null,9,e.W1O),e.YNc(25,ae,2,2,"div",10),e.qZA(),e.TgZ(26,"div",11)(27,"button",12),e.NdJ("click",function(){return d.onCancel()}),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"button",13),e.NdJ("click",function(){return d.onSubmit()}),e._uU(31),e.ALo(32,"translate"),e.qZA()()()),2&h&&(e.Tol(d.theme),e.xp6(2),e.Oqu(e.lcZ(3,16,"DIALOGS.ADD_MANAGERS.TITLE")),e.xp6(6),e.Oqu(e.lcZ(9,18,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",d.selectedRole),e.xp6(1),e.Q6J("ngForOf",d.availableRoles),e.xp6(3),e.Oqu(e.lcZ(15,20,"DIALOGS.ADD_MANAGERS.DESCRIPTION")),e.xp6(2),e.Q6J("formControl",d.searchCtrl),e.xp6(2),e.hij(" ",e.lcZ(19,22,"DIALOGS.ADD_MANAGERS.EMPTY_SEARCH_MESSAGE")," "),e.xp6(2),e.Q6J("disabled",d.loading),e.xp6(1),e.hij(" ",e.lcZ(22,24,"DIALOGS.ADD_MANAGERS.SEARCH")," "),e.xp6(4),e.Q6J("ngIf",d.firstSearchDone),e.xp6(3),e.hij(" ",e.lcZ(29,26,"DIALOGS.ADD_MANAGERS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",0===d.selection.selected.length||void 0===d.selectedRole||d.loading),e.xp6(1),e.hij(" ",e.lcZ(32,28,"DIALOGS.ADD_MANAGERS.CREATE")," "))},dependencies:[a.sg,a.O5,B.ey,F.Nt,C.KE,C.hX,C.TO,t.Fj,t.JJ,t.oH,y.lW,E.uh,E.xY,E.H8,w.gD,Q.K,I.h,V.e,Z.C,M.X$,j.i],styles:[".inline-dialog-items[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]})}return c})();var x=o(25313),p=o(11186),G=o(12207);function m(c,P){1&c&&e._UZ(0,"perun-web-apps-loading-dialog")}function N(c,P){1&c&&e._UZ(0,"th",15)}function U(c,P){if(1&c&&(e.TgZ(0,"td",16),e._uU(1),e.qZA()),2&c){const i=P.$implicit;e.xp6(1),e.AsE("",i.firstName," ",i.lastName,"")}}function ee(c,P){1&c&&e._UZ(0,"tr",17)}function oe(c,P){1&c&&e._UZ(0,"tr",18)}const le=function(c){return{role:c}};function ce(c,P){if(1&c&&(e.TgZ(0,"perun-web-apps-alert",19),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.qZA()),2&c){const i=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,"DIALOGS.REMOVE_MANAGERS.WARNING_REMOVE_YOURSELF",e.VKq(6,le,e.lcZ(3,4,"ROLES."+i.data.role)))," ")}}function _e(c,P){if(1&c){const i=e.EpF();e.TgZ(0,"div")(1,"h1",2),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",3)(5,"p"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div",4),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"table",5),e.ynx(12,6),e.YNc(13,N,1,0,"th",7),e.YNc(14,U,2,2,"td",8),e.BQk(),e.YNc(15,ee,1,0,"tr",9),e.YNc(16,oe,1,0,"tr",10),e.qZA(),e.YNc(17,ce,4,8,"perun-web-apps-alert",11),e.qZA(),e.TgZ(18,"div",12)(19,"button",13),e.NdJ("click",function(){e.CHM(i);const d=e.oxw();return e.KtG(d.onCancel())}),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"button",14),e.NdJ("click",function(){e.CHM(i);const d=e.oxw();return e.KtG(d.onSubmit())}),e._uU(23),e.ALo(24,"translate"),e.qZA()()()}if(2&c){const i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,10,"DIALOGS.REMOVE_MANAGERS.TITLE")),e.xp6(4),e.hij(" ",e.lcZ(7,12,"DIALOGS.REMOVE_MANAGERS.DESCRIPTION")," "),e.xp6(3),e.hij(" ",e.lcZ(10,14,"DIALOGS.REMOVE_MANAGERS.ASK")," "),e.xp6(2),e.Q6J("dataSource",i.dataSource),e.xp6(4),e.Q6J("matHeaderRowDef",i.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",i.displayedColumns),e.xp6(1),e.Q6J("ngIf",i.removeSelf),e.xp6(3),e.hij(" ",e.lcZ(21,16,"DIALOGS.REMOVE_MANAGERS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",i.loading),e.xp6(1),e.hij(" ",e.lcZ(24,18,"DIALOGS.REMOVE_MANAGERS.DELETE")," ")}}let f=(()=>{class c{constructor(i,h,d,$,ne,pe,de){this.dialogRef=i,this.data=h,this.notificator=d,this.translate=$,this.authzService=ne,this.store=pe,this.authService=de,this.displayedColumns=["name"]}ngOnInit(){this.dataSource=new x.by(this.data.managers),this.theme=this.data.theme,this.removeSelf=this.data.managers.map(i=>i.id).includes(this.store.getPerunPrincipal().userId)&&!this.authService.isPerunAdmin()}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithUserComplementaryObject({role:this.data.role,users:this.data.managers.map(i=>i.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_MANAGERS.SUCCESS").subscribe(i=>{this.notificator.showSuccess(i),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)},()=>this.loading=!1)}static#e=this.\u0275fac=function(h){return new(h||c)(e.Y36(E.so),e.Y36(E.WI),e.Y36(n.V6),e.Y36(M.sK),e.Y36(S.Ct),e.Y36(n.d6),e.Y36(n.x4))};static#t=this.\u0275cmp=e.Xpm({type:c,selectors:[["app-remove-manager-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","data-cy","remove-manager-button-dialog","mat-flat-button","",1,"ms-2",3,"disabled","click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""],["alert_type","warn"]],template:function(h,d){if(1&h&&(e.YNc(0,m,1,0,"ng-template",null,0,e.W1O),e.TgZ(2,"div"),e.YNc(3,_e,25,20,"div",1),e.qZA()),2&h){const $=e.MAs(1);e.xp6(2),e.Gre("",d.theme," position-relative"),e.xp6(1),e.Q6J("perunWebAppsLoader",d.loading)("perunWebAppsLoaderIndicator",$)}},dependencies:[a.O5,y.lW,x.BZ,x.fO,x.as,x.w1,x.Dz,x.nj,x.ge,x.ev,x.XQ,x.Gk,E.uh,E.xY,E.H8,p.w,G.b,V.e,M.X$]})}return c})();function q(c,P){1&c&&e._UZ(0,"perun-web-apps-loading-dialog")}function l(c,P){1&c&&e._UZ(0,"th",14)}function u(c,P){if(1&c&&(e.TgZ(0,"td",15),e._uU(1),e.qZA()),2&c){const i=P.$implicit;e.xp6(1),e.Oqu(i.name)}}function g(c,P){1&c&&e._UZ(0,"tr",16)}function A(c,P){1&c&&e._UZ(0,"tr",17)}function D(c,P){if(1&c){const i=e.EpF();e.TgZ(0,"div")(1,"h1",2),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",3)(5,"p"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div",4),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"table",5),e.ynx(12,6),e.YNc(13,l,1,0,"th",7),e.YNc(14,u,2,1,"td",8),e.BQk(),e.YNc(15,g,1,0,"tr",9),e.YNc(16,A,1,0,"tr",10),e.qZA()(),e.TgZ(17,"div",11)(18,"button",12),e.NdJ("click",function(){e.CHM(i);const d=e.oxw();return e.KtG(d.onCancel())}),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"button",13),e.NdJ("click",function(){e.CHM(i);const d=e.oxw();return e.KtG(d.onSubmit())}),e._uU(22),e.ALo(23,"translate"),e.qZA()()()}if(2&c){const i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,9,"DIALOGS.REMOVE_GROUPS.TITLE")),e.xp6(4),e.hij(" ",e.lcZ(7,11,"DIALOGS.REMOVE_GROUPS.DESCRIPTION")," "),e.xp6(3),e.hij(" ",e.lcZ(10,13,"DIALOGS.REMOVE_GROUPS.ASK")," "),e.xp6(2),e.Q6J("dataSource",i.dataSource),e.xp6(4),e.Q6J("matHeaderRowDef",i.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",i.displayedColumns),e.xp6(3),e.hij(" ",e.lcZ(20,15,"DIALOGS.REMOVE_GROUPS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",i.loading),e.xp6(1),e.hij(" ",e.lcZ(23,17,"DIALOGS.REMOVE_GROUPS.DELETE")," ")}}let J=(()=>{class c{constructor(i,h,d,$,ne){this.dialogRef=i,this.data=h,this.notificator=d,this.translate=$,this.authzService=ne,this.displayedColumns=["name"]}ngOnInit(){this.dataSource=new x.by(this.data.groups),this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithGroupComplementaryObject({role:this.data.role,authorizedGroups:this.data.groups.map(i=>i.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUPS.SUCCESS").subscribe(i=>{this.notificator.showSuccess(i),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)},()=>this.loading=!1)}static#e=this.\u0275fac=function(h){return new(h||c)(e.Y36(E.so),e.Y36(E.WI),e.Y36(n.V6),e.Y36(M.sK),e.Y36(S.Ct))};static#t=this.\u0275cmp=e.Xpm({type:c,selectors:[["app-remove-group-manager-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"disabled","click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(h,d){if(1&h&&(e.YNc(0,q,1,0,"ng-template",null,0,e.W1O),e.TgZ(2,"div"),e.YNc(3,D,24,19,"div",1),e.qZA()),2&h){const $=e.MAs(1);e.xp6(2),e.Gre("",d.theme," position-relative"),e.xp6(1),e.Q6J("perunWebAppsLoader",d.loading)("perunWebAppsLoaderIndicator",$)}},dependencies:[y.lW,x.BZ,x.fO,x.as,x.w1,x.Dz,x.nj,x.ge,x.ev,x.XQ,x.Gk,E.uh,E.xY,E.H8,G.b,V.e,M.X$]})}return c})();var te=o(27921),re=o(37398),T=o(24630),se=o(97500),_=o(2730);function O(c,P){if(1&c&&(e.TgZ(0,"mat-option",16),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&c){const i=P.$implicit;e.Q6J("value",i.roleName),e.xp6(1),e.hij(" ",e.lcZ(2,2,i)," ")}}function v(c,P){if(1&c&&(e.TgZ(0,"mat-option",16),e._uU(1),e.qZA()),2&c){const i=P.$implicit;e.Q6J("value",i),e.xp6(1),e.hij(" ",i.name," ")}}function k(c,P){if(1&c){const i=e.EpF();e.TgZ(0,"perun-web-apps-debounce-filter",17),e.NdJ("filter",function(d){e.CHM(i);const $=e.oxw();return e.KtG($.applyFilter(d))}),e.ALo(1,"translate"),e.qZA()}2&c&&e.s9C("placeholder",e.lcZ(1,1,"DIALOGS.ADD_GROUPS.FILTER_GROUPS"))}function z(c,P){1&c&&e._UZ(0,"perun-web-apps-loading-table")}const ue=function(){return["select","id","name","description"]};function ge(c,P){if(1&c&&e._UZ(0,"perun-web-apps-groups-list",20),2&c){const i=e.oxw(2);e.Q6J("disableMembers",!1)("disableRouting",!0)("displayedColumns",e.DdM(7,ue))("selection",i.selection)("groups",i.groups)("filter",i.filterValue)("tableId",i.tableId)}}function Ae(c,P){if(1&c&&(e.TgZ(0,"div",18),e.YNc(1,ge,1,8,"perun-web-apps-groups-list",19),e.qZA()),2&c){const i=e.oxw(),h=e.MAs(24);e.xp6(1),e.Q6J("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",h)}}let Re=(()=>{class c{constructor(i,h,d,$,ne,pe,de,Ee,be){this.dialogRef=i,this.data=h,this.authzService=d,this.voService=$,this.groupService=ne,this.translate=pe,this.notificator=de,this.route=Ee,this.router=be,this.searchString="",this.selection=new r.Ov(!0,[]),this.groups=[],this.vos=[],this.filterValue="",this.myControl=new t.p4,this.firstSearchDone=!1,this.tableId=b.kZ,pe.get("DIALOGS.ADD_GROUPS.TITLE").subscribe(me=>this.title=me),pe.get("DIALOGS.ADD_GROUPS.SUCCESS").subscribe(me=>this.successMessage=me)}displayFn(i){return i?i.name:null}onCancel(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.authzService.setRoleWithGroupComplementaryObject({role:this.selectedRole,authorizedGroups:this.selection.selected.map(i=>i.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}ngOnInit(){this.loading=!0,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.theme=this.data.theme,this.voService.getMyVos().subscribe({next:i=>{this.filteredOptions=this.myControl.valueChanges.pipe((0,te.O)(""),(0,re.U)(h=>this._filter(h))),this.vos=i,this.loading=!1},error:()=>this.loading=!1})}showVoGroups(i){this.loading=!0,this.firstSearchDone=!0,this.groupService.getAllGroups(i.option.value.id).subscribe({next:h=>{this.groups=h,this.loading=!1},error:()=>this.loading=!1})}applyFilter(i){this.filterValue=i}_filter(i){const h="string"==typeof i?i.toLowerCase():i.name.toLowerCase();return this.vos.filter(d=>d.name.toLowerCase().includes(h))}static#e=this.\u0275fac=function(h){return new(h||c)(e.Y36(E.so),e.Y36(E.WI),e.Y36(S.Ct),e.Y36(S.YF),e.Y36(S.ff),e.Y36(M.sK),e.Y36(n.V6),e.Y36(K.gz),e.Y36(K.F0))};static#t=this.\u0275cmp=e.Xpm({type:c,selectors:[["app-add-group-manager-dialog"]],decls:33,vars:32,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"me-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"me-2","w-75"],["aria-label","Assignee","matInput","","type","text",3,"formControl","matAutocomplete","placeholder"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"placeholder","filter",4,"ngIf"],["spinner",""],["class","position-relative mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"disabled","click"],[3,"value"],[3,"placeholder","filter"],[1,"position-relative","mt-3"],[3,"disableMembers","disableRouting","displayedColumns","selection","groups","filter","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"disableMembers","disableRouting","displayedColumns","selection","groups","filter","tableId"]],template:function(h,d){if(1&h&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1)(5,"div",2)(6,"mat-form-field",3)(7,"mat-label"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"mat-select",4),e.NdJ("valueChange",function(ne){return d.selectedRole=ne}),e.YNc(11,O,3,4,"mat-option",5),e.qZA()(),e.TgZ(12,"mat-form-field",6)(13,"mat-label"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e._UZ(16,"input",7),e.ALo(17,"translate"),e.TgZ(18,"mat-autocomplete",8,9),e.NdJ("optionSelected",function(ne){return d.showVoGroups(ne)}),e.YNc(20,v,2,2,"mat-option",5),e.ALo(21,"async"),e.qZA()()(),e.YNc(22,k,2,3,"perun-web-apps-debounce-filter",10),e.YNc(23,z,1,0,"ng-template",null,11,e.W1O),e.YNc(25,Ae,2,2,"div",12),e.qZA(),e.TgZ(26,"div",13)(27,"button",14),e.NdJ("click",function(){return d.onCancel()}),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"button",15),e.NdJ("click",function(){return d.onSubmit()}),e._uU(31),e.ALo(32,"translate"),e.qZA()()()),2&h){const $=e.MAs(19);e.Tol(d.theme),e.xp6(2),e.Oqu(e.lcZ(3,18,"DIALOGS.ADD_GROUPS.TITLE")),e.xp6(6),e.Oqu(e.lcZ(9,20,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",d.selectedRole),e.xp6(1),e.Q6J("ngForOf",d.availableRoles),e.xp6(3),e.Oqu(e.lcZ(15,22,"DIALOGS.ADD_GROUPS.SELECT_VO")),e.xp6(2),e.s9C("placeholder",e.lcZ(17,24,"DIALOGS.ADD_GROUPS.SELECT_VO")),e.Q6J("formControl",d.myControl)("matAutocomplete",$),e.xp6(2),e.Q6J("displayWith",d.displayFn),e.xp6(2),e.Q6J("ngForOf",e.lcZ(21,26,d.filteredOptions)),e.xp6(2),e.Q6J("ngIf",null!==d.groups&&d.groups.length>0&&!d.loading),e.xp6(3),e.Q6J("ngIf",d.firstSearchDone),e.xp6(3),e.hij(" ",e.lcZ(29,28,"DIALOGS.ADD_MANAGERS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",0===d.selection.selected.length||d.loading),e.xp6(1),e.hij(" ",e.lcZ(32,30,"DIALOGS.ADD_MANAGERS.CREATE")," ")}},dependencies:[a.sg,a.O5,T.XC,B.ey,T.ZL,F.Nt,C.KE,C.hX,t.Fj,t.JJ,t.oH,y.lW,E.uh,E.xY,E.H8,w.gD,Q.K,se.W,_.P,V.e,a.Ov,M.X$,j.i]})}return c})();var he=o(64124),Te=o(9769),ve=o(99397),Ce=o(62023),fe=o(74104),Se=o(75986),Oe=o(62481);function Ie(c,P){1&c&&(e._uU(0),e.ALo(1,"translate")),2&c&&e.hij(" ",e.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.USER")," ")}function De(c,P){if(1&c){const i=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(i);const d=e.oxw(2);return e.KtG(d.addManager())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&c&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function Me(c,P){if(1&c){const i=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(i);const d=e.oxw(2);return e.KtG(d.removeManager())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&c){const i=e.oxw(2);e.Q6J("disabled",0===i.selectionUsers.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function xe(c,P){if(1&c&&(e.TgZ(0,"mat-option",16),e.ALo(1,"lowercase"),e._uU(2),e.ALo(3,"displayedRole"),e.qZA()),2&c){const i=P.$implicit;e.Q6J("value",i.roleName),e.uIk("data-cy",e.lcZ(1,3,i.roleName)),e.xp6(2),e.hij(" ",e.lcZ(3,5,i)," ")}}function Le(c,P){if(1&c){const i=e.EpF();e.TgZ(0,"mat-checkbox",17),e.NdJ("change",function(){e.CHM(i);const d=e.oxw(2);return d.showIndirectAdmins=!d.showIndirectAdmins,e.KtG(d.refreshUsers())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&c){const i=e.oxw(2);e.Q6J("checked",i.showIndirectAdmins),e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.SHOW_INDIRECT_ADMINS")," ")}}function Ze(c,P){1&c&&e._UZ(0,"perun-web-apps-loading-table")}function Ue(c,P){if(1&c&&e._UZ(0,"app-users-list",20),2&c){const i=e.oxw(3);e.Q6J("disableSelf",i.disableSelf)("directAdmins",i.directAdminsIds)("tableId",i.tableId)("disableRouting",!i.routeAuth||i.disableRouting)("displayedColumns",i.displayedUserColumns)("selection",i.selectionUsers)("users",i.managers)}}function ye(c,P){if(1&c&&(e.TgZ(0,"div",18),e.YNc(1,Ue,1,7,"app-users-list",19),e.qZA()),2&c){e.oxw();const i=e.MAs(11),h=e.oxw();e.xp6(1),e.Q6J("perunWebAppsLoader",h.loading)("perunWebAppsLoaderIndicator",i)}}function Ge(c,P){if(1&c){const i=e.EpF();e.TgZ(0,"perun-web-apps-refresh-button",5),e.NdJ("refresh",function(){e.CHM(i);const d=e.oxw();return e.KtG(d.refreshUsers())}),e.qZA(),e.YNc(1,De,3,3,"button",6),e.YNc(2,Me,3,4,"button",7),e.TgZ(3,"mat-form-field",8)(4,"mat-label"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"mat-select",9),e.NdJ("selectionChange",function(){e.CHM(i);const d=e.oxw();return e.KtG(d.refreshUsers(!0))})("valueChange",function(d){e.CHM(i);const $=e.oxw();return e.KtG($.selectedRole=d)}),e.YNc(8,xe,4,7,"mat-option",10),e.qZA()(),e.YNc(9,Le,3,4,"mat-checkbox",11),e.YNc(10,Ze,1,0,"ng-template",null,12,e.W1O),e.YNc(12,ye,2,2,"div",13)}if(2&c){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.manageAuth&&!i.configMode),e.xp6(1),e.Q6J("ngIf",i.manageAuth&&!i.configMode),e.xp6(3),e.Oqu(e.lcZ(6,7,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",i.selectedRole),e.xp6(1),e.Q6J("ngForOf",i.availableRoles),e.xp6(1),e.Q6J("ngIf",i.complementaryObject.beanName.includes("Group")),e.xp6(3),e.Q6J("ngIf",i.managers)}}function Ne(c,P){1&c&&(e._uU(0),e.ALo(1,"translate")),2&c&&e.hij(" ",e.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.GROUP")," ")}function Pe(c,P){if(1&c){const i=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(i);const d=e.oxw(2);return e.KtG(d.addGroup())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&c&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function Ye(c,P){if(1&c){const i=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){e.CHM(i);const d=e.oxw(2);return e.KtG(d.removeGroup())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&c){const i=e.oxw(2);e.Q6J("disabled",0===i.selectionGroups.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function we(c,P){if(1&c&&(e.TgZ(0,"mat-option",16),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&c){const i=P.$implicit;e.Q6J("value",i.roleName),e.xp6(1),e.Oqu(e.lcZ(2,2,i))}}function Je(c,P){1&c&&e._UZ(0,"perun-web-apps-loading-table")}function Be(c,P){if(1&c&&e._UZ(0,"perun-web-apps-groups-list",27),2&c){const i=e.oxw(3);e.Q6J("disableMembers",!1)("disableRouting",i.disableRouting)("displayedColumns",i.displayedGroupColumns)("groups",i.groups)("selection",i.selectionGroups)("tableId",i.tableId)}}function We(c,P){if(1&c&&(e.TgZ(0,"div",18),e.YNc(1,Be,1,6,"perun-web-apps-groups-list",26),e.qZA()),2&c){e.oxw();const i=e.MAs(10),h=e.oxw();e.xp6(1),e.Q6J("perunWebAppsLoader",h.loading)("perunWebAppsLoaderIndicator",i)}}function Ke(c,P){if(1&c){const i=e.EpF();e.TgZ(0,"perun-web-apps-refresh-button",5),e.NdJ("refresh",function(){e.CHM(i);const d=e.oxw();return e.KtG(d.refreshGroups())}),e.qZA(),e.YNc(1,Pe,3,3,"button",21),e.YNc(2,Ye,3,4,"button",22),e.TgZ(3,"mat-form-field",23)(4,"mat-label"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"mat-select",9),e.NdJ("selectionChange",function(){e.CHM(i);const d=e.oxw();return e.KtG(d.refreshGroups())})("valueChange",function(d){e.CHM(i);const $=e.oxw();return e.KtG($.selectedRole=d)}),e.YNc(8,we,3,4,"mat-option",10),e.qZA()(),e.YNc(9,Je,1,0,"ng-template",null,12,e.W1O),e.YNc(11,We,2,2,"div",13)}if(2&c){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.manageAuth&&!i.configMode),e.xp6(1),e.Q6J("ngIf",i.manageAuth&&!i.configMode),e.xp6(3),e.Oqu(e.lcZ(6,6,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",i.selectedRole),e.xp6(1),e.Q6J("ngForOf",i.availableRoles),e.xp6(3),e.Q6J("ngIf",i.groups)}}function Fe(c,P){1&c&&(e.TgZ(0,"perun-web-apps-alert",28),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&c&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.NO_AVAILABLE_ROLES"),"\n"))}let Qe=(()=>{class c{constructor(i,h,d,$,ne,pe,de){this.dialog=i,this.authzService=h,this.storeService=d,this.guiAuthResolver=$,this.router=ne,this.reloadEntityDetail=pe,this.route=de,this.configMode=!1,this.disableRouting=!1,this.disableSelf=!1,this.displayedUserColumns=["select","id","name","email","logins","organization"],this.displayedGroupColumns=["select","id","vo","name","description"],this.groups=[],this.managers=null,this.managers$=null,this.selectionUsers=new r.Ov(!0,[]),this.selectionGroups=new r.Ov(!0,[]),this.selectedMode="",this.showIndirectAdmins=!1,this.directAdminsIds=null,this.loading=!1,this.tableId=b.HC,this.availableRolesPrivileges=new Map}ngOnInit(){this.loading=!0,this.routeAuth=this.guiAuthResolver.isPerunAdminOrObserver(),this.guiAuthResolver.setRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(i=>this.availableRolesPrivileges.get(i.roleName).readAuth),0!==this.availableRoles.length&&(this.selectedRole=this.availableRoles[0].roleName),this.refreshUsers()}changeRolePrivileges(){this.guiAuthResolver.setRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(h=>this.availableRolesPrivileges.get(h.roleName).readAuth),this.manageAuth=this.availableRolesPrivileges.get(this.selectedRole).manageAuth,this.displayedUserColumns=this.manageAuth?this.displayedUserColumns:this.displayedUserColumns.filter(h=>"select"!==h),this.displayedGroupColumns=this.manageAuth?this.displayedGroupColumns:this.displayedGroupColumns.filter(h=>"select"!==h),this.roleModes=this.availableRolesPrivileges.get(this.selectedRole).modes;let i=!1;for(const h of this.roleModes)if(this.selectedMode===h.toLowerCase()){i=!0;break}i||(this.selectedMode=this.roleModes[0].toLowerCase())}tabChanged(i){this.loading=!0,0===i.index?(this.selectedMode="user",this.refreshUsers()):(this.selectedMode="group",this.refreshGroups())}refreshUsers(i=!1){this.loading=!0,this.changeRolePrivileges();let h=[s.r.USER_DEF_ORGANIZATION,s.r.USER_DEF_PREFERRED_MAIL];h=h.concat(this.storeService.getLoginAttributeNames()),this.managers$=this.showIndirectAdmins?i?this.getDirectAdmins(h).pipe((0,Te.z)(()=>this.getIndirectAdmins(h))):this.getIndirectAdmins(h):this.getDirectAdmins(h),this.managers$.subscribe({next:d=>{this.managers=d,this.selectionUsers.clear(),this.loading=!1},error:()=>{this.loading=!1}})}getDirectAdmins(i){return this.authzService.getAuthzRichAdmins(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType,i,!1,!0).pipe((0,ve.b)(h=>this.directAdminsIds=h.map(d=>d.id)))}getIndirectAdmins(i){return this.loading=!0,this.authzService.getAuthzRichAdmins(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType,i,!1,!1)}refreshGroups(){this.loading=!0,this.changeRolePrivileges(),this.authzService.getAuthzAdminGroups(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType).subscribe({next:i=>{this.groups=i,this.selectionGroups.clear(),this.loading=!1},error:()=>{this.loading=!1}})}addManager(){const i=(0,he.kZ)();i.width="1000px",i.data={complementaryObject:this.complementaryObject,theme:this.theme,availableRoles:this.availableRoles,selectedRole:this.selectedRole},this.dialog.open(R,i).afterClosed().subscribe(d=>{d&&this.refreshUsers(!0)})}removeManager(){const i=(0,he.kZ)();i.width="450px",i.data={managers:this.selectionUsers.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(f,i).afterClosed().subscribe(d=>{d&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?this.reloadEntityDetail.reloadEntityDetail():this.redirectToAuthRoute())})}removeGroup(){const i=(0,he.kZ)();i.width="450px",i.data={groups:this.selectionGroups.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(J,i).afterClosed().subscribe(d=>{d&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?this.refreshGroups():this.redirectToAuthRoute())})}addGroup(){const i=(0,he.kZ)();i.width="1000px",i.data={complementaryObject:this.complementaryObject,availableRoles:this.availableRoles,theme:this.theme,selectedRole:this.selectedRole},this.dialog.open(Re,i).afterClosed().subscribe(d=>{d&&this.refreshGroups()})}redirectToAuthRoute(){if("Group"===this.complementaryObjectType&&(this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])||this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])))this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])?this.router.navigate(["/organizations",this.complementaryObject.voId,"groups",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"}):this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])&&this.router.navigate(["/organizations",this.complementaryObject.voId],{queryParamsHandling:"merge"});else if("Facility"===this.complementaryObjectType&&this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.complementaryObject]))this.router.navigate(["/facilities",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else if("Vo"===this.complementaryObjectType&&this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject]))this.router.navigate(["/organizations",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else{if("Resource"!==this.complementaryObjectType||!this.guiAuthResolver.isAuthorized("getRichResourceById_int_policy",[this.complementaryObject]))return void this.router.navigate(["/home"],{queryParamsHandling:"merge"});this.router.navigate(["../../"],{relativeTo:this.route,queryParamsHandling:"merge"})}this.reloadEntityDetail.reloadEntityDetail()}static#e=this.\u0275fac=function(h){return new(h||c)(e.Y36(E.uw),e.Y36(S.Ct),e.Y36(n.d6),e.Y36(n.x4),e.Y36(K.F0),e.Y36(Ce.G),e.Y36(K.gz))};static#t=this.\u0275cmp=e.Xpm({type:c,selectors:[["app-managers-page"]],hostVars:2,hostBindings:function(h,d){2&h&&e.ekj("router-component",d.true)},inputs:{complementaryObject:"complementaryObject",availableRoles:"availableRoles",complementaryObjectType:"complementaryObjectType",theme:"theme",configMode:"configMode",disableRouting:"disableRouting",disableSelf:"disableSelf",displayedUserColumns:"displayedUserColumns",displayedGroupColumns:"displayedGroupColumns"},decls:11,vars:4,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false",3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["alert_type","warn",4,"ngIf"],[1,"mt-2",3,"refresh"],["color","accent","class","me-2 action-button","data-cy","add-manager-button","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","data-cy","remove-manager-button","class","me-2","mat-flat-button","",3,"disabled","click",4,"ngIf"],["data-cy","role-filter",1,"me-2","mt-2"],[3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],["color","primary",3,"checked","change",4,"ngIf"],["spinner",""],["class","position-relative",4,"ngIf"],["color","accent","data-cy","add-manager-button","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","data-cy","remove-manager-button","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"value"],["color","primary",3,"checked","change"],[1,"position-relative"],[3,"disableSelf","directAdmins","tableId","disableRouting","displayedColumns","selection","users",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"disableSelf","directAdmins","tableId","disableRouting","displayedColumns","selection","users"],["color","accent","class","me-2 action-button","mat-flat-button","",3,"click",4,"ngIf"],["class","me-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[1,"me-2","mt-2"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"disableMembers","disableRouting","displayedColumns","groups","selection","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"disableMembers","disableRouting","displayedColumns","groups","selection","tableId"],["alert_type","warn"]],template:function(h,d){1&h&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"mat-tab-group",1),e.NdJ("selectedTabChange",function(ne){return d.tabChanged(ne)}),e.TgZ(4,"mat-tab"),e.YNc(5,Ie,2,3,"ng-template",2),e.YNc(6,Ge,13,9,"ng-template",3),e.qZA(),e.TgZ(7,"mat-tab"),e.YNc(8,Ne,2,3,"ng-template",2),e.YNc(9,Ke,12,8,"ng-template",3),e.qZA()(),e.YNc(10,Fe,3,3,"perun-web-apps-alert",4)),2&h&&(e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.TITLE"),"\n"),e.xp6(9),e.Q6J("ngIf",0===d.availableRoles.length))},dependencies:[a.sg,a.O5,B.ey,C.KE,C.hX,y.lW,fe.Vc,fe.uD,fe.uX,fe.SP,Se.oG,w.gD,p.w,Q.K,se.W,Oe.t,V.e,Z.C,a.i8,M.X$,j.i]})}return c})()},26946:(ie,W,o)=>{o.d(W,{o:()=>l});var r=o(13566),E=o(25313),n=o(78337),S=o(73615),b=o(87824),s=o(64124),t=o(65879),e=o(71365),M=o(96814),K=o(24516),a=o(64170),B=o(56223),F=o(30617),C=o(32296),y=o(75986),w=o(92596),Q=o(11186),I=o(77983),V=o(93035),Z=o(32596),j=o(8355);function L(u,g){if(1&u){const A=t.EpF();t.TgZ(0,"th",17)(1,"mat-checkbox",18),t.NdJ("change",function(J){t.CHM(A);const te=t.oxw(2);return t.KtG(J?te.masterToggle():null)}),t.ALo(2,"translate"),t.ALo(3,"masterCheckboxLabel"),t.qZA()()}if(2&u){const A=t.oxw().ngIf,D=t.oxw();t.xp6(1),t.Q6J("aria-label",t.lcZ(2,3,t.lcZ(3,5,A.all)))("checked",D.selection.hasValue()&&A.all)("indeterminate",D.selection.hasValue()&&!A.all)}}const Y=function(u){return{name:u}};function X(u,g){if(1&u){const A=t.EpF();t.TgZ(0,"td",19)(1,"mat-checkbox",20),t.NdJ("change",function(J){const re=t.CHM(A).$implicit,T=t.oxw(2);return t.KtG(J?T.selection.toggle(re):null)})("click",function(J){return J.stopPropagation()}),t.ALo(2,"translate"),t.ALo(3,"checkboxLabel"),t.qZA()()}if(2&u){const A=g.$implicit,D=t.oxw(2);t.xp6(1),t.Q6J("aria-label",t.xi3(2,2,t.lcZ(3,5,D.selection.isSelected(A)),t.VKq(7,Y,A.tagName)))("checked",D.selection.isSelected(A))}}function H(u,g){1&u&&(t.ynx(0,14),t.YNc(1,L,4,7,"th",15),t.YNc(2,X,4,9,"td",16),t.BQk())}function ae(u,g){1&u&&(t.TgZ(0,"th",21),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&u&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_ID")," "))}function R(u,g){if(1&u&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&u){const A=g.$implicit;t.xp6(1),t.Oqu(A.id)}}function x(u,g){1&u&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&u&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_NAME")," "))}function p(u,g){if(1&u&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&u){const A=t.oxw().$implicit;t.xp6(1),t.hij(" ",A.tagName," ")}}function G(u,g){if(1&u){const A=t.EpF();t.TgZ(0,"div")(1,"mat-form-field",26)(2,"input",27),t.NdJ("ngModelChange",function(J){t.CHM(A);const te=t.oxw().$implicit;return t.KtG(te.tagName=J)}),t.ALo(3,"translate"),t.qZA()()()}if(2&u){const A=t.oxw().$implicit;t.xp6(2),t.s9C("placeholder",t.lcZ(3,2,"VO_DETAIL.RESOURCES.TAGS.CHANGE_TAG_NAME")),t.Q6J("ngModel",A.tagName)}}function m(u,g){if(1&u&&(t.TgZ(0,"td",24),t.YNc(1,p,2,1,"div",25),t.YNc(2,G,4,4,"div",25),t.qZA()),2&u){const A=g.$implicit,D=t.oxw();t.xp6(1),t.Q6J("ngIf",!D.isChanging.isSelected(A)),t.xp6(1),t.Q6J("ngIf",D.isChanging.isSelected(A))}}function N(u,g){1&u&&t._UZ(0,"th",23)}function U(u,g){if(1&u){const A=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(A);const J=t.oxw().$implicit,te=t.oxw();return t.KtG(te.edit(J))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()()}2&u&&t.s9C("matTooltip",t.lcZ(1,1,"VO_DETAIL.RESOURCES.TAGS.EDIT_BUTTON"))}function ee(u,g){if(1&u){const A=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(A);const J=t.oxw().$implicit,te=t.oxw();return t.KtG(te.save(J))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"save"),t.qZA()()}2&u&&t.s9C("matTooltip",t.lcZ(1,1,"VO_DETAIL.RESOURCES.TAGS.SAVE_BUTTON"))}function oe(u,g){if(1&u&&(t.TgZ(0,"td",24)(1,"div",28),t.YNc(2,U,4,3,"button",29),t.YNc(3,ee,4,3,"button",29),t.qZA()()),2&u){const A=g.$implicit,D=t.oxw();t.xp6(2),t.Q6J("ngIf",!D.isChanging.isSelected(A)),t.xp6(1),t.Q6J("ngIf",D.isChanging.isSelected(A))}}function le(u,g){1&u&&t._UZ(0,"tr",31)}function ce(u,g){1&u&&t._UZ(0,"tr",32)}function _e(u,g){if(1&u&&(t.TgZ(0,"perun-web-apps-alert",33),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&u){const A=t.oxw();t.xp6(1),t.hij(" ","vo"===A.entity?t.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.NO_TAGS"):t.lcZ(3,3,"RESOURCE_DETAIL.TAGS.NO_TAGS"),"\n")}}function f(u,g){1&u&&(t.TgZ(0,"perun-web-apps-alert",33),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&u&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}const q=function(u){return{all:u}};let l=(()=>{class u{constructor(A,D,J,te,re){this.resourceManager=A,this.notificator=D,this.translator=J,this.authResolver=te,this.tableCheckbox=re,this.resourceTags=[],this.selection=new n.Ov(!0,[]),this.displayedColumns=["select","id","name","edit"],this.isChanging=new n.Ov(!0,[]),this.pageSizeOptions=s.f7}set matSort(A){this.sort=A,this.setDataSource()}static getDataForColumn(A,D){switch(D){case"id":return A.id.toString();case"name":return A.tagName;default:return""}}ngOnChanges(){this.authResolver.isPerunAdminOrObserver()||(this.displayedColumns=this.displayedColumns.filter(A=>"id"!==A)),this.dataSource=new E.by(this.resourceTags),this.setDataSource()}ngAfterViewInit(){this.dataSource.paginator=this.child.paginator}exportAllData(A){(0,s.O6)((0,s.Xn)(this.dataSource.filteredData,this.displayedColumns,u.getDataForColumn),A)}exportDisplayedData(A){const D=this.dataSource.paginator.pageIndex*this.dataSource.paginator.pageSize,J=D+this.dataSource.paginator.pageSize;(0,s.O6)((0,s.Xn)(this.dataSource.sortData(this.dataSource.filteredData,this.dataSource.sort).slice(D,J),this.displayedColumns,u.getDataForColumn),A)}setDataSource(){this.dataSource&&(this.dataSource.filterPredicate=(A,D)=>(0,s.Sd)(A,D,this.displayedColumns,u.getDataForColumn),this.dataSource.sortData=(A,D)=>(0,s.pR)(A,D,u.getDataForColumn),this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue)}isAllSelected(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.dataSource)}masterToggle(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}save(A){this.resourceManager.updateResourceTag({resourceTag:A}).subscribe(()=>{this.translator.get("SHARED.COMPONENTS.RESOURCES_TAGS_LIST.EDIT_SUCCESS").subscribe(D=>{this.notificator.showSuccess(D)}),this.isChanging.deselect(A)})}edit(A){this.isChanging.select(A)}static#e=this.\u0275fac=function(D){return new(D||u)(t.Y36(b.xk),t.Y36(S.V6),t.Y36(e.sK),t.Y36(S.x4),t.Y36(S.UA))};static#t=this.\u0275cmp=t.Xpm({type:u,selectors:[["app-resources-tags-list"]],viewQuery:function(D,J){if(1&D&&(t.Gf(s.l9,7),t.Gf(r.YE,7)),2&D){let te;t.iGM(te=t.CRH())&&(J.child=te.first),t.iGM(te=t.CRH())&&(J.matSort=te.first)}},inputs:{resourceTags:"resourceTags",filterValue:"filterValue",selection:"selection",tableId:"tableId",displayedColumns:"displayedColumns",entity:"entity"},features:[t.TTD],decls:18,vars:15,consts:[[1,"card","mt-2",3,"hidden"],[3,"pageSizeOptions","dataLength","tableId","exportDisplayedData","exportAllData"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select",4,"ngIf"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","edit"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["matColumnDef","select"],["class","align-checkbox","mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size align-checkbox","mat-cell","",4,"matCellDef"],["mat-header-cell","",1,"align-checkbox"],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size","align-checkbox"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"static-column-size"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],["subscriptSizing","dynamic"],["matInput","",3,"ngModel","placeholder","ngModelChange"],[1,"d-flex","justify-content-end"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","",3,"matTooltip","click"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"],["alert_type","warn"]],template:function(D,J){1&D&&(t.TgZ(0,"div",0)(1,"perun-web-apps-table-wrapper",1),t.NdJ("exportDisplayedData",function(re){return J.exportDisplayedData(re)})("exportAllData",function(re){return J.exportAllData(re)}),t.TgZ(2,"table",2),t.YNc(3,H,3,0,"ng-container",3),t.ALo(4,"isAllSelected"),t.ynx(5,4),t.YNc(6,ae,3,3,"th",5),t.YNc(7,R,2,1,"td",6),t.BQk(),t.ynx(8,7),t.YNc(9,x,3,3,"th",8),t.YNc(10,m,3,2,"td",9),t.BQk(),t.ynx(11,10),t.YNc(12,N,1,0,"th",8),t.YNc(13,oe,4,2,"td",9),t.BQk(),t.YNc(14,le,1,0,"tr",11),t.YNc(15,ce,1,0,"tr",12),t.qZA()()(),t.YNc(16,_e,4,5,"perun-web-apps-alert",13),t.YNc(17,f,3,3,"perun-web-apps-alert",13)),2&D&&(t.Q6J("hidden",0===J.resourceTags.length||0===J.dataSource.filteredData.length),t.xp6(1),t.Q6J("pageSizeOptions",J.pageSizeOptions)("dataLength",J.dataSource.filteredData.length)("tableId",J.tableId),t.xp6(1),t.Q6J("dataSource",J.dataSource),t.xp6(1),t.Q6J("ngIf",t.VKq(13,q,t.xi3(4,10,J.dataSource,J.selection.selected.length))),t.xp6(11),t.Q6J("matHeaderRowDef",J.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",J.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===J.resourceTags.length),t.xp6(1),t.Q6J("ngIf",0===J.dataSource.filteredData.length&&0!==J.resourceTags.length))},dependencies:[M.O5,K.Nt,a.KE,B.Fj,B.JJ,B.On,F.Hw,C.RK,r.YE,r.nU,E.BZ,E.fO,E.as,E.w1,E.Dz,E.nj,E.ge,E.ev,E.XQ,E.Gk,y.oG,w.gM,Q.w,I.l,e.X$,V.I,Z.G,j.r]})}return u})()},56684:(ie,W,o)=>{o.d(W,{T:()=>E});var r=o(78645);const E=(n=class{})=>class extends n{constructor(){super(...arguments),this.destroyed$=new r.x}ngOnDestroy(){this.destroyed$.next()}}},52839:(ie,W,o)=>{o.d(W,{F:()=>S});var r=o(65879),E=o(4675),n=o(71365);let S=(()=>{class b{constructor(){this.servicePackages=[],this.selectedPackage=null,this.multiple=!1,this.disableAutoSelect=!1,this.theme="",this.packageSelected=new r.vpe,this.nameFunction=t=>t.name,this.shortNameFunction=t=>t.description,this.searchFunction=t=>t.name+t.description}static#e=this.\u0275fac=function(e){return new(e||b)};static#t=this.\u0275cmp=r.Xpm({type:b,selectors:[["perun-web-apps-service-package-search-select"]],inputs:{servicePackages:"servicePackages",selectedPackage:"selectedPackage",multiple:"multiple",disableAutoSelect:"disableAutoSelect",theme:"theme"},outputs:{packageSelected:"packageSelected"},decls:4,vars:17,consts:[[3,"entities","entity","multiple","disableAutoSelect","searchFunction","mainTextFunction","secondaryTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","theme","entitySelected"]],template:function(e,M){1&e&&(r.TgZ(0,"perun-web-apps-entity-search-select",0),r.NdJ("entitySelected",function(a){return M.packageSelected.emit(a)}),r.ALo(1,"translate"),r.ALo(2,"translate"),r.ALo(3,"translate"),r.qZA()),2&e&&r.Q6J("entities",M.servicePackages)("entity",M.selectedPackage)("multiple",M.multiple)("disableAutoSelect",M.disableAutoSelect)("searchFunction",M.searchFunction)("mainTextFunction",M.nameFunction)("secondaryTextFunction",M.shortNameFunction)("selectPlaceholder",r.lcZ(1,11,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.SELECT_PACKAGE"))("findPlaceholder",r.lcZ(2,13,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.FIND_PACKAGE"))("noEntriesText",r.lcZ(3,15,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.NO_PACKAGE_FOUND"))("theme",M.theme)},dependencies:[E.i,n.X$]})}return b})()},33317:(ie,W,o)=>{o.d(W,{h:()=>E});var r=o(65879);let E=(()=>{class n{constructor(b){this.elementRef=b}ngOnInit(){this.elementRef.nativeElement.focus()}static#e=this.\u0275fac=function(s){return new(s||n)(r.Y36(r.SBq))};static#t=this.\u0275dir=r.lG2({type:n,selectors:[["","perunWebAppsAutoFocus",""]]})}return n})()}}]);