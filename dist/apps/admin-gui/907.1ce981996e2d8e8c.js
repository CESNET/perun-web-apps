"use strict";(self.webpackChunkadmin_gui=self.webpackChunkadmin_gui||[]).push([[907],{15003:(te,k,o)=>{o.d(k,{G:()=>f});var a=o(94650);class f{constructor(){this.entityDetailChange=new a.vpe}reloadEntityDetail(){this.entityDetailChange.emit()}}f.\u0275fac=function(E){return new(E||f)},f.\u0275prov=a.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"})},76023:(te,k,o)=>{o.d(k,{y:()=>q});var a=o(61744),f=o(15466),n=o(95243),E=o(22395),C=o(24006),s=o(95017),t=o(94650),e=o(82761),K=o(36895),P=o(3238),x=o(59549),D=o(84385),i=o(68530),B=o(96214),F=o(38383),N=o(64901),j=o(73358),L=o(89383),y=o(67955);function I(ee,W){if(1&ee&&(t.TgZ(0,"mat-option",10),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&ee){const v=W.$implicit;t.Q6J("value",v),t.xp6(1),t.hij(" ",t.lcZ(2,2,"CONSENTS.STATUS_"+v)," ")}}function z(ee,W){if(1&ee){const v=t.EpF();t.TgZ(0,"mat-form-field",7)(1,"mat-label"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"mat-select",8),t.NdJ("closed",function(){t.CHM(v);const A=t.oxw();return t.KtG(A.changeConsentStatuses())}),t.TgZ(5,"mat-select-trigger"),t._uU(6),t.ALo(7,"selectedConsentStatuses"),t.qZA(),t.YNc(8,I,3,4,"mat-option",9),t.qZA()()}if(2&ee){const v=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,4,"RESOURCE_DETAIL.ASSIGNED_MEMBERS.FILTER_CONSENT_STATUS")),t.xp6(2),t.Q6J("formControl",v.consentStatuses),t.xp6(2),t.hij(" ",t.Dn7(7,6,v.selectedConsentStatuses,v.consentStatusList,v.consentStatuses.value)," "),t.xp6(2),t.Q6J("ngForOf",v.consentStatusList)}}function M(ee,W){1&ee&&t._UZ(0,"perun-web-apps-loading-table")}function w(ee,W){if(1&ee){const v=t.EpF();t.TgZ(0,"perun-web-apps-members-list",11),t.NdJ("updateTable",function(){t.CHM(v);const A=t.oxw();return t.KtG(A.refreshTable())}),t.qZA()}if(2&ee){const v=t.oxw();t.Q6J("displayedColumns",v.columns)("disableRouting",!v.routeAuth)("filter",v.filterValue)("members",v.members)("tableId",v.tableId)}}class q{constructor(W,v,g,A,R,S,Q){this.route=W,this.resourceService=v,this.authResolver=g,this.entityStorageService=A,this.storeService=R,this.consentService=S,this.consentStatusPipe=Q,this.loading=!1,this.filterValue="",this.tableId=f.iQ,this.members=[],this.columns=["id","fullName"],this.includeConsents=!1,this.consents=[],this.consentStatuses=new C.NI,this.consentStatusList=["UNSIGNED","GRANTED","REVOKED"],this.selectedConsentStatuses=[],this.selection=new s.Ov(!0,[])}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.resourceService.getAssignedRichMembers(this.resource.id).subscribe(W=>{this.setAuthRights(W),this.consentService.getConsentHubByResource(this.resource.id).subscribe(v=>{this.includeConsents=this.storeService.getProperty("enforce_consents")&&v.enforceConsents,this.includeConsents?(this.columns=["id","fullName","consentStatus"],this.consentService.getConsentsForConsentHubByResource(this.resource.id).subscribe(g=>{this.consents=g,this.members=this.getConsentsForMembers(W).filter(A=>!this.selectedConsentStatuses||0===this.selectedConsentStatuses.length||this.selectedConsentStatuses.includes(A.consent))})):this.members=W,this.loading=!1})})}setAuthRights(W){0!==W.length&&(this.routeAuth=this.authResolver.isAuthorized("getMemberById_int_policy",[W[0]]))}applyFilter(W){this.filterValue=W}getConsentsForMembers(W){const v=[];return W.forEach(g=>{const A=g;A.consent=this.consentStatusPipe.transform(g.userId,this.consents),v.push(A)}),v}changeConsentStatuses(){this.selection.clear(),this.selectedConsentStatuses=this.consentStatuses.value,this.refreshTable()}}q.\u0275fac=function(W){return new(W||q)(t.Y36(e.gz),t.Y36(a.xk),t.Y36(n.x4),t.Y36(n.fb),t.Y36(n.d6),t.Y36(a.WY),t.Y36(E.m2))},q.\u0275cmp=t.Xpm({type:q,selectors:[["app-resource-assigned-members"]],features:[t._Bn([E.m2,E.Qh])],decls:10,vars:7,consts:[[1,"page-subtitle"],[3,"refresh"],["class","me-2 fix-select",4,"ngIf"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative"],[3,"displayedColumns","disableRouting","filter","members","tableId","updateTable",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[1,"me-2","fix-select"],["multiple","",3,"formControl","closed"],["class","resource-theme",3,"value",4,"ngFor","ngForOf"],[1,"resource-theme",3,"value"],[3,"displayedColumns","disableRouting","filter","members","tableId","updateTable"]],template:function(W,v){if(1&W&&(t.TgZ(0,"h1",0),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.TgZ(3,"perun-web-apps-refresh-button",1),t.NdJ("refresh",function(){return v.refreshTable()}),t.qZA(),t.YNc(4,z,9,10,"mat-form-field",2),t.TgZ(5,"perun-web-apps-debounce-filter",3),t.NdJ("filter",function(A){return v.applyFilter(A)}),t.qZA(),t.YNc(6,M,1,0,"ng-template",null,4,t.W1O),t.TgZ(8,"div",5),t.YNc(9,w,1,5,"perun-web-apps-members-list",6),t.qZA()),2&W){const g=t.MAs(7);t.xp6(1),t.Oqu(t.lcZ(2,5,"RESOURCE_DETAIL.ASSIGNED_MEMBERS.TITLE")),t.xp6(3),t.Q6J("ngIf",v.includeConsents),t.xp6(1),t.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_MEMBERS.FILTER"),t.xp6(4),t.Q6J("perunWebAppsLoader",v.loading)("perunWebAppsLoaderIndicator",g)}},dependencies:[K.sg,K.O5,P.ey,x.KE,x.hX,C.JJ,C.oH,D.gD,D.$L,i.K,B.t,F.O,N.P,j.e,L.X$,y.Q]})},49546:(te,k,o)=>{o.d(k,{D:()=>Y});var a=o(61744),f=o(15466),n=o(95017),E=o(9244),C=o(7274),s=o(95243),t=o(94650),e=o(89383),K=o(36895),P=o(4859),x=o(3848),D=o(97403),i=o(64901),B=o(90439),F=o(73358),N=o(60205);function j(m,p){1&m&&t._UZ(0,"perun-web-apps-loading-dialog")}const L=function(){return["id","name","enabled","description"]};function y(m,p){if(1&m&&t._UZ(0,"app-services-list",15),2&m){const l=t.oxw(2);t.Q6J("disableRouting",!0)("services",l.filteredServices)("displayedColumns",t.DdM(5,L))("selection",l.selection)("tableId",l.tableId)}}const I=function(){return["select","id","name","enabled","description"]};function z(m,p){if(1&m){const l=t.EpF();t.TgZ(0,"div")(1,"h1",2),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",3)(5,"mat-tab-group",4),t.NdJ("selectedTabChange",function(){t.CHM(l);const d=t.oxw();return t.KtG(d.tabChanged())}),t.TgZ(6,"mat-tab",5),t.ALo(7,"translate"),t.TgZ(8,"div",6)(9,"perun-web-apps-debounce-filter",7),t.NdJ("filter",function(d){t.CHM(l);const Z=t.oxw();return t.KtG(Z.applyFilter(d))}),t.ALo(10,"translate"),t.qZA()(),t._UZ(11,"app-services-list",8),t.qZA(),t.TgZ(12,"mat-tab",5),t.ALo(13,"translate"),t.TgZ(14,"div",9)(15,"perun-web-apps-service-package-search-select",10),t.NdJ("packageSelected",function(d){t.CHM(l);const Z=t.oxw();return t.KtG(Z.servicePackageSelected(d))}),t.qZA()(),t.YNc(16,y,1,6,"app-services-list",11),t.qZA()()(),t.TgZ(17,"div",12)(18,"button",13),t.NdJ("click",function(){t.CHM(l);const d=t.oxw();return t.KtG(d.onCancel())}),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.TgZ(21,"button",14),t.NdJ("click",function(){t.CHM(l);const d=t.oxw();return t.KtG(d.onAdd())}),t._uU(22),t.ALo(23,"translate"),t.qZA()()()}if(2&m){const l=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,18,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.TITLE")),t.xp6(4),t.s9C("label",t.lcZ(7,20,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SELECT_SERVICE")),t.Q6J("disabled",l.loading),t.xp6(3),t.s9C("placeholder",t.lcZ(10,22,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.FILTER_DESCRIPTION")),t.xp6(2),t.Q6J("services",l.unAssignedServices)("disableRouting",!0)("displayedColumns",t.DdM(30,I))("filterValue",l.filterValue)("selection",l.selection)("tableId",l.tableId),t.xp6(1),t.s9C("label",t.lcZ(13,24,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SELECT_PACKAGE")),t.Q6J("disabled",l.loading),t.xp6(3),t.Q6J("selectedPackage",l.selectedPackage)("servicePackages",l.servicePackages),t.xp6(1),t.Q6J("ngIf",-1!==l.selectedPackage.id),t.xp6(3),t.hij(" ",t.lcZ(20,26,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.CANCEL_BUTTON")," "),t.xp6(2),t.Q6J("disabled",0===l.selection.selected.length&&-1===l.selectedPackage.id||l.loading),t.xp6(1),t.hij(" ",t.lcZ(23,28,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE."+(-1===l.selectedPackage.id?"ADD_SERVICES":"ADD_PACKAGE"))," ")}}class M{constructor(p,l,h,d,Z,X){this.dialogRef=p,this.data=l,this.notificator=h,this.translate=d,this.resourceManager=Z,this.servicesManager=X,this.loading=!1,this.unAssignedServices=[],this.filteredServices=[],this.servicePackages=[],this.selectedPackage={name:"Not selected",description:"",id:-1,beanName:"ServicePackage"},this.selection=new n.Ov(!0,[]),this.tableId=f.DR,this.filterValue=""}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resourceManager.getAssignedServicesToResource(this.data.resourceId).subscribe(p=>{this.servicesManager.getServices().subscribe(l=>{this.servicesManager.getServicesPackages().subscribe(h=>{this.servicePackages.push(this.selectedPackage),this.servicePackages=this.servicePackages.concat(h),this.unAssignedServices=l;for(const d of p)for(const Z of l)d.id===Z.id&&this.unAssignedServices.splice(this.unAssignedServices.indexOf(Z),1);this.loading=!1})})})}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0,-1!==this.selectedPackage.id?this.addServicePackage():this.addServices()}applyFilter(p){this.filterValue=p}servicePackageSelected(p){this.selectedPackage=p,-1!==p.id?this.servicesManager.getServicesFromServicesPackage(p.id).subscribe(l=>{this.filteredServices=l}):this.filteredServices=[]}tabChanged(){this.selection.clear(),this.filterValue="",this.selectedPackage=this.servicePackages[0]}addServicePackage(){this.resourceManager.assignServicesPackage(this.data.resourceId,this.selectedPackage.id).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.PACKAGE_SUCCESS_MESSAGE").subscribe(p=>{this.notificator.showSuccess(p),0!==this.selection.selected.length?this.addServices():this.dialogRef.close(!0)})},()=>this.loading=!1)}addServices(){const p=[];for(const l of this.selection.selected)p.push(l.id);this.resourceManager.assignServices(this.data.resourceId,p).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SERVICE_SUCCESS_MESSAGE").subscribe(l=>{this.notificator.showSuccess(l),this.dialogRef.close(!0)})},()=>this.loading=!1)}}M.\u0275fac=function(p){return new(p||M)(t.Y36(C.so),t.Y36(C.WI),t.Y36(s.V6),t.Y36(e.sK),t.Y36(a.xk),t.Y36(a.KK))},M.\u0275cmp=t.Xpm({type:M,selectors:[["app-perun-web-apps-assign-service-to-resource-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],["mat-stretch-tabs","false",3,"selectedTabChange"],[3,"disabled","label"],[1,"mt-2"],[3,"placeholder","filter"],[3,"services","disableRouting","displayedColumns","filterValue","selection","tableId"],[1,"mt-3"],[3,"selectedPackage","servicePackages","packageSelected"],[3,"disableRouting","services","displayedColumns","selection","tableId",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"disabled","click"],[3,"disableRouting","services","displayedColumns","selection","tableId"]],template:function(p,l){if(1&p&&(t.YNc(0,j,1,0,"ng-template",null,0,t.W1O),t.TgZ(2,"div"),t.YNc(3,z,24,31,"div",1),t.qZA()),2&p){const h=t.MAs(1);t.xp6(2),t.Gre("",l.theme," position-relative"),t.xp6(1),t.Q6J("perunWebAppsLoader",l.loading)("perunWebAppsLoaderIndicator",h)}},dependencies:[K.O5,P.lW,x.uX,x.SP,C.uh,C.xY,C.H8,D.b,i.P,B.F,F.e,N.Q,e.X$]});var w=o(30671);function q(m,p){1&m&&t._UZ(0,"perun-web-apps-loading-dialog")}function ee(m,p){1&m&&t._UZ(0,"th",14)}function W(m,p){if(1&m&&(t.TgZ(0,"td",15),t._uU(1),t.qZA()),2&m){const l=p.$implicit;t.xp6(1),t.Oqu(l.name)}}function v(m,p){1&m&&t._UZ(0,"tr",16)}function g(m,p){1&m&&t._UZ(0,"tr",17)}function A(m,p){if(1&m){const l=t.EpF();t.TgZ(0,"div")(1,"h1",2),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",3)(5,"p"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"div",4),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"table",5),t.ynx(12,6),t.YNc(13,ee,1,0,"th",7),t.YNc(14,W,2,1,"td",8),t.BQk(),t.YNc(15,v,1,0,"tr",9),t.YNc(16,g,1,0,"tr",10),t.qZA()(),t.TgZ(17,"div",11)(18,"button",12),t.NdJ("click",function(){t.CHM(l);const d=t.oxw();return t.KtG(d.onCancel())}),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.TgZ(21,"button",13),t.NdJ("click",function(){t.CHM(l);const d=t.oxw();return t.KtG(d.onSubmit())}),t._uU(22),t.ALo(23,"translate"),t.qZA()()()}if(2&m){const l=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,9,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.TITLE")),t.xp6(4),t.hij(" ",t.lcZ(7,11,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DESCRIPTION")," "),t.xp6(3),t.hij(" ",t.lcZ(10,13,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.ASK")," "),t.xp6(2),t.Q6J("dataSource",l.dataSource),t.xp6(4),t.Q6J("matHeaderRowDef",l.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",l.displayedColumns),t.xp6(3),t.hij(" ",t.lcZ(20,15,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.CANCEL")," "),t.xp6(2),t.Q6J("disabled",l.loading),t.xp6(1),t.hij(" ",t.lcZ(23,17,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DELETE")," ")}}class R{constructor(p,l,h,d,Z){this.dialogRef=p,this.data=l,this.notificator=h,this.translate=d,this.resourcesManager=Z,this.displayedColumns=["name"]}ngOnInit(){this.theme=this.data.theme,this.dataSource=new w.by(this.data.services)}onSubmit(){this.loading=!0;const p=[];for(const l of this.data.services)p.push(l.id);this.resourcesManager.removeServices(this.data.resourceId,p).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.SUCCESS").subscribe(l=>{this.notificator.showSuccess(l),this.dialogRef.close(!0)})},()=>this.loading=!1)}onCancel(){this.dialogRef.close()}}R.\u0275fac=function(p){return new(p||R)(t.Y36(C.so),t.Y36(C.WI),t.Y36(s.V6),t.Y36(e.sK),t.Y36(a.xk))},R.\u0275cmp=t.Xpm({type:R,selectors:[["app-perun-web-apps-remove-service-from-resource-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-flat-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"disabled","click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(p,l){if(1&p&&(t.YNc(0,q,1,0,"ng-template",null,0,t.W1O),t.TgZ(2,"div"),t.YNc(3,A,24,19,"div",1),t.qZA()),2&p){const h=t.MAs(1);t.xp6(2),t.Gre("",l.theme," position-relative"),t.xp6(1),t.Q6J("perunWebAppsLoader",l.loading)("perunWebAppsLoaderIndicator",h)}},dependencies:[P.lW,w.BZ,w.fO,w.as,w.w1,w.Dz,w.nj,w.ge,w.ev,w.XQ,w.Gk,C.uh,C.xY,C.H8,D.b,F.e,e.X$]});var S=o(82761),Q=o(68530),$=o(96214),ne=o(7434);function re(m,p){if(1&m){const l=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(l);const d=t.oxw();return t.KtG(d.addService())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&m&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_SERVICES.ADD_SERVICE"),"\n"))}function ie(m,p){if(1&m){const l=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(l);const d=t.oxw();return t.KtG(d.removeServices())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&m){const l=t.oxw();t.Q6J("disabled",0===l.selected.selected.length),t.xp6(1),t.hij(" ",t.lcZ(2,2,"RESOURCE_DETAIL.ASSIGNED_SERVICES.REMOVE_SERVICE"),"\n")}}function ae(m,p){1&m&&t._UZ(0,"perun-web-apps-loading-table")}function V(m,p){if(1&m&&t._UZ(0,"app-services-list",10),2&m){const l=t.oxw();t.Q6J("disableRouting",!l.serviceRoutingAuth)("selection",l.selected)("displayedColumns",l.displayedColumns)("filterValue",l.filterValue)("services",l.assignedServices)("tableId",l.tableId)}}class Y{constructor(p,l,h,d,Z){this.route=p,this.resourcesManager=l,this.dialog=h,this.guiAuthResolver=d,this.entityStorageService=Z,this.assignedServices=[],this.selected=new n.Ov(!0,[]),this.tableId=f.uC,this.filterValue="",this.displayedColumns=["select","id","name","enabled","script","description"]}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.getDataForAuthorization(),this.loadAllServices()}loadAllServices(){this.loading=!0,this.resourcesManager.getAssignedServicesToResource(this.resource.id).subscribe(p=>{this.assignedServices=p,this.selected.clear(),this.loading=!1})}addService(){const p=(0,E.kZ)();p.width="800px",p.data={theme:"resource-theme",resourceId:this.resource.id},this.dialog.open(M,p).afterClosed().subscribe(h=>{h&&this.loadAllServices()})}removeServices(){const p=(0,E.kZ)();p.width="500px",p.data={theme:"resource-theme",resourceId:this.resource.id,services:this.selected.selected},this.dialog.open(R,p).afterClosed().subscribe(h=>{h&&this.loadAllServices()})}applyFilter(p){this.filterValue=p}getDataForAuthorization(){this.assignServiceAuth=this.guiAuthResolver.isAuthorized("assignServices_Resource_List<Service>_policy",[this.resource]),this.removeServiceAuth=this.guiAuthResolver.isAuthorized("removeServices_Resource_List<Service>_policy",[this.resource]),this.displayedColumns=this.removeServiceAuth?["select","id","name","enabled","script","description"]:["id","name","enabled","script","description"],this.serviceRoutingAuth=this.guiAuthResolver.isPerunAdminOrObserver()}}Y.\u0275fac=function(p){return new(p||Y)(t.Y36(S.gz),t.Y36(a.xk),t.Y36(C.uw),t.Y36(s.x4),t.Y36(s.fb))},Y.\u0275cmp=t.Xpm({type:Y,selectors:[["app-perun-web-apps-resource-assigned-services"]],decls:11,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["class","action-button me-2","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","me-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative"],[3,"disableRouting","selection","displayedColumns","filterValue","services","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"action-button","me-2",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"disableRouting","selection","displayedColumns","filterValue","services","tableId"]],template:function(p,l){if(1&p&&(t.TgZ(0,"h1",0),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.TgZ(3,"perun-web-apps-refresh-button",1),t.NdJ("refresh",function(){return l.loadAllServices()}),t.qZA(),t.YNc(4,re,3,3,"button",2),t.YNc(5,ie,3,4,"button",3),t.TgZ(6,"perun-web-apps-immediate-filter",4),t.NdJ("filter",function(d){return l.applyFilter(d)}),t.qZA(),t.YNc(7,ae,1,0,"ng-template",null,5,t.W1O),t.TgZ(9,"div",6),t.YNc(10,V,1,6,"app-services-list",7),t.qZA()),2&p){const h=t.MAs(8);t.xp6(1),t.Oqu(t.lcZ(2,6,"RESOURCE_DETAIL.ASSIGNED_SERVICES.TITLE")),t.xp6(3),t.Q6J("ngIf",l.assignServiceAuth),t.xp6(1),t.Q6J("ngIf",l.removeServiceAuth),t.xp6(1),t.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_SERVICES.FILTER_SERVICES"),t.xp6(4),t.Q6J("perunWebAppsLoader",l.loading)("perunWebAppsLoaderIndicator",h)}},dependencies:[K.O5,P.lW,N.Q,Q.K,$.t,ne.L,F.e,e.X$]})},92090:(te,k,o)=>{o.d(k,{X:()=>j});var a=o(95243),f=o(61744),n=o(94650),E=o(36895),C=o(3848),s=o(48323),t=o(12651),e=o(89383);function K(L,y){1&L&&(n._uU(0),n.ALo(1,"translate")),2&L&&n.hij(" ",n.lcZ(1,1,"RESOURCE_DETAIL.ENTITY")," ")}function P(L,y){if(1&L&&n._UZ(0,"app-one-entity-attribute-page",5),2&L){const I=n.oxw();n.Q6J("entityId",I.resource.id)("entity","resource")}}function x(L,y){1&L&&(n._uU(0),n.ALo(1,"translate"),n.ALo(2,"translate")),2&L&&n.AsE(" ",n.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",n.lcZ(2,4,"MEMBER_DETAIL.ENTITY")," ")}function D(L,y){if(1&L&&n._UZ(0,"app-two-entity-attribute-page",6),2&L){const I=n.oxw(2);n.Q6J("firstEntity","resource")("firstEntityId",I.resource.id)("secondEntity","member")}}function i(L,y){1&L&&(n.TgZ(0,"mat-tab"),n.YNc(1,x,3,6,"ng-template",2),n.YNc(2,D,1,3,"ng-template",3),n.qZA())}function B(L,y){1&L&&(n._uU(0),n.ALo(1,"translate"),n.ALo(2,"translate")),2&L&&n.AsE(" ",n.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",n.lcZ(2,4,"GROUP_DETAIL.ENTITY")," ")}function F(L,y){if(1&L&&n._UZ(0,"app-two-entity-attribute-page",6),2&L){const I=n.oxw(2);n.Q6J("firstEntity","resource")("firstEntityId",I.resource.id)("secondEntity","group")}}function N(L,y){1&L&&(n.TgZ(0,"mat-tab"),n.YNc(1,B,3,6,"ng-template",2),n.YNc(2,F,1,3,"ng-template",3),n.qZA())}class j{constructor(y,I,z){this.authResolver=y,this.resourceManager=I,this.entityStorageService=z}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.resourceGroupAttAuth=this.authResolver.isAuthorized("getGroupAssignments_Resource_policy",[this.resource]),this.resourceMemberAttAuth=this.authResolver.isAuthorized("getAssignedMembersWithStatus_Resource_policy",[this.resource])}}j.\u0275fac=function(y){return new(y||j)(n.Y36(a.x4),n.Y36(f.xk),n.Y36(a.fb))},j.\u0275cmp=n.Xpm({type:j,selectors:[["app-resource-attributes"]],hostVars:2,hostBindings:function(y,I){2&y&&n.ekj("router-component",I.true)},decls:10,vars:5,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(y,I){1&y&&(n.TgZ(0,"div")(1,"h1",0),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"mat-tab-group",1)(5,"mat-tab"),n.YNc(6,K,2,3,"ng-template",2),n.YNc(7,P,1,2,"ng-template",3),n.qZA(),n.YNc(8,i,3,0,"mat-tab",4),n.YNc(9,N,3,0,"mat-tab",4),n.qZA()()),2&y&&(n.xp6(2),n.Oqu(n.lcZ(3,3,"RESOURCE_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),n.xp6(6),n.Q6J("ngIf",I.resourceMemberAttAuth),n.xp6(1),n.Q6J("ngIf",I.resourceGroupAttAuth))},dependencies:[E.O5,C.Vc,C.uD,C.uX,C.SP,s.Y,t.t,e.X$]})},98918:(te,k,o)=>{o.d(k,{b:()=>ae});var a=o(36769),f=o(77968),n=o(69024),E=o(61744),C=o(9244),s=o(95243),t=o(22395),e=o(67791),K=o(533),P=o(15003),x=o(22158),D=o(82722),i=o(94650),B=o(82761),F=o(7274),N=o(36895),j=o(97392),L=o(4859),y=o(51572),I=o(10266),z=o(61283),M=o(4235),w=o(55755),q=o(89383);function ee(V,Y){1&V&&i._UZ(0,"mat-spinner",3)}function W(V,Y){if(1&V){const m=i.EpF();i.TgZ(0,"button",14),i.NdJ("click",function(){i.CHM(m);const l=i.oxw(2);return i.KtG(l.editResource())}),i.TgZ(1,"mat-icon"),i._uU(2,"edit"),i.qZA()()}}function v(V,Y){if(1&V){const m=i.EpF();i.TgZ(0,"button",15),i.NdJ("click",function(){i.CHM(m);const l=i.oxw(2);return i.KtG(l.deleteResource())}),i.TgZ(1,"mat-icon"),i._uU(2,"delete_forever"),i.qZA()()}}const g=function(V){return["/organizations",V]};function A(V,Y){if(1&V&&(i.TgZ(0,"a",8),i.NdJ("auxclick",function(p){return p.preventDefault()}),i._uU(1),i.qZA()),2&V){const m=i.oxw(2);i.Q6J("perunWebAppsMiddleClickRouterLink",i.VKq(4,g,m.resource.vo.id.toString()))("routerLink",i.VKq(6,g,m.resource.vo.id)),i.uIk("data-cy",m.resource.vo.name),i.xp6(1),i.Oqu(m.resource.vo.name)}}function R(V,Y){if(1&V&&(i.TgZ(0,"span"),i._uU(1),i.qZA()),2&V){const m=i.oxw(2);i.xp6(1),i.hij(" ",m.resource.vo.name," ")}}const S=function(V){return["/facilities",V]};function Q(V,Y){if(1&V&&(i.TgZ(0,"a",8),i.NdJ("auxclick",function(p){return p.preventDefault()}),i._uU(1),i.qZA()),2&V){const m=i.oxw(2);i.Q6J("perunWebAppsMiddleClickRouterLink",i.VKq(4,S,m.resource.facilityId.toString()))("routerLink",i.VKq(6,S,m.resource.facilityId)),i.uIk("data-cy",m.resource.facility.name),i.xp6(1),i.Oqu(m.resource.facility.name)}}function $(V,Y){if(1&V&&(i.TgZ(0,"span"),i._uU(1),i.qZA()),2&V){const m=i.oxw(2);i.xp6(1),i.hij(" ",m.resource.facility.name," ")}}const ne=function(){return{color:"black"}},re=function(V){return[V]};function ie(V,Y){if(1&V&&(i.TgZ(0,"div")(1,"div",4),i._UZ(2,"mat-icon",5),i.ALo(3,"translate"),i.TgZ(4,"div",6)(5,"div",7)(6,"a",8),i.NdJ("auxclick",function(p){return p.preventDefault()}),i._uU(7),i.qZA(),i.TgZ(8,"span",9),i._uU(9),i.qZA(),i.YNc(10,W,3,0,"button",10),i.YNc(11,v,3,0,"button",11),i.qZA(),i.TgZ(12,"div"),i._uU(13),i.ALo(14,"translate"),i.qZA(),i.TgZ(15,"span",12),i._uU(16),i.ALo(17,"translate"),i.ALo(18,"translate"),i.YNc(19,A,2,8,"a",13),i.YNc(20,R,2,1,"span",2),i._uU(21),i.ALo(22,"translate"),i.YNc(23,Q,2,8,"a",13),i.YNc(24,$,2,1,"span",2),i._uU(25),i.ALo(26,"translate"),i.qZA()()(),i._UZ(27,"app-animated-router-outlet"),i.qZA()),2&V){const m=i.oxw();i.xp6(2),i.s9C("matTooltip",i.lcZ(3,21,"RESOURCE_DETAIL.ENTITY")),i.Q6J("ngStyle",i.DdM(33,ne)),i.xp6(4),i.Q6J("perunWebAppsMiddleClickRouterLink",i.VKq(34,re,m.baseUrl))("routerLink",i.VKq(36,re,m.baseUrl)),i.xp6(1),i.hij(" ",m.resource.name," "),i.xp6(2),i.hij(" \xa0#",m.resource.id," "),i.xp6(1),i.Q6J("ngIf",m.editResourceAuth),i.xp6(1),i.Q6J("ngIf",m.deleteAuth),i.xp6(2),i.AsE("",i.lcZ(14,23,"RESOURCE_DETAIL.UUID"),": ",m.resource.uuid,""),i.xp6(3),i.AsE(" ",i.lcZ(17,25,"RESOURCE_DETAIL.ENTITY"),", ",i.lcZ(18,27,"RESOURCE_DETAIL.VO"),": "),i.xp6(3),i.Q6J("ngIf",m.voLinkAuth),i.xp6(1),i.Q6J("ngIf",!m.voLinkAuth),i.xp6(1),i.AsE(" #",m.resource.voId,", ",i.lcZ(22,29,"RESOURCE_DETAIL.FACILITY"),": "),i.xp6(2),i.Q6J("ngIf",m.facilityLinkAuth),i.xp6(1),i.Q6J("ngIf",!m.facilityLinkAuth),i.xp6(1),i.lnq(" #",m.resource.facilityId,", ",i.lcZ(26,31,"RESOURCE_DETAIL.DESCRIPTION"),": ",m.resource.description," ")}}class ae extends((0,x.T)()){constructor(Y,m,p,l,h,d,Z,X,oe,ce,T){super(),this.route=Y,this.facilityManager=m,this.vosManagerService=p,this.resourcesManager=l,this.sideMenuService=h,this.sideMenuItemService=d,this.dialog=Z,this.guiAuthResolver=X,this.router=oe,this.entityStorageService=ce,this.reloadEntityDetail=T,this.underVoUrl=!1,this.deleteAuth=!1,this.baseUrl="",this.loading=!1}ngOnInit(){this.reloadData(),this.reloadEntityDetail.entityDetailChange.pipe((0,D.R)(this.destroyed$)).subscribe(()=>{this.reloadData()})}reloadData(){this.loading=!0,this.route.params.subscribe(Y=>{const m=Number(Y.resourceId);this.resourcesManager.getRichResourceById(m).subscribe(p=>{this.resource=p,this.entityStorageService.setEntity({id:p.id,voId:p.voId,facilityId:p.facilityId,beanName:"Resource"}),this.setAuth(),"facilities"===this.route.parent.snapshot.url[0].path?(this.baseUrl=(new t.r5).transform(p,!1),this.facilityManager.getFacilityById(p.facilityId).subscribe(l=>{this.facility=l,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)):(this.baseUrl=(new t.r5).transform(p,!0),this.vosManagerService.getVoById(p.voId).subscribe(l=>{this.vo=l,this.underVoUrl=!0,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)),(0,C.sF)("resources",this.resource)})})}setMenuItems(){let Y;const m=this.sideMenuItemService.parseResource(this.resource,this.underVoUrl);this.underVoUrl?(Y=this.sideMenuItemService.parseVo(this.vo),this.sideMenuService.setAccessMenuItems([Y,m])):(Y=this.sideMenuItemService.parseFacility(this.facility),this.sideMenuService.setFacilityMenuItems([Y,m]))}editResource(){let Y;this.resourcesManager.getResourceById(this.resource.id).subscribe(m=>{Y=m;const p=(0,C.kZ)();p.width="450px",p.data={theme:"resource-theme",resource:Y,dialogType:e.Eg.RESOURCE},this.dialog.open(e.rd,p).afterClosed().subscribe(h=>{h&&this.resourcesManager.getRichResourceById(this.resource.id).subscribe(d=>{this.resource=d,this.setMenuItems()})})})}deleteResource(){const Y=(0,C.kZ)();Y.width="500px",Y.data={theme:"resource-theme",resources:[this.resource]},this.dialog.open(K.f,Y).afterClosed().subscribe(p=>{p&&this.router.navigate(["../"],{relativeTo:this.route,queryParamsHandling:"preserve"})})}setAuth(){this.facilityLinkAuth=this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.resource]),this.editResourceAuth=this.guiAuthResolver.isAuthorized("updateResource_Resource_policy",[this.resource]),this.voLinkAuth=this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.resource]),this.deleteAuth=this.guiAuthResolver.isAuthorized("deleteResource_Resource_policy",[this.resource])}}ae.\u0275fac=function(Y){return new(Y||ae)(i.Y36(B.gz),i.Y36(E.IQ),i.Y36(E.YF),i.Y36(E.xk),i.Y36(f.D),i.Y36(n.V),i.Y36(F.uw),i.Y36(s.x4),i.Y36(B.F0),i.Y36(s.fb),i.Y36(P.G))},ae.\u0275cmp=i.Xpm({type:ae,selectors:[["app-resource-detail-page"]],features:[i.qOj],decls:4,vars:2,consts:[[1,"container-fluid","ps-xl-5","pe-xl-5","resource-theme"],["class","me-auto ms-auto",4,"ngIf"],[4,"ngIf"],[1,"me-auto","ms-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-resource-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"resource-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],[1,"text-muted"],["aria-label","Edit resource","mat-icon-button","",3,"click",4,"ngIf"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"mt-1","entity-info"],["class","resource-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick",4,"ngIf"],["aria-label","Edit resource","mat-icon-button","",3,"click"],["mat-icon-button","",3,"click"]],template:function(Y,m){1&Y&&(i.TgZ(0,"div",0),i._UZ(1,"perun-web-apps-back-button"),i.YNc(2,ee,1,0,"mat-spinner",1),i.YNc(3,ie,28,38,"div",2),i.qZA()),2&Y&&(i.xp6(2),i.Q6J("ngIf",m.loading),i.xp6(1),i.Q6J("ngIf",!m.loading&&void 0!==m.resource))},dependencies:[N.O5,N.PC,B.rH,j.Hw,L.RK,y.Ou,I.gM,z.A,M.W,w.YH,w.QG,q.X$],styles:[".break-line[_ngcontent-%COMP%]{display:inline-block}"],data:{animation:[a.Ji]}})},258:(te,k,o)=>{o.d(k,{K:()=>ce});var a=o(61744),f=o(95017),n=o(7274),E=o(30671),C=o(95243),s=o(94650),t=o(89383),e=o(4859),K=o(97403),P=o(73358);function x(T,b){1&T&&s._UZ(0,"perun-web-apps-loading-dialog")}function D(T,b){1&T&&s._UZ(0,"th",14)}function i(T,b){if(1&T&&(s.TgZ(0,"td",15),s._uU(1),s.qZA()),2&T){const _=b.$implicit;s.xp6(1),s.Oqu(_.name)}}function B(T,b){1&T&&s._UZ(0,"tr",16)}function F(T,b){1&T&&s._UZ(0,"tr",17)}function N(T,b){if(1&T){const _=s.EpF();s.TgZ(0,"div")(1,"h1",2),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.TgZ(4,"div",3)(5,"p"),s._uU(6),s.ALo(7,"translate"),s.qZA(),s.TgZ(8,"div",4),s._uU(9),s.ALo(10,"translate"),s.qZA(),s.TgZ(11,"table",5),s.ynx(12,6),s.YNc(13,D,1,0,"th",7),s.YNc(14,i,2,1,"td",8),s.BQk(),s.YNc(15,B,1,0,"tr",9),s.YNc(16,F,1,0,"tr",10),s.qZA()(),s.TgZ(17,"div",11)(18,"button",12),s.NdJ("click",function(){s.CHM(_);const J=s.oxw();return s.KtG(J.onCancel())}),s._uU(19),s.ALo(20,"translate"),s.qZA(),s.TgZ(21,"button",13),s.NdJ("click",function(){s.CHM(_);const J=s.oxw();return s.KtG(J.onSubmit())}),s._uU(22),s.ALo(23,"translate"),s.qZA()()()}if(2&T){const _=s.oxw();s.xp6(2),s.Oqu(s.lcZ(3,9,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.TITLE")),s.xp6(4),s.hij(" ",s.lcZ(7,11,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DESCRIPTION")," "),s.xp6(3),s.hij(" ",s.lcZ(10,13,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.ASK")," "),s.xp6(2),s.Q6J("dataSource",_.dataSource),s.xp6(4),s.Q6J("matHeaderRowDef",_.displayedColumns),s.xp6(1),s.Q6J("matRowDefColumns",_.displayedColumns),s.xp6(3),s.hij(" ",s.lcZ(20,15,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.CANCEL")," "),s.xp6(2),s.Q6J("disabled",_.loading),s.xp6(1),s.hij(" ",s.lcZ(23,17,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DELETE")," ")}}class j{constructor(b,_,U,J,H){this.dialogRef=b,this.data=_,this.notificator=U,this.translate=J,this.resourceManager=H,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.dataSource=new E.by(this.data.groups)}onCancel(){this.dialogRef.close()}onSubmit(){const b=[];for(const _ of this.data.groups)b.push(_.id);this.loading=!0,this.resourceManager.removeGroupsFromResource(b,this.data.resourceId).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUP_FROM_RESOURCE.SUCCESS").subscribe(_=>{this.notificator.showSuccess(_),this.dialogRef.close(!0)})},()=>this.loading=!1)}}j.\u0275fac=function(b){return new(b||j)(s.Y36(n.so),s.Y36(n.WI),s.Y36(C.V6),s.Y36(t.sK),s.Y36(a.xk))},j.\u0275cmp=s.Xpm({type:j,selectors:[["app-perun-web-apps-remove-group-from-resource-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-flat-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","","data-cy","delete-button",1,"ms-2",3,"disabled","click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(b,_){if(1&b&&(s.YNc(0,x,1,0,"ng-template",null,0,s.W1O),s.TgZ(2,"div"),s.YNc(3,N,24,19,"div",1),s.qZA()),2&b){const U=s.MAs(1);s.xp6(2),s.Gre("",_.theme," position-relative"),s.xp6(1),s.Q6J("perunWebAppsLoader",_.loading)("perunWebAppsLoaderIndicator",U)}},dependencies:[e.lW,E.BZ,E.fO,E.as,E.w1,E.Dz,E.nj,E.ge,E.ev,E.XQ,E.Gk,n.uh,n.xY,n.H8,K.b,P.e,t.X$]});var L=o(15466),y=o(36895),I=o(24006),z=o(90455),M=o(86257),w=o(25788),q=o(64901);const ee=["stepper"];function W(T,b){1&T&&s._UZ(0,"perun-web-apps-loading-dialog")}function v(T,b){1&T&&(s._uU(0),s.ALo(1,"translate")),2&T&&s.Oqu(s.lcZ(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.GROUPS"))}function g(T,b){1&T&&(s._uU(0),s.ALo(1,"translate")),2&T&&s.Oqu(s.lcZ(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.OPTIONS"))}const A=function(){return["select","id","name","description"]};function R(T,b){if(1&T){const _=s.EpF();s.TgZ(0,"div",5)(1,"mat-stepper",6,7)(3,"mat-step",8),s.YNc(4,v,2,3,"ng-template",9),s.TgZ(5,"perun-web-apps-debounce-filter",10),s.NdJ("filter",function(J){s.CHM(_);const H=s.oxw(2);return s.KtG(H.applyFilter(J))}),s.ALo(6,"translate"),s.qZA(),s._UZ(7,"perun-web-apps-groups-list",11),s.qZA(),s.TgZ(8,"mat-step"),s.YNc(9,g,2,3,"ng-template",9),s.TgZ(10,"mat-slide-toggle",12),s.NdJ("toggleChange",function(){s.CHM(_);const J=s.oxw(2);return s.KtG(J.changeSubgroupsMessage())})("ngModelChange",function(J){s.CHM(_);const H=s.oxw(2);return s.KtG(H.autoAssignSubgroups=J)}),s._uU(11),s.ALo(12,"translate"),s.qZA(),s.TgZ(13,"div",13),s._UZ(14,"i",14),s.qZA(),s.TgZ(15,"mat-slide-toggle",12),s.NdJ("toggleChange",function(){s.CHM(_);const J=s.oxw(2);return s.KtG(J.changeInactiveMessage())})("ngModelChange",function(J){s.CHM(_);const H=s.oxw(2);return s.KtG(H.asActive=J)}),s._uU(16),s.ALo(17,"translate"),s.qZA(),s.TgZ(18,"div",13),s._uU(19),s.qZA(),s.TgZ(20,"mat-slide-toggle",12),s.NdJ("toggleChange",function(){s.CHM(_);const J=s.oxw(2);return s.KtG(J.changeAsyncMessage())})("ngModelChange",function(J){s.CHM(_);const H=s.oxw(2);return s.KtG(H.async=J)}),s._uU(21),s.ALo(22,"translate"),s.qZA(),s.TgZ(23,"div",13),s._uU(24),s.qZA()()()()}if(2&T){const _=s.oxw(2);s.xp6(1),s.Q6J("linear",!0),s.xp6(2),s.Q6J("completed",0!==_.selection.selected.length&&_.canAddGroups()),s.xp6(2),s.s9C("placeholder",s.lcZ(6,19,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.FILTER_DESCRIPTION")),s.xp6(2),s.Q6J("disableMembers",!1)("groups",_.unAssignedGroups)("selection",_.selection)("disableRouting",!0)("displayedColumns",s.DdM(27,A))("filter",_.filterValue)("tableId",_.tableId),s.xp6(3),s.Q6J("ngModel",_.autoAssignSubgroups),s.xp6(1),s.hij(" ",s.lcZ(12,21,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS")," "),s.xp6(3),s.Q6J("innerHTML",_.autoAssignHint,s.oJD),s.xp6(1),s.Q6J("ngModel",_.asActive),s.xp6(1),s.hij(" ",s.lcZ(17,23,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AS_ACTIVE")," "),s.xp6(3),s.hij(" ",_.asActiveHint," "),s.xp6(1),s.Q6J("ngModel",_.async),s.xp6(1),s.hij(" ",s.lcZ(22,25,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OPT")," "),s.xp6(3),s.hij(" ",_.asyncHint," ")}}function S(T,b){if(1&T){const _=s.EpF();s.TgZ(0,"button",20),s.NdJ("click",function(){s.CHM(_);const J=s.oxw(3);return s.KtG(J.stepperPrevious())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&T&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.BACK")," "))}function Q(T,b){if(1&T){const _=s.EpF();s.TgZ(0,"button",21),s.NdJ("click",function(){s.CHM(_);const J=s.oxw(3);return s.KtG(J.stepperNext())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}if(2&T){const _=s.oxw(3);s.ekj("ms-2",void 0!==_.stepper&&0!==_.stepper.selectedIndex)("ms-auto",!(void 0!==_.stepper&&0!==_.stepper.selectedIndex)),s.Q6J("disabled",0===_.selection.selected.length||!_.canAddGroups()),s.xp6(1),s.hij(" ",s.lcZ(2,6,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.NEXT")," ")}}function $(T,b){if(1&T){const _=s.EpF();s.TgZ(0,"button",22),s.NdJ("click",function(){s.CHM(_);const J=s.oxw(3);return s.KtG(J.onAdd())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&T&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ADD_BUTTON")," "))}function ne(T,b){if(1&T){const _=s.EpF();s.TgZ(0,"div",15)(1,"button",16),s.NdJ("click",function(){s.CHM(_);const J=s.oxw(2);return s.KtG(J.onCancel())}),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.YNc(4,S,3,3,"button",17),s.YNc(5,Q,3,8,"button",18),s.YNc(6,$,3,3,"button",19),s.qZA()}if(2&T){const _=s.oxw(2);s.xp6(2),s.hij(" ",s.lcZ(3,4,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.CANCEL_BUTTON")," "),s.xp6(2),s.Q6J("ngIf",void 0!==_.stepper&&0!==_.stepper.selectedIndex),s.xp6(1),s.Q6J("ngIf",void 0!==_.stepper&&_.stepper.selectedIndex!==_.stepper._steps.length-1),s.xp6(1),s.Q6J("ngIf",void 0!==_.stepper&&_.stepper.selectedIndex===_.stepper._steps.length-1)}}function re(T,b){if(1&T&&(s.TgZ(0,"div")(1,"h1",2),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.YNc(4,R,25,28,"div",3),s.YNc(5,ne,7,6,"div",4),s.qZA()),2&T){const _=s.oxw();s.xp6(2),s.Oqu(s.lcZ(3,3,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.TITLE")),s.xp6(2),s.Q6J("ngIf",_.unAssignedGroups),s.xp6(1),s.Q6J("ngIf",_.stepper)}}class ie{constructor(b,_,U,J,H,le,de,Ae){this.dialogRef=b,this.data=_,this.notificator=U,this.translate=J,this.resourceManager=H,this.groupService=le,this.guiAuthResolver=de,this.cd=Ae,this.loading=!1,this.unAssignedGroups=null,this.async=!0,this.autoAssignSubgroups=!1,this.asActive=!0,this.selection=new f.Ov(!0,[]),this.filterValue="",this.tableId=L.cL}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resource=this.data.resource,this.autoAssignHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT"),this.asActiveHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT"),this.asyncHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT"),this.resourceManager.getAssignedGroups(this.resource.id).subscribe({next:b=>{this.groupService.getAllGroups(this.resource.voId).subscribe({next:_=>{this.unAssignedGroups=this.data.onlyAutoAssignedGroups;for(const U of _)-1===b.findIndex(J=>J.id===U.id)&&this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,U])&&this.unAssignedGroups.push(U);this.loading=!1,this.cd.detectChanges()},error:()=>this.loading=!1})},error:()=>this.loading=!1})}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0;const b=[];for(const _ of this.selection.selected)b.push(_.id);this.resourceManager.assignGroupsToResource(b,this.resource.id,this.async,!this.asActive,this.autoAssignSubgroups).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.SUCCESS_MESSAGE").subscribe(_=>{this.notificator.showSuccess(_),this.dialogRef.close(!0)})},()=>this.loading=!1)}applyFilter(b){this.filterValue=b}canAddGroups(){let b=!0;return this.selection.selected.forEach(_=>{this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,_])||(b=!1)}),b}changeSubgroupsMessage(){this.autoAssignHint=this.translate.instant(this.autoAssignSubgroups?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_ON_HINT")}changeInactiveMessage(){this.asActiveHint=this.translate.instant(this.asActive?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT")}changeAsyncMessage(){this.asyncHint=this.translate.instant(this.async?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT")}stepperPrevious(){this.stepper.previous()}stepperNext(){this.stepper.next()}}ie.\u0275fac=function(b){return new(b||ie)(s.Y36(n.so),s.Y36(n.WI),s.Y36(C.V6),s.Y36(t.sK),s.Y36(a.xk),s.Y36(a.ff),s.Y36(C.x4),s.Y36(s.sBO))},ie.\u0275cmp=s.Xpm({type:ie,selectors:[["app-perun-web-apps-assign-group-to-resource-dialog"]],viewQuery:function(b,_){if(1&b&&s.Gf(ee,5),2&b){let U;s.iGM(U=s.CRH())&&(_.stepper=U.first)}},decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["class","dialog-container","mat-dialog-content","",4,"ngIf"],["mat-dialog-actions","",4,"ngIf"],["mat-dialog-content","",1,"dialog-container"],[3,"linear"],["stepper",""],[3,"completed"],["matStepLabel",""],[3,"placeholder","filter"],[3,"disableMembers","groups","selection","disableRouting","displayedColumns","filter","tableId"],["labelPosition","before",1,"mt-3","slide-text",3,"ngModel","toggleChange","ngModelChange"],[1,"text-muted","new-line","mt-2"],[3,"innerHTML"],["mat-dialog-actions",""],["mat-flat-button","",3,"click"],["class","ms-auto","mat-flat-button","",3,"click",4,"ngIf"],["color","accent","mat-flat-button","","type","button","data-cy","next-button",3,"ms-2","ms-auto","disabled","click",4,"ngIf"],["class","ms-2","color","accent","mat-flat-button","","type","button","data-cy","assign-button",3,"click",4,"ngIf"],["mat-flat-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","","type","button","data-cy","next-button",3,"disabled","click"],["color","accent","mat-flat-button","","type","button","data-cy","assign-button",1,"ms-2",3,"click"]],template:function(b,_){if(1&b&&(s.YNc(0,W,1,0,"ng-template",null,0,s.W1O),s.TgZ(2,"div"),s.YNc(3,re,6,5,"div",1),s.qZA()),2&b){const U=s.MAs(1);s.xp6(2),s.Gre("",_.theme," position-relative"),s.xp6(1),s.Q6J("perunWebAppsLoader",_.loading)("perunWebAppsLoaderIndicator",U)}},dependencies:[y.O5,I.JJ,I.On,e.lW,n.uh,n.xY,n.H8,z.Rr,M.C0,M.VY,M.Vq,K.b,w.W,q.P,P.e,t.X$],styles:[".slide-text[_ngcontent-%COMP%]{font-size:1.1rem}"]});var ae=o(9244),V=o(6134),Y=o(82761),m=o(10266),p=o(68530),l=o(96214);function h(T,b){if(1&T){const _=s.EpF();s.TgZ(0,"button",9),s.NdJ("click",function(){s.CHM(_);const J=s.oxw();return s.KtG(J.addGroup())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&T&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_GROUPS.ADD_GROUP"),"\n"))}function d(T,b){1&T&&s._UZ(0,"perun-web-apps-loading-table")}const Z=function(T){return[T]},X=function(){return["select","id","indirectGroupAssigment","name","status","description"]};function oe(T,b){if(1&T){const _=s.EpF();s.TgZ(0,"perun-web-apps-groups-list",10),s.NdJ("refreshTable",function(){s.CHM(_);const J=s.oxw();return s.KtG(J.loadAllGroups())}),s.qZA()}if(2&T){const _=s.oxw();s.Q6J("disableGroups",!0)("groupsToDisableCheckbox",_.groupsToDisable)("disableMembers",!1)("groups",_.assignedGroups)("disableRouting",!!_.assignedGroups[0]&&!_.guiAuthResolver.isAuthorized("getGroupById_int_policy",s.VKq(10,Z,_.assignedGroups[0])))("displayedColumns",s.DdM(12,X))("filter",_.filteredValue)("resourceId",_.resource.id)("selection",_.selected)("tableId",_.tableId)}}class ce{constructor(b,_,U,J,H){this.route=b,this.resourcesManager=_,this.dialog=U,this.guiAuthResolver=J,this.entityStorageService=H,this.assignedGroups=[],this.selected=new f.Ov(!0,[]),this.filteredValue="",this.tableId=L.Ad}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.loadAllGroups()}loadAllGroups(){this.loading=!0,this.resourcesManager.getGroupAssignments(this.resource.id,[V.r.GROUP_SYNC_ENABLED]).subscribe(b=>{this.assignedGroups=b.map(H=>{const le=H.enrichedGroup.group;return le.status=H.status,le.failureCause=H.failureCause,le.sourceGroupId=H.sourceGroupId,le});const _=this.assignedGroups.map(H=>H.id),U=this.assignedGroups.filter((H,le)=>_.indexOf(H.id)===le),J=this.assignedGroups.filter((H,le)=>{const de=_.indexOf(H.id);return de!==le&&(null===H.sourceGroupId||null===this.assignedGroups[de].sourceGroupId)}).map(H=>H.id);U.forEach(H=>{J.includes(H.id)&&(H.moreTypesOfAssignment=!0)}),this.assignedGroups=U,this.groupsToDisable=new Set(this.assignedGroups.filter(H=>!!H.sourceGroupId&&!H.moreTypesOfAssignment).map(H=>H.id)),this.selected.clear(),this.loading=!1})}addGroup(){const b=(0,ae.kZ)();b.width="1000px",b.data={theme:"resource-theme",resource:this.resource,onlyAutoAssignedGroups:this.assignedGroups.filter(U=>this.groupsToDisable.has(U.id))},this.dialog.open(ie,b).afterClosed().subscribe(U=>{U&&this.loadAllGroups()})}removeGroups(){const b=(0,ae.kZ)();b.width="500px",b.data={resourceId:this.resource.id,groups:this.selected.selected,theme:"resource-theme"},this.dialog.open(j,b).afterClosed().subscribe(U=>{U&&this.loadAllGroups()})}canRemoveGroups(){let b=!0;return this.selected.selected.forEach(_=>{this.guiAuthResolver.isAuthorized("removeGroupsFromResource_List<Group>_Resource_policy",[this.resource,_])||(b=!1)}),b}applyFilter(b){this.filteredValue=b}}ce.\u0275fac=function(b){return new(b||ce)(s.Y36(Y.gz),s.Y36(a.xk),s.Y36(n.uw),s.Y36(C.x4),s.Y36(C.fb))},ce.\u0275cmp=s.Xpm({type:ce,selectors:[["app-perun-web-apps-resource-groups"]],decls:15,vars:17,consts:[[1,"page-subtitle"],[3,"refresh"],["class","action-button","color","accent","mat-flat-button","","data-cy","add-group-button",3,"click",4,"ngIf"],["color","warn","mat-flat-button","","data-cy","remove-group-button",1,"ms-2","me-2",3,"disabled","click"],[3,"matTooltipDisabled","matTooltip"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative"],[3,"disableGroups","groupsToDisableCheckbox","disableMembers","groups","disableRouting","displayedColumns","filter","resourceId","selection","tableId","refreshTable",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","","data-cy","add-group-button",1,"action-button",3,"click"],[3,"disableGroups","groupsToDisableCheckbox","disableMembers","groups","disableRouting","displayedColumns","filter","resourceId","selection","tableId","refreshTable"]],template:function(b,_){if(1&b&&(s.TgZ(0,"h1",0),s._uU(1),s.ALo(2,"translate"),s.qZA(),s.TgZ(3,"perun-web-apps-refresh-button",1),s.NdJ("refresh",function(){return _.loadAllGroups()}),s.qZA(),s.YNc(4,h,3,3,"button",2),s.TgZ(5,"button",3),s.NdJ("click",function(){return _.removeGroups()}),s.TgZ(6,"span",4),s.ALo(7,"translate"),s._uU(8),s.ALo(9,"translate"),s.qZA()(),s.TgZ(10,"perun-web-apps-debounce-filter",5),s.NdJ("filter",function(J){return _.applyFilter(J)}),s.qZA(),s.YNc(11,d,1,0,"ng-template",null,6,s.W1O),s.TgZ(13,"div",7),s.YNc(14,oe,1,13,"perun-web-apps-groups-list",8),s.qZA()),2&b){const U=s.MAs(12);s.xp6(1),s.Oqu(s.lcZ(2,9,"RESOURCE_DETAIL.ASSIGNED_GROUPS.TITLE")),s.xp6(3),s.Q6J("ngIf",_.guiAuthResolver.isAuthorized("getAllGroups_Vo_policy",s.VKq(15,Z,_.resource))),s.xp6(1),s.Q6J("disabled",0===_.selected.selected.length||!_.canRemoveGroups()),s.xp6(1),s.s9C("matTooltip",s.lcZ(7,11,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_TOOLTIP")),s.Q6J("matTooltipDisabled",_.canRemoveGroups()),s.xp6(2),s.hij(" ",s.lcZ(9,13,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_GROUP")," "),s.xp6(2),s.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_GROUPS.FILTER_GROUPS"),s.xp6(4),s.Q6J("perunWebAppsLoader",_.loading)("perunWebAppsLoaderIndicator",U)}},dependencies:[y.O5,e.lW,m.gM,p.K,w.W,l.t,q.P,P.e,t.X$]})},4675:(te,k,o)=>{o.d(k,{H:()=>P});var a=o(61744),f=o(95243),n=o(94650),E=o(82761),C=o(36895),s=o(51572),t=o(71135);function e(x,D){1&x&&n._UZ(0,"mat-spinner",2)}function K(x,D){if(1&x&&(n.TgZ(0,"div"),n._UZ(1,"perun-web-apps-menu-buttons-field",3),n.qZA()),2&x){const i=n.oxw();n.xp6(1),n.Q6J("items",i.navItems)("size","small")}}class P{constructor(D,i,B,F,N){this.resourcesManager=D,this.route=i,this.guiAuthResolver=B,this.entityStorageService=F,this.routePolicyService=N,this.navItems=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.initItems("facilities"!==this.route.parent.parent.snapshot.url[0].path),this.loading=!1}initItems(D){const i=D?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`;this.navItems=[],this.routePolicyService.canNavigate("resources-groups",this.resource)&&this.navItems.push({cssIcon:"perun-group",url:`${i}/resources/${this.resource.id}/groups`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_GROUPS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-services",this.resource)&&this.navItems.push({cssIcon:"perun-service",url:`${i}/resources/${this.resource.id}/services`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_SERVICES",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-members",this.resource)&&this.navItems.push({cssIcon:"perun-user",url:`${i}/resources/${this.resource.id}/members`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_MEMBERS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-tags",this.resource)&&this.navItems.push({cssIcon:"perun-resource-tags",url:`${i}/resources/${this.resource.id}/tags`,label:"MENU_ITEMS.RESOURCE.RESOURCE_TAGS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-attributes",this.resource)&&this.navItems.push({cssIcon:"perun-attributes",url:`${i}/resources/${this.resource.id}/attributes`,label:"MENU_ITEMS.RESOURCE.ATTRIBUTES",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-settings",this.resource)&&this.navItems.push({cssIcon:"perun-settings2",url:`${i}/resources/${this.resource.id}/settings`,label:"MENU_ITEMS.RESOURCE.SETTINGS",style:"resource-btn"})}}P.\u0275fac=function(D){return new(D||P)(n.Y36(a.xk),n.Y36(E.gz),n.Y36(f.x4),n.Y36(f.fb),n.Y36(f.Ip))},P.\u0275cmp=n.Xpm({type:P,selectors:[["app-resource-overview"]],hostVars:2,hostBindings:function(D,i){2&D&&n.ekj("router-component",i.true)},decls:2,vars:2,consts:[["class","me-auto ms-auto",4,"ngIf"],[4,"ngIf"],[1,"me-auto","ms-auto"],[3,"items","size"]],template:function(D,i){1&D&&(n.YNc(0,e,1,0,"mat-spinner",0),n.YNc(1,K,2,2,"div",1)),2&D&&(n.Q6J("ngIf",i.loading),n.xp6(1),n.Q6J("ngIf",!i.loading))},dependencies:[C.O5,s.Ou,t.L]})},35265:(te,k,o)=>{o.d(k,{I:()=>g});var a=o(61744),f=o(95017),n=o(95243),E=o(9244),C=o(67791),s=o(15466),t=o(7274),e=o(94650),K=o(38383),P=o(64901),x=o(83370);const D=function(){return["checkbox","id","fullName"]};class i{constructor(R,S,Q,$,ne){this.data=R,this.dialogRef=S,this.store=Q,this.resourceService=$,this.notificator=ne,this.selection=new f.Ov(!1,[]),this.loading=!1,this.displayedColumns=["checkbox","id","fullName","organization","email","logins"],this.members=[],this.tableId=s.bj,this.filter=""}ngOnInit(){this.loading=!0,this.resourceService.getAssignedRichMembers(this.data.entityId).subscribe({next:R=>{this.members=R,this.loading=!1},error:()=>this.loading=!1}),this.selection.changed.subscribe(R=>{this.ban=this.data.bans.find(S=>{var Q;return S.memberId===(null===(Q=R.source.selected[0])||void 0===Q?void 0:Q.id)})})}cancel(){this.dialogRef.close(!1)}submitBan(R){this.ban?this.updateBan(R):this.banMember(R)}banMember(R){this.loading=!0,this.resourceService.setResourceBan({banOnResource:{memberId:this.selection.selected[0].id,resourceId:this.data.entityId,description:R.description,validityTo:R.validity,id:0,beanName:"BanOnResource"}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.ADD_BAN.SUCCESS_MEMBER"),this.dialogRef.close(!0)},error:()=>this.loading=!1})}updateBan(R){this.loading=!0,this.resourceService.updateResourceBan({banOnResource:{id:this.ban.id,beanName:"BanOnFacility",resourceId:this.ban.resourceId,memberId:this.ban.memberId,description:R.description,validityTo:R.validity}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.UPDATE_BAN.SUCCESS"),this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}}i.\u0275fac=function(R){return new(R||i)(e.Y36(t.WI),e.Y36(t.so),e.Y36(n.d6),e.Y36(a.xk),e.Y36(n.V6))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-add-resource-ban-dialog"]],decls:3,vars:13,consts:[[3,"loading","disabled","theme","ban","add","cancel"],[3,"placeholder","filter"],[3,"displayedColumns","selection","disableRouting","allowCheckboxDisabled","filter","members","tableId"]],template:function(R,S){1&R&&(e.TgZ(0,"app-add-ban-dialog",0),e.NdJ("add",function($){return S.submitBan($)})("cancel",function(){return S.cancel()}),e.TgZ(1,"perun-web-apps-debounce-filter",1),e.NdJ("filter",function($){return S.filter=$}),e.qZA(),e._UZ(2,"perun-web-apps-members-list",2),e.qZA()),2&R&&(e.Q6J("loading",S.loading)("disabled",0===S.selection.selected.length)("theme",S.data.theme)("ban",S.ban),e.xp6(1),e.Q6J("placeholder","DIALOGS.ADD_BAN.FILTER"),e.xp6(1),e.Q6J("displayedColumns",e.DdM(12,D))("selection",S.selection)("disableRouting",!0)("allowCheckboxDisabled",!1)("filter",S.filter)("members",S.members)("tableId",S.tableId))},dependencies:[K.O,P.P,x.u]});var B=o(6134),F=o(28943),N=o(22395),j=o(36895),L=o(4859),y=o(68530),I=o(96214),z=o(91880),M=o(73358),w=o(89383);function q(A,R){if(1&A){const S=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){e.CHM(S);const $=e.oxw();return e.KtG($.add())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&A&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"RESOURCE_DETAIL.SETTINGS.BANS.ADD"),"\n"))}function ee(A,R){if(1&A){const S=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(S);const $=e.oxw();return e.KtG($.remove())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&A){const S=e.oxw();e.Q6J("disabled",0===S.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"RESOURCE_DETAIL.SETTINGS.BANS.REMOVE"),"\n")}}function W(A,R){if(1&A){const S=e.EpF();e.TgZ(0,"perun-web-apps-ban-on-entity-list",10),e.NdJ("updateBan",function($){e.CHM(S);const ne=e.oxw();return e.KtG(ne.update($))}),e.qZA()}if(2&A){const S=e.oxw();e.Q6J("bans",S.bans)("selection",S.selection)("displayedColumns",S.displayedColumns)("filter",S.filter)("updatePolicy","updateBan_BanOnResource_policy")}}function v(A,R){1&A&&e._UZ(0,"perun-web-apps-loading-table")}class g{constructor(R,S,Q,$,ne,re,ie){this.resourceService=R,this.entityService=S,this.authResolver=Q,this.dialog=$,this.notificator=ne,this.store=re,this.userName=ie,this.loading=!1,this.bans=[],this.removeAuth=!1,this.filter="",this.selection=new f.Ov(!1,[]),this.attrNames=[B.r.MEMBER_DEF_MAIL,B.r.USER_DEF_PREFERRED_MAIL].concat(this.store.getLoginAttributeNames()),this.displayedColumns=["select","banId","subjectId","subjectName","description","expiration","edit"]}ngOnInit(){this.loading=!0,this.resource=this.entityService.getEntity(),this.addAuth=this.authResolver.isAuthorized("setBan_BanOnResource_policy",[this.resource]),this.removeAuth=this.authResolver.isAuthorized("resource-removeBan_int_policy",[this.resource]),this.refresh()}refresh(){this.loading=!0,this.resourceService.getEnrichedBansForResource(this.resource.id,this.attrNames).subscribe({next:R=>{this.bans=R,this.selection.clear(),this.loading=!1},error:()=>this.loading=!1})}add(){const R=(0,E.kZ)();R.width="850px",R.data={entityId:this.resource.id,theme:"resource-theme",bans:this.bans.map(Q=>Q.ban)},this.dialog.open(i,R).afterClosed().subscribe(Q=>{Q&&this.refresh()})}remove(){const R=(0,E.kZ)();R.width="550px",R.data={theme:"resource-theme",title:"DIALOGS.REMOVE_BAN.TITLE",description:"DIALOGS.REMOVE_BAN.DESCRIPTION",items:[this.userName.transform(this.selection.selected[0].member.user)],type:"remove",showAsk:!0},this.dialog.open(C.Ts,R).afterClosed().subscribe(Q=>{Q&&this.resourceService.removeResourceBanById(this.selection.selected[0].ban.id).subscribe(()=>{this.notificator.showSuccess("DIALOGS.REMOVE_BAN.SUCCESS"),this.refresh()})})}update(R){const S=(0,E.kZ)();S.width="600px",S.data={ban:R.ban,theme:"facility-theme"},this.dialog.open(F.e,S).afterClosed().subscribe($=>{$&&this.refresh()})}}g.\u0275fac=function(R){return new(R||g)(e.Y36(a.xk),e.Y36(n.fb),e.Y36(n.x4),e.Y36(t.uw),e.Y36(n.V6),e.Y36(n.d6),e.Y36(N.dp))},g.\u0275cmp=e.Xpm({type:g,selectors:[["app-resource-settings-bans"]],features:[e._Bn([N.dp])],decls:11,vars:8,consts:[[1,"page-subtitle"],[3,"click"],["class","me-2 action-button","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","class","me-2","mat-flat-button","",3,"disabled","click",4,"ngIf"],[1,"mt-2","search-field",3,"placeholder","filter"],[1,"position-relative"],[3,"bans","selection","displayedColumns","filter","updatePolicy","updateBan",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["spinner",""],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"bans","selection","displayedColumns","filter","updatePolicy","updateBan"]],template:function(R,S){if(1&R&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("click",function(){return S.refresh()}),e.qZA(),e.YNc(4,q,3,3,"button",2),e.YNc(5,ee,3,4,"button",3),e.TgZ(6,"perun-web-apps-debounce-filter",4),e.NdJ("filter",function($){return S.filter=$}),e.qZA(),e.TgZ(7,"div",5),e.YNc(8,W,1,5,"perun-web-apps-ban-on-entity-list",6),e.qZA(),e.YNc(9,v,1,0,"ng-template",null,7,e.W1O)),2&R){const Q=e.MAs(10);e.xp6(1),e.hij(" ",e.lcZ(2,6,"RESOURCE_DETAIL.SETTINGS.BANS.TITLE"),"\n"),e.xp6(3),e.Q6J("ngIf",S.addAuth),e.xp6(1),e.Q6J("ngIf",S.removeAuth),e.xp6(1),e.Q6J("placeholder","RESOURCE_DETAIL.SETTINGS.BANS.FILTER"),e.xp6(2),e.Q6J("perunWebAppsLoader",S.loading)("perunWebAppsLoaderIndicator",Q)}},dependencies:[j.O5,L.lW,y.K,I.t,P.P,z.s,M.e,w.X$]})},20057:(te,k,o)=>{o.d(k,{O:()=>E});var a=o(95243),f=o(94650),n=o(28361);class E{constructor(s,t){this.guiAuthResolver=s,this.entityStorageService=t,this.availableRoles=[],this.type="Resource",this.theme="resource-theme"}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Resource")}}E.\u0275fac=function(s){return new(s||E)(f.Y36(a.x4),f.Y36(a.fb))},E.\u0275cmp=f.Xpm({type:E,selectors:[["app-resource-settings-managers"]],decls:1,vars:4,consts:[[3,"complementaryObject","availableRoles","complementaryObjectType","theme"]],template:function(s,t){1&s&&f._UZ(0,"app-managers-page",0),2&s&&f.Q6J("complementaryObject",t.resource)("availableRoles",t.availableRoles)("complementaryObjectType",t.type)("theme",t.theme)},dependencies:[n.s]})},16500:(te,k,o)=>{o.d(k,{h:()=>P});var a=o(61744),f=o(95243),n=o(94650),E=o(82761),C=o(36895),s=o(51572),t=o(71135);function e(x,D){1&x&&n._UZ(0,"mat-spinner",2)}function K(x,D){if(1&x&&(n.TgZ(0,"div"),n._UZ(1,"perun-web-apps-menu-buttons-field",3),n.qZA()),2&x){const i=n.oxw();n.xp6(1),n.Q6J("items",i.items)("size","small")}}class P{constructor(D,i,B,F,N){this.route=D,this.resourceManager=i,this.authResolver=B,this.entityStorageService=F,this.routePolicyService=N,this.items=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.initItems("facilities"!==this.route.parent.parent.parent.snapshot.url[0].path),this.loading=!1}initItems(D){this.items=[],this.routePolicyService.canNavigate("resources-settings-managers",this.resource)&&this.items.push({cssIcon:"perun-manager",url:`${D?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/managers`,label:"MENU_ITEMS.RESOURCE.MANAGERS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-settings-bans",this.resource)&&this.items.push({cssIcon:"perun-ban",url:`${D?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/bans`,label:"MENU_ITEMS.RESOURCE.BANS",style:"resource-btn"})}}P.\u0275fac=function(D){return new(D||P)(n.Y36(E.gz),n.Y36(a.xk),n.Y36(f.x4),n.Y36(f.fb),n.Y36(f.Ip))},P.\u0275cmp=n.Xpm({type:P,selectors:[["app-resource-settings-overview"]],hostVars:2,hostBindings:function(D,i){2&D&&n.ekj("router-component",i.true)},decls:2,vars:2,consts:[["class","me-auto ms-auto",4,"ngIf"],[4,"ngIf"],[1,"me-auto","ms-auto"],[3,"items","size"]],template:function(D,i){1&D&&(n.YNc(0,e,1,0,"mat-spinner",0),n.YNc(1,K,2,2,"div",1)),2&D&&(n.Q6J("ngIf",i.loading),n.xp6(1),n.Q6J("ngIf",!i.loading))},dependencies:[C.O5,s.Ou,t.L]})},60113:(te,k,o)=>{o.d(k,{t:()=>E});var a=o(36769),f=o(94650),n=o(61283);class E{}E.\u0275fac=function(s){return new(s||E)},E.\u0275cmp=f.Xpm({type:E,selectors:[["app-resource-settings"]],hostVars:2,hostBindings:function(s,t){2&s&&f.ekj("router-component",t.true)},decls:1,vars:0,template:function(s,t){1&s&&f._UZ(0,"app-animated-router-outlet")},dependencies:[n.A],data:{animation:[a.Ji]}})},20872:(te,k,o)=>{o.d(k,{v:()=>W});var a=o(61744),f=o(95017),n=o(15466),E=o(9244),C=o(95243),s=o(67791),t=o(7274),e=o(94650),K=o(4859),P=o(68530),x=o(73358),D=o(17672),i=o(89383);function B(v,g){1&v&&e._UZ(0,"perun-web-apps-loading-table")}function F(v,g){if(1&v&&e._UZ(0,"app-resources-tags-list",8),2&v){const A=e.oxw();e.Q6J("selection",A.selection)("displayedColumns",A.displayedColumns)("entity","resource")("filterValue",A.filterValue)("resourceTags",A.resourceTags)("tableId",A.tableId)}}class N{constructor(g,A,R){this.dialogRef=g,this.data=A,this.resourcesManager=R,this.tableId=n.g,this.selection=new f.Ov(!0,[]),this.resourceTags=[],this.displayedColumns=["select","id","name"]}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.voId=this.data.voId,this.resourceId=this.data.resourceId,this.assignedTags=this.data.assignedTags,this.resourcesManager.getAllResourcesTagsForVo(this.voId).subscribe(g=>{this.resourceTags=g.filter(A=>!this.assignedTags.map(R=>R.id).includes(A.id)),this.loading=!1})}onCancel(){this.dialogRef.close(!1)}onSubmit(g){this.resourcesManager.assignResourceTagsToResource({resource:this.resourceId,resourceTags:g}).subscribe(()=>{this.dialogRef.close(!0)})}applyFilter(g){this.filterValue=g}}N.\u0275fac=function(g){return new(g||N)(e.Y36(t.so),e.Y36(t.WI),e.Y36(a.xk))},N.\u0275cmp=e.Xpm({type:N,selectors:[["app-add-resource-tag-to-resource-dialog"]],decls:16,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["spinner",""],[1,"position-relative"],[3,"selection","displayedColumns","entity","filterValue","resourceTags","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-actions",""],["mat-flat-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"disabled","click"],[3,"selection","displayedColumns","entity","filterValue","resourceTags","tableId"]],template:function(g,A){if(1&g&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1),e.YNc(5,B,1,0,"ng-template",null,2,e.W1O),e.TgZ(7,"div",3),e.YNc(8,F,1,6,"app-resources-tags-list",4),e.qZA()(),e.TgZ(9,"div",5)(10,"button",6),e.NdJ("click",function(){return A.onCancel()}),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"button",7),e.NdJ("click",function(){return A.onSubmit(A.selection.selected)}),e._uU(14),e.ALo(15,"translate"),e.qZA()()()),2&g){const R=e.MAs(6);e.Tol(A.theme),e.xp6(2),e.Oqu(e.lcZ(3,9,"RESOURCE_DETAIL.TAGS.ADD_TAGS")),e.xp6(6),e.Q6J("perunWebAppsLoader",A.loading)("perunWebAppsLoaderIndicator",R),e.xp6(3),e.hij(" ",e.lcZ(12,11,"RESOURCE_DETAIL.TAGS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",A.loading||0===A.resourceTags.length),e.xp6(1),e.hij(" ",e.lcZ(15,13,"RESOURCE_DETAIL.TAGS.ADD_BUTTON")," ")}},dependencies:[K.lW,t.uh,t.xY,t.H8,P.K,x.e,D.o,i.X$]});var j=o(17584),L=o(36895),y=o(96214),I=o(7434);function z(v,g){if(1&v){const A=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){e.CHM(A);const S=e.oxw();return e.KtG(S.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&v&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.CREATE_BUTTON"),"\n"))}function M(v,g){if(1&v){const A=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){e.CHM(A);const S=e.oxw();return e.KtG(S.addTag())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&v&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"RESOURCE_DETAIL.TAGS.ADD_BUTTON"),"\n"))}function w(v,g){if(1&v){const A=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(A);const S=e.oxw();return e.KtG(S.removeTags())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&v){const A=e.oxw();e.Q6J("disabled",0===A.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"RESOURCE_DETAIL.TAGS.REMOVE_BUTTON"),"\n")}}function q(v,g){1&v&&e._UZ(0,"perun-web-apps-loading-table")}function ee(v,g){if(1&v&&e._UZ(0,"app-resources-tags-list",10),2&v){const A=e.oxw();e.Q6J("displayedColumns",A.displayedColumns)("entity","resource")("resourceTags",A.resourceTags)("filterValue",A.filterValue)("selection",A.selection)("tableId",A.tableId)}}class W{constructor(g,A,R,S,Q,$){this.authResolver=g,this.resourcesManager=A,this.dialog=R,this.notificator=S,this.translate=Q,this.entityStorageService=$,this.loading=!1,this.resourceTags=[],this.selection=new f.Ov(!0,[]),this.tableId=n.M8,this.displayedColumns=[]}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.setAuthRights(),this.updateData()}removeTags(){const g=(0,E.kZ)();g.width="450px",g.data={items:this.selection.selected.map(R=>R.tagName),title:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_TITLE",description:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_DESCRIPTION",theme:"resource-theme",type:"remove",showAsk:!0},this.dialog.open(s.Ts,g).afterClosed().subscribe(R=>{R&&this.resourcesManager.removeResourceTagsFromResource({resource:this.resource.id,resourceTags:this.selection.selected}).subscribe(()=>(this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.REMOVED_SUCCESSFULLY")),this.updateData()))})}addTag(){const g=(0,E.kZ)();g.width="600px",g.data={voId:this.resource.voId,resourceId:this.resource.id,assignedTags:this.resourceTags,theme:"resource-theme"},this.dialog.open(N,g).afterClosed().subscribe(R=>{R&&(this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.ADDED_SUCCESSFULLY")),this.updateData())})}create(){const g=(0,E.kZ)();g.width="450px",g.data={voId:this.resource.voId,theme:"resource-theme"},this.dialog.open(j.p,g).afterClosed().subscribe(R=>{R&&(this.notificator.showSuccess(this.translate.instant("VO_DETAIL.RESOURCES.TAGS.CREATE_SUCCESS")),this.updateData())})}updateData(){this.loading=!0,this.selection.clear(),this.resourcesManager.getAllResourcesTagsForResource(this.resource.id).subscribe(g=>{this.resourceTags=g,this.selection.clear(),this.loading=!1})}setAuthRights(){const g={id:this.resource.voId,beanName:"Vo"};this.displayedColumns=[],this.createAuth=this.authResolver.isAuthorized("createResourceTag_ResourceTag_Vo_policy",[g]),this.addAuth=this.authResolver.isAuthorized("assignResourceTagToResource_ResourceTag_Resource_policy",[this.resource]),this.removeAuth=this.authResolver.isAuthorized("removeResourceTagFromResource_ResourceTag_Resource_policy",[this.resource]),this.displayedColumns=this.removeAuth?["select","id","name"]:["id","name"]}applyFilter(g){this.filterValue=g}}W.\u0275fac=function(g){return new(g||W)(e.Y36(C.x4),e.Y36(a.xk),e.Y36(t.uw),e.Y36(C.V6),e.Y36(C.Te),e.Y36(C.fb))},W.\u0275cmp=e.Xpm({type:W,selectors:[["app-perun-web-apps-resource-tags"]],decls:12,vars:9,consts:[[1,"page-subtitle"],[3,"refresh"],["class","me-2 action-button","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","me-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative"],[3,"displayedColumns","entity","resourceTags","filterValue","selection","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"displayedColumns","entity","resourceTags","filterValue","selection","tableId"]],template:function(g,A){if(1&g&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){return A.updateData()}),e.qZA(),e.YNc(4,z,3,3,"button",2),e.YNc(5,M,3,3,"button",2),e.YNc(6,w,3,4,"button",3),e.TgZ(7,"perun-web-apps-immediate-filter",4),e.NdJ("filter",function(S){return A.applyFilter(S)}),e.qZA(),e.YNc(8,q,1,0,"ng-template",null,5,e.W1O),e.TgZ(10,"div",6),e.YNc(11,ee,1,6,"app-resources-tags-list",7),e.qZA()),2&g){const R=e.MAs(9);e.xp6(1),e.Oqu(e.lcZ(2,7,"RESOURCE_DETAIL.TAGS.TITLE")),e.xp6(3),e.Q6J("ngIf",A.createAuth),e.xp6(1),e.Q6J("ngIf",A.addAuth),e.xp6(1),e.Q6J("ngIf",A.removeAuth),e.xp6(1),e.Q6J("placeholder","RESOURCE_DETAIL.TAGS.SEARCH"),e.xp6(4),e.Q6J("perunWebAppsLoader",A.loading)("perunWebAppsLoaderIndicator",R)}},dependencies:[L.O5,K.lW,D.o,P.K,y.t,I.L,x.e,i.X$]})},83370:(te,k,o)=>{o.d(k,{u:()=>y});var a=o(94650),f=o(37433),n=o(36895),E=o(4859),C=o(7274),s=o(86257),t=o(98380),e=o(97403),K=o(29926),P=o(73358),x=o(89383);function D(I,z){1&I&&a._UZ(0,"perun-web-apps-loading-dialog")}function i(I,z){1&I&&(a.TgZ(0,"perun-web-apps-alert",15),a._uU(1),a.ALo(2,"translate"),a.qZA()),2&I&&(a.Q6J("alert_type","info"),a.xp6(1),a.hij(" ",a.lcZ(2,2,"DIALOGS.ADD_BAN.ALREADY_BANNED")," "))}function B(I,z){if(1&I){const M=a.EpF();a.TgZ(0,"button",16),a.NdJ("click",function(){a.CHM(M),a.oxw();const q=a.MAs(6);return a.KtG(q.next())}),a._uU(1),a.ALo(2,"translate"),a.qZA()}if(2&I){const M=a.oxw(2);a.Q6J("disabled",M.disabled),a.xp6(1),a.hij(" ",a.lcZ(2,2,"DIALOGS.ADD_BAN.NEXT")," ")}}function F(I,z){if(1&I){const M=a.EpF();a.TgZ(0,"button",17),a.NdJ("click",function(){a.CHM(M),a.oxw();const q=a.MAs(6);return a.KtG(q.previous())}),a._uU(1),a.ALo(2,"translate"),a.qZA()}2&I&&(a.xp6(1),a.hij(" ",a.lcZ(2,1,"DIALOGS.ADD_BAN.BACK")," "))}function N(I,z){if(1&I){const M=a.EpF();a.TgZ(0,"button",18),a.NdJ("click",function(){a.CHM(M);const q=a.oxw(2);return a.KtG(q.addBan())}),a._uU(1),a.ALo(2,"translate"),a.qZA()}if(2&I){const M=a.oxw(2);a.xp6(1),a.hij(" ",a.lcZ(2,1,M.ban?"DIALOGS.ADD_BAN.UPDATE":"DIALOGS.ADD_BAN.ADD")," ")}}function j(I,z){if(1&I){const M=a.EpF();a.TgZ(0,"div")(1,"h1",2),a._uU(2),a.ALo(3,"translate"),a.qZA(),a.TgZ(4,"div",3)(5,"mat-stepper",4,5)(7,"mat-step",6),a.ALo(8,"translate"),a.Hsn(9),a.qZA(),a.TgZ(10,"mat-step",7),a.ALo(11,"translate"),a.YNc(12,i,3,4,"perun-web-apps-alert",8),a._UZ(13,"perun-web-apps-ban-specification",9),a.qZA()()(),a.TgZ(14,"div",10)(15,"button",11),a.NdJ("click",function(){a.CHM(M);const q=a.oxw();return a.KtG(q.cancel.emit())}),a._uU(16),a.ALo(17,"translate"),a.qZA(),a.YNc(18,B,3,4,"button",12),a.YNc(19,F,3,3,"button",13),a.YNc(20,N,3,3,"button",14),a.qZA()()}if(2&I){const M=a.MAs(6),w=a.oxw();a.xp6(2),a.Oqu(a.lcZ(3,12,"DIALOGS.ADD_BAN.TITLE")),a.xp6(3),a.Q6J("linear",!0),a.xp6(2),a.Q6J("completed",!w.disabled)("label",a.lcZ(8,14,"DIALOGS.ADD_BAN.SELECTION")),a.xp6(3),a.Q6J("label",a.lcZ(11,16,"DIALOGS.ADD_BAN.SPECIFICATION")),a.xp6(2),a.Q6J("ngIf",w.ban),a.xp6(1),a.Q6J("description",null==w.ban?null:w.ban.description)("validity",null==w.ban?null:w.ban.validityTo),a.xp6(3),a.hij(" ",a.lcZ(17,18,"DIALOGS.ADD_BAN.CANCEL")," "),a.xp6(2),a.Q6J("ngIf",M.selectedIndex!==(null==M||null==M._steps?null:M._steps.length)-1),a.xp6(1),a.Q6J("ngIf",M.selectedIndex===(null==M||null==M._steps?null:M._steps.length)-1),a.xp6(1),a.Q6J("ngIf",M.selectedIndex===(null==M||null==M._steps?null:M._steps.length)-1)}}class y{constructor(){this.loading=!1,this.disabled=!1,this.add=new a.vpe,this.cancel=new a.vpe}addBan(){this.add.emit({description:this.banForm.getDescription(),validity:this.banForm.getValidity()})}}y.\u0275fac=function(z){return new(z||y)},y.\u0275cmp=a.Xpm({type:y,selectors:[["app-add-ban-dialog"]],viewQuery:function(z,M){if(1&z&&a.Gf(f.CZ,5),2&z){let w;a.iGM(w=a.CRH())&&(M.banForm=w.first)}},inputs:{loading:"loading",disabled:"disabled",theme:"theme",ban:"ban"},outputs:{add:"add",cancel:"cancel"},ngContentSelectors:["*"],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[3,"linear"],["stepper",""],[3,"completed","label"],[3,"label"],[3,"alert_type",4,"ngIf"],[3,"description","validity"],["mat-dialog-actions",""],["mat-flat-button","",1,"ms-auto","me-2",3,"click"],["mat-flat-button","","class","me-2","color","accent",3,"disabled","click",4,"ngIf"],["mat-flat-button","","class","me-2",3,"click",4,"ngIf"],["mat-flat-button","","color","accent",3,"click",4,"ngIf"],[3,"alert_type"],["mat-flat-button","","color","accent",1,"me-2",3,"disabled","click"],["mat-flat-button","",1,"me-2",3,"click"],["mat-flat-button","","color","accent",3,"click"]],template:function(z,M){if(1&z&&(a.F$t(),a.YNc(0,D,1,0,"ng-template",null,0,a.W1O),a.TgZ(2,"div"),a.YNc(3,j,21,20,"div",1),a.qZA()),2&z){const w=a.MAs(1);a.xp6(2),a.Gre("",M.theme," position-relative"),a.xp6(1),a.Q6J("perunWebAppsLoader",M.loading)("perunWebAppsLoaderIndicator",w)}},dependencies:[n.O5,E.lW,C.uh,C.xY,C.H8,s.C0,s.Vq,t.w,e.b,K.C,P.e,x.X$]})},17584:(te,k,o)=>{o.d(k,{p:()=>i});var a=o(7274),f=o(61744),n=o(94650),E=o(284),C=o(59549),s=o(24006),t=o(4859),e=o(97403),K=o(73358),P=o(89383);function x(B,F){1&B&&n._UZ(0,"perun-web-apps-loading-dialog")}function D(B,F){if(1&B){const N=n.EpF();n.TgZ(0,"div")(1,"h1",2),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"div",3)(5,"mat-form-field")(6,"mat-label"),n._uU(7),n.ALo(8,"translate"),n.qZA(),n.TgZ(9,"input",4),n.NdJ("ngModelChange",function(L){n.CHM(N);const y=n.oxw();return n.KtG(y.name=L)}),n.qZA(),n.TgZ(10,"mat-error"),n._uU(11),n.ALo(12,"translate"),n.qZA()()(),n.TgZ(13,"div",5)(14,"button",6),n.NdJ("click",function(){n.CHM(N);const L=n.oxw();return n.KtG(L.onCancel())}),n._uU(15),n.ALo(16,"translate"),n.qZA(),n.TgZ(17,"button",7),n.NdJ("click",function(){n.CHM(N);const L=n.oxw();return n.KtG(L.onSubmit())}),n._uU(18),n.ALo(19,"translate"),n.qZA()()()}if(2&B){const N=n.oxw();n.xp6(2),n.Oqu(n.lcZ(3,7,"DIALOGS.CREATE_RESOURCE_TAG.TITLE")),n.xp6(5),n.Oqu(n.lcZ(8,9,"DIALOGS.CREATE_RESOURCE_TAG.NAME")),n.xp6(2),n.Q6J("ngModel",N.name),n.xp6(2),n.Oqu(n.lcZ(12,11,"DIALOGS.CREATE_RESOURCE_TAG.EMPTY_NAME")),n.xp6(4),n.hij(" ",n.lcZ(16,13,"DIALOGS.CREATE_RESOURCE_TAG.CANCEL")," "),n.xp6(2),n.Q6J("disabled",N.loading),n.xp6(1),n.hij(" ",n.lcZ(19,15,"DIALOGS.CREATE_RESOURCE_TAG.CREATE")," ")}}class i{constructor(F,N,j){this.dialogRef=F,this.data=N,this.resourceManager=j,this.name="",this.loading=!1}ngOnInit(){this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){""!==this.name&&(this.loading=!0,this.resourceManager.createResourceTagWithTagName(this.name,this.data.voId).subscribe(()=>{this.dialogRef.close(!0)},()=>this.loading=!1))}}i.\u0275fac=function(F){return new(F||i)(n.Y36(a.so),n.Y36(a.WI),n.Y36(f.xk))},i.\u0275cmp=n.Xpm({type:i,selectors:[["app-create-resource-tag-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],["matInput","","required","",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-flat-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"disabled","click"]],template:function(F,N){if(1&F&&(n.YNc(0,x,1,0,"ng-template",null,0,n.W1O),n.TgZ(2,"div"),n.YNc(3,D,20,17,"div",1),n.qZA()),2&F){const j=n.MAs(1);n.xp6(2),n.Gre("",N.theme," position-relative"),n.xp6(1),n.Q6J("perunWebAppsLoader",N.loading)("perunWebAppsLoaderIndicator",j)}},dependencies:[E.Nt,C.KE,C.hX,C.TO,s.Fj,s.JJ,s.Q7,s.On,t.lW,a.uh,a.xY,a.H8,e.b,K.e,P.X$]})},28361:(te,k,o)=>{o.d(k,{s:()=>ge});var a=o(95017),f=o(7274),n=o(95243),E=o(61744),C=o(15466),s=o(6134),t=o(24006),e=o(94650),K=o(89383),P=o(82761),x=o(36895),D=o(3238),i=o(284),B=o(59549),F=o(4859),N=o(84385),j=o(68530),L=o(55755),y=o(73358),I=o(64877),z=o(23123);function M(u,c){if(1&u&&(e.TgZ(0,"mat-option",14),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&u){const r=c.$implicit;e.Q6J("value",r.roleName),e.xp6(1),e.hij(" ",e.lcZ(2,2,r)," ")}}function w(u,c){1&u&&e._UZ(0,"perun-web-apps-loading-table")}const q=function(){return["select","id","name","email","logins","organization"]};function ee(u,c){if(1&u&&e._UZ(0,"app-users-list",17),2&u){const r=e.oxw(2);e.Q6J("disableRouting",!0)("selection",r.selection)("displayedColumns",e.DdM(5,q))("tableId",r.tableId)("users",r.users)}}function W(u,c){if(1&u&&(e.TgZ(0,"div",15),e.YNc(1,ee,1,6,"app-users-list",16),e.qZA()),2&u){const r=e.oxw(),O=e.MAs(24);e.xp6(1),e.Q6J("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",O)}}class v{constructor(c,r,O,G,se,ue,_e,Re,Ee){this.dialogRef=c,this.data=r,this.authzService=O,this.usersService=G,this.translate=se,this.notificator=ue,this.storeService=_e,this.route=Re,this.router=Ee,this.selection=new a.Ov(!0,[]),this.users=[],this.firstSearchDone=!1,this.tableId=C.H2,se.get("DIALOGS.ADD_MANAGERS.TITLE").subscribe(pe=>this.title=pe),se.get("DIALOGS.ADD_MANAGERS.SUCCESS").subscribe(pe=>this.successMessage=pe)}ngOnInit(){this.theme=this.data.theme,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.searchCtrl=new t.p4("",[t.kI.required,t.kI.pattern(".*[\\S]+.*")])}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.setRoleWithUserComplementaryObject({role:this.selectedRole,users:this.selection.selected.map(c=>c.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}onSearchByString(){if(this.searchCtrl.invalid)return void this.searchCtrl.markAllAsTouched();this.loading=!0,this.firstSearchDone=!0,this.selection.clear();let c=[s.r.USER_DEF_ORGANIZATION,s.r.USER_DEF_PREFERRED_MAIL];c=c.concat(this.storeService.getLoginAttributeNames()),this.usersService.findRichUsersWithAttributes(this.searchCtrl.value,c).subscribe({next:r=>{this.users=r,this.loading=!1},error:()=>this.loading=!1})}}v.\u0275fac=function(c){return new(c||v)(e.Y36(f.so),e.Y36(f.WI),e.Y36(E.Ct),e.Y36(E.Fv),e.Y36(K.sK),e.Y36(n.V6),e.Y36(n.d6),e.Y36(P.gz),e.Y36(P.F0))},v.\u0275cmp=e.Xpm({type:v,selectors:[["app-add-manager-dialog"]],decls:33,vars:30,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"me-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"me-2","w-100"],["matInput","","autocomplete","false","data-cy","search-manager-input","perunWebAppsAutoFocus","",3,"formControl","keyup.enter"],["color","accent","data-cy","search-manager-button","mat-flat-button","",1,"ms-auto",3,"disabled","click"],["spinner",""],["class","position-relative mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ms-auto",3,"click"],["color","accent","data-cy","add-manager-button-dialog","mat-flat-button","",1,"ms-2",3,"disabled","click"],[3,"value"],[1,"position-relative","mt-3"],[3,"disableRouting","selection","displayedColumns","tableId","users",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"disableRouting","selection","displayedColumns","tableId","users"]],template:function(c,r){1&c&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1)(5,"div",2)(6,"mat-form-field",3)(7,"mat-label"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"mat-select",4),e.NdJ("valueChange",function(G){return r.selectedRole=G}),e.YNc(11,M,3,4,"mat-option",5),e.qZA()(),e.TgZ(12,"mat-form-field",6)(13,"mat-label"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"input",7),e.NdJ("keyup.enter",function(){return r.onSearchByString()}),e.qZA(),e.TgZ(17,"mat-error"),e._uU(18),e.ALo(19,"translate"),e.qZA()()(),e.TgZ(20,"button",8),e.NdJ("click",function(){return r.onSearchByString()}),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.YNc(23,w,1,0,"ng-template",null,9,e.W1O),e.YNc(25,W,2,2,"div",10),e.qZA(),e.TgZ(26,"div",11)(27,"button",12),e.NdJ("click",function(){return r.onCancel()}),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"button",13),e.NdJ("click",function(){return r.onSubmit()}),e._uU(31),e.ALo(32,"translate"),e.qZA()()()),2&c&&(e.Tol(r.theme),e.xp6(2),e.Oqu(e.lcZ(3,16,"DIALOGS.ADD_MANAGERS.TITLE")),e.xp6(6),e.Oqu(e.lcZ(9,18,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",r.selectedRole),e.xp6(1),e.Q6J("ngForOf",r.availableRoles),e.xp6(3),e.Oqu(e.lcZ(15,20,"DIALOGS.ADD_MANAGERS.DESCRIPTION")),e.xp6(2),e.Q6J("formControl",r.searchCtrl),e.xp6(2),e.hij(" ",e.lcZ(19,22,"DIALOGS.ADD_MANAGERS.EMPTY_SEARCH_MESSAGE")," "),e.xp6(2),e.Q6J("disabled",r.loading),e.xp6(1),e.hij(" ",e.lcZ(22,24,"DIALOGS.ADD_MANAGERS.SEARCH")," "),e.xp6(4),e.Q6J("ngIf",r.firstSearchDone),e.xp6(3),e.hij(" ",e.lcZ(29,26,"DIALOGS.ADD_MANAGERS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",0===r.selection.selected.length||void 0===r.selectedRole||r.loading),e.xp6(1),e.hij(" ",e.lcZ(32,28,"DIALOGS.ADD_MANAGERS.CREATE")," "))},dependencies:[x.sg,x.O5,D.ey,i.Nt,B.KE,B.hX,B.TO,t.Fj,t.JJ,t.oH,F.lW,f.uh,f.xY,f.H8,N.gD,j.K,L.hT,y.e,I.C,K.X$,z.i],styles:[".inline-dialog-items[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]});var g=o(30671),A=o(98380),R=o(97403);function S(u,c){1&u&&e._UZ(0,"perun-web-apps-loading-dialog")}function Q(u,c){1&u&&e._UZ(0,"th",15)}function $(u,c){if(1&u&&(e.TgZ(0,"td",16),e._uU(1),e.qZA()),2&u){const r=c.$implicit;e.xp6(1),e.AsE("",r.firstName," ",r.lastName,"")}}function ne(u,c){1&u&&e._UZ(0,"tr",17)}function re(u,c){1&u&&e._UZ(0,"tr",18)}const ie=function(u){return{role:u}};function ae(u,c){if(1&u&&(e.TgZ(0,"perun-web-apps-alert",19),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.qZA()),2&u){const r=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,"DIALOGS.REMOVE_MANAGERS.WARNING_REMOVE_YOURSELF",e.VKq(6,ie,e.lcZ(3,4,"ROLES."+r.data.role)))," ")}}function V(u,c){if(1&u){const r=e.EpF();e.TgZ(0,"div")(1,"h1",2),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",3)(5,"p"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div",4),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"table",5),e.ynx(12,6),e.YNc(13,Q,1,0,"th",7),e.YNc(14,$,2,2,"td",8),e.BQk(),e.YNc(15,ne,1,0,"tr",9),e.YNc(16,re,1,0,"tr",10),e.qZA(),e.YNc(17,ae,4,8,"perun-web-apps-alert",11),e.qZA(),e.TgZ(18,"div",12)(19,"button",13),e.NdJ("click",function(){e.CHM(r);const G=e.oxw();return e.KtG(G.onCancel())}),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"button",14),e.NdJ("click",function(){e.CHM(r);const G=e.oxw();return e.KtG(G.onSubmit())}),e._uU(23),e.ALo(24,"translate"),e.qZA()()()}if(2&u){const r=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,10,"DIALOGS.REMOVE_MANAGERS.TITLE")),e.xp6(4),e.hij(" ",e.lcZ(7,12,"DIALOGS.REMOVE_MANAGERS.DESCRIPTION")," "),e.xp6(3),e.hij(" ",e.lcZ(10,14,"DIALOGS.REMOVE_MANAGERS.ASK")," "),e.xp6(2),e.Q6J("dataSource",r.dataSource),e.xp6(4),e.Q6J("matHeaderRowDef",r.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",r.displayedColumns),e.xp6(1),e.Q6J("ngIf",r.removeSelf),e.xp6(3),e.hij(" ",e.lcZ(21,16,"DIALOGS.REMOVE_MANAGERS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",r.loading),e.xp6(1),e.hij(" ",e.lcZ(24,18,"DIALOGS.REMOVE_MANAGERS.DELETE")," ")}}class Y{constructor(c,r,O,G,se,ue,_e){this.dialogRef=c,this.data=r,this.notificator=O,this.translate=G,this.authzService=se,this.store=ue,this.authService=_e,this.displayedColumns=["name"]}ngOnInit(){this.dataSource=new g.by(this.data.managers),this.theme=this.data.theme,this.removeSelf=this.data.managers.map(c=>c.id).includes(this.store.getPerunPrincipal().userId)&&!this.authService.isPerunAdmin()}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithUserComplementaryObject({role:this.data.role,users:this.data.managers.map(c=>c.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_MANAGERS.SUCCESS").subscribe(c=>{this.notificator.showSuccess(c),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)},()=>this.loading=!1)}}function m(u,c){1&u&&e._UZ(0,"perun-web-apps-loading-dialog")}function p(u,c){1&u&&e._UZ(0,"th",14)}function l(u,c){if(1&u&&(e.TgZ(0,"td",15),e._uU(1),e.qZA()),2&u){const r=c.$implicit;e.xp6(1),e.Oqu(r.name)}}function h(u,c){1&u&&e._UZ(0,"tr",16)}function d(u,c){1&u&&e._UZ(0,"tr",17)}function Z(u,c){if(1&u){const r=e.EpF();e.TgZ(0,"div")(1,"h1",2),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",3)(5,"p"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div",4),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"table",5),e.ynx(12,6),e.YNc(13,p,1,0,"th",7),e.YNc(14,l,2,1,"td",8),e.BQk(),e.YNc(15,h,1,0,"tr",9),e.YNc(16,d,1,0,"tr",10),e.qZA()(),e.TgZ(17,"div",11)(18,"button",12),e.NdJ("click",function(){e.CHM(r);const G=e.oxw();return e.KtG(G.onCancel())}),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"button",13),e.NdJ("click",function(){e.CHM(r);const G=e.oxw();return e.KtG(G.onSubmit())}),e._uU(22),e.ALo(23,"translate"),e.qZA()()()}if(2&u){const r=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,9,"DIALOGS.REMOVE_GROUPS.TITLE")),e.xp6(4),e.hij(" ",e.lcZ(7,11,"DIALOGS.REMOVE_GROUPS.DESCRIPTION")," "),e.xp6(3),e.hij(" ",e.lcZ(10,13,"DIALOGS.REMOVE_GROUPS.ASK")," "),e.xp6(2),e.Q6J("dataSource",r.dataSource),e.xp6(4),e.Q6J("matHeaderRowDef",r.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",r.displayedColumns),e.xp6(3),e.hij(" ",e.lcZ(20,15,"DIALOGS.REMOVE_GROUPS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",r.loading),e.xp6(1),e.hij(" ",e.lcZ(23,17,"DIALOGS.REMOVE_GROUPS.DELETE")," ")}}Y.\u0275fac=function(c){return new(c||Y)(e.Y36(f.so),e.Y36(f.WI),e.Y36(n.V6),e.Y36(K.sK),e.Y36(E.Ct),e.Y36(n.d6),e.Y36(n.x4))},Y.\u0275cmp=e.Xpm({type:Y,selectors:[["app-remove-manager-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ms-auto",3,"click"],["color","warn","data-cy","remove-manager-button-dialog","mat-flat-button","",1,"ms-2",3,"disabled","click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""],["alert_type","warn"]],template:function(c,r){if(1&c&&(e.YNc(0,S,1,0,"ng-template",null,0,e.W1O),e.TgZ(2,"div"),e.YNc(3,V,25,20,"div",1),e.qZA()),2&c){const O=e.MAs(1);e.xp6(2),e.Gre("",r.theme," position-relative"),e.xp6(1),e.Q6J("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",O)}},dependencies:[x.O5,F.lW,g.BZ,g.fO,g.as,g.w1,g.Dz,g.nj,g.ge,g.ev,g.XQ,g.Gk,f.uh,f.xY,f.H8,A.w,R.b,y.e,K.X$]});class X{constructor(c,r,O,G,se){this.dialogRef=c,this.data=r,this.notificator=O,this.translate=G,this.authzService=se,this.displayedColumns=["name"]}ngOnInit(){this.dataSource=new g.by(this.data.groups),this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithGroupComplementaryObject({role:this.data.role,authorizedGroups:this.data.groups.map(c=>c.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUPS.SUCCESS").subscribe(c=>{this.notificator.showSuccess(c),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)},()=>this.loading=!1)}}X.\u0275fac=function(c){return new(c||X)(e.Y36(f.so),e.Y36(f.WI),e.Y36(n.V6),e.Y36(K.sK),e.Y36(E.Ct))},X.\u0275cmp=e.Xpm({type:X,selectors:[["app-remove-group-manager-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-flat-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"disabled","click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(c,r){if(1&c&&(e.YNc(0,m,1,0,"ng-template",null,0,e.W1O),e.TgZ(2,"div"),e.YNc(3,Z,24,19,"div",1),e.qZA()),2&c){const O=e.MAs(1);e.xp6(2),e.Gre("",r.theme," position-relative"),e.xp6(1),e.Q6J("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",O)}},dependencies:[F.lW,g.BZ,g.fO,g.as,g.w1,g.Dz,g.nj,g.ge,g.ev,g.XQ,g.Gk,f.uh,f.xY,f.H8,R.b,y.e,K.X$]});var oe=o(68675),ce=o(54004),T=o(47957),b=o(25788),_=o(64901);function U(u,c){if(1&u&&(e.TgZ(0,"mat-option",16),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&u){const r=c.$implicit;e.Q6J("value",r.roleName),e.xp6(1),e.hij(" ",e.lcZ(2,2,r)," ")}}function J(u,c){if(1&u&&(e.TgZ(0,"mat-option",16),e._uU(1),e.qZA()),2&u){const r=c.$implicit;e.Q6J("value",r),e.xp6(1),e.hij(" ",r.name," ")}}function H(u,c){if(1&u){const r=e.EpF();e.TgZ(0,"perun-web-apps-debounce-filter",17),e.NdJ("filter",function(G){e.CHM(r);const se=e.oxw();return e.KtG(se.applyFilter(G))}),e.ALo(1,"translate"),e.qZA()}2&u&&e.s9C("placeholder",e.lcZ(1,1,"DIALOGS.ADD_GROUPS.FILTER_GROUPS"))}function le(u,c){1&u&&e._UZ(0,"perun-web-apps-loading-table")}const de=function(){return["select","id","name","description"]};function Ae(u,c){if(1&u&&e._UZ(0,"perun-web-apps-groups-list",20),2&u){const r=e.oxw(2);e.Q6J("disableMembers",!1)("disableRouting",!0)("displayedColumns",e.DdM(7,de))("selection",r.selection)("groups",r.groups)("filter",r.filterValue)("tableId",r.tableId)}}function be(u,c){if(1&u&&(e.TgZ(0,"div",18),e.YNc(1,Ae,1,8,"perun-web-apps-groups-list",19),e.qZA()),2&u){const r=e.oxw(),O=e.MAs(24);e.xp6(1),e.Q6J("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",O)}}class me{constructor(c,r,O,G,se,ue,_e,Re,Ee){this.dialogRef=c,this.data=r,this.authzService=O,this.voService=G,this.groupService=se,this.translate=ue,this.notificator=_e,this.route=Re,this.router=Ee,this.searchString="",this.selection=new a.Ov(!0,[]),this.groups=[],this.vos=[],this.filterValue="",this.myControl=new t.p4,this.firstSearchDone=!1,this.tableId=C.kZ,ue.get("DIALOGS.ADD_GROUPS.TITLE").subscribe(pe=>this.title=pe),ue.get("DIALOGS.ADD_GROUPS.SUCCESS").subscribe(pe=>this.successMessage=pe)}displayFn(c){return c?c.name:null}onCancel(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.authzService.setRoleWithGroupComplementaryObject({role:this.selectedRole,authorizedGroups:this.selection.selected.map(c=>c.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}ngOnInit(){this.loading=!0,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.theme=this.data.theme,this.voService.getMyVos().subscribe({next:c=>{this.filteredOptions=this.myControl.valueChanges.pipe((0,oe.O)(""),(0,ce.U)(r=>this._filter(r))),this.vos=c,this.loading=!1},error:()=>this.loading=!1})}showVoGroups(c){this.loading=!0,this.firstSearchDone=!0,this.groupService.getAllGroups(c.option.value.id).subscribe({next:r=>{this.groups=r,this.loading=!1},error:()=>this.loading=!1})}applyFilter(c){this.filterValue=c}_filter(c){const r="string"==typeof c?c.toLowerCase():c.name.toLowerCase();return this.vos.filter(O=>O.name.toLowerCase().includes(r))}}me.\u0275fac=function(c){return new(c||me)(e.Y36(f.so),e.Y36(f.WI),e.Y36(E.Ct),e.Y36(E.YF),e.Y36(E.ff),e.Y36(K.sK),e.Y36(n.V6),e.Y36(P.gz),e.Y36(P.F0))},me.\u0275cmp=e.Xpm({type:me,selectors:[["app-add-group-manager-dialog"]],decls:33,vars:32,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"me-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"me-2","w-75"],["aria-label","Assignee","matInput","","type","text",3,"formControl","matAutocomplete","placeholder"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"placeholder","filter",4,"ngIf"],["spinner",""],["class","position-relative mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"disabled","click"],[3,"value"],[3,"placeholder","filter"],[1,"position-relative","mt-3"],[3,"disableMembers","disableRouting","displayedColumns","selection","groups","filter","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"disableMembers","disableRouting","displayedColumns","selection","groups","filter","tableId"]],template:function(c,r){if(1&c&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1)(5,"div",2)(6,"mat-form-field",3)(7,"mat-label"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"mat-select",4),e.NdJ("valueChange",function(G){return r.selectedRole=G}),e.YNc(11,U,3,4,"mat-option",5),e.qZA()(),e.TgZ(12,"mat-form-field",6)(13,"mat-label"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e._UZ(16,"input",7),e.ALo(17,"translate"),e.TgZ(18,"mat-autocomplete",8,9),e.NdJ("optionSelected",function(G){return r.showVoGroups(G)}),e.YNc(20,J,2,2,"mat-option",5),e.ALo(21,"async"),e.qZA()()(),e.YNc(22,H,2,3,"perun-web-apps-debounce-filter",10),e.YNc(23,le,1,0,"ng-template",null,11,e.W1O),e.YNc(25,be,2,2,"div",12),e.qZA(),e.TgZ(26,"div",13)(27,"button",14),e.NdJ("click",function(){return r.onCancel()}),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"button",15),e.NdJ("click",function(){return r.onSubmit()}),e._uU(31),e.ALo(32,"translate"),e.qZA()()()),2&c){const O=e.MAs(19);e.Tol(r.theme),e.xp6(2),e.Oqu(e.lcZ(3,18,"DIALOGS.ADD_GROUPS.TITLE")),e.xp6(6),e.Oqu(e.lcZ(9,20,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",r.selectedRole),e.xp6(1),e.Q6J("ngForOf",r.availableRoles),e.xp6(3),e.Oqu(e.lcZ(15,22,"DIALOGS.ADD_GROUPS.SELECT_VO")),e.xp6(2),e.s9C("placeholder",e.lcZ(17,24,"DIALOGS.ADD_GROUPS.SELECT_VO")),e.Q6J("formControl",r.myControl)("matAutocomplete",O),e.xp6(2),e.Q6J("displayWith",r.displayFn),e.xp6(2),e.Q6J("ngForOf",e.lcZ(21,26,r.filteredOptions)),e.xp6(2),e.Q6J("ngIf",null!==r.groups&&r.groups.length>0&&!r.loading),e.xp6(3),e.Q6J("ngIf",r.firstSearchDone),e.xp6(3),e.hij(" ",e.lcZ(29,28,"DIALOGS.ADD_MANAGERS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",0===r.selection.selected.length||r.loading),e.xp6(1),e.hij(" ",e.lcZ(32,30,"DIALOGS.ADD_MANAGERS.CREATE")," ")}},dependencies:[x.sg,x.O5,T.XC,D.ey,T.ZL,i.Nt,B.KE,B.hX,t.Fj,t.JJ,t.oH,F.lW,f.uh,f.xY,f.H8,N.gD,j.K,b.W,_.P,y.e,x.Ov,K.X$,z.i]});var he=o(9244),ve=o(15003),fe=o(3848),Te=o(96214);function Ce(u,c){1&u&&(e._uU(0),e.ALo(1,"translate")),2&u&&e.hij(" ",e.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.USER")," ")}function Se(u,c){if(1&u){const r=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(r);const G=e.oxw(2);return e.KtG(G.addManager())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&u&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function Oe(u,c){if(1&u){const r=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(r);const G=e.oxw(2);return e.KtG(G.removeManager())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&u){const r=e.oxw(2);e.Q6J("disabled",0===r.selectionUsers.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function De(u,c){if(1&u&&(e.TgZ(0,"mat-option",15),e.ALo(1,"lowercase"),e._uU(2),e.ALo(3,"displayedRole"),e.qZA()),2&u){const r=c.$implicit;e.Q6J("value",r.roleName),e.uIk("data-cy",e.lcZ(1,3,r.roleName)),e.xp6(2),e.hij(" ",e.lcZ(3,5,r)," ")}}function Ie(u,c){1&u&&e._UZ(0,"perun-web-apps-loading-table")}function Me(u,c){if(1&u&&e._UZ(0,"app-users-list",18),2&u){const r=e.oxw(3);e.Q6J("disableSelf",r.disableSelf)("tableId",r.tableId)("disableRouting",!r.routeAuth||r.disableRouting)("displayedColumns",r.displayedUserColumns)("selection",r.selectionUsers)("users",r.managers)}}function xe(u,c){if(1&u&&(e.TgZ(0,"div",16),e.YNc(1,Me,1,6,"app-users-list",17),e.qZA()),2&u){e.oxw();const r=e.MAs(10),O=e.oxw();e.xp6(1),e.Q6J("perunWebAppsLoader",O.loading)("perunWebAppsLoaderIndicator",r)}}function Le(u,c){if(1&u){const r=e.EpF();e.TgZ(0,"perun-web-apps-refresh-button",5),e.NdJ("refresh",function(){e.CHM(r);const G=e.oxw();return e.KtG(G.refreshUsers())}),e.qZA(),e.YNc(1,Se,3,3,"button",6),e.YNc(2,Oe,3,4,"button",7),e.TgZ(3,"mat-form-field",8)(4,"mat-label"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"mat-select",9),e.NdJ("selectionChange",function(){e.CHM(r);const G=e.oxw();return e.KtG(G.refreshUsers())})("valueChange",function(G){e.CHM(r);const se=e.oxw();return e.KtG(se.selectedRole=G)}),e.YNc(8,De,4,7,"mat-option",10),e.qZA()(),e.YNc(9,Ie,1,0,"ng-template",null,11,e.W1O),e.YNc(11,xe,2,2,"div",12)}if(2&u){const r=e.oxw();e.xp6(1),e.Q6J("ngIf",r.manageAuth&&!r.configMode),e.xp6(1),e.Q6J("ngIf",r.manageAuth&&!r.configMode),e.xp6(3),e.Oqu(e.lcZ(6,6,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",r.selectedRole),e.xp6(1),e.Q6J("ngForOf",r.availableRoles),e.xp6(3),e.Q6J("ngIf",r.managers)}}function Ze(u,c){1&u&&(e._uU(0),e.ALo(1,"translate")),2&u&&e.hij(" ",e.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.GROUP")," ")}function Ue(u,c){if(1&u){const r=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(r);const G=e.oxw(2);return e.KtG(G.addGroup())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&u&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function Ge(u,c){if(1&u){const r=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(r);const G=e.oxw(2);return e.KtG(G.removeGroup())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&u){const r=e.oxw(2);e.Q6J("disabled",0===r.selectionGroups.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function ye(u,c){if(1&u&&(e.TgZ(0,"mat-option",15),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&u){const r=c.$implicit;e.Q6J("value",r.roleName),e.xp6(1),e.Oqu(e.lcZ(2,2,r))}}function Pe(u,c){1&u&&e._UZ(0,"perun-web-apps-loading-table")}function Ne(u,c){if(1&u&&e._UZ(0,"perun-web-apps-groups-list",25),2&u){const r=e.oxw(3);e.Q6J("disableMembers",!1)("disableRouting",r.disableRouting)("displayedColumns",r.displayedGroupColumns)("groups",r.groups)("selection",r.selectionGroups)("tableId",r.tableId)}}function Ye(u,c){if(1&u&&(e.TgZ(0,"div",16),e.YNc(1,Ne,1,6,"perun-web-apps-groups-list",24),e.qZA()),2&u){e.oxw();const r=e.MAs(10),O=e.oxw();e.xp6(1),e.Q6J("perunWebAppsLoader",O.loading)("perunWebAppsLoaderIndicator",r)}}function we(u,c){if(1&u){const r=e.EpF();e.TgZ(0,"perun-web-apps-refresh-button",5),e.NdJ("refresh",function(){e.CHM(r);const G=e.oxw();return e.KtG(G.refreshGroups())}),e.qZA(),e.YNc(1,Ue,3,3,"button",19),e.YNc(2,Ge,3,4,"button",20),e.TgZ(3,"mat-form-field",21)(4,"mat-label"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"mat-select",9),e.NdJ("selectionChange",function(){e.CHM(r);const G=e.oxw();return e.KtG(G.refreshGroups())})("valueChange",function(G){e.CHM(r);const se=e.oxw();return e.KtG(se.selectedRole=G)}),e.YNc(8,ye,3,4,"mat-option",10),e.qZA()(),e.YNc(9,Pe,1,0,"ng-template",null,11,e.W1O),e.YNc(11,Ye,2,2,"div",12)}if(2&u){const r=e.oxw();e.xp6(1),e.Q6J("ngIf",r.manageAuth&&!r.configMode),e.xp6(1),e.Q6J("ngIf",r.manageAuth&&!r.configMode),e.xp6(3),e.Oqu(e.lcZ(6,6,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",r.selectedRole),e.xp6(1),e.Q6J("ngForOf",r.availableRoles),e.xp6(3),e.Q6J("ngIf",r.groups)}}function Je(u,c){1&u&&(e.TgZ(0,"perun-web-apps-alert",26),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&u&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.NO_AVAILABLE_ROLES"),"\n"))}class ge{constructor(c,r,O,G,se,ue,_e){this.dialog=c,this.authzService=r,this.storeService=O,this.guiAuthResolver=G,this.router=se,this.reloadEntityDetail=ue,this.route=_e,this.configMode=!1,this.disableRouting=!1,this.disableSelf=!1,this.displayedUserColumns=["select","id","name","email","logins","organization"],this.displayedGroupColumns=["select","id","vo","name","description"],this.groups=[],this.managers=null,this.selectionUsers=new a.Ov(!0,[]),this.selectionGroups=new a.Ov(!0,[]),this.selectedMode="",this.loading=!1,this.tableId=C.HC,this.availableRolesPrivileges=new Map}ngOnInit(){this.loading=!0,this.routeAuth=this.guiAuthResolver.isPerunAdminOrObserver(),this.guiAuthResolver.setRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(c=>this.availableRolesPrivileges.get(c.roleName).readAuth),0!==this.availableRoles.length&&(this.selectedRole=this.availableRoles[0].roleName),this.refreshUsers()}changeRolePrivileges(){this.guiAuthResolver.setRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(r=>this.availableRolesPrivileges.get(r.roleName).readAuth),this.manageAuth=this.availableRolesPrivileges.get(this.selectedRole).manageAuth,this.displayedUserColumns=this.manageAuth?this.displayedUserColumns:this.displayedUserColumns.filter(r=>"select"!==r),this.displayedGroupColumns=this.manageAuth?this.displayedGroupColumns:this.displayedGroupColumns.filter(r=>"select"!==r),this.roleModes=this.availableRolesPrivileges.get(this.selectedRole).modes;let c=!1;for(const r of this.roleModes)if(this.selectedMode===r.toLowerCase()){c=!0;break}c||(this.selectedMode=this.roleModes[0].toLowerCase())}tabChanged(c){this.loading=!0,0===c.index?(this.selectedMode="user",this.refreshUsers()):(this.selectedMode="group",this.refreshGroups())}refreshUsers(){this.loading=!0,this.changeRolePrivileges();let c=[s.r.USER_DEF_ORGANIZATION,s.r.USER_DEF_PREFERRED_MAIL];c=c.concat(this.storeService.getLoginAttributeNames()),this.authzService.getAuthzRichAdmins(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType,c,!1,!0).subscribe({next:r=>{this.managers=r,this.selectionUsers.clear(),this.loading=!1},error:()=>{this.loading=!1}})}refreshGroups(){this.loading=!0,this.changeRolePrivileges(),this.authzService.getAuthzAdminGroups(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType).subscribe({next:c=>{this.groups=c,this.selectionGroups.clear(),this.loading=!1},error:()=>{this.loading=!1}})}addManager(){const c=(0,he.kZ)();c.width="1000px",c.data={complementaryObject:this.complementaryObject,theme:this.theme,availableRoles:this.availableRoles,selectedRole:this.selectedRole},this.dialog.open(v,c).afterClosed().subscribe(O=>{O&&this.refreshUsers()})}removeManager(){const c=(0,he.kZ)();c.width="450px",c.data={managers:this.selectionUsers.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(Y,c).afterClosed().subscribe(O=>{O&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?this.reloadEntityDetail.reloadEntityDetail():this.redirectToAuthRoute())})}removeGroup(){const c=(0,he.kZ)();c.width="450px",c.data={groups:this.selectionGroups.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(X,c).afterClosed().subscribe(O=>{O&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?this.refreshGroups():this.redirectToAuthRoute())})}addGroup(){const c=(0,he.kZ)();c.width="1000px",c.data={complementaryObject:this.complementaryObject,availableRoles:this.availableRoles,theme:this.theme,selectedRole:this.selectedRole},this.dialog.open(me,c).afterClosed().subscribe(O=>{O&&this.refreshGroups()})}redirectToAuthRoute(){if("Group"===this.complementaryObjectType&&(this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])||this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])))this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])?this.router.navigate(["/organizations",this.complementaryObject.voId,"groups",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"}):this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])&&this.router.navigate(["/organizations",this.complementaryObject.voId],{queryParamsHandling:"merge"});else if("Facility"===this.complementaryObjectType&&this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.complementaryObject]))this.router.navigate(["/facilities",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else if("Vo"===this.complementaryObjectType&&this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject]))this.router.navigate(["/organizations",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else{if("Resource"!==this.complementaryObjectType||!this.guiAuthResolver.isAuthorized("getRichResourceById_int_policy",[this.complementaryObject]))return void this.router.navigate(["/home"],{queryParamsHandling:"merge"});this.router.navigate(["../../"],{relativeTo:this.route,queryParamsHandling:"merge"})}this.reloadEntityDetail.reloadEntityDetail()}}ge.\u0275fac=function(c){return new(c||ge)(e.Y36(f.uw),e.Y36(E.Ct),e.Y36(n.d6),e.Y36(n.x4),e.Y36(P.F0),e.Y36(ve.G),e.Y36(P.gz))},ge.\u0275cmp=e.Xpm({type:ge,selectors:[["app-managers-page"]],hostVars:2,hostBindings:function(c,r){2&c&&e.ekj("router-component",r.true)},inputs:{complementaryObject:"complementaryObject",availableRoles:"availableRoles",complementaryObjectType:"complementaryObjectType",theme:"theme",configMode:"configMode",disableRouting:"disableRouting",disableSelf:"disableSelf",displayedUserColumns:"displayedUserColumns",displayedGroupColumns:"displayedGroupColumns"},decls:11,vars:4,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false",3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["alert_type","warn",4,"ngIf"],[1,"mt-2",3,"refresh"],["color","accent","class","me-2 action-button","data-cy","add-manager-button","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","data-cy","remove-manager-button","class","me-2","mat-flat-button","",3,"disabled","click",4,"ngIf"],["data-cy","role-filter",1,"me-2","mt-2"],[3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],["spinner",""],["class","position-relative",4,"ngIf"],["color","accent","data-cy","add-manager-button","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","data-cy","remove-manager-button","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"value"],[1,"position-relative"],[3,"disableSelf","tableId","disableRouting","displayedColumns","selection","users",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"disableSelf","tableId","disableRouting","displayedColumns","selection","users"],["color","accent","class","me-2 action-button","mat-flat-button","",3,"click",4,"ngIf"],["class","me-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[1,"me-2","mt-2"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"disableMembers","disableRouting","displayedColumns","groups","selection","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"disableMembers","disableRouting","displayedColumns","groups","selection","tableId"],["alert_type","warn"]],template:function(c,r){1&c&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"mat-tab-group",1),e.NdJ("selectedTabChange",function(G){return r.tabChanged(G)}),e.TgZ(4,"mat-tab"),e.YNc(5,Ce,2,3,"ng-template",2),e.YNc(6,Le,12,8,"ng-template",3),e.qZA(),e.TgZ(7,"mat-tab"),e.YNc(8,Ze,2,3,"ng-template",2),e.YNc(9,we,12,8,"ng-template",3),e.qZA()(),e.YNc(10,Je,3,3,"perun-web-apps-alert",4)),2&c&&(e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.TITLE"),"\n"),e.xp6(9),e.Q6J("ngIf",0===r.availableRoles.length))},dependencies:[x.sg,x.O5,D.ey,B.KE,B.hX,F.lW,fe.Vc,fe.uD,fe.uX,fe.SP,N.gD,A.w,j.K,b.W,Te.t,y.e,I.C,x.i8,K.X$,z.i]})},17672:(te,k,o)=>{o.d(k,{o:()=>p});var a=o(96308),f=o(30671),n=o(95017),E=o(95243),C=o(61744),s=o(9244),t=o(94650),e=o(89383),K=o(36895),P=o(284),x=o(59549),D=o(24006),i=o(97392),B=o(4859),F=o(56709),N=o(10266),j=o(98380),L=o(18750),y=o(9185),I=o(8231),z=o(14849);function M(l,h){if(1&l){const d=t.EpF();t.TgZ(0,"th",17)(1,"mat-checkbox",18),t.NdJ("change",function(X){t.CHM(d);const oe=t.oxw(2);return t.KtG(X?oe.masterToggle():null)}),t.ALo(2,"translate"),t.ALo(3,"masterCheckboxLabel"),t.qZA()()}if(2&l){const d=t.oxw().ngIf,Z=t.oxw();t.xp6(1),t.Q6J("aria-label",t.lcZ(2,3,t.lcZ(3,5,d.all)))("checked",Z.selection.hasValue()&&d.all)("indeterminate",Z.selection.hasValue()&&!d.all)}}const w=function(l){return{name:l}};function q(l,h){if(1&l){const d=t.EpF();t.TgZ(0,"td",19)(1,"mat-checkbox",20),t.NdJ("change",function(X){const ce=t.CHM(d).$implicit,T=t.oxw(2);return t.KtG(X?T.selection.toggle(ce):null)})("click",function(X){return X.stopPropagation()}),t.ALo(2,"translate"),t.ALo(3,"checkboxLabel"),t.qZA()()}if(2&l){const d=h.$implicit,Z=t.oxw(2);t.xp6(1),t.Q6J("aria-label",t.xi3(2,2,t.lcZ(3,5,Z.selection.isSelected(d)),t.VKq(7,w,d.tagName)))("checked",Z.selection.isSelected(d))}}function ee(l,h){1&l&&(t.ynx(0,14),t.YNc(1,M,4,7,"th",15),t.YNc(2,q,4,9,"td",16),t.BQk())}function W(l,h){1&l&&(t.TgZ(0,"th",21),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&l&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_ID")," "))}function v(l,h){if(1&l&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&l){const d=h.$implicit;t.xp6(1),t.Oqu(d.id)}}function g(l,h){1&l&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&l&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_NAME")," "))}function A(l,h){if(1&l&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&l){const d=t.oxw().$implicit;t.xp6(1),t.hij(" ",d.tagName," ")}}function R(l,h){if(1&l){const d=t.EpF();t.TgZ(0,"div")(1,"mat-form-field",26)(2,"input",27),t.NdJ("ngModelChange",function(X){t.CHM(d);const oe=t.oxw().$implicit;return t.KtG(oe.tagName=X)}),t.ALo(3,"translate"),t.qZA()()()}if(2&l){const d=t.oxw().$implicit;t.xp6(2),t.s9C("placeholder",t.lcZ(3,2,"VO_DETAIL.RESOURCES.TAGS.CHANGE_TAG_NAME")),t.Q6J("ngModel",d.tagName)}}function S(l,h){if(1&l&&(t.TgZ(0,"td",24),t.YNc(1,A,2,1,"div",25),t.YNc(2,R,4,4,"div",25),t.qZA()),2&l){const d=h.$implicit,Z=t.oxw();t.xp6(1),t.Q6J("ngIf",!Z.isChanging.isSelected(d)),t.xp6(1),t.Q6J("ngIf",Z.isChanging.isSelected(d))}}function Q(l,h){1&l&&t._UZ(0,"th",23)}function $(l,h){if(1&l){const d=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(d);const X=t.oxw().$implicit,oe=t.oxw();return t.KtG(oe.edit(X))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()()}2&l&&t.s9C("matTooltip",t.lcZ(1,1,"VO_DETAIL.RESOURCES.TAGS.EDIT_BUTTON"))}function ne(l,h){if(1&l){const d=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(d);const X=t.oxw().$implicit,oe=t.oxw();return t.KtG(oe.save(X))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"save"),t.qZA()()}2&l&&t.s9C("matTooltip",t.lcZ(1,1,"VO_DETAIL.RESOURCES.TAGS.SAVE_BUTTON"))}function re(l,h){if(1&l&&(t.TgZ(0,"td",24)(1,"div",28),t.YNc(2,$,4,3,"button",29),t.YNc(3,ne,4,3,"button",29),t.qZA()()),2&l){const d=h.$implicit,Z=t.oxw();t.xp6(2),t.Q6J("ngIf",!Z.isChanging.isSelected(d)),t.xp6(1),t.Q6J("ngIf",Z.isChanging.isSelected(d))}}function ie(l,h){1&l&&t._UZ(0,"tr",31)}function ae(l,h){1&l&&t._UZ(0,"tr",32)}function V(l,h){if(1&l&&(t.TgZ(0,"perun-web-apps-alert",33),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&l){const d=t.oxw();t.xp6(1),t.hij(" ","vo"===d.entity?t.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.NO_TAGS"):t.lcZ(3,3,"RESOURCE_DETAIL.TAGS.NO_TAGS"),"\n")}}function Y(l,h){1&l&&(t.TgZ(0,"perun-web-apps-alert",33),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&l&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}const m=function(l){return{all:l}};class p{constructor(h,d,Z,X,oe){this.resourceManager=h,this.notificator=d,this.translator=Z,this.authResolver=X,this.tableCheckbox=oe,this.resourceTags=[],this.selection=new n.Ov(!0,[]),this.displayedColumns=["select","id","name","edit"],this.isChanging=new n.Ov(!0,[]),this.pageSizeOptions=s.f7}set matSort(h){this.sort=h,this.setDataSource()}static getDataForColumn(h,d){switch(d){case"id":return h.id.toString();case"name":return h.tagName;default:return""}}ngOnChanges(){this.authResolver.isPerunAdminOrObserver()||(this.displayedColumns=this.displayedColumns.filter(h=>"id"!==h)),this.dataSource=new f.by(this.resourceTags),this.setDataSource()}ngAfterViewInit(){this.dataSource.paginator=this.child.paginator}exportAllData(h){(0,s.O6)((0,s.Xn)(this.dataSource.filteredData,this.displayedColumns,p.getDataForColumn),h)}exportDisplayedData(h){const d=this.dataSource.paginator.pageIndex*this.dataSource.paginator.pageSize,Z=d+this.dataSource.paginator.pageSize;(0,s.O6)((0,s.Xn)(this.dataSource.sortData(this.dataSource.filteredData,this.dataSource.sort).slice(d,Z),this.displayedColumns,p.getDataForColumn),h)}setDataSource(){this.dataSource&&(this.dataSource.filterPredicate=(h,d)=>(0,s.Sd)(h,d,this.displayedColumns,p.getDataForColumn),this.dataSource.sortData=(h,d)=>(0,s.pR)(h,d,p.getDataForColumn),this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue)}isAllSelected(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.dataSource)}masterToggle(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}save(h){this.resourceManager.updateResourceTag({resourceTag:h}).subscribe(()=>{this.translator.get("SHARED.COMPONENTS.RESOURCES_TAGS_LIST.EDIT_SUCCESS").subscribe(d=>{this.notificator.showSuccess(d)}),this.isChanging.deselect(h)})}edit(h){this.isChanging.select(h)}}p.\u0275fac=function(h){return new(h||p)(t.Y36(C.xk),t.Y36(E.V6),t.Y36(e.sK),t.Y36(E.x4),t.Y36(E.UA))},p.\u0275cmp=t.Xpm({type:p,selectors:[["app-resources-tags-list"]],viewQuery:function(h,d){if(1&h&&(t.Gf(s.l9,7),t.Gf(a.YE,7)),2&h){let Z;t.iGM(Z=t.CRH())&&(d.child=Z.first),t.iGM(Z=t.CRH())&&(d.matSort=Z.first)}},inputs:{resourceTags:"resourceTags",filterValue:"filterValue",selection:"selection",tableId:"tableId",displayedColumns:"displayedColumns",entity:"entity"},features:[t.TTD],decls:18,vars:15,consts:[[1,"card","mt-2",3,"hidden"],[3,"pageSizeOptions","dataLength","tableId","exportDisplayedData","exportAllData"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select",4,"ngIf"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","edit"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["matColumnDef","select"],["class","align-checkbox","mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size align-checkbox","mat-cell","",4,"matCellDef"],["mat-header-cell","",1,"align-checkbox"],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size","align-checkbox"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"static-column-size"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],["subscriptSizing","dynamic"],["matInput","",3,"ngModel","placeholder","ngModelChange"],[1,"d-flex","justify-content-end"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","",3,"matTooltip","click"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"],["alert_type","warn"]],template:function(h,d){1&h&&(t.TgZ(0,"div",0)(1,"perun-web-apps-table-wrapper",1),t.NdJ("exportDisplayedData",function(X){return d.exportDisplayedData(X)})("exportAllData",function(X){return d.exportAllData(X)}),t.TgZ(2,"table",2),t.YNc(3,ee,3,0,"ng-container",3),t.ALo(4,"isAllSelected"),t.ynx(5,4),t.YNc(6,W,3,3,"th",5),t.YNc(7,v,2,1,"td",6),t.BQk(),t.ynx(8,7),t.YNc(9,g,3,3,"th",8),t.YNc(10,S,3,2,"td",9),t.BQk(),t.ynx(11,10),t.YNc(12,Q,1,0,"th",8),t.YNc(13,re,4,2,"td",9),t.BQk(),t.YNc(14,ie,1,0,"tr",11),t.YNc(15,ae,1,0,"tr",12),t.qZA()()(),t.YNc(16,V,4,5,"perun-web-apps-alert",13),t.YNc(17,Y,3,3,"perun-web-apps-alert",13)),2&h&&(t.Q6J("hidden",0===d.resourceTags.length||0===d.dataSource.filteredData.length),t.xp6(1),t.Q6J("pageSizeOptions",d.pageSizeOptions)("dataLength",d.dataSource.filteredData.length)("tableId",d.tableId),t.xp6(1),t.Q6J("dataSource",d.dataSource),t.xp6(1),t.Q6J("ngIf",t.VKq(13,m,t.xi3(4,10,d.dataSource,d.selection.selected.length))),t.xp6(11),t.Q6J("matHeaderRowDef",d.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",d.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===d.resourceTags.length),t.xp6(1),t.Q6J("ngIf",0===d.dataSource.filteredData.length&&0!==d.resourceTags.length))},dependencies:[K.O5,P.Nt,x.KE,D.Fj,D.JJ,D.On,i.Hw,B.RK,a.YE,a.nU,f.BZ,f.fO,f.as,f.w1,f.Dz,f.nj,f.ge,f.ev,f.XQ,f.Gk,F.oG,N.gM,j.w,L.l,e.X$,y.I,I.G,z.r]})},22158:(te,k,o)=>{o.d(k,{T:()=>f});var a=o(77579);const f=(n=class{})=>class extends n{constructor(){super(...arguments),this.destroyed$=new a.x}ngOnDestroy(){this.destroyed$.next()}}},90439:(te,k,o)=>{o.d(k,{F:()=>E});var a=o(94650),f=o(89593),n=o(89383);class E{constructor(){this.servicePackages=[],this.selectedPackage=null,this.multiple=!1,this.disableAutoSelect=!1,this.theme="",this.packageSelected=new a.vpe,this.nameFunction=s=>s.name,this.shortNameFunction=s=>s.description,this.searchFunction=s=>s.name+s.description}}E.\u0275fac=function(s){return new(s||E)},E.\u0275cmp=a.Xpm({type:E,selectors:[["perun-web-apps-service-package-search-select"]],inputs:{servicePackages:"servicePackages",selectedPackage:"selectedPackage",multiple:"multiple",disableAutoSelect:"disableAutoSelect",theme:"theme"},outputs:{packageSelected:"packageSelected"},decls:4,vars:17,consts:[[3,"entities","entity","multiple","disableAutoSelect","searchFunction","mainTextFunction","secondaryTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","theme","entitySelected"]],template:function(s,t){1&s&&(a.TgZ(0,"perun-web-apps-entity-search-select",0),a.NdJ("entitySelected",function(K){return t.packageSelected.emit(K)}),a.ALo(1,"translate"),a.ALo(2,"translate"),a.ALo(3,"translate"),a.qZA()),2&s&&a.Q6J("entities",t.servicePackages)("entity",t.selectedPackage)("multiple",t.multiple)("disableAutoSelect",t.disableAutoSelect)("searchFunction",t.searchFunction)("mainTextFunction",t.nameFunction)("secondaryTextFunction",t.shortNameFunction)("selectPlaceholder",a.lcZ(1,11,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.SELECT_PACKAGE"))("findPlaceholder",a.lcZ(2,13,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.FIND_PACKAGE"))("noEntriesText",a.lcZ(3,15,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.NO_PACKAGE_FOUND"))("theme",t.theme)},dependencies:[f.i,n.X$]})}}]);