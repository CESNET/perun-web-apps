(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"pjY/":function(e,t,i){"use strict";i.r(t),i.d(t,"FacilitiesModule",(function(){return ti}));var s=i("2kYt"),a=i("sEIs"),c=i("VFai"),n=i("TkCa"),l=i("4sdY"),r=i("EkAj"),o=i("X2Q7"),b=i("8clQ"),u=i("Ssnw"),h=i("+0js"),d=i("49Zq"),f=i("EM62"),p=i("OZ4H"),g=i("EtYo"),m=i("csyo"),I=i("bFHC"),S=i("Y2X+"),y=i("ma6z"),T=i("PBFl"),A=i("s2Ay");function v(e,t){1&e&&f.Nb(0,"mat-spinner",3)}function E(e,t){if(1&e){const e=f.Tb();f.Sb(0,"button",12),f.Zb("click",(function(){return f.xc(e),f.dc(2).editFacility()})),f.Sb(1,"mat-icon"),f.Jc(2,"edit"),f.Rb(),f.Rb()}}function R(e,t){if(1&e){const e=f.Tb();f.Sb(0,"button",12),f.Zb("click",(function(){return f.xc(e),f.dc(2).deleteFacility()})),f.Sb(1,"mat-icon"),f.Jc(2,"delete_forever"),f.Rb(),f.Rb()}}const C=function(){return{color:"black"}},L=function(e){return["/facilities",e]};function k(e,t){if(1&e&&(f.Sb(0,"div"),f.Sb(1,"div",4),f.Nb(2,"mat-icon",5),f.ec(3,"translate"),f.Sb(4,"div",6),f.Sb(5,"div",7),f.Sb(6,"a",8),f.Jc(7),f.Rb(),f.Sb(8,"span",9),f.Jc(9),f.Rb(),f.Hc(10,E,3,0,"button",10),f.Hc(11,R,3,0,"button",10),f.Rb(),f.Sb(12,"span",11),f.Jc(13),f.ec(14,"translate"),f.ec(15,"translate"),f.Rb(),f.Rb(),f.Rb(),f.Nb(16,"app-animated-router-outlet"),f.Rb()),2&e){const e=f.dc();f.Ab(2),f.lc("matTooltip",f.fc(3,10,"FACILITY_DETAIL.ENTITY")),f.kc("ngStyle",f.oc(16,C)),f.Ab(4),f.kc("routerLink",f.pc(17,L,e.facility.id)),f.Ab(1),f.Kc(e.facility.name),f.Ab(2),f.Lc(" \xa0#",e.facility.id," "),f.Ab(1),f.kc("ngIf",e.editFacilityAuth),f.Ab(1),f.kc("ngIf",e.deleteAuth),f.Ab(2),f.Nc(" ",f.fc(14,12,"FACILITY_DETAIL.ENTITY"),", ",f.fc(15,14,"FACILITY_DETAIL.DESCRIPTION"),": ",e.facility.description," ")}}let F=(()=>{class e{constructor(e,t,i,s,a,c,n){this.dialog=e,this.facilityManager=t,this.route=i,this.sideMenuService=s,this.sideMenuItemService=a,this.guiAuthResolver=c,this.router=n,this.editFacilityAuth=!1,this.deleteAuth=!1,this.loading=!1}ngOnInit(){this.loading=!0,this.route.params.subscribe(e=>{this.facilityManager.getFacilityById(e.facilityId).subscribe(e=>{this.facility=e;const t=this.sideMenuItemService.parseFacility(e);this.sideMenuService.setFacilityMenuItems([t]),this.editFacilityAuth=this.guiAuthResolver.isAuthorized("updateFacility_Facility_policy",[this.facility]),this.deleteAuth=this.guiAuthResolver.isAuthorized("deleteFacility_Facility_Boolean_policy",[this.facility]),Object(b.b)("facilities",this.facility),Object(b.c)(this.facility),this.loading=!1},()=>this.loading=!1)})}editFacility(){const e=Object(b.o)();e.width="450px",e.data={theme:"facility-theme",facility:this.facility,dialogType:h.h.FACILITY},this.dialog.open(h.g,e).afterClosed().subscribe(e=>{e&&this.facilityManager.getFacilityById(this.facility.id).subscribe(e=>{this.facility=e})})}deleteFacility(){const e=Object(b.o)();e.width="500px",e.data={theme:"facility-theme",facility:this.facility},this.dialog.open(d.a,e).afterClosed().subscribe(e=>{e&&this.router.navigate([""])})}}return e.\u0275fac=function(t){return new(t||e)(f.Mb(p.b),f.Mb(o.g),f.Mb(a.a),f.Mb(l.a),f.Mb(r.a),f.Mb(u.h),f.Mb(a.f))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-facility-detail-page"]],decls:4,vars:2,consts:[[1,"container-fluid","pl-xl-5","pr-xl-5","facility-theme"],["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-facility-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],["queryParamsHandling","merge",1,"facility-link",3,"routerLink"],[1,"text-muted"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"mt-1","entity-info"],["mat-icon-button","",3,"click"]],template:function(e,t){1&e&&(f.Sb(0,"div",0),f.Nb(1,"perun-web-apps-back-button"),f.Hc(2,v,1,0,"mat-spinner",1),f.Hc(3,k,17,19,"div",2),f.Rb()),2&e&&(f.Ab(2),f.kc("ngIf",t.loading),f.Ab(1),f.kc("ngIf",!t.loading&&void 0!==t.facility))},directives:[g.a,s.t,m.c,I.a,S.a,s.w,a.i,y.a,T.b],pipes:[A.d],styles:[""],data:{animation:[n.a]}}),e})();var _=i("ZG5M");function M(e,t){1&e&&f.Nb(0,"mat-spinner",2)}function w(e,t){if(1&e&&(f.Sb(0,"div"),f.Nb(1,"perun-web-apps-menu-buttons-field",3),f.Rb()),2&e){const e=f.dc();f.Ab(1),f.kc("items",e.navItems)("size","small")}}let O=(()=>{class e{constructor(e,t,i){this.facilityManager=e,this.route=t,this.authResolver=i,this.navItems=[],this.loading=!1}ngOnInit(){this.loading=!0,this.route.params.subscribe(e=>{this.facilityManager.getFacilityById(e.facilityId).subscribe(e=>{this.facility=e,this.initItems(),this.loading=!1},()=>this.loading=!1)})}initItems(){this.navItems=[],this.authResolver.isAuthorized("getAssignedRichResources_Facility_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-manage-facility",url:`/facilities/${this.facility.id}/resources`,label:"MENU_ITEMS.FACILITY.RESOURCES",style:"facility-btn"}),this.authResolver.isAuthorized("getAssignedUsers_Facility_Service_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-user",url:`/facilities/${this.facility.id}/allowed-users`,label:"MENU_ITEMS.FACILITY.ALLOWED_USERS",style:"facility-btn"}),this.authResolver.isAuthorized("getAllowedGroups_Facility_Vo_Service_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-group",url:`/facilities/${this.facility.id}/allowed-groups`,label:"MENU_ITEMS.FACILITY.ALLOWED_GROUPS",style:"facility-btn"}),this.authResolver.isAuthorized("getFacilityServicesState_Facility_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-service-status",url:`/facilities/${this.facility.id}/services-status`,label:"MENU_ITEMS.FACILITY.SERVICES_STATUS",style:"facility-btn"}),this.authResolver.isAuthorized("getAllRichDestinations_Facility_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-service_destination",url:`/facilities/${this.facility.id}/services-destinations`,label:"MENU_ITEMS.FACILITY.SERVICES_DESTINATIONS",style:"facility-btn"}),this.authResolver.isFacilityAdmin()&&this.navItems.push({cssIcon:"perun-hosts",url:`/facilities/${this.facility.id}/hosts`,label:"MENU_ITEMS.FACILITY.HOSTS",style:"facility-btn"}),this.navItems.push({cssIcon:"perun-attributes",url:`/facilities/${this.facility.id}/attributes`,label:"MENU_ITEMS.FACILITY.ATTRIBUTES",style:"facility-btn"}),(this.authResolver.isAuthorized("getBansForFacility_int_policy",[this.facility])||this.authResolver.isManagerPagePrivileged(this.facility)||this.authResolver.isAuthorized("getOwners_Facility_policy",[this.facility])||this.authResolver.isAuthorized("getAssignedSecurityTeams_Facility_policy",[this.facility]))&&this.navItems.push({cssIcon:"perun-settings2",url:`/facilities/${this.facility.id}/settings`,label:"MENU_ITEMS.FACILITY.SETTINGS",style:"facility-btn"})}}return e.\u0275fac=function(t){return new(t||e)(f.Mb(o.g),f.Mb(a.a),f.Mb(u.h))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-facility-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&f.Eb("router-component",!0)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(f.Hc(0,M,1,0,"mat-spinner",0),f.Hc(1,w,2,2,"div",1)),2&e&&(f.kc("ngIf",t.loading),f.Ab(1),f.kc("ngIf",!t.loading))},directives:[s.t,m.c,_.a],styles:[""]}),e})();var D=i("s8L6"),z=i("Wq+4"),N=i("nSPi"),V=i("y/MV");let H=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=f.Gb({type:e,selectors:[["app-facility-settings"]],hostVars:2,hostBindings:function(e,t){2&e&&f.Eb("router-component",!0)},decls:1,vars:0,template:function(e,t){1&e&&f.Nb(0,"app-animated-router-outlet")},directives:[y.a],styles:[""],data:{animation:[n.a]}}),e})();function Y(e,t){1&e&&f.Nb(0,"mat-spinner",2)}function U(e,t){if(1&e&&(f.Sb(0,"div"),f.Nb(1,"perun-web-apps-menu-buttons-field",3),f.Rb()),2&e){const e=f.dc();f.Ab(1),f.kc("items",e.items)("size","small")}}let B=(()=>{class e{constructor(e,t,i){this.route=e,this.facilityManager=t,this.authResolver=i,this.items=[],this.loading=!1}ngOnInit(){this.loading=!0,this.route.parent.parent.params.subscribe(e=>{this.facilityManager.getFacilityById(e.facilityId).subscribe(e=>{this.facility=e,this.initItems(),this.loading=!1},()=>this.loading=!1)})}initItems(){this.items=[],this.authResolver.isAuthorized("getOwners_Facility_policy",[this.facility])&&this.items.push({cssIcon:"perun-owner-grey",url:`/facilities/${this.facility.id}/settings/owners`,label:"MENU_ITEMS.FACILITY.OWNERS",style:"facility-btn"}),this.authResolver.isManagerPagePrivileged(this.facility)&&this.items.push({cssIcon:"perun-manager",url:`/facilities/${this.facility.id}/settings/managers`,label:"MENU_ITEMS.FACILITY.MANAGERS",style:"facility-btn"}),this.authResolver.isAuthorized("getAssignedSecurityTeams_Facility_policy",[this.facility])&&this.items.push({cssIcon:"perun-security-teams",url:`/facilities/${this.facility.id}/settings/security-teams`,label:"MENU_ITEMS.FACILITY.SECURITY_TEAMS",style:"facility-btn"}),this.authResolver.isAuthorized("getBansForFacility_int_policy",[this.facility])&&this.items.push({cssIcon:"perun-black-list",url:`/facilities/${this.facility.id}/settings/blacklist`,label:"MENU_ITEMS.FACILITY.BLACKLIST",style:"facility-btn"})}}return e.\u0275fac=function(t){return new(t||e)(f.Mb(a.a),f.Mb(o.g),f.Mb(u.h))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-facility-settings-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&f.Eb("router-component",!0)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(f.Hc(0,Y,1,0,"mat-spinner",0),f.Hc(1,U,2,2,"div",1)),2&e&&(f.kc("ngIf",t.loading),f.Ab(1),f.kc("ngIf",!t.loading))},directives:[s.t,m.c,_.a],styles:[""]}),e})();var x=i("HHEo"),P=i("cqs0"),G=i("mEf3"),Z=i("iyZ4"),J=i("IDQ9"),j=i("KZIX"),W=i("0XDM"),K=i("A8Ay"),$=i("LKLE"),q=i("bdug");const Q=["list"];function X(e,t){1&e&&(f.Jc(0),f.ec(1,"translate")),2&e&&f.Lc(" ",f.fc(1,1,"FACILITY_DETAIL.ENTITY")," ")}function ee(e,t){1&e&&f.Nb(0,"mat-spinner",10)}function te(e,t){if(1&e){const e=f.Tb();f.Sb(0,"perun-web-apps-attributes-list",11,12),f.Zb("page",(function(t){return f.xc(e),f.dc().pageChanged(t)})),f.Rb()}if(2&e){const e=f.dc();f.kc("pageSize",e.pageSize)("filterValue",e.filterValue)("attributes",e.attributes)("selection",e.selection)}}function ie(e,t){1&e&&(f.Jc(0),f.ec(1,"translate"),f.ec(2,"translate")),2&e&&f.Mc(" ",f.fc(1,2,"FACILITY_DETAIL.ENTITY")," - ",f.fc(2,4,"ADMIN_USER.ENTITY")," ")}function se(e,t){if(1&e&&f.Nb(0,"app-two-entity-attribute-page",15),2&e){const e=f.dc(3);f.kc("firstEntity","facility")("firstEntityId",e.facilityId)("secondEntity","user")}}function ae(e,t){if(1&e&&f.Hc(0,se,1,3,"app-two-entity-attribute-page",14),2&e){const e=f.dc(2);f.kc("ngIf",!e.loading)}}function ce(e,t){1&e&&(f.Sb(0,"mat-tab"),f.Hc(1,ie,3,6,"ng-template",1),f.Hc(2,ae,1,1,"ng-template",13),f.Rb())}let ne=(()=>{class e{constructor(e,t,i,s,a,c,n){this.attributesManager=e,this.route=t,this.dialog=i,this.notificator=s,this.tableConfigService=a,this.translate=c,this.authResolver=n,this.attributes=[],this.selection=new P.c(!0,[]),this.filterValue="",this.tableId=Z.r,this.translate.get("FACILITY_DETAIL.SETTINGS.ATTRIBUTES.SUCCESS_SAVE").subscribe(e=>this.saveSuccessMessage=e),this.translate.get("FACILITY_DETAIL.SETTINGS.ATTRIBUTES.SUCCESS_DELETE").subscribe(e=>this.deleteSuccessMessage=e)}ngOnInit(){this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe(e=>{this.facilityId=e.facilityId,this.facilityUserAttAuth=this.authResolver.isAuthorized("getAssignedUsers_Facility_policy",[{id:this.facilityId,beanName:"Facility"}]),this.refreshTable()})}onDelete(){const e=Object(b.o)();e.width="450px",e.data={entityId:this.facilityId,entity:"facility",attributes:this.selection.selected,theme:"facility-theme"},this.dialog.open(G.a,e).afterClosed().subscribe(e=>{e&&this.refreshTable()})}onSave(){this.list.updateMapAttributes();const e=Object(b.o)();e.width="450px",e.data={entityId:this.facilityId,entity:"facility",attributes:this.selection.selected},this.dialog.open(h.f,e).afterClosed().subscribe(e=>{e&&this.refreshTable()})}onCreate(){const e=Object(b.o)();e.width="1050px",e.data={entityId:this.facilityId,entity:"facility",notEmptyAttributes:this.attributes,style:"facility-theme"},this.dialog.open(J.a,e).afterClosed().subscribe(e=>{"saved"===e&&this.refreshTable()})}refreshTable(){this.loading=!0,this.attributesManager.getFacilityAttributes(this.facilityId).subscribe(e=>{this.attributes=e,this.selection.clear(),this.loading=!1})}applyFilter(e){this.filterValue=e}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(f.Mb(o.c),f.Mb(a.a),f.Mb(p.b),f.Mb(u.l),f.Mb(Z.pb),f.Mb(A.e),f.Mb(u.h))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-facility-attributes"]],viewQuery:function(e,t){var i;1&e&&f.Qc(Q,!0),2&e&&f.sc(i=f.ac())&&(t.list=i.first)},hostVars:2,hostBindings:function(e,t){2&e&&f.Eb("router-component",!0)},decls:22,vars:20,consts:[[1,"page-subtitle"],["matTabLabel",""],[1,"mt-2",3,"refresh"],["mat-flat-button","","color","accent",1,"mr-2","mt-2",3,"click"],["mat-flat-button","","color","accent",1,"mr-2","mt-2",3,"disabled","click"],["mat-flat-button","","color","warn",1,"mt-2",3,"disabled","click"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","attributes","selection","page",4,"ngIf"],[4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","attributes","selection","page"],["list",""],["matTabContent",""],[3,"firstEntity","firstEntityId","secondEntity",4,"ngIf"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(e,t){1&e&&(f.Sb(0,"div"),f.Sb(1,"h1",0),f.Jc(2),f.ec(3,"translate"),f.Rb(),f.Sb(4,"mat-tab-group"),f.Sb(5,"mat-tab"),f.Hc(6,X,2,3,"ng-template",1),f.Sb(7,"perun-web-apps-refresh-button",2),f.Zb("refresh",(function(){return t.refreshTable()})),f.Rb(),f.Sb(8,"button",3),f.Zb("click",(function(){return t.onCreate()})),f.Jc(9),f.ec(10,"translate"),f.Rb(),f.Sb(11,"button",4),f.Zb("click",(function(){return t.onSave()})),f.Jc(12),f.ec(13,"translate"),f.Rb(),f.Sb(14,"button",5),f.Zb("click",(function(){return t.onDelete()})),f.Jc(15),f.ec(16,"translate"),f.Rb(),f.Sb(17,"perun-web-apps-immediate-filter",6),f.Zb("filter",(function(e){return t.applyFilter(e)})),f.ec(18,"translate"),f.Rb(),f.Hc(19,ee,1,0,"mat-spinner",7),f.Hc(20,te,2,4,"perun-web-apps-attributes-list",8),f.Rb(),f.Hc(21,ce,3,0,"mat-tab",9),f.Rb(),f.Rb()),2&e&&(f.Ab(2),f.Kc(f.fc(3,10,"FACILITY_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),f.Ab(7),f.Lc(" ",f.fc(10,12,"FACILITY_DETAIL.SETTINGS.ATTRIBUTES.CREATE")," "),f.Ab(2),f.kc("disabled",0===t.selection.selected.length),f.Ab(1),f.Lc(" ",f.fc(13,14,"FACILITY_DETAIL.SETTINGS.ATTRIBUTES.SAVE")," "),f.Ab(2),f.kc("disabled",0===t.selection.selected.length),f.Ab(1),f.Lc(" ",f.fc(16,16,"FACILITY_DETAIL.SETTINGS.ATTRIBUTES.DELETE")," "),f.Ab(2),f.kc("placeholder",f.fc(18,18,"SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.FILTER")),f.Ab(2),f.kc("ngIf",t.loading),f.Ab(1),f.kc("ngIf",!t.loading),f.Ab(1),f.kc("ngIf",t.facilityUserAttAuth))},directives:[j.c,j.a,j.d,W.a,T.b,K.a,s.t,m.c,$.a,j.b,q.a],pipes:[A.d],styles:[""]}),e})();var le=i("GyaY"),re=i("HUrR"),oe=i("gxIj"),be=i("jblC"),ue=i("nIj0"),he=i("jIqt"),de=i("YtkY"),fe=i("t47Z"),pe=i("+Tre"),ge=i("29Wa"),me=i("Cd2c"),Ie=i("ulve"),Se=i("mFH5"),ye=i("j+u3");function Te(e,t){if(1&e){const e=f.Tb();f.Sb(0,"mat-option",10),f.Zb("onSelectionChange",(function(){f.xc(e);const i=t.$implicit;return f.dc(3).onSelectedService(i)})),f.Jc(1),f.Rb()}if(2&e){const e=t.$implicit;f.kc("value",e),f.Ab(1),f.Lc(" ",e.name," ")}}function Ae(e,t){if(1&e){const e=f.Tb();f.Sb(0,"mat-form-field",6),f.Sb(1,"input",7),f.Zb("keyup",(function(t){return f.xc(e),f.dc(2).updatedSerVal(t)})),f.ec(2,"translate"),f.Rb(),f.Sb(3,"mat-autocomplete",8,9),f.Sb(5,"mat-option",10),f.Zb("onSelectionChange",(function(){return f.xc(e),f.dc(2).onSelectedService("NOT_SELECTED")})),f.Jc(6),f.ec(7,"translate"),f.Rb(),f.Sb(8,"mat-option",10),f.Zb("onSelectionChange",(function(){return f.xc(e),f.dc(2).onSelectedService("ALL")})),f.Jc(9),f.ec(10,"translate"),f.Rb(),f.Hc(11,Te,2,2,"mat-option",11),f.ec(12,"async"),f.Rb(),f.Rb()}if(2&e){const e=f.tc(4),t=f.dc(2);f.Ab(1),f.lc("placeholder",f.fc(2,9,"FACILITY_DETAIL.SERVICE_CONFIG.SERVICE_SELECT")),f.kc("formControl",t.serviceField)("matAutocomplete",e),f.Ab(2),f.kc("displayWith",t.serviceDisplayFn.bind(t)),f.Ab(2),f.kc("value","NOT_SELECTED"),f.Ab(1),f.Lc(" ",f.fc(7,11,"FACILITY_DETAIL.SERVICE_CONFIG.NOT_SELECTED")," "),f.Ab(2),f.kc("value","ALL"),f.Ab(1),f.Lc(" ",f.fc(10,13,"FACILITY_DETAIL.SERVICE_CONFIG.ALL")," "),f.Ab(2),f.kc("ngForOf",f.fc(12,15,t.filteredServices))}}function ve(e,t){if(1&e){const e=f.Tb();f.Sb(0,"mat-option",10),f.Zb("onSelectionChange",(function(){f.xc(e);const i=t.$implicit;return f.dc(3).onSelectedResource(i)})),f.Jc(1),f.Rb()}if(2&e){const e=t.$implicit;f.kc("value",e),f.Ab(1),f.Lc(" ",e.name," ")}}function Ee(e,t){if(1&e){const e=f.Tb();f.Sb(0,"mat-form-field",6),f.Sb(1,"input",12),f.Zb("keyup",(function(t){return f.xc(e),f.dc(2).updatedResVal(t)})),f.ec(2,"translate"),f.Rb(),f.Sb(3,"mat-autocomplete",8,9),f.Hc(5,ve,2,2,"mat-option",11),f.ec(6,"async"),f.Rb(),f.Rb()}if(2&e){const e=f.tc(4),t=f.dc(2);f.Ab(1),f.lc("placeholder",f.fc(2,5,"FACILITY_DETAIL.SERVICE_CONFIG.RES_SELECT")),f.kc("matAutocomplete",e)("formControl",t.resourceField),f.Ab(2),f.kc("displayWith",t.resourceDisplayFn.bind(t)),f.Ab(2),f.kc("ngForOf",f.fc(6,7,t.filteredResources))}}function Re(e,t){if(1&e){const e=f.Tb();f.Sb(0,"mat-option",10),f.Zb("onSelectionChange",(function(){f.xc(e);const i=t.$implicit;return f.dc(3).onSelectedGroup(i)})),f.Jc(1),f.Rb()}if(2&e){const e=t.$implicit;f.kc("value",e),f.Ab(1),f.Lc(" ",e.name," ")}}function Ce(e,t){if(1&e){const e=f.Tb();f.Sb(0,"mat-form-field",6),f.Sb(1,"input",12),f.Zb("keyup",(function(t){return f.xc(e),f.dc(2).updatedGroupVal(t)})),f.ec(2,"translate"),f.Rb(),f.Sb(3,"mat-autocomplete",13,9),f.Hc(5,Re,2,2,"mat-option",11),f.ec(6,"async"),f.Rb(),f.Rb()}if(2&e){const e=f.tc(4),t=f.dc(2);f.Ab(1),f.lc("placeholder",f.fc(2,5,"FACILITY_DETAIL.SERVICE_CONFIG.GROUP_SELECT")),f.kc("matAutocomplete",e)("formControl",t.groupField),f.Ab(2),f.kc("displayWith",t.groupDisplayFn.bind(t)),f.Ab(2),f.kc("ngForOf",f.fc(6,7,t.filteredGroups))}}function Le(e,t){if(1&e){const e=f.Tb();f.Sb(0,"mat-option",10),f.Zb("onSelectionChange",(function(){f.xc(e);const i=t.$implicit;return f.dc(3).onSelectedMember(i)})),f.Jc(1),f.ec(2,"userFullName"),f.Rb()}if(2&e){const e=t.$implicit;f.kc("value",e),f.Ab(1),f.Lc(" ",f.fc(2,2,e.user)," ")}}function ke(e,t){if(1&e&&(f.Sb(0,"mat-form-field",6),f.Nb(1,"input",14),f.ec(2,"translate"),f.Sb(3,"mat-autocomplete",8,9),f.Hc(5,Le,3,4,"mat-option",11),f.ec(6,"async"),f.Rb(),f.Rb()),2&e){const e=f.tc(4),t=f.dc(2);f.Ab(1),f.lc("placeholder",f.fc(2,5,"FACILITY_DETAIL.SERVICE_CONFIG.MEMBER_SELECT")),f.kc("formControl",t.memberField)("matAutocomplete",e),f.Ab(2),f.kc("displayWith",t.memberDisplayFn.bind(t)),f.Ab(2),f.kc("ngForOf",f.fc(6,7,t.filteredMembers))}}function Fe(e,t){if(1&e){const e=f.Tb();f.Sb(0,"div",3),f.Hc(1,Ae,13,17,"mat-form-field",4),f.Sb(2,"mat-checkbox",5),f.Zb("change",(function(t){return f.xc(e),f.dc().onOfferAllServices(t)})),f.Jc(3),f.ec(4,"translate"),f.Rb(),f.Hc(5,Ee,7,9,"mat-form-field",4),f.Hc(6,Ce,7,9,"mat-form-field",4),f.Hc(7,ke,7,9,"mat-form-field",4),f.Rb()}if(2&e){const e=f.dc();f.Ab(1),f.kc("ngIf",void 0!==e.services),f.Ab(2),f.Lc(" ",f.fc(4,5,"FACILITY_DETAIL.SERVICE_CONFIG.ALL_SERVICES")," "),f.Ab(2),f.kc("ngIf",void 0!==e.resources&&0!=e.resources.length),f.Ab(1),f.kc("ngIf",void 0!==e.selectedResource&&void 0!==e.groups&&0!=e.groups.length),f.Ab(1),f.kc("ngIf",void 0!==e.selectedGroup&&void 0!==e.members&&0!==e.members.length)}}function _e(e,t){if(1&e&&f.Nb(0,"perun-web-apps-service-configurator",15),2&e){const e=f.dc();f.kc("facility",e.facility)("resource",e.selectedResource)("group",e.selectedGroup)("service",e.selectedService)("member",e.selectedMember)}}let Me=(()=>{class e{constructor(e,t,i,s,a,c,n){this.route=e,this.facilityManager=t,this.resourceManager=i,this.serviceManager=s,this.membersManager=a,this.namePipe=c,this.translate=n,this.selectedService="NOT_SELECTED",this.attrNames=[],this.serviceField=new ue.g,this.resourceField=new ue.g,this.groupField=new ue.g,this.memberField=new ue.g,this.allowedStatuses=["INVALID","VALID"],this.translate.get("FACILITY_DETAIL.SERVICE_CONFIG.ALL").subscribe(e=>this.serviceAllTranslation=e),this.translate.get("FACILITY_DETAIL.SERVICE_CONFIG.NOT_SELECTED").subscribe(e=>this.serviceNotSelectedTranslation=e)}ngOnInit(){this.route.parent.params.subscribe(e=>{this.facilityManager.getFacilityById(e.facilityId).subscribe(e=>{this.facility=e,this.facilityManager.getAssignedResourcesForFacility(e.id).subscribe(e=>this.resources=e),this.serviceManager.getAssignedServices(e.id).subscribe(e=>this.services=e)})}),this.filteredServices=this.serviceField.valueChanges.pipe(Object(he.a)(""),Object(de.a)(e=>this._filterServices(e))),this.filteredResources=this.resourceField.valueChanges.pipe(Object(he.a)(""),Object(de.a)(e=>this._filterResources(e))),this.filteredGroups=this.groupField.valueChanges.pipe(Object(he.a)(""),Object(de.a)(e=>this._filterGroups(e))),this.filteredMembers=this.memberField.valueChanges.pipe(Object(he.a)(""),Object(de.a)(e=>this._filterMembers(e)))}onSelectedService(e){this.selectedService=e}onSelectedResource(e){this.selectedResource=e,void 0!==this.selectedResource?(this.resourceManager.getAssignedGroups(this.selectedResource.id).subscribe(e=>this.groups=e),this.selectedGroup=void 0,this.selectedMember=void 0):this.groups=void 0}onOfferAllServices(e){e.checked||this.serviceManager.getAssignedServices(this.facility.id).subscribe(e=>this.services=e)}onSelectedGroup(e){this.selectedGroup=e,void 0!==this.selectedGroup?(this.membersManager.getCompleteRichMembersForGroup(this.selectedGroup.id,!1,this.allowedStatuses,this.attrNames).subscribe(e=>this.members=e),this.selectedMember=void 0):this.members=void 0}onSelectedMember(e){this.selectedMember=e}_filterServices(e){const t=e.toString().toLowerCase();return this.services.filter(e=>e.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t))}_filterResources(e){const t=e.toString().toLowerCase();return this.resources.filter(e=>e.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t))}_filterGroups(e){const t=e.toString().toLowerCase();return this.groups.filter(e=>e.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t))}_filterMembers(e){const t=e.toString().toLowerCase();return this.members.filter(e=>this.namePipe.transform(e.user).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t))}serviceDisplayFn(e){if(null!==e)return"ALL"===e?this.serviceAllTranslation:"NOT_SELECTED"===e?this.serviceNotSelectedTranslation:e.name}resourceDisplayFn(e){if(null!==e)return e.name}groupDisplayFn(e){if(null!==e)return e.name}memberDisplayFn(e){if(null!==e)return this.namePipe.transform(e.user)}updatedSerVal(e){""===e.target.value&&(this.selectedService="NOT_SELECTED")}updatedResVal(e){""===e.target.value&&(this.groups=void 0,this.members=void 0)}updatedGroupVal(e){""===e.target.value&&(this.members=void 0)}updatedMemVal(e){}}return e.\u0275fac=function(t){return new(t||e)(f.Mb(a.a),f.Mb(o.g),f.Mb(o.m),f.Mb(o.n),f.Mb(o.i),f.Mb(fe.c),f.Mb(A.e))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-facility-service-config"]],decls:6,vars:5,consts:[[1,"page-subtitle"],["class","col-12 col-lg-6 mb-2",4,"ngIf"],[3,"facility","resource","group","service","member",4,"ngIf"],[1,"col-12","col-lg-6","mb-2"],["class","w-100",4,"ngIf"],[3,"change"],[1,"w-100"],["type","text","matInput","",3,"placeholder","formControl","matAutocomplete","keyup"],["autoActiveFirstOption","",3,"displayWith"],["auto","matAutocomplete"],[3,"value","onSelectionChange"],[3,"value","onSelectionChange",4,"ngFor","ngForOf"],["type","text","matInput","",3,"placeholder","matAutocomplete","formControl","keyup"],["autoActiveFirstOption","",3,"ngClass","displayWith"],["type","text","matInput","",3,"placeholder","formControl","matAutocomplete"],[3,"facility","resource","group","service","member"]],template:function(e,t){1&e&&(f.Sb(0,"div"),f.Sb(1,"h1",0),f.Jc(2),f.ec(3,"translate"),f.Rb(),f.Hc(4,Fe,8,7,"div",1),f.Hc(5,_e,1,5,"perun-web-apps-service-configurator",2),f.Rb()),2&e&&(f.Ab(2),f.Kc(f.fc(3,3,"FACILITY_DETAIL.SERVICE_CONFIG.TITLE")),f.Ab(2),f.kc("ngIf",!!t.facility),f.Ab(1),f.kc("ngIf",!!t.facility))},directives:[s.t,pe.a,ge.c,me.b,ue.c,Ie.d,ue.r,ue.h,Ie.a,Se.n,s.s,s.q],pipes:[A.d,s.b,ye.a],styles:[""]}),e})();var we=i("NU+N");function Oe(e,t){if(1&e&&f.Nb(0,"app-managers-page",1),2&e){const e=f.dc();f.kc("complementaryObject",e.facility)("complementaryObjectType",e.type)("theme",e.theme)("availableRoles",e.availableRoles)}}let De=(()=>{class e{constructor(e,t,i){this.facilityService=e,this.route=t,this.guiAuthResolver=i,this.availableRoles=[],this.selected="user",this.type="Facility",this.theme="facility-theme"}ngOnInit(){this.route.parent.parent.params.subscribe(e=>{this.facilityService.getFacilityById(e.facilityId).subscribe(e=>{this.facility=e})}),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Facility")}}return e.\u0275fac=function(t){return new(t||e)(f.Mb(o.g),f.Mb(a.a),f.Mb(u.h))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-perun-web-apps-facility-settings-managers"]],hostVars:2,hostBindings:function(e,t){2&e&&f.Eb("router-component",!0)},decls:1,vars:1,consts:[[3,"complementaryObject","complementaryObjectType","theme","availableRoles",4,"ngIf"],[3,"complementaryObject","complementaryObjectType","theme","availableRoles"]],template:function(e,t){1&e&&f.Hc(0,Oe,1,4,"app-managers-page",0),2&e&&f.kc("ngIf",t.facility)},directives:[s.t,we.a],styles:[""]}),e})();var ze=i("/nwi"),Ne=i("Dkjx"),Ve=i("pgvo");function He(e,t){if(1&e){const e=f.Tb();f.Sb(0,"button",8),f.Zb("click",(function(){return f.xc(e),f.dc().addDestination()})),f.Jc(1),f.ec(2,"translate"),f.Rb()}2&e&&(f.Ab(1),f.Lc(" ",f.fc(2,1,"FACILITY_DETAIL.SERVICES_DESTINATIONS.ADD")," "))}function Ye(e,t){if(1&e){const e=f.Tb();f.Sb(0,"button",9),f.Zb("click",(function(){return f.xc(e),f.dc().removeDestination()})),f.Jc(1),f.ec(2,"translate"),f.Rb()}if(2&e){const e=f.dc();f.kc("disabled",0===e.selected.selected.length),f.Ab(1),f.Lc(" ",f.fc(2,2,"FACILITY_DETAIL.SERVICES_DESTINATIONS.REMOVE")," ")}}function Ue(e,t){if(1&e){const e=f.Tb();f.Sb(0,"button",10),f.Zb("click",(function(){return f.xc(e),f.dc().onAllow()})),f.Sb(1,"mat-icon"),f.Jc(2," check_circle_outline "),f.Rb(),f.Jc(3),f.ec(4,"translate"),f.Rb()}if(2&e){const e=f.dc();f.kc("disabled",0===e.selected.selected.length||e.allSelectedAllowed()),f.Ab(3),f.Lc(" ",f.fc(4,2,"FACILITY_DETAIL.SERVICES_DESTINATIONS.ALLOW")," ")}}function Be(e,t){if(1&e){const e=f.Tb();f.Sb(0,"button",10),f.Zb("click",(function(){return f.xc(e),f.dc().onBlock()})),f.Sb(1,"mat-icon"),f.Jc(2," block "),f.Rb(),f.Jc(3),f.ec(4,"translate"),f.Rb()}if(2&e){const e=f.dc();f.kc("disabled",0===e.selected.selected.length||e.allSelectedBlocked()),f.Ab(3),f.Lc(" ",f.fc(4,2,"FACILITY_DETAIL.SERVICES_DESTINATIONS.BLOCK")," ")}}function xe(e,t){1&e&&f.Nb(0,"mat-spinner",11)}function Pe(e,t){if(1&e){const e=f.Tb();f.Sb(0,"app-perun-web-apps-destination-list",12),f.Zb("page",(function(t){return f.xc(e),f.dc().pageChanged(t)})),f.Rb()}if(2&e){const e=f.dc();f.kc("pageSize",e.pageSize)("filterValue",e.filterValue)("destinations",e.destinations)("selection",e.selected)("displayedColumns",e.displayedColumns)}}let Ge=(()=>{class e{constructor(e,t,i,s,a,c,n,l,r){this.dialog=e,this.facilitiesManager=t,this.servicesManager=i,this.tableConfigService=s,this.translate=a,this.notificator=c,this.route=n,this.authResolver=l,this.serviceManager=r,this.selected=new P.c(!0,[]),this.displayedColumns=["select","destinationId","service","destination","type","propagationType"],this.filterValue="",this.tableId=Z.C}ngOnInit(){this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.loading=!0,this.route.parent.params.subscribe(e=>{this.facilitiesManager.getFacilityById(e.facilityId).subscribe(e=>{this.facility=e,this.refreshTable()})})}refreshTable(){this.loading=!0,this.servicesManager.getAllRichDestinationsForFacility(this.facility.id).subscribe(e=>{this.destinations=e,this.selected.clear(),this.setAuthRights(),this.loading=!1})}setAuthRights(){this.addAuth=this.authResolver.isAuthorized("addDestination_Service_Facility_Destination_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeDestination_Service_Facility_Destination_policy",[this.facility]),this.allowAuth=this.authResolver.isAuthorized("unblockServiceOnDestination_Service_int_policy",[this.facility]),this.blockAuth=this.authResolver.isAuthorized("blockServiceOnDestination_Service_int_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","destinationId","service","destination","type","status","propagationType"]:["destinationId","service","destination","type","status","propagationType"]}addDestination(){const e=Object(b.o)();e.width="600px",e.data={facility:this.facility,theme:"facility-theme"},this.dialog.open(Ne.a,e).afterClosed().subscribe(e=>{e&&this.translate.get("FACILITY_DETAIL.SERVICES_DESTINATIONS.ADD_SUCCESS").subscribe(e=>{this.refreshTable(),this.notificator.showSuccess(e)})})}removeDestination(){const e=Object(b.o)();e.width="600px",e.data={destinations:this.selected.selected,theme:"facility-theme"},this.dialog.open(ze.a,e).afterClosed().subscribe(e=>{e&&this.refreshTable()})}blockServiceOnDestinations(e){if(0===e.length)return this.notificator.showSuccess(this.translate.instant("FACILITY_DETAIL.SERVICES_DESTINATIONS.BLOCK_SUCCESS")),void this.refreshTable();const t=e.pop();this.serviceManager.blockServiceOnDestination(t.service.id,t.id).subscribe(()=>{this.blockServiceOnDestinations(e)},()=>this.loading=!1)}onBlock(){this.loading=!0,this.blockServiceOnDestinations(this.selected.selected)}allowServiceOnDestinations(e){if(0===e.length)return this.notificator.showSuccess(this.translate.instant("FACILITY_DETAIL.SERVICES_DESTINATIONS.ALLOW_SUCCESS")),void this.refreshTable();const t=e.pop();this.serviceManager.unblockServiceOnDestinationById(t.service.id,t.id).subscribe(()=>{this.allowServiceOnDestinations(e)},()=>this.loading=!1)}onAllow(){this.loading=!0,this.allowServiceOnDestinations(this.selected.selected)}applyFilter(e){this.filterValue=e}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}allSelectedAllowed(){return this.selected.selected.reduce((e,t)=>e&&!t.blocked,!0)}allSelectedBlocked(){return this.selected.selected.reduce((e,t)=>e&&t.blocked,!0)}}return e.id="FacilityServicesDestinationsComponent",e.\u0275fac=function(t){return new(t||e)(f.Mb(p.b),f.Mb(o.g),f.Mb(o.n),f.Mb(Z.pb),f.Mb(A.e),f.Mb(u.l),f.Mb(a.a),f.Mb(u.h),f.Mb(o.n))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-perun-web-apps-facility-services-destinations"]],hostVars:2,hostBindings:function(e,t){2&e&&f.Eb("router-component",!0)},decls:12,vars:10,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent","class","mr-2",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2",3,"disabled","click",4,"ngIf"],["mat-stroked-button","","class","mr-2",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","destinations","selection","displayedColumns","page",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2",3,"click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],["mat-stroked-button","",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","destinations","selection","displayedColumns","page"]],template:function(e,t){1&e&&(f.Sb(0,"div"),f.Sb(1,"h1",0),f.Jc(2),f.ec(3,"translate"),f.Rb(),f.Sb(4,"perun-web-apps-refresh-button",1),f.Zb("refresh",(function(){return t.refreshTable()})),f.Rb(),f.Hc(5,He,3,3,"button",2),f.Hc(6,Ye,3,4,"button",3),f.Hc(7,Ue,5,4,"button",4),f.Hc(8,Be,5,4,"button",4),f.Sb(9,"perun-web-apps-immediate-filter",5),f.Zb("filter",(function(e){return t.applyFilter(e)})),f.Rb(),f.Hc(10,xe,1,0,"mat-spinner",6),f.Hc(11,Pe,1,5,"app-perun-web-apps-destination-list",7),f.Rb()),2&e&&(f.Ab(2),f.Kc(f.fc(3,8,"FACILITY_DETAIL.SERVICES_DESTINATIONS.TITLE")),f.Ab(3),f.kc("ngIf",!t.loading&&t.addAuth),f.Ab(1),f.kc("ngIf",!t.loading&&t.removeAuth),f.Ab(1),f.kc("ngIf",!t.loading&&t.allowAuth),f.Ab(1),f.kc("ngIf",!t.loading&&t.blockAuth),f.Ab(1),f.kc("placeholder","FACILITY_DETAIL.SERVICES_DESTINATIONS.FILTER"),f.Ab(1),f.kc("ngIf",t.loading),f.Ab(1),f.kc("ngIf",!t.loading))},directives:[W.a,s.t,K.a,T.b,I.a,m.c,Ve.a],pipes:[A.d],styles:[""]}),e})();var Ze=i("st5j"),Je=i("noDS"),je=i("9Iem");function We(e,t){if(1&e){const e=f.Tb();f.Sb(0,"perun-web-apps-refresh-button",7),f.Zb("refresh",(function(){return f.xc(e),f.dc().refreshTable()})),f.Rb()}}function Ke(e,t){if(1&e){const e=f.Tb();f.Sb(0,"button",8),f.Zb("click",(function(){return f.xc(e),f.dc().onCreate()})),f.Jc(1),f.ec(2,"translate"),f.Rb()}2&e&&(f.Ab(1),f.Lc(" ",f.fc(2,1,"FACILITY_DETAIL.SETTINGS.OWNERS.ADD"),"\n"))}function $e(e,t){if(1&e){const e=f.Tb();f.Sb(0,"button",9),f.Zb("click",(function(){return f.xc(e),f.dc().onRemove()})),f.Jc(1),f.ec(2,"translate"),f.Rb()}if(2&e){const e=f.dc();f.kc("disabled",0===e.selection.selected.length),f.Ab(1),f.Lc(" ",f.fc(2,2,"FACILITY_DETAIL.SETTINGS.OWNERS.DELETE"),"\n")}}function qe(e,t){if(1&e){const e=f.Tb();f.Sb(0,"perun-web-apps-immediate-filter",10),f.Zb("filter",(function(t){return f.xc(e),f.dc().applyFilter(t)})),f.Rb()}2&e&&f.kc("placeholder","VO_MANAGEMENT.FILTER_PLACEHOLDER")}function Qe(e,t){1&e&&f.Nb(0,"mat-spinner",11)}function Xe(e,t){if(1&e){const e=f.Tb();f.Sb(0,"perun-web-apps-owners-list",12),f.Zb("page",(function(t){return f.xc(e),f.dc().pageChanged(t)})),f.Rb()}if(2&e){const e=f.dc();f.kc("pageSize",e.pageSize)("filterValue",e.filterValue)("owners",e.owners)("displayedColumns",e.displayedColumns)("selection",e.selection)}}let et=(()=>{class e{constructor(e,t,i,s,a){this.facilitiesManagerService=e,this.tableConfigService=t,this.route=i,this.dialog=s,this.authResolver=a,this.owners=[],this.selection=new P.c(!0,[]),this.displayedColumns=["id","name","contact","type"],this.tableId=Z.y}ngOnInit(){this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.filterValue="",this.route.parent.parent.params.subscribe(e=>{this.facilityId=parseInt(e.facilityId,10),this.facility={id:this.facilityId,beanName:"Facility"},this.refreshTable()})}refreshTable(){this.loading=!0,this.selection.clear(),this.facilitiesManagerService.getFacilityOwners(this.facilityId).subscribe(e=>{this.owners=e,this.setAuthRights(),this.loading=!1})}setAuthRights(){this.addAuth=this.authResolver.isAuthorized("addOwner_Facility_Owner_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeOwner_Facility_Owner_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","id","name","contact","type"]:["id","name","contact","type"]}applyFilter(e){this.filterValue=e}onCreate(){const e=Object(b.o)();e.width="800px",e.data={theme:"facility-theme",facilityId:this.facilityId,forbiddenOwners:this.owners.map(e=>e.id)},this.dialog.open(Ze.a,e).afterClosed().subscribe(e=>{e&&this.refreshTable()})}onRemove(){const e=Object(b.o)();e.width="600px",e.data={theme:"facility-theme",owners:this.selection.selected,facilityId:this.facilityId},this.dialog.open(Je.a,e).afterClosed().subscribe(e=>{e&&this.refreshTable()})}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(f.Mb(o.g),f.Mb(Z.pb),f.Mb(a.a),f.Mb(p.b),f.Mb(u.h))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-facility-settings-owners"]],decls:9,vars:9,consts:[[1,"page-subtitle"],[3,"refresh",4,"ngIf"],["class","mr-2","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","owners","displayedColumns","selection","page",4,"ngIf"],[3,"refresh"],["color","accent","mat-flat-button","",1,"mr-2",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[3,"placeholder","filter"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","owners","displayedColumns","selection","page"]],template:function(e,t){1&e&&(f.Sb(0,"h1",0),f.Jc(1),f.ec(2,"translate"),f.Rb(),f.Hc(3,We,1,0,"perun-web-apps-refresh-button",1),f.Hc(4,Ke,3,3,"button",2),f.Hc(5,$e,3,4,"button",3),f.Hc(6,qe,1,1,"perun-web-apps-immediate-filter",4),f.Hc(7,Qe,1,0,"mat-spinner",5),f.Hc(8,Xe,1,5,"perun-web-apps-owners-list",6)),2&e&&(f.Ab(1),f.Kc(f.fc(2,7,"FACILITY_DETAIL.SETTINGS.OWNERS.TITLE")),f.Ab(2),f.kc("ngIf",!t.loading),f.Ab(1),f.kc("ngIf",!t.loading&&t.addAuth),f.Ab(1),f.kc("ngIf",!t.loading&&t.removeAuth),f.Ab(1),f.kc("ngIf",!t.loading),f.Ab(1),f.kc("ngIf",t.loading),f.Ab(1),f.kc("ngIf",!t.loading))},directives:[s.t,W.a,T.b,K.a,m.c,je.a],pipes:[A.d],styles:[""]}),e})();var tt=i("dnAU"),it=i("vUrr"),st=i("gdiH");function at(e,t){if(1&e){const e=f.Tb();f.Sb(0,"button",7),f.Zb("click",(function(){return f.xc(e),f.dc().addHost()})),f.Jc(1),f.ec(2,"translate"),f.Rb()}2&e&&(f.Ab(1),f.Lc(" ",f.fc(2,1,"FACILITY_DETAIL.HOSTS.ADD")," "))}function ct(e,t){if(1&e){const e=f.Tb();f.Sb(0,"button",8),f.Zb("click",(function(){return f.xc(e),f.dc().removeHost()})),f.Jc(1),f.ec(2,"translate"),f.Rb()}if(2&e){const e=f.dc();f.kc("disabled",0===e.selected.selected.length),f.Ab(1),f.Lc(" ",f.fc(2,2,"FACILITY_DETAIL.HOSTS.REMOVE")," ")}}function nt(e,t){1&e&&f.Nb(0,"mat-spinner",9)}function lt(e,t){if(1&e){const e=f.Tb();f.Sb(0,"app-hosts-list",10),f.Zb("page",(function(t){return f.xc(e),f.dc().pageChanged(t)})),f.Rb()}if(2&e){const e=f.dc();f.kc("pageSize",e.pageSize)("filterValue",e.filterValue)("hosts",e.hosts)("selection",e.selected)("displayedColumns",e.displayedColumns)("disableRouting",!e.routeAuth)("facilityId",e.facilityId)}}let rt=(()=>{class e{constructor(e,t,i,s,a){this.dialog=e,this.facilitiesManager=t,this.tableConfigService=i,this.route=s,this.authResolver=a,this.hosts=[],this.selected=new P.c(!0,[]),this.filterValue="",this.tableId=Z.x,this.displayedColumns=["id","name"]}ngOnInit(){this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe(e=>{this.facilityId=e.facilityId,this.facilitiesManager.getFacilityById(this.facilityId).subscribe(e=>{this.facility=e,this.refreshTable()})})}refreshTable(){this.loading=!0,this.facilitiesManager.getHosts(this.facilityId).subscribe(e=>{this.hosts=e,this.selected.clear(),this.setAuthRights(),this.loading=!1})}setAuthRights(){this.addAuth=this.authResolver.isAuthorized("addHosts_Facility_List<String>_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeHosts_List<Host>_Facility_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","id","name"]:["id","name"],0!==this.hosts.length&&(this.routeAuth=this.authResolver.isAuthorized("getHostById_int_policy",[this.facility,this.hosts[0]]))}addHost(){const e=Object(b.o)();e.width="600px",e.data={facilityId:this.facility.id,facilityName:this.facility.name,theme:"facility-theme"},this.dialog.open(tt.a,e).afterClosed().subscribe(e=>{e&&this.refreshTable()})}removeHost(){const e=Object(b.o)();e.width="600px",e.data={facilityId:this.facility.id,theme:"facility-theme",hosts:this.selected.selected},this.dialog.open(it.a,e).afterClosed().subscribe(e=>{e&&this.refreshTable()})}applyFilter(e){this.filterValue=e}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(f.Mb(p.b),f.Mb(o.g),f.Mb(Z.pb),f.Mb(a.a),f.Mb(u.h))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-facility-hosts"]],decls:10,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent","class","mr-2",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","hosts","selection","displayedColumns","disableRouting","facilityId","page",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2",3,"click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","hosts","selection","displayedColumns","disableRouting","facilityId","page"]],template:function(e,t){1&e&&(f.Sb(0,"div"),f.Sb(1,"h1",0),f.Jc(2),f.ec(3,"translate"),f.Rb(),f.Sb(4,"perun-web-apps-refresh-button",1),f.Zb("refresh",(function(){return t.refreshTable()})),f.Rb(),f.Hc(5,at,3,3,"button",2),f.Hc(6,ct,3,4,"button",3),f.Sb(7,"perun-web-apps-immediate-filter",4),f.Zb("filter",(function(e){return t.applyFilter(e)})),f.Rb(),f.Hc(8,nt,1,0,"mat-spinner",5),f.Hc(9,lt,1,7,"app-hosts-list",6),f.Rb()),2&e&&(f.Ab(2),f.Kc(f.fc(3,6,"FACILITY_DETAIL.HOSTS.TITLE")),f.Ab(3),f.kc("ngIf",!t.loading&&t.addAuth),f.Ab(1),f.kc("ngIf",!t.loading&&t.removeAuth),f.Ab(1),f.kc("placeholder","FACILITY_DETAIL.HOSTS.FILTER"),f.Ab(1),f.kc("ngIf",t.loading),f.Ab(1),f.kc("ngIf",!t.loading))},directives:[W.a,s.t,K.a,T.b,m.c,st.a],pipes:[A.d],styles:[""]}),e})();var ot=i("77So");function bt(e,t){1&e&&f.Nb(0,"mat-spinner",5)}function ut(e,t){if(1&e){const e=f.Tb();f.Sb(0,"app-perun-web-apps-blacklist-list",6),f.Zb("page",(function(t){return f.xc(e),f.dc().pageChanged(t)})),f.Rb()}if(2&e){const e=f.dc();f.kc("pageSize",e.pageSize)("filterValue",e.filterValue)("bansOnFacilitiesWithUsers",e.bansOnFacilitiesWithUsers)("selection",e.selected)}}let ht=(()=>{class e{constructor(e,t,i,s){this.facilitiesManager=e,this.usersManager=t,this.tableConfigService=i,this.route=s,this.bansOnFacilitiesWithUsers=[],this.selected=new P.c(!0,[]),this.filterValue="",this.tableId=Z.w}ngOnInit(){this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.refreshTable()}refreshTable(){this.loading=!0,this.route.parent.parent.params.subscribe(e=>{this.facilitiesManager.getBansForFacility(e.facilityId).subscribe(e=>{const t=e;for(const i of t){let e;this.usersManager.getUserById(i.userId).subscribe(t=>{e=t}),this.bansOnFacilitiesWithUsers.push([i,e])}this.selected.clear(),this.loading=!1})})}applyFilter(e){this.filterValue=e}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(f.Mb(o.g),f.Mb(o.q),f.Mb(Z.pb),f.Mb(a.a))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-perun-web-apps-facility-settings-blacklist"]],decls:9,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","bansOnFacilitiesWithUsers","selection","page",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","bansOnFacilitiesWithUsers","selection","page"]],template:function(e,t){1&e&&(f.Sb(0,"div"),f.Sb(1,"h1",0),f.Jc(2),f.ec(3,"translate"),f.Rb(),f.Sb(4,"perun-web-apps-refresh-button",1),f.Zb("refresh",(function(){return t.refreshTable()})),f.Rb(),f.Sb(5,"perun-web-apps-immediate-filter",2),f.Zb("filter",(function(e){return t.applyFilter(e)})),f.ec(6,"translate"),f.Rb(),f.Hc(7,bt,1,0,"mat-spinner",3),f.Hc(8,ut,1,4,"app-perun-web-apps-blacklist-list",4),f.Rb()),2&e&&(f.Ab(2),f.Kc(f.fc(3,4,"FACILITY_DETAIL.SETTINGS.BLACKLIST.TITLE")),f.Ab(3),f.kc("placeholder",f.fc(6,6,"FACILITY_DETAIL.SETTINGS.BLACKLIST.FILTER")),f.Ab(2),f.kc("ngIf",t.loading),f.Ab(1),f.kc("ngIf",!t.loading))},directives:[W.a,K.a,s.t,m.c,ot.a],pipes:[A.d],styles:[""]}),e})();const dt=["list"];function ft(e,t){if(1&e){const e=f.Tb();f.Sb(0,"perun-web-apps-attributes-list",6,7),f.Zb("page",(function(t){return f.xc(e),f.dc().pageChanged(t)})),f.Rb()}if(2&e){const e=f.dc();f.kc("pageSize",e.pageSize)("attributes",e.attributes)("selection",e.selected)}}let pt=(()=>{class e{constructor(e,t,i,s,a){this.dialog=e,this.attributesManager=t,this.facilityManager=i,this.tableConfigService=s,this.route=a,this.attributes=[],this.selected=new P.c(!0,[]),this.host={beanName:"",id:0},this.tableId=Z.r}ngOnInit(){this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.params.subscribe(e=>{this.hostId=e.hostId,this.facilityManager.getHostById(this.hostId).subscribe(e=>{this.host=e}),this.refreshTable()})}refreshTable(){this.loading=!0,this.attributesManager.getHostAttributes(this.hostId).subscribe(e=>{this.attributes=Object(b.j)(e),this.selected.clear(),this.loading=!1})}onSave(){this.list.updateMapAttributes();const e=Object(b.o)();e.width="450px",e.data={entityId:this.hostId,entity:"host",attributes:this.selected.selected},this.dialog.open(h.f,e).afterClosed().subscribe(e=>{e&&this.refreshTable()})}addAttribute(){const e=Object(b.o)();e.width="1050px",e.data={entityId:this.hostId,entity:"host",notEmptyAttributes:this.attributes,style:"facility-theme"},this.dialog.open(J.a,e).afterClosed().subscribe(e=>{"saved"===e&&this.refreshTable()})}removeAttribute(){const e=Object(b.o)();e.width="450px",e.data={entityId:this.hostId,entity:"host",attributes:this.selected.selected,theme:"facility-theme"},this.dialog.open(G.a,e).afterClosed().subscribe(e=>{e&&this.refreshTable()})}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(f.Mb(p.b),f.Mb(o.c),f.Mb(o.g),f.Mb(Z.pb),f.Mb(a.a))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-facility-hosts-detail"]],viewQuery:function(e,t){var i;1&e&&f.Qc(dt,!0),2&e&&f.sc(i=f.ac())&&(t.list=i.first)},decls:15,vars:16,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent",1,"mr-2",3,"click"],["mat-flat-button","","color","accent",1,"mr-2",3,"disabled","click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[3,"pageSize","attributes","selection","page",4,"ngIf"],[3,"pageSize","attributes","selection","page"],["list",""]],template:function(e,t){1&e&&(f.Sb(0,"div"),f.Sb(1,"h1",0),f.Jc(2),f.ec(3,"translate"),f.Rb(),f.Sb(4,"perun-web-apps-refresh-button",1),f.Zb("refresh",(function(){return t.refreshTable()})),f.Rb(),f.Sb(5,"button",2),f.Zb("click",(function(){return t.addAttribute()})),f.Jc(6),f.ec(7,"translate"),f.Rb(),f.Sb(8,"button",3),f.Zb("click",(function(){return t.onSave()})),f.Jc(9),f.ec(10,"translate"),f.Rb(),f.Sb(11,"button",4),f.Zb("click",(function(){return t.removeAttribute()})),f.Jc(12),f.ec(13,"translate"),f.Rb(),f.Hc(14,ft,2,3,"perun-web-apps-attributes-list",5),f.Rb()),2&e&&(f.Ab(2),f.Mc(" ",f.fc(3,8,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.TITLE")," ",t.host.hostname,""),f.Ab(4),f.Lc(" ",f.fc(7,10,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.ADD")," "),f.Ab(2),f.kc("disabled",0===t.selected.selected.length),f.Ab(1),f.Lc(" ",f.fc(10,12,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.SAVE")," "),f.Ab(2),f.kc("disabled",0===t.selected.selected.length),f.Ab(1),f.Lc(" ",f.fc(13,14,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.REMOVE")," "),f.Ab(2),f.kc("ngIf",!t.loading))},directives:[W.a,T.b,s.t,$.a],pipes:[A.d],styles:[""]}),e})();var gt=i("iT3j");function mt(e,t){1&e&&f.Nb(0,"mat-spinner",5)}function It(e,t){if(1&e){const e=f.Tb();f.Sb(0,"app-security-teams-list",6),f.Zb("page",(function(t){return f.xc(e),f.dc().pageChanged(t)})),f.Rb()}if(2&e){const e=f.dc();f.kc("pageSize",e.pageSize)("filterValue",e.filterValue)("securityTeams",e.securityTeams)("displayedColumns",e.displayedColumns)("selection",e.selected)}}let St=(()=>{class e{constructor(e,t,i,s,a){this.dialog=e,this.facilitiesManager=t,this.tableConfigService=i,this.route=s,this.authResolver=a,this.securityTeams=[],this.selected=new P.c(!0,[]),this.filterValue="",this.tableId=Z.A,this.displayedColumns=[]}ngOnInit(){this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe(e=>{this.facilitiesManager.getFacilityById(e.facilityId).subscribe(e=>{this.facility=e,this.refreshTable()})})}refreshTable(){this.loading=!0,this.facilitiesManager.getAssignedSecurityTeams(this.facility.id).subscribe(e=>{this.securityTeams=e,this.selected.clear(),this.setAuthRights(),this.loading=!1})}setAuthRights(){this.addAuth=this.authResolver.isAuthorized("assignSecurityTeam_Facility_SecurityTeam_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeSecurityTeam_Facility_SecurityTeam_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","id","name","description"]:["id","name","description"]}applyFilter(e){this.filterValue=e}addSecurityTeam(){}removeSecurityTeam(){}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(f.Mb(p.b),f.Mb(o.g),f.Mb(Z.pb),f.Mb(a.a),f.Mb(u.h))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-facility-security-teams"]],decls:8,vars:6,consts:[[1,"page-subtitle"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","securityTeams","displayedColumns","selection","page",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","securityTeams","displayedColumns","selection","page"]],template:function(e,t){1&e&&(f.Sb(0,"div"),f.Sb(1,"h1",0),f.Jc(2),f.ec(3,"translate"),f.Rb(),f.Sb(4,"perun-web-apps-refresh-button",1),f.Zb("refresh",(function(){return t.refreshTable()})),f.Rb(),f.Sb(5,"perun-web-apps-immediate-filter",2),f.Zb("filter",(function(e){return t.applyFilter(e)})),f.Rb(),f.Hc(6,mt,1,0,"mat-spinner",3),f.Hc(7,It,1,5,"app-security-teams-list",4),f.Rb()),2&e&&(f.Ab(2),f.Kc(f.fc(3,4,"FACILITY_DETAIL.SECURITY_TEAMS.TITLE")),f.Ab(3),f.kc("placeholder","FACILITY_DETAIL.SECURITY_TEAMS.FILTER"),f.Ab(1),f.kc("ngIf",t.loading),f.Ab(1),f.kc("ngIf",!t.loading))},directives:[W.a,K.a,s.t,m.c,gt.a],pipes:[A.d],styles:[""]}),e})();var yt=i("Fm3m"),Tt=i("TNye"),At=i("CIWc"),vt=i("RCwe"),Et=i("NMas"),Rt=i("Jb3d"),Ct=i("WLDY");function Lt(e,t){if(1&e){const e=f.Tb();f.Sb(0,"button",11),f.Zb("click",(function(){return f.xc(e),f.dc().forcePropagation()})),f.Jc(1),f.ec(2,"translate"),f.Rb()}if(2&e){const e=f.dc();f.kc("disabled",0===e.selected.selected.length),f.Ab(1),f.Lc(" ",f.fc(2,2,"FACILITY_DETAIL.SERVICES_STATUS.FORCE_PROPAGATION")," ")}}function kt(e,t){if(1&e){const e=f.Tb();f.Sb(0,"button",11),f.Zb("click",(function(){return f.xc(e),f.dc().allow()})),f.Jc(1),f.ec(2,"translate"),f.Rb()}if(2&e){const e=f.dc();f.kc("disabled",0===e.selected.selected.length||e.disableAllowButton),f.Ab(1),f.Lc(" ",f.fc(2,2,"FACILITY_DETAIL.SERVICES_STATUS.ALLOW")," ")}}function Ft(e,t){if(1&e){const e=f.Tb();f.Sb(0,"button",12),f.Zb("click",(function(){return f.xc(e),f.dc().block()})),f.Jc(1),f.ec(2,"translate"),f.Rb()}if(2&e){const e=f.dc();f.kc("disabled",0===e.selected.selected.length||e.disableBlockButton),f.Ab(1),f.Lc(" ",f.fc(2,2,"FACILITY_DETAIL.SERVICES_STATUS.BLOCK")," ")}}function _t(e,t){if(1&e&&(f.Sb(0,"button",13),f.ec(1,"translate"),f.Jc(2),f.ec(3,"translate"),f.Rb()),2&e){const e=f.dc(),t=f.tc(10);f.lc("matTooltip",f.fc(1,5,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOXES_DISABLED")),f.kc("matTooltipDisabled",!e.disableRemoveButton)("disabled",e.disableRemoveButton)("matMenuTriggerFor",t),f.Ab(2),f.Lc(" ",f.fc(3,7,"FACILITY_DETAIL.SERVICES_STATUS.REMOVE")," ")}}function Mt(e,t){if(1&e){const e=f.Tb();f.Sb(0,"button",7),f.Zb("click",(function(){return f.xc(e),f.dc().removeTaskResults()})),f.Jc(1),f.ec(2,"translate"),f.Rb()}2&e&&(f.Ab(1),f.Lc(" ",f.fc(2,1,"FACILITY_DETAIL.SERVICES_STATUS.REMOVE_TASK_RESULTS")," "))}function wt(e,t){1&e&&f.Nb(0,"mat-spinner",14)}function Ot(e,t){if(1&e){const e=f.Tb();f.Sb(0,"perun-web-apps-services-status-list",15),f.Zb("page",(function(t){return f.xc(e),f.dc().pageChanged(t)}))("selectionChange",(function(){return f.xc(e),f.dc().selectionChanged()})),f.Rb()}if(2&e){const e=f.dc();f.kc("pageSize",e.pageSize)("filterValue",e.filterValue)("servicesStatus",e.servicesStates)("selection",e.selected)("disableRouting",!e.routeAuth)}}let Dt=(()=>{class e{constructor(e,t,i,s,a,c,n,l,r,o){this.route=e,this.tasksManager=t,this.tableConfigService=i,this.servicesManager=s,this.notificator=a,this.translate=c,this.authResolver=n,this.facilityManager=l,this.resourcesManager=r,this.dialog=o,this.servicesStates=[],this.selected=new P.c(!0,[]),this.filterValue="",this.tableId=Z.D,this.disableAllowButton=!0,this.disableBlockButton=!0,this.disableRemoveButton=!0,c.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_FORCE_PROPAGATION").subscribe(e=>this.successFPMessage=e),c.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_ALLOW").subscribe(e=>this.successAllowMessage=e),c.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_BLOCK").subscribe(e=>this.successBlockMessage=e),c.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_DELETE").subscribe(e=>this.successDeleteMessage=e),c.get("FACILITY_DETAIL.SERVICES_STATUS.ALREADY_DELETED").subscribe(e=>this.allreadyDeletedMessage=e)}ngOnInit(){this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe(e=>{this.facilityId=parseInt(e.facilityId,10),this.facility={id:this.facilityId,beanName:"Facility"},this.refreshTable()})}forcePropagation(){for(const e of this.selected.selected)this.servicesManager.forceServicePropagation(e.service.id,e.facility.id).subscribe(()=>{this.refreshTable(),this.notificator.showSuccess(this.successFPMessage)})}allow(){for(const e of this.selected.selected)this.servicesManager.unblockServiceOnFacility(e.service.id,e.facility.id).subscribe(()=>{this.refreshTable(),this.notificator.showSuccess(this.successAllowMessage)})}block(){for(const e of this.selected.selected)this.servicesManager.blockServiceOnFacility(e.service.id,e.facility.id).subscribe(()=>{this.refreshTable(),this.notificator.showSuccess(this.successBlockMessage)})}removeTaskResults(){this.tasksManager.getTaskResultsForGUIByTask(this.selected.selected[0].task.id).subscribe(e=>{const t=Object(b.o)();t.width="600px",t.data={theme:"facility-theme",taskResults:e},this.dialog.open(At.a,t)})}removeServiceFromFacility(){this.facilityManager.getAssignedResourcesByAssignedServiceForFacility(this.selected.selected[0].facility.id,this.selected.selected[0].service.id).subscribe(e=>{const t=Object(b.o)();t.width="600px",this.taskId=this.taskIsNull?null:this.selected.selected[0].task.id,0===e.length?(t.data={theme:"facility-theme",taskId:this.taskId},this.dialog.open(Et.a,t).afterClosed().subscribe(e=>{e&&(this.disableRemoveButton=!0,this.refreshTable())})):this.resourcesManager.getRichResourcesByIds(e.map(e=>e.id)).subscribe(e=>{t.data={theme:"facility-theme",taskId:this.taskId,serviceId:this.selected.selected[0].service.id,facilityId:this.selected.selected[0].facility.id,resource:e},this.dialog.open(vt.a,t).afterClosed().subscribe(e=>{e&&(this.disableRemoveButton=!0,this.refreshTable())})})})}refreshTable(){this.loading=!0,this.tasksManager.getFacilityServicesState(this.facilityId).subscribe(e=>{this.servicesStates=e,this.selected.clear(),this.setAuthRights(),this.loading=!1})}setAuthRights(){this.propagationAuth=this.authResolver.isAuthorized("forceServicePropagation_Facility_Service_policy",[this.facility]),this.blockAuth=this.authResolver.isAuthorized("blockServiceOnFacility_Service_Facility_policy",[this.facility]),this.allowAuth=this.authResolver.isAuthorized("unblockServiceOnFacility_Service_Facility_policy",[this.facility]),this.deleteAuth=this.authResolver.isAuthorized("deleteTask_Task_policy",[this.facility]),this.routeAuth=this.authResolver.isAuthorized("getTaskResultsByTask_int_policy",[this.facility])}applyFilter(e){this.filterValue=e}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}selectionChanged(){this.disableBlockButton=!0,this.disableAllowButton=!0,this.disableRemoveButton=1!==this.selected.selected.length,this.disableRemoveButton||(this.taskIsNull=null===this.selected.selected[0].task);for(const e of this.selected.selected)e.blockedOnFacility?this.disableAllowButton=!1:this.disableBlockButton=!1}}return e.\u0275fac=function(t){return new(t||e)(f.Mb(a.a),f.Mb(o.o),f.Mb(Z.pb),f.Mb(o.n),f.Mb(u.l),f.Mb(A.e),f.Mb(u.h),f.Mb(o.g),f.Mb(o.m),f.Mb(p.b))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-facility-service-status"]],decls:18,vars:14,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent","class","mr-2",3,"disabled","click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2",3,"disabled","click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2 dropdown-toggle",3,"matTooltip","matTooltipDisabled","disabled","matMenuTriggerFor",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","servicesStatus","selection","disableRouting","page","selectionChange",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2",3,"disabled","click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],["mat-flat-button","","color","warn",1,"mr-2","dropdown-toggle",3,"matTooltip","matTooltipDisabled","disabled","matMenuTriggerFor"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","servicesStatus","selection","disableRouting","page","selectionChange"]],template:function(e,t){1&e&&(f.Sb(0,"div"),f.Sb(1,"h1",0),f.Jc(2),f.ec(3,"translate"),f.Rb(),f.Sb(4,"perun-web-apps-refresh-button",1),f.Zb("refresh",(function(){return t.refreshTable()})),f.Rb(),f.Hc(5,Lt,3,4,"button",2),f.Hc(6,kt,3,4,"button",2),f.Hc(7,Ft,3,4,"button",3),f.Hc(8,_t,4,9,"button",4),f.Sb(9,"mat-menu",null,5),f.Hc(11,Mt,3,3,"button",6),f.Sb(12,"button",7),f.Zb("click",(function(){return t.removeServiceFromFacility()})),f.Jc(13),f.ec(14,"translate"),f.Rb(),f.Rb(),f.Sb(15,"perun-web-apps-immediate-filter",8),f.Zb("filter",(function(e){return t.applyFilter(e)})),f.Rb(),f.Hc(16,wt,1,0,"mat-spinner",9),f.Hc(17,Ot,1,5,"perun-web-apps-services-status-list",10),f.Rb()),2&e&&(f.Ab(2),f.Kc(f.fc(3,10,"FACILITY_DETAIL.SERVICES_STATUS.TITLE")),f.Ab(3),f.kc("ngIf",!t.loading&&t.propagationAuth),f.Ab(1),f.kc("ngIf",!t.loading&&t.allowAuth),f.Ab(1),f.kc("ngIf",!t.loading&&t.blockAuth),f.Ab(1),f.kc("ngIf",!t.loading&&t.deleteAuth),f.Ab(3),f.kc("ngIf",!t.taskIsNull),f.Ab(2),f.Kc(f.fc(14,12,"FACILITY_DETAIL.SERVICES_STATUS.REMOVE_SERVICE_FROM_FACILITY")),f.Ab(2),f.kc("placeholder","SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.TABLE_SEARCH"),f.Ab(1),f.kc("ngIf",t.loading),f.Ab(1),f.kc("ngIf",!t.loading))},directives:[W.a,s.t,Rt.e,Rt.b,K.a,T.b,S.a,Rt.d,m.c,Ct.a],pipes:[A.d],styles:[""]}),e})();var zt=i("FcRk"),Nt=i("NC8S");function Vt(e,t){if(1&e){const e=f.Tb();f.Sb(0,"perun-web-apps-refresh-button",6),f.Zb("refresh",(function(){return f.xc(e),f.dc().refreshTable()})),f.Rb()}}function Ht(e,t){if(1&e){const e=f.Tb();f.Sb(0,"perun-web-apps-immediate-filter",7),f.Zb("filter",(function(t){return f.xc(e),f.dc().applyFilter(t)})),f.Rb()}2&e&&f.kc("placeholder","FACILITY_DETAIL.ALLOWED_USERS.FILTER")}function Yt(e,t){1&e&&f.Nb(0,"mat-spinner",8)}function Ut(e,t){1&e&&(f.Sb(0,"app-alert",9),f.Jc(1),f.ec(2,"translate"),f.Rb()),2&e&&(f.Ab(1),f.Lc(" ",f.fc(2,1,"FACILITY_DETAIL.ALLOWED_USERS.NO_USERS")," "))}const Bt=function(){return["id","name"]};function xt(e,t){if(1&e){const e=f.Tb();f.Sb(0,"app-users-list",10),f.Zb("page",(function(t){return f.xc(e),f.dc().pageChanged(t)})),f.Rb()}if(2&e){const e=f.dc();f.kc("pageSize",e.pageSize)("users",e.users)("displayedColumns",f.oc(5,Bt))("disableRouting",!e.routeAuth)("filter",e.filterValue)}}let Pt=(()=>{class e{constructor(e,t,i,s){this.route=e,this.facilityService=t,this.tableConfigService=i,this.authResolver=s,this.loading=!1,this.filterValue="",this.tableId=Z.v}ngOnInit(){this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe(e=>{this.facilityId=e.facilityId,this.routeAuth=this.authResolver.isPerunAdmin(),this.refreshTable()})}refreshTable(){this.loading=!0,this.facilityService.getAssignedUsers(this.facilityId).subscribe(e=>{this.users=e,this.loading=!1})}applyFilter(e){this.filterValue=e}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(f.Mb(a.a),f.Mb(o.g),f.Mb(Z.pb),f.Mb(u.h))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-facility-allowed-users"]],decls:9,vars:8,consts:[[1,"page-subtitle"],[3,"refresh",4,"ngIf"],[3,"placeholder","filter",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],["alert_type","warn",4,"ngIf"],[3,"pageSize","users","displayedColumns","disableRouting","filter","page",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],[1,"ml-auto","mr-auto"],["alert_type","warn"],[3,"pageSize","users","displayedColumns","disableRouting","filter","page"]],template:function(e,t){1&e&&(f.Sb(0,"div"),f.Sb(1,"h1",0),f.Jc(2),f.ec(3,"translate"),f.Rb(),f.Hc(4,Vt,1,0,"perun-web-apps-refresh-button",1),f.Hc(5,Ht,1,1,"perun-web-apps-immediate-filter",2),f.Hc(6,Yt,1,0,"mat-spinner",3),f.Hc(7,Ut,3,3,"app-alert",4),f.Hc(8,xt,1,6,"app-users-list",5),f.Rb()),2&e&&(f.Ab(2),f.Kc(f.fc(3,6,"FACILITY_DETAIL.ALLOWED_USERS.TITLE")),f.Ab(2),f.kc("ngIf",!t.loading),f.Ab(1),f.kc("ngIf",!t.loading),f.Ab(1),f.kc("ngIf",t.loading),f.Ab(1),f.kc("ngIf",!t.loading&&(void 0===t.users||0===t.users.length)),f.Ab(1),f.kc("ngIf",!t.loading&&0!==t.users.length))},directives:[s.t,W.a,K.a,m.c,zt.a,Nt.a],pipes:[A.d],styles:[""]}),e})();var Gt=i("lfUW"),Zt=i("COMt");function Jt(e,t){if(1&e){const e=f.Tb();f.Sb(0,"button",8),f.Zb("click",(function(){return f.xc(e),f.dc(2).removeTaskResult()})),f.Jc(1),f.ec(2,"translate"),f.Rb()}if(2&e){const e=f.dc(2);f.kc("disabled",0===e.selection.selected.length),f.Ab(1),f.Lc(" ",f.fc(2,2,"FACILITY_DETAIL.TASK_RESULTS.REMOVE")," ")}}function jt(e,t){1&e&&f.Nb(0,"mat-spinner",9)}function Wt(e,t){if(1&e){const e=f.Tb();f.Sb(0,"perun-web-apps-task-results-list",10),f.Zb("page",(function(t){return f.xc(e),f.dc(2).pageChanged(t)})),f.Rb()}if(2&e){const e=f.dc(2);f.kc("displayedColumns",e.displayedColumns)("filterValue",e.filterValue)("pageSize",e.pageSize)("selection",e.selection)("taskResults",e.taskResults)}}function Kt(e,t){if(1&e){const e=f.Tb();f.Sb(0,"div"),f.Sb(1,"h1",1),f.Jc(2),f.ec(3,"translate"),f.Sb(4,"span",2),f.Jc(5),f.Rb(),f.Rb(),f.Sb(6,"perun-web-apps-refresh-button",3),f.Zb("refresh",(function(){return f.xc(e),f.dc().refreshTable()})),f.Rb(),f.Hc(7,Jt,3,4,"button",4),f.Sb(8,"perun-web-apps-immediate-filter",5),f.Zb("filter",(function(t){return f.xc(e),f.dc().applyFilter(t)})),f.Rb(),f.Hc(9,jt,1,0,"mat-spinner",6),f.Hc(10,Wt,1,5,"perun-web-apps-task-results-list",7),f.Rb()}if(2&e){const e=f.dc();f.Ab(2),f.Mc("",f.fc(3,7,"FACILITY_DETAIL.TASK_RESULTS.TITLE")," - ",e.task.service.name," "),f.Ab(3),f.Lc(" \xa0#",e.task.id," "),f.Ab(2),f.kc("ngIf",!e.loading&&e.removeAuth),f.Ab(1),f.kc("placeholder","FACILITY_DETAIL.TASK_RESULTS.FILTER"),f.Ab(1),f.kc("ngIf",e.loading),f.Ab(1),f.kc("ngIf",!e.loading)}}const $t=[{path:"",component:c.a},{path:":facilityId",component:F,children:[{path:"",component:O,data:{animation:"FacilityOverviewPage"}},{path:"attributes",component:ne,data:{animation:"FacilityAttributesPage"}},{path:"resources",component:D.a,data:{animation:"FacilityResourcesPage"}},{path:"allowed-users",component:Pt,data:{animation:"FacilityAllowedUsersPage"}},{path:"allowed-groups",component:z.a,data:{animation:"FacilityAllowedGroupsPage"}},{path:"services-status",component:Dt,data:{animation:"FacilityServiceStatusPage"}},{path:"services-status/:taskId",component:(()=>{class e{constructor(e,t,i,s,a){this.route=e,this.tableConfigService=t,this.taskManager=i,this.authResolver=s,this.dialog=a,this.loading=!1,this.filterValue="",this.selection=new P.c(!0,[]),this.tableId=Z.Y,this.displayedColumns=["select","id","destination","type","service","status","time","returnCode","standardMessage","errorMessage"],this.removeAuth=!1}ngOnInit(){this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe(e=>{this.facility={id:parseInt(e.facilityId,10),beanName:"Facility"},this.removeAuth=this.authResolver.isAuthorized("deleteTask_Task_policy",[this.facility]),this.removeAuth||(this.displayedColumns=["id","destination","type","service","status","time","returnCode","standardMessage","errorMessage"]),this.route.params.subscribe(e=>{this.taskId=e.taskId,this.taskManager.getTaskById(this.taskId).subscribe(e=>{this.task=e,this.refreshTable()})})})}refreshTable(){this.loading=!0,this.taskManager.getTaskResultsForGUIByTask(this.taskId).subscribe(e=>{this.selection.clear(),this.taskResults=e,this.loading=!1})}removeTaskResult(){const e=Object(b.o)();e.width="600px",e.data={theme:"facility-theme",taskResults:this.selection.selected},this.dialog.open(At.a,e).afterClosed().subscribe(e=>{e&&this.refreshTable()})}applyFilter(e){this.filterValue=e}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(f.Mb(a.a),f.Mb(Z.pb),f.Mb(o.o),f.Mb(u.h),f.Mb(p.b))},e.\u0275cmp=f.Gb({type:e,selectors:[["app-facility-task-results"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-subtitle"],[1,"text-muted"],[3,"refresh"],["class","mr-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"displayedColumns","filterValue","pageSize","selection","taskResults","page",4,"ngIf"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"displayedColumns","filterValue","pageSize","selection","taskResults","page"]],template:function(e,t){1&e&&f.Hc(0,Kt,11,9,"div",0),2&e&&f.kc("ngIf",!t.loading)},directives:[s.t,W.a,K.a,T.b,m.c,Zt.a],pipes:[A.d],styles:[""]}),e})(),data:{animation:"FacilityTaskResultsPage"}},{path:"service-config",component:Me,data:{animation:"FacilityServiceConfigPage"}},{path:"services-destinations",component:Ge,data:{animation:"FacilityServicesDestinationsPage"}},{path:"hosts",component:rt,data:{animation:"FacilityHostsPage"}},{path:"hosts/:hostId",component:pt,data:{animation:"FacilityHostsDetailPage"}},{path:"settings",component:H,children:[{path:"",component:B,data:{animation:"FacilitySettingsOverviewPage"}},{path:"owners",component:et,data:{animation:"FacilitySettingOwnersPage"}},{path:"managers",component:De,data:{animation:"FacilitySettingsManagersPage"}},{path:"security-teams",component:St,data:{animation:"FacilitySecurityTeamsPage"}},{path:"blacklist",component:ht,data:{animation:"FacilitySettingsBlackListPage"}}]}]},{path:":facilityId/resources/:resourceId",component:N.a,children:[{path:"",component:V.a,data:{animation:"ResourceOverviewPage"}},{path:"attributes",component:oe.a,data:{animation:"ResourceAttributesPage"}},{path:"groups",component:be.a,data:{animation:"ResourceGroupsComponent"}},{path:"services",component:Tt.a,data:{animation:"ResourceAssignedServicesComponent"}},{path:"members",component:Gt.a,data:{animation:"ResourceAssignedMembersComponent"}},{path:"settings",component:le.a,children:[{path:"",component:re.a,data:{animation:"ResourceSettingsOverviewPage"}},{path:"managers",component:yt.a,data:{animation:"ResourceSettingsManagersPage"}}]}]}];let qt=(()=>{class e{}return e.\u0275mod=f.Kb({type:e}),e.\u0275inj=f.Jb({factory:function(t){return new(t||e)},imports:[[a.j.forChild($t)],a.j]}),e})();var Qt=i("PCNd"),Xt=i("KoHB"),ei=i("zrcO");let ti=(()=>{class e{}return e.\u0275mod=f.Kb({type:e}),e.\u0275inj=f.Jb({factory:function(t){return new(t||e)},providers:[fe.c],imports:[[s.c,qt,Qt.a,Xt.a,x.d,fe.b,ei.UsersModule]]}),e})()}}]);