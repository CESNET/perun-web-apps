function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,i=function(){};return{s:i,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s,n=!0,c=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return n=e.done,e},e:function(e){c=!0,s=e},f:function(){try{n||null==a.return||a.return()}finally{if(c)throw s}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"pjY/":function(e,t,i){"use strict";i.r(t),i.d(t,"FacilitiesModule",(function(){return ci}));var a=i("2kYt"),s=i("sEIs"),n=i("VFai"),c=i("TkCa"),r=i("4sdY"),l=i("EkAj"),o=i("X2Q7"),u=i("8clQ"),f=i("Ssnw"),b=i("+0js"),h=i("EM62"),d=i("OZ4H"),p=i("EtYo"),g=i("ma6z"),y=i("csyo"),m=i("bFHC"),I=i("Y2X+"),v=i("PBFl"),S=i("s2Ay");function C(e,t){1&e&&h.Rb(0,"mat-spinner",3)}function T(e,t){if(1&e){var i=h.Xb();h.Wb(0,"button",12),h.ec("click",(function(){return h.Bc(i),h.ic(2).editFacility()})),h.Wb(1,"mat-icon"),h.Lc(2,"edit"),h.Vb(),h.Vb()}}var A=function(){return{color:"black"}},E=function(e){return["/facilities",e]};function k(e,t){if(1&e&&(h.Wb(0,"div",4),h.Rb(1,"mat-icon",5),h.jc(2,"translate"),h.Wb(3,"div",6),h.Wb(4,"div",7),h.Wb(5,"a",8),h.Lc(6),h.Vb(),h.Wb(7,"span",9),h.Lc(8),h.Vb(),h.Jc(9,T,3,0,"button",10),h.Vb(),h.Wb(10,"span",11),h.Lc(11),h.jc(12,"translate"),h.jc(13,"translate"),h.Vb(),h.Vb(),h.Vb()),2&e){var i=h.ic();h.Cb(1),h.pc("matTooltip",h.kc(2,9,"FACILITY_DETAIL.ENTITY")),h.oc("ngStyle",h.sc(15,A)),h.Cb(4),h.oc("routerLink",h.tc(16,E,i.facility.id)),h.Cb(1),h.Mc(i.facility.name),h.Cb(2),h.Nc(" \xa0#",i.facility.id," "),h.Cb(1),h.oc("ngIf",i.editFacilityAuth),h.Cb(2),h.Pc(" ",h.kc(12,11,"FACILITY_DETAIL.ENTITY"),", ",h.kc(13,13,"FACILITY_DETAIL.DESCRIPTION"),": ",i.facility.description," ")}}var _,L=((_=function(){function e(t,i,a,s,n,c){_classCallCheck(this,e),this.dialog=t,this.facilityManager=i,this.route=a,this.sideMenuService=s,this.sideMenuItemService=n,this.guiAuthResolver=c,this.editFacilityAuth=!1,this.loading=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.params.subscribe((function(t){e.facilityManager.getFacilityById(t.facilityId).subscribe((function(t){e.facility=t;var i=e.sideMenuItemService.parseFacility(t);e.sideMenuService.setFacilityMenuItems([i]),e.editFacilityAuth=e.guiAuthResolver.isAuthorized("updateFacility_Facility_policy",[e.facility]),Object(u.b)("facilities",e.facility),e.loading=!1}),(function(){return e.loading=!1}))}))}},{key:"editFacility",value:function(){var e=this,t=Object(u.k)();t.width="450px",t.data={theme:"facility-theme",facility:this.facility,dialogType:b.f.FACILITY},this.dialog.open(b.e,t).afterClosed().subscribe((function(t){t&&e.facilityManager.getFacilityById(e.facility.id).subscribe((function(t){e.facility=t}))}))}}]),e}()).\u0275fac=function(e){return new(e||_)(h.Qb(d.b),h.Qb(o.g),h.Qb(s.a),h.Qb(r.a),h.Qb(l.a),h.Qb(f.g))},_.\u0275cmp=h.Kb({type:_,selectors:[["app-facility-detail-page"]],decls:5,vars:2,consts:[[1,"container-fluid","pl-xl-5","pr-xl-5","facility-theme"],["class","mr-auto ml-auto",4,"ngIf"],["class","d-flex page-title-headtitle",4,"ngIf"],[1,"mr-auto","ml-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-facility-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"facility-link",3,"routerLink"],[1,"text-muted"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"mt-1","entity-info"],["mat-icon-button","",3,"click"]],template:function(e,t){1&e&&(h.Wb(0,"div",0),h.Rb(1,"perun-web-apps-back-button"),h.Jc(2,C,1,0,"mat-spinner",1),h.Jc(3,k,14,18,"div",2),h.Rb(4,"app-animated-router-outlet"),h.Vb()),2&e&&(h.Cb(2),h.oc("ngIf",t.loading),h.Cb(1),h.oc("ngIf",!t.loading&&void 0!==t.facility))},directives:[p.a,a.t,g.a,y.c,m.a,I.a,a.w,s.i,v.b],pipes:[S.d],styles:[""],data:{animation:[c.a]}}),_),F=i("ZG5M");function R(e,t){1&e&&h.Rb(0,"mat-spinner",2)}function V(e,t){if(1&e&&(h.Wb(0,"div"),h.Rb(1,"perun-web-apps-menu-buttons-field",3),h.Vb()),2&e){var i=h.ic();h.Cb(1),h.oc("items",i.navItems)("size","small")}}var w,O,M=((w=function(){function e(t,i,a){_classCallCheck(this,e),this.facilityManager=t,this.route=i,this.authResolver=a,this.navItems=[],this.loading=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.params.subscribe((function(t){e.facilityManager.getFacilityById(t.facilityId).subscribe((function(t){e.facility=t,e.initItems(),e.loading=!1}),(function(){return e.loading=!1}))}))}},{key:"initItems",value:function(){this.navItems=[{cssIcon:"perun-attributes",url:"/facilities/".concat(this.facility.id,"/attributes"),label:"MENU_ITEMS.FACILITY.ATTRIBUTES",style:"facility-btn"}],this.authResolver.isAuthorized("getAssignedRichResources_Facility_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-manage-facility",url:"/facilities/".concat(this.facility.id,"/resources"),label:"MENU_ITEMS.FACILITY.RESOURCES",style:"facility-btn"}),this.authResolver.isAuthorized("getAssignedUsers_Facility_Service_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-user",url:"/facilities/".concat(this.facility.id,"/allowed-users"),label:"MENU_ITEMS.FACILITY.ALLOWED_USERS",style:"facility-btn"}),this.authResolver.isAuthorized("getAllowedGroups_Facility_Vo_Service_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-group",url:"/facilities/".concat(this.facility.id,"/allowed-groups"),label:"MENU_ITEMS.FACILITY.ALLOWED_GROUPS",style:"facility-btn"}),this.authResolver.isAuthorized("getFacilityServicesState_Facility_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-service-status",url:"/facilities/".concat(this.facility.id,"/services-status"),label:"MENU_ITEMS.FACILITY.SERVICES_STATUS",style:"facility-btn"}),this.authResolver.isAuthorized("getAssignedServices_Facility_policy",[this.facility])&&this.authResolver.isAuthorized("getAssignedResources_Facility_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-settings2",url:"/facilities/".concat(this.facility.id,"/service-config"),label:"MENU_ITEMS.FACILITY.SERVICE_CONFIG",style:"facility-btn"}),this.authResolver.isAuthorized("getAllRichDestinations_Facility_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-service_destination",url:"/facilities/".concat(this.facility.id,"/services-destinations"),label:"MENU_ITEMS.FACILITY.SERVICES_DESTINATIONS",style:"facility-btn"}),this.authResolver.isFacilityAdmin()&&this.navItems.push({cssIcon:"perun-hosts",url:"/facilities/".concat(this.facility.id,"/hosts"),label:"MENU_ITEMS.FACILITY.HOSTS",style:"facility-btn"}),this.authResolver.isAuthorized("getAssignedSecurityTeams_Facility_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-security-teams",url:"/facilities/".concat(this.facility.id,"/security-teams"),label:"MENU_ITEMS.FACILITY.SECURITY_TEAMS",style:"facility-btn"}),(this.authResolver.isAuthorized("getBansForFacility_int_policy",[this.facility])||this.authResolver.isAuthorized("getRichAdmins_Facility_List<String>_boolean_boolean_policy",[this.facility])||this.authResolver.isAuthorized("getOwners_Facility_policy",[this.facility]))&&this.navItems.push({cssIcon:"perun-settings2",url:"/facilities/".concat(this.facility.id,"/settings"),label:"MENU_ITEMS.FACILITY.SETTINGS",style:"facility-btn"})}}]),e}()).\u0275fac=function(e){return new(e||w)(h.Qb(o.g),h.Qb(s.a),h.Qb(f.g))},w.\u0275cmp=h.Kb({type:w,selectors:[["app-facility-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&h.Gb("router-component",!0)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(h.Jc(0,R,1,0,"mat-spinner",0),h.Jc(1,V,2,2,"div",1)),2&e&&(h.oc("ngIf",t.loading),h.Cb(1),h.oc("ngIf",!t.loading))},directives:[a.t,y.c,F.a],styles:[""]}),w),D=i("s8L6"),z=i("Wq+4"),W=i("nSPi"),N=i("y/MV"),B=((O=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||O)},O.\u0275cmp=h.Kb({type:O,selectors:[["app-facility-settings"]],hostVars:2,hostBindings:function(e,t){2&e&&h.Gb("router-component",!0)},decls:1,vars:0,template:function(e,t){1&e&&h.Rb(0,"app-animated-router-outlet")},directives:[g.a],styles:[""],data:{animation:[c.a]}}),O);function j(e,t){1&e&&h.Rb(0,"mat-spinner",2)}function Y(e,t){if(1&e&&(h.Wb(0,"div"),h.Rb(1,"perun-web-apps-menu-buttons-field",3),h.Vb()),2&e){var i=h.ic();h.Cb(1),h.oc("items",i.items)("size","small")}}var Q,U=((Q=function(){function e(t,i,a){_classCallCheck(this,e),this.route=t,this.facilityManager=i,this.authResolver=a,this.items=[],this.loading=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.parent.parent.params.subscribe((function(t){e.facilityManager.getFacilityById(t.facilityId).subscribe((function(t){e.facility=t,e.initItems(),e.loading=!1}),(function(){return e.loading=!1}))}))}},{key:"initItems",value:function(){this.items=[],this.authResolver.isAuthorized("getOwners_Facility_policy",[this.facility])&&this.items.push({cssIcon:"perun-user",url:"/facilities/".concat(this.facility.id,"/settings/owners"),label:"MENU_ITEMS.FACILITY.OWNERS",style:"facility-btn"}),this.authResolver.isAuthorized("getRichAdmins_Facility_List<String>_boolean_boolean_policy",[this.facility])&&this.items.push({cssIcon:"perun-manager",url:"/facilities/".concat(this.facility.id,"/settings/managers"),label:"MENU_ITEMS.FACILITY.MANAGERS",style:"facility-btn"}),this.authResolver.isAuthorized("getBansForFacility_int_policy",[this.facility])&&this.items.push({cssIcon:"perun-black-list",url:"/facilities/".concat(this.facility.id,"/settings/blacklist"),label:"MENU_ITEMS.FACILITY.BLACKLIST",style:"facility-btn"})}}]),e}()).\u0275fac=function(e){return new(e||Q)(h.Qb(s.a),h.Qb(o.g),h.Qb(f.g))},Q.\u0275cmp=h.Kb({type:Q,selectors:[["app-facility-settings-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&h.Gb("router-component",!0)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(h.Jc(0,j,1,0,"mat-spinner",0),h.Jc(1,Y,2,2,"div",1)),2&e&&(h.oc("ngIf",t.loading),h.Cb(1),h.oc("ngIf",!t.loading))},directives:[a.t,y.c,F.a],styles:[""]}),Q),P=i("HHEo"),G=i("cqs0"),J=i("mEf3"),H=i("iyZ4"),X=i("IDQ9"),x=i("0XDM"),K=i("A8Ay"),$=i("LKLE"),q=["list"];function Z(e,t){1&e&&h.Rb(0,"mat-spinner",8)}function ee(e,t){if(1&e){var i=h.Xb();h.Wb(0,"perun-web-apps-attributes-list",9,10),h.ec("page",(function(e){return h.Bc(i),h.ic().pageChanged(e)})),h.Vb()}if(2&e){var a=h.ic();h.oc("pageSize",a.pageSize)("filterValue",a.filterValue)("attributes",a.attributes)("selection",a.selection)}}var te,ie=((te=function(){function e(t,i,a,s,n,c){var r=this;_classCallCheck(this,e),this.attributesManager=t,this.route=i,this.dialog=a,this.notificator=s,this.tableConfigService=n,this.translate=c,this.attributes=[],this.selection=new G.c(!0,[]),this.filterValue="",this.tableId=H.n,this.translate.get("FACILITY_DETAIL.SETTINGS.ATTRIBUTES.SUCCESS_SAVE").subscribe((function(e){return r.saveSuccessMessage=e})),this.translate.get("FACILITY_DETAIL.SETTINGS.ATTRIBUTES.SUCCESS_DELETE").subscribe((function(e){return r.deleteSuccessMessage=e}))}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe((function(t){e.facilityId=t.facilityId,e.refreshTable()}))}},{key:"onDelete",value:function(){var e=this,t=Object(u.k)();t.width="450px",t.data={entityId:this.facilityId,entity:"facility",attributes:this.selection.selected,theme:"facility-theme"},this.dialog.open(J.a,t).afterClosed().subscribe((function(t){t&&e.refreshTable()}))}},{key:"onSave",value:function(){var e=this;this.list.updateMapAttributes();var t=Object(u.k)();t.width="450px",t.data={entityId:this.facilityId,entity:"facility",attributes:this.selection.selected},this.dialog.open(b.d,t).afterClosed().subscribe((function(t){t&&e.refreshTable()}))}},{key:"onCreate",value:function(){var e=this,t=Object(u.k)();t.width="1050px",t.data={entityId:this.facilityId,entity:"facility",notEmptyAttributes:this.attributes,style:"facility-theme"},this.dialog.open(X.a,t).afterClosed().subscribe((function(t){"saved"===t&&e.refreshTable()}))}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.attributesManager.getFacilityAttributes(this.facilityId).subscribe((function(t){e.attributes=t,e.selection.clear(),e.loading=!1}))}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}()).\u0275fac=function(e){return new(e||te)(h.Qb(o.c),h.Qb(s.a),h.Qb(d.b),h.Qb(f.k),h.Qb(H.lb),h.Qb(S.e))},te.\u0275cmp=h.Kb({type:te,selectors:[["app-facility-attributes"]],viewQuery:function(e,t){var i;1&e&&h.Tc(q,!0),2&e&&h.wc(i=h.fc())&&(t.list=i.first)},hostVars:2,hostBindings:function(e,t){2&e&&h.Gb("router-component",!0)},decls:18,vars:19,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent",1,"mr-2",3,"click"],["mat-flat-button","","color","accent",1,"mr-2",3,"disabled","click"],["mat-flat-button","","color","warn",3,"disabled","click"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","attributes","selection","page",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","attributes","selection","page"],["list",""]],template:function(e,t){1&e&&(h.Wb(0,"div"),h.Wb(1,"h1",0),h.Lc(2),h.jc(3,"translate"),h.Vb(),h.Wb(4,"perun-web-apps-refresh-button",1),h.ec("refresh",(function(){return t.refreshTable()})),h.Vb(),h.Wb(5,"button",2),h.ec("click",(function(){return t.onCreate()})),h.Lc(6),h.jc(7,"translate"),h.Vb(),h.Wb(8,"button",3),h.ec("click",(function(){return t.onSave()})),h.Lc(9),h.jc(10,"translate"),h.Vb(),h.Wb(11,"button",4),h.ec("click",(function(){return t.onDelete()})),h.Lc(12),h.jc(13,"translate"),h.Vb(),h.Wb(14,"perun-web-apps-immediate-filter",5),h.ec("filter",(function(e){return t.applyFilter(e)})),h.jc(15,"translate"),h.Vb(),h.Jc(16,Z,1,0,"mat-spinner",6),h.Jc(17,ee,2,4,"perun-web-apps-attributes-list",7),h.Vb()),2&e&&(h.Cb(2),h.Mc(h.kc(3,9,"FACILITY_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),h.Cb(4),h.Nc(" ",h.kc(7,11,"FACILITY_DETAIL.SETTINGS.ATTRIBUTES.CREATE")," "),h.Cb(2),h.oc("disabled",0===t.selection.selected.length),h.Cb(1),h.Nc(" ",h.kc(10,13,"FACILITY_DETAIL.SETTINGS.ATTRIBUTES.SAVE")," "),h.Cb(2),h.oc("disabled",0===t.selection.selected.length),h.Cb(1),h.Nc(" ",h.kc(13,15,"FACILITY_DETAIL.SETTINGS.ATTRIBUTES.DELETE")," "),h.Cb(2),h.oc("placeholder",h.kc(15,17,"SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.FILTER")),h.Cb(2),h.oc("ngIf",t.loading),h.Cb(1),h.oc("ngIf",!t.loading))},directives:[x.a,v.b,K.a,a.t,y.c,$.a],pipes:[S.d],styles:[""]}),te),ae=i("GyaY"),se=i("HUrR"),ne=i("gxIj"),ce=i("jblC"),re=i("nIj0"),le=i("jIqt"),oe=i("YtkY"),ue=i("t47Z"),fe=i("+Tre"),be=i("29Wa"),he=i("Cd2c"),de=i("ulve"),pe=i("mFH5"),ge=i("j+u3");function ye(e,t){if(1&e){var i=h.Xb();h.Wb(0,"mat-option",10),h.ec("onSelectionChange",(function(){h.Bc(i);var e=t.$implicit;return h.ic(3).onSelectedService(e)})),h.Lc(1),h.Vb()}if(2&e){var a=t.$implicit;h.oc("value",a),h.Cb(1),h.Nc(" ",a.name," ")}}function me(e,t){if(1&e){var i=h.Xb();h.Wb(0,"mat-form-field",6),h.Wb(1,"input",7),h.ec("keyup",(function(e){return h.Bc(i),h.ic(2).updatedSerVal(e)})),h.jc(2,"translate"),h.Vb(),h.Wb(3,"mat-autocomplete",8,9),h.Wb(5,"mat-option",10),h.ec("onSelectionChange",(function(){return h.Bc(i),h.ic(2).onSelectedService("NOT_SELECTED")})),h.Lc(6),h.jc(7,"translate"),h.Vb(),h.Wb(8,"mat-option",10),h.ec("onSelectionChange",(function(){return h.Bc(i),h.ic(2).onSelectedService("ALL")})),h.Lc(9),h.jc(10,"translate"),h.Vb(),h.Jc(11,ye,2,2,"mat-option",11),h.jc(12,"async"),h.Vb(),h.Vb()}if(2&e){var a=h.xc(4),s=h.ic(2);h.Cb(1),h.pc("placeholder",h.kc(2,9,"FACILITY_DETAIL.SERVICE_CONFIG.SERVICE_SELECT")),h.oc("formControl",s.serviceField)("matAutocomplete",a),h.Cb(2),h.oc("displayWith",s.serviceDisplayFn.bind(s)),h.Cb(2),h.oc("value","NOT_SELECTED"),h.Cb(1),h.Nc(" ",h.kc(7,11,"FACILITY_DETAIL.SERVICE_CONFIG.NOT_SELECTED")," "),h.Cb(2),h.oc("value","ALL"),h.Cb(1),h.Nc(" ",h.kc(10,13,"FACILITY_DETAIL.SERVICE_CONFIG.ALL")," "),h.Cb(2),h.oc("ngForOf",h.kc(12,15,s.filteredServices))}}function Ie(e,t){if(1&e){var i=h.Xb();h.Wb(0,"mat-option",10),h.ec("onSelectionChange",(function(){h.Bc(i);var e=t.$implicit;return h.ic(3).onSelectedResource(e)})),h.Lc(1),h.Vb()}if(2&e){var a=t.$implicit;h.oc("value",a),h.Cb(1),h.Nc(" ",a.name," ")}}function ve(e,t){if(1&e){var i=h.Xb();h.Wb(0,"mat-form-field",6),h.Wb(1,"input",12),h.ec("keyup",(function(e){return h.Bc(i),h.ic(2).updatedResVal(e)})),h.jc(2,"translate"),h.Vb(),h.Wb(3,"mat-autocomplete",8,9),h.Jc(5,Ie,2,2,"mat-option",11),h.jc(6,"async"),h.Vb(),h.Vb()}if(2&e){var a=h.xc(4),s=h.ic(2);h.Cb(1),h.pc("placeholder",h.kc(2,5,"FACILITY_DETAIL.SERVICE_CONFIG.RES_SELECT")),h.oc("matAutocomplete",a)("formControl",s.resourceField),h.Cb(2),h.oc("displayWith",s.resourceDisplayFn.bind(s)),h.Cb(2),h.oc("ngForOf",h.kc(6,7,s.filteredResources))}}function Se(e,t){if(1&e){var i=h.Xb();h.Wb(0,"mat-option",10),h.ec("onSelectionChange",(function(){h.Bc(i);var e=t.$implicit;return h.ic(3).onSelectedGroup(e)})),h.Lc(1),h.Vb()}if(2&e){var a=t.$implicit;h.oc("value",a),h.Cb(1),h.Nc(" ",a.name," ")}}function Ce(e,t){if(1&e){var i=h.Xb();h.Wb(0,"mat-form-field",6),h.Wb(1,"input",12),h.ec("keyup",(function(e){return h.Bc(i),h.ic(2).updatedGroupVal(e)})),h.jc(2,"translate"),h.Vb(),h.Wb(3,"mat-autocomplete",13,9),h.Jc(5,Se,2,2,"mat-option",11),h.jc(6,"async"),h.Vb(),h.Vb()}if(2&e){var a=h.xc(4),s=h.ic(2);h.Cb(1),h.pc("placeholder",h.kc(2,5,"FACILITY_DETAIL.SERVICE_CONFIG.GROUP_SELECT")),h.oc("matAutocomplete",a)("formControl",s.groupField),h.Cb(2),h.oc("displayWith",s.groupDisplayFn.bind(s)),h.Cb(2),h.oc("ngForOf",h.kc(6,7,s.filteredGroups))}}function Te(e,t){if(1&e){var i=h.Xb();h.Wb(0,"mat-option",10),h.ec("onSelectionChange",(function(){h.Bc(i);var e=t.$implicit;return h.ic(3).onSelectedMember(e)})),h.Lc(1),h.jc(2,"userFullName"),h.Vb()}if(2&e){var a=t.$implicit;h.oc("value",a),h.Cb(1),h.Nc(" ",h.kc(2,2,a.user)," ")}}function Ae(e,t){if(1&e&&(h.Wb(0,"mat-form-field",6),h.Rb(1,"input",14),h.jc(2,"translate"),h.Wb(3,"mat-autocomplete",8,9),h.Jc(5,Te,3,4,"mat-option",11),h.jc(6,"async"),h.Vb(),h.Vb()),2&e){var i=h.xc(4),a=h.ic(2);h.Cb(1),h.pc("placeholder",h.kc(2,5,"FACILITY_DETAIL.SERVICE_CONFIG.MEMBER_SELECT")),h.oc("formControl",a.memberField)("matAutocomplete",i),h.Cb(2),h.oc("displayWith",a.memberDisplayFn.bind(a)),h.Cb(2),h.oc("ngForOf",h.kc(6,7,a.filteredMembers))}}function Ee(e,t){if(1&e){var i=h.Xb();h.Wb(0,"div",3),h.Jc(1,me,13,17,"mat-form-field",4),h.Wb(2,"mat-checkbox",5),h.ec("change",(function(e){return h.Bc(i),h.ic().onOfferAllServices(e)})),h.Lc(3),h.jc(4,"translate"),h.Vb(),h.Jc(5,ve,7,9,"mat-form-field",4),h.Jc(6,Ce,7,9,"mat-form-field",4),h.Jc(7,Ae,7,9,"mat-form-field",4),h.Vb()}if(2&e){var a=h.ic();h.Cb(1),h.oc("ngIf",void 0!==a.services),h.Cb(2),h.Nc(" ",h.kc(4,5,"FACILITY_DETAIL.SERVICE_CONFIG.ALL_SERVICES")," "),h.Cb(2),h.oc("ngIf",void 0!==a.resources&&0!=a.resources.length),h.Cb(1),h.oc("ngIf",void 0!==a.selectedResource&&void 0!==a.groups&&0!=a.groups.length),h.Cb(1),h.oc("ngIf",void 0!==a.selectedGroup&&void 0!==a.members&&0!==a.members.length)}}function ke(e,t){if(1&e&&h.Rb(0,"perun-web-apps-service-configurator",15),2&e){var i=h.ic();h.oc("facility",i.facility)("resource",i.selectedResource)("group",i.selectedGroup)("service",i.selectedService)("member",i.selectedMember)}}var _e,Le=((_e=function(){function e(t,i,a,s,n,c,r){var l=this;_classCallCheck(this,e),this.route=t,this.facilityManager=i,this.resourceManager=a,this.serviceManager=s,this.membersManager=n,this.namePipe=c,this.translate=r,this.selectedService="NOT_SELECTED",this.attrNames=[],this.serviceField=new re.f,this.resourceField=new re.f,this.groupField=new re.f,this.memberField=new re.f,this.translate.get("FACILITY_DETAIL.SERVICE_CONFIG.ALL").subscribe((function(e){return l.serviceAllTranslation=e})),this.translate.get("FACILITY_DETAIL.SERVICE_CONFIG.NOT_SELECTED").subscribe((function(e){return l.serviceNotSelectedTranslation=e}))}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.route.parent.params.subscribe((function(t){e.facilityManager.getFacilityById(t.facilityId).subscribe((function(t){e.facility=t,e.facilityManager.getAssignedResourcesForFacility(t.id).subscribe((function(t){return e.resources=t})),e.serviceManager.getAssignedServices(t.id).subscribe((function(t){return e.services=t}))}))})),this.filteredServices=this.serviceField.valueChanges.pipe(Object(le.a)(""),Object(oe.a)((function(t){return e._filterServices(t)}))),this.filteredResources=this.resourceField.valueChanges.pipe(Object(le.a)(""),Object(oe.a)((function(t){return e._filterResources(t)}))),this.filteredGroups=this.groupField.valueChanges.pipe(Object(le.a)(""),Object(oe.a)((function(t){return e._filterGroups(t)}))),this.filteredMembers=this.memberField.valueChanges.pipe(Object(le.a)(""),Object(oe.a)((function(t){return e._filterMembers(t)})))}},{key:"onSelectedService",value:function(e){this.selectedService=e}},{key:"onSelectedResource",value:function(e){var t=this;this.selectedResource=e,void 0!==this.selectedResource?(this.resourceManager.getAssignedGroups(this.selectedResource.id).subscribe((function(e){return t.groups=e})),this.selectedGroup=void 0,this.selectedMember=void 0):this.groups=void 0}},{key:"onOfferAllServices",value:function(e){var t=this;e.checked||this.serviceManager.getAssignedServices(this.facility.id).subscribe((function(e){return t.services=e}))}},{key:"onSelectedGroup",value:function(e){var t=this;this.selectedGroup=e,void 0!==this.selectedGroup?(this.membersManager.getCompleteRichMembersForGroup(this.selectedGroup.id,this.attrNames).subscribe((function(e){return t.members=e})),this.selectedMember=void 0):this.members=void 0}},{key:"onSelectedMember",value:function(e){this.selectedMember=e}},{key:"_filterServices",value:function(e){var t=e.toString().toLowerCase();return this.services.filter((function(e){return e.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)}))}},{key:"_filterResources",value:function(e){var t=e.toString().toLowerCase();return this.resources.filter((function(e){return e.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)}))}},{key:"_filterGroups",value:function(e){var t=e.toString().toLowerCase();return this.groups.filter((function(e){return e.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)}))}},{key:"_filterMembers",value:function(e){var t=this,i=e.toString().toLowerCase();return this.members.filter((function(e){return t.namePipe.transform(e.user).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(i)}))}},{key:"serviceDisplayFn",value:function(e){if(null!==e)return"ALL"===e?this.serviceAllTranslation:"NOT_SELECTED"===e?this.serviceNotSelectedTranslation:e.name}},{key:"resourceDisplayFn",value:function(e){if(null!==e)return e.name}},{key:"groupDisplayFn",value:function(e){if(null!==e)return e.name}},{key:"memberDisplayFn",value:function(e){if(null!==e)return this.namePipe.transform(e.user)}},{key:"updatedSerVal",value:function(e){""===e.target.value&&(this.selectedService="NOT_SELECTED")}},{key:"updatedResVal",value:function(e){""===e.target.value&&(this.groups=void 0,this.members=void 0)}},{key:"updatedGroupVal",value:function(e){""===e.target.value&&(this.members=void 0)}},{key:"updatedMemVal",value:function(e){}}]),e}()).\u0275fac=function(e){return new(e||_e)(h.Qb(s.a),h.Qb(o.g),h.Qb(o.m),h.Qb(o.n),h.Qb(f.i),h.Qb(ue.c),h.Qb(S.e))},_e.\u0275cmp=h.Kb({type:_e,selectors:[["app-facility-service-config"]],decls:6,vars:5,consts:[[1,"page-subtitle"],["class","col-12 col-lg-6 mb-2",4,"ngIf"],[3,"facility","resource","group","service","member",4,"ngIf"],[1,"col-12","col-lg-6","mb-2"],["class","w-100",4,"ngIf"],[3,"change"],[1,"w-100"],["type","text","matInput","",3,"placeholder","formControl","matAutocomplete","keyup"],["autoActiveFirstOption","",3,"displayWith"],["auto","matAutocomplete"],[3,"value","onSelectionChange"],[3,"value","onSelectionChange",4,"ngFor","ngForOf"],["type","text","matInput","",3,"placeholder","matAutocomplete","formControl","keyup"],["autoActiveFirstOption","",3,"ngClass","displayWith"],["type","text","matInput","",3,"placeholder","formControl","matAutocomplete"],[3,"facility","resource","group","service","member"]],template:function(e,t){1&e&&(h.Wb(0,"div"),h.Wb(1,"h1",0),h.Lc(2),h.jc(3,"translate"),h.Vb(),h.Jc(4,Ee,8,7,"div",1),h.Jc(5,ke,1,5,"perun-web-apps-service-configurator",2),h.Vb()),2&e&&(h.Cb(2),h.Mc(h.kc(3,3,"FACILITY_DETAIL.SERVICE_CONFIG.TITLE")),h.Cb(2),h.oc("ngIf",!!t.facility),h.Cb(1),h.oc("ngIf",!!t.facility))},directives:[a.t,fe.a,be.c,he.b,re.c,de.d,re.q,re.g,de.a,pe.l,a.s,a.q],pipes:[S.d,a.b,ge.a],styles:[""]}),_e),Fe=i("Iydx"),Re=i("NU+N");function Ve(e,t){if(1&e&&h.Rb(0,"app-managers-page",1),2&e){var i=h.ic();h.oc("complementaryObject",i.facility)("complementaryObjectType",i.type)("theme",i.theme)("availableRoles",i.availableRoles)}}var we,Oe=((we=function(){function e(t,i){_classCallCheck(this,e),this.facilityService=t,this.route=i,this.availableRoles=[Fe.a.FACILITYADMIN],this.selected="user",this.type="Facility",this.theme="facility-theme"}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.route.parent.parent.params.subscribe((function(t){e.facilityService.getFacilityById(t.facilityId).subscribe((function(t){e.facility=t}))}))}}]),e}()).\u0275fac=function(e){return new(e||we)(h.Qb(o.g),h.Qb(s.a))},we.\u0275cmp=h.Kb({type:we,selectors:[["app-perun-web-apps-facility-settings-managers"]],hostVars:2,hostBindings:function(e,t){2&e&&h.Gb("router-component",!0)},decls:1,vars:1,consts:[[3,"complementaryObject","complementaryObjectType","theme","availableRoles",4,"ngIf"],[3,"complementaryObject","complementaryObjectType","theme","availableRoles"]],template:function(e,t){1&e&&h.Jc(0,Ve,1,4,"app-managers-page",0),2&e&&h.oc("ngIf",t.facility)},directives:[a.t,Re.a],styles:[""]}),we),Me=i("/nwi"),De=i("Dkjx"),ze=i("pgvo");function We(e,t){if(1&e){var i=h.Xb();h.Wb(0,"button",7),h.ec("click",(function(){return h.Bc(i),h.ic().addDestination()})),h.Lc(1),h.jc(2,"translate"),h.Vb()}2&e&&(h.Cb(1),h.Nc(" ",h.kc(2,1,"FACILITY_DETAIL.SERVICES_DESTINATIONS.ADD")," "))}function Ne(e,t){if(1&e){var i=h.Xb();h.Wb(0,"button",8),h.ec("click",(function(){return h.Bc(i),h.ic().removeDestination()})),h.Lc(1),h.jc(2,"translate"),h.Vb()}if(2&e){var a=h.ic();h.oc("disabled",0===a.selected.selected.length),h.Cb(1),h.Nc(" ",h.kc(2,2,"FACILITY_DETAIL.SERVICES_DESTINATIONS.REMOVE")," ")}}function Be(e,t){1&e&&h.Rb(0,"mat-spinner",9)}function je(e,t){if(1&e){var i=h.Xb();h.Wb(0,"app-perun-web-apps-destination-list",10),h.ec("page",(function(e){return h.Bc(i),h.ic().pageChanged(e)})),h.Vb()}if(2&e){var a=h.ic();h.oc("pageSize",a.pageSize)("filterValue",a.filterValue)("destinations",a.destinations)("selection",a.selected)("displayedColumns",a.displayedColumns)}}var Ye,Qe=((Ye=function(){function e(t,i,a,s,n,c,r,l){_classCallCheck(this,e),this.dialog=t,this.facilitiesManager=i,this.servicesManager=a,this.tableConfigService=s,this.translate=n,this.notificator=c,this.route=r,this.authResolver=l,this.selected=new G.c(!0,[]),this.displayedColumns=["select","destinationId","service","destination","type","propagationType"],this.filterValue="",this.tableId=H.x}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.loading=!0,this.route.parent.params.subscribe((function(t){e.facilitiesManager.getFacilityById(t.facilityId).subscribe((function(t){e.facility=t,e.refreshTable()}))}))}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.servicesManager.getAllRichDestinationsForFacility(this.facility.id).subscribe((function(t){e.destinations=t,e.selected.clear(),e.setAuthRights(),e.loading=!1}))}},{key:"setAuthRights",value:function(){this.addAuth=this.authResolver.isAuthorized("addDestination_Service_Facility_Destination_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeDestination_Service_Facility_Destination_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","destinationId","service","destination","type","propagationType"]:["destinationId","service","destination","type","propagationType"]}},{key:"addDestination",value:function(){var e=this,t=Object(u.k)();t.width="600px",t.data={facility:this.facility,theme:"facility-theme"},this.dialog.open(De.a,t).afterClosed().subscribe((function(t){t&&e.translate.get("FACILITY_DETAIL.SERVICES_DESTINATIONS.ADD_SUCCESS").subscribe((function(t){e.refreshTable(),e.notificator.showSuccess(t)}))}))}},{key:"removeDestination",value:function(){var e=this,t=Object(u.k)();t.width="600px",t.data={destinations:this.selected.selected,theme:"facility-theme"},this.dialog.open(Me.a,t).afterClosed().subscribe((function(t){t&&(e.loading=!0,e.deleteDestinations(e.selected.selected))}))}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){console.log(e.pageSize),this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}},{key:"deleteDestinations",value:function(e){var t=this;if(0===e.length)this.translate.get("FACILITY_DETAIL.SERVICES_DESTINATIONS.REMOVE_SUCCESS").subscribe((function(e){t.refreshTable(),t.notificator.showSuccess(e)}));else{var i=e[0];this.servicesManager.removeDestination(i.service.id,i.facility.id,i.destination,i.type).subscribe((function(){e.shift(),t.deleteDestinations(e)}))}}}]),e}()).id="FacilityServicesDestinationsComponent",Ye.\u0275fac=function(e){return new(e||Ye)(h.Qb(d.b),h.Qb(o.g),h.Qb(o.n),h.Qb(H.lb),h.Qb(S.e),h.Qb(f.k),h.Qb(s.a),h.Qb(f.g))},Ye.\u0275cmp=h.Kb({type:Ye,selectors:[["app-perun-web-apps-facility-services-destinations"]],hostVars:2,hostBindings:function(e,t){2&e&&h.Gb("router-component",!0)},decls:10,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent","class","mr-2",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","destinations","selection","displayedColumns","page",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2",3,"click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","destinations","selection","displayedColumns","page"]],template:function(e,t){1&e&&(h.Wb(0,"div"),h.Wb(1,"h1",0),h.Lc(2),h.jc(3,"translate"),h.Vb(),h.Wb(4,"perun-web-apps-refresh-button",1),h.ec("refresh",(function(){return t.refreshTable()})),h.Vb(),h.Jc(5,We,3,3,"button",2),h.Jc(6,Ne,3,4,"button",3),h.Wb(7,"perun-web-apps-immediate-filter",4),h.ec("filter",(function(e){return t.applyFilter(e)})),h.Vb(),h.Jc(8,Be,1,0,"mat-spinner",5),h.Jc(9,je,1,5,"app-perun-web-apps-destination-list",6),h.Vb()),2&e&&(h.Cb(2),h.Mc(h.kc(3,6,"FACILITY_DETAIL.SERVICES_DESTINATIONS.TITLE")),h.Cb(3),h.oc("ngIf",!t.loading&&t.addAuth),h.Cb(1),h.oc("ngIf",!t.loading&&t.removeAuth),h.Cb(1),h.oc("placeholder","FACILITY_DETAIL.SERVICES_DESTINATIONS.FILTER"),h.Cb(1),h.oc("ngIf",t.loading),h.Cb(1),h.oc("ngIf",!t.loading))},directives:[x.a,a.t,K.a,v.b,y.c,ze.a],pipes:[S.d],styles:[""]}),Ye),Ue=i("st5j"),Pe=i("noDS"),Ge=i("5kIe");function Je(e,t){if(1&e){var i=h.Xb();h.Wb(0,"perun-web-apps-refresh-button",7),h.ec("refresh",(function(){return h.Bc(i),h.ic().refreshTable()})),h.Vb()}}function He(e,t){if(1&e){var i=h.Xb();h.Wb(0,"button",8),h.ec("click",(function(){return h.Bc(i),h.ic().onCreate()})),h.Lc(1),h.jc(2,"translate"),h.Vb()}2&e&&(h.Cb(1),h.Nc(" ",h.kc(2,1,"FACILITY_DETAIL.SETTINGS.OWNERS.ADD"),"\n"))}function Xe(e,t){if(1&e){var i=h.Xb();h.Wb(0,"button",9),h.ec("click",(function(){return h.Bc(i),h.ic().onRemove()})),h.Lc(1),h.jc(2,"translate"),h.Vb()}if(2&e){var a=h.ic();h.oc("disabled",0===a.selection.selected.length),h.Cb(1),h.Nc(" ",h.kc(2,2,"FACILITY_DETAIL.SETTINGS.OWNERS.DELETE"),"\n")}}function xe(e,t){if(1&e){var i=h.Xb();h.Wb(0,"perun-web-apps-immediate-filter",10),h.ec("filter",(function(e){return h.Bc(i),h.ic().applyFilter(e)})),h.Vb()}2&e&&h.oc("placeholder","VO_MANAGEMENT.FILTER_PLACEHOLDER")}function Ke(e,t){1&e&&h.Rb(0,"mat-spinner",11)}function $e(e,t){if(1&e&&h.Rb(0,"app-owners-list",12),2&e){var i=h.ic();h.oc("filterValue",i.filterValue)("owners",i.owners)("displayedColumns",i.displayedColumns)("selection",i.selection)}}var qe,Ze=((qe=function(){function e(t,i,a,s){_classCallCheck(this,e),this.facilitiesManagerService=t,this.route=i,this.dialog=a,this.authResolver=s,this.owners=[],this.selection=new G.c(!0,[]),this.displayedColumns=["id","name","contact","type"]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.route.parent.parent.params.subscribe((function(t){e.facilityId=parseInt(t.facilityId,10),e.facility={id:e.facilityId,beanName:"Facility"},e.refreshTable()}))}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.selection.clear(),this.facilitiesManagerService.getFacilityOwners(this.facilityId).subscribe((function(t){e.owners=t,e.setAuthRights(),e.loading=!1}))}},{key:"setAuthRights",value:function(){this.addAuth=this.authResolver.isAuthorized("addOwner_Facility_Owner_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeOwner_Facility_Owner_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","id","name","contact","type"]:["id","name","contact","type"]}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"onCreate",value:function(){var e=this,t=Object(u.k)();t.width="800px",t.data={theme:"facility-theme",facilityId:this.facilityId,forbiddenOwners:this.owners.map((function(e){return e.id}))},this.dialog.open(Ue.a,t).afterClosed().subscribe((function(t){t&&e.refreshTable()}))}},{key:"onRemove",value:function(){var e=this,t=Object(u.k)();t.width="600px",t.data={theme:"facility-theme",owners:this.selection.selected,facilityId:this.facilityId},this.dialog.open(Pe.a,t).afterClosed().subscribe((function(t){t&&e.refreshTable()}))}}]),e}()).\u0275fac=function(e){return new(e||qe)(h.Qb(o.g),h.Qb(s.a),h.Qb(d.b),h.Qb(f.g))},qe.\u0275cmp=h.Kb({type:qe,selectors:[["app-facility-settings-owners"]],decls:9,vars:9,consts:[[1,"page-subtitle"],[3,"refresh",4,"ngIf"],["class","mr-2","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],[3,"filterValue","owners","displayedColumns","selection",4,"ngIf"],[3,"refresh"],["color","accent","mat-flat-button","",1,"mr-2",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[3,"placeholder","filter"],[1,"ml-auto","mr-auto"],[3,"filterValue","owners","displayedColumns","selection"]],template:function(e,t){1&e&&(h.Wb(0,"h1",0),h.Lc(1),h.jc(2,"translate"),h.Vb(),h.Jc(3,Je,1,0,"perun-web-apps-refresh-button",1),h.Jc(4,He,3,3,"button",2),h.Jc(5,Xe,3,4,"button",3),h.Jc(6,xe,1,1,"perun-web-apps-immediate-filter",4),h.Jc(7,Ke,1,0,"mat-spinner",5),h.Jc(8,$e,1,4,"app-owners-list",6)),2&e&&(h.Cb(1),h.Mc(h.kc(2,7,"FACILITY_DETAIL.SETTINGS.OWNERS.TITLE")),h.Cb(2),h.oc("ngIf",!t.loading),h.Cb(1),h.oc("ngIf",!t.loading&&t.addAuth),h.Cb(1),h.oc("ngIf",!t.loading&&t.removeAuth),h.Cb(1),h.oc("ngIf",!t.loading),h.Cb(1),h.oc("ngIf",t.loading),h.Cb(1),h.oc("ngIf",!t.loading))},directives:[a.t,x.a,v.b,K.a,y.c,Ge.a],pipes:[S.d],styles:[""]}),qe),et=i("dnAU"),tt=i("vUrr"),it=i("gdiH");function at(e,t){if(1&e){var i=h.Xb();h.Wb(0,"button",7),h.ec("click",(function(){return h.Bc(i),h.ic().addHost()})),h.Lc(1),h.jc(2,"translate"),h.Vb()}2&e&&(h.Cb(1),h.Nc(" ",h.kc(2,1,"FACILITY_DETAIL.HOSTS.ADD")," "))}function st(e,t){if(1&e){var i=h.Xb();h.Wb(0,"button",8),h.ec("click",(function(){return h.Bc(i),h.ic().removeHost()})),h.Lc(1),h.jc(2,"translate"),h.Vb()}if(2&e){var a=h.ic();h.oc("disabled",0===a.selected.selected.length),h.Cb(1),h.Nc(" ",h.kc(2,2,"FACILITY_DETAIL.HOSTS.REMOVE")," ")}}function nt(e,t){1&e&&h.Rb(0,"mat-spinner",9)}function ct(e,t){if(1&e){var i=h.Xb();h.Wb(0,"app-hosts-list",10),h.ec("page",(function(e){return h.Bc(i),h.ic().pageChanged(e)})),h.Vb()}if(2&e){var a=h.ic();h.oc("pageSize",a.pageSize)("filterValue",a.filterValue)("hosts",a.hosts)("selection",a.selected)("displayedColumns",a.displayedColumns)("disableRouting",!a.routeAuth)("facilityId",a.facilityId)}}var rt,lt=((rt=function(){function e(t,i,a,s,n){_classCallCheck(this,e),this.dialog=t,this.facilitiesManager=i,this.tableConfigService=a,this.route=s,this.authResolver=n,this.hosts=[],this.selected=new G.c(!0,[]),this.filterValue="",this.tableId=H.t,this.displayedColumns=["id","name"]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe((function(t){e.facilityId=t.facilityId,e.facilitiesManager.getFacilityById(e.facilityId).subscribe((function(t){e.facility=t,e.refreshTable()}))}))}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.facilitiesManager.getHosts(this.facilityId).subscribe((function(t){e.hosts=t,e.selected.clear(),e.setAuthRights(),e.loading=!1}))}},{key:"setAuthRights",value:function(){this.addAuth=this.authResolver.isAuthorized("addHosts_Facility_List<String>_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeHosts_List<Host>_Facility_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","id","name"]:["id","name"],0!==this.hosts.length&&(this.routeAuth=this.authResolver.isAuthorized("getHostById_int_policy",[this.facility,this.hosts[0]]))}},{key:"addHost",value:function(){var e=this,t=Object(u.k)();t.width="600px",t.data={facilityId:this.facility.id,facilityName:this.facility.name,theme:"facility-theme"},this.dialog.open(et.a,t).afterClosed().subscribe((function(t){t&&e.refreshTable()}))}},{key:"removeHost",value:function(){var e=this,t=Object(u.k)();t.width="600px",t.data={facilityId:this.facility.id,theme:"facility-theme",hosts:this.selected.selected},this.dialog.open(tt.a,t).afterClosed().subscribe((function(t){t&&e.refreshTable()}))}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}()).\u0275fac=function(e){return new(e||rt)(h.Qb(d.b),h.Qb(o.g),h.Qb(H.lb),h.Qb(s.a),h.Qb(f.g))},rt.\u0275cmp=h.Kb({type:rt,selectors:[["app-facility-hosts"]],decls:10,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent","class","mr-2",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","hosts","selection","displayedColumns","disableRouting","facilityId","page",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2",3,"click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","hosts","selection","displayedColumns","disableRouting","facilityId","page"]],template:function(e,t){1&e&&(h.Wb(0,"div"),h.Wb(1,"h1",0),h.Lc(2),h.jc(3,"translate"),h.Vb(),h.Wb(4,"perun-web-apps-refresh-button",1),h.ec("refresh",(function(){return t.refreshTable()})),h.Vb(),h.Jc(5,at,3,3,"button",2),h.Jc(6,st,3,4,"button",3),h.Wb(7,"perun-web-apps-immediate-filter",4),h.ec("filter",(function(e){return t.applyFilter(e)})),h.Vb(),h.Jc(8,nt,1,0,"mat-spinner",5),h.Jc(9,ct,1,7,"app-hosts-list",6),h.Vb()),2&e&&(h.Cb(2),h.Mc(h.kc(3,6,"FACILITY_DETAIL.HOSTS.TITLE")),h.Cb(3),h.oc("ngIf",!t.loading&&t.addAuth),h.Cb(1),h.oc("ngIf",!t.loading&&t.removeAuth),h.Cb(1),h.oc("placeholder","FACILITY_DETAIL.HOSTS.FILTER"),h.Cb(1),h.oc("ngIf",t.loading),h.Cb(1),h.oc("ngIf",!t.loading))},directives:[x.a,a.t,K.a,v.b,y.c,it.a],pipes:[S.d],styles:[""]}),rt),ot=i("77So");function ut(e,t){1&e&&h.Rb(0,"mat-spinner",5)}function ft(e,t){if(1&e){var i=h.Xb();h.Wb(0,"app-perun-web-apps-blacklist-list",6),h.ec("page",(function(e){return h.Bc(i),h.ic().pageChanged(e)})),h.Vb()}if(2&e){var a=h.ic();h.oc("pageSize",a.pageSize)("filterValue",a.filterValue)("bansOnFacilitiesWithUsers",a.bansOnFacilitiesWithUsers)("selection",a.selected)}}var bt,ht=((bt=function(){function e(t,i,a,s){_classCallCheck(this,e),this.facilitiesManager=t,this.usersManager=i,this.tableConfigService=a,this.route=s,this.bansOnFacilitiesWithUsers=[],this.selected=new G.c(!0,[]),this.filterValue="",this.tableId=H.s}return _createClass(e,[{key:"ngOnInit",value:function(){this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.refreshTable()}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.route.parent.parent.params.subscribe((function(t){e.facilitiesManager.getBansForFacility(t.facilityId).subscribe((function(t){var i,a=_createForOfIteratorHelper(t);try{for(a.s();!(i=a.n()).done;){var s=i.value,n=void 0;e.usersManager.getUserById(s.userId).subscribe((function(e){n=e})),e.bansOnFacilitiesWithUsers.push([s,n])}}catch(c){a.e(c)}finally{a.f()}e.selected.clear(),e.loading=!1}))}))}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}()).\u0275fac=function(e){return new(e||bt)(h.Qb(o.g),h.Qb(o.p),h.Qb(H.lb),h.Qb(s.a))},bt.\u0275cmp=h.Kb({type:bt,selectors:[["app-perun-web-apps-facility-settings-blacklist"]],decls:9,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","bansOnFacilitiesWithUsers","selection","page",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","bansOnFacilitiesWithUsers","selection","page"]],template:function(e,t){1&e&&(h.Wb(0,"div"),h.Wb(1,"h1",0),h.Lc(2),h.jc(3,"translate"),h.Vb(),h.Wb(4,"perun-web-apps-refresh-button",1),h.ec("refresh",(function(){return t.refreshTable()})),h.Vb(),h.Wb(5,"perun-web-apps-immediate-filter",2),h.ec("filter",(function(e){return t.applyFilter(e)})),h.jc(6,"translate"),h.Vb(),h.Jc(7,ut,1,0,"mat-spinner",3),h.Jc(8,ft,1,4,"app-perun-web-apps-blacklist-list",4),h.Vb()),2&e&&(h.Cb(2),h.Mc(h.kc(3,4,"FACILITY_DETAIL.SETTINGS.BLACKLIST.TITLE")),h.Cb(3),h.oc("placeholder",h.kc(6,6,"FACILITY_DETAIL.SETTINGS.BLACKLIST.FILTER")),h.Cb(2),h.oc("ngIf",t.loading),h.Cb(1),h.oc("ngIf",!t.loading))},directives:[x.a,K.a,a.t,y.c,ot.a],pipes:[S.d],styles:[""]}),bt),dt=["list"];function pt(e,t){if(1&e){var i=h.Xb();h.Wb(0,"perun-web-apps-attributes-list",6,7),h.ec("page",(function(e){return h.Bc(i),h.ic().pageChanged(e)})),h.Vb()}if(2&e){var a=h.ic();h.oc("pageSize",a.pageSize)("attributes",a.attributes)("selection",a.selected)}}var gt,yt=((gt=function(){function e(t,i,a,s,n){_classCallCheck(this,e),this.dialog=t,this.attributesManager=i,this.facilityManager=a,this.tableConfigService=s,this.route=n,this.attributes=[],this.selected=new G.c(!0,[]),this.host={beanName:"",id:0},this.tableId=H.n}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.params.subscribe((function(t){e.hostId=t.hostId,e.facilityManager.getHostById(e.hostId).subscribe((function(t){e.host=t})),e.refreshTable()}))}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.attributesManager.getHostAttributes(this.hostId).subscribe((function(t){e.attributes=Object(u.f)(t),e.selected.clear(),e.loading=!1}))}},{key:"onSave",value:function(){var e=this;this.list.updateMapAttributes();var t=Object(u.k)();t.width="450px",t.data={entityId:this.hostId,entity:"host",attributes:this.selected.selected},this.dialog.open(b.d,t).afterClosed().subscribe((function(t){t&&e.refreshTable()}))}},{key:"addAttribute",value:function(){var e=this,t=Object(u.k)();t.width="1050px",t.data={entityId:this.hostId,entity:"host",notEmptyAttributes:this.attributes,style:"facility-theme"},this.dialog.open(X.a,t).afterClosed().subscribe((function(t){"saved"===t&&e.refreshTable()}))}},{key:"removeAttribute",value:function(){var e=this,t=Object(u.k)();t.width="450px",t.data={entityId:this.hostId,entity:"host",attributes:this.selected.selected,theme:"facility-theme"},this.dialog.open(J.a,t).afterClosed().subscribe((function(t){t&&e.refreshTable()}))}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}()).\u0275fac=function(e){return new(e||gt)(h.Qb(d.b),h.Qb(o.c),h.Qb(o.g),h.Qb(H.lb),h.Qb(s.a))},gt.\u0275cmp=h.Kb({type:gt,selectors:[["app-facility-hosts-detail"]],viewQuery:function(e,t){var i;1&e&&h.Tc(dt,!0),2&e&&h.wc(i=h.fc())&&(t.list=i.first)},decls:15,vars:16,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent",1,"mr-2",3,"click"],["mat-flat-button","","color","accent",1,"mr-2",3,"disabled","click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[3,"pageSize","attributes","selection","page",4,"ngIf"],[3,"pageSize","attributes","selection","page"],["list",""]],template:function(e,t){1&e&&(h.Wb(0,"div"),h.Wb(1,"h1",0),h.Lc(2),h.jc(3,"translate"),h.Vb(),h.Wb(4,"perun-web-apps-refresh-button",1),h.ec("refresh",(function(){return t.refreshTable()})),h.Vb(),h.Wb(5,"button",2),h.ec("click",(function(){return t.addAttribute()})),h.Lc(6),h.jc(7,"translate"),h.Vb(),h.Wb(8,"button",3),h.ec("click",(function(){return t.onSave()})),h.Lc(9),h.jc(10,"translate"),h.Vb(),h.Wb(11,"button",4),h.ec("click",(function(){return t.removeAttribute()})),h.Lc(12),h.jc(13,"translate"),h.Vb(),h.Jc(14,pt,2,3,"perun-web-apps-attributes-list",5),h.Vb()),2&e&&(h.Cb(2),h.Oc(" ",h.kc(3,8,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.TITLE")," ",t.host.hostname,""),h.Cb(4),h.Nc(" ",h.kc(7,10,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.ADD")," "),h.Cb(2),h.oc("disabled",0===t.selected.selected.length),h.Cb(1),h.Nc(" ",h.kc(10,12,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.SAVE")," "),h.Cb(2),h.oc("disabled",0===t.selected.selected.length),h.Cb(1),h.Nc(" ",h.kc(13,14,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.REMOVE")," "),h.Cb(2),h.oc("ngIf",!t.loading))},directives:[x.a,v.b,a.t,$.a],pipes:[S.d],styles:[""]}),gt),mt=i("iT3j");function It(e,t){1&e&&h.Rb(0,"mat-spinner",5)}function vt(e,t){if(1&e){var i=h.Xb();h.Wb(0,"app-security-teams-list",6),h.ec("page",(function(e){return h.Bc(i),h.ic().pageChanged(e)})),h.Vb()}if(2&e){var a=h.ic();h.oc("pageSize",a.pageSize)("filterValue",a.filterValue)("securityTeams",a.securityTeams)("displayedColumns",a.displayedColumns)("selection",a.selected)}}var St,Ct=((St=function(){function e(t,i,a,s,n){_classCallCheck(this,e),this.dialog=t,this.facilitiesManager=i,this.tableConfigService=a,this.route=s,this.authResolver=n,this.securityTeams=[],this.selected=new G.c(!0,[]),this.filterValue="",this.tableId=H.v,this.displayedColumns=[]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe((function(t){e.facilitiesManager.getFacilityById(t.facilityId).subscribe((function(t){e.facility=t,e.refreshTable()}))}))}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.facilitiesManager.getAssignedSecurityTeams(this.facility.id).subscribe((function(t){e.securityTeams=t,e.selected.clear(),e.setAuthRights(),e.loading=!1}))}},{key:"setAuthRights",value:function(){this.addAuth=this.authResolver.isAuthorized("assignSecurityTeam_Facility_SecurityTeam_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeSecurityTeam_Facility_SecurityTeam_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","id","name","description"]:["id","name","description"]}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"addSecurityTeam",value:function(){}},{key:"removeSecurityTeam",value:function(){}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}()).\u0275fac=function(e){return new(e||St)(h.Qb(d.b),h.Qb(o.g),h.Qb(H.lb),h.Qb(s.a),h.Qb(f.g))},St.\u0275cmp=h.Kb({type:St,selectors:[["app-facility-security-teams"]],decls:8,vars:6,consts:[[1,"page-subtitle"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","securityTeams","displayedColumns","selection","page",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","securityTeams","displayedColumns","selection","page"]],template:function(e,t){1&e&&(h.Wb(0,"div"),h.Wb(1,"h1",0),h.Lc(2),h.jc(3,"translate"),h.Vb(),h.Wb(4,"perun-web-apps-refresh-button",1),h.ec("refresh",(function(){return t.refreshTable()})),h.Vb(),h.Wb(5,"perun-web-apps-immediate-filter",2),h.ec("filter",(function(e){return t.applyFilter(e)})),h.Vb(),h.Jc(6,It,1,0,"mat-spinner",3),h.Jc(7,vt,1,5,"app-security-teams-list",4),h.Vb()),2&e&&(h.Cb(2),h.Mc(h.kc(3,4,"FACILITY_DETAIL.SECURITY_TEAMS.TITLE")),h.Cb(3),h.oc("placeholder","FACILITY_DETAIL.SECURITY_TEAMS.FILTER"),h.Cb(1),h.oc("ngIf",t.loading),h.Cb(1),h.oc("ngIf",!t.loading))},directives:[x.a,K.a,a.t,y.c,mt.a],pipes:[S.d],styles:[""]}),St),Tt=i("Fm3m"),At=i("TNye"),Et=i("WLDY");function kt(e,t){if(1&e){var i=h.Xb();h.Wb(0,"button",7),h.ec("click",(function(){return h.Bc(i),h.ic().forcePropagation()})),h.Lc(1),h.jc(2,"translate"),h.Vb()}if(2&e){var a=h.ic();h.oc("disabled",0===a.selected.selected.length),h.Cb(1),h.Nc(" ",h.kc(2,2,"FACILITY_DETAIL.SERVICES_STATUS.FORCE_PROPAGATION")," ")}}function _t(e,t){if(1&e){var i=h.Xb();h.Wb(0,"button",7),h.ec("click",(function(){return h.Bc(i),h.ic().allow()})),h.Lc(1),h.jc(2,"translate"),h.Vb()}if(2&e){var a=h.ic();h.oc("disabled",0===a.selected.selected.length||a.disableAllowButton),h.Cb(1),h.Nc(" ",h.kc(2,2,"FACILITY_DETAIL.SERVICES_STATUS.ALLOW")," ")}}function Lt(e,t){if(1&e){var i=h.Xb();h.Wb(0,"button",8),h.ec("click",(function(){return h.Bc(i),h.ic().block()})),h.Lc(1),h.jc(2,"translate"),h.Vb()}if(2&e){var a=h.ic();h.oc("disabled",0===a.selected.selected.length||a.disableBlockButton),h.Cb(1),h.Nc(" ",h.kc(2,2,"FACILITY_DETAIL.SERVICES_STATUS.BLOCK")," ")}}function Ft(e,t){if(1&e){var i=h.Xb();h.Wb(0,"button",8),h.ec("click",(function(){return h.Bc(i),h.ic().delete()})),h.Lc(1),h.jc(2,"translate"),h.Vb()}if(2&e){var a=h.ic();h.oc("disabled",0===a.selected.selected.length||a.disableDeleteTaskButton),h.Cb(1),h.Nc(" ",h.kc(2,2,"FACILITY_DETAIL.SERVICES_STATUS.DELETE")," ")}}function Rt(e,t){1&e&&h.Rb(0,"mat-spinner",9)}function Vt(e,t){if(1&e){var i=h.Xb();h.Wb(0,"perun-web-apps-services-status-list",10),h.ec("page",(function(e){return h.Bc(i),h.ic().pageChanged(e)}))("selectionChange",(function(){return h.Bc(i),h.ic().selectionChanged()})),h.Vb()}if(2&e){var a=h.ic();h.oc("pageSize",a.pageSize)("filterValue",a.filterValue)("servicesStatus",a.servicesStates)("selection",a.selected)("disableRouting",!a.routeAuth)}}var wt,Ot=((wt=function(){function e(t,i,a,s,n,c,r){var l=this;_classCallCheck(this,e),this.route=t,this.tasksManager=i,this.tableConfigService=a,this.servicesManager=s,this.notificator=n,this.translate=c,this.authResolver=r,this.servicesStates=[],this.selected=new G.c(!0,[]),this.filterValue="",this.tableId=H.y,this.disableAllowButton=!0,this.disableBlockButton=!0,this.disableDeleteTaskButton=!0,c.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_FORCE_PROPAGATION").subscribe((function(e){return l.successFPMessage=e})),c.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_ALLOW").subscribe((function(e){return l.successAllowMessage=e})),c.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_BLOCK").subscribe((function(e){return l.successBlockMessage=e})),c.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_DELETE").subscribe((function(e){return l.successDeleteMessage=e})),c.get("FACILITY_DETAIL.SERVICES_STATUS.ALREADY_DELETED").subscribe((function(e){return l.allreadyDeletedMessage=e}))}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe((function(t){e.facilityId=parseInt(t.facilityId,10),e.facility={id:e.facilityId,beanName:"Facility"},e.refreshTable()}))}},{key:"forcePropagation",value:function(){var e,t=this,i=_createForOfIteratorHelper(this.selected.selected);try{for(i.s();!(e=i.n()).done;){var a=e.value;this.servicesManager.forceServicePropagation(a.service.id,a.facility.id).subscribe((function(){t.refreshTable(),t.notificator.showSuccess(t.successFPMessage)}))}}catch(s){i.e(s)}finally{i.f()}}},{key:"allow",value:function(){var e,t=this,i=_createForOfIteratorHelper(this.selected.selected);try{for(i.s();!(e=i.n()).done;){var a=e.value;this.servicesManager.unblockServiceOnFacility(a.service.id,a.facility.id).subscribe((function(){t.refreshTable(),t.notificator.showSuccess(t.successAllowMessage)}))}}catch(s){i.e(s)}finally{i.f()}}},{key:"block",value:function(){var e,t=this,i=_createForOfIteratorHelper(this.selected.selected);try{for(i.s();!(e=i.n()).done;){var a=e.value;this.servicesManager.blockServiceOnFacility(a.service.id,a.facility.id).subscribe((function(){t.refreshTable(),t.notificator.showSuccess(t.successBlockMessage)}))}}catch(s){i.e(s)}finally{i.f()}}},{key:"delete",value:function(){var e,t=this,i=_createForOfIteratorHelper(this.selected.selected);try{for(i.s();!(e=i.n()).done;){var a=e.value;null!==a.task?this.tasksManager.deleteTask({task:a.task.id}).subscribe((function(){t.refreshTable(),t.notificator.showSuccess(t.successDeleteMessage)})):this.notificator.showSuccess(this.allreadyDeletedMessage)}}catch(s){i.e(s)}finally{i.f()}}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.tasksManager.getFacilityServicesState(this.facilityId).subscribe((function(t){e.servicesStates=t,e.selected.clear(),e.setAuthRights(),e.loading=!1}))}},{key:"setAuthRights",value:function(){this.propagationAuth=this.authResolver.isAuthorized("forceServicePropagation_Facility_Service_policy",[this.facility]),this.blockAuth=this.authResolver.isAuthorized("blockServiceOnFacility_Service_Facility_policy",[this.facility]),this.allowAuth=this.authResolver.isAuthorized("unblockServiceOnFacility_Service_Facility_policy",[this.facility]),this.deleteAuth=this.authResolver.isAuthorized("deleteTask_Task_policy",[this.facility]),this.routeAuth=this.authResolver.isAuthorized("getTaskResultsForGUIByTask_int_policy",[this.facility])}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}},{key:"selectionChanged",value:function(){this.disableBlockButton=!0,this.disableAllowButton=!0,this.disableDeleteTaskButton=!0;var e,t=_createForOfIteratorHelper(this.selected.selected);try{for(t.s();!(e=t.n()).done;){var i=e.value;i.blockedOnFacility?this.disableAllowButton=!1:this.disableBlockButton=!1,i.task&&(this.disableDeleteTaskButton=!1)}}catch(a){t.e(a)}finally{t.f()}}}]),e}()).\u0275fac=function(e){return new(e||wt)(h.Qb(s.a),h.Qb(o.o),h.Qb(H.lb),h.Qb(o.n),h.Qb(f.k),h.Qb(S.e),h.Qb(f.g))},wt.\u0275cmp=h.Kb({type:wt,selectors:[["app-facility-service-status"]],decls:12,vars:10,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent","class","mr-2",3,"disabled","click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","servicesStatus","selection","disableRouting","page","selectionChange",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2",3,"disabled","click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","servicesStatus","selection","disableRouting","page","selectionChange"]],template:function(e,t){1&e&&(h.Wb(0,"div"),h.Wb(1,"h1",0),h.Lc(2),h.jc(3,"translate"),h.Vb(),h.Wb(4,"perun-web-apps-refresh-button",1),h.ec("refresh",(function(){return t.refreshTable()})),h.Vb(),h.Jc(5,kt,3,4,"button",2),h.Jc(6,_t,3,4,"button",2),h.Jc(7,Lt,3,4,"button",3),h.Jc(8,Ft,3,4,"button",3),h.Wb(9,"perun-web-apps-immediate-filter",4),h.ec("filter",(function(e){return t.applyFilter(e)})),h.Vb(),h.Jc(10,Rt,1,0,"mat-spinner",5),h.Jc(11,Vt,1,5,"perun-web-apps-services-status-list",6),h.Vb()),2&e&&(h.Cb(2),h.Mc(h.kc(3,8,"FACILITY_DETAIL.SERVICES_STATUS.TITLE")),h.Cb(3),h.oc("ngIf",!t.loading&&t.propagationAuth),h.Cb(1),h.oc("ngIf",!t.loading&&t.allowAuth),h.Cb(1),h.oc("ngIf",!t.loading&&t.blockAuth),h.Cb(1),h.oc("ngIf",!t.loading&&t.deleteAuth),h.Cb(1),h.oc("placeholder","SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.TABLE_SEARCH"),h.Cb(1),h.oc("ngIf",t.loading),h.Cb(1),h.oc("ngIf",!t.loading))},directives:[x.a,a.t,K.a,v.b,y.c,Et.a],pipes:[S.d],styles:[""]}),wt),Mt=i("FcRk"),Dt=i("NC8S");function zt(e,t){if(1&e){var i=h.Xb();h.Wb(0,"perun-web-apps-refresh-button",6),h.ec("refresh",(function(){return h.Bc(i),h.ic().refreshTable()})),h.Vb()}}function Wt(e,t){if(1&e){var i=h.Xb();h.Wb(0,"perun-web-apps-immediate-filter",7),h.ec("filter",(function(e){return h.Bc(i),h.ic().applyFilter(e)})),h.Vb()}2&e&&h.oc("placeholder","FACILITY_DETAIL.ALLOWED_USERS.FILTER")}function Nt(e,t){1&e&&h.Rb(0,"mat-spinner",8)}function Bt(e,t){1&e&&(h.Wb(0,"app-alert",9),h.Lc(1),h.jc(2,"translate"),h.Vb()),2&e&&(h.Cb(1),h.Nc(" ",h.kc(2,1,"FACILITY_DETAIL.ALLOWED_USERS.NO_USERS")," "))}var jt=function(){return["id","name"]};function Yt(e,t){if(1&e){var i=h.Xb();h.Wb(0,"app-users-list",10),h.ec("page",(function(e){return h.Bc(i),h.ic().pageChanged(e)})),h.Vb()}if(2&e){var a=h.ic();h.oc("pageSize",a.pageSize)("users",a.users)("displayedColumns",h.sc(5,jt))("disableRouting",!a.routeAuth)("filter",a.filterValue)}}var Qt,Ut=((Qt=function(){function e(t,i,a,s){_classCallCheck(this,e),this.route=t,this.facilityService=i,this.tableConfigService=a,this.authResolver=s,this.loading=!1,this.filterValue="",this.tableId=H.r}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe((function(t){e.facilityId=t.facilityId,e.routeAuth=e.authResolver.isPerunAdmin(),e.refreshTable()}))}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.facilityService.getAssignedUsers(this.facilityId).subscribe((function(t){e.users=t,e.loading=!1}))}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}()).\u0275fac=function(e){return new(e||Qt)(h.Qb(s.a),h.Qb(o.g),h.Qb(H.lb),h.Qb(f.g))},Qt.\u0275cmp=h.Kb({type:Qt,selectors:[["app-facility-allowed-users"]],decls:9,vars:8,consts:[[1,"page-subtitle"],[3,"refresh",4,"ngIf"],[3,"placeholder","filter",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],["color","warn",4,"ngIf"],[3,"pageSize","users","displayedColumns","disableRouting","filter","page",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],[1,"ml-auto","mr-auto"],["color","warn"],[3,"pageSize","users","displayedColumns","disableRouting","filter","page"]],template:function(e,t){1&e&&(h.Wb(0,"div"),h.Wb(1,"h1",0),h.Lc(2),h.jc(3,"translate"),h.Vb(),h.Jc(4,zt,1,0,"perun-web-apps-refresh-button",1),h.Jc(5,Wt,1,1,"perun-web-apps-immediate-filter",2),h.Jc(6,Nt,1,0,"mat-spinner",3),h.Jc(7,Bt,3,3,"app-alert",4),h.Jc(8,Yt,1,6,"app-users-list",5),h.Vb()),2&e&&(h.Cb(2),h.Mc(h.kc(3,6,"FACILITY_DETAIL.ALLOWED_USERS.TITLE")),h.Cb(2),h.oc("ngIf",!t.loading),h.Cb(1),h.oc("ngIf",!t.loading),h.Cb(1),h.oc("ngIf",t.loading),h.Cb(1),h.oc("ngIf",!t.loading&&(void 0===t.users||0===t.users.length)),h.Cb(1),h.oc("ngIf",!t.loading&&0!==t.users.length))},directives:[a.t,x.a,K.a,y.c,Mt.a,Dt.a],pipes:[S.d],styles:[""]}),Qt),Pt=i("lfUW"),Gt=i("CIWc"),Jt=i("COMt");function Ht(e,t){if(1&e){var i=h.Xb();h.Wb(0,"button",8),h.ec("click",(function(){return h.Bc(i),h.ic(2).removeTaskResult()})),h.Lc(1),h.jc(2,"translate"),h.Vb()}if(2&e){var a=h.ic(2);h.oc("disabled",0===a.selection.selected.length),h.Cb(1),h.Nc(" ",h.kc(2,2,"FACILITY_DETAIL.TASK_RESULTS.REMOVE")," ")}}function Xt(e,t){1&e&&h.Rb(0,"mat-spinner",9)}function xt(e,t){if(1&e){var i=h.Xb();h.Wb(0,"perun-web-apps-task-results-list",10),h.ec("page",(function(e){return h.Bc(i),h.ic(2).pageChanged(e)})),h.Vb()}if(2&e){var a=h.ic(2);h.oc("displayedColumns",a.displayedColumns)("filterValue",a.filterValue)("pageSize",a.pageSize)("selection",a.selection)("taskResults",a.taskResults)}}function Kt(e,t){if(1&e){var i=h.Xb();h.Wb(0,"div"),h.Wb(1,"h1",1),h.Lc(2),h.jc(3,"translate"),h.Wb(4,"span",2),h.Lc(5),h.Vb(),h.Vb(),h.Wb(6,"perun-web-apps-refresh-button",3),h.ec("refresh",(function(){return h.Bc(i),h.ic().refreshTable()})),h.Vb(),h.Jc(7,Ht,3,4,"button",4),h.Wb(8,"perun-web-apps-immediate-filter",5),h.ec("filter",(function(e){return h.Bc(i),h.ic().applyFilter(e)})),h.Vb(),h.Jc(9,Xt,1,0,"mat-spinner",6),h.Jc(10,xt,1,5,"perun-web-apps-task-results-list",7),h.Vb()}if(2&e){var a=h.ic();h.Cb(2),h.Oc("",h.kc(3,7,"FACILITY_DETAIL.TASK_RESULTS.TITLE")," - ",a.task.service.name," "),h.Cb(3),h.Nc(" \xa0#",a.task.id," "),h.Cb(2),h.oc("ngIf",!a.loading&&a.removeAuth),h.Cb(1),h.oc("placeholder","FACILITY_DETAIL.TASK_RESULTS.FILTER"),h.Cb(1),h.oc("ngIf",a.loading),h.Cb(1),h.oc("ngIf",!a.loading)}}var $t,qt,Zt,ei=[{path:"",component:n.a},{path:":facilityId",component:L,children:[{path:"",component:M,data:{animation:"FacilityOverviewPage"}},{path:"attributes",component:ie,data:{animation:"FacilityAttributesPage"}},{path:"resources",component:D.a,data:{animation:"FacilityResourcesPage"}},{path:"allowed-users",component:Ut,data:{animation:"FacilityAllowedUsersPage"}},{path:"allowed-groups",component:z.a,data:{animation:"FacilityAllowedGroupsPage"}},{path:"services-status",component:Ot,data:{animation:"FacilityServiceStatusPage"}},{path:"services-status/:taskId",component:($t=function(){function e(t,i,a,s,n){_classCallCheck(this,e),this.route=t,this.tableConfigService=i,this.taskManager=a,this.authResolver=s,this.dialog=n,this.loading=!1,this.filterValue="",this.selection=new G.c(!0,[]),this.tableId=H.R,this.displayedColumns=["select","id","destination","type","service","status","time","returnCode","standardMessage","errorMessage"],this.removeAuth=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.parent.params.subscribe((function(t){e.facility={id:parseInt(t.facilityId,10),beanName:"Facility"},e.removeAuth=e.authResolver.isAuthorized("deleteTask_Task_policy",[e.facility]),e.removeAuth||(e.displayedColumns=["id","destination","type","service","status","time","returnCode","standardMessage","errorMessage"]),e.route.params.subscribe((function(t){e.taskId=t.taskId,e.taskManager.getTaskById(e.taskId).subscribe((function(t){e.task=t,e.refreshTable()}))}))}))}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.taskManager.getTaskResultsForGUIByTask(this.taskId).subscribe((function(t){e.selection.clear(),e.taskResults=t,e.loading=!1}))}},{key:"removeTaskResult",value:function(){var e=this,t=Object(u.k)();t.width="600px",t.data={theme:"facility-theme",taskResults:this.selection.selected},this.dialog.open(Gt.a,t).afterClosed().subscribe((function(t){t&&e.refreshTable()}))}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}(),$t.\u0275fac=function(e){return new(e||$t)(h.Qb(s.a),h.Qb(H.lb),h.Qb(o.o),h.Qb(f.g),h.Qb(d.b))},$t.\u0275cmp=h.Kb({type:$t,selectors:[["app-facility-task-results"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-subtitle"],[1,"text-muted"],[3,"refresh"],["class","mr-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"displayedColumns","filterValue","pageSize","selection","taskResults","page",4,"ngIf"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"displayedColumns","filterValue","pageSize","selection","taskResults","page"]],template:function(e,t){1&e&&h.Jc(0,Kt,11,9,"div",0),2&e&&h.oc("ngIf",!t.loading)},directives:[a.t,x.a,K.a,v.b,y.c,Jt.a],pipes:[S.d],styles:[""]}),$t),data:{animation:"FacilityTaskResultsPage"}},{path:"service-config",component:Le,data:{animation:"FacilityServiceConfigPage"}},{path:"services-destinations",component:Qe,data:{animation:"FacilityServicesDestinationsPage"}},{path:"hosts",component:lt,data:{animation:"FacilityHostsPage"}},{path:"hosts/:hostId",component:yt,data:{animation:"FacilityHostsDetailPage"}},{path:"security-teams",component:Ct,data:{animation:"FacilitySecurityTeamsPage"}},{path:"settings",component:B,children:[{path:"",component:U,data:{animation:"FacilitySettingsOverviewPage"}},{path:"owners",component:Ze,data:{animation:"FacilitySettingOwnersPage"}},{path:"managers",component:Oe,data:{animation:"FacilitySettingsManagersPage"}},{path:"blacklist",component:ht,data:{animation:"FacilitySettingsBlackListPage"}}]}]},{path:":facilityId/resources/:resourceId",component:W.a,children:[{path:"",component:N.a,data:{animation:"ResourceOverviewPage"}},{path:"attributes",component:ne.a,data:{animation:"ResourceAttributesPage"}},{path:"groups",component:ce.a,data:{animation:"ResourceGroupsComponent"}},{path:"services",component:At.a,data:{animation:"ResourceAssignedServicesComponent"}},{path:"members",component:Pt.a,data:{animation:"ResourceAssignedMembersComponent"}},{path:"settings",component:ae.a,children:[{path:"",component:se.a,data:{animation:"ResourceSettingsOverviewPage"}},{path:"managers",component:Tt.a,data:{animation:"ResourceSettingsManagersPage"}}]}]}],ti=((qt=function e(){_classCallCheck(this,e)}).\u0275mod=h.Ob({type:qt}),qt.\u0275inj=h.Nb({factory:function(e){return new(e||qt)},imports:[[s.j.forChild(ei)],s.j]}),qt),ii=i("PCNd"),ai=i("mWkV"),si=i("KoHB"),ni=i("zrcO"),ci=((Zt=function e(){_classCallCheck(this,e)}).\u0275mod=h.Ob({type:Zt}),Zt.\u0275inj=h.Nb({factory:function(e){return new(e||Zt)},providers:[ue.c],imports:[[a.c,ti,ai.b,ii.a,si.a,P.c,ue.b,ni.UsersModule]]}),Zt)}}]);