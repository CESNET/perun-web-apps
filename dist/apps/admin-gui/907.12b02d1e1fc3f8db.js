"use strict";(self.webpackChunkadmin_gui=self.webpackChunkadmin_gui||[]).push([[907],{15003:(te,j,o)=>{o.d(j,{G:()=>A});var r=o(94650);let A=(()=>{class n{constructor(){this.entityDetailChange=new r.vpe}reloadEntityDetail(){this.entityDetailChange.emit()}}return n.\u0275fac=function(R){return new(R||n)},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},76023:(te,j,o)=>{o.d(j,{y:()=>H});var r=o(61744),A=o(10036),n=o(81591),m=o(94650),R=o(94364),s=o(36895),t=o(51572),e=o(96214),Q=o(38383),K=o(64901),a=o(89383);function w(G,F){1&G&&m._UZ(0,"mat-spinner",5)}const y=function(){return["id","fullName"]};function U(G,F){if(1&G){const E=m.EpF();m.TgZ(0,"perun-web-apps-members-list",6),m.NdJ("updateTable",function(){m.CHM(E);const P=m.oxw();return m.KtG(P.refreshTable())}),m.qZA()}if(2&G){const E=m.oxw();m.Q6J("displayedColumns",m.DdM(5,y))("disableRouting",!E.routeAuth)("filter",E.filterValue)("members",E.members)("tableId",E.tableId)}}let H=(()=>{class G{constructor(E,I,P,L){this.route=E,this.resourceService=I,this.authResolver=P,this.entityStorageService=L,this.loading=!1,this.filterValue="",this.tableId=A.iQ}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.resourceService.getAssignedRichMembers(this.resource.id).subscribe(E=>{this.members=E,this.setAuthRights(),this.loading=!1})}setAuthRights(){0!==this.members.length&&(this.routeAuth=this.authResolver.isAuthorized("getMemberById_int_policy",[this.members[0]]))}applyFilter(E){this.filterValue=E}}return G.\u0275fac=function(E){return new(E||G)(m.Y36(R.gz),m.Y36(r.xk),m.Y36(n.x4),m.Y36(n.fb))},G.\u0275cmp=m.Xpm({type:G,selectors:[["app-resource-assigned-members"]],decls:7,vars:6,consts:[[1,"page-subtitle"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"displayedColumns","disableRouting","filter","members","tableId","updateTable",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"displayedColumns","disableRouting","filter","members","tableId","updateTable"]],template:function(E,I){1&E&&(m.TgZ(0,"h1",0),m._uU(1),m.ALo(2,"translate"),m.qZA(),m.TgZ(3,"perun-web-apps-refresh-button",1),m.NdJ("refresh",function(){return I.refreshTable()}),m.qZA(),m.TgZ(4,"perun-web-apps-debounce-filter",2),m.NdJ("filter",function(L){return I.applyFilter(L)}),m.qZA(),m.YNc(5,w,1,0,"mat-spinner",3),m.YNc(6,U,1,6,"perun-web-apps-members-list",4)),2&E&&(m.xp6(1),m.Oqu(m.lcZ(2,4,"RESOURCE_DETAIL.ASSIGNED_MEMBERS.TITLE")),m.xp6(3),m.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_MEMBERS.FILTER"),m.xp6(1),m.Q6J("ngIf",I.loading),m.xp6(1),m.Q6J("ngIf",!I.loading))},dependencies:[s.O5,t.Ou,e.t,Q.O,K.P,a.X$]}),G})()},49546:(te,j,o)=>{o.d(j,{D:()=>re});var r=o(61744),A=o(10036),n=o(95017),m=o(9244),R=o(65412),s=o(81591),t=o(94650),e=o(89383),Q=o(36895),K=o(4859),a=o(3848),w=o(51572),y=o(64901),U=o(90439),H=o(60205);function G(M,S){1&M&&t._UZ(0,"mat-spinner",6)}const F=function(){return["id","name","enabled","description"]};function E(M,S){if(1&M&&t._UZ(0,"app-services-list",16),2&M){const p=t.oxw(2);t.Q6J("disableRouting",!0)("services",p.filteredServices)("displayedColumns",t.DdM(5,F))("selection",p.selection)("tableId",p.tableId)}}const I=function(){return["select","id","name","enabled","description"]};function P(M,S){if(1&M){const p=t.EpF();t.TgZ(0,"div",7)(1,"mat-tab-group",8),t.NdJ("selectedTabChange",function(){t.CHM(p);const u=t.oxw();return t.KtG(u.tabChanged())}),t.TgZ(2,"mat-tab",9),t.ALo(3,"translate"),t.TgZ(4,"div",10)(5,"perun-web-apps-debounce-filter",11),t.NdJ("filter",function(u){t.CHM(p);const v=t.oxw();return t.KtG(v.applyFilter(u))}),t.ALo(6,"translate"),t.qZA()(),t._UZ(7,"app-services-list",12),t.qZA(),t.TgZ(8,"mat-tab",9),t.ALo(9,"translate"),t.TgZ(10,"div",13)(11,"perun-web-apps-service-package-search-select",14),t.NdJ("packageSelected",function(u){t.CHM(p);const v=t.oxw();return t.KtG(v.servicePackageSelected(u))}),t.qZA()(),t.YNc(12,E,1,6,"app-services-list",15),t.qZA()()()}if(2&M){const p=t.oxw();t.xp6(2),t.s9C("label",t.lcZ(3,12,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SELECT_SERVICE")),t.xp6(3),t.s9C("placeholder",t.lcZ(6,14,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.FILTER_DESCRIPTION")),t.xp6(2),t.Q6J("services",p.unAssignedServices)("disableRouting",!0)("displayedColumns",t.DdM(18,I))("filterValue",p.filterValue)("selection",p.selection)("tableId",p.tableId),t.xp6(1),t.s9C("label",t.lcZ(9,16,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SELECT_PACKAGE")),t.xp6(3),t.Q6J("selectedPackage",p.selectedPackage)("servicePackages",p.servicePackages),t.xp6(1),t.Q6J("ngIf",-1!==p.selectedPackage.id)}}let L=(()=>{class M{constructor(p,_,u,v,f,D){this.dialogRef=p,this.data=_,this.notificator=u,this.translate=v,this.resourceManager=f,this.servicesManager=D,this.loading=!1,this.unAssignedServices=[],this.filteredServices=[],this.servicePackages=[],this.selectedPackage={name:"Not selected",description:"",id:-1,beanName:"ServicePackage"},this.selection=new n.Ov(!0,[]),this.tableId=A.DR,this.filterValue=""}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resourceManager.getAssignedServicesToResource(this.data.resourceId).subscribe(p=>{this.servicesManager.getServices().subscribe(_=>{this.servicesManager.getServicesPackages().subscribe(u=>{this.servicePackages.push(this.selectedPackage),this.servicePackages=this.servicePackages.concat(u),this.unAssignedServices=_;for(const v of p)for(const f of _)v.id===f.id&&this.unAssignedServices.splice(this.unAssignedServices.indexOf(f),1);this.loading=!1})})})}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0,-1!==this.selectedPackage.id?this.addServicePackage():this.addServices()}applyFilter(p){this.filterValue=p}servicePackageSelected(p){this.selectedPackage=p,-1!==p.id?this.servicesManager.getServicesFromServicesPackage(p.id).subscribe(_=>{this.filteredServices=_}):this.filteredServices=[]}tabChanged(){this.selection.clear(),this.filterValue="",this.selectedPackage=this.servicePackages[0]}addServicePackage(){this.resourceManager.assignServicesPackage(this.data.resourceId,this.selectedPackage.id).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.PACKAGE_SUCCESS_MESSAGE").subscribe(p=>{this.notificator.showSuccess(p),0!==this.selection.selected.length?this.addServices():this.dialogRef.close(!0)})},()=>this.loading=!1)}addServices(){const p=[];for(const _ of this.selection.selected)p.push(_.id);this.resourceManager.assignServices(this.data.resourceId,p).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SERVICE_SUCCESS_MESSAGE").subscribe(_=>{this.notificator.showSuccess(_),this.dialogRef.close(!0)})},()=>this.loading=!1)}}return M.\u0275fac=function(p){return new(p||M)(t.Y36(R.so),t.Y36(R.WI),t.Y36(s.V6),t.Y36(e.sK),t.Y36(r.xk),t.Y36(r.KK))},M.\u0275cmp=t.Xpm({type:M,selectors:[["app-perun-web-apps-assign-service-to-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[3,"selectedTabChange"],[3,"label"],[1,"mt-2"],[3,"placeholder","filter"],[3,"services","disableRouting","displayedColumns","filterValue","selection","tableId"],[1,"mt-3"],[3,"selectedPackage","servicePackages","packageSelected"],[3,"disableRouting","services","displayedColumns","selection","tableId",4,"ngIf"],[3,"disableRouting","services","displayedColumns","selection","tableId"]],template:function(p,_){1&p&&(t.TgZ(0,"div")(1,"h1",0),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.YNc(4,G,1,0,"mat-spinner",1),t.YNc(5,P,13,19,"div",2),t.TgZ(6,"div",3)(7,"button",4),t.NdJ("click",function(){return _.onCancel()}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"button",5),t.NdJ("click",function(){return _.onAdd()}),t._uU(11),t.ALo(12,"translate"),t.qZA()()()),2&p&&(t.Tol(_.theme),t.xp6(2),t.Oqu(t.lcZ(3,9,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.TITLE")),t.xp6(2),t.Q6J("ngIf",_.loading),t.xp6(1),t.Q6J("ngIf",!_.loading),t.xp6(3),t.hij(" ",t.lcZ(9,11,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.CANCEL_BUTTON")," "),t.xp6(2),t.Q6J("disabled",0===_.selection.selected.length&&-1===_.selectedPackage.id||_.loading),t.xp6(1),t.hij(" ",t.lcZ(12,13,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE."+(-1===_.selectedPackage.id?"ADD_SERVICES":"ADD_PACKAGE"))," "))},dependencies:[Q.O5,K.lW,a.SP,a.uX,R.uh,R.xY,R.H8,w.Ou,y.P,U.F,H.Q,e.X$]}),M})();var V=o(30671);function W(M,S){1&M&&t._UZ(0,"mat-spinner",6)}function oe(M,S){1&M&&t._UZ(0,"th",15)}function ne(M,S){if(1&M&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&M){const p=S.$implicit;t.xp6(1),t.Oqu(p.name)}}function B(M,S){1&M&&t._UZ(0,"tr",17)}function $(M,S){1&M&&t._UZ(0,"tr",18)}function b(M,S){if(1&M&&(t.TgZ(0,"div",7)(1,"p"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",8),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"table",9),t.ynx(8,10),t.YNc(9,oe,1,0,"th",11),t.YNc(10,ne,2,1,"td",12),t.BQk(),t.YNc(11,B,1,0,"tr",13),t.YNc(12,$,1,0,"tr",14),t.qZA()()),2&M){const p=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,5,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DESCRIPTION")," "),t.xp6(3),t.hij(" ",t.lcZ(6,7,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.ASK")," "),t.xp6(2),t.Q6J("dataSource",p.dataSource),t.xp6(4),t.Q6J("matHeaderRowDef",p.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",p.displayedColumns)}}let h=(()=>{class M{constructor(p,_,u,v,f){this.dialogRef=p,this.data=_,this.notificator=u,this.translate=v,this.resourcesManager=f,this.displayedColumns=["name"]}ngOnInit(){this.theme=this.data.theme,this.dataSource=new V.by(this.data.services)}onSubmit(){this.loading=!0;const p=[];for(const _ of this.data.services)p.push(_.id);this.resourcesManager.removeServices(this.data.resourceId,p).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.SUCCESS").subscribe(_=>{this.notificator.showSuccess(_),this.dialogRef.close(!0)})},()=>this.loading=!1)}onCancel(){this.dialogRef.close()}}return M.\u0275fac=function(p){return new(p||M)(t.Y36(R.so),t.Y36(R.WI),t.Y36(s.V6),t.Y36(e.sK),t.Y36(r.xk))},M.\u0275cmp=t.Xpm({type:M,selectors:[["app-perun-web-apps-remove-service-from-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","warn","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(p,_){1&p&&(t.TgZ(0,"div")(1,"h1",0),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.YNc(4,W,1,0,"mat-spinner",1),t.YNc(5,b,13,9,"div",2),t.TgZ(6,"div",3)(7,"button",4),t.NdJ("click",function(){return _.onCancel()}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"button",5),t.NdJ("click",function(){return _.onSubmit()}),t._uU(11),t.ALo(12,"translate"),t.qZA()()()),2&p&&(t.Tol(_.theme),t.xp6(2),t.Oqu(t.lcZ(3,9,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.TITLE")),t.xp6(2),t.Q6J("ngIf",_.loading),t.xp6(1),t.Q6J("ngIf",!_.loading),t.xp6(3),t.hij(" ",t.lcZ(9,11,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.CANCEL")," "),t.xp6(2),t.Q6J("disabled",_.loading),t.xp6(1),t.hij(" ",t.lcZ(12,13,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DELETE")," "))},dependencies:[Q.O5,K.lW,V.BZ,V.fO,V.as,V.w1,V.Dz,V.nj,V.ge,V.ev,V.XQ,V.Gk,R.uh,R.xY,R.H8,w.Ou,e.X$]}),M})();var J=o(94364),C=o(96214),Y=o(7434);function k(M,S){if(1&M){const p=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){t.CHM(p);const u=t.oxw();return t.KtG(u.addService())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&M&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_SERVICES.ADD_SERVICE"),"\n"))}function X(M,S){if(1&M){const p=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(p);const u=t.oxw();return t.KtG(u.removeServices())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&M){const p=t.oxw();t.Q6J("disabled",0===p.selected.selected.length),t.xp6(1),t.hij(" ",t.lcZ(2,2,"RESOURCE_DETAIL.ASSIGNED_SERVICES.REMOVE_SERVICE"),"\n")}}function se(M,S){1&M&&t._UZ(0,"mat-spinner",9)}function ae(M,S){if(1&M&&t._UZ(0,"app-services-list",10),2&M){const p=t.oxw();t.Q6J("disableRouting",!p.serviceRoutingAuth)("selection",p.selected)("displayedColumns",p.displayedColumns)("filterValue",p.filterValue)("services",p.assignedServices)("tableId",p.tableId)}}let re=(()=>{class M{constructor(p,_,u,v,f){this.route=p,this.resourcesManager=_,this.dialog=u,this.guiAuthResolver=v,this.entityStorageService=f,this.assignedServices=[],this.selected=new n.Ov(!0,[]),this.tableId=A.uC,this.filterValue="",this.displayedColumns=["select","id","name","enabled","script","description"]}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.getDataForAuthorization(),this.loadAllServices()}loadAllServices(){this.loading=!0,this.resourcesManager.getAssignedServicesToResource(this.resource.id).subscribe(p=>{this.assignedServices=p,this.selected.clear(),this.loading=!1})}addService(){const p=(0,m.kZ)();p.width="800px",p.data={theme:"resource-theme",resourceId:this.resource.id},this.dialog.open(L,p).afterClosed().subscribe(u=>{u&&this.loadAllServices()})}removeServices(){const p=(0,m.kZ)();p.width="500px",p.data={theme:"resource-theme",resourceId:this.resource.id,services:this.selected.selected},this.dialog.open(h,p).afterClosed().subscribe(u=>{u&&this.loadAllServices()})}applyFilter(p){this.filterValue=p}getDataForAuthorization(){this.assignServiceAuth=this.guiAuthResolver.isAuthorized("assignServices_Resource_List<Service>_policy",[this.resource]),this.removeServiceAuth=this.guiAuthResolver.isAuthorized("removeServices_Resource_List<Service>_policy",[this.resource]),this.displayedColumns=this.removeServiceAuth?["select","id","name","enabled","script","description"]:["id","name","enabled","script","description"],this.serviceRoutingAuth=this.guiAuthResolver.isPerunAdminOrObserver()}}return M.\u0275fac=function(p){return new(p||M)(t.Y36(J.gz),t.Y36(r.xk),t.Y36(R.uw),t.Y36(s.x4),t.Y36(s.fb))},M.\u0275cmp=t.Xpm({type:M,selectors:[["app-perun-web-apps-resource-assigned-services"]],decls:9,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["class","action-button mr-2","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"disableRouting","selection","displayedColumns","filterValue","services","tableId",4,"ngIf"],["color","accent","mat-flat-button","",1,"action-button","mr-2",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"disableRouting","selection","displayedColumns","filterValue","services","tableId"]],template:function(p,_){1&p&&(t.TgZ(0,"h1",0),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.TgZ(3,"perun-web-apps-refresh-button",1),t.NdJ("refresh",function(){return _.loadAllServices()}),t.qZA(),t.YNc(4,k,3,3,"button",2),t.YNc(5,X,3,4,"button",3),t.TgZ(6,"perun-web-apps-immediate-filter",4),t.NdJ("filter",function(v){return _.applyFilter(v)}),t.qZA(),t.YNc(7,se,1,0,"mat-spinner",5),t.YNc(8,ae,1,6,"app-services-list",6)),2&p&&(t.xp6(1),t.Oqu(t.lcZ(2,6,"RESOURCE_DETAIL.ASSIGNED_SERVICES.TITLE")),t.xp6(3),t.Q6J("ngIf",_.assignServiceAuth),t.xp6(1),t.Q6J("ngIf",_.removeServiceAuth),t.xp6(1),t.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_SERVICES.FILTER_SERVICES"),t.xp6(1),t.Q6J("ngIf",_.loading),t.xp6(1),t.Q6J("ngIf",!_.loading))},dependencies:[Q.O5,K.lW,w.Ou,H.Q,C.t,Y.L,e.X$]}),M})()},92090:(te,j,o)=>{o.d(j,{X:()=>F});var r=o(81591),A=o(61744),n=o(94650),m=o(36895),R=o(3848),s=o(48323),t=o(12651),e=o(89383);function Q(E,I){1&E&&(n._uU(0),n.ALo(1,"translate")),2&E&&n.hij(" ",n.lcZ(1,1,"RESOURCE_DETAIL.ENTITY")," ")}function K(E,I){if(1&E&&n._UZ(0,"app-one-entity-attribute-page",4),2&E){const P=n.oxw();n.Q6J("entityId",P.resource.id)("entity","resource")}}function a(E,I){1&E&&(n._uU(0),n.ALo(1,"translate"),n.ALo(2,"translate")),2&E&&n.AsE(" ",n.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",n.lcZ(2,4,"MEMBER_DETAIL.ENTITY")," ")}function w(E,I){if(1&E&&n._UZ(0,"app-two-entity-attribute-page",5),2&E){const P=n.oxw(2);n.Q6J("firstEntity","resource")("firstEntityId",P.resource.id)("secondEntity","member")}}function y(E,I){1&E&&(n.TgZ(0,"mat-tab"),n.YNc(1,a,3,6,"ng-template",1),n.YNc(2,w,1,3,"ng-template",2),n.qZA())}function U(E,I){1&E&&(n._uU(0),n.ALo(1,"translate"),n.ALo(2,"translate")),2&E&&n.AsE(" ",n.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",n.lcZ(2,4,"GROUP_DETAIL.ENTITY")," ")}function H(E,I){if(1&E&&n._UZ(0,"app-two-entity-attribute-page",5),2&E){const P=n.oxw(2);n.Q6J("firstEntity","resource")("firstEntityId",P.resource.id)("secondEntity","group")}}function G(E,I){1&E&&(n.TgZ(0,"mat-tab"),n.YNc(1,U,3,6,"ng-template",1),n.YNc(2,H,1,3,"ng-template",2),n.qZA())}let F=(()=>{class E{constructor(P,L,V){this.authResolver=P,this.resourceManager=L,this.entityStorageService=V}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.resourceGroupAttAuth=this.authResolver.isAuthorized("getGroupAssignments_Resource_policy",[this.resource]),this.resourceMemberAttAuth=this.authResolver.isAuthorized("getAssignedMembersWithStatus_Resource_policy",[this.resource])}}return E.\u0275fac=function(P){return new(P||E)(n.Y36(r.x4),n.Y36(A.xk),n.Y36(r.fb))},E.\u0275cmp=n.Xpm({type:E,selectors:[["app-resource-attributes"]],hostVars:2,hostBindings:function(P,L){2&P&&n.ekj("router-component",L.true)},decls:10,vars:5,consts:[[1,"page-subtitle"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(P,L){1&P&&(n.TgZ(0,"div")(1,"h1",0),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"mat-tab-group")(5,"mat-tab"),n.YNc(6,Q,2,3,"ng-template",1),n.YNc(7,K,1,2,"ng-template",2),n.qZA(),n.YNc(8,y,3,0,"mat-tab",3),n.YNc(9,G,3,0,"mat-tab",3),n.qZA()()),2&P&&(n.xp6(2),n.Oqu(n.lcZ(3,3,"RESOURCE_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),n.xp6(6),n.Q6J("ngIf",L.resourceMemberAttAuth),n.xp6(1),n.Q6J("ngIf",L.resourceGroupAttAuth))},dependencies:[m.O5,R.SP,R.uD,R.uX,R.Vc,s.Y,t.t,e.X$]}),E})()},98918:(te,j,o)=>{o.d(j,{b:()=>M});var r=o(36769),A=o(69024),n=o(61744),m=o(9244),R=o(81591),s=o(19516),t=o(21029),e=o(533),Q=o(22158),K=o(82722),a=o(94650),w=o(94364),y=o(77968),U=o(65412),H=o(15003),G=o(36895),F=o(97392),E=o(4859),I=o(51572),P=o(10266),L=o(61283),V=o(4235),W=o(34198),oe=o(55660),ne=o(89383);function B(S,p){1&S&&a._UZ(0,"mat-spinner",3)}function $(S,p){if(1&S){const _=a.EpF();a.TgZ(0,"button",14),a.NdJ("click",function(){a.CHM(_);const v=a.oxw(2);return a.KtG(v.editResource())}),a.TgZ(1,"mat-icon"),a._uU(2,"edit"),a.qZA()()}}function b(S,p){if(1&S){const _=a.EpF();a.TgZ(0,"button",15),a.NdJ("click",function(){a.CHM(_);const v=a.oxw(2);return a.KtG(v.deleteResource())}),a.TgZ(1,"mat-icon"),a._uU(2,"delete_forever"),a.qZA()()}}const h=function(S){return["/organizations",S]};function J(S,p){if(1&S&&(a.TgZ(0,"a",8),a.NdJ("auxclick",function(u){return u.preventDefault()}),a._uU(1),a.qZA()),2&S){const _=a.oxw(2);a.Q6J("perunWebAppsMiddleClickRouterLink",a.VKq(4,h,_.resource.vo.id.toString()))("routerLink",a.VKq(6,h,_.resource.vo.id)),a.uIk("data-cy",_.resource.vo.name),a.xp6(1),a.Oqu(_.resource.vo.name)}}function C(S,p){if(1&S&&(a.TgZ(0,"span"),a._uU(1),a.qZA()),2&S){const _=a.oxw(2);a.xp6(1),a.hij(" ",_.resource.vo.name," ")}}const Y=function(S){return["/facilities",S]};function k(S,p){if(1&S&&(a.TgZ(0,"a",8),a.NdJ("auxclick",function(u){return u.preventDefault()}),a._uU(1),a.qZA()),2&S){const _=a.oxw(2);a.Q6J("perunWebAppsMiddleClickRouterLink",a.VKq(4,Y,_.resource.facilityId.toString()))("routerLink",a.VKq(6,Y,_.resource.facilityId)),a.uIk("data-cy",_.resource.facility.name),a.xp6(1),a.Oqu(_.resource.facility.name)}}function X(S,p){if(1&S&&(a.TgZ(0,"span"),a._uU(1),a.qZA()),2&S){const _=a.oxw(2);a.xp6(1),a.hij(" ",_.resource.facility.name," ")}}const se=function(){return{color:"black"}},ae=function(S){return[S]};function re(S,p){if(1&S&&(a.TgZ(0,"div")(1,"div",4),a._UZ(2,"mat-icon",5),a.ALo(3,"translate"),a.TgZ(4,"div",6)(5,"div",7)(6,"a",8),a.NdJ("auxclick",function(u){return u.preventDefault()}),a._uU(7),a.qZA(),a.TgZ(8,"span",9),a._uU(9),a.qZA(),a.YNc(10,$,3,0,"button",10),a.YNc(11,b,3,0,"button",11),a.qZA(),a.TgZ(12,"div"),a._uU(13),a.ALo(14,"translate"),a.qZA(),a.TgZ(15,"span",12),a._uU(16),a.ALo(17,"translate"),a.ALo(18,"translate"),a.YNc(19,J,2,8,"a",13),a.YNc(20,C,2,1,"span",2),a._uU(21),a.ALo(22,"translate"),a.YNc(23,k,2,8,"a",13),a.YNc(24,X,2,1,"span",2),a._uU(25),a.ALo(26,"translate"),a.qZA()()(),a._UZ(27,"app-animated-router-outlet"),a.qZA()),2&S){const _=a.oxw();a.xp6(2),a.s9C("matTooltip",a.lcZ(3,21,"RESOURCE_DETAIL.ENTITY")),a.Q6J("ngStyle",a.DdM(33,se)),a.xp6(4),a.Q6J("perunWebAppsMiddleClickRouterLink",a.VKq(34,ae,_.baseUrl))("routerLink",a.VKq(36,ae,_.baseUrl)),a.xp6(1),a.hij(" ",_.resource.name," "),a.xp6(2),a.hij(" \xa0#",_.resource.id," "),a.xp6(1),a.Q6J("ngIf",_.editResourceAuth),a.xp6(1),a.Q6J("ngIf",_.deleteAuth),a.xp6(2),a.AsE("",a.lcZ(14,23,"RESOURCE_DETAIL.UUID"),": ",_.resource.uuid,""),a.xp6(3),a.AsE(" ",a.lcZ(17,25,"RESOURCE_DETAIL.ENTITY"),", ",a.lcZ(18,27,"RESOURCE_DETAIL.VO"),": "),a.xp6(3),a.Q6J("ngIf",_.voLinkAuth),a.xp6(1),a.Q6J("ngIf",!_.voLinkAuth),a.xp6(1),a.AsE(" #",_.resource.voId,", ",a.lcZ(22,29,"RESOURCE_DETAIL.FACILITY"),": "),a.xp6(2),a.Q6J("ngIf",_.facilityLinkAuth),a.xp6(1),a.Q6J("ngIf",!_.facilityLinkAuth),a.xp6(1),a.lnq(" #",_.resource.facilityId,", ",a.lcZ(26,31,"RESOURCE_DETAIL.DESCRIPTION"),": ",_.resource.description," ")}}let M=(()=>{class S extends((0,Q.T)()){constructor(_,u,v,f,D,g,N,c,T,Z,q){super(),this.route=_,this.facilityManager=u,this.vosManagerService=v,this.resourcesManager=f,this.sideMenuService=D,this.sideMenuItemService=g,this.dialog=N,this.guiAuthResolver=c,this.router=T,this.entityStorageService=Z,this.reloadEntityDetail=q,this.underVoUrl=!1,this.deleteAuth=!1,this.baseUrl="",this.loading=!1}ngOnInit(){this.reloadData(),this.reloadEntityDetail.entityDetailChange.pipe((0,K.R)(this.destroyed$)).subscribe(()=>{this.reloadData()})}reloadData(){this.loading=!0,this.route.params.subscribe(_=>{const u=Number(_.resourceId);this.resourcesManager.getRichResourceById(u).subscribe(v=>{this.resource=v,this.entityStorageService.setEntity({id:v.id,voId:v.voId,facilityId:v.facilityId,beanName:"Resource"}),this.setAuth(),"facilities"===this.route.parent.snapshot.url[0].path?(this.baseUrl=(new s.r5).transform(v,!1),this.facilityManager.getFacilityById(v.facilityId).subscribe(f=>{this.facility=f,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)):(this.baseUrl=(new s.r5).transform(v,!0),this.vosManagerService.getVoById(v.voId).subscribe(f=>{this.vo=f,this.underVoUrl=!0,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)),(0,m.sF)("resources",this.resource)})})}setMenuItems(){let _;const u=this.sideMenuItemService.parseResource(this.resource,this.underVoUrl);this.underVoUrl?(_=this.sideMenuItemService.parseVo(this.vo),this.sideMenuService.setAccessMenuItems([_,u])):(_=this.sideMenuItemService.parseFacility(this.facility),this.sideMenuService.setFacilityMenuItems([_,u]))}editResource(){let _;this.resourcesManager.getResourceById(this.resource.id).subscribe(u=>{_=u;const v=(0,m.kZ)();v.width="450px",v.data={theme:"resource-theme",resource:_,dialogType:t.Eg.RESOURCE},this.dialog.open(t.rd,v).afterClosed().subscribe(D=>{D&&this.resourcesManager.getRichResourceById(this.resource.id).subscribe(g=>{this.resource=g,this.setMenuItems()})})})}deleteResource(){const _=(0,m.kZ)();_.width="500px",_.data={theme:"resource-theme",resources:[this.resource]},this.dialog.open(e.f,_).afterClosed().subscribe(v=>{v&&this.router.navigate(["../"],{relativeTo:this.route,queryParamsHandling:"preserve"})})}setAuth(){this.facilityLinkAuth=this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.resource]),this.editResourceAuth=this.guiAuthResolver.isAuthorized("updateResource_Resource_policy",[this.resource]),this.voLinkAuth=this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.resource]),this.deleteAuth=this.guiAuthResolver.isAuthorized("deleteResource_Resource_policy",[this.resource])}}return S.\u0275fac=function(_){return new(_||S)(a.Y36(w.gz),a.Y36(n.IQ),a.Y36(n.YF),a.Y36(n.xk),a.Y36(y.D),a.Y36(A.V),a.Y36(U.uw),a.Y36(R.x4),a.Y36(w.F0),a.Y36(R.fb),a.Y36(H.G))},S.\u0275cmp=a.Xpm({type:S,selectors:[["app-resource-detail-page"]],features:[a.qOj],decls:4,vars:2,consts:[[1,"container-fluid","pl-xl-5","pr-xl-5","resource-theme"],["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-resource-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"resource-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],[1,"text-muted"],["aria-label","Edit resource","mat-icon-button","",3,"click",4,"ngIf"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"mt-1","entity-info"],["class","resource-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick",4,"ngIf"],["aria-label","Edit resource","mat-icon-button","",3,"click"],["mat-icon-button","",3,"click"]],template:function(_,u){1&_&&(a.TgZ(0,"div",0),a._UZ(1,"perun-web-apps-back-button"),a.YNc(2,B,1,0,"mat-spinner",1),a.YNc(3,re,28,38,"div",2),a.qZA()),2&_&&(a.xp6(2),a.Q6J("ngIf",u.loading),a.xp6(1),a.Q6J("ngIf",!u.loading&&void 0!==u.resource))},dependencies:[G.O5,G.PC,w.yS,F.Hw,E.lW,I.Ou,P.gM,L.A,V.W,W.Y,oe.Q,ne.X$],styles:[".break-line[_ngcontent-%COMP%]{display:inline-block}"],data:{animation:[r.Ji]}}),S})()},258:(te,j,o)=>{o.d(j,{K:()=>D});var r=o(61744),A=o(95017),n=o(65412),m=o(30671),R=o(81591),s=o(94650),t=o(89383),e=o(36895),Q=o(4859),K=o(51572);function a(g,N){1&g&&s._UZ(0,"mat-spinner",6)}function w(g,N){1&g&&s._UZ(0,"th",15)}function y(g,N){if(1&g&&(s.TgZ(0,"td",16),s._uU(1),s.qZA()),2&g){const c=N.$implicit;s.xp6(1),s.Oqu(c.name)}}function U(g,N){1&g&&s._UZ(0,"tr",17)}function H(g,N){1&g&&s._UZ(0,"tr",18)}function G(g,N){if(1&g&&(s.TgZ(0,"div",7)(1,"p"),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.TgZ(4,"div",8),s._uU(5),s.ALo(6,"translate"),s.qZA(),s.TgZ(7,"table",9),s.ynx(8,10),s.YNc(9,w,1,0,"th",11),s.YNc(10,y,2,1,"td",12),s.BQk(),s.YNc(11,U,1,0,"tr",13),s.YNc(12,H,1,0,"tr",14),s.qZA()()),2&g){const c=s.oxw();s.xp6(2),s.hij(" ",s.lcZ(3,5,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DESCRIPTION")," "),s.xp6(3),s.hij(" ",s.lcZ(6,7,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.ASK")," "),s.xp6(2),s.Q6J("dataSource",c.dataSource),s.xp6(4),s.Q6J("matHeaderRowDef",c.displayedColumns),s.xp6(1),s.Q6J("matRowDefColumns",c.displayedColumns)}}let F=(()=>{class g{constructor(c,T,Z,q,z){this.dialogRef=c,this.data=T,this.notificator=Z,this.translate=q,this.resourceManager=z,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.dataSource=new m.by(this.data.groups)}onCancel(){this.dialogRef.close()}onSubmit(){const c=[];for(const T of this.data.groups)c.push(T.id);this.loading=!0,this.resourceManager.removeGroupsFromResource(c,this.data.resourceId).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUP_FROM_RESOURCE.SUCCESS").subscribe(T=>{this.notificator.showSuccess(T),this.dialogRef.close(!0)})},()=>this.loading=!1)}}return g.\u0275fac=function(c){return new(c||g)(s.Y36(n.so),s.Y36(n.WI),s.Y36(R.V6),s.Y36(t.sK),s.Y36(r.xk))},g.\u0275cmp=s.Xpm({type:g,selectors:[["app-perun-web-apps-remove-group-from-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","warn","mat-flat-button","","data-cy","delete-button",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(c,T){1&c&&(s.TgZ(0,"div")(1,"h1",0),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.YNc(4,a,1,0,"mat-spinner",1),s.YNc(5,G,13,9,"div",2),s.TgZ(6,"div",3)(7,"button",4),s.NdJ("click",function(){return T.onCancel()}),s._uU(8),s.ALo(9,"translate"),s.qZA(),s.TgZ(10,"button",5),s.NdJ("click",function(){return T.onSubmit()}),s._uU(11),s.ALo(12,"translate"),s.qZA()()()),2&c&&(s.Tol(T.theme),s.xp6(2),s.Oqu(s.lcZ(3,9,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.TITLE")),s.xp6(2),s.Q6J("ngIf",T.loading),s.xp6(1),s.Q6J("ngIf",!T.loading),s.xp6(3),s.hij(" ",s.lcZ(9,11,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.CANCEL")," "),s.xp6(2),s.Q6J("disabled",T.loading),s.xp6(1),s.hij(" ",s.lcZ(12,13,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DELETE")," "))},dependencies:[e.O5,Q.lW,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,n.uh,n.xY,n.H8,K.Ou,t.X$]}),g})();var E=o(10036),I=o(24006),P=o(90455),L=o(86257),V=o(25788),W=o(64901);const oe=["stepper"];function ne(g,N){1&g&&s._UZ(0,"mat-spinner",4)}function B(g,N){1&g&&(s._uU(0),s.ALo(1,"translate")),2&g&&s.Oqu(s.lcZ(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.GROUPS"))}function $(g,N){1&g&&(s._uU(0),s.ALo(1,"translate")),2&g&&s.Oqu(s.lcZ(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.OPTIONS"))}const b=function(){return["select","id","name","description"]};function h(g,N){if(1&g){const c=s.EpF();s.TgZ(0,"div",5)(1,"mat-stepper",6,7)(3,"mat-step",8),s.YNc(4,B,2,3,"ng-template",9),s.TgZ(5,"perun-web-apps-debounce-filter",10),s.NdJ("filter",function(Z){s.CHM(c);const q=s.oxw();return s.KtG(q.applyFilter(Z))}),s.ALo(6,"translate"),s.qZA(),s._UZ(7,"perun-web-apps-groups-list",11),s.qZA(),s.TgZ(8,"mat-step"),s.YNc(9,$,2,3,"ng-template",9),s.TgZ(10,"mat-slide-toggle",12),s.NdJ("toggleChange",function(){s.CHM(c);const Z=s.oxw();return s.KtG(Z.changeSubgroupsMessage())})("ngModelChange",function(Z){s.CHM(c);const q=s.oxw();return s.KtG(q.autoAssignSubgroups=Z)}),s._uU(11),s.ALo(12,"translate"),s.qZA(),s.TgZ(13,"div",13),s._UZ(14,"i",14),s.qZA(),s.TgZ(15,"mat-slide-toggle",12),s.NdJ("toggleChange",function(){s.CHM(c);const Z=s.oxw();return s.KtG(Z.changeInactiveMessage())})("ngModelChange",function(Z){s.CHM(c);const q=s.oxw();return s.KtG(q.asActive=Z)}),s._uU(16),s.ALo(17,"translate"),s.qZA(),s.TgZ(18,"div",13),s._uU(19),s.qZA(),s.TgZ(20,"mat-slide-toggle",12),s.NdJ("toggleChange",function(){s.CHM(c);const Z=s.oxw();return s.KtG(Z.changeAsyncMessage())})("ngModelChange",function(Z){s.CHM(c);const q=s.oxw();return s.KtG(q.async=Z)}),s._uU(21),s.ALo(22,"translate"),s.qZA(),s.TgZ(23,"div",13),s._uU(24),s.qZA()()()()}if(2&g){const c=s.oxw();s.xp6(1),s.Q6J("linear",!0),s.xp6(2),s.Q6J("completed",0!==c.selection.selected.length&&c.canAddGroups()),s.xp6(2),s.s9C("placeholder",s.lcZ(6,19,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.FILTER_DESCRIPTION")),s.xp6(2),s.Q6J("disableMembers",!1)("groups",c.unAssignedGroups)("selection",c.selection)("disableRouting",!0)("displayedColumns",s.DdM(27,b))("filter",c.filterValue)("tableId",c.tableId),s.xp6(3),s.Q6J("ngModel",c.autoAssignSubgroups),s.xp6(1),s.hij(" ",s.lcZ(12,21,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS")," "),s.xp6(3),s.Q6J("innerHTML",c.autoAssignHint,s.oJD),s.xp6(1),s.Q6J("ngModel",c.asActive),s.xp6(1),s.hij(" ",s.lcZ(17,23,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AS_ACTIVE")," "),s.xp6(3),s.hij(" ",c.asActiveHint," "),s.xp6(1),s.Q6J("ngModel",c.async),s.xp6(1),s.hij(" ",s.lcZ(22,25,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OPT")," "),s.xp6(3),s.hij(" ",c.asyncHint," ")}}function J(g,N){if(1&g){const c=s.EpF();s.TgZ(0,"button",20),s.NdJ("click",function(){s.CHM(c);const Z=s.oxw(2);return s.KtG(Z.stepperPrevious())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&g&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.BACK")," "))}function C(g,N){if(1&g){const c=s.EpF();s.TgZ(0,"button",21),s.NdJ("click",function(){s.CHM(c);const Z=s.oxw(2);return s.KtG(Z.stepperNext())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}if(2&g){const c=s.oxw(2);s.ekj("ml-2",void 0!==c.stepper&&0!==c.stepper.selectedIndex)("ml-auto",!(void 0!==c.stepper&&0!==c.stepper.selectedIndex)),s.Q6J("disabled",0===c.selection.selected.length||!c.canAddGroups()),s.xp6(1),s.hij(" ",s.lcZ(2,6,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.NEXT")," ")}}function Y(g,N){if(1&g){const c=s.EpF();s.TgZ(0,"button",22),s.NdJ("click",function(){s.CHM(c);const Z=s.oxw(2);return s.KtG(Z.onAdd())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&g&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ADD_BUTTON")," "))}function k(g,N){if(1&g){const c=s.EpF();s.TgZ(0,"div",15)(1,"button",16),s.NdJ("click",function(){s.CHM(c);const Z=s.oxw();return s.KtG(Z.onCancel())}),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.YNc(4,J,3,3,"button",17),s.YNc(5,C,3,8,"button",18),s.YNc(6,Y,3,3,"button",19),s.qZA()}if(2&g){const c=s.oxw();s.xp6(2),s.hij(" ",s.lcZ(3,4,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.CANCEL_BUTTON")," "),s.xp6(2),s.Q6J("ngIf",void 0!==c.stepper&&0!==c.stepper.selectedIndex),s.xp6(1),s.Q6J("ngIf",void 0!==c.stepper&&c.stepper.selectedIndex!==c.stepper._steps.length-1),s.xp6(1),s.Q6J("ngIf",void 0!==c.stepper&&c.stepper.selectedIndex===c.stepper._steps.length-1)}}let X=(()=>{class g{constructor(c,T,Z,q,z,ie,pe,ge){this.dialogRef=c,this.data=T,this.notificator=Z,this.translate=q,this.resourceManager=z,this.groupService=ie,this.guiAuthResolver=pe,this.cd=ge,this.loading=!1,this.unAssignedGroups=this.data.onlyAutoAssignedGroups,this.async=!0,this.autoAssignSubgroups=!1,this.asActive=!0,this.selection=new A.Ov(!0,[]),this.filterValue="",this.tableId=E.cL}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resource=this.data.resource,this.autoAssignHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT"),this.asActiveHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT"),this.asyncHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT"),this.resourceManager.getAssignedGroups(this.resource.id).subscribe(c=>{this.groupService.getAllGroups(this.resource.voId).subscribe(T=>{for(const Z of T)-1===c.findIndex(q=>q.id===Z.id)&&this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,Z])&&this.unAssignedGroups.push(Z);this.loading=!1,this.cd.detectChanges()},()=>this.loading=!1)},()=>this.loading=!1)}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0;const c=[];for(const T of this.selection.selected)c.push(T.id);this.resourceManager.assignGroupsToResource(c,this.resource.id,this.async,!this.asActive,this.autoAssignSubgroups).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.SUCCESS_MESSAGE").subscribe(T=>{this.notificator.showSuccess(T),this.dialogRef.close(!0)})},()=>this.loading=!1)}applyFilter(c){this.filterValue=c}canAddGroups(){let c=!0;return this.selection.selected.forEach(T=>{this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,T])||(c=!1)}),c}changeSubgroupsMessage(){this.autoAssignHint=this.translate.instant(this.autoAssignSubgroups?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_ON_HINT")}changeInactiveMessage(){this.asActiveHint=this.translate.instant(this.asActive?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT")}changeAsyncMessage(){this.asyncHint=this.translate.instant(this.async?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT")}stepperPrevious(){this.stepper.previous()}stepperNext(){this.stepper.next()}}return g.\u0275fac=function(c){return new(c||g)(s.Y36(n.so),s.Y36(n.WI),s.Y36(R.V6),s.Y36(t.sK),s.Y36(r.xk),s.Y36(r.ff),s.Y36(R.x4),s.Y36(s.sBO))},g.\u0275cmp=s.Xpm({type:g,selectors:[["app-perun-web-apps-assign-group-to-resource-dialog"]],viewQuery:function(c,T){if(1&c&&s.Gf(oe,5),2&c){let Z;s.iGM(Z=s.CRH())&&(T.stepper=Z.first)}},decls:7,vars:9,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["class","dialog-container","mat-dialog-content","",4,"ngIf"],["mat-dialog-actions","",4,"ngIf"],[1,"mr-auto","ml-auto"],["mat-dialog-content","",1,"dialog-container"],[3,"linear"],["stepper",""],[3,"completed"],["matStepLabel",""],[3,"placeholder","filter"],[3,"disableMembers","groups","selection","disableRouting","displayedColumns","filter","tableId"],["labelPosition","before",1,"mt-3","slide-text",3,"ngModel","toggleChange","ngModelChange"],[1,"text-muted","new-line","mt-2"],[3,"innerHTML"],["mat-dialog-actions",""],["mat-flat-button","",3,"click"],["class","ml-auto","mat-flat-button","",3,"click",4,"ngIf"],["color","accent","mat-flat-button","","type","button","data-cy","next-button",3,"ml-2","ml-auto","disabled","click",4,"ngIf"],["class","ml-2","color","accent","mat-flat-button","","type","button","data-cy","assign-button",3,"click",4,"ngIf"],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","","type","button","data-cy","next-button",3,"disabled","click"],["color","accent","mat-flat-button","","type","button","data-cy","assign-button",1,"ml-2",3,"click"]],template:function(c,T){1&c&&(s.TgZ(0,"div")(1,"h1",0),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.YNc(4,ne,1,0,"mat-spinner",1),s.YNc(5,h,25,28,"div",2),s.YNc(6,k,7,6,"div",3),s.qZA()),2&c&&(s.Tol(T.theme),s.xp6(2),s.Oqu(s.lcZ(3,7,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.TITLE")),s.xp6(2),s.Q6J("ngIf",T.loading),s.xp6(1),s.Q6J("ngIf",!T.loading),s.xp6(1),s.Q6J("ngIf",!T.loading&&T.stepper))},dependencies:[e.O5,I.JJ,I.On,Q.lW,n.uh,n.xY,n.H8,K.Ou,P.Rr,L.C0,L.VY,L.Vq,V.W,W.P,t.X$],styles:[".slide-text[_ngcontent-%COMP%]{font-size:1.1rem}"]}),g})();var se=o(9244),ae=o(64080),re=o(94364),M=o(10266),S=o(96214);function p(g,N){if(1&g){const c=s.EpF();s.TgZ(0,"button",8),s.NdJ("click",function(){s.CHM(c);const Z=s.oxw();return s.KtG(Z.addGroup())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&g&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_GROUPS.ADD_GROUP"),"\n"))}function _(g,N){1&g&&s._UZ(0,"mat-spinner",9)}const u=function(g){return[g]},v=function(){return["select","id","indirectGroupAssigment","name","status","description"]};function f(g,N){if(1&g){const c=s.EpF();s.TgZ(0,"perun-web-apps-groups-list",10),s.NdJ("refreshTable",function(){s.CHM(c);const Z=s.oxw();return s.KtG(Z.loadAllGroups())}),s.qZA()}if(2&g){const c=s.oxw();s.Q6J("disableGroups",!0)("groupsToDisableCheckbox",c.groupsToDisable)("disableMembers",!1)("groups",c.assignedGroups)("disableRouting",!!c.assignedGroups[0]&&!c.guiAuthResolver.isAuthorized("getGroupById_int_policy",s.VKq(10,u,c.assignedGroups[0])))("displayedColumns",s.DdM(12,v))("filter",c.filteredValue)("resourceId",c.resource.id)("selection",c.selected)("tableId",c.tableId)}}let D=(()=>{class g{constructor(c,T,Z,q,z){this.route=c,this.resourcesManager=T,this.dialog=Z,this.guiAuthResolver=q,this.entityStorageService=z,this.assignedGroups=[],this.selected=new A.Ov(!0,[]),this.filteredValue="",this.tableId=E.Ad}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.loadAllGroups()}loadAllGroups(){this.loading=!0,this.resourcesManager.getGroupAssignments(this.resource.id,[ae.r.GROUP_SYNC_ENABLED]).subscribe(c=>{this.assignedGroups=c.map(z=>{const ie=z.enrichedGroup.group;return ie.status=z.status,ie.failureCause=z.failureCause,ie.sourceGroupId=z.sourceGroupId,ie});const T=this.assignedGroups.map(z=>z.id),Z=this.assignedGroups.filter((z,ie)=>T.indexOf(z.id)===ie),q=this.assignedGroups.filter((z,ie)=>{const pe=T.indexOf(z.id);return pe!==ie&&(null===z.sourceGroupId||null===this.assignedGroups[pe].sourceGroupId)}).map(z=>z.id);Z.forEach(z=>{q.includes(z.id)&&(z.moreTypesOfAssignment=!0)}),this.assignedGroups=Z,this.groupsToDisable=new Set(this.assignedGroups.filter(z=>!!z.sourceGroupId&&!z.moreTypesOfAssignment).map(z=>z.id)),this.selected.clear(),this.loading=!1})}addGroup(){const c=(0,se.kZ)();c.width="1000px",c.data={theme:"resource-theme",resource:this.resource,onlyAutoAssignedGroups:this.assignedGroups.filter(Z=>this.groupsToDisable.has(Z.id))},this.dialog.open(X,c).afterClosed().subscribe(Z=>{Z&&this.loadAllGroups()})}removeGroups(){const c=(0,se.kZ)();c.width="500px",c.data={resourceId:this.resource.id,groups:this.selected.selected,theme:"resource-theme"},this.dialog.open(F,c).afterClosed().subscribe(Z=>{Z&&this.loadAllGroups()})}canRemoveGroups(){let c=!0;return this.selected.selected.forEach(T=>{this.guiAuthResolver.isAuthorized("removeGroupsFromResource_List<Group>_Resource_policy",[this.resource,T])||(c=!1)}),c}applyFilter(c){this.filteredValue=c}}return g.\u0275fac=function(c){return new(c||g)(s.Y36(re.gz),s.Y36(r.xk),s.Y36(n.uw),s.Y36(R.x4),s.Y36(R.fb))},g.\u0275cmp=s.Xpm({type:g,selectors:[["app-perun-web-apps-resource-groups"]],decls:13,vars:17,consts:[[1,"page-subtitle"],[3,"refresh"],["class","action-button","color","accent","mat-flat-button","","data-cy","add-group-button",3,"click",4,"ngIf"],["color","warn","mat-flat-button","","data-cy","remove-group-button",1,"ml-2","mr-2",3,"disabled","click"],[3,"matTooltipDisabled","matTooltip"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"disableGroups","groupsToDisableCheckbox","disableMembers","groups","disableRouting","displayedColumns","filter","resourceId","selection","tableId","refreshTable",4,"ngIf"],["color","accent","mat-flat-button","","data-cy","add-group-button",1,"action-button",3,"click"],[1,"ml-auto","mr-auto"],[3,"disableGroups","groupsToDisableCheckbox","disableMembers","groups","disableRouting","displayedColumns","filter","resourceId","selection","tableId","refreshTable"]],template:function(c,T){1&c&&(s.TgZ(0,"h1",0),s._uU(1),s.ALo(2,"translate"),s.qZA(),s.TgZ(3,"perun-web-apps-refresh-button",1),s.NdJ("refresh",function(){return T.loadAllGroups()}),s.qZA(),s.YNc(4,p,3,3,"button",2),s.TgZ(5,"button",3),s.NdJ("click",function(){return T.removeGroups()}),s.TgZ(6,"span",4),s.ALo(7,"translate"),s._uU(8),s.ALo(9,"translate"),s.qZA()(),s.TgZ(10,"perun-web-apps-debounce-filter",5),s.NdJ("filter",function(q){return T.applyFilter(q)}),s.qZA(),s.YNc(11,_,1,0,"mat-spinner",6),s.YNc(12,f,1,13,"perun-web-apps-groups-list",7)),2&c&&(s.xp6(1),s.Oqu(s.lcZ(2,9,"RESOURCE_DETAIL.ASSIGNED_GROUPS.TITLE")),s.xp6(3),s.Q6J("ngIf",T.guiAuthResolver.isAuthorized("getAllGroups_Vo_policy",s.VKq(15,u,T.resource))),s.xp6(1),s.Q6J("disabled",0===T.selected.selected.length||!T.canRemoveGroups()),s.xp6(1),s.s9C("matTooltip",s.lcZ(7,11,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_TOOLTIP")),s.Q6J("matTooltipDisabled",T.canRemoveGroups()),s.xp6(2),s.hij(" ",s.lcZ(9,13,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_GROUP")," "),s.xp6(2),s.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_GROUPS.FILTER_GROUPS"),s.xp6(1),s.Q6J("ngIf",T.loading),s.xp6(1),s.Q6J("ngIf",!T.loading))},dependencies:[e.O5,Q.lW,K.Ou,M.gM,V.W,S.t,W.P,t.X$]}),g})()},4675:(te,j,o)=>{o.d(j,{H:()=>K});var r=o(61744),A=o(81591),n=o(94650),m=o(94364),R=o(36895),s=o(51572),t=o(71135);function e(a,w){1&a&&n._UZ(0,"mat-spinner",2)}function Q(a,w){if(1&a&&(n.TgZ(0,"div"),n._UZ(1,"perun-web-apps-menu-buttons-field",3),n.qZA()),2&a){const y=n.oxw();n.xp6(1),n.Q6J("items",y.navItems)("size","small")}}let K=(()=>{class a{constructor(y,U,H,G,F){this.resourcesManager=y,this.route=U,this.guiAuthResolver=H,this.entityStorageService=G,this.routePolicyService=F,this.navItems=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.initItems("facilities"!==this.route.parent.parent.snapshot.url[0].path),this.loading=!1}initItems(y){const U=y?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`;this.navItems=[],this.routePolicyService.canNavigate("resources-groups",this.resource)&&this.navItems.push({cssIcon:"perun-group",url:`${U}/resources/${this.resource.id}/groups`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_GROUPS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-services",this.resource)&&this.navItems.push({cssIcon:"perun-service",url:`${U}/resources/${this.resource.id}/services`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_SERVICES",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-members",this.resource)&&this.navItems.push({cssIcon:"perun-user",url:`${U}/resources/${this.resource.id}/members`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_MEMBERS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-tags",this.resource)&&this.navItems.push({cssIcon:"perun-resource-tags",url:`${U}/resources/${this.resource.id}/tags`,label:"MENU_ITEMS.RESOURCE.RESOURCE_TAGS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-attributes",this.resource)&&this.navItems.push({cssIcon:"perun-attributes",url:`${U}/resources/${this.resource.id}/attributes`,label:"MENU_ITEMS.RESOURCE.ATTRIBUTES",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-settings",this.resource)&&this.navItems.push({cssIcon:"perun-settings2",url:`${U}/resources/${this.resource.id}/settings`,label:"MENU_ITEMS.RESOURCE.SETTINGS",style:"resource-btn"})}}return a.\u0275fac=function(y){return new(y||a)(n.Y36(r.xk),n.Y36(m.gz),n.Y36(A.x4),n.Y36(A.fb),n.Y36(A.Ip))},a.\u0275cmp=n.Xpm({type:a,selectors:[["app-resource-overview"]],hostVars:2,hostBindings:function(y,U){2&y&&n.ekj("router-component",U.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(y,U){1&y&&(n.YNc(0,e,1,0,"mat-spinner",0),n.YNc(1,Q,2,2,"div",1)),2&y&&(n.Q6J("ngIf",U.loading),n.xp6(1),n.Q6J("ngIf",!U.loading))},dependencies:[R.O5,s.Ou,t.L]}),a})()},35265:(te,j,o)=>{o.d(j,{I:()=>b});var r=o(61744),A=o(95017),n=o(81591),m=o(9244),R=o(21029),s=o(10036),t=o(65412),e=o(94650),Q=o(38383),K=o(64901),a=o(83370);const w=function(){return["checkbox","id","fullName"]};let y=(()=>{class h{constructor(C,Y,k,X,se){this.data=C,this.dialogRef=Y,this.store=k,this.resourceService=X,this.notificator=se,this.selection=new A.Ov(!1,[]),this.loading=!1,this.displayedColumns=["checkbox","id","fullName","organization","email","logins"],this.members=[],this.tableId=s.bj,this.filter=""}ngOnInit(){this.loading=!0,this.resourceService.getAssignedRichMembers(this.data.entityId).subscribe({next:C=>{this.members=C,this.loading=!1},error:()=>this.loading=!1}),this.selection.changed.subscribe(C=>{this.ban=this.data.bans.find(Y=>Y.memberId===C.source.selected[0]?.id)})}cancel(){this.dialogRef.close(!1)}submitBan(C){this.ban?this.updateBan(C):this.banMember(C)}banMember(C){this.loading=!0,this.resourceService.setResourceBan({banOnResource:{memberId:this.selection.selected[0].id,resourceId:this.data.entityId,description:C.description,validityTo:C.validity,id:0,beanName:"BanOnResource"}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.ADD_BAN.SUCCESS_MEMBER"),this.dialogRef.close(!0)},error:()=>this.loading=!1})}updateBan(C){this.loading=!0,this.resourceService.updateResourceBan({banOnResource:{id:this.ban.id,beanName:"BanOnFacility",resourceId:this.ban.resourceId,memberId:this.ban.memberId,description:C.description,validityTo:C.validity}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.UPDATE_BAN.SUCCESS"),this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}}return h.\u0275fac=function(C){return new(C||h)(e.Y36(t.WI),e.Y36(t.so),e.Y36(n.d6),e.Y36(r.xk),e.Y36(n.V6))},h.\u0275cmp=e.Xpm({type:h,selectors:[["app-add-resource-ban-dialog"]],decls:3,vars:13,consts:[[3,"loading","disabled","theme","ban","add","cancel"],[3,"placeholder","filter"],[3,"displayedColumns","selection","disableRouting","allowCheckboxDisabled","filter","members","tableId"]],template:function(C,Y){1&C&&(e.TgZ(0,"app-add-ban-dialog",0),e.NdJ("add",function(X){return Y.submitBan(X)})("cancel",function(){return Y.cancel()}),e.TgZ(1,"perun-web-apps-debounce-filter",1),e.NdJ("filter",function(X){return Y.filter=X}),e.qZA(),e._UZ(2,"perun-web-apps-members-list",2),e.qZA()),2&C&&(e.Q6J("loading",Y.loading)("disabled",0===Y.selection.selected.length)("theme",Y.data.theme)("ban",Y.ban),e.xp6(1),e.Q6J("placeholder","DIALOGS.ADD_BAN.FILTER"),e.xp6(1),e.Q6J("displayedColumns",e.DdM(12,w))("selection",Y.selection)("disableRouting",!0)("allowCheckboxDisabled",!1)("filter",Y.filter)("members",Y.members)("tableId",Y.tableId))},dependencies:[Q.O,K.P,a.u]}),h})();var U=o(64080),H=o(28943),G=o(19516),F=o(36895),E=o(4859),I=o(51572),P=o(96214),L=o(73358),V=o(91880),W=o(89383);function oe(h,J){if(1&h){const C=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){e.CHM(C);const k=e.oxw();return e.KtG(k.add())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&h&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"RESOURCE_DETAIL.SETTINGS.BANS.ADD"),"\n"))}function ne(h,J){if(1&h){const C=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(C);const k=e.oxw();return e.KtG(k.remove())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&h){const C=e.oxw();e.Q6J("disabled",0===C.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"RESOURCE_DETAIL.SETTINGS.BANS.REMOVE"),"\n")}}function B(h,J){if(1&h){const C=e.EpF();e.TgZ(0,"perun-web-apps-ban-on-entity-list",10),e.NdJ("updateBan",function(k){e.CHM(C);const X=e.oxw();return e.KtG(X.update(k))}),e.qZA()}if(2&h){const C=e.oxw();e.Q6J("bans",C.bans)("selection",C.selection)("displayedColumns",C.displayedColumns)("filter",C.filter)("updatePolicy","updateBan_BanOnResource_policy")}}function $(h,J){1&h&&(e.TgZ(0,"div",11),e._UZ(1,"mat-spinner"),e.qZA())}let b=(()=>{class h{constructor(C,Y,k,X,se,ae,re){this.resourceService=C,this.entityService=Y,this.authResolver=k,this.dialog=X,this.notificator=se,this.store=ae,this.userName=re,this.loading=!1,this.bans=[],this.removeAuth=!1,this.filter="",this.selection=new A.Ov(!1,[]),this.attrNames=[U.r.MEMBER_DEF_MAIL,U.r.USER_DEF_PREFERRED_MAIL].concat(this.store.getLoginAttributeNames()),this.displayedColumns=["select","banId","subjectId","subjectName","description","expiration","edit"]}ngOnInit(){this.loading=!0,this.resource=this.entityService.getEntity(),this.addAuth=this.authResolver.isAuthorized("setBan_BanOnResource_policy",[this.resource]),this.removeAuth=this.authResolver.isAuthorized("resource-removeBan_int_policy",[this.resource]),this.refresh()}refresh(){this.loading=!0,this.resourceService.getEnrichedBansForResource(this.resource.id,this.attrNames).subscribe({next:C=>{this.bans=C,this.selection.clear(),this.loading=!1},error:()=>this.loading=!1})}add(){const C=(0,m.kZ)();C.width="850px",C.data={entityId:this.resource.id,theme:"resource-theme",bans:this.bans.map(k=>k.ban)},this.dialog.open(y,C).afterClosed().subscribe(k=>{k&&this.refresh()})}remove(){const C=(0,m.kZ)();C.width="550px",C.data={theme:"resource-theme",title:"DIALOGS.REMOVE_BAN.TITLE",description:"DIALOGS.REMOVE_BAN.DESCRIPTION",items:[this.userName.transform(this.selection.selected[0].member.user)],type:"remove",showAsk:!0},this.dialog.open(R.Ts,C).afterClosed().subscribe(k=>{k&&this.resourceService.removeResourceBanById(this.selection.selected[0].ban.id).subscribe(()=>{this.notificator.showSuccess("DIALOGS.REMOVE_BAN.SUCCESS"),this.refresh()})})}update(C){const Y=(0,m.kZ)();Y.width="600px",Y.data={ban:C.ban,theme:"facility-theme"},this.dialog.open(H.e,Y).afterClosed().subscribe(X=>{X&&this.refresh()})}}return h.\u0275fac=function(C){return new(C||h)(e.Y36(r.xk),e.Y36(n.fb),e.Y36(n.x4),e.Y36(t.uw),e.Y36(n.V6),e.Y36(n.d6),e.Y36(G.dp))},h.\u0275cmp=e.Xpm({type:h,selectors:[["app-resource-settings-bans"]],features:[e._Bn([G.dp])],decls:11,vars:8,consts:[[1,"page-subtitle"],[3,"click"],["class","mr-2 action-button","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","class","mr-2","mat-flat-button","",3,"disabled","click",4,"ngIf"],[1,"mt-2","search-field",3,"placeholder","filter"],[1,"position-relative"],[3,"bans","selection","displayedColumns","filter","updatePolicy","updateBan",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["spinner",""],["color","accent","mat-flat-button","",1,"mr-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[3,"bans","selection","displayedColumns","filter","updatePolicy","updateBan"],[1,"spinner-container"]],template:function(C,Y){if(1&C&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("click",function(){return Y.refresh()}),e.qZA(),e.YNc(4,oe,3,3,"button",2),e.YNc(5,ne,3,4,"button",3),e.TgZ(6,"perun-web-apps-debounce-filter",4),e.NdJ("filter",function(X){return Y.filter=X}),e.qZA(),e.TgZ(7,"div",5),e.YNc(8,B,1,5,"perun-web-apps-ban-on-entity-list",6),e.qZA(),e.YNc(9,$,2,0,"ng-template",null,7,e.W1O)),2&C){const k=e.MAs(10);e.xp6(1),e.hij(" ",e.lcZ(2,6,"RESOURCE_DETAIL.SETTINGS.BANS.TITLE"),"\n"),e.xp6(3),e.Q6J("ngIf",Y.addAuth),e.xp6(1),e.Q6J("ngIf",Y.removeAuth),e.xp6(1),e.Q6J("placeholder","RESOURCE_DETAIL.SETTINGS.BANS.FILTER"),e.xp6(2),e.Q6J("perunWebAppsLoader",Y.loading)("perunWebAppsLoaderIndicator",k)}},dependencies:[F.O5,E.lW,I.Ou,P.t,K.P,L.e,V.s,W.X$]}),h})()},20057:(te,j,o)=>{o.d(j,{O:()=>m});var r=o(81591),A=o(94650),n=o(28361);let m=(()=>{class R{constructor(t,e){this.guiAuthResolver=t,this.entityStorageService=e,this.availableRoles=[],this.type="Resource",this.theme="resource-theme"}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Resource")}}return R.\u0275fac=function(t){return new(t||R)(A.Y36(r.x4),A.Y36(r.fb))},R.\u0275cmp=A.Xpm({type:R,selectors:[["app-resource-settings-managers"]],decls:1,vars:4,consts:[[3,"complementaryObject","availableRoles","complementaryObjectType","theme"]],template:function(t,e){1&t&&A._UZ(0,"app-managers-page",0),2&t&&A.Q6J("complementaryObject",e.resource)("availableRoles",e.availableRoles)("complementaryObjectType",e.type)("theme",e.theme)},dependencies:[n.s]}),R})()},16500:(te,j,o)=>{o.d(j,{h:()=>K});var r=o(61744),A=o(81591),n=o(94650),m=o(94364),R=o(36895),s=o(51572),t=o(71135);function e(a,w){1&a&&n._UZ(0,"mat-spinner",2)}function Q(a,w){if(1&a&&(n.TgZ(0,"div"),n._UZ(1,"perun-web-apps-menu-buttons-field",3),n.qZA()),2&a){const y=n.oxw();n.xp6(1),n.Q6J("items",y.items)("size","small")}}let K=(()=>{class a{constructor(y,U,H,G,F){this.route=y,this.resourceManager=U,this.authResolver=H,this.entityStorageService=G,this.routePolicyService=F,this.items=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.initItems("facilities"!==this.route.parent.parent.parent.snapshot.url[0].path),this.loading=!1}initItems(y){this.items=[],this.routePolicyService.canNavigate("resources-settings-managers",this.resource)&&this.items.push({cssIcon:"perun-manager",url:`${y?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/managers`,label:"MENU_ITEMS.RESOURCE.MANAGERS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-settings-bans",this.resource)&&this.items.push({cssIcon:"perun-ban",url:`${y?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/bans`,label:"MENU_ITEMS.RESOURCE.BANS",style:"resource-btn"})}}return a.\u0275fac=function(y){return new(y||a)(n.Y36(m.gz),n.Y36(r.xk),n.Y36(A.x4),n.Y36(A.fb),n.Y36(A.Ip))},a.\u0275cmp=n.Xpm({type:a,selectors:[["app-resource-settings-overview"]],hostVars:2,hostBindings:function(y,U){2&y&&n.ekj("router-component",U.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(y,U){1&y&&(n.YNc(0,e,1,0,"mat-spinner",0),n.YNc(1,Q,2,2,"div",1)),2&y&&(n.Q6J("ngIf",U.loading),n.xp6(1),n.Q6J("ngIf",!U.loading))},dependencies:[R.O5,s.Ou,t.L]}),a})()},60113:(te,j,o)=>{o.d(j,{t:()=>m});var r=o(36769),A=o(94650),n=o(61283);let m=(()=>{class R{}return R.\u0275fac=function(t){return new(t||R)},R.\u0275cmp=A.Xpm({type:R,selectors:[["app-resource-settings"]],hostVars:2,hostBindings:function(t,e){2&t&&A.ekj("router-component",e.true)},decls:1,vars:0,template:function(t,e){1&t&&A._UZ(0,"app-animated-router-outlet")},dependencies:[n.A],data:{animation:[r.Ji]}}),R})()},20872:(te,j,o)=>{o.d(j,{v:()=>ne});var r=o(61744),A=o(95017),n=o(10036),m=o(9244),R=o(81591),s=o(21029),t=o(65412),e=o(94650),Q=o(36895),K=o(4859),a=o(51572),w=o(17672),y=o(89383);function U(B,$){1&B&&e._UZ(0,"mat-spinner",8)}function H(B,$){if(1&B&&e._UZ(0,"app-resources-tags-list",9),2&B){const b=e.oxw();e.Q6J("selection",b.selection)("displayedColumns",b.displayedColumns)("entity","resource")("filterValue",b.filterValue)("resourceTags",b.resourceTags)("tableId",b.tableId)}}let G=(()=>{class B{constructor(b,h,J){this.dialogRef=b,this.data=h,this.resourcesManager=J,this.tableId=n.g,this.selection=new A.Ov(!0,[]),this.resourceTags=[],this.displayedColumns=["select","id","name"]}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.voId=this.data.voId,this.resourceId=this.data.resourceId,this.assignedTags=this.data.assignedTags,this.resourcesManager.getAllResourcesTagsForVo(this.voId).subscribe(b=>{this.resourceTags=b.filter(h=>!this.assignedTags.map(J=>J.id).includes(h.id)),this.loading=!1})}onCancel(){this.dialogRef.close(!1)}onSubmit(b){this.resourcesManager.assignResourceTagsToResource({resource:this.resourceId,resourceTags:b}).subscribe(()=>{this.dialogRef.close(!0)})}applyFilter(b){this.filterValue=b}}return B.\u0275fac=function(b){return new(b||B)(e.Y36(t.so),e.Y36(t.WI),e.Y36(r.xk))},B.\u0275cmp=e.Xpm({type:B,selectors:[["app-add-resource-tag-to-resource-dialog"]],decls:15,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],[3,"selection","displayedColumns","entity","filterValue","resourceTags","tableId",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],[3,"selection","displayedColumns","entity","filterValue","resourceTags","tableId"]],template:function(b,h){1&b&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1)(5,"div",2),e.YNc(6,U,1,0,"mat-spinner",3),e.qZA(),e.YNc(7,H,1,6,"app-resources-tags-list",4),e.qZA(),e.TgZ(8,"div",5)(9,"button",6),e.NdJ("click",function(){return h.onCancel()}),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"button",7),e.NdJ("click",function(){return h.onSubmit(h.selection.selected)}),e._uU(13),e.ALo(14,"translate"),e.qZA()()()),2&b&&(e.Tol(h.theme),e.xp6(2),e.Oqu(e.lcZ(3,9,"RESOURCE_DETAIL.TAGS.ADD_TAGS")),e.xp6(4),e.Q6J("ngIf",h.loading),e.xp6(1),e.Q6J("ngIf",!h.loading),e.xp6(3),e.hij(" ",e.lcZ(11,11,"RESOURCE_DETAIL.TAGS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",h.loading||0===h.resourceTags.length),e.xp6(1),e.hij(" ",e.lcZ(14,13,"RESOURCE_DETAIL.TAGS.ADD_BUTTON")," "))},dependencies:[Q.O5,K.lW,t.uh,t.xY,t.H8,a.Ou,w.o,y.X$]}),B})();var F=o(17584),E=o(96214),I=o(7434);function P(B,$){if(1&B){const b=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){e.CHM(b);const J=e.oxw();return e.KtG(J.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&B&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.CREATE_BUTTON"),"\n"))}function L(B,$){if(1&B){const b=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){e.CHM(b);const J=e.oxw();return e.KtG(J.addTag())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&B&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"RESOURCE_DETAIL.TAGS.ADD_BUTTON"),"\n"))}function V(B,$){if(1&B){const b=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){e.CHM(b);const J=e.oxw();return e.KtG(J.removeTags())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&B){const b=e.oxw();e.Q6J("disabled",0===b.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"RESOURCE_DETAIL.TAGS.REMOVE_BUTTON"),"\n")}}function W(B,$){1&B&&e._UZ(0,"mat-spinner",9)}function oe(B,$){if(1&B&&e._UZ(0,"app-resources-tags-list",10),2&B){const b=e.oxw();e.Q6J("displayedColumns",b.displayedColumns)("entity","resource")("resourceTags",b.resourceTags)("filterValue",b.filterValue)("selection",b.selection)("tableId",b.tableId)}}let ne=(()=>{class B{constructor(b,h,J,C,Y,k){this.authResolver=b,this.resourcesManager=h,this.dialog=J,this.notificator=C,this.translate=Y,this.entityStorageService=k,this.loading=!1,this.resourceTags=[],this.selection=new A.Ov(!0,[]),this.tableId=n.M8,this.displayedColumns=[]}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.setAuthRights(),this.updateData()}removeTags(){const b=(0,m.kZ)();b.width="450px",b.data={items:this.selection.selected.map(J=>J.tagName),title:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_TITLE",description:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_DESCRIPTION",theme:"resource-theme",type:"remove",showAsk:!0},this.dialog.open(s.Ts,b).afterClosed().subscribe(J=>{J&&this.resourcesManager.removeResourceTagsFromResource({resource:this.resource.id,resourceTags:this.selection.selected}).subscribe(()=>(this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.REMOVED_SUCCESSFULLY")),this.updateData()))})}addTag(){const b=(0,m.kZ)();b.width="600px",b.data={voId:this.resource.voId,resourceId:this.resource.id,assignedTags:this.resourceTags,theme:"resource-theme"},this.dialog.open(G,b).afterClosed().subscribe(J=>{J&&(this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.ADDED_SUCCESSFULLY")),this.updateData())})}create(){const b=(0,m.kZ)();b.width="450px",b.data={voId:this.resource.voId,theme:"resource-theme"},this.dialog.open(F.p,b).afterClosed().subscribe(J=>{J&&(this.notificator.showSuccess(this.translate.instant("VO_DETAIL.RESOURCES.TAGS.CREATE_SUCCESS")),this.updateData())})}updateData(){this.loading=!0,this.selection.clear(),this.resourcesManager.getAllResourcesTagsForResource(this.resource.id).subscribe(b=>{this.resourceTags=b,this.selection.clear(),this.loading=!1})}setAuthRights(){const b={id:this.resource.voId,beanName:"Vo"};this.displayedColumns=[],this.createAuth=this.authResolver.isAuthorized("createResourceTag_ResourceTag_Vo_policy",[b]),this.addAuth=this.authResolver.isAuthorized("assignResourceTagToResource_ResourceTag_Resource_policy",[this.resource]),this.removeAuth=this.authResolver.isAuthorized("removeResourceTagFromResource_ResourceTag_Resource_policy",[this.resource]),this.displayedColumns=this.removeAuth?["select","id","name"]:["id","name"]}applyFilter(b){this.filterValue=b}}return B.\u0275fac=function(b){return new(b||B)(e.Y36(R.x4),e.Y36(r.xk),e.Y36(t.uw),e.Y36(R.V6),e.Y36(R.Te),e.Y36(R.fb))},B.\u0275cmp=e.Xpm({type:B,selectors:[["app-perun-web-apps-resource-tags"]],decls:10,vars:9,consts:[[1,"page-subtitle"],[3,"refresh"],["class","mr-2 action-button","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"displayedColumns","entity","resourceTags","filterValue","selection","tableId",4,"ngIf"],["color","accent","mat-flat-button","",1,"mr-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"displayedColumns","entity","resourceTags","filterValue","selection","tableId"]],template:function(b,h){1&b&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){return h.updateData()}),e.qZA(),e.YNc(4,P,3,3,"button",2),e.YNc(5,L,3,3,"button",2),e.YNc(6,V,3,4,"button",3),e.TgZ(7,"perun-web-apps-immediate-filter",4),e.NdJ("filter",function(C){return h.applyFilter(C)}),e.qZA(),e.YNc(8,W,1,0,"mat-spinner",5),e.YNc(9,oe,1,6,"app-resources-tags-list",6)),2&b&&(e.xp6(1),e.Oqu(e.lcZ(2,7,"RESOURCE_DETAIL.TAGS.TITLE")),e.xp6(3),e.Q6J("ngIf",h.createAuth),e.xp6(1),e.Q6J("ngIf",h.addAuth),e.xp6(1),e.Q6J("ngIf",h.removeAuth),e.xp6(1),e.Q6J("placeholder","RESOURCE_DETAIL.TAGS.SEARCH"),e.xp6(1),e.Q6J("ngIf",h.loading),e.xp6(1),e.Q6J("ngIf",!h.loading))},dependencies:[Q.O5,K.lW,a.Ou,w.o,E.t,I.L,y.X$]}),B})()},83370:(te,j,o)=>{o.d(j,{u:()=>E});var r=o(94650),A=o(37433),n=o(36895),m=o(4859),R=o(65412),s=o(51572),t=o(86257),e=o(98380),Q=o(29926),K=o(89383);function a(I,P){1&I&&r._UZ(0,"mat-spinner",13)}function w(I,P){1&I&&(r.TgZ(0,"perun-web-apps-alert",16),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&I&&(r.Q6J("alert_type","info"),r.xp6(1),r.hij(" ",r.lcZ(2,2,"DIALOGS.ADD_BAN.ALREADY_BANNED")," "))}function y(I,P){if(1&I&&(r.TgZ(0,"div"),r.YNc(1,w,3,4,"perun-web-apps-alert",14),r._UZ(2,"perun-web-apps-ban-specification",15),r.qZA()),2&I){const L=r.oxw();r.xp6(1),r.Q6J("ngIf",L.ban),r.xp6(1),r.Q6J("description",null==L.ban?null:L.ban.description)("validity",null==L.ban?null:L.ban.validityTo)}}function U(I,P){if(1&I){const L=r.EpF();r.TgZ(0,"button",17),r.NdJ("click",function(){r.CHM(L),r.oxw();const W=r.MAs(6);return r.KtG(W.next())}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&I){const L=r.oxw();r.Q6J("disabled",L.disabled),r.xp6(1),r.hij(" ",r.lcZ(2,2,"DIALOGS.ADD_BAN.NEXT")," ")}}function H(I,P){if(1&I){const L=r.EpF();r.TgZ(0,"button",18),r.NdJ("click",function(){r.CHM(L),r.oxw();const W=r.MAs(6);return r.KtG(W.previous())}),r._uU(1),r.ALo(2,"translate"),r.qZA()}2&I&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"DIALOGS.ADD_BAN.BACK")," "))}function G(I,P){if(1&I){const L=r.EpF();r.TgZ(0,"button",19),r.NdJ("click",function(){r.CHM(L);const W=r.oxw();return r.KtG(W.addBan())}),r._uU(1),r.ALo(2,"translate"),r.qZA()}if(2&I){const L=r.oxw();r.xp6(1),r.hij(" ",r.lcZ(2,1,L.ban?"DIALOGS.ADD_BAN.UPDATE":"DIALOGS.ADD_BAN.ADD")," ")}}const F=["*"];let E=(()=>{class I{constructor(){this.loading=!1,this.disabled=!1,this.add=new r.vpe,this.cancel=new r.vpe}addBan(){this.add.emit({description:this.banForm.getDescription(),validity:this.banForm.getValidity()})}}return I.\u0275fac=function(L){return new(L||I)},I.\u0275cmp=r.Xpm({type:I,selectors:[["app-add-ban-dialog"]],viewQuery:function(L,V){if(1&L&&r.Gf(A.CZ,5),2&L){let W;r.iGM(W=r.CRH())&&(V.banForm=W.first)}},inputs:{loading:"loading",disabled:"disabled",theme:"theme",ban:"ban"},outputs:{add:"add",cancel:"cancel"},ngContentSelectors:F,decls:21,vars:22,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"linear"],["stepper",""],[3,"completed","label"],[3,"label"],["class","ml-auto mr-auto",4,"ngIf"],[4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto","mr-2",3,"click"],["mat-flat-button","","class","mr-2","color","accent",3,"disabled","click",4,"ngIf"],["mat-flat-button","","class","mr-2",3,"click",4,"ngIf"],["mat-flat-button","","color","accent",3,"click",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"alert_type",4,"ngIf"],[3,"description","validity"],[3,"alert_type"],["mat-flat-button","","color","accent",1,"mr-2",3,"disabled","click"],["mat-flat-button","",1,"mr-2",3,"click"],["mat-flat-button","","color","accent",3,"click"]],template:function(L,V){if(1&L&&(r.F$t(),r.TgZ(0,"div")(1,"h1",0),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"div",1)(5,"mat-stepper",2,3)(7,"mat-step",4),r.ALo(8,"translate"),r.Hsn(9),r.qZA(),r.TgZ(10,"mat-step",5),r.ALo(11,"translate"),r.YNc(12,a,1,0,"mat-spinner",6),r.YNc(13,y,3,3,"div",7),r.qZA()()(),r.TgZ(14,"div",8)(15,"button",9),r.NdJ("click",function(){return V.cancel.emit()}),r._uU(16),r.ALo(17,"translate"),r.qZA(),r.YNc(18,U,3,4,"button",10),r.YNc(19,H,3,3,"button",11),r.YNc(20,G,3,3,"button",12),r.qZA()()),2&L){const W=r.MAs(6);r.Tol(V.theme),r.xp6(2),r.Oqu(r.lcZ(3,14,"DIALOGS.ADD_BAN.TITLE")),r.xp6(3),r.Q6J("linear",!0),r.xp6(2),r.Q6J("completed",!V.disabled)("label",r.lcZ(8,16,"DIALOGS.ADD_BAN.SELECTION")),r.xp6(3),r.Q6J("label",r.lcZ(11,18,"DIALOGS.ADD_BAN.SPECIFICATION")),r.xp6(2),r.Q6J("ngIf",V.loading),r.xp6(1),r.Q6J("ngIf",!V.loading),r.xp6(3),r.hij(" ",r.lcZ(17,20,"DIALOGS.ADD_BAN.CANCEL")," "),r.xp6(2),r.Q6J("ngIf",W.selectedIndex!==(null==W||null==W._steps?null:W._steps.length)-1),r.xp6(1),r.Q6J("ngIf",W.selectedIndex===(null==W||null==W._steps?null:W._steps.length)-1),r.xp6(1),r.Q6J("ngIf",W.selectedIndex===(null==W||null==W._steps?null:W._steps.length)-1)}},dependencies:[n.O5,m.lW,R.uh,R.xY,R.H8,s.Ou,t.C0,t.Vq,e.w,Q.C,K.X$]}),I})()},17584:(te,j,o)=>{o.d(j,{p:()=>y});var r=o(65412),A=o(61744),n=o(94650),m=o(36895),R=o(59549),s=o(284),t=o(24006),e=o(4859),Q=o(51572),K=o(89383);function a(U,H){1&U&&n._UZ(0,"mat-spinner",6)}function w(U,H){if(1&U){const G=n.EpF();n.TgZ(0,"div",7)(1,"mat-form-field")(2,"input",8),n.NdJ("ngModelChange",function(E){n.CHM(G);const I=n.oxw();return n.KtG(I.name=E)}),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"mat-error"),n._uU(5),n.ALo(6,"translate"),n.qZA()()()}if(2&U){const G=n.oxw();n.xp6(2),n.s9C("placeholder",n.lcZ(3,3,"DIALOGS.CREATE_RESOURCE_TAG.NAME")),n.Q6J("ngModel",G.name),n.xp6(3),n.Oqu(n.lcZ(6,5,"DIALOGS.CREATE_RESOURCE_TAG.EMPTY_NAME"))}}let y=(()=>{class U{constructor(G,F,E){this.dialogRef=G,this.data=F,this.resourceManager=E,this.name="",this.loading=!1}ngOnInit(){this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){""!==this.name&&(this.loading=!0,this.resourceManager.createResourceTagWithTagName(this.name,this.data.voId).subscribe(()=>{this.dialogRef.close(!0)},()=>this.loading=!1))}}return U.\u0275fac=function(G){return new(G||U)(n.Y36(r.so),n.Y36(r.WI),n.Y36(A.xk))},U.\u0275cmp=n.Xpm({type:U,selectors:[["app-create-resource-tag-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","ml-auto mr-auto",4,"ngIf"],["class","dialog-container","mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content","",1,"dialog-container"],["matInput","","required","",3,"placeholder","ngModel","ngModelChange"]],template:function(G,F){1&G&&(n.TgZ(0,"div")(1,"h1",0),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.YNc(4,a,1,0,"mat-spinner",1),n.YNc(5,w,7,7,"div",2),n.TgZ(6,"div",3)(7,"button",4),n.NdJ("click",function(){return F.onCancel()}),n._uU(8),n.ALo(9,"translate"),n.qZA(),n.TgZ(10,"button",5),n.NdJ("click",function(){return F.onSubmit()}),n._uU(11),n.ALo(12,"translate"),n.qZA()()()),2&G&&(n.Tol(F.theme),n.xp6(2),n.Oqu(n.lcZ(3,9,"DIALOGS.CREATE_RESOURCE_TAG.TITLE")),n.xp6(2),n.Q6J("ngIf",F.loading),n.xp6(1),n.Q6J("ngIf",!F.loading),n.xp6(3),n.hij(" ",n.lcZ(9,11,"DIALOGS.CREATE_RESOURCE_TAG.CANCEL")," "),n.xp6(2),n.Q6J("disabled",F.loading),n.xp6(1),n.hij(" ",n.lcZ(12,13,"DIALOGS.CREATE_RESOURCE_TAG.CREATE")," "))},dependencies:[m.O5,R.TO,R.KE,s.Nt,t.Fj,t.JJ,t.Q7,t.On,e.lW,r.uh,r.xY,r.H8,Q.Ou,K.X$]}),U})()},28361:(te,j,o)=>{o.d(j,{s:()=>Pe});var r=o(95017),A=o(65412),n=o(81591),m=o(61744),R=o(10036),s=o(64080),t=o(24006),e=o(94650),Q=o(89383),K=o(94364),a=o(36895),w=o(3238),y=o(59549),U=o(284),H=o(4859),G=o(84385),F=o(51572),E=o(98380),I=o(22308),P=o(64877),L=o(23123);function V(l,O){if(1&l&&(e.TgZ(0,"mat-option",15),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&l){const i=O.$implicit;e.Q6J("value",i.roleName),e.xp6(1),e.hij(" ",e.lcZ(2,2,i)," ")}}function W(l,O){1&l&&e._UZ(0,"mat-spinner",16)}function oe(l,O){1&l&&(e.TgZ(0,"perun-web-apps-alert",20),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&l&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"DIALOGS.ADD_MANAGERS.NO_USERS_FOUND")," "))}const ne=function(){return["select","id","name","email","logins","organization"]};function B(l,O){if(1&l&&e._UZ(0,"app-users-list",21),2&l){const i=e.oxw(2);e.Q6J("disableRouting",!0)("selection",i.selection)("displayedColumns",e.DdM(5,ne))("tableId",i.tableId)("users",i.users)}}function $(l,O){if(1&l&&(e.TgZ(0,"div",17),e.YNc(1,oe,3,3,"perun-web-apps-alert",18),e.YNc(2,B,1,6,"app-users-list",19),e.qZA()),2&l){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",0===i.users.length&&i.firstSearchDone),e.xp6(1),e.Q6J("ngIf",0!==i.users.length)}}let b=(()=>{class l{constructor(i,d,x,ee,le,ce,ue,he,fe){this.dialogRef=i,this.data=d,this.authzService=x,this.usersService=ee,this.translate=le,this.notificator=ce,this.storeService=ue,this.route=he,this.router=fe,this.selection=new r.Ov(!0,[]),this.users=[],this.firstSearchDone=!1,this.tableId=R.H2,le.get("DIALOGS.ADD_MANAGERS.TITLE").subscribe(_e=>this.title=_e),le.get("DIALOGS.ADD_MANAGERS.SUCCESS").subscribe(_e=>this.successMessage=_e)}ngOnInit(){this.theme=this.data.theme,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.searchCtrl=new t.p4("",[t.kI.required,t.kI.pattern(".*[\\S]+.*")])}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.setRoleWithUserComplementaryObject({role:this.selectedRole,users:this.selection.selected.map(i=>i.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}onSearchByString(){if(this.searchCtrl.invalid)return void this.searchCtrl.markAllAsTouched();this.loading=!0,this.selection.clear();let i=[s.r.USER_DEF_ORGANIZATION,s.r.USER_DEF_PREFERRED_MAIL];i=i.concat(this.storeService.getLoginAttributeNames()),this.usersService.findRichUsersWithAttributes(this.searchCtrl.value,i).subscribe({next:d=>{this.users=d,this.loading=!1,this.firstSearchDone=!0},error:()=>this.loading=!1})}}return l.\u0275fac=function(i){return new(i||l)(e.Y36(A.so),e.Y36(A.WI),e.Y36(m.Ct),e.Y36(m.Fv),e.Y36(Q.sK),e.Y36(n.V6),e.Y36(n.d6),e.Y36(K.gz),e.Y36(K.F0))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-add-manager-dialog"]],decls:31,vars:31,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"mr-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"mr-2","w-100"],["matInput","","autocomplete","false","data-cy","search-manager-input","perunWebAppsAutoFocus","",3,"placeholder","formControl","keyup.enter"],["color","accent","data-cy","search-manager-button","mat-flat-button","",1,"ml-auto",3,"disabled","click"],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","data-cy","add-manager-button-dialog","mat-flat-button","",1,"ml-2",3,"disabled","click"],[3,"value"],[1,"mr-auto","ml-auto"],[1,"mt-3"],["alert_type","warn",4,"ngIf"],[3,"disableRouting","selection","displayedColumns","tableId","users",4,"ngIf"],["alert_type","warn"],[3,"disableRouting","selection","displayedColumns","tableId","users"]],template:function(i,d){1&i&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1)(5,"div",2)(6,"mat-form-field",3)(7,"mat-label"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"mat-select",4),e.NdJ("valueChange",function(ee){return d.selectedRole=ee}),e.YNc(11,V,3,4,"mat-option",5),e.qZA()(),e.TgZ(12,"mat-form-field",6)(13,"input",7),e.NdJ("keyup.enter",function(){return d.onSearchByString()}),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"mat-error"),e._uU(16),e.ALo(17,"translate"),e.qZA()()(),e.TgZ(18,"button",8),e.NdJ("click",function(){return d.onSearchByString()}),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"div",9),e.YNc(22,W,1,0,"mat-spinner",10),e.qZA(),e.YNc(23,$,3,2,"div",11),e.qZA(),e.TgZ(24,"div",12)(25,"button",13),e.NdJ("click",function(){return d.onCancel()}),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"button",14),e.NdJ("click",function(){return d.onSubmit()}),e._uU(29),e.ALo(30,"translate"),e.qZA()()()),2&i&&(e.Tol(d.theme),e.xp6(2),e.Oqu(e.lcZ(3,17,"DIALOGS.ADD_MANAGERS.TITLE")),e.xp6(6),e.Oqu(e.lcZ(9,19,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",d.selectedRole),e.xp6(1),e.Q6J("ngForOf",d.availableRoles),e.xp6(2),e.s9C("placeholder",e.lcZ(14,21,"DIALOGS.ADD_MANAGERS.DESCRIPTION")),e.Q6J("formControl",d.searchCtrl),e.xp6(3),e.hij(" ",e.lcZ(17,23,"DIALOGS.ADD_MANAGERS.EMPTY_SEARCH_MESSAGE")," "),e.xp6(2),e.Q6J("disabled",d.loading),e.xp6(1),e.hij(" ",e.lcZ(20,25,"DIALOGS.ADD_MANAGERS.SEARCH")," "),e.xp6(3),e.Q6J("ngIf",d.loading),e.xp6(1),e.Q6J("ngIf",null!==d.users&&!d.loading),e.xp6(3),e.hij(" ",e.lcZ(27,27,"DIALOGS.ADD_MANAGERS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",0===d.selection.selected.length||void 0===d.selectedRole||d.loading),e.xp6(1),e.hij(" ",e.lcZ(30,29,"DIALOGS.ADD_MANAGERS.CREATE")," "))},dependencies:[a.sg,a.O5,w.ey,y.TO,y.KE,y.hX,U.Nt,t.Fj,t.JJ,t.oH,H.lW,A.uh,A.xY,A.H8,G.gD,F.Ou,E.w,I.h,P.C,Q.X$,L.i],styles:[".inline-dialog-items[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]}),l})();var h=o(30671);function J(l,O){1&l&&e._UZ(0,"th",15)}function C(l,O){if(1&l&&(e.TgZ(0,"td",16),e._uU(1),e.qZA()),2&l){const i=O.$implicit;e.xp6(1),e.AsE("",i.firstName," ",i.lastName,"")}}function Y(l,O){1&l&&e._UZ(0,"tr",17)}function k(l,O){1&l&&e._UZ(0,"tr",18)}const X=function(l){return{role:l}};function se(l,O){if(1&l&&(e.TgZ(0,"perun-web-apps-alert",19),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"translate"),e.qZA()),2&l){const i=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,"DIALOGS.REMOVE_MANAGERS.WARNING_REMOVE_YOURSELF",e.VKq(6,X,e.lcZ(3,4,"ROLES."+i.data.role)))," ")}}function ae(l,O){if(1&l&&(e.TgZ(0,"div",6)(1,"p"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",7),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"table",8),e.ynx(8,9),e.YNc(9,J,1,0,"th",10),e.YNc(10,C,2,2,"td",11),e.BQk(),e.YNc(11,Y,1,0,"tr",12),e.YNc(12,k,1,0,"tr",13),e.qZA(),e.YNc(13,se,4,8,"perun-web-apps-alert",14),e.qZA()),2&l){const i=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,6,"DIALOGS.REMOVE_MANAGERS.DESCRIPTION")," "),e.xp6(3),e.hij(" ",e.lcZ(6,8,"DIALOGS.REMOVE_MANAGERS.ASK")," "),e.xp6(2),e.Q6J("dataSource",i.dataSource),e.xp6(4),e.Q6J("matHeaderRowDef",i.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",i.displayedColumns),e.xp6(1),e.Q6J("ngIf",i.removeSelf)}}function re(l,O){1&l&&e._UZ(0,"mat-spinner",20)}let M=(()=>{class l{constructor(i,d,x,ee,le,ce,ue){this.dialogRef=i,this.data=d,this.notificator=x,this.translate=ee,this.authzService=le,this.store=ce,this.authService=ue,this.displayedColumns=["name"]}ngOnInit(){this.dataSource=new h.by(this.data.managers),this.theme=this.data.theme,this.removeSelf=this.data.managers.map(i=>i.id).includes(this.store.getPerunPrincipal().userId)&&!this.authService.isPerunAdmin()}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithUserComplementaryObject({role:this.data.role,users:this.data.managers.map(i=>i.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_MANAGERS.SUCCESS").subscribe(i=>{this.notificator.showSuccess(i),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)},()=>this.loading=!1)}}return l.\u0275fac=function(i){return new(i||l)(e.Y36(A.so),e.Y36(A.WI),e.Y36(n.V6),e.Y36(Q.sK),e.Y36(m.Ct),e.Y36(n.d6),e.Y36(n.x4))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-remove-manager-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content","",4,"ngIf"],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","warn","data-cy","remove-manager-button-dialog","mat-flat-button","",1,"ml-2",3,"disabled","click"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""],["alert_type","warn"],[1,"mr-auto","ml-auto"]],template:function(i,d){1&i&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,ae,14,10,"div",1),e.YNc(5,re,1,0,"mat-spinner",2),e.TgZ(6,"div",3)(7,"button",4),e.NdJ("click",function(){return d.onCancel()}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",5),e.NdJ("click",function(){return d.onSubmit()}),e._uU(11),e.ALo(12,"translate"),e.qZA()()()),2&i&&(e.Tol(d.theme),e.xp6(2),e.Oqu(e.lcZ(3,9,"DIALOGS.REMOVE_MANAGERS.TITLE")),e.xp6(2),e.Q6J("ngIf",!d.loading),e.xp6(1),e.Q6J("ngIf",d.loading),e.xp6(3),e.hij(" ",e.lcZ(9,11,"DIALOGS.REMOVE_MANAGERS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",d.loading),e.xp6(1),e.hij(" ",e.lcZ(12,13,"DIALOGS.REMOVE_MANAGERS.DELETE")," "))},dependencies:[a.O5,H.lW,h.BZ,h.fO,h.as,h.w1,h.Dz,h.nj,h.ge,h.ev,h.XQ,h.Gk,A.uh,A.xY,A.H8,F.Ou,E.w,Q.X$]}),l})();function S(l,O){1&l&&e._UZ(0,"mat-spinner",6)}function p(l,O){1&l&&e._UZ(0,"th",15)}function _(l,O){if(1&l&&(e.TgZ(0,"td",16),e._uU(1),e.qZA()),2&l){const i=O.$implicit;e.xp6(1),e.Oqu(i.name)}}function u(l,O){1&l&&e._UZ(0,"tr",17)}function v(l,O){1&l&&e._UZ(0,"tr",18)}function f(l,O){if(1&l&&(e.TgZ(0,"div",7)(1,"p"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",8),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"table",9),e.ynx(8,10),e.YNc(9,p,1,0,"th",11),e.YNc(10,_,2,1,"td",12),e.BQk(),e.YNc(11,u,1,0,"tr",13),e.YNc(12,v,1,0,"tr",14),e.qZA()()),2&l){const i=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,5,"DIALOGS.REMOVE_GROUPS.DESCRIPTION")," "),e.xp6(3),e.hij(" ",e.lcZ(6,7,"DIALOGS.REMOVE_GROUPS.ASK")," "),e.xp6(2),e.Q6J("dataSource",i.dataSource),e.xp6(4),e.Q6J("matHeaderRowDef",i.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",i.displayedColumns)}}let D=(()=>{class l{constructor(i,d,x,ee,le){this.dialogRef=i,this.data=d,this.notificator=x,this.translate=ee,this.authzService=le,this.displayedColumns=["name"]}ngOnInit(){this.dataSource=new h.by(this.data.groups),this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithGroupComplementaryObject({role:this.data.role,authorizedGroups:this.data.groups.map(i=>i.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUPS.SUCCESS").subscribe(i=>{this.notificator.showSuccess(i),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)},()=>this.loading=!1)}}return l.\u0275fac=function(i){return new(i||l)(e.Y36(A.so),e.Y36(A.WI),e.Y36(n.V6),e.Y36(Q.sK),e.Y36(m.Ct))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-remove-group-manager-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","warn","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(i,d){1&i&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,S,1,0,"mat-spinner",1),e.YNc(5,f,13,9,"div",2),e.TgZ(6,"div",3)(7,"button",4),e.NdJ("click",function(){return d.onCancel()}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",5),e.NdJ("click",function(){return d.onSubmit()}),e._uU(11),e.ALo(12,"translate"),e.qZA()()()),2&i&&(e.Tol(d.theme),e.xp6(2),e.Oqu(e.lcZ(3,9,"DIALOGS.REMOVE_GROUPS.TITLE")),e.xp6(2),e.Q6J("ngIf",d.loading),e.xp6(1),e.Q6J("ngIf",!d.loading),e.xp6(3),e.hij(" ",e.lcZ(9,11,"DIALOGS.REMOVE_GROUPS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",d.loading),e.xp6(1),e.hij(" ",e.lcZ(12,13,"DIALOGS.REMOVE_GROUPS.DELETE")," "))},dependencies:[a.O5,H.lW,h.BZ,h.fO,h.as,h.w1,h.Dz,h.nj,h.ge,h.ev,h.XQ,h.Gk,A.uh,A.xY,A.H8,F.Ou,Q.X$]}),l})();var g=o(68675),N=o(54004),c=o(47957),T=o(25788),Z=o(64901);function q(l,O){if(1&l&&(e.TgZ(0,"mat-option",17),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&l){const i=O.$implicit;e.Q6J("value",i.roleName),e.xp6(1),e.hij(" ",e.lcZ(2,2,i)," ")}}function z(l,O){if(1&l&&(e.TgZ(0,"mat-option",17),e._uU(1),e.qZA()),2&l){const i=O.$implicit;e.Q6J("value",i),e.xp6(1),e.hij(" ",i.name," ")}}function ie(l,O){if(1&l){const i=e.EpF();e.TgZ(0,"perun-web-apps-debounce-filter",18),e.NdJ("filter",function(x){e.CHM(i);const ee=e.oxw();return e.KtG(ee.applyFilter(x))}),e.ALo(1,"translate"),e.qZA()}2&l&&e.s9C("placeholder",e.lcZ(1,1,"DIALOGS.ADD_GROUPS.FILTER_GROUPS"))}function pe(l,O){1&l&&e._UZ(0,"mat-spinner",19)}const ge=function(){return["select","id","name","description"]};function Ae(l,O){if(1&l&&(e.TgZ(0,"div",20),e._UZ(1,"perun-web-apps-groups-list",21),e.qZA()),2&l){const i=e.oxw();e.xp6(1),e.Q6J("disableMembers",!1)("disableRouting",!0)("displayedColumns",e.DdM(7,ge))("selection",i.selection)("groups",i.groups)("filter",i.filterValue)("tableId",i.tableId)}}let Re=(()=>{class l{constructor(i,d,x,ee,le,ce,ue,he,fe){this.dialogRef=i,this.data=d,this.authzService=x,this.voService=ee,this.groupService=le,this.translate=ce,this.notificator=ue,this.route=he,this.router=fe,this.searchString="",this.selection=new r.Ov(!0,[]),this.groups=[],this.vos=[],this.filterValue="",this.myControl=new t.p4,this.firstSearchDone=!1,this.tableId=R.kZ,ce.get("DIALOGS.ADD_GROUPS.TITLE").subscribe(_e=>this.title=_e),ce.get("DIALOGS.ADD_GROUPS.SUCCESS").subscribe(_e=>this.successMessage=_e)}displayFn(i){return i?i.name:null}onCancel(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.authzService.setRoleWithGroupComplementaryObject({role:this.selectedRole,authorizedGroups:this.selection.selected.map(i=>i.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}ngOnInit(){this.loading=!0,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.theme=this.data.theme,this.voService.getMyVos().subscribe({next:i=>{this.filteredOptions=this.myControl.valueChanges.pipe((0,g.O)(""),(0,N.U)(d=>this._filter(d))),this.vos=i,this.loading=!1},error:()=>this.loading=!1})}showVoGroups(i){this.loading=!0,this.groupService.getAllGroups(i.option.value.id).subscribe({next:d=>{this.groups=d,this.loading=!1,this.firstSearchDone=!0},error:()=>this.loading=!1})}applyFilter(i){this.filterValue=i}_filter(i){const d="string"==typeof i?i.toLowerCase():i.name.toLowerCase();return this.vos.filter(x=>x.name.toLowerCase().includes(d))}}return l.\u0275fac=function(i){return new(i||l)(e.Y36(A.so),e.Y36(A.WI),e.Y36(m.Ct),e.Y36(m.YF),e.Y36(m.ff),e.Y36(Q.sK),e.Y36(n.V6),e.Y36(K.gz),e.Y36(K.F0))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-add-group-manager-dialog"]],decls:33,vars:33,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"mr-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"mr-2","w-75"],["aria-label","Assignee","matInput","","type","text",3,"formControl","matAutocomplete","placeholder"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"placeholder","filter",4,"ngIf"],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],[3,"value"],[3,"placeholder","filter"],[1,"mr-auto","ml-auto"],[1,"mt-3"],[3,"disableMembers","disableRouting","displayedColumns","selection","groups","filter","tableId"]],template:function(i,d){if(1&i&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1)(5,"div",2)(6,"mat-form-field",3)(7,"mat-label"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"mat-select",4),e.NdJ("valueChange",function(ee){return d.selectedRole=ee}),e.YNc(11,q,3,4,"mat-option",5),e.qZA()(),e.TgZ(12,"mat-form-field",6)(13,"mat-label"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e._UZ(16,"input",7),e.ALo(17,"translate"),e.TgZ(18,"mat-autocomplete",8,9),e.NdJ("optionSelected",function(ee){return d.showVoGroups(ee)}),e.YNc(20,z,2,2,"mat-option",5),e.ALo(21,"async"),e.qZA()()(),e.YNc(22,ie,2,3,"perun-web-apps-debounce-filter",10),e.TgZ(23,"div",11),e.YNc(24,pe,1,0,"mat-spinner",12),e.qZA(),e.YNc(25,Ae,2,8,"div",13),e.qZA(),e.TgZ(26,"div",14)(27,"button",15),e.NdJ("click",function(){return d.onCancel()}),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"button",16),e.NdJ("click",function(){return d.onSubmit()}),e._uU(31),e.ALo(32,"translate"),e.qZA()()()),2&i){const x=e.MAs(19);e.Tol(d.theme),e.xp6(2),e.Oqu(e.lcZ(3,19,"DIALOGS.ADD_GROUPS.TITLE")),e.xp6(6),e.Oqu(e.lcZ(9,21,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",d.selectedRole),e.xp6(1),e.Q6J("ngForOf",d.availableRoles),e.xp6(3),e.Oqu(e.lcZ(15,23,"DIALOGS.ADD_GROUPS.SELECT_VO")),e.xp6(2),e.s9C("placeholder",e.lcZ(17,25,"DIALOGS.ADD_GROUPS.SELECT_VO")),e.Q6J("formControl",d.myControl)("matAutocomplete",x),e.xp6(2),e.Q6J("displayWith",d.displayFn),e.xp6(2),e.Q6J("ngForOf",e.lcZ(21,27,d.filteredOptions)),e.xp6(2),e.Q6J("ngIf",null!==d.groups&&d.groups.length>0&&!d.loading),e.xp6(2),e.Q6J("ngIf",d.loading),e.xp6(1),e.Q6J("ngIf",null!==d.groups&&!d.loading),e.xp6(3),e.hij(" ",e.lcZ(29,29,"DIALOGS.ADD_MANAGERS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",0===d.selection.selected.length||d.loading),e.xp6(1),e.hij(" ",e.lcZ(32,31,"DIALOGS.ADD_MANAGERS.CREATE")," ")}},dependencies:[a.sg,a.O5,c.XC,c.ZL,w.ey,y.KE,y.hX,U.Nt,t.Fj,t.JJ,t.oH,H.lW,A.uh,A.xY,A.H8,G.gD,F.Ou,T.W,Z.P,a.Ov,Q.X$,L.i]}),l})();var de=o(9244),Ee=o(15003),me=o(3848),Te=o(96214);function be(l,O){1&l&&(e._uU(0),e.ALo(1,"translate")),2&l&&e.hij(" ",e.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.USER")," ")}function Ce(l,O){if(1&l){const i=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(i);const x=e.oxw(2);return e.KtG(x.addManager())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&l&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function ve(l,O){if(1&l){const i=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(i);const x=e.oxw(2);return e.KtG(x.removeManager())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&l){const i=e.oxw(2);e.Q6J("disabled",0===i.selectionUsers.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function Se(l,O){if(1&l&&(e.TgZ(0,"mat-option",15),e.ALo(1,"lowercase"),e._uU(2),e.ALo(3,"displayedRole"),e.qZA()),2&l){const i=O.$implicit;e.Q6J("value",i.roleName),e.uIk("data-cy",e.lcZ(1,3,i.roleName)),e.xp6(2),e.hij(" ",e.lcZ(3,5,i)," ")}}function Oe(l,O){1&l&&e._UZ(0,"mat-spinner",16)}function Ie(l,O){if(1&l&&e._UZ(0,"app-users-list",17),2&l){const i=e.oxw(2);e.Q6J("disableSelf",i.disableSelf)("tableId",i.tableId)("disableRouting",!i.routeAuth||i.disableRouting)("displayedColumns",i.displayedUserColumns)("selection",i.selectionUsers)("users",i.managers)}}function De(l,O){if(1&l){const i=e.EpF();e.TgZ(0,"perun-web-apps-refresh-button",5),e.NdJ("refresh",function(){e.CHM(i);const x=e.oxw();return e.KtG(x.refreshUsers())}),e.qZA(),e.YNc(1,Ce,3,3,"button",6),e.YNc(2,ve,3,4,"button",7),e.TgZ(3,"mat-form-field",8)(4,"mat-label"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"mat-select",9),e.NdJ("selectionChange",function(){e.CHM(i);const x=e.oxw();return e.KtG(x.refreshUsers())})("valueChange",function(x){e.CHM(i);const ee=e.oxw();return e.KtG(ee.selectedRole=x)}),e.YNc(8,Se,4,7,"mat-option",10),e.qZA()(),e.YNc(9,Oe,1,0,"mat-spinner",11),e.YNc(10,Ie,1,6,"app-users-list",12)}if(2&l){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.manageAuth&&!i.configMode),e.xp6(1),e.Q6J("ngIf",i.manageAuth&&!i.configMode),e.xp6(3),e.Oqu(e.lcZ(6,7,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",i.selectedRole),e.xp6(1),e.Q6J("ngForOf",i.availableRoles),e.xp6(1),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading&&i.managers)}}function Me(l,O){1&l&&(e._uU(0),e.ALo(1,"translate")),2&l&&e.hij(" ",e.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.GROUP")," ")}function xe(l,O){if(1&l){const i=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(i);const x=e.oxw(2);return e.KtG(x.addGroup())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&l&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function Ze(l,O){if(1&l){const i=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(i);const x=e.oxw(2);return e.KtG(x.removeGroup())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&l){const i=e.oxw(2);e.Q6J("disabled",0===i.selectionGroups.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function ye(l,O){if(1&l&&(e.TgZ(0,"mat-option",15),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&l){const i=O.$implicit;e.Q6J("value",i.roleName),e.xp6(1),e.Oqu(e.lcZ(2,2,i))}}function Ue(l,O){1&l&&e._UZ(0,"mat-spinner",16)}function Le(l,O){if(1&l&&e._UZ(0,"perun-web-apps-groups-list",24),2&l){const i=e.oxw(2);e.Q6J("disableMembers",!1)("disableRouting",i.disableRouting)("displayedColumns",i.displayedGroupColumns)("groups",i.groups)("selection",i.selectionGroups)("tableId",i.tableId)}}function Ge(l,O){if(1&l){const i=e.EpF();e.TgZ(0,"perun-web-apps-refresh-button",5),e.NdJ("refresh",function(){e.CHM(i);const x=e.oxw();return e.KtG(x.refreshGroups())}),e.qZA(),e.YNc(1,xe,3,3,"button",18),e.YNc(2,Ze,3,4,"button",19),e.TgZ(3,"mat-form-field",20)(4,"mat-label"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"mat-select",9),e.NdJ("selectionChange",function(){e.CHM(i);const x=e.oxw();return e.KtG(x.refreshGroups())})("valueChange",function(x){e.CHM(i);const ee=e.oxw();return e.KtG(ee.selectedRole=x)}),e.YNc(8,ye,3,4,"mat-option",10),e.qZA()(),e.YNc(9,Ue,1,0,"mat-spinner",11),e.YNc(10,Le,1,6,"perun-web-apps-groups-list",21)}if(2&l){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.manageAuth&&!i.configMode),e.xp6(1),e.Q6J("ngIf",i.manageAuth&&!i.configMode),e.xp6(3),e.Oqu(e.lcZ(6,7,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",i.selectedRole),e.xp6(1),e.Q6J("ngForOf",i.availableRoles),e.xp6(1),e.Q6J("ngIf",i.loading),e.xp6(1),e.Q6J("ngIf",!i.loading&&i.groups)}}function Ne(l,O){1&l&&(e.TgZ(0,"perun-web-apps-alert",25),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&l&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.NO_AVAILABLE_ROLES"),"\n"))}let Pe=(()=>{class l{constructor(i,d,x,ee,le,ce,ue){this.dialog=i,this.authzService=d,this.storeService=x,this.guiAuthResolver=ee,this.router=le,this.reloadEntityDetail=ce,this.route=ue,this.configMode=!1,this.disableRouting=!1,this.disableSelf=!1,this.displayedUserColumns=["select","id","name","email","logins","organization"],this.displayedGroupColumns=["select","id","vo","name","description"],this.groups=[],this.managers=null,this.selectionUsers=new r.Ov(!0,[]),this.selectionGroups=new r.Ov(!0,[]),this.selectedMode="",this.loading=!1,this.tableId=R.HC,this.availableRolesPrivileges=new Map}ngOnInit(){this.loading=!0,this.routeAuth=this.guiAuthResolver.isPerunAdminOrObserver(),this.guiAuthResolver.setRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(i=>this.availableRolesPrivileges.get(i.roleName).readAuth),0!==this.availableRoles.length&&(this.selectedRole=this.availableRoles[0].roleName),this.refreshUsers()}changeRolePrivileges(){this.guiAuthResolver.setRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(d=>this.availableRolesPrivileges.get(d.roleName).readAuth),this.manageAuth=this.availableRolesPrivileges.get(this.selectedRole).manageAuth,this.displayedUserColumns=this.manageAuth?this.displayedUserColumns:this.displayedUserColumns.filter(d=>"select"!==d),this.displayedGroupColumns=this.manageAuth?this.displayedGroupColumns:this.displayedGroupColumns.filter(d=>"select"!==d),this.roleModes=this.availableRolesPrivileges.get(this.selectedRole).modes;let i=!1;for(const d of this.roleModes)if(this.selectedMode===d.toLowerCase()){i=!0;break}i||(this.selectedMode=this.roleModes[0].toLowerCase())}tabChanged(i){this.loading=!0,0===i.index?(this.selectedMode="user",this.refreshUsers()):(this.selectedMode="group",this.refreshGroups())}refreshUsers(){this.loading=!0,this.changeRolePrivileges();let i=[s.r.USER_DEF_ORGANIZATION,s.r.USER_DEF_PREFERRED_MAIL];i=i.concat(this.storeService.getLoginAttributeNames()),this.authzService.getAuthzRichAdmins(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType,i,!1,!0).subscribe({next:d=>{this.managers=d,this.selectionUsers.clear(),this.loading=!1},error:()=>{this.loading=!1}})}refreshGroups(){this.loading=!0,this.changeRolePrivileges(),this.authzService.getAuthzAdminGroups(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType).subscribe({next:i=>{this.groups=i,this.selectionGroups.clear(),this.loading=!1},error:()=>{this.loading=!1}})}addManager(){const i=(0,de.kZ)();i.width="1000px",i.data={complementaryObject:this.complementaryObject,theme:this.theme,availableRoles:this.availableRoles,selectedRole:this.selectedRole},this.dialog.open(b,i).afterClosed().subscribe(x=>{x&&this.refreshUsers()})}removeManager(){const i=(0,de.kZ)();i.width="450px",i.data={managers:this.selectionUsers.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(M,i).afterClosed().subscribe(x=>{x&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?this.reloadEntityDetail.reloadEntityDetail():this.redirectToAuthRoute())})}removeGroup(){const i=(0,de.kZ)();i.width="450px",i.data={groups:this.selectionGroups.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(D,i).afterClosed().subscribe(x=>{x&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?this.refreshGroups():this.redirectToAuthRoute())})}addGroup(){const i=(0,de.kZ)();i.width="1000px",i.data={complementaryObject:this.complementaryObject,availableRoles:this.availableRoles,theme:this.theme,selectedRole:this.selectedRole},this.dialog.open(Re,i).afterClosed().subscribe(x=>{x&&this.refreshGroups()})}redirectToAuthRoute(){if("Group"===this.complementaryObjectType&&(this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])||this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])))this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])?this.router.navigate(["/organizations",this.complementaryObject.voId,"groups",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"}):this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])&&this.router.navigate(["/organizations",this.complementaryObject.voId],{queryParamsHandling:"merge"});else if("Facility"===this.complementaryObjectType&&this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.complementaryObject]))this.router.navigate(["/facilities",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else if("Vo"===this.complementaryObjectType&&this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject]))this.router.navigate(["/organizations",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else{if("Resource"!==this.complementaryObjectType||!this.guiAuthResolver.isAuthorized("getRichResourceById_int_policy",[this.complementaryObject]))return void this.router.navigate(["/home"],{queryParamsHandling:"merge"});this.router.navigate(["../../"],{relativeTo:this.route,queryParamsHandling:"merge"})}this.reloadEntityDetail.reloadEntityDetail()}}return l.\u0275fac=function(i){return new(i||l)(e.Y36(A.uw),e.Y36(m.Ct),e.Y36(n.d6),e.Y36(n.x4),e.Y36(K.F0),e.Y36(Ee.G),e.Y36(K.gz))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-managers-page"]],hostVars:2,hostBindings:function(i,d){2&i&&e.ekj("router-component",d.true)},inputs:{complementaryObject:"complementaryObject",availableRoles:"availableRoles",complementaryObjectType:"complementaryObjectType",theme:"theme",configMode:"configMode",disableRouting:"disableRouting",disableSelf:"disableSelf",displayedUserColumns:"displayedUserColumns",displayedGroupColumns:"displayedGroupColumns"},decls:11,vars:4,consts:[[1,"page-subtitle"],[3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["alert_type","warn",4,"ngIf"],[1,"mt-2",3,"refresh"],["color","accent","class","mr-2 mt-2 action-button","data-cy","add-manager-button","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","data-cy","remove-manager-button","class","mr-2 mt-2","mat-flat-button","",3,"disabled","click",4,"ngIf"],["data-cy","role-filter",1,"mr-2","mt-2"],[3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],["class","ml-auto mr-auto",4,"ngIf"],[3,"disableSelf","tableId","disableRouting","displayedColumns","selection","users",4,"ngIf"],["color","accent","data-cy","add-manager-button","mat-flat-button","",1,"mr-2","mt-2","action-button",3,"click"],["color","warn","data-cy","remove-manager-button","mat-flat-button","",1,"mr-2","mt-2",3,"disabled","click"],[3,"value"],[1,"ml-auto","mr-auto"],[3,"disableSelf","tableId","disableRouting","displayedColumns","selection","users"],["color","accent","class","mr-2 mt-2 action-button","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-2 mt-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[1,"mr-2","mt-2"],[3,"disableMembers","disableRouting","displayedColumns","groups","selection","tableId",4,"ngIf"],["color","accent","mat-flat-button","",1,"mr-2","mt-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"mr-2","mt-2",3,"disabled","click"],[3,"disableMembers","disableRouting","displayedColumns","groups","selection","tableId"],["alert_type","warn"]],template:function(i,d){1&i&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"mat-tab-group",1),e.NdJ("selectedTabChange",function(ee){return d.tabChanged(ee)}),e.TgZ(4,"mat-tab"),e.YNc(5,be,2,3,"ng-template",2),e.YNc(6,De,11,9,"ng-template",3),e.qZA(),e.TgZ(7,"mat-tab"),e.YNc(8,Me,2,3,"ng-template",2),e.YNc(9,Ge,11,9,"ng-template",3),e.qZA()(),e.YNc(10,Ne,3,3,"perun-web-apps-alert",4)),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.TITLE"),"\n"),e.xp6(9),e.Q6J("ngIf",0===d.availableRoles.length))},dependencies:[a.sg,a.O5,w.ey,y.KE,y.hX,H.lW,me.SP,me.uD,me.uX,me.Vc,G.gD,F.Ou,E.w,T.W,Te.t,P.C,a.i8,Q.X$,L.i]}),l})()},17672:(te,j,o)=>{o.d(j,{o:()=>_});var r=o(96308),A=o(30671),n=o(95017),m=o(81591),R=o(61744),s=o(9244),t=o(94650),e=o(89383),Q=o(36895),K=o(59549),a=o(284),w=o(24006),y=o(97392),U=o(4859),H=o(56709),G=o(10266),F=o(98380),E=o(18750),I=o(9185),P=o(8231),L=o(14849);function V(u,v){if(1&u){const f=t.EpF();t.TgZ(0,"th",17)(1,"mat-checkbox",18),t.NdJ("change",function(g){t.CHM(f);const N=t.oxw(2);return t.KtG(g?N.masterToggle():null)}),t.ALo(2,"translate"),t.ALo(3,"masterCheckboxLabel"),t.qZA()()}if(2&u){const f=t.oxw().ngIf,D=t.oxw();t.xp6(1),t.Q6J("aria-label",t.lcZ(2,3,t.lcZ(3,5,f.all)))("checked",D.selection.hasValue()&&f.all)("indeterminate",D.selection.hasValue()&&!f.all)}}const W=function(u){return{name:u}};function oe(u,v){if(1&u){const f=t.EpF();t.TgZ(0,"td",19)(1,"mat-checkbox",20),t.NdJ("change",function(g){const c=t.CHM(f).$implicit,T=t.oxw(2);return t.KtG(g?T.selection.toggle(c):null)})("click",function(g){return g.stopPropagation()}),t.ALo(2,"translate"),t.ALo(3,"checkboxLabel"),t.qZA()()}if(2&u){const f=v.$implicit,D=t.oxw(2);t.xp6(1),t.Q6J("aria-label",t.xi3(2,2,t.lcZ(3,5,D.selection.isSelected(f)),t.VKq(7,W,f.tagName)))("checked",D.selection.isSelected(f))}}function ne(u,v){1&u&&(t.ynx(0,14),t.YNc(1,V,4,7,"th",15),t.YNc(2,oe,4,9,"td",16),t.BQk())}function B(u,v){1&u&&(t.TgZ(0,"th",21),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&u&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_ID")," "))}function $(u,v){if(1&u&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&u){const f=v.$implicit;t.xp6(1),t.Oqu(f.id)}}function b(u,v){1&u&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&u&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_NAME")," "))}function h(u,v){if(1&u&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&u){const f=t.oxw().$implicit;t.xp6(1),t.hij(" ",f.tagName," ")}}function J(u,v){if(1&u){const f=t.EpF();t.TgZ(0,"div")(1,"mat-form-field")(2,"input",26),t.NdJ("ngModelChange",function(g){t.CHM(f);const N=t.oxw().$implicit;return t.KtG(N.tagName=g)}),t.qZA()()()}if(2&u){const f=t.oxw().$implicit;t.xp6(2),t.Q6J("ngModel",f.tagName)}}function C(u,v){if(1&u&&(t.TgZ(0,"td",24),t.YNc(1,h,2,1,"div",25),t.YNc(2,J,3,1,"div",25),t.qZA()),2&u){const f=v.$implicit,D=t.oxw();t.xp6(1),t.Q6J("ngIf",!D.isChanging.isSelected(f)),t.xp6(1),t.Q6J("ngIf",D.isChanging.isSelected(f))}}function Y(u,v){1&u&&t._UZ(0,"th",23)}function k(u,v){if(1&u){const f=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(f);const g=t.oxw().$implicit,N=t.oxw();return t.KtG(N.edit(g))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()()}2&u&&t.s9C("matTooltip",t.lcZ(1,1,"VO_DETAIL.RESOURCES.TAGS.EDIT_BUTTON"))}function X(u,v){if(1&u){const f=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(f);const g=t.oxw().$implicit,N=t.oxw();return t.KtG(N.save(g))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"save"),t.qZA()()}2&u&&t.s9C("matTooltip",t.lcZ(1,1,"VO_DETAIL.RESOURCES.TAGS.SAVE_BUTTON"))}function se(u,v){if(1&u&&(t.TgZ(0,"td",24)(1,"div",27),t.YNc(2,k,4,3,"button",28),t.YNc(3,X,4,3,"button",28),t.qZA()()),2&u){const f=v.$implicit,D=t.oxw();t.xp6(2),t.Q6J("ngIf",!D.isChanging.isSelected(f)),t.xp6(1),t.Q6J("ngIf",D.isChanging.isSelected(f))}}function ae(u,v){1&u&&t._UZ(0,"tr",30)}function re(u,v){1&u&&t._UZ(0,"tr",31)}function M(u,v){if(1&u&&(t.TgZ(0,"perun-web-apps-alert",32),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&u){const f=t.oxw();t.xp6(1),t.hij(" ","vo"===f.entity?t.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.NO_TAGS"):t.lcZ(3,3,"RESOURCE_DETAIL.TAGS.NO_TAGS"),"\n")}}function S(u,v){1&u&&(t.TgZ(0,"perun-web-apps-alert",32),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&u&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}const p=function(u){return{all:u}};let _=(()=>{class u{constructor(f,D,g,N,c){this.resourceManager=f,this.notificator=D,this.translator=g,this.authResolver=N,this.tableCheckbox=c,this.resourceTags=[],this.selection=new n.Ov(!0,[]),this.displayedColumns=["select","id","name","edit"],this.isChanging=new n.Ov(!0,[]),this.pageSizeOptions=s.f7}set matSort(f){this.sort=f,this.setDataSource()}static getDataForColumn(f,D){switch(D){case"id":return f.id.toString();case"name":return f.tagName;default:return""}}ngOnChanges(){this.authResolver.isPerunAdminOrObserver()||(this.displayedColumns=this.displayedColumns.filter(f=>"id"!==f)),this.dataSource=new A.by(this.resourceTags),this.setDataSource()}ngAfterViewInit(){this.dataSource.paginator=this.child.paginator}exportAllData(f){(0,s.O6)((0,s.Xn)(this.dataSource.filteredData,this.displayedColumns,u.getDataForColumn),f)}exportDisplayedData(f){const D=this.dataSource.paginator.pageIndex*this.dataSource.paginator.pageSize,g=D+this.dataSource.paginator.pageSize;(0,s.O6)((0,s.Xn)(this.dataSource.sortData(this.dataSource.filteredData,this.dataSource.sort).slice(D,g),this.displayedColumns,u.getDataForColumn),f)}setDataSource(){this.dataSource&&(this.dataSource.filterPredicate=(f,D)=>(0,s.Sd)(f,D,this.displayedColumns,u.getDataForColumn),this.dataSource.sortData=(f,D)=>(0,s.pR)(f,D,u.getDataForColumn),this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue)}isAllSelected(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.dataSource)}masterToggle(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}save(f){this.resourceManager.updateResourceTag({resourceTag:f}).subscribe(()=>{this.translator.get("SHARED.COMPONENTS.RESOURCES_TAGS_LIST.EDIT_SUCCESS").subscribe(D=>{this.notificator.showSuccess(D)}),this.isChanging.deselect(f)})}edit(f){this.isChanging.select(f)}}return u.\u0275fac=function(f){return new(f||u)(t.Y36(R.xk),t.Y36(m.V6),t.Y36(e.sK),t.Y36(m.x4),t.Y36(m.UA))},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-resources-tags-list"]],viewQuery:function(f,D){if(1&f&&(t.Gf(s.l9,7),t.Gf(r.YE,7)),2&f){let g;t.iGM(g=t.CRH())&&(D.child=g.first),t.iGM(g=t.CRH())&&(D.matSort=g.first)}},inputs:{resourceTags:"resourceTags",filterValue:"filterValue",selection:"selection",tableId:"tableId",displayedColumns:"displayedColumns",entity:"entity"},features:[t.TTD],decls:18,vars:15,consts:[[1,"card","mt-2",3,"hidden"],[3,"pageSizeOptions","dataLength","tableId","exportDisplayedData","exportAllData"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select",4,"ngIf"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","edit"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["matColumnDef","select"],["class","align-checkbox","mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size align-checkbox","mat-cell","",4,"matCellDef"],["mat-header-cell","",1,"align-checkbox"],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size","align-checkbox"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"static-column-size"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],["matInput","",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-end"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","",3,"matTooltip","click"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"],["alert_type","warn"]],template:function(f,D){1&f&&(t.TgZ(0,"div",0)(1,"perun-web-apps-table-wrapper",1),t.NdJ("exportDisplayedData",function(N){return D.exportDisplayedData(N)})("exportAllData",function(N){return D.exportAllData(N)}),t.TgZ(2,"table",2),t.YNc(3,ne,3,0,"ng-container",3),t.ALo(4,"isAllSelected"),t.ynx(5,4),t.YNc(6,B,3,3,"th",5),t.YNc(7,$,2,1,"td",6),t.BQk(),t.ynx(8,7),t.YNc(9,b,3,3,"th",8),t.YNc(10,C,3,2,"td",9),t.BQk(),t.ynx(11,10),t.YNc(12,Y,1,0,"th",8),t.YNc(13,se,4,2,"td",9),t.BQk(),t.YNc(14,ae,1,0,"tr",11),t.YNc(15,re,1,0,"tr",12),t.qZA()()(),t.YNc(16,M,4,5,"perun-web-apps-alert",13),t.YNc(17,S,3,3,"perun-web-apps-alert",13)),2&f&&(t.Q6J("hidden",0===D.resourceTags.length||0===D.dataSource.filteredData.length),t.xp6(1),t.Q6J("pageSizeOptions",D.pageSizeOptions)("dataLength",D.dataSource.filteredData.length)("tableId",D.tableId),t.xp6(1),t.Q6J("dataSource",D.dataSource),t.xp6(1),t.Q6J("ngIf",t.VKq(13,p,t.xi3(4,10,D.dataSource,D.selection.selected.length))),t.xp6(11),t.Q6J("matHeaderRowDef",D.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",D.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===D.resourceTags.length),t.xp6(1),t.Q6J("ngIf",0===D.dataSource.filteredData.length&&0!==D.resourceTags.length))},dependencies:[Q.O5,K.KE,a.Nt,w.Fj,w.JJ,w.On,y.Hw,U.lW,r.YE,r.nU,A.BZ,A.fO,A.as,A.w1,A.Dz,A.nj,A.ge,A.ev,A.XQ,A.Gk,H.oG,G.gM,F.w,E.l,e.X$,I.I,P.G,L.r]}),u})()},22158:(te,j,o)=>{o.d(j,{T:()=>A});var r=o(77579);const A=(n=class{})=>class extends n{constructor(){super(...arguments),this.destroyed$=new r.x}ngOnDestroy(){this.destroyed$.next()}}},90439:(te,j,o)=>{o.d(j,{F:()=>m});var r=o(94650),A=o(89593),n=o(89383);let m=(()=>{class R{constructor(){this.servicePackages=[],this.selectedPackage=null,this.multiple=!1,this.disableAutoSelect=!1,this.theme="",this.packageSelected=new r.vpe,this.nameFunction=t=>t.name,this.shortNameFunction=t=>t.description,this.searchFunction=t=>t.name+t.description}}return R.\u0275fac=function(t){return new(t||R)},R.\u0275cmp=r.Xpm({type:R,selectors:[["perun-web-apps-service-package-search-select"]],inputs:{servicePackages:"servicePackages",selectedPackage:"selectedPackage",multiple:"multiple",disableAutoSelect:"disableAutoSelect",theme:"theme"},outputs:{packageSelected:"packageSelected"},decls:4,vars:17,consts:[[3,"entities","entity","multiple","disableAutoSelect","searchFunction","mainTextFunction","secondaryTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","theme","entitySelected"]],template:function(t,e){1&t&&(r.TgZ(0,"perun-web-apps-entity-search-select",0),r.NdJ("entitySelected",function(K){return e.packageSelected.emit(K)}),r.ALo(1,"translate"),r.ALo(2,"translate"),r.ALo(3,"translate"),r.qZA()),2&t&&r.Q6J("entities",e.servicePackages)("entity",e.selectedPackage)("multiple",e.multiple)("disableAutoSelect",e.disableAutoSelect)("searchFunction",e.searchFunction)("mainTextFunction",e.nameFunction)("secondaryTextFunction",e.shortNameFunction)("selectPlaceholder",r.lcZ(1,11,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.SELECT_PACKAGE"))("findPlaceholder",r.lcZ(2,13,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.FIND_PACKAGE"))("noEntriesText",r.lcZ(3,15,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.NO_PACKAGE_FOUND"))("theme",e.theme)},dependencies:[A.i,n.X$]}),R})()}}]);