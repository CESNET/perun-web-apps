!function(){function e(e,i){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,i){if(!e)return;if("string"==typeof e)return t(e,i);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,i)}(e))||i&&e&&"number"==typeof e.length){n&&(e=n);var a=0,s=function(){};return{s:s,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){l=!0,o=e},f:function(){try{r||null==n.return||n.return()}finally{if(l)throw o}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}(self.webpackChunkperun_web_apps=self.webpackChunkperun_web_apps||[]).push([[827],{95142:function(e,t,n){"use strict";n.d(t,{y:function(){return S}});var s=n(65249),o=n(60611),r=n(68416),l=n(31572),c=n(57629),u=n(59403),d=n(91058),g=n(61511),h=n(67806),p=n(4252),f=n(48160);function m(e,t){1&e&&l._UZ(0,"mat-spinner",5)}var A=function(){return["id","fullName"]};function v(e,t){if(1&e){var i=l.EpF();l.TgZ(0,"perun-web-apps-members-list",6),l.NdJ("updateTable",function(){return l.CHM(i),l.oxw().refreshTable()}),l.qZA()}if(2&e){var n=l.oxw();l.Q6J("tableId",n.tableId)("disableRouting",!n.routeAuth)("filter",n.filterValue)("displayedColumns",l.DdM(5,A))("members",n.members)}}var S=function(){var e=function(){function e(t,n,a,s){i(this,e),this.route=t,this.resourceService=n,this.authResolver=a,this.entityStorageService=s,this.loading=!1,this.filterValue="",this.tableId=o.iQ}return a(e,[{key:"ngOnInit",value:function(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.refreshTable()}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.resourceService.getAssignedRichMembers(this.resource.id).subscribe(function(t){e.members=t,e.setAuthRights(),e.loading=!1})}},{key:"setAuthRights",value:function(){0!==this.members.length&&(this.routeAuth=this.authResolver.isAuthorized("getMemberById_int_policy",[this.members[0]]))}},{key:"applyFilter",value:function(e){this.filterValue=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(l.Y36(c.gz),l.Y36(s.xk),l.Y36(r.x4),l.Y36(r.fb))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-resource-assigned-members"]],decls:7,vars:6,consts:[[1,"page-subtitle"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","disableRouting","filter","displayedColumns","members","updateTable",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"tableId","disableRouting","filter","displayedColumns","members","updateTable"]],template:function(e,t){1&e&&(l.TgZ(0,"h1",0),l._uU(1),l.ALo(2,"translate"),l.qZA(),l.TgZ(3,"perun-web-apps-refresh-button",1),l.NdJ("refresh",function(){return t.refreshTable()}),l.qZA(),l.TgZ(4,"perun-web-apps-debounce-filter",2),l.NdJ("filter",function(e){return t.applyFilter(e)}),l.qZA(),l.YNc(5,m,1,0,"mat-spinner",3),l.YNc(6,v,1,6,"perun-web-apps-members-list",4)),2&e&&(l.xp6(1),l.Oqu(l.lcZ(2,4,"RESOURCE_DETAIL.ASSIGNED_MEMBERS.TITLE")),l.xp6(3),l.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_MEMBERS.FILTER"),l.xp6(1),l.Q6J("ngIf",t.loading),l.xp6(1),l.Q6J("ngIf",!t.loading))},directives:[u.t,d.P,g.O5,h.$g,p.O],pipes:[f.X$],styles:[""]}),e}()},75374:function(t,n,s){"use strict";s.d(n,{D:function(){return P}});var o=s(65249),r=s(60611),l=s(4230),c=s(84140),u=s(84608),d=s(68416),g=s(31572),h=s(48160),p=s(61511),f=s(15980),m=s(67806),A=s(55109),v=s(91058),S=s(91721),b=s(65267);function E(e,t){1&e&&g._UZ(0,"mat-spinner",6)}var R=function(){return["id","name","enabled","description"]};function T(e,t){if(1&e&&g._UZ(0,"app-services-list",16),2&e){var i=g.oxw(2);g.Q6J("tableId",i.tableId)("disableRouting",!0)("displayedColumns",g.DdM(5,R))("selection",i.selection)("services",i.filteredServices)}}var I=function(){return["select","id","name","enabled","description"]};function Z(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"div",7),g.TgZ(1,"mat-tab-group",8),g.NdJ("selectedTabChange",function(){return g.CHM(i),g.oxw().tabChanged()}),g.TgZ(2,"mat-tab",9),g.ALo(3,"translate"),g.TgZ(4,"div",10),g.TgZ(5,"perun-web-apps-debounce-filter",11),g.NdJ("filter",function(e){return g.CHM(i),g.oxw().applyFilter(e)}),g.ALo(6,"translate"),g.qZA(),g.qZA(),g._UZ(7,"app-services-list",12),g.qZA(),g.TgZ(8,"mat-tab",9),g.ALo(9,"translate"),g.TgZ(10,"div",13),g.TgZ(11,"perun-web-apps-service-package-search-select",14),g.NdJ("packageSelected",function(e){return g.CHM(i),g.oxw().servicePackageSelected(e)}),g.qZA(),g.qZA(),g.YNc(12,T,1,6,"app-services-list",15),g.qZA(),g.qZA(),g.qZA()}if(2&e){var n=g.oxw();g.xp6(2),g.s9C("label",g.lcZ(3,12,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SELECT_SERVICE")),g.xp6(3),g.s9C("placeholder",g.lcZ(6,14,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.FILTER_DESCRIPTION")),g.xp6(2),g.Q6J("tableId",n.tableId)("disableRouting",!0)("displayedColumns",g.DdM(18,I))("filterValue",n.filterValue)("selection",n.selection)("services",n.unAssignedServices),g.xp6(1),g.s9C("label",g.lcZ(9,16,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SELECT_PACKAGE")),g.xp6(3),g.Q6J("selectedPackage",n.selectedPackage)("servicePackages",n.servicePackages),g.xp6(1),g.Q6J("ngIf",-1!==n.selectedPackage.id)}}var _=function(){var t=function(){function t(e,n,a,s,o,c){i(this,t),this.dialogRef=e,this.data=n,this.notificator=a,this.translate=s,this.resourceManager=o,this.servicesManager=c,this.loading=!1,this.unAssignedServices=[],this.filteredServices=[],this.servicePackages=[],this.selectedPackage={name:"Not selected",description:"",id:-1,beanName:"ServicePackage"},this.selection=new l.Ov(!0,[]),this.tableId=r.DR,this.filterValue=""}return a(t,[{key:"ngOnInit",value:function(){var t=this;this.loading=!0,this.theme=this.data.theme,this.resourceManager.getAssignedServicesToResource(this.data.resourceId).subscribe(function(i){t.servicesManager.getServices().subscribe(function(n){t.servicesManager.getServicesPackages().subscribe(function(a){t.servicePackages.push(t.selectedPackage),t.servicePackages=t.servicePackages.concat(a),t.unAssignedServices=n;var s,o=e(i);try{for(o.s();!(s=o.n()).done;){var r,l=s.value,c=e(n);try{for(c.s();!(r=c.n()).done;){var u=r.value;l.id===u.id&&t.unAssignedServices.splice(t.unAssignedServices.indexOf(u),1)}}catch(d){c.e(d)}finally{c.f()}}}catch(d){o.e(d)}finally{o.f()}t.loading=!1})})})}},{key:"onCancel",value:function(){this.dialogRef.close()}},{key:"onAdd",value:function(){this.loading=!0,-1!==this.selectedPackage.id?this.addServicePackage():this.addServices()}},{key:"addServicePackage",value:function(){var e=this;this.resourceManager.assignServicesPackage(this.data.resourceId,this.selectedPackage.id).subscribe(function(){e.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.PACKAGE_SUCCESS_MESSAGE").subscribe(function(t){e.notificator.showSuccess(t),0!==e.selection.selected.length?e.addServices():e.dialogRef.close(!0)})},function(){return e.loading=!1})}},{key:"addServices",value:function(){var t,i=this,n=[],a=e(this.selection.selected);try{for(a.s();!(t=a.n()).done;){var s=t.value;n.push(s.id)}}catch(o){a.e(o)}finally{a.f()}this.resourceManager.assignServices(this.data.resourceId,n).subscribe(function(){i.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SERVICE_SUCCESS_MESSAGE").subscribe(function(e){i.notificator.showSuccess(e),i.dialogRef.close(!0)})},function(){return i.loading=!1})}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"servicePackageSelected",value:function(e){var t=this;this.selectedPackage=e,-1!==e.id?this.servicesManager.getServicesFromServicesPackage(e.id).subscribe(function(e){t.filteredServices=e}):this.filteredServices=[]}},{key:"tabChanged",value:function(){this.selection.clear(),this.filterValue="",this.selectedPackage=this.servicePackages[0]}}]),t}();return t.\u0275fac=function(e){return new(e||t)(g.Y36(u.so),g.Y36(u.WI),g.Y36(d.V6),g.Y36(h.sK),g.Y36(o.xk),g.Y36(o.KK))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-perun-web-apps-assign-service-to-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[3,"selectedTabChange"],[3,"label"],[1,"mt-2"],[3,"placeholder","filter"],[3,"tableId","disableRouting","displayedColumns","filterValue","selection","services"],[1,"mt-3"],[3,"selectedPackage","servicePackages","packageSelected"],[3,"tableId","disableRouting","displayedColumns","selection","services",4,"ngIf"],[3,"tableId","disableRouting","displayedColumns","selection","services"]],template:function(e,t){1&e&&(g.TgZ(0,"div"),g.TgZ(1,"h1",0),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.YNc(4,E,1,0,"mat-spinner",1),g.YNc(5,Z,13,19,"div",2),g.TgZ(6,"div",3),g.TgZ(7,"button",4),g.NdJ("click",function(){return t.onCancel()}),g._uU(8),g.ALo(9,"translate"),g.qZA(),g.TgZ(10,"button",5),g.NdJ("click",function(){return t.onAdd()}),g._uU(11),g.ALo(12,"translate"),g.qZA(),g.qZA(),g.qZA()),2&e&&(g.Tol(t.theme),g.xp6(2),g.Oqu(g.lcZ(3,9,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.TITLE")),g.xp6(2),g.Q6J("ngIf",t.loading),g.xp6(1),g.Q6J("ngIf",!t.loading),g.xp6(3),g.hij(" ",g.lcZ(9,11,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.CANCEL_BUTTON")," "),g.xp6(2),g.Q6J("disabled",0===t.selection.selected.length&&-1===t.selectedPackage.id||t.loading),g.xp6(1),g.hij(" ",g.lcZ(12,13,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE."+(-1===t.selectedPackage.id?"ADD_SERVICES":"ADD_PACKAGE"))," "))},directives:[u.uh,p.O5,u.H8,f.lW,m.$g,u.xY,A.SP,A.uX,v.P,S.Q,b.F],pipes:[h.X$],styles:[""]}),t}(),O=s(67033);function C(e,t){1&e&&g._UZ(0,"mat-spinner",6)}function y(e,t){1&e&&g._UZ(0,"th",15)}function x(e,t){if(1&e&&(g.TgZ(0,"td",16),g._uU(1),g.qZA()),2&e){var i=t.$implicit;g.xp6(1),g.hij(" ",i.name," ")}}function U(e,t){1&e&&g._UZ(0,"tr",17)}function N(e,t){1&e&&g._UZ(0,"tr",18)}function G(e,t){if(1&e&&(g.TgZ(0,"div",7),g.TgZ(1,"p"),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"div",8),g._uU(5),g.ALo(6,"translate"),g.qZA(),g.TgZ(7,"table",9),g.ynx(8,10),g.YNc(9,y,1,0,"th",11),g.YNc(10,x,2,1,"td",12),g.BQk(),g.YNc(11,U,1,0,"tr",13),g.YNc(12,N,1,0,"tr",14),g.qZA(),g.qZA()),2&e){var i=g.oxw();g.xp6(2),g.hij(" ",g.lcZ(3,5,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DESCRIPTION")," "),g.xp6(3),g.hij(" ",g.lcZ(6,7,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.ASK")," "),g.xp6(2),g.Q6J("dataSource",i.dataSource),g.xp6(4),g.Q6J("matHeaderRowDef",i.displayedColumns),g.xp6(1),g.Q6J("matRowDefColumns",i.displayedColumns)}}var L=function(){var t=function(){function t(e,n,a,s,o){i(this,t),this.dialogRef=e,this.data=n,this.notificator=a,this.translate=s,this.resourcesManager=o,this.displayedColumns=["name"]}return a(t,[{key:"ngOnInit",value:function(){this.theme=this.data.theme,this.dataSource=new O.by(this.data.services)}},{key:"onSubmit",value:function(){var t=this;this.loading=!0;var i,n=[],a=e(this.data.services);try{for(a.s();!(i=a.n()).done;){var s=i.value;n.push(s.id)}}catch(o){a.e(o)}finally{a.f()}this.resourcesManager.removeServices(this.data.resourceId,n).subscribe(function(){t.translate.get("DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.SUCCESS").subscribe(function(e){t.notificator.showSuccess(e),t.dialogRef.close(!0)})},function(){return t.loading=!1})}},{key:"onCancel",value:function(){this.dialogRef.close()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(g.Y36(u.so),g.Y36(u.WI),g.Y36(d.V6),g.Y36(h.sK),g.Y36(o.xk))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-perun-web-apps-remove-service-from-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(g.TgZ(0,"div"),g.TgZ(1,"h1",0),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.YNc(4,C,1,0,"mat-spinner",1),g.YNc(5,G,13,9,"div",2),g.TgZ(6,"div",3),g.TgZ(7,"button",4),g.NdJ("click",function(){return t.onCancel()}),g._uU(8),g.ALo(9,"translate"),g.qZA(),g.TgZ(10,"button",5),g.NdJ("click",function(){return t.onSubmit()}),g._uU(11),g.ALo(12,"translate"),g.qZA(),g.qZA(),g.qZA()),2&e&&(g.Tol(t.theme),g.xp6(2),g.Oqu(g.lcZ(3,9,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.TITLE")),g.xp6(2),g.Q6J("ngIf",t.loading),g.xp6(1),g.Q6J("ngIf",!t.loading),g.xp6(3),g.hij(" ",g.lcZ(9,11,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.CANCEL")," "),g.xp6(2),g.Q6J("disabled",t.loading),g.xp6(1),g.hij(" ",g.lcZ(12,13,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DELETE")," "))},directives:[u.uh,p.O5,u.H8,f.lW,m.$g,u.xY,O.BZ,O.w1,O.fO,O.Dz,O.as,O.nj,O.ge,O.ev,O.XQ,O.Gk],pipes:[h.X$],styles:[""]}),t}(),D=s(57629),k=s(59403),w=s(19139);function M(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"button",7),g.NdJ("click",function(){return g.CHM(i),g.oxw().addService()}),g._uU(1),g.ALo(2,"translate"),g.qZA()}2&e&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_SERVICES.ADD_SERVICE"),"\n"))}function Y(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"button",8),g.NdJ("click",function(){return g.CHM(i),g.oxw().removeServices()}),g._uU(1),g.ALo(2,"translate"),g.qZA()}if(2&e){var n=g.oxw();g.Q6J("disabled",0===n.selected.selected.length),g.xp6(1),g.hij(" ",g.lcZ(2,2,"RESOURCE_DETAIL.ASSIGNED_SERVICES.REMOVE_SERVICE"),"\n")}}function q(e,t){1&e&&g._UZ(0,"mat-spinner",9)}function J(e,t){if(1&e&&g._UZ(0,"app-services-list",10),2&e){var i=g.oxw();g.Q6J("tableId",i.tableId)("services",i.assignedServices)("selection",i.selected)("filterValue",i.filterValue)("displayedColumns",i.displayedColumns)("disableRouting",!i.serviceRoutingAuth)}}var P=function(){var e=function(){function e(t,n,a,s,o){i(this,e),this.route=t,this.resourcesManager=n,this.dialog=a,this.guiAuthResolver=s,this.entityStorageService=o,this.assignedServices=[],this.selected=new l.Ov(!0,[]),this.tableId=r.uC,this.filterValue="",this.displayedColumns=["select","id","name","enabled","script","description"]}return a(e,[{key:"ngOnInit",value:function(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.getDataForAuthorization(),this.loadAllServices()}},{key:"loadAllServices",value:function(){var e=this;this.loading=!0,this.resourcesManager.getAssignedServicesToResource(this.resource.id).subscribe(function(t){e.assignedServices=t,e.selected.clear(),e.loading=!1})}},{key:"addService",value:function(){var e=this,t=(0,c.kZ)();t.width="800px",t.data={theme:"resource-theme",resourceId:this.resource.id},this.dialog.open(_,t).afterClosed().subscribe(function(t){t&&e.loadAllServices()})}},{key:"removeServices",value:function(){var e=this,t=(0,c.kZ)();t.width="500px",t.data={theme:"resource-theme",resourceId:this.resource.id,services:this.selected.selected},this.dialog.open(L,t).afterClosed().subscribe(function(t){t&&e.loadAllServices()})}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"getDataForAuthorization",value:function(){this.assignServiceAuth=this.guiAuthResolver.isAuthorized("assignServices_Resource_List<Service>_policy",[this.resource]),this.removeServiceAuth=this.guiAuthResolver.isAuthorized("removeServices_Resource_List<Service>_policy",[this.resource]),this.displayedColumns=this.removeServiceAuth?["select","id","name","enabled","script","description"]:["id","name","enabled","script","description"],this.serviceRoutingAuth=this.guiAuthResolver.isPerunAdminOrObserver()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(D.gz),g.Y36(o.xk),g.Y36(u.uw),g.Y36(d.x4),g.Y36(d.fb))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-perun-web-apps-resource-assigned-services"]],decls:9,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["class","action-button mr-2","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","services","selection","filterValue","displayedColumns","disableRouting",4,"ngIf"],["color","accent","mat-flat-button","",1,"action-button","mr-2",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"tableId","services","selection","filterValue","displayedColumns","disableRouting"]],template:function(e,t){1&e&&(g.TgZ(0,"h1",0),g._uU(1),g.ALo(2,"translate"),g.qZA(),g.TgZ(3,"perun-web-apps-refresh-button",1),g.NdJ("refresh",function(){return t.loadAllServices()}),g.qZA(),g.YNc(4,M,3,3,"button",2),g.YNc(5,Y,3,4,"button",3),g.TgZ(6,"perun-web-apps-immediate-filter",4),g.NdJ("filter",function(e){return t.applyFilter(e)}),g.qZA(),g.YNc(7,q,1,0,"mat-spinner",5),g.YNc(8,J,1,6,"app-services-list",6)),2&e&&(g.xp6(1),g.Oqu(g.lcZ(2,6,"RESOURCE_DETAIL.ASSIGNED_SERVICES.TITLE")),g.xp6(3),g.Q6J("ngIf",t.assignServiceAuth),g.xp6(1),g.Q6J("ngIf",t.removeServiceAuth),g.xp6(1),g.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_SERVICES.FILTER_SERVICES"),g.xp6(1),g.Q6J("ngIf",t.loading),g.xp6(1),g.Q6J("ngIf",!t.loading))},directives:[k.t,p.O5,w.L,f.lW,m.$g,S.Q],pipes:[h.X$],styles:[""]}),e}()},79472:function(e,t,n){"use strict";n.d(t,{X:function(){return E}});var s=n(68416),o=n(65249),r=n(31572),l=n(55109),c=n(61511),u=n(541),d=n(3417),g=n(48160);function h(e,t){1&e&&(r._uU(0),r.ALo(1,"translate")),2&e&&r.hij(" ",r.lcZ(1,1,"RESOURCE_DETAIL.ENTITY")," ")}function p(e,t){if(1&e&&r._UZ(0,"app-one-entity-attribute-page",4),2&e){var i=r.oxw();r.Q6J("entity","resource")("entityId",i.resource.id)}}function f(e,t){1&e&&(r._uU(0),r.ALo(1,"translate"),r.ALo(2,"translate")),2&e&&r.AsE(" ",r.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",r.lcZ(2,4,"MEMBER_DETAIL.ENTITY")," ")}function m(e,t){if(1&e&&r._UZ(0,"app-two-entity-attribute-page",5),2&e){var i=r.oxw(2);r.Q6J("firstEntity","resource")("firstEntityId",i.resource.id)("secondEntity","member")}}function A(e,t){1&e&&(r.TgZ(0,"mat-tab"),r.YNc(1,f,3,6,"ng-template",1),r.YNc(2,m,1,3,"ng-template",2),r.qZA())}function v(e,t){1&e&&(r._uU(0),r.ALo(1,"translate"),r.ALo(2,"translate")),2&e&&r.AsE(" ",r.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",r.lcZ(2,4,"GROUP_DETAIL.ENTITY")," ")}function S(e,t){if(1&e&&r._UZ(0,"app-two-entity-attribute-page",5),2&e){var i=r.oxw(2);r.Q6J("firstEntity","resource")("firstEntityId",i.resource.id)("secondEntity","group")}}function b(e,t){1&e&&(r.TgZ(0,"mat-tab"),r.YNc(1,v,3,6,"ng-template",1),r.YNc(2,S,1,3,"ng-template",2),r.qZA())}var E=function(){var e=function(){function e(t,n,a){i(this,e),this.authResolver=t,this.resourceManager=n,this.entityStorageService=a}return a(e,[{key:"ngOnInit",value:function(){this.resource=this.entityStorageService.getEntity(),this.resourceGroupAttAuth=this.authResolver.isAuthorized("getGroupAssignments_Resource_policy",[this.resource]),this.resourceMemberAttAuth=this.authResolver.isAuthorized("getAssignedMembersWithStatus_Resource_policy",[this.resource])}}]),e}();return e.\u0275fac=function(t){return new(t||e)(r.Y36(s.x4),r.Y36(o.xk),r.Y36(s.fb))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-resource-attributes"]],hostVars:2,hostBindings:function(e,t){2&e&&r.ekj("router-component",t.true)},decls:10,vars:5,consts:[[1,"page-subtitle"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entity","entityId"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(e,t){1&e&&(r.TgZ(0,"div"),r.TgZ(1,"h1",0),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-tab-group"),r.TgZ(5,"mat-tab"),r.YNc(6,h,2,3,"ng-template",1),r.YNc(7,p,1,2,"ng-template",2),r.qZA(),r.YNc(8,A,3,0,"mat-tab",3),r.YNc(9,b,3,0,"mat-tab",3),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.Oqu(r.lcZ(3,3,"RESOURCE_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),r.xp6(6),r.Q6J("ngIf",t.resourceMemberAttAuth),r.xp6(1),r.Q6J("ngIf",t.resourceGroupAttAuth))},directives:[l.SP,l.uX,l.uD,l.Vc,c.O5,u.t,d.Y],pipes:[g.X$],styles:[""]}),e}()},72920:function(e,t,n){"use strict";n.d(t,{b:function(){return w}});var s=n(17),o=n(75585),r=n(65249),l=n(84140),c=n(68416),u=n(22280),d=n(6527),g=n(95909),h=n(31572),p=n(57629),f=n(48958),m=n(84608),A=n(66297),v=n(61511),S=n(67806),b=n(43691),E=n(36922),R=n(21575),T=n(15980),I=n(48160);function Z(e,t){1&e&&h._UZ(0,"mat-spinner",3)}function _(e,t){if(1&e){var i=h.EpF();h.TgZ(0,"button",15),h.NdJ("click",function(){return h.CHM(i),h.oxw(2).editResource()}),h.TgZ(1,"mat-icon"),h._uU(2,"edit"),h.qZA(),h.qZA()}}function O(e,t){if(1&e){var i=h.EpF();h.TgZ(0,"button",16),h.NdJ("click",function(){return h.CHM(i),h.oxw(2).deleteResource()}),h.TgZ(1,"mat-icon"),h._uU(2,"delete_forever"),h.qZA(),h.qZA()}}var C=function(e){return["/organizations",e]};function y(e,t){if(1&e&&(h.TgZ(0,"a",8),h._uU(1),h.qZA()),2&e){var i=h.oxw(2);h.Q6J("routerLink",h.VKq(2,C,i.resource.vo.id)),h.xp6(1),h.Oqu(i.resource.vo.name)}}function x(e,t){if(1&e&&(h.TgZ(0,"span"),h._uU(1),h.qZA()),2&e){var i=h.oxw(2);h.xp6(1),h.hij(" ",i.resource.vo.name," ")}}var U=function(e){return["/facilities",e]};function N(e,t){if(1&e&&(h.TgZ(0,"a",8),h._uU(1),h.qZA()),2&e){var i=h.oxw(2);h.Q6J("routerLink",h.VKq(2,U,i.resource.facilityId)),h.xp6(1),h.Oqu(i.resource.facility.name)}}function G(e,t){if(1&e&&(h.TgZ(0,"span"),h._uU(1),h.qZA()),2&e){var i=h.oxw(2);h.xp6(1),h.hij(" ",i.resource.facility.name," ")}}var L=function(){return{color:"black"}},D=function(e){return[e]};function k(e,t){if(1&e&&(h.TgZ(0,"div"),h.TgZ(1,"div",4),h._UZ(2,"mat-icon",5),h.ALo(3,"translate"),h.TgZ(4,"div",6),h.TgZ(5,"div",7),h.TgZ(6,"a",8),h._uU(7),h.qZA(),h.TgZ(8,"span",9),h._uU(9),h.qZA(),h.YNc(10,_,3,0,"button",10),h.YNc(11,O,3,0,"button",11),h.qZA(),h.TgZ(12,"div"),h._uU(13),h.ALo(14,"translate"),h.qZA(),h.TgZ(15,"span",12),h._uU(16),h.ALo(17,"translate"),h.ALo(18,"translate"),h.YNc(19,y,2,4,"a",13),h.YNc(20,x,2,1,"span",2),h._uU(21),h.ALo(22,"translate"),h.YNc(23,N,2,4,"a",14),h.YNc(24,G,2,1,"span",2),h._uU(25),h.ALo(26,"translate"),h.qZA(),h.qZA(),h.qZA(),h._UZ(27,"app-animated-router-outlet"),h.qZA()),2&e){var i=h.oxw();h.xp6(2),h.s9C("matTooltip",h.lcZ(3,20,"RESOURCE_DETAIL.ENTITY")),h.Q6J("ngStyle",h.DdM(32,L)),h.xp6(4),h.Q6J("routerLink",h.VKq(33,D,i.baseUrl)),h.xp6(1),h.hij(" ",i.resource.name," "),h.xp6(2),h.hij(" \xa0#",i.resource.id," "),h.xp6(1),h.Q6J("ngIf",i.editResourceAuth),h.xp6(1),h.Q6J("ngIf",i.deleteAuth),h.xp6(2),h.AsE(" ",h.lcZ(14,22,"RESOURCE_DETAIL.UUID"),": ",i.resource.uuid," "),h.xp6(3),h.AsE(" ",h.lcZ(17,24,"RESOURCE_DETAIL.ENTITY"),", ",h.lcZ(18,26,"RESOURCE_DETAIL.VO"),": "),h.xp6(3),h.Q6J("ngIf",i.voLinkAuth),h.xp6(1),h.Q6J("ngIf",!i.voLinkAuth),h.xp6(1),h.AsE(" #",i.resource.voId,", ",h.lcZ(22,28,"RESOURCE_DETAIL.FACILITY"),": "),h.xp6(2),h.Q6J("ngIf",i.facilityLinkAuth),h.xp6(1),h.Q6J("ngIf",!i.facilityLinkAuth),h.xp6(1),h.lnq(" #",i.resource.facilityId,", ",h.lcZ(26,30,"RESOURCE_DETAIL.DESCRIPTION"),": ",i.resource.description," ")}}var w=function(){var e=function(){function e(t,n,a,s,o,r,l,c,u,d){i(this,e),this.route=t,this.facilityManager=n,this.vosManagerService=a,this.resourcesManager=s,this.sideMenuService=o,this.sideMenuItemService=r,this.dialog=l,this.guiAuthResolver=c,this.router=u,this.entityStorageService=d,this.deleteAuth=!1,this.baseUrl="",this.loading=!1}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.params.subscribe(function(t){e.resourcesManager.getRichResourceById(t.resourceId).subscribe(function(t){e.resource=t,e.entityStorageService.setEntity({id:t.id,voId:t.voId,facilityId:t.facilityId,beanName:t.beanName}),e.setAuth(),"facilities"===e.route.parent.snapshot.url[0].path?(e.baseUrl=(new u.r5).transform(t,!1),e.facilityManager.getFacilityById(t.facilityId).subscribe(function(i){var n=e.sideMenuItemService.parseFacility(i),a=e.sideMenuItemService.parseResource(t,!1);e.sideMenuService.setFacilityMenuItems([n,a]),e.loading=!1},function(){return e.loading=!1})):(e.baseUrl=(new u.r5).transform(t,!0),e.vosManagerService.getVoById(t.voId).subscribe(function(i){var n=e.sideMenuItemService.parseVo(i),a=e.sideMenuItemService.parseResource(t,!0);e.sideMenuService.setAccessMenuItems([n,a]),e.loading=!1},function(){return e.loading=!1})),(0,l.sF)("resources",e.resource)})})}},{key:"setAuth",value:function(){this.facilityLinkAuth=this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.resource]),this.editResourceAuth=this.guiAuthResolver.isAuthorized("updateResource_Resource_policy",[this.resource]),this.voLinkAuth=this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.resource]),this.deleteAuth=this.guiAuthResolver.isAuthorized("deleteResource_Resource_policy",[this.resource])}},{key:"editResource",value:function(){var e,t=this;this.resourcesManager.getResourceById(this.resource.id).subscribe(function(i){e=i;var n=(0,l.kZ)();n.width="450px",n.data={theme:"resource-theme",resource:e,dialogType:d.Eg.RESOURCE},t.dialog.open(d.rd,n).afterClosed().subscribe(function(e){e&&t.resourcesManager.getRichResourceById(t.resource.id).subscribe(function(e){t.resource=e})})})}},{key:"deleteResource",value:function(){var e=this,t=(0,l.kZ)();t.width="500px",t.data={theme:"resource-theme",resources:[this.resource]},this.dialog.open(g.f,t).afterClosed().subscribe(function(t){t&&e.router.navigate(["../"],{relativeTo:e.route})})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(p.gz),h.Y36(r.IQ),h.Y36(r.YF),h.Y36(r.xk),h.Y36(f.D),h.Y36(o.V),h.Y36(m.uw),h.Y36(c.x4),h.Y36(p.F0),h.Y36(c.fb))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-resource-detail-page"]],decls:4,vars:2,consts:[[1,"container-fluid","pl-xl-5","pr-xl-5","resource-theme"],["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-resource-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],["queryParamsHandling","merge",1,"resource-link",3,"routerLink"],[1,"text-muted"],["mat-icon-button","","aria-label","Edit resource",3,"click",4,"ngIf"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"mt-1","entity-info"],["queryParamsHandling","merge","class","resource-link",3,"routerLink",4,"ngIf"],["class","resource-link","queryParamsHandling","merge",3,"routerLink",4,"ngIf"],["mat-icon-button","","aria-label","Edit resource",3,"click"],["mat-icon-button","",3,"click"]],template:function(e,t){1&e&&(h.TgZ(0,"div",0),h._UZ(1,"perun-web-apps-back-button"),h.YNc(2,Z,1,0,"mat-spinner",1),h.YNc(3,k,28,35,"div",2),h.qZA()),2&e&&(h.xp6(2),h.Q6J("ngIf",t.loading),h.xp6(1),h.Q6J("ngIf",!t.loading&&void 0!==t.resource))},directives:[A.W,v.O5,S.$g,b.Hw,E.gM,v.PC,p.yS,R.A,T.lW],pipes:[I.X$],styles:[".break-line[_ngcontent-%COMP%]{display:inline-block}"],data:{animation:[s.Ji]}}),e}()},42473:function(t,n,s){"use strict";s.d(n,{K:function(){return X}});var o=s(65249),r=s(4230),l=s(84608),c=s(67033),u=s(68416),d=s(31572),g=s(48160),h=s(61511),p=s(15980),f=s(67806);function m(e,t){1&e&&d._UZ(0,"mat-spinner",6)}function A(e,t){1&e&&d._UZ(0,"th",15)}function v(e,t){if(1&e&&(d.TgZ(0,"td",16),d._uU(1),d.qZA()),2&e){var i=t.$implicit;d.xp6(1),d.hij(" ",i.name," ")}}function S(e,t){1&e&&d._UZ(0,"tr",17)}function b(e,t){1&e&&d._UZ(0,"tr",18)}function E(e,t){if(1&e&&(d.TgZ(0,"div",7),d.TgZ(1,"p"),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"div",8),d._uU(5),d.ALo(6,"translate"),d.qZA(),d.TgZ(7,"table",9),d.ynx(8,10),d.YNc(9,A,1,0,"th",11),d.YNc(10,v,2,1,"td",12),d.BQk(),d.YNc(11,S,1,0,"tr",13),d.YNc(12,b,1,0,"tr",14),d.qZA(),d.qZA()),2&e){var i=d.oxw();d.xp6(2),d.hij(" ",d.lcZ(3,5,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DESCRIPTION")," "),d.xp6(3),d.hij(" ",d.lcZ(6,7,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.ASK")," "),d.xp6(2),d.Q6J("dataSource",i.dataSource),d.xp6(4),d.Q6J("matHeaderRowDef",i.displayedColumns),d.xp6(1),d.Q6J("matRowDefColumns",i.displayedColumns)}}var R=function(){var t=function(){function t(e,n,a,s,o){i(this,t),this.dialogRef=e,this.data=n,this.notificator=a,this.translate=s,this.resourceManager=o,this.displayedColumns=["name"],this.loading=!1}return a(t,[{key:"ngOnInit",value:function(){this.theme=this.data.theme,this.dataSource=new c.by(this.data.groups)}},{key:"onCancel",value:function(){this.dialogRef.close()}},{key:"onSubmit",value:function(){var t,i=this,n=[],a=e(this.data.groups);try{for(a.s();!(t=a.n()).done;){var s=t.value;n.push(s.id)}}catch(o){a.e(o)}finally{a.f()}this.loading=!0,this.resourceManager.removeGroupsFromResource(n,this.data.resourceId).subscribe(function(){i.translate.get("DIALOGS.REMOVE_GROUP_FROM_RESOURCE.SUCCESS").subscribe(function(e){i.notificator.showSuccess(e),i.dialogRef.close(!0)})},function(){return i.loading=!1})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(d.Y36(l.so),d.Y36(l.WI),d.Y36(u.V6),d.Y36(g.sK),d.Y36(o.xk))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-perun-web-apps-remove-group-from-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(d.TgZ(0,"div"),d.TgZ(1,"h1",0),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.YNc(4,m,1,0,"mat-spinner",1),d.YNc(5,E,13,9,"div",2),d.TgZ(6,"div",3),d.TgZ(7,"button",4),d.NdJ("click",function(){return t.onCancel()}),d._uU(8),d.ALo(9,"translate"),d.qZA(),d.TgZ(10,"button",5),d.NdJ("click",function(){return t.onSubmit()}),d._uU(11),d.ALo(12,"translate"),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.Tol(t.theme),d.xp6(2),d.Oqu(d.lcZ(3,9,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.TITLE")),d.xp6(2),d.Q6J("ngIf",t.loading),d.xp6(1),d.Q6J("ngIf",!t.loading),d.xp6(3),d.hij(" ",d.lcZ(9,11,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.CANCEL")," "),d.xp6(2),d.Q6J("disabled",t.loading),d.xp6(1),d.hij(" ",d.lcZ(12,13,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DELETE")," "))},directives:[l.uh,h.O5,l.H8,p.lW,f.$g,l.xY,c.BZ,c.w1,c.fO,c.Dz,c.as,c.nj,c.ge,c.ev,c.XQ,c.Gk],pipes:[g.X$],styles:[""]}),t}(),T=s(60611),I=s(70663),Z=s(91058),_=s(78364),O=s(27521),C=s(16073),y=["stepper"];function x(e,t){1&e&&d._UZ(0,"mat-spinner",4)}function U(e,t){1&e&&(d._uU(0),d.ALo(1,"translate")),2&e&&d.Oqu(d.lcZ(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.GROUPS"))}function N(e,t){1&e&&(d._uU(0),d.ALo(1,"translate")),2&e&&d.Oqu(d.lcZ(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.OPTIONS"))}var G=function(){return["select","id","name","description"]};function L(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"div",5),d.TgZ(1,"mat-stepper",6,7),d.TgZ(3,"mat-step",8),d.YNc(4,U,2,3,"ng-template",9),d.TgZ(5,"perun-web-apps-debounce-filter",10),d.NdJ("filter",function(e){return d.CHM(i),d.oxw().applyFilter(e)}),d.ALo(6,"translate"),d.qZA(),d._UZ(7,"perun-web-apps-groups-list",11),d.qZA(),d.TgZ(8,"mat-step"),d.YNc(9,N,2,3,"ng-template",9),d.TgZ(10,"mat-slide-toggle",12),d.NdJ("toggleChange",function(){return d.CHM(i),d.oxw().changeSubgroupsMessage()})("ngModelChange",function(e){return d.CHM(i),d.oxw().autoAssignSubgroups=e}),d._uU(11),d.ALo(12,"translate"),d.qZA(),d.TgZ(13,"div",13),d._UZ(14,"i",14),d.qZA(),d.TgZ(15,"mat-slide-toggle",12),d.NdJ("toggleChange",function(){return d.CHM(i),d.oxw().changeInactiveMessage()})("ngModelChange",function(e){return d.CHM(i),d.oxw().asActive=e}),d._uU(16),d.ALo(17,"translate"),d.qZA(),d.TgZ(18,"div",13),d._uU(19),d.qZA(),d.TgZ(20,"mat-slide-toggle",12),d.NdJ("toggleChange",function(){return d.CHM(i),d.oxw().changeAsyncMessage()})("ngModelChange",function(e){return d.CHM(i),d.oxw().async=e}),d._uU(21),d.ALo(22,"translate"),d.qZA(),d.TgZ(23,"div",13),d._uU(24),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&e){var n=d.oxw();d.xp6(1),d.Q6J("linear",!0),d.xp6(2),d.Q6J("completed",0!==n.selection.selected.length&&n.canAddGroups()),d.xp6(2),d.s9C("placeholder",d.lcZ(6,19,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.FILTER_DESCRIPTION")),d.xp6(2),d.Q6J("tableId",n.tableId)("groups",n.unAssignedGroups)("selection",n.selection)("filter",n.filterValue)("displayedColumns",d.DdM(27,G))("disableRouting",!0)("disableMembers",!1),d.xp6(3),d.Q6J("ngModel",n.autoAssignSubgroups),d.xp6(1),d.hij(" ",d.lcZ(12,21,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS")," "),d.xp6(3),d.Q6J("innerHTML",n.autoAssignHint,d.oJD),d.xp6(1),d.Q6J("ngModel",n.asActive),d.xp6(1),d.hij(" ",d.lcZ(17,23,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AS_ACTIVE")," "),d.xp6(3),d.hij(" ",n.asActiveHint," "),d.xp6(1),d.Q6J("ngModel",n.async),d.xp6(1),d.hij(" ",d.lcZ(22,25,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OPT")," "),d.xp6(3),d.hij(" ",n.asyncHint," ")}}function D(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"button",20),d.NdJ("click",function(){return d.CHM(i),d.oxw(2).stepperPrevious()}),d._uU(1),d.ALo(2,"translate"),d.qZA()}2&e&&(d.xp6(1),d.hij(" ",d.lcZ(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.BACK")," "))}function k(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"button",21),d.NdJ("click",function(){return d.CHM(i),d.oxw(2).stepperNext()}),d._uU(1),d.ALo(2,"translate"),d.qZA()}if(2&e){var n=d.oxw(2);d.ekj("ml-2",void 0!==n.stepper&&0!==n.stepper.selectedIndex)("ml-auto",!(void 0!==n.stepper&&0!==n.stepper.selectedIndex)),d.Q6J("disabled",0===n.selection.selected.length||!n.canAddGroups()),d.xp6(1),d.hij(" ",d.lcZ(2,6,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.NEXT")," ")}}function w(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"button",22),d.NdJ("click",function(){return d.CHM(i),d.oxw(2).onAdd()}),d._uU(1),d.ALo(2,"translate"),d.qZA()}2&e&&(d.xp6(1),d.hij(" ",d.lcZ(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ADD_BUTTON")," "))}function M(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"div",15),d.TgZ(1,"button",16),d.NdJ("click",function(){return d.CHM(i),d.oxw().onCancel()}),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.YNc(4,D,3,3,"button",17),d.YNc(5,k,3,8,"button",18),d.YNc(6,w,3,3,"button",19),d.qZA()}if(2&e){var n=d.oxw();d.xp6(2),d.hij(" ",d.lcZ(3,4,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.CANCEL_BUTTON")," "),d.xp6(2),d.Q6J("ngIf",void 0!==n.stepper&&0!==n.stepper.selectedIndex),d.xp6(1),d.Q6J("ngIf",void 0!==n.stepper&&n.stepper.selectedIndex!==n.stepper._steps.length-1),d.xp6(1),d.Q6J("ngIf",void 0!==n.stepper&&n.stepper.selectedIndex===n.stepper._steps.length-1)}}var Y=function(){var t=function(){function t(e,n,a,s,o,l,c,u){i(this,t),this.dialogRef=e,this.data=n,this.notificator=a,this.translate=s,this.resourceManager=o,this.groupService=l,this.guiAuthResolver=c,this.cd=u,this.loading=!1,this.unAssignedGroups=[],this.async=!0,this.autoAssignSubgroups=!1,this.asActive=!0,this.selection=new r.Ov(!0,[]),this.filterValue="",this.tableId=T.cL}return a(t,[{key:"ngOnInit",value:function(){var t=this;this.loading=!0,this.theme=this.data.theme,this.resource=this.data.resource,this.autoAssignHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT"),this.asActiveHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT"),this.asyncHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT"),this.resourceManager.getAssignedGroups(this.resource.id).subscribe(function(i){t.groupService.getAllGroups(t.resource.voId).subscribe(function(n){var a,s=e(n);try{var o=function(){var e=a.value;-1===i.findIndex(function(t){return t.id===e.id})&&t.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[t.resource,e])&&t.unAssignedGroups.push(e)};for(s.s();!(a=s.n()).done;)o()}catch(r){s.e(r)}finally{s.f()}t.loading=!1,t.cd.detectChanges()},function(){return t.loading=!1})},function(){return t.loading=!1})}},{key:"onCancel",value:function(){this.dialogRef.close()}},{key:"onAdd",value:function(){var t=this;this.loading=!0;var i,n=[],a=e(this.selection.selected);try{for(a.s();!(i=a.n()).done;){var s=i.value;n.push(s.id)}}catch(o){a.e(o)}finally{a.f()}this.resourceManager.assignGroupsToResource(n,this.resource.id,this.async,!this.asActive,this.autoAssignSubgroups).subscribe(function(){t.translate.get("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.SUCCESS_MESSAGE").subscribe(function(e){t.notificator.showSuccess(e),t.dialogRef.close(!0)})},function(){return t.loading=!1})}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"canAddGroups",value:function(){var e=this,t=!0;return this.selection.selected.forEach(function(i){e.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[e.resource,i])||(t=!1)}),t}},{key:"changeSubgroupsMessage",value:function(){this.autoAssignHint=this.translate.instant(this.autoAssignSubgroups?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_ON_HINT")}},{key:"changeInactiveMessage",value:function(){this.asActiveHint=this.translate.instant(this.asActive?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT")}},{key:"changeAsyncMessage",value:function(){this.asyncHint=this.translate.instant(this.async?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT")}},{key:"stepperPrevious",value:function(){this.stepper.previous()}},{key:"stepperNext",value:function(){this.stepper.next()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(d.Y36(l.so),d.Y36(l.WI),d.Y36(u.V6),d.Y36(g.sK),d.Y36(o.xk),d.Y36(o.ff),d.Y36(u.x4),d.Y36(d.sBO))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-perun-web-apps-assign-group-to-resource-dialog"]],viewQuery:function(e,t){var i;(1&e&&d.Gf(y,5),2&e)&&(d.iGM(i=d.CRH())&&(t.stepper=i.first))},decls:7,vars:9,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","","class","dialog-container",4,"ngIf"],["mat-dialog-actions","",4,"ngIf"],[1,"mr-auto","ml-auto"],["mat-dialog-content","",1,"dialog-container"],[3,"linear"],["stepper",""],[3,"completed"],["matStepLabel",""],[3,"placeholder","filter"],[3,"tableId","groups","selection","filter","displayedColumns","disableRouting","disableMembers"],["labelPosition","before",1,"mt-3","slide-text",3,"ngModel","toggleChange","ngModelChange"],[1,"text-muted","new-line","mt-2"],[3,"innerHTML"],["mat-dialog-actions",""],["mat-flat-button","",3,"click"],["class","ml-auto","mat-flat-button","",3,"click",4,"ngIf"],["color","accent","mat-flat-button","","type","button",3,"ml-2","ml-auto","disabled","click",4,"ngIf"],["class","ml-2","color","accent","mat-flat-button","","type","button",3,"click",4,"ngIf"],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","","type","button",3,"disabled","click"],["color","accent","mat-flat-button","","type","button",1,"ml-2",3,"click"]],template:function(e,t){1&e&&(d.TgZ(0,"div"),d.TgZ(1,"h1",0),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.YNc(4,x,1,0,"mat-spinner",1),d.YNc(5,L,25,28,"div",2),d.YNc(6,M,7,6,"div",3),d.qZA()),2&e&&(d.Tol(t.theme),d.xp6(2),d.Oqu(d.lcZ(3,7,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.TITLE")),d.xp6(2),d.Q6J("ngIf",t.loading),d.xp6(1),d.Q6J("ngIf",!t.loading),d.xp6(1),d.Q6J("ngIf",!t.loading&&t.stepper))},directives:[l.uh,h.O5,f.$g,l.xY,I.Vq,I.C0,I.VY,Z.P,_.W,O.Rr,C.JJ,C.On,l.H8,p.lW],pipes:[g.X$],styles:[".slide-text[_ngcontent-%COMP%]{font-size:1.1rem}"]}),t}(),q=s(84140),J=s(67004),P=s(57629),Q=s(59403),V=s(36922);function F(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"button",8),d.NdJ("click",function(){return d.CHM(i),d.oxw().addGroup()}),d._uU(1),d.ALo(2,"translate"),d.qZA()}2&e&&(d.xp6(1),d.hij(" ",d.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_GROUPS.ADD_GROUP"),"\n"))}function H(e,t){1&e&&d._UZ(0,"mat-spinner",9)}var j=function(e){return[e]},z=function(){return["select","id","indirectGroupAssigment","name","status","description"]};function B(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"perun-web-apps-groups-list",10),d.NdJ("refreshTable",function(){return d.CHM(i),d.oxw().loadAllGroups()}),d.qZA()}if(2&e){var n=d.oxw();d.Q6J("disableGroups",!0)("groupsToDisableCheckbox",n.groupsToDisable)("tableId",n.tableId)("groups",n.assignedGroups)("filter",n.filteredValue)("selection",n.selected)("disableMembers",!1)("resourceId",n.resource.id)("disableRouting",!!n.assignedGroups[0]&&!n.guiAuthResolver.isAuthorized("getGroupById_int_policy",d.VKq(10,j,n.assignedGroups[0])))("displayedColumns",d.DdM(12,z))}}var X=function(){var e=function(){function e(t,n,a,s,o){i(this,e),this.route=t,this.resourcesManager=n,this.dialog=a,this.guiAuthResolver=s,this.entityStorageService=o,this.assignedGroups=[],this.selected=new r.Ov(!0,[]),this.filteredValue="",this.tableId=T.Ad}return a(e,[{key:"ngOnInit",value:function(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.loadAllGroups()}},{key:"loadAllGroups",value:function(){var e=this;this.loading=!0,this.resourcesManager.getGroupAssignments(this.resource.id,[J.r.GROUP_SYNC_ENABLED]).subscribe(function(t){e.assignedGroups=t.map(function(e){var t=e.enrichedGroup.group;return t.status=e.status,t.failureCause=e.failureCause,t.sourceGroupId=e.sourceGroupId,t}),e.groupsToDisable=new Set(e.assignedGroups.filter(function(e){return!!e.sourceGroupId}).map(function(e){return e.id})),e.selected.clear(),e.loading=!1})}},{key:"addGroup",value:function(){var e=this,t=(0,q.kZ)();t.width="1000px",t.data={theme:"resource-theme",resource:this.resource},this.dialog.open(Y,t).afterClosed().subscribe(function(t){t&&e.loadAllGroups()})}},{key:"removeGroups",value:function(){var e=this,t=(0,q.kZ)();t.width="500px",t.data={resourceId:this.resource.id,groups:this.selected.selected,theme:"resource-theme"},this.dialog.open(R,t).afterClosed().subscribe(function(t){t&&e.loadAllGroups()})}},{key:"canRemoveGroups",value:function(){var e=this,t=!0;return this.selected.selected.forEach(function(i){e.guiAuthResolver.isAuthorized("removeGroupsFromResource_List<Group>_Resource_policy",[e.resource,i])||(t=!1)}),t}},{key:"applyFilter",value:function(e){this.filteredValue=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(d.Y36(P.gz),d.Y36(o.xk),d.Y36(l.uw),d.Y36(u.x4),d.Y36(u.fb))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-perun-web-apps-resource-groups"]],decls:13,vars:17,consts:[[1,"page-subtitle"],[3,"refresh"],["class","action-button","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","mat-flat-button","",1,"ml-2","mr-2",3,"disabled","click"],[3,"matTooltipDisabled","matTooltip"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"disableGroups","groupsToDisableCheckbox","tableId","groups","filter","selection","disableMembers","resourceId","disableRouting","displayedColumns","refreshTable",4,"ngIf"],["color","accent","mat-flat-button","",1,"action-button",3,"click"],[1,"ml-auto","mr-auto"],[3,"disableGroups","groupsToDisableCheckbox","tableId","groups","filter","selection","disableMembers","resourceId","disableRouting","displayedColumns","refreshTable"]],template:function(e,t){1&e&&(d.TgZ(0,"h1",0),d._uU(1),d.ALo(2,"translate"),d.qZA(),d.TgZ(3,"perun-web-apps-refresh-button",1),d.NdJ("refresh",function(){return t.loadAllGroups()}),d.qZA(),d.YNc(4,F,3,3,"button",2),d.TgZ(5,"button",3),d.NdJ("click",function(){return t.removeGroups()}),d.TgZ(6,"span",4),d.ALo(7,"translate"),d._uU(8),d.ALo(9,"translate"),d.qZA(),d.qZA(),d.TgZ(10,"perun-web-apps-debounce-filter",5),d.NdJ("filter",function(e){return t.applyFilter(e)}),d.qZA(),d.YNc(11,H,1,0,"mat-spinner",6),d.YNc(12,B,1,13,"perun-web-apps-groups-list",7)),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,9,"RESOURCE_DETAIL.ASSIGNED_GROUPS.TITLE")),d.xp6(3),d.Q6J("ngIf",t.guiAuthResolver.isAuthorized("getAllGroups_Vo_policy",d.VKq(15,j,t.resource))),d.xp6(1),d.Q6J("disabled",0===t.selected.selected.length||!t.canRemoveGroups()),d.xp6(1),d.s9C("matTooltip",d.lcZ(7,11,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_TOOLTIP")),d.Q6J("matTooltipDisabled",t.canRemoveGroups()),d.xp6(2),d.hij(" ",d.lcZ(9,13,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_GROUP")," "),d.xp6(2),d.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_GROUPS.FILTER_GROUPS"),d.xp6(1),d.Q6J("ngIf",t.loading),d.xp6(1),d.Q6J("ngIf",!t.loading))},directives:[Q.t,h.O5,p.lW,V.gM,Z.P,f.$g,_.W],pipes:[g.X$],styles:[""]}),e}()},76527:function(e,t,n){"use strict";n.d(t,{H:function(){return p}});var s=n(65249),o=n(68416),r=n(31572),l=n(57629),c=n(61511),u=n(67806),d=n(8557);function g(e,t){1&e&&r._UZ(0,"mat-spinner",2)}function h(e,t){if(1&e&&(r.TgZ(0,"div"),r._UZ(1,"perun-web-apps-menu-buttons-field",3),r.qZA()),2&e){var i=r.oxw();r.xp6(1),r.Q6J("items",i.navItems)("size","small")}}var p=function(){var e=function(){function e(t,n,a,s){i(this,e),this.resourcesManager=t,this.route=n,this.guiAuthResolver=a,this.entityStorageService=s,this.navItems=[],this.loading=!1}return a(e,[{key:"ngOnInit",value:function(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.initItems("facilities"!==this.route.parent.parent.snapshot.url[0].path),this.loading=!1}},{key:"initItems",value:function(e){var t=e?"/organizations/".concat(this.resource.voId):"/facilities/".concat(this.resource.facilityId);this.navItems=[],this.guiAuthResolver.isAuthorized("getAssignedGroups_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-group",url:"".concat(t,"/resources/").concat(this.resource.id,"/groups"),label:"MENU_ITEMS.RESOURCE.ASSIGNED_GROUPS",style:"resource-btn"}),this.guiAuthResolver.isAuthorized("getAssignedServices_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-service",url:"/".concat(t,"/resources/").concat(this.resource.id,"/services"),label:"MENU_ITEMS.RESOURCE.ASSIGNED_SERVICES",style:"resource-btn"}),this.guiAuthResolver.isAuthorized("getAssignedMembers_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-user",url:"".concat(t,"/resources/").concat(this.resource.id,"/members"),label:"MENU_ITEMS.RESOURCE.ASSIGNED_MEMBERS",style:"resource-btn"}),this.guiAuthResolver.isAuthorized("getAllResourcesTagsForResource_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-resource-tags",url:"".concat(t,"/resources/").concat(this.resource.id,"/tags"),label:"MENU_ITEMS.RESOURCE.RESOURCE_TAGS",style:"resource-btn"}),this.navItems.push({cssIcon:"perun-attributes",url:"".concat(t,"/resources/").concat(this.resource.id,"/attributes"),label:"MENU_ITEMS.RESOURCE.ATTRIBUTES",style:"resource-btn"}),this.guiAuthResolver.isManagerPagePrivileged(this.resource)&&this.navItems.push({cssIcon:"perun-settings2",url:"".concat(t,"/resources/").concat(this.resource.id,"/settings"),label:"MENU_ITEMS.RESOURCE.SETTINGS",style:"resource-btn"})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(r.Y36(s.xk),r.Y36(l.gz),r.Y36(o.x4),r.Y36(o.fb))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-resource-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&r.ekj("router-component",t.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(r.YNc(0,g,1,0,"mat-spinner",0),r.YNc(1,h,2,2,"div",1)),2&e&&(r.Q6J("ngIf",t.loading),r.xp6(1),r.Q6J("ngIf",!t.loading))},directives:[c.O5,u.$g,d.L],styles:[""]}),e}()},64359:function(e,t,n){"use strict";n.d(t,{O:function(){return l}});var s=n(68416),o=n(31572),r=n(489),l=function(){var e=function(){function e(t,n){i(this,e),this.guiAuthResolver=t,this.entityStorageService=n,this.availableRoles=[],this.type="Resource",this.theme="resource-theme"}return a(e,[{key:"ngOnInit",value:function(){this.resource=this.entityStorageService.getEntity(),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Resource")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Y36(s.x4),o.Y36(s.fb))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-resource-settings-managers"]],decls:1,vars:4,consts:[[3,"complementaryObject","complementaryObjectType","theme","availableRoles"]],template:function(e,t){1&e&&o._UZ(0,"app-managers-page",0),2&e&&o.Q6J("complementaryObject",t.resource)("complementaryObjectType",t.type)("theme",t.theme)("availableRoles",t.availableRoles)},directives:[r.s],styles:[""]}),e}()},22927:function(e,t,n){"use strict";n.d(t,{h:function(){return p}});var s=n(65249),o=n(68416),r=n(31572),l=n(57629),c=n(61511),u=n(67806),d=n(8557);function g(e,t){1&e&&r._UZ(0,"mat-spinner",2)}function h(e,t){if(1&e&&(r.TgZ(0,"div"),r._UZ(1,"perun-web-apps-menu-buttons-field",3),r.qZA()),2&e){var i=r.oxw();r.xp6(1),r.Q6J("items",i.items)("size","small")}}var p=function(){var e=function(){function e(t,n,a,s){i(this,e),this.route=t,this.resourceManager=n,this.authResolver=a,this.entityStorageService=s,this.items=[],this.loading=!1}return a(e,[{key:"ngOnInit",value:function(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.initItems("facilities"!==this.route.parent.parent.parent.snapshot.url[0].path),this.loading=!1}},{key:"initItems",value:function(e){this.items=[],this.authResolver.isManagerPagePrivileged(this.resource)&&this.items.push({cssIcon:"perun-manager",url:"".concat(e?"/organizations/".concat(this.resource.voId):"/facilities/".concat(this.resource.facilityId),"/resources/").concat(this.resource.id,"/settings/managers"),label:"MENU_ITEMS.RESOURCE.MANAGERS",style:"resource-btn"})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(r.Y36(l.gz),r.Y36(s.xk),r.Y36(o.x4),r.Y36(o.fb))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-resource-settings-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&r.ekj("router-component",t.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(r.YNc(0,g,1,0,"mat-spinner",0),r.YNc(1,h,2,2,"div",1)),2&e&&(r.Q6J("ngIf",t.loading),r.xp6(1),r.Q6J("ngIf",!t.loading))},directives:[c.O5,u.$g,d.L],styles:[""]}),e}()},77968:function(e,t,n){"use strict";n.d(t,{t:function(){return r}});var a=n(17),s=n(31572),o=n(21575),r=function(){var e=function e(){i(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-resource-settings"]],hostVars:2,hostBindings:function(e,t){2&e&&s.ekj("router-component",t.true)},decls:1,vars:0,template:function(e,t){1&e&&s._UZ(0,"app-animated-router-outlet")},directives:[o.A],styles:[""],data:{animation:[a.Ji]}}),e}()},53134:function(e,t,n){"use strict";n.d(t,{v:function(){return y}});var s=n(65249),o=n(4230),r=n(60611),l=n(84140),c=n(68416),u=n(6527),d=n(84608),g=n(31572),h=n(61511),p=n(15980),f=n(67806),m=n(4196),A=n(48160);function v(e,t){1&e&&g._UZ(0,"mat-spinner",8)}function S(e,t){if(1&e&&g._UZ(0,"app-resources-tags-list",9),2&e){var i=g.oxw();g.Q6J("selection",i.selection)("tableId",i.tableId)("resourceTags",i.resourceTags)("filterValue",i.filterValue)("displayedColumns",i.displayedColumns)("entity","resource")}}var b=function(){var e=function(){function e(t,n,a){i(this,e),this.dialogRef=t,this.data=n,this.resourcesManager=a,this.tableId=r.g,this.selection=new o.Ov(!0,[]),this.resourceTags=[],this.displayedColumns=["select","id","name"]}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.theme=this.data.theme,this.voId=this.data.voId,this.resourceId=this.data.resourceId,this.assignedTags=this.data.assignedTags,this.resourcesManager.getAllResourcesTagsForVo(this.voId).subscribe(function(t){e.resourceTags=t.filter(function(t){return e.assignedTags.map(function(e){return e.id}).indexOf(t.id)<=-1}),e.loading=!1})}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}},{key:"onSubmit",value:function(e){var t=this;if(0===e.length)return this.dialogRef.close(!0);var i=e.pop();this.resourcesManager.assignResourceTagToResource({resource:this.resourceId,resourceTag:i}).subscribe(function(){t.onSubmit(e)})}},{key:"applyFilter",value:function(e){this.filterValue=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(d.so),g.Y36(d.WI),g.Y36(s.xk))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-add-resource-tag-to-resource-dialog"]],decls:15,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],[3,"selection","tableId","resourceTags","filterValue","displayedColumns","entity",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],[3,"selection","tableId","resourceTags","filterValue","displayedColumns","entity"]],template:function(e,t){1&e&&(g.TgZ(0,"div"),g.TgZ(1,"h1",0),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"div",1),g.TgZ(5,"div",2),g.YNc(6,v,1,0,"mat-spinner",3),g.qZA(),g.YNc(7,S,1,6,"app-resources-tags-list",4),g.qZA(),g.TgZ(8,"div",5),g.TgZ(9,"button",6),g.NdJ("click",function(){return t.onCancel()}),g._uU(10),g.ALo(11,"translate"),g.qZA(),g.TgZ(12,"button",7),g.NdJ("click",function(){return t.onSubmit(t.selection.selected)}),g._uU(13),g.ALo(14,"translate"),g.qZA(),g.qZA(),g.qZA()),2&e&&(g.Tol(t.theme),g.xp6(2),g.Oqu(g.lcZ(3,9,"RESOURCE_DETAIL.TAGS.ADD_TAGS")),g.xp6(4),g.Q6J("ngIf",t.loading),g.xp6(1),g.Q6J("ngIf",!t.loading),g.xp6(3),g.hij(" ",g.lcZ(11,11,"RESOURCE_DETAIL.TAGS.CANCEL")," "),g.xp6(2),g.Q6J("disabled",t.loading||0===t.resourceTags.length),g.xp6(1),g.hij(" ",g.lcZ(14,13,"RESOURCE_DETAIL.TAGS.ADD_BUTTON")," "))},directives:[d.uh,d.xY,h.O5,d.H8,p.lW,f.$g,m.o],pipes:[A.X$],styles:[""]}),e}(),E=n(24923),R=n(59403),T=n(19139);function I(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"button",7),g.NdJ("click",function(){return g.CHM(i),g.oxw().create()}),g._uU(1),g.ALo(2,"translate"),g.qZA()}2&e&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.CREATE_BUTTON"),"\n"))}function Z(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"button",7),g.NdJ("click",function(){return g.CHM(i),g.oxw().addTag()}),g._uU(1),g.ALo(2,"translate"),g.qZA()}2&e&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"RESOURCE_DETAIL.TAGS.ADD_BUTTON"),"\n"))}function _(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"button",8),g.NdJ("click",function(){return g.CHM(i),g.oxw().removeTags()}),g._uU(1),g.ALo(2,"translate"),g.qZA()}if(2&e){var n=g.oxw();g.Q6J("disabled",0===n.selection.selected.length),g.xp6(1),g.hij(" ",g.lcZ(2,2,"RESOURCE_DETAIL.TAGS.REMOVE_BUTTON"),"\n")}}function O(e,t){1&e&&g._UZ(0,"mat-spinner",9)}function C(e,t){if(1&e&&g._UZ(0,"app-resources-tags-list",10),2&e){var i=g.oxw();g.Q6J("selection",i.selection)("tableId",i.tableId)("resourceTags",i.resourceTags)("filterValue",i.filterValue)("displayedColumns",i.displayedColumns)("entity","resource")}}var y=function(){var e=function(){function e(t,n,a,s,l,c){i(this,e),this.authResolver=t,this.resourcesManager=n,this.dialog=a,this.notificator=s,this.translate=l,this.entityStorageService=c,this.loading=!1,this.resourceTags=[],this.selection=new o.Ov(!0,[]),this.tableId=r.M8,this.displayedColumns=[]}return a(e,[{key:"ngOnInit",value:function(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.setAuthRights(),this.updateData()}},{key:"removeTags",value:function(){var e=this,t=(0,l.kZ)();t.width="450px",t.data={items:this.selection.selected.map(function(e){return e.tagName}),title:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_TITLE",description:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_DESCRIPTION",theme:"resource-theme"},this.dialog.open(u.Tf,t).afterClosed().subscribe(function(t){t&&e.removeTag(e.selection.selected)})}},{key:"removeTag",value:function(e){var t=this;if(0===e.length)return this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.REMOVED_SUCCESSFULLY")),this.updateData();var i=e.pop();this.resourcesManager.removeResourceTagFromResource({resource:this.resource.id,resourceTag:i}).subscribe(function(){t.removeTag(e)})}},{key:"addTag",value:function(){var e=this,t=(0,l.kZ)();t.width="600px",t.data={voId:this.resource.voId,resourceId:this.resource.id,assignedTags:this.resourceTags,theme:"resource-theme"},this.dialog.open(b,t).afterClosed().subscribe(function(t){t&&(e.notificator.showSuccess(e.translate.instant("RESOURCE_DETAIL.TAGS.ADDED_SUCCESSFULLY")),e.updateData())})}},{key:"create",value:function(){var e=this,t=(0,l.kZ)();t.width="450px",t.data={voId:this.resource.voId,theme:"resource-theme"},this.dialog.open(E.p,t).afterClosed().subscribe(function(t){t&&(e.translate.get("VO_DETAIL.RESOURCES.TAGS.CREATE_SUCCESS").subscribe(function(t){e.notificator.showSuccess(t)}),e.updateData())})}},{key:"updateData",value:function(){var e=this;this.loading=!0,this.selection.clear(),this.resourcesManager.getAllResourcesTagsForResource(this.resource.id).subscribe(function(t){e.resourceTags=t,e.selection.clear(),e.loading=!1})}},{key:"setAuthRights",value:function(){var e={id:this.resource.voId,beanName:"Vo"};this.displayedColumns=[],this.createAuth=this.authResolver.isAuthorized("createResourceTag_ResourceTag_Vo_policy",[e]),this.addAuth=this.authResolver.isAuthorized("assignResourceTagToResource_ResourceTag_Resource_policy",[this.resource]),this.removeAuth=this.authResolver.isAuthorized("removeResourceTagFromResource_ResourceTag_Resource_policy",[this.resource]),this.displayedColumns=this.removeAuth?["select","id","name"]:["id","name"]}},{key:"applyFilter",value:function(e){this.filterValue=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(c.x4),g.Y36(s.xk),g.Y36(d.uw),g.Y36(c.V6),g.Y36(A.sK),g.Y36(c.fb))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-perun-web-apps-resource-tags"]],decls:10,vars:9,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","class","mr-2 action-button","color","accent",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"selection","tableId","resourceTags","filterValue","displayedColumns","entity",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2","action-button",3,"click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"selection","tableId","resourceTags","filterValue","displayedColumns","entity"]],template:function(e,t){1&e&&(g.TgZ(0,"h1",0),g._uU(1),g.ALo(2,"translate"),g.qZA(),g.TgZ(3,"perun-web-apps-refresh-button",1),g.NdJ("refresh",function(){return t.updateData()}),g.qZA(),g.YNc(4,I,3,3,"button",2),g.YNc(5,Z,3,3,"button",2),g.YNc(6,_,3,4,"button",3),g.TgZ(7,"perun-web-apps-immediate-filter",4),g.NdJ("filter",function(e){return t.applyFilter(e)}),g.qZA(),g.YNc(8,O,1,0,"mat-spinner",5),g.YNc(9,C,1,6,"app-resources-tags-list",6)),2&e&&(g.xp6(1),g.Oqu(g.lcZ(2,7,"RESOURCE_DETAIL.TAGS.TITLE")),g.xp6(3),g.Q6J("ngIf",t.createAuth),g.xp6(1),g.Q6J("ngIf",t.addAuth),g.xp6(1),g.Q6J("ngIf",t.removeAuth),g.xp6(1),g.Q6J("placeholder","RESOURCE_DETAIL.TAGS.SEARCH"),g.xp6(1),g.Q6J("ngIf",t.loading),g.xp6(1),g.Q6J("ngIf",!t.loading))},directives:[R.t,h.O5,T.L,p.lW,f.$g,m.o],pipes:[A.X$],styles:[""]}),e}()},24923:function(e,t,n){"use strict";n.d(t,{p:function(){return A}});var s=n(84608),o=n(65249),r=n(31572),l=n(61511),c=n(15980),u=n(67806),d=n(66283),g=n(80340),h=n(16073),p=n(48160);function f(e,t){1&e&&r._UZ(0,"mat-spinner",6)}function m(e,t){if(1&e){var i=r.EpF();r.TgZ(0,"div",7),r.TgZ(1,"mat-form-field"),r.TgZ(2,"input",8),r.NdJ("ngModelChange",function(e){return r.CHM(i),r.oxw().name=e}),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-error"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.qZA(),r.qZA()}if(2&e){var n=r.oxw();r.xp6(2),r.s9C("placeholder",r.lcZ(3,3,"DIALOGS.CREATE_RESOURCE_TAG.NAME")),r.Q6J("ngModel",n.name),r.xp6(3),r.Oqu(r.lcZ(6,5,"DIALOGS.CREATE_RESOURCE_TAG.EMPTY_NAME"))}}var A=function(){var e=function(){function e(t,n,a){i(this,e),this.dialogRef=t,this.data=n,this.resourceManager=a,this.name="",this.loading=!1}return a(e,[{key:"ngOnInit",value:function(){this.theme=this.data.theme}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}},{key:"onSubmit",value:function(){var e=this;""!==this.name&&(this.loading=!0,this.resourceManager.createResourceTagWithTagName(this.name,this.data.voId).subscribe(function(){e.dialogRef.close(!0)},function(){return e.loading=!1}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(r.Y36(s.so),r.Y36(s.WI),r.Y36(o.xk))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-create-resource-tag-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-content","","class","dialog-container",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content","",1,"dialog-container"],["matInput","","required","",3,"placeholder","ngModel","ngModelChange"]],template:function(e,t){1&e&&(r.TgZ(0,"div"),r.TgZ(1,"h1",0),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.YNc(4,f,1,0,"mat-spinner",1),r.YNc(5,m,7,7,"div",2),r.TgZ(6,"div",3),r.TgZ(7,"button",4),r.NdJ("click",function(){return t.onCancel()}),r._uU(8),r.ALo(9,"translate"),r.qZA(),r.TgZ(10,"button",5),r.NdJ("click",function(){return t.onSubmit()}),r._uU(11),r.ALo(12,"translate"),r.qZA(),r.qZA(),r.qZA()),2&e&&(r.Tol(t.theme),r.xp6(2),r.Oqu(r.lcZ(3,9,"DIALOGS.CREATE_RESOURCE_TAG.TITLE")),r.xp6(2),r.Q6J("ngIf",t.loading),r.xp6(1),r.Q6J("ngIf",!t.loading),r.xp6(3),r.hij(" ",r.lcZ(9,11,"DIALOGS.CREATE_RESOURCE_TAG.CANCEL")," "),r.xp6(2),r.Q6J("disabled",t.loading),r.xp6(1),r.hij(" ",r.lcZ(12,13,"DIALOGS.CREATE_RESOURCE_TAG.CREATE")," "))},directives:[s.uh,l.O5,s.H8,c.lW,u.$g,s.xY,d.KE,g.Nt,h.Fj,h.Q7,h.JJ,h.On,d.TO],pipes:[p.X$],styles:[""]}),e}()},489:function(t,n,s){"use strict";s.d(n,{s:function(){return Ie}});var o=s(4230),r=s(84608),l=s(68416),c=s(65249),u=s(60611),d=s(67004),g=s(16073),h=s(31572),p=s(48160),f=s(57629),m=s(66283),A=s(4786),v=s(61511),S=s(80340),b=s(15980),E=s(71522),R=s(67806),T=s(39571),I=s(77889),Z=function(){var e=function(){function e(t){i(this,e),this.translate=t,this.prefix="ROLES."}return a(e,[{key:"transform",value:function(e){var t=this.prefix.concat(e);return this.translate.instant(t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(p.sK,16))},e.\u0275pipe=h.Yjl({name:"displayedRole",type:e,pure:!0}),e}();function _(e,t){if(1&e&&(h.TgZ(0,"mat-option",15),h._uU(1),h.ALo(2,"displayedRole"),h.qZA()),2&e){var i=t.$implicit;h.Q6J("value",i),h.xp6(1),h.Oqu(h.lcZ(2,2,i))}}function O(e,t){1&e&&h._UZ(0,"mat-spinner",16)}function C(e,t){1&e&&(h.TgZ(0,"app-alert",20),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"DIALOGS.ADD_MANAGERS.NO_USERS_FOUND")," "))}var y=function(){return["select","id","name","email","logins","organization"]};function x(e,t){if(1&e&&h._UZ(0,"app-users-list",21),2&e){var i=h.oxw(2);h.Q6J("tableId",i.tableId)("disableRouting",!0)("selection",i.selection)("displayedColumns",h.DdM(5,y))("users",i.users)}}function U(e,t){if(1&e&&(h.TgZ(0,"div",17),h.YNc(1,C,3,3,"app-alert",18),h.YNc(2,x,1,6,"app-users-list",19),h.qZA()),2&e){var i=h.oxw();h.xp6(1),h.Q6J("ngIf",0===i.users.length&&i.firstSearchDone),h.xp6(1),h.Q6J("ngIf",0!==i.users.length)}}var N=function(){var e=function(){function e(t,n,a,s,r,l,c,d,g){var h=this;i(this,e),this.dialogRef=t,this.data=n,this.authzService=a,this.usersService=s,this.translate=r,this.notificator=l,this.storeService=c,this.route=d,this.router=g,this.selection=new o.Ov(!0,[]),this.users=[],this.firstSearchDone=!1,this.tableId=u.H2,r.get("DIALOGS.ADD_MANAGERS.TITLE").subscribe(function(e){return h.title=e}),r.get("DIALOGS.ADD_MANAGERS.SUCCESS").subscribe(function(e){return h.successMessage=e})}return a(e,[{key:"ngOnInit",value:function(){this.theme=this.data.theme,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.searchCtrl=new g.NI("",[g.kI.required,g.kI.pattern(".*[\\S]+.*")])}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}},{key:"onSubmit",value:function(){var e=this;this.loading=!0,this.authzService.setRoleWithUserComplementaryObject({role:this.selectedRole,users:this.selection.selected.map(function(e){return e.id}),complementaryObject:this.data.complementaryObject}).subscribe(function(){e.notificator.showSuccess(e.successMessage),e.loading=!1,e.dialogRef.close(!0)},function(){return e.loading=!1})}},{key:"onSearchByString",value:function(){var e=this;if(this.searchCtrl.invalid)this.searchCtrl.markAllAsTouched();else{this.loading=!0,this.selection.clear();var t=[d.r.USER_DEF_ORGANIZATION,d.r.USER_DEF_PREFERRED_MAIL];t=t.concat(this.storeService.getLoginAttributeNames()),this.usersService.findRichUsersWithAttributes(this.searchCtrl.value,t).subscribe(function(t){e.users=t,e.loading=!1,e.firstSearchDone=!0},function(){return e.loading=!1})}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(r.so),h.Y36(r.WI),h.Y36(c.Ct),h.Y36(c.Fv),h.Y36(p.sK),h.Y36(l.V6),h.Y36(l.d6),h.Y36(f.gz),h.Y36(f.F0))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-add-manager-dialog"]],decls:32,vars:31,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"mr-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"mr-2","w-100"],["matInput","","autocomplete","false","data-cy","search-manager-input",3,"placeholder","formControl","keyup.enter"],["mat-flat-button","","color","accent","data-cy","search-manager-button",1,"ml-auto",3,"disabled","click"],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent","data-cy","add-manager-button-dialog",1,"ml-2",3,"disabled","click"],[3,"value"],[1,"mr-auto","ml-auto"],[1,"mt-3"],["alert_type","warn",4,"ngIf"],[3,"tableId","disableRouting","selection","displayedColumns","users",4,"ngIf"],["alert_type","warn"],[3,"tableId","disableRouting","selection","displayedColumns","users"]],template:function(e,t){1&e&&(h.TgZ(0,"div"),h.TgZ(1,"h1",0),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"div",1),h.TgZ(5,"div",2),h.TgZ(6,"mat-form-field",3),h.TgZ(7,"mat-label"),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.TgZ(10,"mat-select",4),h.NdJ("valueChange",function(e){return t.selectedRole=e}),h.YNc(11,_,3,4,"mat-option",5),h.qZA(),h.qZA(),h.TgZ(12,"mat-form-field",6),h.TgZ(13,"label"),h.TgZ(14,"input",7),h.NdJ("keyup.enter",function(){return t.onSearchByString()}),h.ALo(15,"translate"),h.qZA(),h.qZA(),h.TgZ(16,"mat-error"),h._uU(17),h.ALo(18,"translate"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(19,"button",8),h.NdJ("click",function(){return t.onSearchByString()}),h._uU(20),h.ALo(21,"translate"),h.qZA(),h.TgZ(22,"div",9),h.YNc(23,O,1,0,"mat-spinner",10),h.qZA(),h.YNc(24,U,3,2,"div",11),h.qZA(),h.TgZ(25,"div",12),h.TgZ(26,"button",13),h.NdJ("click",function(){return t.onCancel()}),h._uU(27),h.ALo(28,"translate"),h.qZA(),h.TgZ(29,"button",14),h.NdJ("click",function(){return t.onSubmit()}),h._uU(30),h.ALo(31,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.Tol(t.theme),h.xp6(2),h.Oqu(h.lcZ(3,17,"DIALOGS.ADD_MANAGERS.TITLE")),h.xp6(6),h.Oqu(h.lcZ(9,19,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),h.xp6(2),h.Q6J("value",t.selectedRole),h.xp6(1),h.Q6J("ngForOf",t.availableRoles),h.xp6(3),h.s9C("placeholder",h.lcZ(15,21,"DIALOGS.ADD_MANAGERS.DESCRIPTION")),h.Q6J("formControl",t.searchCtrl),h.xp6(3),h.hij(" ",h.lcZ(18,23,"DIALOGS.ADD_MANAGERS.EMPTY_SEARCH_MESSAGE")," "),h.xp6(2),h.Q6J("disabled",t.loading),h.xp6(1),h.hij(" ",h.lcZ(21,25,"DIALOGS.ADD_MANAGERS.SEARCH")," "),h.xp6(3),h.Q6J("ngIf",t.loading),h.xp6(1),h.Q6J("ngIf",null!==t.users&&!t.loading),h.xp6(3),h.hij(" ",h.lcZ(28,27,"DIALOGS.ADD_MANAGERS.CANCEL")," "),h.xp6(2),h.Q6J("disabled",0===t.selection.selected.length||void 0===t.selectedRole||t.loading),h.xp6(1),h.hij(" ",h.lcZ(31,29,"DIALOGS.ADD_MANAGERS.CREATE")," "))},directives:[r.uh,r.xY,m.KE,m.hX,A.gD,v.sg,S.Nt,g.Fj,g.JJ,g.oH,m.TO,b.lW,v.O5,r.H8,E.ey,R.$g,T.w,I.C],pipes:[p.X$,Z],styles:[".inline-dialog-items[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]}),e}(),G=s(67033);function L(e,t){1&e&&h._UZ(0,"th",14)}function D(e,t){if(1&e&&(h.TgZ(0,"td",15),h._uU(1),h.qZA()),2&e){var i=t.$implicit;h.xp6(1),h.AsE(" ",i.firstName," ",i.lastName,"")}}function k(e,t){1&e&&h._UZ(0,"tr",16)}function w(e,t){1&e&&h._UZ(0,"tr",17)}function M(e,t){if(1&e&&(h.TgZ(0,"div",6),h.TgZ(1,"p"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"div",7),h._uU(5),h.ALo(6,"translate"),h.qZA(),h.TgZ(7,"table",8),h.ynx(8,9),h.YNc(9,L,1,0,"th",10),h.YNc(10,D,2,2,"td",11),h.BQk(),h.YNc(11,k,1,0,"tr",12),h.YNc(12,w,1,0,"tr",13),h.qZA(),h.qZA()),2&e){var i=h.oxw();h.xp6(2),h.hij(" ",h.lcZ(3,5,"DIALOGS.REMOVE_MANAGERS.DESCRIPTION")," "),h.xp6(3),h.hij(" ",h.lcZ(6,7,"DIALOGS.REMOVE_MANAGERS.ASK")," "),h.xp6(2),h.Q6J("dataSource",i.dataSource),h.xp6(4),h.Q6J("matHeaderRowDef",i.displayedColumns),h.xp6(1),h.Q6J("matRowDefColumns",i.displayedColumns)}}function Y(e,t){1&e&&h._UZ(0,"mat-spinner",18)}var q=function(){var e=function(){function e(t,n,a,s,o){i(this,e),this.dialogRef=t,this.data=n,this.notificator=a,this.translate=s,this.authzService=o,this.displayedColumns=["name"]}return a(e,[{key:"ngOnInit",value:function(){this.dataSource=new G.by(this.data.managers),this.theme=this.data.theme}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}},{key:"onSubmit",value:function(){var e=this;this.loading=!0,this.authzService.unsetRoleWithUserComplementaryObject({role:this.data.role,users:this.data.managers.map(function(e){return e.id}),complementaryObject:this.data.complementaryObject}).subscribe(function(){e.translate.get("DIALOGS.REMOVE_MANAGERS.SUCCESS").subscribe(function(t){e.notificator.showSuccess(t),e.loading=!1,e.dialogRef.close(!0)},function(){return e.loading=!1})},function(){return e.loading=!1})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(r.so),h.Y36(r.WI),h.Y36(l.V6),h.Y36(p.sK),h.Y36(c.Ct))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-remove-manager-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content","",4,"ngIf"],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn","data-cy","remove-manager-button-dialog",1,"ml-2",3,"disabled","click"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""],[1,"mr-auto","ml-auto"]],template:function(e,t){1&e&&(h.TgZ(0,"div"),h.TgZ(1,"h1",0),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.YNc(4,M,13,9,"div",1),h.YNc(5,Y,1,0,"mat-spinner",2),h.TgZ(6,"div",3),h.TgZ(7,"button",4),h.NdJ("click",function(){return t.onCancel()}),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.TgZ(10,"button",5),h.NdJ("click",function(){return t.onSubmit()}),h._uU(11),h.ALo(12,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.Tol(t.theme),h.xp6(2),h.Oqu(h.lcZ(3,9,"DIALOGS.REMOVE_MANAGERS.TITLE")),h.xp6(2),h.Q6J("ngIf",!t.loading),h.xp6(1),h.Q6J("ngIf",t.loading),h.xp6(3),h.hij(" ",h.lcZ(9,11,"DIALOGS.REMOVE_MANAGERS.CANCEL")," "),h.xp6(2),h.Q6J("disabled",t.loading),h.xp6(1),h.hij(" ",h.lcZ(12,13,"DIALOGS.REMOVE_MANAGERS.DELETE")," "))},directives:[r.uh,v.O5,r.H8,b.lW,r.xY,G.BZ,G.w1,G.fO,G.Dz,G.as,G.nj,G.ge,G.ev,G.XQ,G.Gk,R.$g],pipes:[p.X$],styles:[""]}),e}();function J(e,t){1&e&&h._UZ(0,"mat-spinner",6)}function P(e,t){1&e&&h._UZ(0,"th",15)}function Q(e,t){if(1&e&&(h.TgZ(0,"td",16),h._uU(1),h.qZA()),2&e){var i=t.$implicit;h.xp6(1),h.hij(" ",i.name,"")}}function V(e,t){1&e&&h._UZ(0,"tr",17)}function F(e,t){1&e&&h._UZ(0,"tr",18)}function H(e,t){if(1&e&&(h.TgZ(0,"div",7),h.TgZ(1,"p"),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"div",8),h._uU(5),h.ALo(6,"translate"),h.qZA(),h.TgZ(7,"table",9),h.ynx(8,10),h.YNc(9,P,1,0,"th",11),h.YNc(10,Q,2,1,"td",12),h.BQk(),h.YNc(11,V,1,0,"tr",13),h.YNc(12,F,1,0,"tr",14),h.qZA(),h.qZA()),2&e){var i=h.oxw();h.xp6(2),h.hij(" ",h.lcZ(3,5,"DIALOGS.REMOVE_GROUPS.DESCRIPTION")," "),h.xp6(3),h.hij(" ",h.lcZ(6,7,"DIALOGS.REMOVE_GROUPS.ASK")," "),h.xp6(2),h.Q6J("dataSource",i.dataSource),h.xp6(4),h.Q6J("matHeaderRowDef",i.displayedColumns),h.xp6(1),h.Q6J("matRowDefColumns",i.displayedColumns)}}var j=function(){var e=function(){function e(t,n,a,s,o){i(this,e),this.dialogRef=t,this.data=n,this.notificator=a,this.translate=s,this.authzService=o,this.displayedColumns=["name"]}return a(e,[{key:"ngOnInit",value:function(){this.dataSource=new G.by(this.data.groups),this.theme=this.data.theme}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}},{key:"onSubmit",value:function(){var e=this;this.loading=!0,this.authzService.unsetRoleWithGroupComplementaryObject({role:this.data.role,authorizedGroups:this.data.groups.map(function(e){return e.id}),complementaryObject:this.data.complementaryObject}).subscribe(function(){e.translate.get("DIALOGS.REMOVE_GROUPS.SUCCESS").subscribe(function(t){e.notificator.showSuccess(t),e.loading=!1,e.dialogRef.close(!0)},function(){return e.loading=!1})},function(){return e.loading=!1})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(r.so),h.Y36(r.WI),h.Y36(l.V6),h.Y36(p.sK),h.Y36(c.Ct))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-remove-group-manager-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(h.TgZ(0,"div"),h.TgZ(1,"h1",0),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.YNc(4,J,1,0,"mat-spinner",1),h.YNc(5,H,13,9,"div",2),h.TgZ(6,"div",3),h.TgZ(7,"button",4),h.NdJ("click",function(){return t.onCancel()}),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.TgZ(10,"button",5),h.NdJ("click",function(){return t.onSubmit()}),h._uU(11),h.ALo(12,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e&&(h.Tol(t.theme),h.xp6(2),h.Oqu(h.lcZ(3,9,"DIALOGS.REMOVE_GROUPS.TITLE")),h.xp6(2),h.Q6J("ngIf",t.loading),h.xp6(1),h.Q6J("ngIf",!t.loading),h.xp6(3),h.hij(" ",h.lcZ(9,11,"DIALOGS.REMOVE_GROUPS.CANCEL")," "),h.xp6(2),h.Q6J("disabled",t.loading),h.xp6(1),h.hij(" ",h.lcZ(12,13,"DIALOGS.REMOVE_GROUPS.DELETE")," "))},directives:[r.uh,v.O5,r.H8,b.lW,R.$g,r.xY,G.BZ,G.w1,G.fO,G.Dz,G.as,G.nj,G.ge,G.ev,G.XQ,G.Gk],pipes:[p.X$],styles:[""]}),e}(),z=s(56238),B=s(79996),X=s(40084),$=s(91058),W=s(78364);function K(e,t){if(1&e&&(h.TgZ(0,"mat-option",17),h._uU(1),h.ALo(2,"displayedRole"),h.qZA()),2&e){var i=t.$implicit;h.Q6J("value",i),h.xp6(1),h.Oqu(h.lcZ(2,2,i))}}function ee(e,t){if(1&e&&(h.TgZ(0,"mat-option",17),h._uU(1),h.qZA()),2&e){var i=t.$implicit;h.Q6J("value",i),h.xp6(1),h.hij(" ",i.name," ")}}function te(e,t){if(1&e){var i=h.EpF();h.TgZ(0,"perun-web-apps-debounce-filter",18),h.NdJ("filter",function(e){return h.CHM(i),h.oxw().applyFilter(e)}),h.ALo(1,"translate"),h.qZA()}2&e&&h.s9C("placeholder",h.lcZ(1,1,"DIALOGS.ADD_GROUPS.FILTER_GROUPS"))}function ie(e,t){1&e&&h._UZ(0,"mat-spinner",19)}var ne=function(){return["select","id","name","description"]};function ae(e,t){if(1&e&&(h.TgZ(0,"div",20),h._UZ(1,"perun-web-apps-groups-list",21),h.qZA()),2&e){var i=h.oxw();h.xp6(1),h.Q6J("tableId",i.tableId)("disableRouting",!0)("displayedColumns",h.DdM(7,ne))("selection",i.selection)("filter",i.filterValue)("groups",i.groups)("disableMembers",!1)}}var se=function(){var e=function(){function e(t,n,a,s,r,l,c,d,h){var p=this;i(this,e),this.dialogRef=t,this.data=n,this.authzService=a,this.voService=s,this.groupService=r,this.translate=l,this.notificator=c,this.route=d,this.router=h,this.searchString="",this.selection=new o.Ov(!0,[]),this.groups=[],this.vos=[],this.filterValue="",this.myControl=new g.NI,this.firstSearchDone=!1,this.tableId=u.kZ,l.get("DIALOGS.ADD_GROUPS.TITLE").subscribe(function(e){return p.title=e}),l.get("DIALOGS.ADD_GROUPS.SUCCESS").subscribe(function(e){return p.successMessage=e})}return a(e,[{key:"displayFn",value:function(e){return e?e.name:null}},{key:"onCancel",value:function(){this.dialogRef.close()}},{key:"onSubmit",value:function(){var e=this;this.loading=!0,this.authzService.setRoleWithGroupComplementaryObject({role:this.selectedRole,authorizedGroups:this.selection.selected.map(function(e){return e.id}),complementaryObject:this.data.complementaryObject}).subscribe(function(){e.notificator.showSuccess(e.successMessage),e.loading=!1,e.dialogRef.close(!0)},function(){return e.loading=!1})}},{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.theme=this.data.theme,this.voService.getMyVos().subscribe(function(t){e.filteredOptions=e.myControl.valueChanges.pipe((0,z.O)(""),(0,B.U)(function(t){return e._filter(t)})),e.vos=t,e.loading=!1},function(){return e.loading=!1})}},{key:"_filter",value:function(e){var t="string"==typeof e?e.toLowerCase():e.name.toLowerCase;return this.vos.filter(function(e){return e.name.toLowerCase().includes(t)})}},{key:"showVoGroups",value:function(e){var t=this;this.loading=!0,this.groupService.getAllGroups(e.option.value.id).subscribe(function(e){t.groups=e,t.loading=!1,t.firstSearchDone=!0},function(){return t.loading=!1})}},{key:"applyFilter",value:function(e){this.filterValue=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(r.so),h.Y36(r.WI),h.Y36(c.Ct),h.Y36(c.YF),h.Y36(c.ff),h.Y36(p.sK),h.Y36(l.V6),h.Y36(f.gz),h.Y36(f.F0))},e.\u0275cmp=h.Xpm({type:e,selectors:[["app-add-group-manager-dialog"]],decls:33,vars:33,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"mr-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"mr-2","w-75"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"placeholder","filter",4,"ngIf"],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[3,"value"],[3,"placeholder","filter"],[1,"mr-auto","ml-auto"],[1,"mt-3"],[3,"tableId","disableRouting","displayedColumns","selection","filter","groups","disableMembers"]],template:function(e,t){if(1&e&&(h.TgZ(0,"div"),h.TgZ(1,"h1",0),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"div",1),h.TgZ(5,"div",2),h.TgZ(6,"mat-form-field",3),h.TgZ(7,"mat-label"),h._uU(8),h.ALo(9,"translate"),h.qZA(),h.TgZ(10,"mat-select",4),h.NdJ("valueChange",function(e){return t.selectedRole=e}),h.YNc(11,K,3,4,"mat-option",5),h.qZA(),h.qZA(),h.TgZ(12,"mat-form-field",6),h.TgZ(13,"mat-label"),h._uU(14),h.ALo(15,"translate"),h.qZA(),h._UZ(16,"input",7),h.ALo(17,"translate"),h.TgZ(18,"mat-autocomplete",8,9),h.NdJ("optionSelected",function(e){return t.showVoGroups(e)}),h.YNc(20,ee,2,2,"mat-option",5),h.ALo(21,"async"),h.qZA(),h.qZA(),h.qZA(),h.YNc(22,te,2,3,"perun-web-apps-debounce-filter",10),h.TgZ(23,"div",11),h.YNc(24,ie,1,0,"mat-spinner",12),h.qZA(),h.YNc(25,ae,2,8,"div",13),h.qZA(),h.TgZ(26,"div",14),h.TgZ(27,"button",15),h.NdJ("click",function(){return t.onCancel()}),h._uU(28),h.ALo(29,"translate"),h.qZA(),h.TgZ(30,"button",16),h.NdJ("click",function(){return t.onSubmit()}),h._uU(31),h.ALo(32,"translate"),h.qZA(),h.qZA(),h.qZA()),2&e){var i=h.MAs(19);h.Tol(t.theme),h.xp6(2),h.Oqu(h.lcZ(3,19,"DIALOGS.ADD_GROUPS.TITLE")),h.xp6(6),h.Oqu(h.lcZ(9,21,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),h.xp6(2),h.Q6J("value",t.selectedRole),h.xp6(1),h.Q6J("ngForOf",t.availableRoles),h.xp6(3),h.Oqu(h.lcZ(15,23,"DIALOGS.ADD_GROUPS.SELECT_VO")),h.xp6(2),h.s9C("placeholder",h.lcZ(17,25,"DIALOGS.ADD_GROUPS.SELECT_VO")),h.Q6J("formControl",t.myControl)("matAutocomplete",i),h.xp6(2),h.Q6J("displayWith",t.displayFn),h.xp6(2),h.Q6J("ngForOf",h.lcZ(21,27,t.filteredOptions)),h.xp6(2),h.Q6J("ngIf",null!==t.groups&&t.groups.length>0&&!t.loading),h.xp6(2),h.Q6J("ngIf",t.loading),h.xp6(1),h.Q6J("ngIf",null!==t.groups&&!t.loading),h.xp6(3),h.hij(" ",h.lcZ(29,29,"DIALOGS.ADD_MANAGERS.CANCEL")," "),h.xp6(2),h.Q6J("disabled",0===t.selection.selected.length||t.loading),h.xp6(1),h.hij(" ",h.lcZ(32,31,"DIALOGS.ADD_MANAGERS.CREATE")," ")}},directives:[r.uh,r.xY,m.KE,m.hX,A.gD,v.sg,S.Nt,g.Fj,X.ZL,g.JJ,g.oH,X.XC,v.O5,r.H8,b.lW,E.ey,$.P,R.$g,W.W],pipes:[p.X$,v.Ov,Z],styles:[""]}),e}(),oe=s(84140),re=s(55109),le=s(59403);function ce(e,t){1&e&&(h._uU(0),h.ALo(1,"translate")),2&e&&h.hij(" ",h.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.USER")," ")}function ue(e,t){if(1&e){var i=h.EpF();h.TgZ(0,"button",13),h.NdJ("click",function(){return h.CHM(i),h.oxw(2).addManager()}),h._uU(1),h.ALo(2,"translate"),h.qZA()}2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function de(e,t){if(1&e){var i=h.EpF();h.TgZ(0,"button",14),h.NdJ("click",function(){return h.CHM(i),h.oxw(2).removeManager()}),h._uU(1),h.ALo(2,"translate"),h.qZA()}if(2&e){var n=h.oxw(2);h.Q6J("disabled",0===n.selectionUsers.selected.length),h.xp6(1),h.hij(" ",h.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function ge(e,t){if(1&e&&(h.TgZ(0,"mat-option",15),h._uU(1),h.ALo(2,"displayedRole"),h.qZA()),2&e){var i=t.$implicit;h.Q6J("value",i),h.xp6(1),h.Oqu(h.lcZ(2,2,i))}}function he(e,t){1&e&&h._UZ(0,"mat-spinner",16)}function pe(e,t){if(1&e&&h._UZ(0,"app-users-list",17),2&e){var i=h.oxw(2);h.Q6J("tableId",i.tableId)("users",i.managers)("disableRouting",!i.routeAuth||i.disableRouting)("displayedColumns",i.displayedUserColumns)("selection",i.selectionUsers)("disableSelf",i.disableSelf)}}function fe(e,t){if(1&e){var i=h.EpF();h.TgZ(0,"perun-web-apps-refresh-button",5),h.NdJ("refresh",function(){return h.CHM(i),h.oxw().refreshUsers()}),h.qZA(),h.YNc(1,ue,3,3,"button",6),h.YNc(2,de,3,4,"button",7),h.TgZ(3,"mat-form-field",8),h.TgZ(4,"mat-label"),h._uU(5),h.ALo(6,"translate"),h.qZA(),h.TgZ(7,"mat-select",9),h.NdJ("valueChange",function(e){return h.CHM(i),h.oxw().selectedRole=e})("selectionChange",function(){return h.CHM(i),h.oxw().refreshUsers()}),h.YNc(8,ge,3,4,"mat-option",10),h.qZA(),h.qZA(),h.YNc(9,he,1,0,"mat-spinner",11),h.YNc(10,pe,1,6,"app-users-list",12)}if(2&e){var n=h.oxw();h.xp6(1),h.Q6J("ngIf",n.manageAuth&&!n.configMode),h.xp6(1),h.Q6J("ngIf",n.manageAuth&&!n.configMode),h.xp6(3),h.Oqu(h.lcZ(6,7,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),h.xp6(2),h.Q6J("value",n.selectedRole),h.xp6(1),h.Q6J("ngForOf",n.availableRoles),h.xp6(1),h.Q6J("ngIf",n.loading),h.xp6(1),h.Q6J("ngIf",!n.loading&&n.managers)}}function me(e,t){1&e&&(h._uU(0),h.ALo(1,"translate")),2&e&&h.hij(" ",h.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.GROUP")," ")}function Ae(e,t){if(1&e){var i=h.EpF();h.TgZ(0,"button",21),h.NdJ("click",function(){return h.CHM(i),h.oxw(2).addGroup()}),h._uU(1),h.ALo(2,"translate"),h.qZA()}2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function ve(e,t){if(1&e){var i=h.EpF();h.TgZ(0,"button",22),h.NdJ("click",function(){return h.CHM(i),h.oxw(2).removeGroup()}),h._uU(1),h.ALo(2,"translate"),h.qZA()}if(2&e){var n=h.oxw(2);h.Q6J("disabled",0===n.selectionGroups.selected.length),h.xp6(1),h.hij(" ",h.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function Se(e,t){if(1&e&&(h.TgZ(0,"mat-option",15),h._uU(1),h.ALo(2,"displayedRole"),h.qZA()),2&e){var i=t.$implicit;h.Q6J("value",i),h.xp6(1),h.Oqu(h.lcZ(2,2,i))}}function be(e,t){1&e&&h._UZ(0,"mat-spinner",16)}function Ee(e,t){if(1&e&&h._UZ(0,"perun-web-apps-groups-list",23),2&e){var i=h.oxw(2);h.Q6J("tableId",i.tableId)("disableRouting",i.disableRouting)("displayedColumns",i.displayedGroupColumns)("groups",i.groups)("selection",i.selectionGroups)("disableMembers",!1)}}function Re(e,t){if(1&e){var i=h.EpF();h.TgZ(0,"perun-web-apps-refresh-button",5),h.NdJ("refresh",function(){return h.CHM(i),h.oxw().refreshGroups()}),h.qZA(),h.YNc(1,Ae,3,3,"button",18),h.YNc(2,ve,3,4,"button",19),h.TgZ(3,"mat-form-field",8),h.TgZ(4,"mat-label"),h._uU(5),h.ALo(6,"translate"),h.qZA(),h.TgZ(7,"mat-select",9),h.NdJ("valueChange",function(e){return h.CHM(i),h.oxw().selectedRole=e})("selectionChange",function(){return h.CHM(i),h.oxw().refreshGroups()}),h.YNc(8,Se,3,4,"mat-option",10),h.qZA(),h.qZA(),h.YNc(9,be,1,0,"mat-spinner",11),h.YNc(10,Ee,1,6,"perun-web-apps-groups-list",20)}if(2&e){var n=h.oxw();h.xp6(1),h.Q6J("ngIf",n.manageAuth&&!n.configMode),h.xp6(1),h.Q6J("ngIf",n.manageAuth&&!n.configMode),h.xp6(3),h.Oqu(h.lcZ(6,7,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),h.xp6(2),h.Q6J("value",n.selectedRole),h.xp6(1),h.Q6J("ngForOf",n.availableRoles),h.xp6(1),h.Q6J("ngIf",n.loading),h.xp6(1),h.Q6J("ngIf",!n.loading&&n.groups)}}function Te(e,t){1&e&&(h.TgZ(0,"app-alert",24),h._uU(1),h.ALo(2,"translate"),h.qZA()),2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.NO_AVAILABLE_ROLES"),"\n"))}var Ie=function(){var t=function(){function t(e,n,a,s){i(this,t),this.dialog=e,this.authzService=n,this.storeService=a,this.guiAuthResolver=s,this.groups=null,this.managers=null,this.configMode=!1,this.disableRouting=!1,this.disableSelf=!1,this.displayedUserColumns=["select","id","name","email","logins","organization"],this.displayedGroupColumns=["select","id","vo","name","description"],this.selectionUsers=new o.Ov(!0,[]),this.selectionGroups=new o.Ov(!0,[]),this.selectedMode="",this.loading=!1,this.tableId=u.HC,this.availableRolesPrivileges=new Map}return a(t,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.guiAuthResolver.getRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(function(t){return e.availableRolesPrivileges.get(t).readAuth}),0!==this.availableRoles.length&&(this.selectedRole=this.availableRoles[0]),this.routeAuth=this.guiAuthResolver.isPerunAdminOrObserver(),this.refreshUsers()}},{key:"changeRolePrivileges",value:function(){this.manageAuth=this.availableRolesPrivileges.get(this.selectedRole).manageAuth,this.displayedUserColumns=this.manageAuth?this.displayedUserColumns:this.displayedUserColumns.filter(function(e){return"select"===e}),this.displayedGroupColumns=this.manageAuth?this.displayedGroupColumns:this.displayedGroupColumns.filter(function(e){return"select"===e}),this.roleModes=this.availableRolesPrivileges.get(this.selectedRole).modes;var t,i=!1,n=e(this.roleModes);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(this.selectedMode===a.toLowerCase()){i=!0;break}}}catch(s){n.e(s)}finally{n.f()}i||(this.selectedMode=this.roleModes[0].toLowerCase())}},{key:"tabChanged",value:function(e){this.loading=!0,0===e.index?(this.selectedMode="user",this.refreshUsers()):(this.selectedMode="group",this.refreshGroups())}},{key:"refreshUsers",value:function(){var e=this;this.loading=!0,this.changeRolePrivileges();var t=[d.r.USER_DEF_ORGANIZATION,d.r.USER_DEF_PREFERRED_MAIL];t=t.concat(this.storeService.getLoginAttributeNames()),this.authzService.getAuthzRichAdmins(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType,t,!1,!0).subscribe(function(t){e.managers=t,e.selectionUsers.clear(),e.loading=!1},function(){e.loading=!1})}},{key:"refreshGroups",value:function(){var e=this;this.loading=!0,this.changeRolePrivileges(),this.authzService.getAuthzAdminGroups(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType).subscribe(function(t){e.groups=t,e.selectionGroups.clear(),e.loading=!1},function(){e.loading=!1})}},{key:"addManager",value:function(){var e=this,t=(0,oe.kZ)();t.width="1000px",t.data={complementaryObject:this.complementaryObject,theme:this.theme,availableRoles:this.availableRoles,selectedRole:this.selectedRole},this.dialog.open(N,t).afterClosed().subscribe(function(t){t&&e.refreshUsers()})}},{key:"removeManager",value:function(){var e=this,t=(0,oe.kZ)();t.width="450px",t.data={managers:this.selectionUsers.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(q,t).afterClosed().subscribe(function(t){t&&e.refreshUsers()})}},{key:"removeGroup",value:function(){var e=this,t=(0,oe.kZ)();t.width="450px",t.data={groups:this.selectionGroups.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(j,t).afterClosed().subscribe(function(t){t&&e.refreshGroups()})}},{key:"addGroup",value:function(){var e=this,t=(0,oe.kZ)();t.width="1000px",t.data={complementaryObject:this.complementaryObject,availableRoles:this.availableRoles,theme:this.theme,selectedRole:this.selectedRole},this.dialog.open(se,t).afterClosed().subscribe(function(t){t&&e.refreshGroups()})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(h.Y36(r.uw),h.Y36(c.Ct),h.Y36(l.d6),h.Y36(l.x4))},t.\u0275cmp=h.Xpm({type:t,selectors:[["app-managers-page"]],hostVars:2,hostBindings:function(e,t){2&e&&h.ekj("router-component",t.true)},inputs:{complementaryObject:"complementaryObject",availableRoles:"availableRoles",complementaryObjectType:"complementaryObjectType",theme:"theme",configMode:"configMode",disableRouting:"disableRouting",disableSelf:"disableSelf",displayedUserColumns:"displayedUserColumns",displayedGroupColumns:"displayedGroupColumns"},decls:11,vars:4,consts:[[1,"page-subtitle"],[3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["alert_type","warn",4,"ngIf"],[1,"mt-2",3,"refresh"],["mat-flat-button","","color","accent","class","mr-2 mt-2 action-button","data-cy","add-manager-button",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2 mt-2","data-cy","remove-manager-button",3,"disabled","click",4,"ngIf"],[1,"mr-2","mt-2"],[3,"value","valueChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","users","disableRouting","displayedColumns","selection","disableSelf",4,"ngIf"],["mat-flat-button","","color","accent","data-cy","add-manager-button",1,"mr-2","mt-2","action-button",3,"click"],["mat-flat-button","","color","warn","data-cy","remove-manager-button",1,"mr-2","mt-2",3,"disabled","click"],[3,"value"],[1,"ml-auto","mr-auto"],[3,"tableId","users","disableRouting","displayedColumns","selection","disableSelf"],["mat-flat-button","","color","accent","class","mr-2 mt-2 action-button",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2 mt-2",3,"disabled","click",4,"ngIf"],[3,"tableId","disableRouting","displayedColumns","groups","selection","disableMembers",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2","mt-2","action-button",3,"click"],["mat-flat-button","","color","warn",1,"mr-2","mt-2",3,"disabled","click"],[3,"tableId","disableRouting","displayedColumns","groups","selection","disableMembers"],["alert_type","warn"]],template:function(e,t){1&e&&(h.TgZ(0,"h1",0),h._uU(1),h.ALo(2,"translate"),h.qZA(),h.TgZ(3,"mat-tab-group",1),h.NdJ("selectedTabChange",function(e){return t.tabChanged(e)}),h.TgZ(4,"mat-tab"),h.YNc(5,ce,2,3,"ng-template",2),h.YNc(6,fe,11,9,"ng-template",3),h.qZA(),h.TgZ(7,"mat-tab"),h.YNc(8,me,2,3,"ng-template",2),h.YNc(9,Re,11,9,"ng-template",3),h.qZA(),h.qZA(),h.YNc(10,Te,3,3,"app-alert",4)),2&e&&(h.xp6(1),h.hij(" ",h.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.TITLE"),"\n"),h.xp6(9),h.Q6J("ngIf",0===t.availableRoles.length))},directives:[re.SP,re.uX,re.uD,re.Vc,v.O5,le.t,m.KE,m.hX,A.gD,v.sg,b.lW,E.ey,R.$g,I.C,W.W,T.w],pipes:[p.X$,Z],styles:[""]}),t}()},4196:function(e,t,n){"use strict";n.d(t,{o:function(){return Y}});var s=n(58623),o=n(67033),r=n(4230),l=n(68416),c=n(65249),u=n(84140),d=n(31572),g=n(48160),h=n(82819),p=n(61511),f=n(29236),m=n(66283),A=n(80340),v=n(16073),S=n(15980),b=n(36922),E=n(43691),R=n(39571);function T(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"th",16),d.TgZ(1,"mat-checkbox",17),d.NdJ("change",function(e){d.CHM(i);var t=d.oxw();return e?t.masterToggle():null}),d.qZA(),d.qZA()}if(2&e){var n=d.oxw();d.xp6(1),d.Q6J("aria-label",n.checkboxLabel())("checked",n.selection.hasValue()&&n.isAllSelected())("indeterminate",n.selection.hasValue()&&!n.isAllSelected())}}function I(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"td",18),d.TgZ(1,"mat-checkbox",19),d.NdJ("change",function(e){var t=d.CHM(i).$implicit,n=d.oxw();return e?n.selection.toggle(t):null})("click",function(e){return e.stopPropagation()}),d.qZA(),d.qZA()}if(2&e){var n=t.$implicit,a=d.oxw();d.xp6(1),d.Q6J("aria-label",a.checkboxLabel(n))("checked",a.selection.isSelected(n))}}function Z(e,t){1&e&&(d.TgZ(0,"th",20),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_ID")))}function _(e,t){if(1&e&&(d.TgZ(0,"td",21),d._uU(1),d.qZA()),2&e){var i=t.$implicit;d.xp6(1),d.Oqu(i.id)}}function O(e,t){1&e&&(d.TgZ(0,"th",22),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_NAME")))}function C(e,t){if(1&e&&(d.TgZ(0,"div"),d._uU(1),d.qZA()),2&e){var i=d.oxw().$implicit;d.xp6(1),d.hij(" ",i.tagName," ")}}function y(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"div"),d.TgZ(1,"mat-form-field"),d.TgZ(2,"input",25),d.NdJ("ngModelChange",function(e){return d.CHM(i),d.oxw().$implicit.tagName=e}),d.qZA(),d.qZA(),d.qZA()}if(2&e){var n=d.oxw().$implicit;d.xp6(2),d.Q6J("ngModel",n.tagName)}}function x(e,t){if(1&e&&(d.TgZ(0,"td",23),d.YNc(1,C,2,1,"div",24),d.YNc(2,y,3,1,"div",24),d.qZA()),2&e){var i=t.$implicit,n=d.oxw();d.xp6(1),d.Q6J("ngIf",!n.isChanging.isSelected(i)),d.xp6(1),d.Q6J("ngIf",n.isChanging.isSelected(i))}}function U(e,t){1&e&&d._UZ(0,"th",22)}function N(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"button",28),d.NdJ("click",function(){d.CHM(i);var e=d.oxw().$implicit;return d.oxw().edit(e)}),d.ALo(1,"translate"),d.TgZ(2,"mat-icon"),d._uU(3,"edit"),d.qZA(),d.qZA()}2&e&&d.s9C("matTooltip",d.lcZ(1,1,"VO_DETAIL.RESOURCES.TAGS.EDIT_BUTTON"))}function G(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"button",28),d.NdJ("click",function(){d.CHM(i);var e=d.oxw().$implicit;return d.oxw().save(e)}),d.ALo(1,"translate"),d.TgZ(2,"mat-icon"),d._uU(3,"save"),d.qZA(),d.qZA()}2&e&&d.s9C("matTooltip",d.lcZ(1,1,"VO_DETAIL.RESOURCES.TAGS.SAVE_BUTTON"))}function L(e,t){if(1&e&&(d.TgZ(0,"td",23),d.TgZ(1,"div",26),d.YNc(2,N,4,3,"button",27),d.YNc(3,G,4,3,"button",27),d.qZA(),d.qZA()),2&e){var i=t.$implicit,n=d.oxw();d.xp6(2),d.Q6J("ngIf",!n.isChanging.isSelected(i)),d.xp6(1),d.Q6J("ngIf",n.isChanging.isSelected(i))}}function D(e,t){1&e&&d._UZ(0,"tr",29)}function k(e,t){1&e&&d._UZ(0,"tr",30)}function w(e,t){if(1&e&&(d.TgZ(0,"app-alert",31),d._uU(1),d.ALo(2,"translate"),d.ALo(3,"translate"),d.qZA()),2&e){var i=d.oxw();d.xp6(1),d.hij(" ","vo"===i.entity?d.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.NO_TAGS"):d.lcZ(3,3,"RESOURCE_DETAIL.TAGS.NO_TAGS"),"\n")}}function M(e,t){1&e&&(d.TgZ(0,"app-alert",31),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.hij(" ",d.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}var Y=function(){var e=function(){function e(t,n,a,s,o){i(this,e),this.resourceManager=t,this.notificator=n,this.translator=a,this.authResolver=s,this.tableCheckbox=o,this.resourceTags=[],this.selection=new r.Ov(!0,[]),this.displayedColumns=["select","id","name","edit"],this.isChanging=new r.Ov(!0,[]),this.pageSizeOptions=u.f7}return a(e,[{key:"matSort",set:function(e){this.sort=e,this.setDataSource()}},{key:"ngOnChanges",value:function(){this.authResolver.isPerunAdminOrObserver()||(this.displayedColumns=this.displayedColumns.filter(function(e){return"id"!==e})),this.dataSource=new o.by(this.resourceTags),this.setDataSource()}},{key:"ngAfterViewInit",value:function(){this.dataSource.paginator=this.child.paginator}},{key:"getDataForColumn",value:function(e,t){switch(t){case"id":return e.id.toString();case"name":return e.tagName;default:return""}}},{key:"exportData",value:function(e){(0,u.O6)((0,u.Xn)(this.dataSource.filteredData,this.displayedColumns,this.getDataForColumn,this),e)}},{key:"setDataSource",value:function(){var e=this;this.dataSource&&(this.dataSource.filterPredicate=function(t,i){return(0,u.Sd)(t,i,e.displayedColumns,e.getDataForColumn,e)},this.dataSource.sortData=function(t,i){return(0,u.pR)(t,i,e.getDataForColumn,e)},this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue)}},{key:"isAllSelected",value:function(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.child.paginator.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}},{key:"masterToggle",value:function(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}},{key:"checkboxLabel",value:function(e){return e?"".concat(this.selection.isSelected(e)?"deselect":"select"," row ").concat(e.id+1):(this.isAllSelected()?"select":"deselect")+" all"}},{key:"save",value:function(e){var t=this;this.resourceManager.updateResourceTag({resourceTag:e}).subscribe(function(){t.translator.get("SHARED.COMPONENTS.RESOURCES_TAGS_LIST.EDIT_SUCCESS").subscribe(function(e){t.notificator.showSuccess(e)}),t.isChanging.deselect(e)})}},{key:"edit",value:function(e){this.isChanging.select(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(d.Y36(c.xk),d.Y36(l.V6),d.Y36(g.sK),d.Y36(l.x4),d.Y36(l.UA))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-resources-tags-list"]],viewQuery:function(e,t){var i;(1&e&&(d.Gf(s.YE,7),d.Gf(u.l9,7)),2&e)&&(d.iGM(i=d.CRH())&&(t.matSort=i.first),d.iGM(i=d.CRH())&&(t.child=i.first))},inputs:{resourceTags:"resourceTags",filterValue:"filterValue",selection:"selection",tableId:"tableId",displayedColumns:"displayedColumns",entity:"entity"},features:[d.TTD],decls:19,vars:9,consts:[[1,"card","mt-2",3,"hidden"],[3,"tableId","dataLength","pageSizeOptions","exportData"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","","class","align-checkbox",4,"matHeaderCellDef"],["class","static-column-size align-checkbox","mat-cell","",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","edit"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell","",1,"align-checkbox"],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size","align-checkbox"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"static-column-size"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],["matInput","",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-end"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","",3,"matTooltip","click"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"],["alert_type","warn"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.TgZ(1,"perun-web-apps-table-wrapper",1),d.NdJ("exportData",function(e){return t.exportData(e)}),d.TgZ(2,"table",2),d.ynx(3,3),d.YNc(4,T,2,3,"th",4),d.YNc(5,I,2,2,"td",5),d.BQk(),d.ynx(6,6),d.YNc(7,Z,3,3,"th",7),d.YNc(8,_,2,1,"td",8),d.BQk(),d.ynx(9,9),d.YNc(10,O,3,3,"th",10),d.YNc(11,x,3,2,"td",11),d.BQk(),d.ynx(12,12),d.YNc(13,U,1,0,"th",10),d.YNc(14,L,4,2,"td",11),d.BQk(),d.YNc(15,D,1,0,"tr",13),d.YNc(16,k,1,0,"tr",14),d.qZA(),d.qZA(),d.qZA(),d.YNc(17,w,4,5,"app-alert",15),d.YNc(18,M,3,3,"app-alert",15)),2&e&&(d.Q6J("hidden",0===t.resourceTags.length||0===t.dataSource.filteredData.length),d.xp6(1),d.Q6J("tableId",t.tableId)("dataLength",t.dataSource.filteredData.length)("pageSizeOptions",t.pageSizeOptions),d.xp6(1),d.Q6J("dataSource",t.dataSource),d.xp6(13),d.Q6J("matHeaderRowDef",t.displayedColumns),d.xp6(1),d.Q6J("matRowDefColumns",t.displayedColumns),d.xp6(1),d.Q6J("ngIf",0===t.resourceTags.length),d.xp6(1),d.Q6J("ngIf",0===t.dataSource.filteredData.length&&0!==t.resourceTags.length))},directives:[h.l,o.BZ,s.YE,o.w1,o.fO,o.Dz,o.as,o.nj,p.O5,o.ge,f.oG,o.ev,s.nU,m.KE,A.Nt,v.Fj,v.JJ,v.On,S.lW,b.gM,E.Hw,o.XQ,o.Gk,R.w],pipes:[g.X$],styles:[""]}),e}()},65267:function(e,t,n){"use strict";n.d(t,{F:function(){return r}});var a=n(31572),s=n(44973),o=n(48160),r=function(){var e=function e(){i(this,e),this.servicePackages=[],this.selectedPackage=null,this.multiple=!1,this.disableAutoSelect=!1,this.theme="",this.packageSelected=new a.vpe,this.nameFunction=function(e){return e.name},this.shortNameFunction=function(e){return e.description},this.searchFunction=function(e){return e.name+e.description}};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Xpm({type:e,selectors:[["perun-web-apps-service-package-search-select"]],inputs:{servicePackages:"servicePackages",selectedPackage:"selectedPackage",multiple:"multiple",disableAutoSelect:"disableAutoSelect",theme:"theme"},outputs:{packageSelected:"packageSelected"},decls:4,vars:17,consts:[[3,"entities","entity","multiple","disableAutoSelect","searchFunction","mainTextFunction","secondaryTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","theme","entitySelected"]],template:function(e,t){1&e&&(a.TgZ(0,"perun-web-apps-entity-search-select",0),a.NdJ("entitySelected",function(e){return t.packageSelected.emit(e)}),a.ALo(1,"translate"),a.ALo(2,"translate"),a.ALo(3,"translate"),a.qZA()),2&e&&a.Q6J("entities",t.servicePackages)("entity",t.selectedPackage)("multiple",t.multiple)("disableAutoSelect",t.disableAutoSelect)("searchFunction",t.searchFunction)("mainTextFunction",t.nameFunction)("secondaryTextFunction",t.shortNameFunction)("selectPlaceholder",a.lcZ(1,11,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.SELECT_PACKAGE"))("findPlaceholder",a.lcZ(2,13,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.FIND_PACKAGE"))("noEntriesText",a.lcZ(3,15,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.NO_PACKAGE_FOUND"))("theme",t.theme)},directives:[s.i],pipes:[o.X$],styles:[""]}),e}()}}])}();