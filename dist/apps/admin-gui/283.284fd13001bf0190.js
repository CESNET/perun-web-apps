"use strict";(self.webpackChunkadmin_gui=self.webpackChunkadmin_gui||[]).push([[283],{61283:(F,L,s)=>{s.d(L,{A:()=>d});var t=s(36769),u=s(94650),M=s(82761);class d{prepareRoute(h){return h?.activatedRouteData&&null!==h?.activatedRouteData.animation}}d.\u0275fac=function(h){return new(h||d)},d.\u0275cmp=u.Xpm({type:d,selectors:[["app-animated-router-outlet"]],decls:3,vars:0,consts:[["outlet","outlet"]],template:function(h,a){1&h&&(u.TgZ(0,"div"),u._UZ(1,"router-outlet",null,0),u.qZA())},dependencies:[M.lC],data:{animation:[t.Ji]}})},71103:(F,L,s)=>{s.d(L,{n:()=>U});var t=s(7274),u=s(95017),M=s(95243),d=s(61744),i=s(15466),a=(s(37433),s(94650)),p=s(89383),e=s(36895),P=s(4859),D=s(98380),N=s(68530),R=s(7434),A=s(6881),C=s(73358);const y=["list"];function I(O,m){1&O&&(a.TgZ(0,"perun-web-apps-alert",11),a._uU(1),a.ALo(2,"translate"),a.qZA()),2&O&&(a.xp6(1),a.hij(" ",a.lcZ(2,1,"DIALOGS.CREATE_ATTRIBUTE.ERROR_EMPTY_VALUE")," "))}function _(O,m){1&O&&a._UZ(0,"perun-web-apps-loading-table")}function v(O,m){if(1&O&&a._UZ(0,"perun-web-apps-attributes-list",12,13),2&O){const r=a.oxw();a.Q6J("emptyListText","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.EMPTY_ATTRIBUTES")("attributes",r.attributes)("filterValue",r.filterValue)("inDialog",!0)("selection",r.selected)("tableId",r.tableId)}}class U{constructor(m,r,g,S,G){this.dialogRef=m,this.data=r,this.attributesManager=g,this.notificator=S,this.translate=G,this.attributes=[],this.selected=new u.Ov(!0,[]),this.showError=!1,this.filterValue="",this.tableId=i.rF,this.translate.get("DIALOGS.CREATE_ATTRIBUTE.SUCCESS_SAVE").subscribe(w=>this.saveSuccessMessage=w)}ngOnInit(){const m=new Array;let r,g,S,G,w,W,T,c;switch(this.data.notEmptyAttributes.forEach(l=>{m.push(l.id)}),this.data.entity){case"member":r=this.data.entityId;break;case"user":g=this.data.entityId;break;case"vo":S=this.data.entityId;break;case"group":G=this.data.entityId;break;case"resource":w=this.data.entityId;break;case"facility":W=this.data.entityId;break;case"host":T=this.data.entityId;break;case"ues":c=this.data.entityId}switch(this.data.secondEntity){case"member":r=this.data.secondEntityId;break;case"user":g=this.data.secondEntityId;break;case"vo":S=this.data.secondEntityId;break;case"group":G=this.data.secondEntityId;break;case"resource":w=this.data.secondEntityId;break;case"facility":W=this.data.secondEntityId;break;case"host":T=this.data.secondEntityId;break;case"ues":c=this.data.secondEntityId}this.loading=!0,this.attributesManager.getAttributesDefinitionWithRights(r,g,S,G,w,W,T,c).subscribe(l=>{this.attributes=l,this.attributes=this.attributes.filter(x=>!m.includes(x.id)&&this.twoEntityValid(x)),this.loading=!1})}onCancel(){this.dialogRef.close()}onSave(){this.list.updateMapAttributes();let m=!1;for(const r of this.selected.selected)"java.util.ArrayList"===r.type&&0===r.value.length&&(m=!0),void 0===r.value&&(m=!0);if(m)return this.showError=!0,void setTimeout(()=>{this.showError=!1},5e3);switch(this.data.entity){case"facility":"user"===this.data.secondEntity?this.attributesManager.setUserFacilityAttributes({facility:this.data.entityId,user:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()}):this.attributesManager.setFacilityAttributes({facility:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"group":"resource"===this.data.secondEntity?this.attributesManager.setGroupResourceAttributes({group:this.data.entityId,resource:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()}):this.attributesManager.setGroupAttributes({group:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"member":switch(this.data.secondEntity){case"resource":this.attributesManager.setMemberResourceAttributes({member:this.data.entityId,resource:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"group":this.attributesManager.setMemberGroupAttributes({member:this.data.entityId,group:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;default:this.attributesManager.setMemberAttributes({member:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()})}break;case"resource":switch(this.data.secondEntity){case"member":this.attributesManager.setMemberResourceAttributes({resource:this.data.entityId,member:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"group":this.attributesManager.setGroupResourceAttributes({resource:this.data.entityId,group:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;default:this.attributesManager.setResourceAttributes({resource:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()})}break;case"user":"facility"===this.data.secondEntity?this.attributesManager.setUserFacilityAttributes({user:this.data.entityId,facility:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()}):this.attributesManager.setUserAttributes({user:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"vo":this.attributesManager.setVoAttributes({vo:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"host":this.attributesManager.setHostAttributes({host:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"ues":this.attributesManager.setUserExtSourceAttributes({userExtSource:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()})}}applyFilter(m){this.filterValue=m}handleSuccess(){this.notificator.showSuccess(this.saveSuccessMessage),this.selected.clear(),this.dialogRef.close("saved")}twoEntityValid(m){return!this.data.secondEntity||m.entity===`${this.data.entity}_${this.data.secondEntity}`||m.entity===`${this.data.secondEntity}_${this.data.entity}`}}U.\u0275fac=function(m){return new(m||U)(a.Y36(t.so),a.Y36(t.WI),a.Y36(d.H8),a.Y36(M.V6),a.Y36(p.sK))},U.\u0275cmp=a.Xpm({type:U,selectors:[["app-create-attribute-dialog"]],viewQuery:function(m,r){if(1&m&&a.Gf(y,5),2&m){let g;a.iGM(g=a.CRH())&&(r.list=g.first)}},decls:19,vars:17,consts:[["mat-dialog-title",""],[1,"page-subtitle"],["data-cy","filter-attributes",1,"font-size-1rem",3,"placeholder","filter"],["class","ms-3 font-size-1rem","alert_type","error",4,"ngIf"],["mat-dialog-content",""],["spinner",""],[1,"position-relative"],[3,"emptyListText","attributes","filterValue","inDialog","selection","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-actions",""],["mat-flat-button","",1,"ms-auto",3,"click"],["color","accent","data-cy","save-selected-attributes","mat-flat-button","",1,"ms-2",3,"disabled","click"],["alert_type","error",1,"ms-3","font-size-1rem"],[3,"emptyListText","attributes","filterValue","inDialog","selection","tableId"],["list",""]],template:function(m,r){if(1&m&&(a.TgZ(0,"div")(1,"div",0)(2,"h1",1),a._uU(3),a.ALo(4,"translate"),a.qZA(),a.TgZ(5,"perun-web-apps-immediate-filter",2),a.NdJ("filter",function(S){return r.applyFilter(S)}),a.qZA(),a.YNc(6,I,3,3,"perun-web-apps-alert",3),a.qZA(),a.TgZ(7,"div",4),a.YNc(8,_,1,0,"ng-template",null,5,a.W1O),a.TgZ(10,"div",6),a.YNc(11,v,2,6,"perun-web-apps-attributes-list",7),a.qZA()(),a.TgZ(12,"div",8)(13,"button",9),a.NdJ("click",function(){return r.onCancel()}),a._uU(14),a.ALo(15,"translate"),a.qZA(),a.TgZ(16,"button",10),a.NdJ("click",function(){return r.onSave()}),a._uU(17),a.ALo(18,"translate"),a.qZA()()()),2&m){const g=a.MAs(9);a.Tol(r.data.style),a.xp6(3),a.Oqu(a.lcZ(4,11,"DIALOGS.CREATE_ATTRIBUTE.SET_NEW")),a.xp6(2),a.Q6J("placeholder","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.FILTER"),a.xp6(1),a.Q6J("ngIf",r.showError),a.xp6(5),a.Q6J("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",g),a.xp6(3),a.hij(" ",a.lcZ(15,13,"DIALOGS.CREATE_ATTRIBUTE.CANCEL")," "),a.xp6(2),a.Q6J("disabled",0===r.selected.selected.length),a.xp6(1),a.hij(" ",a.lcZ(18,15,"DIALOGS.CREATE_ATTRIBUTE.SAVE")," ")}},dependencies:[e.O5,P.lW,t.uh,t.xY,t.H8,D.w,N.K,R.L,A.p,C.e,p.X$],styles:[".font-size-1rem[_ngcontent-%COMP%]{font-size:1rem!important}"]})},61365:(F,L,s)=>{s.d(L,{k:()=>y});var t=s(7274),u=s(30671),M=s(95243),d=s(61744),i=s(94650),h=s(89383),a=s(4859),p=s(97403),e=s(73358);function P(I,_){1&I&&i._UZ(0,"perun-web-apps-loading-dialog")}function D(I,_){1&I&&i._UZ(0,"th",14)}function N(I,_){if(1&I&&(i.TgZ(0,"td",15),i._uU(1),i.qZA()),2&I){const v=_.$implicit;i.xp6(1),i.Oqu(v.displayName)}}function R(I,_){1&I&&i._UZ(0,"tr",16)}function A(I,_){1&I&&i._UZ(0,"tr",17)}function C(I,_){if(1&I){const v=i.EpF();i.TgZ(0,"div")(1,"h1",2),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"div",3)(5,"div"),i._uU(6),i.ALo(7,"translate"),i.qZA(),i.TgZ(8,"div",4),i._uU(9),i.ALo(10,"translate"),i.qZA(),i.TgZ(11,"table",5),i.ynx(12,6),i.YNc(13,D,1,0,"th",7),i.YNc(14,N,2,1,"td",8),i.BQk(),i.YNc(15,R,1,0,"tr",9),i.YNc(16,A,1,0,"tr",10),i.qZA()(),i.TgZ(17,"div",11)(18,"button",12),i.NdJ("click",function(){i.CHM(v);const O=i.oxw();return i.KtG(O.onCancel())}),i._uU(19),i.ALo(20,"translate"),i.qZA(),i.TgZ(21,"button",13),i.NdJ("click",function(){i.CHM(v);const O=i.oxw();return i.KtG(O.onSubmit())}),i._uU(22),i.ALo(23,"translate"),i.qZA()()()}if(2&I){const v=i.oxw();i.xp6(2),i.Oqu(i.lcZ(3,9,"DIALOGS.DELETE_ATTRIBUTES.TITLE")),i.xp6(4),i.hij(" ",i.lcZ(7,11,"DIALOGS.DELETE_ATTRIBUTES.DESCRIPTION")," "),i.xp6(3),i.hij(" ",i.lcZ(10,13,"DIALOGS.DELETE_ATTRIBUTES.ASK")," "),i.xp6(2),i.Q6J("dataSource",v.dataSource),i.xp6(4),i.Q6J("matHeaderRowDef",v.displayedColumns),i.xp6(1),i.Q6J("matRowDefColumns",v.displayedColumns),i.xp6(3),i.hij(" ",i.lcZ(20,15,"DIALOGS.DELETE_ATTRIBUTES.CANCEL")," "),i.xp6(2),i.Q6J("disabled",v.loading),i.xp6(1),i.hij(" ",i.lcZ(23,17,"DIALOGS.DELETE_ATTRIBUTES.DELETE")," ")}}class y{constructor(_,v,U,O,m){this.dialogRef=_,this.data=v,this.notificator=U,this.translate=O,this.attributesManager=m,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.dataSource=new u.by(this.data.attributes),this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){const _=[];for(const U of this.data.attributes)_.push(U.id);const v={};switch(v[this.data.entity]=this.data.entityId,v.attributes=_,void 0!==this.data.secondEntity&&(v[this.data.secondEntity]=this.data.secondEntityId),this.loading=!0,this.data.entity){case"vo":this.attributesManager.removeVoAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"group":"resource"===this.data.secondEntity?this.attributesManager.removeGroupResourceAttributes(this.data.entityId,this.data.secondEntityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1}):this.attributesManager.removeGroupAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"user":"facility"===this.data.secondEntity?this.attributesManager.removeUserFacilityAttributes(this.data.entityId,this.data.secondEntityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1}):this.attributesManager.removeUserAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"member":switch(this.data.secondEntity){case"resource":this.attributesManager.removeMemberResourceAttributes(this.data.entityId,this.data.secondEntityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"group":this.attributesManager.removeMemberGroupAttributes(this.data.entityId,this.data.secondEntityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;default:this.attributesManager.removeMemberAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1})}break;case"facility":"user"===this.data.secondEntity?this.attributesManager.removeUserFacilityAttributes(this.data.secondEntityId,this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1}):this.attributesManager.removeFacilityAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"host":this.attributesManager.removeHostAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"ues":this.attributesManager.removeUesAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"resource":switch(this.data.secondEntity){case"member":this.attributesManager.removeMemberResourceAttributes(this.data.secondEntityId,this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"group":this.attributesManager.removeGroupResourceAttributes(this.data.secondEntityId,this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;default:this.attributesManager.removeResourceAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1})}}}onSuccess(){this.translate.get("DIALOGS.DELETE_ATTRIBUTES.SUCCESS").subscribe(_=>{this.notificator.showSuccess(_),this.dialogRef.close(!0)})}}y.\u0275fac=function(_){return new(_||y)(i.Y36(t.so),i.Y36(t.WI),i.Y36(M.V6),i.Y36(h.sK),i.Y36(d.H8))},y.\u0275cmp=i.Xpm({type:y,selectors:[["app-delete-attribute-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-flat-button","",1,"ms-auto",3,"click"],["color","warn","data-cy","delete-attributes","mat-flat-button","",1,"ms-2",3,"disabled","click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(_,v){if(1&_&&(i.YNc(0,P,1,0,"ng-template",null,0,i.W1O),i.TgZ(2,"div"),i.YNc(3,C,24,19,"div",1),i.qZA()),2&_){const U=i.MAs(1);i.xp6(2),i.Gre("",v.theme," position-relative"),i.xp6(1),i.Q6J("perunWebAppsLoader",v.loading)("perunWebAppsLoaderIndicator",U)}},dependencies:[a.lW,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk,t.uh,t.xY,t.H8,p.b,e.e,h.X$]})},1415:(F,L,s)=>{s.d(L,{l:()=>D});var t=s(94650),u=s(37433),M=s(4859),d=s(7274),i=s(97403),h=s(29926),a=s(73358),p=s(89383);function e(N,R){1&N&&t._UZ(0,"perun-web-apps-loading-dialog")}function P(N,R){if(1&N){const A=t.EpF();t.TgZ(0,"div")(1,"h1",2),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",3),t._UZ(5,"perun-web-apps-ban-specification",4),t.qZA(),t.TgZ(6,"div",5)(7,"button",6),t.NdJ("click",function(){t.CHM(A);const y=t.oxw();return t.KtG(y.cancel.emit())}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"button",7),t.NdJ("click",function(){t.CHM(A);const y=t.oxw();return t.KtG(y.updateBan())}),t._uU(11),t.ALo(12,"translate"),t.qZA()()()}if(2&N){const A=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,5,"DIALOGS.UPDATE_BAN.TITLE")),t.xp6(3),t.Q6J("description",A.ban.description)("validity",A.ban.validityTo),t.xp6(3),t.hij(" ",t.lcZ(9,7,"DIALOGS.UPDATE_BAN.CANCEL")," "),t.xp6(3),t.hij(" ",t.lcZ(12,9,"DIALOGS.UPDATE_BAN.UPDATE")," ")}}class D{constructor(){this.loading=!1,this.cancel=new t.vpe,this.update=new t.vpe}updateBan(){this.update.emit({description:this.banForm.getDescription(),validity:this.banForm.getValidity()})}}D.\u0275fac=function(R){return new(R||D)},D.\u0275cmp=t.Xpm({type:D,selectors:[["app-update-ban-dialog"]],viewQuery:function(R,A){if(1&R&&t.Gf(u.CZ,5),2&R){let C;t.iGM(C=t.CRH())&&(A.banForm=C.first)}},inputs:{loading:"loading",ban:"ban",theme:"theme"},outputs:{cancel:"cancel",update:"update"},decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[3,"description","validity"],["mat-dialog-actions",""],["mat-flat-button","",1,"ms-auto","me-2",3,"click"],["mat-flat-button","","color","accent",3,"click"]],template:function(R,A){if(1&R&&(t.YNc(0,e,1,0,"ng-template",null,0,t.W1O),t.TgZ(2,"div"),t.YNc(3,P,13,11,"div",1),t.qZA()),2&R){const C=t.MAs(1);t.xp6(2),t.Gre("",A.theme," position-relative"),t.xp6(1),t.Q6J("perunWebAppsLoader",A.loading)("perunWebAppsLoaderIndicator",C)}},dependencies:[M.lW,d.uh,d.xY,d.H8,i.b,h.C,a.e,p.X$]})},28943:(F,L,s)=>{s.d(L,{e:()=>h});var t=s(7274),u=s(61744),M=s(95243),d=s(94650),i=s(1415);class h{constructor(p,e,P,D){this.data=p,this.dialogRef=e,this.resourceService=P,this.notificator=D,this.loading=!1}update(p){this.loading=!0,this.resourceService.updateResourceBan({banOnResource:{id:this.data.ban.id,beanName:"BanOnFacility",resourceId:this.data.ban.resourceId,memberId:this.data.ban.memberId,description:p.description,validityTo:p.validity}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.UPDATE_BAN.SUCCESS"),this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}cancel(){this.dialogRef.close(!1)}}h.\u0275fac=function(p){return new(p||h)(d.Y36(t.WI),d.Y36(t.so),d.Y36(u.xk),d.Y36(M.V6))},h.\u0275cmp=d.Xpm({type:h,selectors:[["app-update-resource-ban-dialog"]],decls:1,vars:3,consts:[[3,"ban","theme","loading","cancel","update"]],template:function(p,e){1&p&&(d.TgZ(0,"app-update-ban-dialog",0),d.NdJ("cancel",function(){return e.cancel()})("update",function(D){return e.update(D)}),d.qZA()),2&p&&d.Q6J("ban",e.data.ban)("theme","facility-theme")("loading",e.loading)},dependencies:[i.l]})},32316:(F,L,s)=>{s.d(L,{A:()=>h});var t=s(7274),u=s(61744),M=s(95243),d=s(94650),i=s(1415);class h{constructor(p,e,P,D){this.data=p,this.dialogRef=e,this.voService=P,this.notificator=D,this.loading=!1}update(p){this.loading=!0,this.voService.updateVoBan({banOnVo:{id:this.data.ban.id,beanName:"BanOnVo",voId:this.data.ban.voId,memberId:this.data.ban.memberId,description:p.description,validityTo:p.validity}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.UPDATE_BAN.SUCCESS"),this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}cancel(){this.dialogRef.close(!1)}}h.\u0275fac=function(p){return new(p||h)(d.Y36(t.WI),d.Y36(t.so),d.Y36(u.YF),d.Y36(M.V6))},h.\u0275cmp=d.Xpm({type:h,selectors:[["app-update-vo-ban-dialog"]],decls:1,vars:3,consts:[[3,"ban","theme","loading","cancel","update"]],template:function(p,e){1&p&&(d.TgZ(0,"app-update-ban-dialog",0),d.NdJ("cancel",function(){return e.cancel()})("update",function(D){return e.update(D)}),d.qZA()),2&p&&d.Q6J("ban",e.data.ban)("theme","vo-theme")("loading",e.loading)},dependencies:[i.l]})},95406:(F,L,s)=>{s.d(L,{r:()=>W});var t=s(94650),u=s(24006),M=s(9244),d=s(28499),i=s(61744),h=s(95243),a=s(10266),p=s(71948),e=s(13469),P=s(78372),D=s(95698),N=s(63900),R=s(54004),A=s(36895),C=s(3238),y=s(284),I=s(59549),_=s(84385),v=s(89383);function U(T,c){if(1&T&&(t.TgZ(0,"mat-option",7),t._uU(1),t.qZA()),2&T){const l=c.$implicit;t.Q6J("value",l),t.xp6(1),t.hij(" ",l," ")}}function O(T,c){1&T&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&T&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.FIELD_EMPTY")))}function m(T,c){1&T&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&T&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_EXISTS")))}function r(T,c){1&T&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&T&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_FORMAT")))}function g(T,c){1&T&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&T&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_LONG")))}function S(T,c){1&T&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&T&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_SHORT")))}function G(T,c){if(1&T&&(t.TgZ(0,"span",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&T){const l=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,1,"Not selected"===l.formGroup.get("namespaceCtrl").value?"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_DISABLED":"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_DISABLED_FOR_NAMESPACE")," ")}}class w{constructor(c,l){this.membersManagerService=c,this.usersManagerService=l,this.filteredNamespaces=null,this.namespaceChanged=new t.vpe,this.parsedRulesChanged=new t.vpe,this.namespaceOptions=[],this.selectedNamespace=null,this.namespaceRules=[],this.parsedRules=new Map}ngOnInit(){this.namespaceOptions=["Not selected"],this.membersManagerService.getAllNamespacesRules().subscribe(c=>{this.namespaceRules=c,this.parseNamespaceRules()}),this.onNamespaceChanged("Not selected")}existingLoginValidator(){return c=>{let l=this.formGroup.get("namespaceCtrl").value.toLowerCase();return l="not selected"===l?"mu":l,c.valueChanges.pipe((0,P.b)(500),(0,D.q)(1),(0,N.w)(()=>this.usersManagerService.isLoginAvailable(l,c.value).pipe((0,R.U)(x=>x?null:{loginExists:!0}))))}}parseNamespaceRules(){for(const c of this.namespaceRules)if(null===this.filteredNamespaces||!this.filteredNamespaces.includes(c.namespaceName)){this.namespaceOptions.push(c.namespaceName);const l={login:"disabled"};this.parseAttributes(l,c.requiredAttributes,"required"),this.parseAttributes(l,c.optionalAttributes,"optional"),this.parsedRules.set(c.namespaceName,l)}this.parsedRulesChanged.emit(this.parsedRules)}parseAttributes(c,l,x){for(const Z of l)"login"===Z&&(c.login=x)}onNamespaceChanged(c){this.selectedNamespace=c.toLowerCase();const l=this.formGroup.get("loginCtrl");if("Not selected"!==c)if("disabled"===this.parsedRules.get(this.selectedNamespace).login)l.disable(),l.setValue("");else{const x=[u.kI.required,u.kI.pattern("^[a-z][a-z0-9_-]+$"),u.kI.maxLength(15),u.kI.minLength(2)];(0,M.mH)(l,x,[this.existingLoginValidator()])}else l.disable(),l.setValue("");this.namespaceChanged.emit(c)}}w.\u0275fac=function(c){return new(c||w)(t.Y36(i.uq),t.Y36(i.Fv))},w.\u0275cmp=t.Xpm({type:w,selectors:[["app-login-for-namespace"]],inputs:{formGroup:"formGroup",filteredNamespaces:"filteredNamespaces"},outputs:{namespaceChanged:"namespaceChanged",parsedRulesChanged:"parsedRulesChanged"},decls:18,vars:16,consts:[[1,"display-flex",3,"formGroup"],["formControlName","namespaceCtrl",3,"valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"floatLabel"],["formControlName","loginCtrl","matInput","","required","",3,"hidden"],[4,"ngIf"],["class","input-disabled",4,"ngIf"],[3,"value"],[1,"input-disabled"]],template:function(c,l){1&c&&(t.TgZ(0,"div",0)(1,"mat-form-field")(2,"mat-label"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"mat-select",1),t.NdJ("valueChange",function(Z){return l.onNamespaceChanged(Z)}),t.YNc(6,U,2,2,"mat-option",2),t.qZA()(),t.TgZ(7,"mat-form-field",3)(8,"mat-label"),t._uU(9),t.ALo(10,"translate"),t.qZA(),t._UZ(11,"input",4),t.YNc(12,O,3,3,"mat-error",5),t.YNc(13,m,3,3,"mat-error",5),t.YNc(14,r,3,3,"mat-error",5),t.YNc(15,g,3,3,"mat-error",5),t.YNc(16,S,3,3,"mat-error",5),t.YNc(17,G,3,3,"span",6),t.qZA()()),2&c&&(t.Q6J("formGroup",l.formGroup),t.xp6(3),t.Oqu(t.lcZ(4,12,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.NAMESPACE")),t.xp6(3),t.Q6J("ngForOf",l.namespaceOptions),t.xp6(1),t.Q6J("floatLabel",l.formGroup.get("loginCtrl").disabled?"always":null),t.xp6(2),t.Oqu(t.lcZ(10,14,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN")),t.xp6(2),t.Q6J("hidden",l.formGroup.get("loginCtrl").disabled),t.xp6(1),t.Q6J("ngIf",l.formGroup.get("loginCtrl").hasError("required")),t.xp6(1),t.Q6J("ngIf",l.formGroup.get("loginCtrl").hasError("loginExists")),t.xp6(1),t.Q6J("ngIf",l.formGroup.get("loginCtrl").hasError("pattern")&&!l.formGroup.get("loginCtrl").hasError("minlength")),t.xp6(1),t.Q6J("ngIf",l.formGroup.get("loginCtrl").hasError("maxlength")),t.xp6(1),t.Q6J("ngIf",l.formGroup.get("loginCtrl").hasError("minlength")),t.xp6(1),t.Q6J("ngIf",l.formGroup.get("loginCtrl").disabled))},dependencies:[A.sg,A.O5,C.ey,y.Nt,I.KE,I.hX,I.TO,u.Fj,u.JJ,u.JL,u.Q7,u.sg,u.u,_.gD,v.X$],styles:[".display-flex[_ngcontent-%COMP%]{display:flex;flex-direction:column}.input-disabled[_ngcontent-%COMP%]{pointer-events:none;color:#888}"]});class W{constructor(c,l,x){this.membersManagerService=c,this.usersManagerService=l,this.apiRequestConfiguration=x,this.filteredNamespace=null,this.parsedRulesOutput=new t.vpe,this.selectedNamespace=null,this.parsedRules=new Map}parsedRulesFunction(c){this.parsedRules=c,this.parsedRulesOutput.emit(c)}onNamespaceChanged(c){this.selectedNamespace=c.toLowerCase();const l=this.formGroup.get("passwordCtrl"),x=this.formGroup.get("passwordAgainCtrl"),Z=this.formGroup.get("generatePasswordCtrl");"Not selected"!==c?((0,M.mH)(Z,[]),this.passwordOptionChanged()):(l.disable(),l.setValue(""),x.disable(),x.setValue(""),Z.disable(),Z.dirty||Z.setValue(!0))}passwordOptionChanged(){const c=this.formGroup.get("passwordCtrl"),l=this.formGroup.get("passwordAgainCtrl");this.formGroup.get("generatePasswordCtrl").value?(c.disable(),c.setValue(""),l.disable(),l.setValue("")):((0,M.mH)(c,[u.kI.required],[(0,d.yT)(this.selectedNamespace,this.usersManagerService,this.apiRequestConfiguration)]),(0,M.mH)(l,[]))}}W.\u0275fac=function(c){return new(c||W)(t.Y36(i.uq),t.Y36(i.Fv),t.Y36(h.F5))},W.\u0275cmp=t.Xpm({type:W,selectors:[["app-login-password-form-with-generate-option"]],inputs:{formGroup:"formGroup",filteredNamespace:"filteredNamespace"},outputs:{parsedRulesOutput:"parsedRulesOutput"},decls:12,vars:23,consts:[[1,"display-flex",3,"formGroup"],[3,"formGroup","filteredNamespaces","namespaceChanged","parsedRulesChanged"],["formControlName","generatePasswordCtrl","matTooltipPosition","left",1,"display-flex","mt-3",3,"matTooltipDisabled","matTooltip","ngModelChange"],[3,"checked","value"],[1,"display-flex"],[3,"formGroup","namespace","passwordRequired","tooltipPwdDisabledForNamespace"]],template:function(c,l){1&c&&(t.TgZ(0,"div",0)(1,"app-login-for-namespace",1),t.NdJ("namespaceChanged",function(Z){return l.onNamespaceChanged(Z)})("parsedRulesChanged",function(Z){return l.parsedRulesFunction(Z)}),t.qZA(),t.TgZ(2,"mat-radio-group",2),t.NdJ("ngModelChange",function(){return l.passwordOptionChanged()}),t.ALo(3,"translate"),t.TgZ(4,"mat-radio-button",3),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"mat-radio-button",3),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"div",4),t._UZ(11,"perun-web-apps-password-form",5),t.qZA()()),2&c&&(t.Q6J("formGroup",l.formGroup),t.xp6(1),t.Q6J("formGroup",l.formGroup)("filteredNamespaces",l.filteredNamespace),t.xp6(1),t.s9C("matTooltip",t.lcZ(3,17,"DIALOGS.CREATE_SERVICE_MEMBER.PASSWORD_NOT_SUPPORTED")),t.Q6J("matTooltipDisabled","Not selected"!==l.formGroup.get("namespaceCtrl").value),t.xp6(2),t.Q6J("checked",l.formGroup.get("generatePasswordCtrl").value&&l.formGroup.get("generatePasswordCtrl").enabled)("value",!0),t.xp6(1),t.hij(" ",t.lcZ(6,19,"DIALOGS.CREATE_SERVICE_MEMBER.PASSWORD_RANDOM")," "),t.xp6(2),t.Q6J("checked",!l.formGroup.get("generatePasswordCtrl").value&&l.formGroup.get("generatePasswordCtrl").enabled)("value",!1),t.xp6(1),t.hij(" ",t.lcZ(9,21,"DIALOGS.CREATE_SERVICE_MEMBER.ENTER_PASSWORD")," "),t.xp6(2),t.ekj("input-disabled",l.formGroup.get("generatePasswordCtrl").value),t.xp6(1),t.Q6J("formGroup",l.formGroup)("namespace",l.selectedNamespace)("passwordRequired",!l.formGroup.get("generatePasswordCtrl").value)("tooltipPwdDisabledForNamespace",l.formGroup.get("generatePasswordCtrl").enabled))},dependencies:[u.JJ,u.JL,u.sg,u.u,a.gM,p.VQ,p.U0,e.G,w,v.X$],styles:[".display-flex[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]})},12651:(F,L,s)=>{s.d(L,{t:()=>O});var t=s(61744),u=s(95017),M=s(9244),d=s(71103),i=s(67791),h=s(61365),p=(s(37433),s(15466)),e=s(94650),P=s(7274),D=s(4859),N=s(68530),R=s(96214),A=s(7434),C=s(6881),y=s(73358),I=s(89383);const _=["list"];function v(m,r){1&m&&e._UZ(0,"perun-web-apps-loading-table")}function U(m,r){if(1&m&&e._UZ(0,"perun-web-apps-attributes-list",8,9),2&m){const g=e.oxw();e.Q6J("attributes",g.attributes)("filterValue",g.filterValue)("selection",g.selection)("tableId",g.tableId)}}class O{constructor(r,g){this.attributesManagerService=r,this.dialog=g,this.attributes=[],this.selection=new u.Ov(!0,[]),this.filterValue="",this.tableId=p.rF,this.loading=!1}ngOnInit(){this.refreshTable()}refreshTable(){switch(this.loading=!0,this.entity){case"member":this.attributesManagerService.getMemberAttributes(this.entityId).subscribe(r=>{this.attributes=r,this.selection.clear(),this.loading=!1});break;case"group":this.attributesManagerService.getGroupAttributes(this.entityId).subscribe(r=>{this.attributes=r,this.selection.clear(),this.loading=!1});break;case"user":this.attributesManagerService.getUserAttributes(this.entityId).subscribe(r=>{this.attributes=r,this.selection.clear(),this.loading=!1});break;case"resource":this.attributesManagerService.getResourceAttributes(this.entityId).subscribe(r=>{this.attributes=r,this.selection.clear(),this.loading=!1});break;case"facility":this.attributesManagerService.getFacilityAttributes(this.entityId).subscribe(r=>{this.attributes=r,this.selection.clear(),this.loading=!1});break;case"vo":this.attributesManagerService.getVoAttributes(this.entityId).subscribe(r=>{this.attributes=r,this.selection.clear(),this.loading=!1})}}applyFilter(r){this.filterValue=r}onCreate(){const r=(0,M.kZ)();r.width="1050px",r.data={entityId:this.entityId,entity:this.entity,notEmptyAttributes:this.attributes,style:this.entity+"-theme"},this.dialog.open(d.n,r).afterClosed().subscribe(S=>{S&&this.refreshTable()})}onSave(){this.list.updateMapAttributes();const r=(0,M.kZ)();r.width="450px",r.data={entityId:this.entityId,entity:this.entity,attributes:this.selection.selected},this.dialog.open(i.wA,r).afterClosed().subscribe(S=>{S&&this.refreshTable()})}onDelete(){const r=(0,M.kZ)();r.width="450px",r.data={entityId:this.entityId,entity:this.entity,attributes:this.selection.selected},this.dialog.open(h.k,r).afterClosed().subscribe(S=>{S&&this.refreshTable()})}}O.\u0275fac=function(r){return new(r||O)(e.Y36(t.H8),e.Y36(P.uw))},O.\u0275cmp=e.Xpm({type:O,selectors:[["app-one-entity-attribute-page"]],viewQuery:function(r,g){if(1&r&&e.Gf(_,5),2&r){let S;e.iGM(S=e.CRH())&&(g.list=S.first)}},inputs:{entity:"entity",entityId:"entityId"},decls:15,vars:14,consts:[[3,"refresh"],["color","accent","data-cy","add-attributes","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","accent","mat-flat-button","",1,"me-2",3,"disabled","click"],["color","warn","data-cy","remove-attributes","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative"],[3,"attributes","filterValue","selection","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"attributes","filterValue","selection","tableId"],["list",""]],template:function(r,g){if(1&r&&(e.TgZ(0,"perun-web-apps-refresh-button",0),e.NdJ("refresh",function(){return g.refreshTable()}),e.qZA(),e.TgZ(1,"button",1),e.NdJ("click",function(){return g.onCreate()}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return g.onSave()}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"button",3),e.NdJ("click",function(){return g.onDelete()}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"perun-web-apps-immediate-filter",4),e.NdJ("filter",function(G){return g.applyFilter(G)}),e.qZA(),e.YNc(11,v,1,0,"ng-template",null,5,e.W1O),e.TgZ(13,"div",6),e.YNc(14,U,2,4,"perun-web-apps-attributes-list",7),e.qZA()),2&r){const S=e.MAs(12);e.xp6(2),e.hij(" ",e.lcZ(3,8,"USER_DETAIL.SETTINGS.ATTRIBUTES.CREATE"),"\n"),e.xp6(2),e.Q6J("disabled",0===g.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(6,10,"USER_DETAIL.SETTINGS.ATTRIBUTES.SAVE"),"\n"),e.xp6(2),e.Q6J("disabled",0===g.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(9,12,"USER_DETAIL.SETTINGS.ATTRIBUTES.DELETE"),"\n"),e.xp6(2),e.Q6J("placeholder","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.FILTER"),e.xp6(4),e.Q6J("perunWebAppsLoader",g.loading)("perunWebAppsLoaderIndicator",S)}},dependencies:[D.lW,N.K,R.t,A.L,C.p,y.e,I.X$]})},48323:(F,L,s)=>{s.d(L,{Y:()=>K});var t=s(61744),M=(s(37433),s(95017)),d=s(61365),i=s(9244),h=s(67791),a=s(71103),p=s(6134),e=s(94650),P=s(7274),D=s(36895),N=s(4859),R=s(51572),A=s(98380),C=s(68530),y=s(96214),I=s(7434),_=s(6881),v=s(82322),U=s(45703),O=s(89593),m=s(89383);class r{constructor(){this.memberSelected=new e.vpe,this.memberFullNameFunction=o=>(0,i.bD)(o.user)}ngOnInit(){this.members=this.members.sort(i.fx)}}r.\u0275fac=function(o){return new(o||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["perun-web-apps-member-search-select"]],inputs:{members:"members"},outputs:{memberSelected:"memberSelected"},decls:4,vars:12,consts:[[3,"entities","searchFunction","mainTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","entitySelected"]],template:function(o,n){1&o&&(e.TgZ(0,"perun-web-apps-entity-search-select",0),e.NdJ("entitySelected",function(f){return n.memberSelected.emit(f)}),e.ALo(1,"translate"),e.ALo(2,"translate"),e.ALo(3,"translate"),e.qZA()),2&o&&e.Q6J("entities",n.members)("searchFunction",n.memberFullNameFunction)("mainTextFunction",n.memberFullNameFunction)("selectPlaceholder",e.lcZ(1,6,"SHARED_LIB.PERUN.COMPONENTS.MEMBER_SEARCH_SELECT.SELECT_MEMBER"))("findPlaceholder",e.lcZ(2,8,"SHARED_LIB.PERUN.COMPONENTS.MEMBER_SEARCH_SELECT.FIND_MEMBER"))("noEntriesText",e.lcZ(3,10,"SHARED_LIB.PERUN.COMPONENTS.MEMBER_SEARCH_SELECT.NO_MEMBER_FOUND"))},dependencies:[O.i,m.X$]});var g=s(79707),S=s(74250),G=s(73358);const w=["list"];function W(E,o){1&E&&e._UZ(0,"mat-spinner",4)}function T(E,o){if(1&E&&(e.TgZ(0,"perun-web-apps-alert",5),e._uU(1),e.qZA()),2&E){const n=e.oxw();e.xp6(1),e.Oqu(n.noEntityMessage)}}function c(E,o){if(1&E){const n=e.EpF();e.TgZ(0,"perun-web-apps-group-search-select",20),e.NdJ("groupSelected",function(f){e.CHM(n);const B=e.oxw(2);return e.KtG(B.specifySecondEntity(f))}),e.qZA()}if(2&E){const n=e.oxw(2);e.Q6J("firstSelectedGroup",n.specificSecondEntity)("displayStatus",!0)("groups",n.entityValues)}}function l(E,o){if(1&E){const n=e.EpF();e.TgZ(0,"perun-web-apps-resource-search-select",21),e.NdJ("resourceSelected",function(f){e.CHM(n);const B=e.oxw(2);return e.KtG(B.specifySecondEntity(f))}),e.qZA()}if(2&E){const n=e.oxw(2);e.Q6J("resources",n.entityValues)}}function x(E,o){if(1&E){const n=e.EpF();e.TgZ(0,"perun-web-apps-member-search-select",22),e.NdJ("memberSelected",function(f){e.CHM(n);const B=e.oxw(2);return e.KtG(B.specifySecondEntity(f))}),e.qZA()}if(2&E){const n=e.oxw(2);e.Q6J("members",n.entityValues)}}function Z(E,o){if(1&E){const n=e.EpF();e.TgZ(0,"perun-web-apps-facility-search-select",23),e.NdJ("facilitySelected",function(f){e.CHM(n);const B=e.oxw(2);return e.KtG(B.specifySecondEntity(f))}),e.qZA()}if(2&E){const n=e.oxw(2);e.Q6J("facilities",n.entityValues)}}function J(E,o){if(1&E){const n=e.EpF();e.TgZ(0,"perun-web-apps-user-search-select",24),e.NdJ("userSelected",function(f){e.CHM(n);const B=e.oxw(2);return e.KtG(B.specifySecondEntity(f))}),e.qZA()}if(2&E){const n=e.oxw(2);e.Q6J("users",n.entityValues)}}function Y(E,o){1&E&&e._UZ(0,"perun-web-apps-loading-table")}function V(E,o){if(1&E&&e._UZ(0,"perun-web-apps-attributes-list",25,26),2&E){const n=e.oxw(2);e.Q6J("attributes",n.attributes)("filterValue",n.filterValue)("selection",n.selection)}}function Q(E,o){if(1&E){const n=e.EpF();e.TgZ(0,"div")(1,"div",6),e.YNc(2,c,1,3,"perun-web-apps-group-search-select",7),e.YNc(3,l,1,1,"perun-web-apps-resource-search-select",8),e.YNc(4,x,1,1,"perun-web-apps-member-search-select",9),e.YNc(5,Z,1,1,"perun-web-apps-facility-search-select",10),e.YNc(6,J,1,1,"perun-web-apps-user-search-select",11),e.qZA(),e.TgZ(7,"perun-web-apps-refresh-button",12),e.NdJ("refresh",function(){e.CHM(n);const f=e.oxw();return e.KtG(f.getAttributes(f.specificSecondEntity.id))}),e.qZA(),e.TgZ(8,"button",13),e.NdJ("click",function(){e.CHM(n);const f=e.oxw();return e.KtG(f.onAdd(f.specificSecondEntity.id))}),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"button",14),e.NdJ("click",function(){e.CHM(n);const f=e.oxw();return e.KtG(f.onSave(f.specificSecondEntity.id))}),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"button",15),e.NdJ("click",function(){e.CHM(n);const f=e.oxw();return e.KtG(f.onDelete(f.specificSecondEntity.id))}),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"perun-web-apps-immediate-filter",16),e.NdJ("filter",function(f){e.CHM(n);const B=e.oxw();return e.KtG(B.applyFilter(f))}),e.qZA(),e.YNc(18,Y,1,0,"ng-template",null,17,e.W1O),e.TgZ(20,"div",18),e.YNc(21,V,2,3,"perun-web-apps-attributes-list",19),e.qZA()()}if(2&E){const n=e.MAs(19),b=e.oxw();e.xp6(2),e.Q6J("ngIf","group"===b.secondEntity),e.xp6(1),e.Q6J("ngIf","resource"===b.secondEntity),e.xp6(1),e.Q6J("ngIf","member"===b.secondEntity),e.xp6(1),e.Q6J("ngIf","facility"===b.secondEntity),e.xp6(1),e.Q6J("ngIf","user"===b.secondEntity),e.xp6(3),e.hij(" ",e.lcZ(10,13,"MEMBER_DETAIL.SETTINGS.ATTRIBUTES.CREATE")," "),e.xp6(2),e.Q6J("disabled",0===b.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(13,15,"MEMBER_DETAIL.SETTINGS.ATTRIBUTES.SAVE")," "),e.xp6(2),e.Q6J("disabled",0===b.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(16,17,"MEMBER_DETAIL.SETTINGS.ATTRIBUTES.DELETE")," "),e.xp6(2),e.Q6J("placeholder","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.FILTER"),e.xp6(4),e.Q6J("perunWebAppsLoader",b.innerLoading)("perunWebAppsLoaderIndicator",n)}}class K{constructor(o,n,b,f,B,H){this.attributesManagerService=o,this.resourcesManagerService=n,this.facilitiesManagerService=b,this.groupsManagerService=f,this.membersManager=B,this.dialog=H,this.entityValues=[],this.attributes=[],this.selection=new M.Ov(!0,[]),this.allowedStatuses=["INVALID","VALID"],this.loading=!1,this.innerLoading=!1,this.filterValue=""}ngOnInit(){this.loadEntityValues(),this.setMessages(this.secondEntity.toLowerCase())}loadEntityValues(){switch(this.loading=!0,this.firstEntity){case"member":switch(this.secondEntity){case"resource":this.resourcesManagerService.getAssignedResourcesWithStatus(this.firstEntityId).subscribe(o=>{this.entityValues=o.map(n=>n.enrichedResource.resource),this.preselectEntity(),this.loading=!1});break;case"group":this.groupsManagerService.getMemberGroups(this.firstEntityId).subscribe(o=>{this.entityValues=o,this.preselectEntity(),this.loading=!1})}break;case"group":switch(this.secondEntity){case"resource":this.resourcesManagerService.getResourceAssignments(this.firstEntityId).subscribe(o=>{this.entityValues=o.map(n=>{const b=n.enrichedResource.resource;return b.status=n.status,b}),this.preselectEntity(),this.loading=!1});break;case"member":this.membersManager.getCompleteRichMembersForGroup(this.firstEntityId,!1,this.allowedStatuses,null,[p.r.MEMBER_CORE_ID]).subscribe(o=>{this.entityValues=o,this.preselectEntity(),this.loading=!1})}break;case"user":this.facilitiesManagerService.getAssignedFacilitiesByUser(this.firstEntityId).subscribe(o=>{this.entityValues=o,this.preselectEntity(),this.loading=!1});break;case"resource":switch(this.secondEntity){case"member":this.resourcesManagerService.getAssignedMembersWithStatus(this.firstEntityId).subscribe(o=>{this.entityValues=o.map(n=>n.richMember),this.preselectEntity(),this.loading=!1});break;case"group":this.resourcesManagerService.getGroupAssignments(this.firstEntityId).subscribe(o=>{this.entityValues=o.map(n=>{const b=n.enrichedGroup.group;return b.status=n.status,b}),this.preselectEntity(),this.loading=!1})}break;case"facility":this.facilitiesManagerService.getAssignedUsers(this.firstEntityId).subscribe(o=>{this.entityValues=o,this.preselectEntity(),this.loading=!1})}}preselectEntity(){0!==this.entityValues.length&&this.findInitiallySelectedEntity()}findInitiallySelectedEntity(){let o=this.entityValues[0];const n=(0,i.vL)(this.entityKey());if(n)for(const b of this.entityValues)if(b.id===n[0]){o=b;break}this.specifySecondEntity(o)}entityKey(){return"group"===this.secondEntity?"groups":""}getAttributes(o){switch(this.innerLoading=!0,this.selection.clear(),this.firstEntity){case"member":switch(this.secondEntity){case"resource":this.attributesManagerService.getMemberResourceAttributes(this.firstEntityId,o).subscribe(n=>{this.attributes=n,this.innerLoading=!1});break;case"group":this.attributesManagerService.getMemberGroupAttributes(this.firstEntityId,o).subscribe(n=>{this.attributes=n,this.innerLoading=!1})}break;case"group":switch(this.secondEntity){case"resource":this.attributesManagerService.getGroupResourceAttributes(this.firstEntityId,o).subscribe(n=>{this.attributes=n,this.innerLoading=!1});break;case"member":this.attributesManagerService.getMemberGroupAttributes(o,this.firstEntityId).subscribe(n=>{this.attributes=n,this.innerLoading=!1})}break;case"user":this.attributesManagerService.getUserFacilityAttributes(this.firstEntityId,o).subscribe(n=>{this.attributes=n,this.innerLoading=!1});break;case"resource":switch(this.secondEntity){case"member":this.attributesManagerService.getMemberResourceAttributes(o,this.firstEntityId).subscribe(n=>{this.attributes=n,this.innerLoading=!1});break;case"group":this.attributesManagerService.getGroupResourceAttributes(o,this.firstEntityId).subscribe(n=>{this.attributes=n,this.innerLoading=!1})}break;case"facility":this.attributesManagerService.getUserFacilityAttributes(o,this.firstEntityId).subscribe(n=>{this.attributes=n,this.innerLoading=!1})}}setMessages(o){this.noEntityMessage=`No ${o} assigned`}onSave(o){this.list.updateMapAttributes();const n=(0,i.kZ)();n.width="450px",n.data={entityId:this.firstEntityId,entity:this.firstEntity,secondEntity:this.secondEntity,secondEntityId:o,attributes:this.selection.selected},this.dialog.open(h.wA,n).afterClosed().subscribe(f=>{f&&(this.selection.clear(),this.getAttributes(o))})}onDelete(o){const n=(0,i.kZ)();n.width="450px",n.data={entityId:this.firstEntityId,entity:this.firstEntity,secondEntity:this.secondEntity,secondEntityId:o,attributes:this.selection.selected,theme:`${this.firstEntity}-theme`},this.dialog.open(d.k,n).afterClosed().subscribe(f=>{f&&(this.selection.clear(),this.getAttributes(o))})}onAdd(o){const n=(0,i.kZ)();n.width="1050px",n.data={entityId:this.firstEntityId,entity:this.firstEntity,secondEntity:this.secondEntity,secondEntityId:o,notEmptyAttributes:this.attributes,style:`${this.firstEntity}-theme`},this.dialog.open(a.n,n).afterClosed().subscribe(f=>{f&&(this.selection.clear(),this.getAttributes(o))})}specifySecondEntity(o){o&&(this.specificSecondEntity=o,this.getAttributes(this.specificSecondEntity.id))}applyFilter(o){this.filterValue=o}}K.\u0275fac=function(o){return new(o||K)(e.Y36(t.H8),e.Y36(t.xk),e.Y36(t.IQ),e.Y36(t.ff),e.Y36(t.uq),e.Y36(P.uw))},K.\u0275cmp=e.Xpm({type:K,selectors:[["app-two-entity-attribute-page"]],viewQuery:function(o,n){if(1&o&&e.Gf(w,5),2&o){let b;e.iGM(b=e.CRH())&&(n.list=b.first)}},inputs:{firstEntityId:"firstEntityId",firstEntity:"firstEntity",secondEntity:"secondEntity"},decls:4,vars:3,consts:[[1,"mt-3"],["class","ms-auto me-auto",4,"ngIf"],["alert_type","warn",4,"ngIf"],[4,"ngIf"],[1,"ms-auto","me-auto"],["alert_type","warn"],[1,"flex-row"],[3,"firstSelectedGroup","displayStatus","groups","groupSelected",4,"ngIf"],[3,"resources","resourceSelected",4,"ngIf"],[3,"members","memberSelected",4,"ngIf"],[3,"facilities","facilitySelected",4,"ngIf"],[3,"users","userSelected",4,"ngIf"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","accent","mat-flat-button","",1,"me-2",3,"disabled","click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative"],[3,"attributes","filterValue","selection",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"firstSelectedGroup","displayStatus","groups","groupSelected"],[3,"resources","resourceSelected"],[3,"members","memberSelected"],[3,"facilities","facilitySelected"],[3,"users","userSelected"],[3,"attributes","filterValue","selection"],["list",""]],template:function(o,n){1&o&&(e.TgZ(0,"div",0),e.YNc(1,W,1,0,"mat-spinner",1),e.YNc(2,T,2,1,"perun-web-apps-alert",2),e.YNc(3,Q,22,19,"div",3),e.qZA()),2&o&&(e.xp6(1),e.Q6J("ngIf",n.loading),e.xp6(1),e.Q6J("ngIf",0===n.entityValues.length&&!n.loading),e.xp6(1),e.Q6J("ngIf",0!==n.entityValues.length))},dependencies:[D.O5,N.lW,R.Ou,A.w,C.K,y.t,I.L,_.p,v.h,U.L,r,g.R,S.S,G.e,m.X$],styles:[".w-35[_ngcontent-%COMP%]{width:35%}"]})},79707:(F,L,s)=>{s.d(L,{R:()=>i});var t=s(94650),u=s(9244),M=s(89593),d=s(89383);class i{constructor(){this.disableAutoSelect=!1,this.selectPlaceholder="SHARED_LIB.PERUN.COMPONENTS.FACILITY_SEARCH_SELECT.SELECT_FACILITY",this.facilitySelected=new t.vpe,this.nameFunction=a=>a.name}ngOnInit(){this.facilities=this.facilities.sort(u.aC)}}i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["perun-web-apps-facility-search-select"]],inputs:{facilities:"facilities",disableAutoSelect:"disableAutoSelect",selectPlaceholder:"selectPlaceholder"},outputs:{facilitySelected:"facilitySelected"},decls:4,vars:13,consts:[[3,"entities","disableAutoSelect","searchFunction","mainTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","entitySelected"]],template:function(a,p){1&a&&(t.TgZ(0,"perun-web-apps-entity-search-select",0),t.NdJ("entitySelected",function(P){return p.facilitySelected.emit(P)}),t.ALo(1,"translate"),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&a&&t.Q6J("entities",p.facilities)("disableAutoSelect",p.disableAutoSelect)("searchFunction",p.nameFunction)("mainTextFunction",p.nameFunction)("selectPlaceholder",t.lcZ(1,7,p.selectPlaceholder))("findPlaceholder",t.lcZ(2,9,"SHARED_LIB.PERUN.COMPONENTS.FACILITY_SEARCH_SELECT.FIND_FACILITY"))("noEntriesText",t.lcZ(3,11,"SHARED_LIB.PERUN.COMPONENTS.FACILITY_SEARCH_SELECT.NO_FACILITY_FOUND"))},dependencies:[M.i,d.X$]})},71135:(F,L,s)=>{s.d(L,{L:()=>R});var t=s(94650),u=s(7274),M=s(82761),d=s(36895),i=s(97392),h=s(3238),a=s(55755),p=s(89383),e=s(64597);const P=function(A){return[A]};function D(A,C){if(1&A&&(t.TgZ(0,"div",3)(1,"a",4),t.NdJ("auxclick",function(I){return I.preventDefault()}),t.ALo(2,"multiWordDataCy"),t.ALo(3,"translate"),t._UZ(4,"mat-icon",5),t._uU(5),t.ALo(6,"translate"),t.qZA()()),2&A){const y=C.$implicit;t.xp6(1),t.Gre("",y.style," item-itself"),t.Q6J("perunWebAppsMiddleClickRouterLink",t.VKq(14,P,y.url))("routerLink",y.url),t.uIk("data-cy",t.lcZ(2,8,t.lcZ(3,10,y.label))),t.xp6(3),t.Q6J("svgIcon",y.cssIcon),t.xp6(1),t.hij(" ",t.lcZ(6,12,y.label)," ")}}function N(A,C){if(1&A&&(t.TgZ(0,"div",1),t.YNc(1,D,7,16,"div",2),t.qZA()),2&A){const y=t.oxw();t.xp6(1),t.Q6J("ngForOf",y.items)}}class R{constructor(C,y){this.dialog=C,this.route=y,this.size="large"}ngOnInit(){this.route.params.subscribe(C=>{this.voId=Number(C.voId)})}}R.\u0275fac=function(C){return new(C||R)(t.Y36(u.uw),t.Y36(M.gz))},R.\u0275cmp=t.Xpm({type:R,selectors:[["perun-web-apps-menu-buttons-field"]],inputs:{items:"items",size:"size"},decls:1,vars:1,consts:[["class","items-container",4,"ngIf"],[1,"items-container"],["class","item-itself-container","mat-ripple","",4,"ngFor","ngForOf"],["mat-ripple","",1,"item-itself-container"],[3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],[1,"item-pic","perun-icon",3,"svgIcon"]],template:function(C,y){1&C&&t.YNc(0,N,2,1,"div",0),2&C&&t.Q6J("ngIf","small"===y.size)},dependencies:[d.sg,d.O5,M.rH,i.Hw,h.wG,a.YH,a.QG,p.X$,e.R],styles:[".items-container[_ngcontent-%COMP%]{display:grid;grid-gap:0;grid-template-columns:repeat(auto-fill,minmax(208px,1fr));margin:0 -8px}@media (max-width: 768px){.items-container[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(148px,1fr))}}.item-pic[_ngcontent-%COMP%]{color:currentColor;transform:scale(3);height:74px;margin-bottom:22px}.item-itself-container[_ngcontent-%COMP%]{margin:8px}.item-itself[_ngcontent-%COMP%]{text-align:center;min-height:186px;height:100%;padding:20px;display:flex;flex-direction:column;align-items:center;font-size:1.25rem;text-decoration:none}.item-itself[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:120px;margin-bottom:10px}@media (max-width: 768px){.item-itself[_ngcontent-%COMP%]{min-height:150px;padding:10px}.item-itself[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:80px;margin-bottom:10px}}"]})}}]);