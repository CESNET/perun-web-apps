"use strict";(self.webpackChunkadmin_gui=self.webpackChunkadmin_gui||[]).push([[338],{54668:(x,N,s)=>{s.d(N,{l:()=>o});var O=s(65412),l=s(32105),R=s(69723),t=s(10036),e=s(95017),S=s(64080),u=s(24006),n=s(94650),M=s(89383),g=s(36895),P=s(59549),C=s(284),A=s(97392),L=s(4859),v=s(51572),b=s(98380),E=s(64877);function I(a,c){if(1&a&&n._UZ(0,"app-users-list",14),2&a){const h=n.oxw(2);n.Q6J("displayedColumns",h.displayedColumns)("selection",h.selection)("tableId",h.tableId)("disableRouting",!0)("users",h.identities)}}function D(a,c){if(1&a&&(n.TgZ(0,"div"),n.YNc(1,I,1,5,"app-users-list",13),n.qZA()),2&a){const h=n.oxw();n.xp6(1),n.Q6J("ngIf",void 0!==h.identities&&h.identities.length>0)}}function d(a,c){1&a&&(n.TgZ(0,"perun-web-apps-alert",15),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&a&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"DIALOGS.CONNECT_IDENTITY.SEARCH_HINT")," "))}function m(a,c){1&a&&(n.TgZ(0,"perun-web-apps-alert",16),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&a&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"DIALOGS.CONNECT_IDENTITY.NO_IDENTITIES")," "))}function _(a,c){1&a&&n._UZ(0,"mat-spinner",17)}let o=(()=>{class a{constructor(h,T,y,B,F,Q){this.dialogRef=h,this.data=T,this.userManager=y,this.storeService=B,this.notificator=F,this.translate=Q,this.loading=!1,this.selection=new e.Ov(!1,[]),this.firstSearchDone=!1,this.displayedColumns=["select","id","user","name","email","logins","organization"],this.tableId=t.Iz}ngOnInit(){this.target=this.data.target,this.theme=this.data.theme,this.userId=this.data.userId,this.isService=this.data.isService,this.searchCtrl=new u.p4("",[u.kI.required,u.kI.pattern(".*[\\S]+.*")])}onAdd(){let h,T;this.loading=!0,this.isService?(h=this.selection.selected[0].id,T=this.userId):(h=this.userId,T=this.selection.selected[0].id),this.userManager.addSpecificUserOwner(h,T).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.CONNECT_IDENTITY.SUCCESS")),this.dialogRef.close(!0)},error:()=>this.loading=!1})}onCancel(){this.dialogRef.close(!1)}onSearchByString(){if(this.searchCtrl.invalid)return void this.searchCtrl.markAllAsTouched();this.loading=!0,this.firstSearchDone=!0;let h=[S.r.USER_DEF_ORGANIZATION,S.r.USER_DEF_PREFERRED_MAIL];h=h.concat(this.storeService.getLoginAttributeNames()),this.userManager.findRichUsersWithAttributes(this.searchCtrl.value,h).subscribe(T=>{this.identities=this.filterIdentities(T),this.loading=!1},()=>{this.loading=!1})}onKeyInput(h){"Enter"===h.key&&this.onSearchByString()}filterIdentities(h){return h.filter(this.isService?T=>!T.serviceUser:T=>T.serviceUser)}}return a.\u0275fac=function(h){return new(h||a)(n.Y36(O.so),n.Y36(O.WI),n.Y36(l.Fv),n.Y36(R.d6),n.Y36(R.V6),n.Y36(M.sK))},a.\u0275cmp=n.Xpm({type:a,selectors:[["app-connect-identity-dialog"]],decls:25,vars:25,consts:[[3,"keyup"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],[1,"mr-2","search-field","no-border-mat-input"],["matInput","","autocomplete","false",3,"placeholder","formControl"],["color","primary","mat-flat-button","",1,"mr-2","search-btn",3,"disabled","click"],[4,"ngIf"],["alert_type","info",4,"ngIf"],["alert_type","warn",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],[3,"displayedColumns","selection","tableId","disableRouting","users",4,"ngIf"],[3,"displayedColumns","selection","tableId","disableRouting","users"],["alert_type","info"],["alert_type","warn"],[1,"ml-auto","mr-auto"]],template:function(h,T){1&h&&(n.TgZ(0,"div",0),n.NdJ("keyup",function(B){return T.onKeyInput(B)}),n.TgZ(1,"h1",1),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"div",2)(5,"mat-form-field",3),n._UZ(6,"input",4),n.ALo(7,"translate"),n.TgZ(8,"mat-error"),n._uU(9),n.ALo(10,"translate"),n.qZA()(),n.TgZ(11,"button",5),n.NdJ("click",function(){return T.onSearchByString()}),n.TgZ(12,"mat-icon"),n._uU(13,"search"),n.qZA()(),n.YNc(14,D,2,1,"div",6),n.YNc(15,d,3,3,"perun-web-apps-alert",7),n.YNc(16,m,3,3,"perun-web-apps-alert",8),n.qZA(),n.YNc(17,_,1,0,"mat-spinner",9),n.TgZ(18,"div",10)(19,"button",11),n.NdJ("click",function(){return T.onCancel()}),n._uU(20),n.ALo(21,"translate"),n.qZA(),n.TgZ(22,"button",12),n.NdJ("click",function(){return T.onAdd()}),n._uU(23),n.ALo(24,"translate"),n.qZA()()()),2&h&&(n.Tol(T.theme),n.xp6(2),n.Oqu(n.lcZ(3,15,"DIALOGS.CONNECT_IDENTITY.TITLE_"+T.target)),n.xp6(4),n.s9C("placeholder",n.lcZ(7,17,"DIALOGS.CONNECT_IDENTITY.SEARCH")),n.Q6J("formControl",T.searchCtrl),n.xp6(3),n.hij(" ",n.lcZ(10,19,"DIALOGS.CONNECT_IDENTITY.EMPTY_SEARCH_MESSAGE")," "),n.xp6(2),n.Q6J("disabled",T.loading),n.xp6(3),n.Q6J("ngIf",!T.loading),n.xp6(1),n.Q6J("ngIf",!T.firstSearchDone),n.xp6(1),n.Q6J("ngIf",!T.loading&&T.firstSearchDone&&0===T.identities.length),n.xp6(1),n.Q6J("ngIf",T.loading),n.xp6(3),n.hij(" ",n.lcZ(21,21,"DIALOGS.CONNECT_IDENTITY.CANCEL")," "),n.xp6(2),n.Q6J("disabled",0===T.selection.selected.length),n.xp6(1),n.hij(" ",n.lcZ(24,23,"DIALOGS.CONNECT_IDENTITY.CONNECT")," "))},dependencies:[g.O5,P.TO,P.KE,C.Nt,u.Fj,u.JJ,u.oH,A.Hw,L.lW,O.uh,O.xY,O.H8,v.Ou,b.w,E.C,M.X$],styles:[".search-field[_ngcontent-%COMP%]{width:300px}.search-btn[_ngcontent-%COMP%]{width:50px}"]}),a})()},94814:(x,N,s)=>{s.d(N,{B:()=>E});var O=s(32105),l=s(65412),R=s(69723),t=s(30671),e=s(94650),S=s(89383),u=s(36895),n=s(4859),M=s(98380),g=s(31359);function P(I,D){1&I&&e._UZ(0,"th",13)}function C(I,D){if(1&I&&(e.TgZ(0,"td",14),e._uU(1),e.ALo(2,"userFullName"),e.qZA()),2&I){const d=D.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,d))}}function A(I,D){1&I&&e._UZ(0,"tr",15)}function L(I,D){1&I&&e._UZ(0,"tr",16)}function v(I,D){1&I&&(e.TgZ(0,"perun-web-apps-alert",17),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&I&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"DIALOGS.DISCONNECT_IDENTITY.WARNING_DISCONNECT_YOURSELF")," "))}function b(I,D){1&I&&(e.TgZ(0,"perun-web-apps-alert",17),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&I&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"DIALOGS.DISCONNECT_IDENTITY.WARNING_LAST_USER")," "))}let E=(()=>{class I{constructor(d,m,_,o,a,c){this.dialogRef=d,this.data=m,this.userManager=_,this.notificator=o,this.translate=a,this.store=c,this.displayedColumns=["name"]}ngOnInit(){let d;this.targetTitle=this.data.targetTitle,this.targetDescription=this.data.targetDescription,this.theme=this.data.theme,this.userId=Number(this.data.userId),this.dataSource=new t.by([this.data.specificUser]),this.isService=this.data.isService,this.isService?(d=this.userId,this.disconnectingSelf=this.dataSource.data[0].id===this.store.getPerunPrincipal().userId):(d=this.dataSource.data[0].id,this.disconnectingSelf=this.userId===this.store.getPerunPrincipal().userId),this.userManager.getUsersBySpecificUser(d).subscribe(m=>{this.disconnectingLastOwner=1===m.length})}onConfirm(){let d,m;this.isService?(d=this.dataSource.data[0].id,m=this.userId):(d=this.userId,m=this.dataSource.data[0].id),this.userManager.removeSpecificUserOwner(d,m).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.DISCONNECT_IDENTITY.SUCCESS")),this.dialogRef.close(!0)})}onCancel(){this.dialogRef.close(!1)}}return I.\u0275fac=function(d){return new(d||I)(e.Y36(l.so),e.Y36(l.WI),e.Y36(O.Fv),e.Y36(R.V6),e.Y36(S.sK),e.Y36(R.d6))},I.\u0275cmp=e.Xpm({type:I,selectors:[["app-disconnect-identity-dialog"]],decls:26,vars:23,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","warn","mat-flat-button","",1,"ml-2",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""],["alert_type","warn"]],template:function(d,m){1&d&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"div")(4,"div",1)(5,"p"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div",2),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"table",3),e.ynx(12,4),e.YNc(13,P,1,0,"th",5),e.YNc(14,C,3,3,"td",6),e.BQk(),e.YNc(15,A,1,0,"tr",7),e.YNc(16,L,1,0,"tr",8),e.qZA(),e.YNc(17,v,3,3,"perun-web-apps-alert",9),e.YNc(18,b,3,3,"perun-web-apps-alert",9),e.qZA(),e.TgZ(19,"div",10)(20,"button",11),e.NdJ("click",function(){return m.onCancel()}),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"button",12),e.NdJ("click",function(){return m.onConfirm()}),e._uU(24),e.ALo(25,"translate"),e.qZA()()()),2&d&&(e.xp6(1),e.Oqu(e.lcZ(2,13,"DIALOGS.DISCONNECT_IDENTITY.TITLE_"+m.targetTitle)),e.xp6(2),e.Tol(m.theme),e.xp6(3),e.Oqu(e.lcZ(7,15,"DIALOGS.DISCONNECT_IDENTITY.DESCRIPTION_"+m.targetDescription)),e.xp6(3),e.hij(" ",e.lcZ(10,17,"DIALOGS.DISCONNECT_IDENTITY.ASK")," "),e.xp6(2),e.Q6J("dataSource",m.dataSource),e.xp6(4),e.Q6J("matHeaderRowDef",m.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",m.displayedColumns),e.xp6(1),e.Q6J("ngIf",m.disconnectingSelf),e.xp6(1),e.Q6J("ngIf",m.disconnectingLastOwner),e.xp6(3),e.hij(" ",e.lcZ(22,19,"DIALOGS.DISCONNECT_IDENTITY.CANCEL")," "),e.xp6(3),e.hij(" ",e.lcZ(25,21,"DIALOGS.DISCONNECT_IDENTITY.REMOVE")," "))},dependencies:[u.O5,n.lW,t.BZ,t.fO,t.as,t.w1,t.Dz,t.nj,t.ge,t.ev,t.XQ,t.Gk,l.uh,l.xY,l.H8,M.w,S.X$,g.d]}),I})()},29862:(x,N,s)=>{s.d(N,{x:()=>b});var O=s(32105),l=s(65412),R=s(69723),t=s(24006),e=s(94650),S=s(89383),u=s(36895),n=s(59549),M=s(284),g=s(4859);function P(E,I){1&E&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&E&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LENGTH")))}function C(E,I){1&E&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&E&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LENGTH")))}function A(E,I){1&E&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&E&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_FIRST_NAME")))}function L(E,I){1&E&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&E&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LENGTH")))}function v(E,I){1&E&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&E&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LAST_NAME")))}let b=(()=>{class E{constructor(D,d,m,_,o){this.dialogRef=D,this.data=d,this.userService=m,this.notificator=_,this.translateService=o,this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.titleBefore=new t.p4(this.data.user.titleBefore,[t.kI.pattern(".*[\\S]+.*"),t.kI.maxLength(129)]),this.titleAfter=new t.p4(this.data.user.titleAfter,[t.kI.pattern(".*[\\S]+.*"),t.kI.maxLength(129)]),this.firstName=new t.p4(this.data.user.firstName,[t.kI.required,t.kI.pattern(".*[\\S]+.*"),t.kI.maxLength(129)]),this.middleName=new t.p4(this.data.user.middleName,[t.kI.pattern(".*[\\S]+.*"),t.kI.maxLength(129)]),this.lastName=new t.p4(this.data.user.lastName,[t.kI.required,t.kI.pattern(".*[\\S]+.*"),t.kI.maxLength(129)])}onCancel(){this.dialogRef.close(!1)}onSave(){this.loading=!0,this.data.user.titleBefore=this.titleBefore.value,this.data.user.titleAfter=this.titleAfter.value,this.data.user.firstName=this.firstName.value,this.data.user.middleName=this.middleName.value,this.data.user.lastName=this.lastName.value,this.userService.updateUser({user:this.data.user}).subscribe(()=>{this.translateService.get("DIALOGS.EDIT_USER.SUCCESS").subscribe(D=>{this.notificator.showSuccess(D),this.dialogRef.close(!0)})},()=>this.loading=!1)}}return E.\u0275fac=function(D){return new(D||E)(e.Y36(l.so),e.Y36(l.WI),e.Y36(O.Fv),e.Y36(R.V6),e.Y36(S.sK))},E.\u0275cmp=e.Xpm({type:E,selectors:[["app-edit-user-dialog"]],decls:32,vars:38,consts:[[1,"mat-dialog-title"],["mat-dialog-content","",1,"dialog-container"],["matInput","",3,"formControl","placeholder"],[4,"ngIf"],["matInput","","data-cy","user-first-name-input","required","",3,"placeholder","formControl"],["matInput","","required","",3,"formControl","placeholder"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","data-cy","user-save-button","mat-flat-button","",1,"ml-2",3,"disabled","click"]],template:function(D,d){1&D&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1)(5,"mat-form-field"),e._UZ(6,"input",2),e.ALo(7,"translate"),e.YNc(8,P,3,3,"mat-error",3),e.qZA(),e.TgZ(9,"mat-form-field"),e._UZ(10,"input",2),e.ALo(11,"translate"),e.YNc(12,C,3,3,"mat-error",3),e.qZA(),e.TgZ(13,"mat-form-field"),e._UZ(14,"input",4),e.ALo(15,"translate"),e.YNc(16,A,3,3,"mat-error",3),e.qZA(),e.TgZ(17,"mat-form-field"),e._UZ(18,"input",2),e.ALo(19,"translate"),e.YNc(20,L,3,3,"mat-error",3),e.qZA(),e.TgZ(21,"mat-form-field"),e._UZ(22,"input",5),e.ALo(23,"translate"),e.YNc(24,v,3,3,"mat-error",3),e.qZA()(),e.TgZ(25,"div",6)(26,"button",7),e.NdJ("click",function(){return d.onCancel()}),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"button",8),e.NdJ("click",function(){return d.onSave()}),e._uU(30),e.ALo(31,"translate"),e.qZA()()()),2&D&&(e.Tol(d.theme),e.xp6(2),e.Oqu(e.lcZ(3,22,"DIALOGS.EDIT_USER.DIALOG_TITLE")),e.xp6(4),e.s9C("placeholder",e.lcZ(7,24,"DIALOGS.EDIT_USER.TITLE_BEFORE")),e.Q6J("formControl",d.titleBefore),e.xp6(2),e.Q6J("ngIf",d.titleBefore.invalid),e.xp6(2),e.s9C("placeholder",e.lcZ(11,26,"DIALOGS.EDIT_USER.TITLE_AFTER")),e.Q6J("formControl",d.titleAfter),e.xp6(2),e.Q6J("ngIf",d.titleAfter.invalid),e.xp6(2),e.s9C("placeholder",e.lcZ(15,28,"DIALOGS.EDIT_USER.FIRST_NAME")),e.Q6J("formControl",d.firstName),e.xp6(2),e.Q6J("ngIf",d.firstName.invalid),e.xp6(2),e.s9C("placeholder",e.lcZ(19,30,"DIALOGS.EDIT_USER.MIDDLE_NAME")),e.Q6J("formControl",d.middleName),e.xp6(2),e.Q6J("ngIf",d.middleName.invalid),e.xp6(2),e.s9C("placeholder",e.lcZ(23,32,"DIALOGS.EDIT_USER.LAST_NAME")),e.Q6J("formControl",d.lastName),e.xp6(2),e.Q6J("ngIf",d.lastName.invalid),e.xp6(3),e.hij(" ",e.lcZ(28,34,"DIALOGS.EDIT_USER.CANCEL")," "),e.xp6(2),e.Q6J("disabled",d.loading||d.firstName.invalid||d.lastName.invalid||d.titleBefore.invalid||d.titleAfter.invalid||d.middleName.invalid),e.xp6(1),e.hij(" ",e.lcZ(31,36,"DIALOGS.EDIT_USER.SAVE")," "))},dependencies:[u.O5,n.TO,n.KE,M.Nt,t.Fj,t.JJ,t.Q7,t.oH,g.lW,l.xY,l.H8,S.X$]}),E})()},98973:(x,N,s)=>{s.d(N,{u:()=>L});var O=s(69723),l=s(94650),R=s(94364),t=s(36895),e=s(3848),S=s(48323),u=s(12651),n=s(89383);function M(v,b){1&v&&(l._uU(0),l.ALo(1,"translate")),2&v&&l.hij(" ",l.lcZ(1,1,"ADMIN_USER.ENTITY")," ")}function g(v,b){if(1&v&&l._UZ(0,"app-one-entity-attribute-page",5),2&v){const E=l.oxw();l.Q6J("entityId",E.userId)("entity","user")}}function P(v,b){1&v&&(l._uU(0),l.ALo(1,"translate"),l.ALo(2,"translate")),2&v&&l.AsE(" ",l.lcZ(1,2,"ADMIN_USER.ENTITY")," - ",l.lcZ(2,4,"FACILITY_DETAIL.ENTITY")," ")}function C(v,b){if(1&v&&l._UZ(0,"app-two-entity-attribute-page",6),2&v){const E=l.oxw(2);l.Q6J("firstEntity","user")("firstEntityId",E.userId)("secondEntity","facility")}}function A(v,b){1&v&&(l.TgZ(0,"mat-tab"),l.YNc(1,P,3,6,"ng-template",2),l.YNc(2,C,1,3,"ng-template",3),l.qZA())}let L=(()=>{class v{constructor(E,I,D){this.route=E,this.store=I,this.authResolver=D}ngOnInit(){this.route.parent.params.subscribe(E=>{this.userId=Number(E.userId),this.userId||(this.userId=this.store.getPerunPrincipal().userId),this.userFacilityAttAuth=this.authResolver.isAuthorized("getAssignedFacilities_User_policy",[{id:this.userId,beanName:"User"}])})}}return v.\u0275fac=function(E){return new(E||v)(l.Y36(R.gz),l.Y36(O.d6),l.Y36(O.x4))},v.\u0275cmp=l.Xpm({type:v,selectors:[["app-user-settings-attributes"]],hostVars:2,hostBindings:function(E,I){2&E&&l.ekj("router-component",I.true)},decls:8,vars:4,consts:[[1,"page-subtitle"],[1,"mb-2"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(E,I){1&E&&(l.TgZ(0,"h1",0),l._uU(1),l.ALo(2,"translate"),l.qZA(),l.TgZ(3,"mat-tab-group")(4,"mat-tab",1),l.YNc(5,M,2,3,"ng-template",2),l.YNc(6,g,1,2,"ng-template",3),l.qZA(),l.YNc(7,A,3,0,"mat-tab",4),l.qZA()),2&E&&(l.xp6(1),l.Oqu(l.lcZ(2,2,"USER_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),l.xp6(6),l.Q6J("ngIf",I.userFacilityAttAuth))},dependencies:[t.O5,e.SP,e.uD,e.uX,e.Vc,S.Y,u.t,n.X$]}),v})()},85985:(x,N,s)=>{s.d(N,{u:()=>d});var O=s(69723),l=s(32105),R=s(10036),t=s(94650),e=s(94364),S=s(36895),u=s(51572),n=s(25788),M=s(96214),g=s(7434),P=s(89383);function C(m,_){1&m&&(t.TgZ(0,"h1",6),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&m&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.YOU_ARE_MEMBER"),"\n"))}function A(m,_){1&m&&(t.TgZ(0,"h1",6),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&m&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.USER_IS_MEMBER"),"\n"))}function L(m,_){1&m&&t._UZ(0,"mat-spinner",7)}const v=function(){return["id","vo","name","description"]};function b(m,_){if(1&m&&t._UZ(0,"perun-web-apps-groups-list",8),2&m){const o=t.oxw();t.Q6J("disableMembers",!1)("groups",o.membersGroups)("displayedColumns",t.DdM(5,v))("filter",o.memberFilterValue)("tableId",o.tableId)}}function E(m,_){1&m&&t._UZ(0,"mat-spinner",7)}function I(m,_){if(1&m&&t._UZ(0,"perun-web-apps-groups-list",8),2&m){const o=t.oxw(2);t.Q6J("disableMembers",!1)("groups",o.adminsGroups)("displayedColumns",t.DdM(5,v))("filter",o.adminFilterValue)("tableId",o.adminTableId)}}function D(m,_){if(1&m){const o=t.EpF();t.TgZ(0,"div",9)(1,"h1",6),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"perun-web-apps-refresh-button",1),t.NdJ("refresh",function(){t.CHM(o);const c=t.oxw();return t.KtG(c.refreshAdminTable())}),t.qZA(),t.TgZ(5,"perun-web-apps-immediate-filter",2),t.NdJ("filter",function(c){t.CHM(o);const h=t.oxw();return t.KtG(h.adminFilter(c))}),t.qZA(),t.YNc(6,E,1,0,"mat-spinner",3),t.YNc(7,I,1,6,"perun-web-apps-groups-list",4),t.qZA()}if(2&m){const o=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,4,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.USER_IS_ADMIN")," "),t.xp6(3),t.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),t.xp6(1),t.Q6J("ngIf",o.adminRefresh),t.xp6(1),t.Q6J("ngIf",!o.adminRefresh)}}let d=(()=>{class m{constructor(o,a,c,h,T){this.usersService=o,this.memberService=a,this.groupService=c,this.store=h,this.route=T,this.memberFilterValue="",this.adminFilterValue="",this.vos=[],this.membersGroups=[],this.adminsGroups=[],this.tableId=R.KE,this.adminTableId=R.Sb}ngOnInit(){(this.showPrincipal=this.route.snapshot.data.showPrincipal)?this.userId=this.store.getPerunPrincipal().user.id:this.route.parent.params.subscribe(o=>this.userId=Number(o.userId)),this.refreshAdminTable(),this.refreshMemberTable()}memberFilter(o){this.memberFilterValue=o}adminFilter(o){this.adminFilterValue=o}refreshAdminTable(){this.adminRefresh=!0,this.usersService.getGroupsWhereUserIsAdmin(this.userId).subscribe(o=>{this.adminsGroups=o,this.adminRefresh=!1})}refreshMemberTable(){this.memberRefresh=!0,this.membersGroups=[],this.usersService.getVosWhereUserIsMember(this.userId).subscribe(o=>{this.vos=o;for(const a of this.vos)this.memberService.getMemberByUser(a.id,this.userId).subscribe(c=>{this.groupService.getMemberGroups(c.id).subscribe(h=>{this.membersGroups=this.membersGroups.concat(h),this.vos.indexOf(a)===this.vos.length-1&&(this.memberRefresh=!1)})});0===o.length&&(this.memberRefresh=!1)})}}return m.\u0275fac=function(o){return new(o||m)(t.Y36(l.Fv),t.Y36(l.uq),t.Y36(l.ff),t.Y36(O.d6),t.Y36(e.gz))},m.\u0275cmp=t.Xpm({type:m,selectors:[["app-user-groups"]],hostVars:2,hostBindings:function(o,a){2&o&&t.ekj("router-component",a.true)},decls:7,vars:6,consts:[["class","page-subtitle",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"disableMembers","groups","displayedColumns","filter","tableId",4,"ngIf"],["class","mt-5",4,"ngIf"],[1,"page-subtitle"],[1,"ml-auto","mr-auto"],[3,"disableMembers","groups","displayedColumns","filter","tableId"],[1,"mt-5"]],template:function(o,a){1&o&&(t.YNc(0,C,3,3,"h1",0),t.YNc(1,A,3,3,"h1",0),t.TgZ(2,"perun-web-apps-refresh-button",1),t.NdJ("refresh",function(){return a.refreshMemberTable()}),t.qZA(),t.TgZ(3,"perun-web-apps-immediate-filter",2),t.NdJ("filter",function(h){return a.memberFilter(h)}),t.qZA(),t.YNc(4,L,1,0,"mat-spinner",3),t.YNc(5,b,1,6,"perun-web-apps-groups-list",4),t.YNc(6,D,8,6,"div",5)),2&o&&(t.Q6J("ngIf",a.showPrincipal),t.xp6(1),t.Q6J("ngIf",!a.showPrincipal),t.xp6(2),t.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),t.xp6(1),t.Q6J("ngIf",a.memberRefresh),t.xp6(1),t.Q6J("ngIf",!a.memberRefresh),t.xp6(1),t.Q6J("ngIf",!a.showPrincipal))},dependencies:[S.O5,u.Ou,n.W,M.t,g.L,P.X$]}),m})()},74837:(x,N,s)=>{s.d(N,{j:()=>D});var O=s(32105),l=s(69723),R=s(10036),t=s(94650),e=s(94364),S=s(36895),u=s(51572),n=s(87831),M=s(96214),g=s(7434),P=s(89383);function C(d,m){1&d&&(t.TgZ(0,"h1",6),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&d&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED_LIB.PERUN.ORGANIZATIONS.YOU_ARE_MEMBER"),"\n"))}function A(d,m){1&d&&(t.TgZ(0,"h1",6),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&d&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED_LIB.PERUN.ORGANIZATIONS.USER_IS_MEMBER"),"\n"))}function L(d,m){1&d&&t._UZ(0,"mat-spinner",7)}function v(d,m){if(1&d&&t._UZ(0,"perun-web-apps-vos-list",8),2&d){const _=t.oxw();t.Q6J("displayedColumns",_.displayedColumns)("tableId",_.memberTableId)("filterValue",_.memberFilterValue)("vos",_.vosWhereIsMember)}}function b(d,m){1&d&&t._UZ(0,"mat-spinner",7)}function E(d,m){if(1&d&&t._UZ(0,"perun-web-apps-vos-list",8),2&d){const _=t.oxw(2);t.Q6J("displayedColumns",_.displayedColumns)("tableId",_.adminTableId)("filterValue",_.adminFilterValue)("vos",_.vosWhereIsAdmin)}}function I(d,m){if(1&d){const _=t.EpF();t.TgZ(0,"div",9)(1,"h1",6),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"perun-web-apps-refresh-button",1),t.NdJ("refresh",function(){t.CHM(_);const a=t.oxw();return t.KtG(a.refreshAdminTable())}),t.qZA(),t.TgZ(5,"perun-web-apps-immediate-filter",2),t.NdJ("filter",function(a){t.CHM(_);const c=t.oxw();return t.KtG(c.applyAdminFilter(a))}),t.qZA(),t.YNc(6,b,1,0,"mat-spinner",3),t.YNc(7,E,1,4,"perun-web-apps-vos-list",4),t.qZA()}if(2&d){const _=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,4,"SHARED_LIB.PERUN.ORGANIZATIONS.USER_IS_ADMIN")),t.xp6(3),t.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),t.xp6(1),t.Q6J("ngIf",_.adminRefresh),t.xp6(1),t.Q6J("ngIf",!_.adminRefresh)}}let D=(()=>{class d{constructor(_,o,a,c){this.usersService=_,this.authResolver=o,this.store=a,this.route=c,this.adminFilterValue="",this.memberFilterValue="",this.displayedColumns=["id","name"],this.adminTableId=R.YF,this.memberTableId=R.gc}ngOnInit(){(this.isMyProfile=this.route.snapshot.data.showPrincipal)?this.userId=this.store.getPerunPrincipal().user.id:this.route.parent.params.subscribe(_=>this.userId=Number(_.userId)),this.refreshAdminTable(),this.refreshMemberTable()}refreshMemberTable(){this.memberRefresh=!0,this.usersService.getVosWhereUserIsMember(this.userId).subscribe(_=>{this.vosWhereIsMember=_,this.memberRefresh=!1},()=>this.memberRefresh=!1)}refreshAdminTable(){this.adminRefresh=!0,this.usersService.getVosWhereUserIsAdmin(this.userId).subscribe(_=>{this.vosWhereIsAdmin=_,this.adminRefresh=!1},()=>this.adminRefresh=!1)}applyMemberFilter(_){this.memberFilterValue=_}applyAdminFilter(_){this.adminFilterValue=_}}return d.\u0275fac=function(_){return new(_||d)(t.Y36(O.Fv),t.Y36(l.x4),t.Y36(l.d6),t.Y36(e.gz))},d.\u0275cmp=t.Xpm({type:d,selectors:[["app-user-organizations"]],hostVars:2,hostBindings:function(_,o){2&_&&t.ekj("router-component",o.true)},decls:7,vars:6,consts:[["class","page-subtitle",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],["class","mr-auto ml-auto",4,"ngIf"],[3,"displayedColumns","tableId","filterValue","vos",4,"ngIf"],["class","mt-5",4,"ngIf"],[1,"page-subtitle"],[1,"mr-auto","ml-auto"],[3,"displayedColumns","tableId","filterValue","vos"],[1,"mt-5"]],template:function(_,o){1&_&&(t.YNc(0,C,3,3,"h1",0),t.YNc(1,A,3,3,"h1",0),t.TgZ(2,"perun-web-apps-refresh-button",1),t.NdJ("refresh",function(){return o.refreshMemberTable()}),t.qZA(),t.TgZ(3,"perun-web-apps-immediate-filter",2),t.NdJ("filter",function(c){return o.applyMemberFilter(c)}),t.qZA(),t.YNc(4,L,1,0,"mat-spinner",3),t.YNc(5,v,1,4,"perun-web-apps-vos-list",4),t.YNc(6,I,8,6,"div",5)),2&_&&(t.Q6J("ngIf",o.isMyProfile),t.xp6(1),t.Q6J("ngIf",!o.isMyProfile),t.xp6(2),t.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),t.xp6(1),t.Q6J("ngIf",o.memberRefresh),t.xp6(1),t.Q6J("ngIf",!o.memberRefresh),t.xp6(1),t.Q6J("ngIf",!o.isMyProfile))},dependencies:[S.O5,u.Ou,n.Z,M.t,g.L,P.X$]}),d})()},17755:(x,N,s)=>{s.d(N,{Z:()=>_});var O=s(32105),l=s(30671),R=s(69723),t=s(64080),e=s(9244),S=s(36792),u=s(94650),n=s(94364),M=s(65412),g=s(36895),P=s(97392),C=s(4859),A=s(73546),L=s(71135),v=s(89383);function b(o,a){1&o&&u._UZ(0,"th",12)}function E(o,a){if(1&o&&(u.TgZ(0,"td",13),u._uU(1),u.qZA()),2&o){const c=a.$implicit;u.xp6(1),u.hij(" ",c.displayName,": ")}}function I(o,a){1&o&&u._UZ(0,"th",12)}function D(o,a){if(1&o){const c=u.EpF();u.TgZ(0,"td",14),u._uU(1),u.TgZ(2,"button",15),u.NdJ("click",function(){u.CHM(c);const T=u.oxw(2);return u.KtG(T.changeEmail())}),u.TgZ(3,"mat-icon"),u._uU(4,"edit"),u.qZA()()()}if(2&o){const c=a.$implicit;u.xp6(1),u.hij(" ",c.value," ")}}function d(o,a){1&o&&u._UZ(0,"tr",16)}function m(o,a){if(1&o&&(u.TgZ(0,"div",2)(1,"mat-card",3)(2,"mat-card-header")(3,"mat-card-title")(4,"h1",4),u._uU(5),u.ALo(6,"translate"),u.qZA()()(),u.TgZ(7,"mat-card-content")(8,"table",5),u.ynx(9,6),u.YNc(10,b,1,0,"th",7),u.YNc(11,E,2,1,"td",8),u.BQk(),u.ynx(12,9),u.YNc(13,I,1,0,"th",7),u.YNc(14,D,5,1,"td",10),u.BQk(),u.YNc(15,d,1,0,"tr",11),u.qZA()()()()),2&o){const c=u.oxw();u.xp6(5),u.Oqu(u.lcZ(6,3,"USER_DETAIL.OVERVIEW.GENERAL_SETTINGS")),u.xp6(3),u.Q6J("dataSource",c.mailDataSource),u.xp6(7),u.Q6J("matRowDefColumns",c.displayedColumns)}}let _=(()=>{class o{constructor(c,h,T,y,B){this.userService=c,this.attributeService=h,this.storeService=T,this.route=y,this.dialog=B,this.navItems=[],this.isServiceUser=!1,this.displayedColumns=["name","value"],this.inMyProfile=!1}ngOnInit(){this.route.params.subscribe(c=>{c.userId?this.userService.getUserById(Number(c.userId)).subscribe(h=>{this.user=h,this.isServiceUser=h.serviceUser,this.initNavItems()}):(this.inMyProfile=!0,this.userID=this.storeService.getPerunPrincipal().user.id,this.attributeService.getUserAttributeByName(this.userID,t.r.USER_DEF_PREFERRED_MAIL).subscribe(h=>{this.preferredMail=h,this.handleMailNotDefined(),this.mailDataSource=new l.by([this.preferredMail]),this.initNavItems()}))})}changeEmail(){const c=(0,e.kZ)();c.width="350px",c.data={userId:this.userID},this.dialog.open(S.gr,c).afterClosed().subscribe(T=>{T&&this.attributeService.getUserAttributeByName(this.userID,t.r.USER_DEF_PREFERRED_MAIL).subscribe(y=>{this.preferredMail=y,this.handleMailNotDefined(),this.mailDataSource=new l.by([this.preferredMail])})})}handleMailNotDefined(){null==this.preferredMail&&(this.preferredMail={id:-1,beanName:"Attribute",displayName:(0,e.Cz)(t.r.USER_DEF_PREFERRED_MAIL.split(":").pop()),value:new Object("-")})}initNavItems(){this.navItems=[{cssIcon:"perun-vo",url:"organizations",label:"MENU_ITEMS.ADMIN.ORGANIZATIONS",style:"user-btn"},{cssIcon:"perun-group",url:"groups",label:"MENU_ITEMS.ADMIN.GROUPS",style:"user-btn"}],window.location.pathname.startsWith("/admin")&&this.navItems.push({cssIcon:"perun-user",url:"accounts",label:"MENU_ITEMS.USER.ACCOUNTS",style:"user-btn"},{cssIcon:"perun-identity",url:"identities",label:"MENU_ITEMS.USER.IDENTITIES",style:"user-btn"},{cssIcon:"perun-facility-white",url:"facilities",label:"MENU_ITEMS.USER.FACILITIES",style:"user-btn"},{cssIcon:"perun-resource",url:"resources",label:"MENU_ITEMS.USER.RESOURCES",style:"user-btn"}),this.navItems.push({cssIcon:"perun-attributes",url:"attributes",label:"MENU_ITEMS.USER.ATTRIBUTES",style:"user-btn"}),this.navItems.push({cssIcon:"perun-roles",url:"roles",label:"MENU_ITEMS.USER.ROLES",style:"user-btn"}),this.navItems.push(this.isServiceUser?{cssIcon:"perun-manager",url:"associated-users",label:"MENU_ITEMS.USER.ASSOCIATED_USERS",style:"user-btn"}:{cssIcon:"perun-service-identity",url:"service-identities",label:"MENU_ITEMS.USER.SERVICE_IDENTITIES",style:"user-btn"}),window.location.pathname.startsWith("/admin")||this.navItems.push({cssIcon:"perun-settings2",url:"settings",label:"MENU_ITEMS.ADMIN.SETTINGS",style:"user-btn"})}}return o.\u0275fac=function(c){return new(c||o)(u.Y36(O.Fv),u.Y36(O.H8),u.Y36(R.d6),u.Y36(n.gz),u.Y36(M.uw))},o.\u0275cmp=u.Xpm({type:o,selectors:[["app-user-overview"]],hostVars:2,hostBindings:function(c,h){2&c&&u.ekj("router-component",h.true)},decls:2,vars:3,consts:[["class","align-cards",4,"ngIf"],[3,"items","size"],[1,"align-cards"],[1,"mat-elevation-z3"],[1,"page-subtitle"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["class","font-weight-bold","mat-cell","",4,"matCellDef"],["matColumnDef","value"],["mat-cell","",4,"matCellDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"font-weight-bold"],["mat-cell",""],["mat-icon-button","",1,"ml-3",3,"click"],["mat-row",""]],template:function(c,h){1&c&&(u.YNc(0,m,16,5,"div",0),u._UZ(1,"perun-web-apps-menu-buttons-field",1)),2&c&&(u.Q6J("ngIf",h.inMyProfile),u.xp6(1),u.Q6J("items",h.navItems)("size","small"))},dependencies:[g.O5,P.Hw,C.lW,l.BZ,l.fO,l.w1,l.Dz,l.nj,l.ge,l.ev,l.Gk,A.a8,A.dk,A.dn,A.n5,L.L,v.X$],styles:[".align-cards[_ngcontent-%COMP%]{margin:1rem;display:inline-block;vertical-align:top}"]}),o})()},6097:(x,N,s)=>{s.d(N,{t:()=>M});var O=s(32105),l=s(69723),R=s(39646),t=s(48382),e=s(86099),S=s(94650),u=s(94364),n=s(79394);let M=(()=>{class g{constructor(C,A,L,v){this.authzResolverService=C,this.route=A,this.store=L,this.roleService=v,this.roles=new Map,this.showDescription=!0}ngOnInit(){this.outerLoading=!0,this.route.parent.params.subscribe(C=>{C.userId?(this.entityType="USER",this.userId=Number(C.userId)):(this.userId=this.store.getPerunPrincipal().userId,this.entityType="SELF"),this.getData()})}getData(){this.outerLoading=!0,this.roles.clear(),(0,R.of)(this.entityType).pipe((0,e.z)(C=>(0,t.s)(()=>"SELF"===C,(0,R.of)(this.store.getPerunPrincipal().roles),this.authzResolverService.getUserRoles(this.userId)))).subscribe(C=>{const A=Object.keys(C).map(L=>L.toUpperCase());this.roles=this.roleService.prepareRoles(C,A),this.outerLoading=!1})}}return g.\u0275fac=function(C){return new(C||g)(S.Y36(O.Ct),S.Y36(u.gz),S.Y36(l.d6),S.Y36(l.Nj))},g.\u0275cmp=S.Xpm({type:g,selectors:[["app-user-roles"]],hostVars:2,hostBindings:function(C,A){2&C&&S.ekj("router-component",A.true)},decls:1,vars:5,consts:[[3,"outerLoading","roles","entityId","showDescription","entityType","reload","startLoading"]],template:function(C,A){1&C&&(S.TgZ(0,"app-perun-web-apps-roles-page",0),S.NdJ("reload",function(){return A.getData()})("startLoading",function(){return A.outerLoading=!0}),S.qZA()),2&C&&S.Q6J("outerLoading",A.outerLoading)("roles",A.roles)("entityId",A.userId)("showDescription",A.showDescription)("entityType",A.entityType)},dependencies:[n._]}),g})()},46597:(x,N,s)=>{s.d(N,{d:()=>m});var O=s(10036),l=s(32105),R=s(95017),t=s(9244),e=s(54668),S=s(94814),u=s(69723),n=s(54004),M=s(63900),g=s(94650),P=s(65412),C=s(94364),A=s(36895),L=s(4859),v=s(51572),b=s(96214),E=s(64877),I=s(89383);function D(_,o){if(1&_&&(g._UZ(0,"app-users-list",6),g.ALo(1,"translate")),2&_){const a=g.oxw();g.Q6J("noUsersFoundLabel",g.lcZ(1,6,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.NO_ASSOCIATED_USERS"))("disableRouting",a.disableRouting)("displayedColumns",a.displayedColumns)("selection",a.selection)("tableId",a.tableId)("users",a.associatedUsers)}}function d(_,o){1&_&&g._UZ(0,"mat-spinner",7)}let m=(()=>{class _{constructor(a,c,h,T,y){this.dialog=a,this.router=c,this.authResolver=h,this.userManager=T,this.entityStorageService=y,this.loading=!1,this.selection=new R.Ov(!1,[]),this.associatedUsers=[],this.tableId=O.It,this.displayedColumns=["select","id","user","name","email","logins","organization"]}ngOnInit(){this.loading=!0,this.user=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.userManager.getUsersBySpecificUser(this.user.id).pipe((0,n.U)(a=>a.map(c=>c.id)),(0,M.w)(a=>this.userManager.getRichUsersWithAttributesByIds(a))).subscribe(a=>{this.associatedUsers=a,this.selection.clear(),this.setAuth(),this.loading=!1})}setAuth(){this.addAuth=this.authResolver.isAuthorized("addSpecificUserOwner_User_User_policy",[this.user]),this.removeAuth=this.authResolver.isAuthorized("removeSpecificUserOwner_User_User_policy",[this.user]),this.disableRouting=!this.authResolver.isPerunAdminOrObserver()}onAdd(){const a=(0,t.kZ)();a.width="1250px",a.data={userId:this.user.id,theme:"user-theme",isService:!0,target:"USER"},this.dialog.open(e.l,a).afterClosed().subscribe(h=>{h&&this.refreshTable()})}onRemove(){const a=(0,t.kZ)();a.width="650px",a.data={identities:this.selection.selected,userId:this.user.id,specificUser:this.selection.selected[0],isService:!0,theme:"user-theme",targetTitle:"USER",targetDescription:"SERVICE"},this.dialog.open(S.B,a).afterClosed().subscribe(h=>{h&&(this.authResolver.isAuthorized("getUsersBySpecificUser_User_policy",[this.user])?this.refreshTable():this.router.navigate(["/myProfile"]))})}}return _.\u0275fac=function(a){return new(a||_)(g.Y36(P.uw),g.Y36(C.F0),g.Y36(u.x4),g.Y36(l.Fv),g.Y36(u.fb))},_.\u0275cmp=g.Xpm({type:_,selectors:[["app-user-settings-associated-users"]],decls:13,vars:12,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"mr-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[3,"noUsersFoundLabel","disableRouting","displayedColumns","selection","tableId","users",4,"ngIf"],["class","mr-auto ml-auto",4,"ngIf"],[3,"noUsersFoundLabel","disableRouting","displayedColumns","selection","tableId","users"],[1,"mr-auto","ml-auto"]],template:function(a,c){1&a&&(g.TgZ(0,"div")(1,"h1",0),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"perun-web-apps-refresh-button",1),g.NdJ("refresh",function(){return c.refreshTable()}),g.qZA(),g.TgZ(5,"button",2),g.NdJ("click",function(){return c.onAdd()}),g._uU(6),g.ALo(7,"translate"),g.qZA(),g.TgZ(8,"button",3),g.NdJ("click",function(){return c.onRemove()}),g._uU(9),g.ALo(10,"translate"),g.qZA(),g.YNc(11,D,2,8,"app-users-list",4),g.qZA(),g.YNc(12,d,1,0,"mat-spinner",5)),2&a&&(g.xp6(2),g.Oqu(g.lcZ(3,6,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.TITLE")),g.xp6(4),g.hij(" ",g.lcZ(7,8,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.ADD")," "),g.xp6(2),g.Q6J("disabled",0===c.selection.selected.length),g.xp6(1),g.hij(" ",g.lcZ(10,10,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.REMOVE")," "),g.xp6(2),g.Q6J("ngIf",!c.loading),g.xp6(1),g.Q6J("ngIf",c.loading))},dependencies:[A.O5,L.lW,v.Ou,b.t,E.C,I.X$]}),_})()},97453:(x,N,s)=>{s.d(N,{R:()=>m});var O=s(95017),l=s(32105),R=s(10036),t=s(9244),e=s(54668),S=s(94814),u=s(69723),n=s(94650),M=s(94364),g=s(65412),P=s(36895),C=s(4859),A=s(51572),L=s(96214),v=s(64877),b=s(89383);function E(_,o){if(1&_){const a=n.EpF();n.TgZ(0,"button",6),n.NdJ("click",function(){n.CHM(a);const h=n.oxw();return n.KtG(h.onAdd())}),n._uU(1),n.ALo(2,"translate"),n.qZA()}2&_&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.CREATE"),"\n"))}function I(_,o){if(1&_){const a=n.EpF();n.TgZ(0,"button",7),n.NdJ("click",function(){n.CHM(a);const h=n.oxw();return n.KtG(h.onRemove())}),n._uU(1),n.ALo(2,"translate"),n.qZA()}if(2&_){const a=n.oxw();n.Q6J("disabled",0===a.selection.selected.length),n.xp6(1),n.hij(" ",n.lcZ(2,2,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.DELETE"),"\n")}}function D(_,o){1&_&&n._UZ(0,"mat-spinner",8)}function d(_,o){if(1&_&&(n._UZ(0,"app-users-list",9),n.ALo(1,"translate")),2&_){const a=n.oxw();n.Q6J("noUsersFoundLabel",n.lcZ(1,6,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.NO_IDENTITIES"))("displayedColumns",a.displayedColumns)("selection",a.selection)("tableId",a.tableId)("routeToAdmin",a.routeToAdminSection)("users",a.identities)}}let m=(()=>{class _{constructor(a,c,h,T,y,B){this.route=a,this.dialog=c,this.router=h,this.userManager=T,this.authResolver=y,this.store=B,this.loading=!1,this.selection=new O.Ov(!1,[]),this.identities=[],this.tableId=R.Iz,this.displayedColumns=["select","id","user","name"],this.routeToAdminSection=!0,this.targetTitle="SERVICE",this.targetDescription="SERVICE"}ngOnInit(){this.loading=!0,this.route.parent.params.subscribe(a=>{this.userId=Number(a.userId),this.userId||(this.targetTitle="SERVICE",this.targetDescription="SELF",this.userId=this.store.getPerunPrincipal().userId,this.routeToAdminSection=!1),this.setAuthRights(),this.refreshTable()})}refreshTable(){this.loading=!0,this.userManager.getSpecificUsersByUser(this.userId).subscribe(a=>{this.identities=a,this.selection.clear(),this.loading=!1})}setAuthRights(){this.addIdentity=this.authResolver.isPerunAdmin(),this.removeIdentity=this.authResolver.isAuthorized("removeSpecificUserOwner_User_User_policy",[{id:this.userId,beanName:"User"}])}onAdd(){const a=(0,t.kZ)();a.width="1250px",a.data={userId:this.userId,theme:"user-theme",isService:!1,target:this.targetTitle},this.dialog.open(e.l,a).afterClosed().subscribe(h=>{h&&this.refreshTable()})}onRemove(){const a=(0,t.kZ)();a.width="650px",a.data={identities:this.selection.selected,userId:this.userId,specificUser:this.selection.selected[0],theme:"user-theme",targetTitle:this.targetTitle,targetDescription:this.targetDescription},this.dialog.open(S.B,a).afterClosed().subscribe(h=>{h&&this.refreshTable()})}}return _.\u0275fac=function(a){return new(a||_)(n.Y36(M.gz),n.Y36(g.uw),n.Y36(M.F0),n.Y36(l.Fv),n.Y36(u.x4),n.Y36(u.d6))},_.\u0275cmp=n.Xpm({type:_,selectors:[["app-user-settings-service-identities"]],decls:8,vars:7,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","class","mr-2 action-button","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","class","mr-2","mat-flat-button","",3,"disabled","click",4,"ngIf"],["class","mr-auto ml-auto",4,"ngIf"],[3,"noUsersFoundLabel","displayedColumns","selection","tableId","routeToAdmin","users",4,"ngIf"],["color","accent","mat-flat-button","",1,"mr-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],[3,"noUsersFoundLabel","displayedColumns","selection","tableId","routeToAdmin","users"]],template:function(a,c){1&a&&(n.TgZ(0,"h1",0),n._uU(1),n.ALo(2,"translate"),n.qZA(),n.TgZ(3,"perun-web-apps-refresh-button",1),n.NdJ("refresh",function(){return c.refreshTable()}),n.qZA(),n.YNc(4,E,3,3,"button",2),n.YNc(5,I,3,4,"button",3),n.YNc(6,D,1,0,"mat-spinner",4),n.YNc(7,d,2,8,"app-users-list",5)),2&a&&(n.xp6(1),n.Oqu(n.lcZ(2,5,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.TITLE")),n.xp6(3),n.Q6J("ngIf",c.addIdentity),n.xp6(1),n.Q6J("ngIf",c.removeIdentity),n.xp6(1),n.Q6J("ngIf",c.loading),n.xp6(1),n.Q6J("ngIf",!c.loading))},dependencies:[P.O5,C.lW,A.Ou,L.t,v.C,b.X$]}),_})()},38338:(x,N,s)=>{s.r(N),s.d(N,{UsersModule:()=>at});var O=s(36895),l=s(94364),R=s(74837),t=s(85985),e=s(94650),S=s(61283);let u=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-settings"]],hostVars:2,hostBindings:function(i,p){2&i&&e.ekj("router-component",p.true)},decls:1,vars:0,template:function(i,p){1&i&&e._UZ(0,"app-animated-router-outlet")},dependencies:[S.A]}),r})();var n=s(32105),M=s(51572),g=s(71135);function P(r,f){1&r&&e._UZ(0,"mat-spinner",2)}function C(r,f){if(1&r&&(e.TgZ(0,"div"),e._UZ(1,"perun-web-apps-menu-buttons-field",3),e.qZA()),2&r){const i=e.oxw();e.xp6(1),e.Q6J("items",i.navItems)("size","small")}}let A=(()=>{class r{constructor(i,p){this.route=i,this.userManager=p,this.navItems=[],this.loading=!1}ngOnInit(){window.location.pathname.startsWith("/admin")?(this.loading=!0,this.route.parent.parent.params.subscribe(i=>{const p=Number(i.userId);this.userManager.getUserById(p).subscribe(U=>{this.isServiceUser=U.serviceUser,this.initNavItems(),this.loading=!1},()=>this.loading=!1)})):this.initNavItems()}initNavItems(){this.navItems=[],window.location.pathname.startsWith("/admin")||this.navItems.push({cssIcon:"perun-settings2",url:"passwordReset",label:"MENU_ITEMS.USER.PASSWORD_RESET",style:"user-btn"},{cssIcon:"perun-settings1",url:"guiConfig",label:"MENU_ITEMS.USER.GUI_CONFIG",style:"user-btn"})}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(l.gz),e.Y36(n.Fv))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-settings-overview"]],hostVars:2,hostBindings:function(i,p){2&i&&e.ekj("router-component",p.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(i,p){1&i&&(e.YNc(0,P,1,0,"mat-spinner",0),e.YNc(1,C,2,2,"div",1)),2&i&&(e.Q6J("ngIf",p.loading),e.xp6(1),e.Q6J("ngIf",!p.loading))},dependencies:[O.O5,M.Ou,g.L]}),r})();var L=s(98973),v=s(85147),b=s(9244),E=s(6335),I=s(3238),D=s(59549),d=s(84385),m=s(89383);function _(r,f){if(1&r&&(e.TgZ(0,"mat-option",5),e._uU(1),e.qZA()),2&r){const i=f.$implicit;e.Q6J("value",i),e.xp6(1),e.hij(" ",i," ")}}let o=(()=>{class r{constructor(i){this.guiConfigService=i,this.tablePageSizeOptions=b.f7}ngOnInit(){this.preferredTablePageSize=this.guiConfigService.getNumber(E.Rc)}updatePreferredTablePageSize(){this.guiConfigService.setNumber(E.Rc,this.preferredTablePageSize)}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(E.Ng))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-settings-app-configuration"]],decls:10,vars:8,consts:[[1,"page-subtitle"],[1,"col-12","col-lg-6","p-0"],[1,"w-100"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,p){1&i&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"div",1)(4,"mat-form-field",2)(5,"mat-label"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"mat-select",3),e.NdJ("valueChange",function(){return p.updatePreferredTablePageSize()})("valueChange",function(Z){return p.preferredTablePageSize=Z}),e.YNc(9,_,2,2,"mat-option",4),e.qZA()()()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,4,"USER_DETAIL.SETTINGS.GUI_CONFIG.TITLE")),e.xp6(5),e.Oqu(e.lcZ(7,6,"USER_DETAIL.SETTINGS.GUI_CONFIG.PREF_TABLE_PAGE_SIZE")),e.xp6(2),e.Q6J("value",p.preferredTablePageSize),e.xp6(1),e.Q6J("ngForOf",p.tablePageSizeOptions))},dependencies:[O.sg,I.ey,D.KE,D.hX,d.gD,m.X$]}),r})();var a=s(17755),c=s(69723),h=s(77968),T=s(97392),y=s(10266),B=s(4235),F=s(31359);const Q=function(){return{color:"black"}},H=function(){return["/myProfile"]};function V(r,f){if(1&r&&(e.TgZ(0,"div",1),e._UZ(1,"perun-web-apps-back-button"),e.TgZ(2,"div",2),e._UZ(3,"mat-icon",3),e.ALo(4,"translate"),e.TgZ(5,"div",4)(6,"div",5)(7,"a",6),e._uU(8),e.ALo(9,"userFullName"),e.qZA(),e.TgZ(10,"span",7),e._uU(11),e.qZA()(),e.TgZ(12,"span",8),e._uU(13),e.ALo(14,"translate"),e.ALo(15,"translate"),e.qZA()()(),e._UZ(16,"app-animated-router-outlet"),e.qZA()),2&r){const i=e.oxw();e.xp6(3),e.s9C("matTooltip",e.lcZ(4,8,"MENU_ITEMS.USER.ENTITY")),e.Q6J("ngStyle",e.DdM(16,Q)),e.xp6(4),e.Q6J("routerLink",e.DdM(17,H)),e.xp6(1),e.hij(" ",e.lcZ(9,10,i.user)," "),e.xp6(3),e.hij(" \xa0#",i.user.id," "),e.xp6(2),e.lnq(" ",e.lcZ(14,12,"MENU_ITEMS.USER.ENTITY"),", ",e.lcZ(15,14,"MENU_ITEMS.USER.USER_TYPE"),": ",i.getUserType()," ")}}let X=(()=>{class r{constructor(i,p,U){this.sideMenuService=i,this.store=p,this.router=U}ngOnInit(){this.path=this.router.url,this.router.events.subscribe(()=>{this.path=this.router.url}),this.principal=this.store.getPerunPrincipal(),this.user=this.principal.user,this.sideMenuService.setUserItems([])}getUserType(){return this.user.serviceUser?"Service":"Person"}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(h.D),e.Y36(c.d6),e.Y36(l.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-profile"]],decls:1,vars:1,consts:[["class","container-fluid pl-xl-5 pr-xl-5 user-theme",4,"ngIf"],[1,"container-fluid","pl-xl-5","pr-xl-5","user-theme"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-user-dark",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],["queryParamsHandling","merge",1,"user-link",3,"routerLink"],[1,"text-muted"],[1,"mt-1","entity-info"]],template:function(i,p){1&i&&e.YNc(0,V,17,18,"div",0),2&i&&e.Q6J("ngIf",void 0!==p.user)},dependencies:[O.O5,O.PC,l.yS,T.Hw,y.gM,B.W,S.A,m.X$,F.d]}),r})();var $=s(6097),k=s(97453),q=s(69024),ee=s(29862),K=s(65412),G=s(4859);function te(r,f){1&r&&e._UZ(0,"mat-spinner",11)}function se(r,f){if(1&r){const i=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(i);const U=e.oxw(2);return e.KtG(U.editUser())}),e.TgZ(1,"mat-icon"),e._uU(2,"edit"),e.qZA()()}}const ne=function(){return{color:"black"}},ie=function(r){return["/myProfile/service-identities",r]};function re(r,f){if(1&r&&(e.TgZ(0,"div",1),e._UZ(1,"perun-web-apps-back-button"),e.YNc(2,te,1,0,"mat-spinner",2),e.TgZ(3,"div",3),e._UZ(4,"mat-icon",4),e.ALo(5,"translate"),e.TgZ(6,"div",5)(7,"div",6)(8,"a",7),e._uU(9),e.ALo(10,"userFullName"),e.qZA(),e.TgZ(11,"span",8),e._uU(12),e.qZA(),e.YNc(13,se,3,0,"button",9),e.qZA(),e.TgZ(14,"div"),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"span",10),e._uU(18),e.ALo(19,"translate"),e.ALo(20,"translate"),e.qZA()()(),e._UZ(21,"app-animated-router-outlet"),e.qZA()),2&r){const i=e.oxw();e.xp6(2),e.Q6J("ngIf",i.loading),e.xp6(2),e.s9C("matTooltip",e.lcZ(5,12,"MENU_ITEMS.USER.ENTITY")),e.Q6J("ngStyle",e.DdM(22,ne)),e.xp6(4),e.Q6J("routerLink",e.VKq(23,ie,i.user.id)),e.xp6(1),e.hij(" ",e.lcZ(10,14,i.user)," "),e.xp6(3),e.hij(" \xa0#",i.user.id," "),e.xp6(1),e.Q6J("ngIf",i.authResolver.isPerunAdmin()),e.xp6(2),e.AsE("",e.lcZ(16,16,"ADMIN_USER.UUID"),": ",i.user.uuid,""),e.xp6(3),e.lnq(" ",e.lcZ(19,18,"MENU_ITEMS.USER.ENTITY"),", ",e.lcZ(20,20,"MENU_ITEMS.USER.USER_TYPE"),": ",i.getUserType()," ")}}let ae=(()=>{class r{constructor(i,p,U,Z,W,w,J){this.sideMenuService=i,this.usersService=p,this.sideMenuItemService=U,this.route=Z,this.dialog=W,this.authResolver=w,this.entityStorageService=J,this.loading=!1}ngOnInit(){this.loading=!0,this.route.params.subscribe(i=>{const p=Number(i.userId);this.entityStorageService.setEntity({id:p,beanName:"User"}),this.usersService.getUserById(p).subscribe(U=>{this.user=U;const Z=this.sideMenuItemService.parseServiceIdentity(U);this.sideMenuService.setUserItems([Z]),this.loading=!1},()=>this.loading=!1)})}getUserType(){return this.user.serviceUser?"Service":"Person"}editUser(){const i=(0,b.kZ)();i.width="450px",i.data={theme:"admin-theme",user:this.user},this.dialog.open(ee.x,i).afterClosed().subscribe(U=>{U&&this.usersService.getUserById(this.user.id).subscribe(Z=>{this.user=Z})})}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(h.D),e.Y36(n.Fv),e.Y36(q.V),e.Y36(l.gz),e.Y36(K.uw),e.Y36(c.x4),e.Y36(c.fb))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-detail-page"]],decls:1,vars:1,consts:[["class","container-fluid pl-xl-5 pr-xl-5 user-theme",4,"ngIf"],[1,"container-fluid","pl-xl-5","pr-xl-5","user-theme"],["class","mr-auto ml-auto",4,"ngIf"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-service-identity",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],["queryParamsHandling","merge",1,"user-link",3,"routerLink"],[1,"text-muted"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"mt-1","entity-info"],[1,"mr-auto","ml-auto"],["mat-icon-button","",3,"click"]],template:function(i,p){1&i&&e.YNc(0,re,22,25,"div",0),2&i&&e.Q6J("ngIf",void 0!==p.user)},dependencies:[O.O5,O.PC,l.yS,T.Hw,G.lW,M.Ou,y.gM,B.W,S.A,m.X$,F.d]}),r})(),oe=(()=>{class r{constructor(){this.navItems=[]}ngOnInit(){this.initNavItems()}initNavItems(){this.navItems=[{cssIcon:"perun-manager",url:"associated-users",label:"MENU_ITEMS.USER.ASSOCIATED_USERS",style:"user-btn"},{cssIcon:"perun-notification",url:"mailing-lists",label:"MENU_ITEMS.USER.MAILING_LISTS",style:"user-btn"},{cssIcon:"perun-statistics",url:"data-quotas",label:"MENU_ITEMS.USER.DATA_QUOTAS",style:"user-btn"},{cssIcon:"perun-authentication",url:"authentication",label:"MENU_ITEMS.USER.AUTHENTICATION",style:"user-btn"}]}}return r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-overview"]],decls:1,vars:2,consts:[[3,"items","size"]],template:function(i,p){1&i&&e._UZ(0,"perun-web-apps-menu-buttons-field",0),2&i&&e.Q6J("items",p.navItems)("size","small")},dependencies:[g.L]}),r})();var le=s(46597),_e=s(74006);let ce=(()=>{class r{constructor(i){this.entityStorageService=i}ngOnInit(){this.user=this.entityStorageService.getEntity()}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(c.fb))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-user-settings-mailing-lists"]],decls:1,vars:2,consts:[[3,"user","isService"]],template:function(i,p){1&i&&e._UZ(0,"perun-web-apps-mailing-lists",0),2&i&&e.Q6J("user",p.user)("isService",!0)},dependencies:[_e.E]}),r})();var ue=s(2541);let pe=(()=>{class r{constructor(i){this.entityStorageService=i}ngOnInit(){this.user=this.entityStorageService.getEntity()}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(c.fb))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-user-settings-data-quotas"]],decls:1,vars:1,consts:[[3,"user"]],template:function(i,p){1&i&&e._UZ(0,"perun-web-apps-data-quotas",0),2&i&&e.Q6J("user",p.user)},dependencies:[ue.m]}),r})(),de=(()=>{class r{constructor(){this.navItems=[]}ngOnInit(){this.initNavItems()}initNavItems(){this.navItems=[{cssIcon:"perun-logins",url:"logins",label:"MENU_ITEMS.USER.LOGINS",style:"user-btn"},{cssIcon:"perun-certificates",url:"certificates",label:"MENU_ITEMS.USER.CERTIFICATES",style:"user-btn"},{cssIcon:"perun-key",url:"ssh-keys",label:"MENU_ITEMS.USER.SSH_KEYS",style:"user-btn"}]}}return r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-authentication-overview"]],decls:1,vars:2,consts:[[3,"items","size"]],template:function(i,p){1&i&&e._UZ(0,"perun-web-apps-menu-buttons-field",0),2&i&&e.Q6J("items",p.navItems)("size","small")},dependencies:[g.L]}),r})();var Y=s(24006),me=s(28499),ge=s(95406);function he(r,f){if(1&r&&(e.TgZ(0,"div",7),e._UZ(1,"app-login-password-form-with-generate-option",8),e.qZA()),2&r){const i=e.oxw();e.xp6(1),e.Q6J("formGroup",i.formGroup)("filteredNamespace",i.data.filteredNamespaces)}}function fe(r,f){1&r&&e._UZ(0,"mat-spinner",9)}let Ee=(()=>{class r{constructor(i,p,U,Z,W,w,J,ot,lt,_t){this.dialogRef=i,this.data=p,this.formBuilder=U,this.usersManagerService=Z,this.membersManagerService=W,this.attributesManagerService=w,this.apiRequestConfiguration=J,this.notificator=ot,this.translate=lt,this.cd=_t,this.processing=!1}ngOnInit(){this.userId=this.data.userId,this.formGroup=this.formBuilder.group({namespaceCtrl:["Not selected"],loginCtrl:["",[Y.kI.pattern("^[a-z][a-z0-9_-]+$"),Y.kI.maxLength(15),Y.kI.minLength(2)]],passwordCtrl:["",Y.kI.required,[(0,me.yT)(null,this.usersManagerService,this.apiRequestConfiguration)]],passwordAgainCtrl:[""],generatePasswordCtrl:[!0]},{validators:b.dN.passwordMatchValidator})}ngAfterViewInit(){this.cd.detectChanges()}onSetLogin(){this.processing=!0;const i=this.formGroup.get("namespaceCtrl").value.toLowerCase(),p=this.formGroup.get("loginCtrl").value;if(p)this.setLogin(i,p);else{const U=`urn:perun:user:attribute-def:def:login-namespace:${i}`;this.attributesManagerService.getUserAttributeByName(this.userId,"urn:perun:user:attribute-def:core:lastName").subscribe(Z=>{this.usersManagerService.generateAccountForName(i,Z.value).subscribe(w=>{this.setLogin(i,w[U])},()=>this.processing=!1)})}}setLogin(i,p){this.usersManagerService.setLogin(this.userId,p,i).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.SET_LOGIN.SUCCESS_LOGIN")),this.setPassword()},()=>{this.processing=!1})}setPassword(){const i=this.formGroup.get("namespaceCtrl").value.toLowerCase(),p=this.formGroup.get("passwordCtrl").value;if(this.formGroup.get("generatePasswordCtrl").value){if(!this.formGroup.get("loginCtrl").value)return;this.usersManagerService.reserveRandomPassword(this.userId,i).subscribe(()=>{this.usersManagerService.validatePasswordForUser(this.userId,i).subscribe(()=>{this.dialogRef.close(!0)},()=>{this.processing=!1})},()=>{this.processing=!1})}else this.usersManagerService.reservePasswordForUser({user:this.userId,namespace:i,password:p}).subscribe(()=>{this.usersManagerService.validatePasswordForUser(this.userId,i).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.SET_LOGIN.SUCCESS_PASSWORD")),this.dialogRef.close(!0)},()=>{this.processing=!1})},()=>{this.processing=!1})}onCancel(){this.dialogRef.close(!1)}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(K.so),e.Y36(K.WI),e.Y36(Y.QS),e.Y36(n.Fv),e.Y36(n.uq),e.Y36(n.H8),e.Y36(c.F5),e.Y36(c.V6),e.Y36(m.sK),e.Y36(e.sBO))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-set-login-dialog"]],decls:13,vars:12,consts:[[1,"vo-theme"],[1,"mat-dialog-title"],["class","dialog-container","mat-dialog-content","",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],["mat-dialog-content","",1,"dialog-container"],[3,"formGroup","filteredNamespace"],[1,"ml-auto","mr-auto"]],template:function(i,p){1&i&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,he,2,2,"div",2),e.YNc(5,fe,1,0,"mat-spinner",3),e.TgZ(6,"div",4)(7,"button",5),e.NdJ("click",function(){return p.onCancel()}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",6),e.NdJ("click",function(){return p.onSetLogin()}),e._uU(11),e.ALo(12,"translate"),e.qZA()()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,6,"DIALOGS.SET_LOGIN.TITLE")),e.xp6(2),e.Q6J("ngIf",!p.processing),e.xp6(1),e.Q6J("ngIf",p.processing),e.xp6(3),e.hij(" ",e.lcZ(9,8,"DIALOGS.SET_LOGIN.CANCEL")," "),e.xp6(2),e.Q6J("disabled","Not selected"===p.formGroup.get("namespaceCtrl").value||p.formGroup.invalid||p.formGroup.pending||p.processing),e.xp6(1),e.hij(" ",e.lcZ(12,10,"DIALOGS.SET_LOGIN.SET_LOGIN")," "))},dependencies:[O.O5,Y.JL,Y.sg,G.lW,K.xY,K.H8,M.Ou,ge.r,m.X$]}),r})();var z=s(96214),Ie=s(53599);const Te=["logins"];let ve=(()=>{class r{constructor(i,p){this.dialog=i,this.entityStorageService=p,this.filteredNamespaces=[]}ngOnInit(){this.userId=this.entityStorageService.getEntity().id}onAdd(){const i=(0,b.kZ)();i.width="500px",i.data={userId:this.userId,filteredNamespaces:this.filteredNamespaces},this.dialog.open(Ee,i).afterClosed().subscribe(U=>{U&&this.logins.refreshTable()})}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(K.uw),e.Y36(c.fb))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-user-settings-logins"]],viewQuery:function(i,p){if(1&i&&e.Gf(Te,5),2&i){let U;e.iGM(U=e.CRH())&&(p.logins=U.first)}},decls:9,vars:7,consts:[[1,"page-title"],[3,"refresh"],["color","accent","mat-flat-button","",1,"mr-2","action-button",3,"click"],[3,"authenticationPage","filteredNamespaces"],["logins",""]],template:function(i,p){if(1&i){const U=e.EpF();e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){e.CHM(U);const W=e.MAs(8);return e.KtG(W.refreshTable())}),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return p.onAdd()}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"perun-web-apps-password-reset",3,4),e.NdJ("filteredNamespaces",function(W){return p.filteredNamespaces=W}),e.qZA()}2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,3,"USER_DETAIL.SETTINGS.LOGINS.TITLE")),e.xp6(4),e.hij(" ",e.lcZ(6,5,"USER_DETAIL.SETTINGS.LOGINS.ADD"),"\n"),e.xp6(2),e.Q6J("authenticationPage",!0))},dependencies:[G.lW,z.t,Ie.N,m.X$]}),r})(),Ue=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-authentication"]],hostVars:2,hostBindings:function(i,p){2&i&&e.ekj("router-component",p.true)},decls:1,vars:0,template:function(i,p){1&i&&e._UZ(0,"app-animated-router-outlet")},dependencies:[S.A]}),r})();var Se=s(64080),Ce=s(95017),Ae=s(36792),De=s(53984);const Oe=["list"];function be(r,f){1&r&&e._UZ(0,"mat-spinner",5)}const Me=function(r){return[r]};function Re(r,f){if(1&r&&e._UZ(0,"perun-web-apps-attributes-list",6,7),2&r){const i=e.oxw();e.Q6J("attributes",e.VKq(2,Me,i.certificates))("selection",i.selection)}}const Pe=[{path:"",component:X,children:[{path:"",component:a.Z,data:{animation:"UserOverviewPage"}},{path:"attributes",component:L.u,data:{animation:"UserAttributesPage"}},{path:"organizations",component:R.j,data:{animation:"UserOrganizationsPage",showPrincipal:!0}},{path:"groups",component:t.u,data:{animation:"UserGroupsPage",showPrincipal:!0}},{path:"roles",component:$.t,data:{animation:"UserRolesPage"}},{path:"service-identities",component:k.R,data:{animation:"UserServiceIdentities"}},{path:"settings",component:u,children:[{path:"",component:A,data:{animation:"UserSettingsOverviewPage"}},{path:"passwordReset",component:v.Nj,data:{animation:"PasswordResetPage"}},{path:"guiConfig",component:o,data:{animation:"UserAppConfigurationPage"}}]}]},{path:"service-identities/:userId",component:ae,children:[{path:"",component:oe},{path:"associated-users",component:le.d},{path:"authentication",component:Ue,children:[{path:"",component:de},{path:"logins",component:ve},{path:"certificates",component:(()=>{class r{constructor(i,p,U){this.entityStorageService=i,this.attributesManagerService=p,this.dialog=U,this.selection=new Ce.Ov(!0,[])}ngOnInit(){this.userId=this.entityStorageService.getEntity().id,this.refresh()}refresh(){this.loading=!0,this.attributesManagerService.getUserAttributeByName(this.userId,Se.r.USER_DEF_CERTIFICATES).subscribe(i=>{this.certificates=i,this.selection.clear(),this.loading=!1})}save(){this.list.updateMapAttributes();const i=(0,b.kZ)();i.width="450px",i.data={entityId:this.userId,entity:"user",attributes:this.selection.selected},this.dialog.open(Ae.wA,i).afterClosed().subscribe(U=>{U&&this.refresh()})}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(c.fb),e.Y36(n.H8),e.Y36(K.uw))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-certificates"]],viewQuery:function(i,p){if(1&i&&e.Gf(Oe,5),2&i){let U;e.iGM(U=e.CRH())&&(p.list=U.first)}},decls:9,vars:9,consts:[[1,"page-title"],[1,"mt-2",3,"refresh"],["color","accent","mat-flat-button","",1,"mr-2","mt-2",3,"disabled","click"],["class","ml-auto mr-auto",4,"ngIf"],[3,"attributes","selection",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"attributes","selection"],["list",""]],template:function(i,p){1&i&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){return p.refresh()}),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return p.save()}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.YNc(7,be,1,0,"mat-spinner",3),e.YNc(8,Re,2,4,"perun-web-apps-attributes-list",4)),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,5,"USER_DETAIL.SETTINGS.CERTIFICATES.TITLE")),e.xp6(3),e.Q6J("disabled",0===p.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(6,7,"USER_DETAIL.SETTINGS.CERTIFICATES.SAVE"),"\n"),e.xp6(2),e.Q6J("ngIf",p.loading),e.xp6(1),e.Q6J("ngIf",!p.loading))},dependencies:[O.O5,G.lW,M.Ou,z.t,De.p,m.X$]}),r})()},{path:"ssh-keys",component:v.N7}]},{path:"mailing-lists",component:ce},{path:"data-quotas",component:pe}]}];let Ne=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[l.Bz.forChild(Pe),l.Bz]}),r})();var ye=s(47957),Ze=s(284),xe=s(23267),Be=s(37084),Ye=s(96308),We=s(30671),Ke=s(3848),Ge=s(35423),we=s(56709),Je=s(17009),Fe=s(73162),Qe=s(90455),ze=s(99602),je=s(71948),He=s(44850),Ve=s(98739),j=s(73546),Xe=s(86257),$e=s(73555),ke=s(77331),qe=s(28255),et=s(67376),tt=s(63189),st=s(42673),nt=s(11243),it=s(19516),rt=s(14264);let at=(()=>{class r{constructor(i){this.translate=i,i.addLangs(["en","cs"])}}return r.\u0275fac=function(i){return new(i||r)(e.LFG(m.sK))},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[O.ez,Ne,ye.Bb,Ze.c,D.lN,Y.UX,Y.u5,T.Ps,xe.SJ,Be.To,m.aw.forChild({}),G.ot,Ye.JX,We.p0,Ke.Nh,Ge.dp,G.ot,we.p9,K.Is,d.LD,Je.ZX,M.Cq,Fe.Cv,y.AV,Qe.rP,ze.FA,I.XK,je.Fk,He.t,I.si,Ve.TU,j.QW,Xe.T5,$e._t,j.QW,ke.Hi,qe.Tx,et.Cl,tt.r,st.g,v.ez,nt.r,it.d4,rt.m]}),r})()}}]);