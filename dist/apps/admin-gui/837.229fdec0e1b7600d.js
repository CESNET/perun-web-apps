"use strict";(self.webpackChunkadmin_gui=self.webpackChunkadmin_gui||[]).push([[837],{80992:(G,W,s)=>{s.d(W,{l:()=>g});var U=s(17700),c=s(87824),p=s(73615),m=s(38106),t=s(78337),e=s(1385),n=s(56223),i=s(65879),C=s(71365),h=s(96814),Z=s(24516),M=s(64170),D=s(30617),x=s(32296),E=s(11186),R=s(55959),I=s(12207),v=s(69755),L=s(16921);function N(_,u){1&_&&i._UZ(0,"perun-web-apps-loading-dialog")}function A(_,u){1&_&&i._UZ(0,"perun-web-apps-loading-table")}function O(_,u){if(1&_&&(i._UZ(0,"app-users-list",16),i.ALo(1,"translate")),2&_){const d=i.oxw(3);i.Q6J("displayedColumns",d.displayedColumns)("selection",d.selection)("tableId",d.tableId)("disableRouting",!0)("users",d.identities)("noUsersFoundLabel",i.lcZ(1,6,"DIALOGS.CONNECT_IDENTITY.NO_IDENTITIES"))}}function P(_,u){if(1&_&&(i.TgZ(0,"div",14),i.YNc(1,O,2,8,"app-users-list",15),i.qZA()),2&_){i.oxw();const d=i.MAs(18),T=i.oxw();i.xp6(1),i.Q6J("perunWebAppsLoader",T.loading)("perunWebAppsLoaderIndicator",d)}}function S(_,u){1&_&&(i.TgZ(0,"perun-web-apps-alert",17),i._uU(1),i.ALo(2,"translate"),i.qZA()),2&_&&(i.xp6(1),i.hij(" ",i.lcZ(2,1,"DIALOGS.CONNECT_IDENTITY.SEARCH_HINT")," "))}function f(_,u){if(1&_){const d=i.EpF();i.TgZ(0,"div")(1,"div",2),i.NdJ("keyup",function(y){i.CHM(d);const w=i.oxw();return i.KtG(w.onKeyInput(y))}),i.TgZ(2,"h1",3),i._uU(3),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),i._uU(8),i.ALo(9,"translate"),i.qZA(),i._UZ(10,"input",6),i.TgZ(11,"mat-error"),i._uU(12),i.ALo(13,"translate"),i.qZA()(),i.TgZ(14,"button",7),i.NdJ("click",function(){i.CHM(d);const y=i.oxw();return i.KtG(y.onSearchByString())}),i.TgZ(15,"mat-icon"),i._uU(16,"search"),i.qZA()(),i.YNc(17,A,1,0,"ng-template",null,8,i.W1O),i.YNc(19,P,2,2,"div",9),i.YNc(20,S,3,3,"perun-web-apps-alert",10),i.qZA(),i.TgZ(21,"div",11)(22,"button",12),i.NdJ("click",function(){i.CHM(d);const y=i.oxw();return i.KtG(y.onCancel())}),i._uU(23),i.ALo(24,"translate"),i.qZA(),i.TgZ(25,"button",13),i.NdJ("click",function(){i.CHM(d);const y=i.oxw();return i.KtG(y.onAdd())}),i._uU(26),i.ALo(27,"translate"),i.qZA()()()()}if(2&_){const d=i.oxw();i.xp6(1),i.Tol(d.theme),i.xp6(2),i.Oqu(i.lcZ(4,13,"DIALOGS.CONNECT_IDENTITY.TITLE_"+d.target)),i.xp6(5),i.Oqu(i.lcZ(9,15,"DIALOGS.CONNECT_IDENTITY.SEARCH")),i.xp6(2),i.Q6J("formControl",d.searchCtrl),i.xp6(2),i.hij(" ",i.lcZ(13,17,"DIALOGS.CONNECT_IDENTITY.EMPTY_SEARCH_MESSAGE")," "),i.xp6(2),i.Q6J("disabled",d.loading),i.xp6(5),i.Q6J("ngIf",d.firstSearchDone),i.xp6(1),i.Q6J("ngIf",!d.firstSearchDone),i.xp6(3),i.hij(" ",i.lcZ(24,19,"DIALOGS.CONNECT_IDENTITY.CANCEL")," "),i.xp6(2),i.Q6J("disabled",0===d.selection.selected.length),i.xp6(1),i.hij(" ",i.lcZ(27,21,"DIALOGS.CONNECT_IDENTITY.CONNECT")," ")}}let g=(()=>{class _{constructor(d,T,y,w,j,z){this.dialogRef=d,this.data=T,this.userManager=y,this.storeService=w,this.notificator=j,this.translate=z,this.loading=!1,this.finalLoading=!1,this.identities=[],this.selection=new t.Ov(!1,[]),this.firstSearchDone=!1,this.displayedColumns=["select","id","user","name","email","logins","organization"],this.tableId=m.Iz}ngOnInit(){this.target=this.data.target,this.theme=this.data.theme,this.userId=this.data.userId,this.isService=this.data.isService,this.searchCtrl=new n.p4("",[n.kI.required,n.kI.pattern(".*[\\S]+.*")])}onAdd(){let d,T;this.finalLoading=!0,this.isService?(d=this.selection.selected[0].id,T=this.userId):(d=this.userId,T=this.selection.selected[0].id),this.userManager.addSpecificUserOwner(d,T).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.CONNECT_IDENTITY.SUCCESS")),this.dialogRef.close(!0)},error:()=>this.finalLoading=!1})}onCancel(){this.dialogRef.close(!1)}onSearchByString(){if(this.searchCtrl.invalid)return void this.searchCtrl.markAllAsTouched();this.loading=!0,this.firstSearchDone=!0;let d=[e.r.USER_DEF_ORGANIZATION,e.r.USER_DEF_PREFERRED_MAIL];d=d.concat(this.storeService.getLoginAttributeNames()),this.userManager.findRichUsersWithAttributes(this.searchCtrl.value,d).subscribe(T=>{this.identities=this.filterIdentities(T),this.loading=!1},()=>{this.loading=!1})}onKeyInput(d){"Enter"===d.key&&this.onSearchByString()}filterIdentities(d){return d.filter(this.isService?T=>!T.serviceUser:T=>T.serviceUser)}static#e=this.\u0275fac=function(T){return new(T||_)(i.Y36(U.so),i.Y36(U.WI),i.Y36(c.Fv),i.Y36(p.d6),i.Y36(p.V6),i.Y36(C.sK))};static#t=this.\u0275cmp=i.Xpm({type:_,selectors:[["app-connect-identity-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"keyup"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],[1,"me-2","search-field","no-border-mat-input"],["matInput","","autocomplete","false",3,"formControl"],["color","primary","mat-flat-button","",1,"me-2","search-btn",3,"disabled","click"],["searchSpinner",""],["class","position-relative",4,"ngIf"],["alert_type","info",4,"ngIf"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"disabled","click"],[1,"position-relative"],[3,"displayedColumns","selection","tableId","disableRouting","users","noUsersFoundLabel",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"displayedColumns","selection","tableId","disableRouting","users","noUsersFoundLabel"],["alert_type","info"]],template:function(T,y){if(1&T&&(i.YNc(0,N,1,0,"ng-template",null,0,i.W1O),i.TgZ(2,"div"),i.YNc(3,f,28,23,"div",1),i.qZA()),2&T){const w=i.MAs(1);i.xp6(2),i.Gre("",y.theme," position-relative"),i.xp6(1),i.Q6J("perunWebAppsLoader",y.finalLoading)("perunWebAppsLoaderIndicator",w)}},dependencies:[h.O5,Z.Nt,M.KE,M.hX,M.TO,n.Fj,n.JJ,n.oH,D.Hw,x.lW,U.uh,U.xY,U.H8,E.w,R.K,I.b,v.e,L.C,C.X$],styles:[".search-field[_ngcontent-%COMP%]{width:300px}.search-btn[_ngcontent-%COMP%]{width:50px}"]})}return _})()},88885:(G,W,s)=>{s.d(W,{B:()=>I});var U=s(87824),c=s(17700),p=s(73615),m=s(25313),t=s(65879),e=s(71365),n=s(96814),i=s(32296),C=s(11186),h=s(37803);function Z(v,L){1&v&&t._UZ(0,"th",13)}function M(v,L){if(1&v&&(t.TgZ(0,"td",14),t._uU(1),t.ALo(2,"userFullName"),t.qZA()),2&v){const N=L.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,N))}}function D(v,L){1&v&&t._UZ(0,"tr",15)}function x(v,L){1&v&&t._UZ(0,"tr",16)}function E(v,L){1&v&&(t.TgZ(0,"perun-web-apps-alert",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&v&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"DIALOGS.DISCONNECT_IDENTITY.WARNING_DISCONNECT_YOURSELF")," "))}function R(v,L){1&v&&(t.TgZ(0,"perun-web-apps-alert",17),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&v&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"DIALOGS.DISCONNECT_IDENTITY.WARNING_LAST_USER")," "))}let I=(()=>{class v{constructor(N,A,O,P,S,f){this.dialogRef=N,this.data=A,this.userManager=O,this.notificator=P,this.translate=S,this.store=f,this.displayedColumns=["name"]}ngOnInit(){let N;this.targetTitle=this.data.targetTitle,this.targetDescription=this.data.targetDescription,this.theme=this.data.theme,this.userId=Number(this.data.userId),this.dataSource=new m.by([this.data.specificUser]),this.isService=this.data.isService,this.isService?(N=this.userId,this.disconnectingSelf=this.dataSource.data[0].id===this.store.getPerunPrincipal().userId):(N=this.dataSource.data[0].id,this.disconnectingSelf=this.userId===this.store.getPerunPrincipal().userId),this.userManager.getUsersBySpecificUser(N).subscribe(A=>{this.disconnectingLastOwner=1===A.length})}onConfirm(){let N,A;this.isService?(N=this.dataSource.data[0].id,A=this.userId):(N=this.userId,A=this.dataSource.data[0].id),this.userManager.removeSpecificUserOwner(N,A).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.DISCONNECT_IDENTITY.SUCCESS")),this.dialogRef.close(!0)})}onCancel(){this.dialogRef.close(!1)}static#e=this.\u0275fac=function(A){return new(A||v)(t.Y36(c.so),t.Y36(c.WI),t.Y36(U.Fv),t.Y36(p.V6),t.Y36(e.sK),t.Y36(p.d6))};static#t=this.\u0275cmp=t.Xpm({type:v,selectors:[["app-disconnect-identity-dialog"]],decls:26,vars:23,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","fw-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"fw-bolder"],["mat-row",""],["alert_type","warn"]],template:function(A,O){1&A&&(t.TgZ(0,"h1",0),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.TgZ(3,"div")(4,"div",1)(5,"p"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"div",2),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"table",3),t.ynx(12,4),t.YNc(13,Z,1,0,"th",5),t.YNc(14,M,3,3,"td",6),t.BQk(),t.YNc(15,D,1,0,"tr",7),t.YNc(16,x,1,0,"tr",8),t.qZA(),t.YNc(17,E,3,3,"perun-web-apps-alert",9),t.YNc(18,R,3,3,"perun-web-apps-alert",9),t.qZA(),t.TgZ(19,"div",10)(20,"button",11),t.NdJ("click",function(){return O.onCancel()}),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"button",12),t.NdJ("click",function(){return O.onConfirm()}),t._uU(24),t.ALo(25,"translate"),t.qZA()()()),2&A&&(t.xp6(1),t.Oqu(t.lcZ(2,13,"DIALOGS.DISCONNECT_IDENTITY.TITLE_"+O.targetTitle)),t.xp6(2),t.Tol(O.theme),t.xp6(3),t.Oqu(t.lcZ(7,15,"DIALOGS.DISCONNECT_IDENTITY.DESCRIPTION_"+O.targetDescription)),t.xp6(3),t.hij(" ",t.lcZ(10,17,"DIALOGS.DISCONNECT_IDENTITY.ASK")," "),t.xp6(2),t.Q6J("dataSource",O.dataSource),t.xp6(4),t.Q6J("matHeaderRowDef",O.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",O.displayedColumns),t.xp6(1),t.Q6J("ngIf",O.disconnectingSelf),t.xp6(1),t.Q6J("ngIf",O.disconnectingLastOwner),t.xp6(3),t.hij(" ",t.lcZ(22,19,"DIALOGS.DISCONNECT_IDENTITY.CANCEL")," "),t.xp6(3),t.hij(" ",t.lcZ(25,21,"DIALOGS.DISCONNECT_IDENTITY.REMOVE")," "))},dependencies:[n.O5,i.lW,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,c.uh,c.xY,c.H8,C.w,e.X$,h.d]})}return v})()},13350:(G,W,s)=>{s.d(W,{x:()=>R});var U=s(87824),c=s(17700),p=s(73615),m=s(56223),t=s(65879),e=s(71365),n=s(96814),i=s(24516),C=s(64170),h=s(32296);function Z(I,v){1&I&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&I&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LENGTH")))}function M(I,v){1&I&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&I&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LENGTH")))}function D(I,v){1&I&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&I&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_FIRST_NAME")))}function x(I,v){1&I&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&I&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LENGTH")))}function E(I,v){1&I&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&I&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LAST_NAME")))}let R=(()=>{class I{constructor(L,N,A,O,P){this.dialogRef=L,this.data=N,this.userService=A,this.notificator=O,this.translateService=P,this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.titleBefore=new m.p4(this.data.user.titleBefore,[m.kI.pattern(".*[\\S]+.*"),m.kI.maxLength(129)]),this.titleAfter=new m.p4(this.data.user.titleAfter,[m.kI.pattern(".*[\\S]+.*"),m.kI.maxLength(129)]),this.firstName=new m.p4(this.data.user.firstName,[m.kI.required,m.kI.pattern(".*[\\S]+.*"),m.kI.maxLength(129)]),this.middleName=new m.p4(this.data.user.middleName,[m.kI.pattern(".*[\\S]+.*"),m.kI.maxLength(129)]),this.lastName=new m.p4(this.data.user.lastName,[m.kI.required,m.kI.pattern(".*[\\S]+.*"),m.kI.maxLength(129)])}onCancel(){this.dialogRef.close(!1)}onSave(){this.loading=!0,this.data.user.titleBefore=this.titleBefore.value,this.data.user.titleAfter=this.titleAfter.value,this.data.user.firstName=this.firstName.value,this.data.user.middleName=this.middleName.value,this.data.user.lastName=this.lastName.value,this.userService.updateUser({user:this.data.user}).subscribe(()=>{this.translateService.get("DIALOGS.EDIT_USER.SUCCESS").subscribe(L=>{this.notificator.showSuccess(L),this.dialogRef.close(!0)})},()=>this.loading=!1)}static#e=this.\u0275fac=function(N){return new(N||I)(t.Y36(c.so),t.Y36(c.WI),t.Y36(U.Fv),t.Y36(p.V6),t.Y36(e.sK))};static#t=this.\u0275cmp=t.Xpm({type:I,selectors:[["app-edit-user-dialog"]],decls:42,vars:38,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],["matInput","",3,"formControl"],[4,"ngIf"],["matInput","","data-cy","user-first-name-input","required","",3,"formControl"],["matInput","","required","",3,"formControl"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","data-cy","user-save-button","mat-flat-button","",1,"ms-2",3,"disabled","click"]],template:function(N,A){1&N&&(t.TgZ(0,"div")(1,"h1",0),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",1)(5,"mat-form-field")(6,"mat-label"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t._UZ(9,"input",2),t.YNc(10,Z,3,3,"mat-error",3),t.qZA(),t.TgZ(11,"mat-form-field")(12,"mat-label"),t._uU(13),t.ALo(14,"translate"),t.qZA(),t._UZ(15,"input",2),t.YNc(16,M,3,3,"mat-error",3),t.qZA(),t.TgZ(17,"mat-form-field")(18,"mat-label"),t._uU(19),t.ALo(20,"translate"),t.qZA(),t._UZ(21,"input",4),t.YNc(22,D,3,3,"mat-error",3),t.qZA(),t.TgZ(23,"mat-form-field")(24,"mat-label"),t._uU(25),t.ALo(26,"translate"),t.qZA(),t._UZ(27,"input",2),t.YNc(28,x,3,3,"mat-error",3),t.qZA(),t.TgZ(29,"mat-form-field")(30,"mat-label"),t._uU(31),t.ALo(32,"translate"),t.qZA(),t._UZ(33,"input",5),t.YNc(34,E,3,3,"mat-error",3),t.qZA()(),t.TgZ(35,"div",6)(36,"button",7),t.NdJ("click",function(){return A.onCancel()}),t._uU(37),t.ALo(38,"translate"),t.qZA(),t.TgZ(39,"button",8),t.NdJ("click",function(){return A.onSave()}),t._uU(40),t.ALo(41,"translate"),t.qZA()()()),2&N&&(t.Tol(A.theme),t.xp6(2),t.Oqu(t.lcZ(3,22,"DIALOGS.EDIT_USER.DIALOG_TITLE")),t.xp6(5),t.Oqu(t.lcZ(8,24,"DIALOGS.EDIT_USER.TITLE_BEFORE")),t.xp6(2),t.Q6J("formControl",A.titleBefore),t.xp6(1),t.Q6J("ngIf",A.titleBefore.invalid),t.xp6(3),t.Oqu(t.lcZ(14,26,"DIALOGS.EDIT_USER.TITLE_AFTER")),t.xp6(2),t.Q6J("formControl",A.titleAfter),t.xp6(1),t.Q6J("ngIf",A.titleAfter.invalid),t.xp6(3),t.Oqu(t.lcZ(20,28,"DIALOGS.EDIT_USER.FIRST_NAME")),t.xp6(2),t.Q6J("formControl",A.firstName),t.xp6(1),t.Q6J("ngIf",A.firstName.invalid),t.xp6(3),t.Oqu(t.lcZ(26,30,"DIALOGS.EDIT_USER.MIDDLE_NAME")),t.xp6(2),t.Q6J("formControl",A.middleName),t.xp6(1),t.Q6J("ngIf",A.middleName.invalid),t.xp6(3),t.Oqu(t.lcZ(32,32,"DIALOGS.EDIT_USER.LAST_NAME")),t.xp6(2),t.Q6J("formControl",A.lastName),t.xp6(1),t.Q6J("ngIf",A.lastName.invalid),t.xp6(3),t.hij(" ",t.lcZ(38,34,"DIALOGS.EDIT_USER.CANCEL")," "),t.xp6(2),t.Q6J("disabled",A.loading||A.firstName.invalid||A.lastName.invalid||A.titleBefore.invalid||A.titleAfter.invalid||A.middleName.invalid),t.xp6(1),t.hij(" ",t.lcZ(41,36,"DIALOGS.EDIT_USER.SAVE")," "))},dependencies:[n.O5,i.Nt,C.KE,C.hX,C.TO,m.Fj,m.JJ,m.Q7,m.oH,h.lW,c.uh,c.xY,c.H8,e.X$]})}return I})()},46685:(G,W,s)=>{s.d(W,{G:()=>e});var U=s(17700),c=s(73615),p=s(87824),m=s(65879),t=s(54200);let e=(()=>{class n{constructor(C,h,Z,M){this.data=C,this.dialogRef=h,this.facilityService=Z,this.notificator=M,this.loading=!1}update(C){this.loading=!0,this.facilityService.updateFacilityBan({banOnFacility:{id:this.data.ban.id,beanName:"BanOnFacility",facilityId:this.data.ban.facilityId,userId:this.data.ban.userId,description:C.description,validityTo:C.validity}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.UPDATE_BAN.SUCCESS"),this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}cancel(){this.dialogRef.close(!1)}static#e=this.\u0275fac=function(h){return new(h||n)(m.Y36(U.WI),m.Y36(U.so),m.Y36(p.IQ),m.Y36(c.V6))};static#t=this.\u0275cmp=m.Xpm({type:n,selectors:[["app-update-facility-ban-dialog"]],decls:1,vars:3,consts:[[3,"ban","theme","loading","cancel","update"]],template:function(h,Z){1&h&&(m.TgZ(0,"app-update-ban-dialog",0),m.NdJ("cancel",function(){return Z.cancel()})("update",function(D){return Z.update(D)}),m.qZA()),2&h&&m.Q6J("ban",Z.data.ban)("theme","facility-theme")("loading",Z.loading)},dependencies:[t.l]})}return n})()},98836:(G,W,s)=>{s.d(W,{u:()=>x});var U=s(73615),c=s(65879),p=s(44112),m=s(96814),t=s(74104),e=s(95845),n=s(5786),i=s(71365);function C(E,R){1&E&&(c._uU(0),c.ALo(1,"translate")),2&E&&c.hij(" ",c.lcZ(1,1,"ADMIN_USER.ENTITY")," ")}function h(E,R){if(1&E&&c._UZ(0,"app-one-entity-attribute-page",6),2&E){const I=c.oxw();c.Q6J("entityId",I.userId)("entity","user")}}function Z(E,R){1&E&&(c._uU(0),c.ALo(1,"translate"),c.ALo(2,"translate")),2&E&&c.AsE(" ",c.lcZ(1,2,"ADMIN_USER.ENTITY")," - ",c.lcZ(2,4,"FACILITY_DETAIL.ENTITY")," ")}function M(E,R){if(1&E&&c._UZ(0,"app-two-entity-attribute-page",7),2&E){const I=c.oxw(2);c.Q6J("firstEntity","user")("firstEntityId",I.userId)("secondEntity","facility")}}function D(E,R){1&E&&(c.TgZ(0,"mat-tab"),c.YNc(1,Z,3,6,"ng-template",3),c.YNc(2,M,1,3,"ng-template",4),c.qZA())}let x=(()=>{class E{constructor(I,v,L){this.route=I,this.store=v,this.authResolver=L}ngOnInit(){this.route.parent.params.subscribe(I=>{this.userId=Number(I.userId),this.userId||(this.userId=this.store.getPerunPrincipal().userId),this.userFacilityAttAuth=this.authResolver.isAuthorized("getAssignedFacilities_User_policy",[{id:this.userId,beanName:"User"}])})}static#e=this.\u0275fac=function(v){return new(v||E)(c.Y36(p.gz),c.Y36(U.d6),c.Y36(U.x4))};static#t=this.\u0275cmp=c.Xpm({type:E,selectors:[["app-user-settings-attributes"]],hostVars:2,hostBindings:function(v,L){2&v&&c.ekj("router-component",L.true)},decls:8,vars:4,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false"],[1,"mb-2"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(v,L){1&v&&(c.TgZ(0,"h1",0),c._uU(1),c.ALo(2,"translate"),c.qZA(),c.TgZ(3,"mat-tab-group",1)(4,"mat-tab",2),c.YNc(5,C,2,3,"ng-template",3),c.YNc(6,h,1,2,"ng-template",4),c.qZA(),c.YNc(7,D,3,0,"mat-tab",5),c.qZA()),2&v&&(c.xp6(1),c.Oqu(c.lcZ(2,2,"USER_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),c.xp6(6),c.Q6J("ngIf",L.userFacilityAttAuth))},dependencies:[m.O5,t.Vc,t.uD,t.uX,t.SP,e.Y,n.t,i.X$]})}return E})()},81381:(G,W,s)=>{s.d(W,{Q:()=>f});var U=s(87824),c=s(73615),p=s(64124),m=s(82060),t=s(52260),e=s(46685),n=s(65879),i=s(17700),C=s(74104),h=s(55959),Z=s(2730),M=s(6849),D=s(69755),x=s(71365);function E(g,_){1&g&&(n._uU(0),n.ALo(1,"translate")),2&g&&n.hij(" ",n.lcZ(1,1,"USER_DETAIL.BANS.VO")," ")}function R(g,_){if(1&g){const u=n.EpF();n.TgZ(0,"perun-web-apps-ban-on-entity-list",8),n.NdJ("updateBan",function(T){n.CHM(u);const y=n.oxw(2);return n.KtG(y.updateVoBan(T))}),n.qZA()}if(2&g){const u=n.oxw(2);n.Q6J("bans",u.voBans)("displayedColumns",u.displayedColumns)("filter",u.filter)("updatePolicy","updateBan_BanOnVo_policy")}}function I(g,_){if(1&g){const u=n.EpF();n.TgZ(0,"perun-web-apps-debounce-filter",5),n.NdJ("filter",function(T){n.CHM(u);const y=n.oxw();return n.KtG(y.filter=T)}),n.qZA(),n.TgZ(1,"div",6),n.YNc(2,R,1,4,"perun-web-apps-ban-on-entity-list",7),n.qZA()}if(2&g){const u=n.oxw(),d=n.MAs(14);n.Q6J("placeholder","USER_DETAIL.BANS.FILTER"),n.xp6(2),n.Q6J("perunWebAppsLoader",u.loading)("perunWebAppsLoaderIndicator",d)}}function v(g,_){1&g&&(n._uU(0),n.ALo(1,"translate")),2&g&&n.hij(" ",n.lcZ(1,1,"USER_DETAIL.BANS.RESOURCE")," ")}function L(g,_){if(1&g){const u=n.EpF();n.TgZ(0,"perun-web-apps-ban-on-entity-list",8),n.NdJ("updateBan",function(T){n.CHM(u);const y=n.oxw(2);return n.KtG(y.updateResourceBan(T))}),n.qZA()}if(2&g){const u=n.oxw(2);n.Q6J("bans",u.resourceBans)("displayedColumns",u.displayedColumns)("filter",u.filter)("updatePolicy","updateBan_BanOnResource_policy")}}function N(g,_){if(1&g){const u=n.EpF();n.TgZ(0,"perun-web-apps-debounce-filter",5),n.NdJ("filter",function(T){n.CHM(u);const y=n.oxw();return n.KtG(y.filter=T)}),n.qZA(),n.TgZ(1,"div",6),n.YNc(2,L,1,4,"perun-web-apps-ban-on-entity-list",7),n.qZA()}if(2&g){const u=n.oxw(),d=n.MAs(14);n.Q6J("placeholder","USER_DETAIL.BANS.FILTER"),n.xp6(2),n.Q6J("perunWebAppsLoader",u.loading)("perunWebAppsLoaderIndicator",d)}}function A(g,_){1&g&&(n._uU(0),n.ALo(1,"translate")),2&g&&n.hij(" ",n.lcZ(1,1,"USER_DETAIL.BANS.FACILITY")," ")}function O(g,_){if(1&g){const u=n.EpF();n.TgZ(0,"perun-web-apps-ban-on-entity-list",8),n.NdJ("updateBan",function(T){n.CHM(u);const y=n.oxw(2);return n.KtG(y.updateFacilityBan(T))}),n.qZA()}if(2&g){const u=n.oxw(2);n.Q6J("bans",u.facilityBans)("displayedColumns",u.displayedColumns)("filter",u.filter)("updatePolicy","updateBan_BanOnFacility_policy")}}function P(g,_){if(1&g){const u=n.EpF();n.TgZ(0,"perun-web-apps-debounce-filter",5),n.NdJ("filter",function(T){n.CHM(u);const y=n.oxw();return n.KtG(y.filter=T)}),n.qZA(),n.TgZ(1,"div",6),n.YNc(2,O,1,4,"perun-web-apps-ban-on-entity-list",7),n.qZA()}if(2&g){const u=n.oxw(),d=n.MAs(14);n.Q6J("placeholder","USER_DETAIL.BANS.FILTER"),n.xp6(2),n.Q6J("perunWebAppsLoader",u.loading)("perunWebAppsLoaderIndicator",d)}}function S(g,_){1&g&&n._UZ(0,"perun-web-apps-loading-table")}let f=(()=>{class g{constructor(u,d,T,y,w){this.voService=u,this.resourceService=d,this.facilityService=T,this.entityService=y,this.dialog=w,this.loading=!1,this.voBans=[],this.resourceBans=[],this.facilityBans=[],this.filter="",this.displayedColumns=["banId","targetId","targetName","description","expiration","edit"]}ngOnInit(){this.loading=!0,this.user=this.entityService.getEntity(),this.refreshVoBans()}refreshVoBans(){this.loading=!0,this.voService.getEnrichedVoBansForUser(this.user.id).subscribe({next:u=>{this.voBans=u,this.loading=!1},error:()=>this.loading=!1})}refreshResourceBans(){this.loading=!0,this.resourceService.getEnrichedBansForUser(this.user.id).subscribe({next:u=>{this.resourceBans=u,this.loading=!1},error:()=>this.loading=!1})}refreshFacilityBans(){this.loading=!0,this.facilityService.getEnricheFacilitydBansForUser(this.user.id).subscribe({next:u=>{this.facilityBans=u,this.loading=!1},error:()=>this.loading=!1})}updateVoBan(u){this.dialog.open(m.A,this.getConfig(u)).afterClosed().subscribe(T=>{T&&this.refreshVoBans()})}updateResourceBan(u){this.dialog.open(t.e,this.getConfig(u)).afterClosed().subscribe(T=>{T&&this.refreshResourceBans()})}updateFacilityBan(u){this.dialog.open(e.G,this.getConfig(u)).afterClosed().subscribe(T=>{T&&this.refreshFacilityBans()})}getConfig(u){const d=(0,p.kZ)();return d.width="600px",d.data={ban:u.ban,theme:"user-theme"},d}refresh(u){0===u.index?this.refreshVoBans():1===u.index?this.refreshResourceBans():this.refreshFacilityBans()}static#e=this.\u0275fac=function(d){return new(d||g)(n.Y36(U.YF),n.Y36(U.xk),n.Y36(U.IQ),n.Y36(c.fb),n.Y36(i.uw))};static#t=this.\u0275cmp=n.Xpm({type:g,selectors:[["app-user-bans"]],decls:15,vars:3,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false",1,"mt-3",3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["spinner",""],[1,"mt-2","search-field",3,"placeholder","filter"],[1,"position-relative"],[3,"bans","displayedColumns","filter","updatePolicy","updateBan",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"bans","displayedColumns","filter","updatePolicy","updateBan"]],template:function(d,T){1&d&&(n.TgZ(0,"h1",0),n._uU(1),n.ALo(2,"translate"),n.qZA(),n.TgZ(3,"mat-tab-group",1),n.NdJ("selectedTabChange",function(w){return T.refresh(w)}),n.TgZ(4,"mat-tab"),n.YNc(5,E,2,3,"ng-template",2),n.YNc(6,I,3,3,"ng-template",3),n.qZA(),n.TgZ(7,"mat-tab"),n.YNc(8,v,2,3,"ng-template",2),n.YNc(9,N,3,3,"ng-template",3),n.qZA(),n.TgZ(10,"mat-tab"),n.YNc(11,A,2,3,"ng-template",2),n.YNc(12,P,3,3,"ng-template",3),n.qZA()(),n.YNc(13,S,1,0,"ng-template",null,4,n.W1O)),2&d&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"USER_DETAIL.BANS.TITLE"),"\n"))},dependencies:[C.Vc,C.uD,C.uX,C.SP,h.K,Z.P,M.s,D.e,x.X$]})}return g})()},5824:(G,W,s)=>{s.d(W,{Z:()=>S});var U=s(87824),c=s(25313),p=s(73615),m=s(1385),t=s(64124),e=s(37073),n=s(65879),i=s(44112),C=s(17700),h=s(96814),Z=s(30617),M=s(32296),D=s(92596),x=s(95195),E=s(39518),R=s(19218),I=s(71365);function v(f,g){1&f&&n._UZ(0,"th",13)}function L(f,g){if(1&f&&(n.TgZ(0,"td",14),n._uU(1),n.qZA()),2&f){const _=g.$implicit;n.xp6(1),n.hij("",_.displayName,":")}}function N(f,g){1&f&&n._UZ(0,"th",13)}function A(f,g){if(1&f){const _=n.EpF();n.TgZ(0,"td",15)(1,"div",16),n._uU(2),n.TgZ(3,"button",17),n.NdJ("click",function(){n.CHM(_);const d=n.oxw(2);return n.KtG(d.changeEmail())}),n.ALo(4,"translate"),n.TgZ(5,"mat-icon"),n._uU(6,"edit"),n.qZA()()()()}if(2&f){const _=g.$implicit;n.xp6(2),n.hij(" ",_.value," "),n.xp6(1),n.s9C("matTooltip",n.lcZ(4,2,"USER_DETAIL.OVERVIEW.CHANGE_EMAIL"))}}function O(f,g){1&f&&n._UZ(0,"tr",18)}function P(f,g){if(1&f&&(n.TgZ(0,"div",3)(1,"mat-card",4)(2,"mat-card-header")(3,"mat-card-title")(4,"h1",5),n._uU(5),n.ALo(6,"translate"),n.qZA()()(),n.TgZ(7,"mat-card-content")(8,"table",6),n.ynx(9,7),n.YNc(10,v,1,0,"th",8),n.YNc(11,L,2,1,"td",9),n.BQk(),n.ynx(12,10),n.YNc(13,N,1,0,"th",8),n.YNc(14,A,7,4,"td",11),n.BQk(),n.YNc(15,O,1,0,"tr",12),n.qZA()()()()),2&f){const _=n.oxw();n.xp6(5),n.Oqu(n.lcZ(6,3,"USER_DETAIL.OVERVIEW.GENERAL_SETTINGS")),n.xp6(3),n.Q6J("dataSource",_.mailDataSource),n.xp6(7),n.Q6J("matRowDefColumns",_.displayedColumns)}}let S=(()=>{class f{constructor(_,u,d,T,y){this.userService=_,this.attributeService=u,this.storeService=d,this.route=T,this.dialog=y,this.items=[],this.settingsItems=[],this.isServiceUser=!1,this.displayedColumns=["name","value"],this.inMyProfile=!1}ngOnInit(){this.route.params.subscribe(_=>{_.userId?this.userService.getUserById(Number(_.userId)).subscribe(u=>{this.user=u,this.isServiceUser=u.serviceUser,this.setItems(`/admin/users/${this.user.id}`),this.setSettingsItems()}):(this.inMyProfile=!0,this.userID=this.storeService.getPerunPrincipal().user.id,this.attributeService.getUserAttributeByName(this.userID,m.r.USER_DEF_PREFERRED_MAIL).subscribe(u=>{this.preferredMail=u,this.handleMailNotDefined(),this.mailDataSource=new c.by([this.preferredMail]),this.setItems("/myProfile"),this.setSettingsItems()}))})}changeEmail(){const _=(0,t.kZ)();_.width="350px",_.data={userId:this.userID},this.dialog.open(e.gr,_).afterClosed().subscribe(d=>{d&&this.attributeService.getUserAttributeByName(this.userID,m.r.USER_DEF_PREFERRED_MAIL).subscribe(T=>{this.preferredMail=T,this.handleMailNotDefined(),this.mailDataSource=new c.by([this.preferredMail])})})}handleMailNotDefined(){null==this.preferredMail&&(this.preferredMail={id:-1,beanName:"Attribute",displayName:(0,t.Cz)(m.r.USER_DEF_PREFERRED_MAIL.split(":").pop()),value:new Object("-")})}setItems(_){this.items=[],this.inMyProfile?this.items.push({cssIcon:"perun-vo",url:`${_}/organizations`,label:"MENU_ITEMS.ADMIN.ORGANIZATIONS",style:"user-btn"},{cssIcon:"perun-group",url:`${_}/groups`,label:"MENU_ITEMS.ADMIN.GROUPS",style:"user-btn"}):this.items.push({cssIcon:"perun-user",url:`${_}/accounts`,label:"MENU_ITEMS.USER.ACCOUNTS",style:"user-btn"},{cssIcon:"perun-facility-white",url:`${_}/assignments`,label:"MENU_ITEMS.USER.ASSIGNMENTS",style:"user-btn"},{cssIcon:"perun-identity",url:`${_}/identities`,label:"MENU_ITEMS.USER.IDENTITIES",style:"user-btn"}),this.items.push({cssIcon:"perun-attributes",url:`${_}/attributes`,label:"MENU_ITEMS.USER.ATTRIBUTES",style:"user-btn"}),this.items.push({cssIcon:"perun-roles",url:`${_}/roles`,label:"MENU_ITEMS.USER.ROLES",style:"user-btn"}),this.items.push(this.isServiceUser?{cssIcon:"perun-manager",url:`${_}/associated-users`,label:"MENU_ITEMS.USER.ASSOCIATED_USERS",style:"user-btn"}:{cssIcon:"perun-service-identity",url:`${_}/service-identities`,label:"MENU_ITEMS.USER.SERVICE_IDENTITIES",style:"user-btn"}),this.items.push({cssIcon:"perun-ban",url:"bans",label:"MENU_ITEMS.USER.BANS",style:"user-btn"})}setSettingsItems(){this.settingsItems=[],this.inMyProfile&&this.settingsItems.push({cssIcon:"perun-settings2",url:"/myProfile/settings/passwordReset",label:"MENU_ITEMS.USER.PASSWORD_RESET",style:"user-btn"},{cssIcon:"perun-settings1",url:"/myProfile/settings/guiConfig",label:"MENU_ITEMS.USER.GUI_CONFIG",style:"user-btn"})}static#e=this.\u0275fac=function(u){return new(u||f)(n.Y36(U.Fv),n.Y36(U.H8),n.Y36(p.d6),n.Y36(i.gz),n.Y36(C.uw))};static#t=this.\u0275cmp=n.Xpm({type:f,selectors:[["app-user-overview"]],hostVars:2,hostBindings:function(u,d){2&u&&n.ekj("router-component",d.true)},decls:3,vars:5,consts:[["class","align-cards",4,"ngIf"],[3,"items"],[3,"items","title","sectionId"],[1,"align-cards"],["appearance","outlined",1,"card","mat-elevation-z3"],[1,"page-subtitle"],["mat-table","",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["class","fw-bold","mat-cell","",4,"matCellDef"],["matColumnDef","value"],["mat-cell","",4,"matCellDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"fw-bold"],["mat-cell",""],[1,"d-flex","align-items-center"],["mat-icon-button","",1,"ms-3",3,"matTooltip","click"],["mat-row",""]],template:function(u,d){1&u&&(n.YNc(0,P,16,5,"div",0),n._UZ(1,"perun-web-apps-menu-buttons-field",1)(2,"perun-web-apps-expandable-tiles",2)),2&u&&(n.Q6J("ngIf",d.inMyProfile),n.xp6(1),n.Q6J("items",d.items),n.xp6(1),n.Q6J("items",d.settingsItems)("title","MENU_ITEMS.USER.SETTINGS")("sectionId","settings"))},dependencies:[h.O5,Z.Hw,M.RK,c.BZ,c.fO,c.w1,c.Dz,c.nj,c.ge,c.ev,c.Gk,D.gM,x.a8,x.dn,x.dk,x.n5,E.L,R.A,I.X$],styles:[".align-cards[_ngcontent-%COMP%]{margin:1rem 0;display:inline-block;vertical-align:top}"]})}return f})()},47406:(G,W,s)=>{s.d(W,{t:()=>M});var U=s(87824),c=s(73615),p=s(65879),m=s(44112),t=s(74104),e=s(40095),n=s(71365);function i(D,x){1&D&&(p._uU(0),p.ALo(1,"translate")),2&D&&p.hij(" ",p.lcZ(1,1,"USER_DETAIL.DASHBOARD.DIRECT_ROLES")," ")}function C(D,x){if(1&D){const E=p.EpF();p.TgZ(0,"app-perun-web-apps-roles-page",4),p.NdJ("reload",function(){p.CHM(E);const I=p.oxw();return p.KtG(I.getData())})("startLoading",function(){p.CHM(E);const I=p.oxw();return p.KtG(I.outerLoading=!0)}),p.qZA()}if(2&D){const E=p.oxw();p.Q6J("outerLoading",E.outerLoading)("roles",E.roles)("entityId",E.userId)("showDescription",E.showDescription)("entityType",E.entityType)("editable",!0)}}function h(D,x){1&D&&(p._uU(0),p.ALo(1,"translate")),2&D&&p.hij(" ",p.lcZ(1,1,"USER_DETAIL.DASHBOARD.AUTHORIZED_GROUP_BASED_ROLES")," ")}function Z(D,x){if(1&D){const E=p.EpF();p.TgZ(0,"app-perun-web-apps-roles-page",5),p.NdJ("reload",function(){p.CHM(E);const I=p.oxw();return p.KtG(I.getData())})("startLoading",function(){p.CHM(E);const I=p.oxw();return p.KtG(I.outerLoading=!0)}),p.qZA()}if(2&D){const E=p.oxw();p.Q6J("outerLoading",E.outerLoading)("roles",E.indirectRoles)("entityId",E.userId)("showDescription",E.showDescription)("entityType",E.entityType)("editable",!1)("complementaryObjectsWithAuthzGroups",E.rolesComplementaryObjectsWithAuthzGroups)}}let M=(()=>{class D{constructor(E,R,I,v){this.authzResolverService=E,this.route=R,this.store=I,this.roleService=v,this.roles=new Map,this.indirectRoles=new Map,this.rolesComplementaryObjectsWithAuthzGroups=new Map,this.showDescription=!0}ngOnInit(){this.outerLoading=!0,this.route.parent.params.subscribe(E=>{E.userId?(this.entityType="USER",this.userId=Number(E.userId)):(this.userId=this.store.getPerunPrincipal().userId,this.entityType="SELF"),this.getData()})}getData(){this.outerLoading=!0,this.roles.clear(),this.authzResolverService.getUserDirectRoles(this.userId).subscribe({next:E=>{const R=Object.keys(E).map(I=>I.toUpperCase());this.roles=this.roleService.prepareRoles(E,R),this.indirectRoles.clear(),this.authzResolverService.getUserRolesObtainedFromAuthorizedGroupMemberships(this.userId).subscribe({next:I=>{const v=Object.keys(I).map(L=>L.toUpperCase());this.indirectRoles=this.roleService.prepareRoles(I,v),this.rolesComplementaryObjectsWithAuthzGroups.clear(),this.authzResolverService.getRoleComplementaryObjectsWithAuthorizedGroups(this.userId).subscribe({next:L=>{this.rolesComplementaryObjectsWithAuthzGroups=this.roleService.prepareComplementaryObjects(Object.keys(L),L),this.outerLoading=!1},error:()=>this.outerLoading=!1})},error:()=>this.outerLoading=!1})},error:()=>this.outerLoading=!1})}static#e=this.\u0275fac=function(R){return new(R||D)(p.Y36(U.Ct),p.Y36(m.gz),p.Y36(c.d6),p.Y36(c.Nj))};static#t=this.\u0275cmp=p.Xpm({type:D,selectors:[["app-user-roles"]],hostVars:2,hostBindings:function(R,I){2&R&&p.ekj("router-component",I.true)},decls:10,vars:3,consts:[[1,"page-subtitle","d-flex"],["mat-stretch-tabs","false"],["matTabLabel",""],["matTabContent",""],[3,"outerLoading","roles","entityId","showDescription","entityType","editable","reload","startLoading"],[3,"outerLoading","roles","entityId","showDescription","entityType","editable","complementaryObjectsWithAuthzGroups","reload","startLoading"]],template:function(R,I){1&R&&(p.TgZ(0,"h1",0),p._uU(1),p.ALo(2,"translate"),p.qZA(),p.TgZ(3,"mat-tab-group",1)(4,"mat-tab"),p.YNc(5,i,2,3,"ng-template",2),p.YNc(6,C,1,6,"ng-template",3),p.qZA(),p.TgZ(7,"mat-tab"),p.YNc(8,h,2,3,"ng-template",2),p.YNc(9,Z,1,7,"ng-template",3),p.qZA()()),2&R&&(p.xp6(1),p.Oqu(p.lcZ(2,1,"ROLES.TITLE")))},dependencies:[t.Vc,t.uD,t.uX,t.SP,e._,n.X$]})}return D})()},35938:(G,W,s)=>{s.d(W,{d:()=>A});var U=s(38106),c=s(87824),p=s(78337),m=s(64124),t=s(80992),e=s(88885),n=s(73615),i=s(37398),C=s(94664),h=s(65879),Z=s(17700),M=s(44112),D=s(32296),x=s(55959),E=s(62481),R=s(69755),I=s(16921),v=s(71365);function L(O,P){1&O&&h._UZ(0,"perun-web-apps-loading-table")}function N(O,P){if(1&O&&(h._UZ(0,"app-users-list",7),h.ALo(1,"translate")),2&O){const S=h.oxw();h.Q6J("noUsersFoundLabel",h.lcZ(1,6,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.NO_ASSOCIATED_USERS"))("disableRouting",S.disableRouting)("displayedColumns",S.displayedColumns)("selection",S.selection)("tableId",S.tableId)("users",S.associatedUsers)}}let A=(()=>{class O{constructor(S,f,g,_,u){this.dialog=S,this.router=f,this.authResolver=g,this.userManager=_,this.entityStorageService=u,this.loading=!1,this.selection=new p.Ov(!1,[]),this.associatedUsers=[],this.tableId=U.It,this.displayedColumns=["select","id","user","name","email","logins","organization"]}ngOnInit(){this.loading=!0,this.user=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.userManager.getUsersBySpecificUser(this.user.id).pipe((0,i.U)(S=>S.map(f=>f.id)),(0,C.w)(S=>this.userManager.getRichUsersWithAttributesByIds(S))).subscribe(S=>{this.associatedUsers=S,this.selection.clear(),this.setAuth(),this.loading=!1})}setAuth(){this.addAuth=this.authResolver.isAuthorized("addSpecificUserOwner_User_User_policy",[this.user]),this.removeAuth=this.authResolver.isAuthorized("removeSpecificUserOwner_User_User_policy",[this.user]),this.disableRouting=!this.authResolver.isPerunAdminOrObserver()}onAdd(){const S=(0,m.kZ)();S.width="1250px",S.data={userId:this.user.id,theme:"user-theme",isService:!0,target:"USER"},this.dialog.open(t.l,S).afterClosed().subscribe(g=>{g&&this.refreshTable()})}onRemove(){const S=(0,m.kZ)();S.width="650px",S.data={identities:this.selection.selected,userId:this.user.id,specificUser:this.selection.selected[0],isService:!0,theme:"user-theme",targetTitle:"USER",targetDescription:"SERVICE"},this.dialog.open(e.B,S).afterClosed().subscribe(g=>{g&&(this.authResolver.isAuthorized("getUsersBySpecificUser_User_policy",[this.user])?this.refreshTable():this.router.navigate(["/myProfile"],{queryParamsHandling:"preserve"}))})}static#e=this.\u0275fac=function(f){return new(f||O)(h.Y36(Z.uw),h.Y36(M.F0),h.Y36(n.x4),h.Y36(c.Fv),h.Y36(n.fb))};static#t=this.\u0275cmp=h.Xpm({type:O,selectors:[["app-user-settings-associated-users"]],decls:15,vars:12,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],["spinner",""],[1,"position-relative"],[3,"noUsersFoundLabel","disableRouting","displayedColumns","selection","tableId","users",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"noUsersFoundLabel","disableRouting","displayedColumns","selection","tableId","users"]],template:function(f,g){if(1&f&&(h.TgZ(0,"div")(1,"h1",0),h._uU(2),h.ALo(3,"translate"),h.qZA(),h.TgZ(4,"perun-web-apps-refresh-button",1),h.NdJ("refresh",function(){return g.refreshTable()}),h.qZA(),h.TgZ(5,"button",2),h.NdJ("click",function(){return g.onAdd()}),h._uU(6),h.ALo(7,"translate"),h.qZA(),h.TgZ(8,"button",3),h.NdJ("click",function(){return g.onRemove()}),h._uU(9),h.ALo(10,"translate"),h.qZA(),h.YNc(11,L,1,0,"ng-template",null,4,h.W1O),h.TgZ(13,"div",5),h.YNc(14,N,2,8,"app-users-list",6),h.qZA()()),2&f){const _=h.MAs(12);h.xp6(2),h.Oqu(h.lcZ(3,6,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.TITLE")),h.xp6(4),h.hij(" ",h.lcZ(7,8,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.ADD")," "),h.xp6(2),h.Q6J("disabled",0===g.selection.selected.length),h.xp6(1),h.hij(" ",h.lcZ(10,10,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.REMOVE")," "),h.xp6(5),h.Q6J("perunWebAppsLoader",g.loading)("perunWebAppsLoaderIndicator",_)}},dependencies:[D.lW,x.K,E.t,R.e,I.C,v.X$]})}return O})()},99497:(G,W,s)=>{s.d(W,{R:()=>O});var U=s(78337),c=s(87824),p=s(38106),m=s(64124),t=s(80992),e=s(88885),n=s(73615),i=s(65879),C=s(44112),h=s(17700),Z=s(96814),M=s(32296),D=s(55959),x=s(62481),E=s(69755),R=s(16921),I=s(71365);function v(P,S){if(1&P){const f=i.EpF();i.TgZ(0,"button",7),i.NdJ("click",function(){i.CHM(f);const _=i.oxw();return i.KtG(_.onAdd())}),i._uU(1),i.ALo(2,"translate"),i.qZA()}2&P&&(i.xp6(1),i.hij(" ",i.lcZ(2,1,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.CREATE"),"\n"))}function L(P,S){if(1&P){const f=i.EpF();i.TgZ(0,"button",8),i.NdJ("click",function(){i.CHM(f);const _=i.oxw();return i.KtG(_.onRemove())}),i._uU(1),i.ALo(2,"translate"),i.qZA()}if(2&P){const f=i.oxw();i.Q6J("disabled",0===f.selection.selected.length),i.xp6(1),i.hij(" ",i.lcZ(2,2,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.DELETE"),"\n")}}function N(P,S){1&P&&i._UZ(0,"perun-web-apps-loading-table")}function A(P,S){if(1&P&&(i._UZ(0,"app-users-list",9),i.ALo(1,"translate")),2&P){const f=i.oxw();i.Q6J("noUsersFoundLabel",i.lcZ(1,6,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.NO_IDENTITIES"))("displayedColumns",f.displayedColumns)("selection",f.selection)("tableId",f.tableId)("routeToAdmin",f.routeToAdminSection)("users",f.identities)}}let O=(()=>{class P{constructor(f,g,_,u,d,T){this.route=f,this.dialog=g,this.router=_,this.userManager=u,this.authResolver=d,this.store=T,this.loading=!1,this.selection=new U.Ov(!1,[]),this.identities=[],this.tableId=p.Iz,this.displayedColumns=["select","id","user","name"],this.routeToAdminSection=!0,this.targetTitle="SERVICE",this.targetDescription="SERVICE"}ngOnDestroy(){this.subscription.unsubscribe()}ngOnInit(){this.loading=!0,this.subscription=this.route.parent.params.subscribe(f=>{this.userId=Number(f.userId),this.userId||(this.targetTitle="SERVICE",this.targetDescription="SELF",this.userId=this.store.getPerunPrincipal().userId,this.routeToAdminSection=!1),this.setAuthRights(),this.refreshTable()})}refreshTable(){this.loading=!0,this.userManager.getSpecificUsersByUser(this.userId).subscribe(f=>{this.identities=f,this.selection.clear(),this.loading=!1})}setAuthRights(){this.addIdentity=this.authResolver.isPerunAdmin(),this.removeIdentity=this.authResolver.isAuthorized("removeSpecificUserOwner_User_User_policy",[{id:this.userId,beanName:"User"}])}onAdd(){const f=(0,m.kZ)();f.width="1250px",f.data={userId:this.userId,theme:"user-theme",isService:!1,target:this.targetTitle},this.dialog.open(t.l,f).afterClosed().subscribe(_=>{_&&this.refreshTable()})}onRemove(){const f=(0,m.kZ)();f.width="650px",f.data={identities:this.selection.selected,userId:this.userId,specificUser:this.selection.selected[0],theme:"user-theme",targetTitle:this.targetTitle,targetDescription:this.targetDescription},this.dialog.open(e.B,f).afterClosed().subscribe(_=>{_&&this.refreshTable()})}static#e=this.\u0275fac=function(g){return new(g||P)(i.Y36(C.gz),i.Y36(h.uw),i.Y36(C.F0),i.Y36(c.Fv),i.Y36(n.x4),i.Y36(n.d6))};static#t=this.\u0275cmp=i.Xpm({type:P,selectors:[["app-user-settings-service-identities"]],decls:10,vars:7,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","class","me-2 action-button","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","class","me-2","mat-flat-button","",3,"disabled","click",4,"ngIf"],["spinner",""],[1,"position-relative"],[3,"noUsersFoundLabel","displayedColumns","selection","tableId","routeToAdmin","users",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"noUsersFoundLabel","displayedColumns","selection","tableId","routeToAdmin","users"]],template:function(g,_){if(1&g&&(i.TgZ(0,"h1",0),i._uU(1),i.ALo(2,"translate"),i.qZA(),i.TgZ(3,"perun-web-apps-refresh-button",1),i.NdJ("refresh",function(){return _.refreshTable()}),i.qZA(),i.YNc(4,v,3,3,"button",2),i.YNc(5,L,3,4,"button",3),i.YNc(6,N,1,0,"ng-template",null,4,i.W1O),i.TgZ(8,"div",5),i.YNc(9,A,2,8,"app-users-list",6),i.qZA()),2&g){const u=i.MAs(7);i.xp6(1),i.Oqu(i.lcZ(2,5,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.TITLE")),i.xp6(3),i.Q6J("ngIf",_.addIdentity),i.xp6(1),i.Q6J("ngIf",_.removeIdentity),i.xp6(4),i.Q6J("perunWebAppsLoader",_.loading)("perunWebAppsLoaderIndicator",u)}},dependencies:[Z.O5,M.lW,D.K,x.t,E.e,R.C,I.X$]})}return P})()},70837:(G,W,s)=>{s.r(W),s.d(W,{UsersModule:()=>Lt});var U=s(96814),c=s(44112),p=s(87824),m=s(73615),t=s(38106),e=s(65879),n=s(55959),i=s(80238),C=s(62481),h=s(2730),Z=s(69755),M=s(71365);function D(r,B){1&r&&(e.TgZ(0,"h1",7),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED_LIB.PERUN.ORGANIZATIONS.YOU_ARE_MEMBER"),"\n"))}function x(r,B){1&r&&(e.TgZ(0,"h1",7),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED_LIB.PERUN.ORGANIZATIONS.USER_IS_MEMBER"),"\n"))}function E(r,B){if(1&r&&e._UZ(0,"perun-web-apps-vos-list",8),2&r){const a=e.oxw();e.Q6J("displayedColumns",a.displayedColumns)("tableId",a.memberTableId)("filterValue",a.memberFilterValue)("vos",a.vosWhereIsMember)}}function R(r,B){if(1&r&&e._UZ(0,"perun-web-apps-vos-list",8),2&r){const a=e.oxw(2);e.Q6J("displayedColumns",a.displayedColumns)("tableId",a.adminTableId)("filterValue",a.adminFilterValue)("vos",a.vosWhereIsAdmin)}}function I(r,B){if(1&r){const a=e.EpF();e.TgZ(0,"div",9)(1,"h1",7),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){e.CHM(a);const l=e.oxw();return e.KtG(l.refreshAdminTable())}),e.qZA(),e.TgZ(5,"perun-web-apps-debounce-filter",2),e.NdJ("filter",function(l){e.CHM(a);const b=e.oxw();return e.KtG(b.applyAdminFilter(l))}),e.qZA(),e.TgZ(6,"div",3),e.YNc(7,R,1,4,"perun-web-apps-vos-list",4),e.qZA()()}if(2&r){const a=e.oxw(),o=e.MAs(8);e.xp6(2),e.Oqu(e.lcZ(3,4,"SHARED_LIB.PERUN.ORGANIZATIONS.USER_IS_ADMIN")),e.xp6(3),e.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),e.xp6(2),e.Q6J("perunWebAppsLoader",a.adminRefresh)("perunWebAppsLoaderIndicator",o)}}function v(r,B){1&r&&e._UZ(0,"perun-web-apps-loading-table")}let L=(()=>{class r{constructor(a,o,l,b){this.usersService=a,this.authResolver=o,this.store=l,this.route=b,this.vosWhereIsAdmin=[],this.vosWhereIsMember=[],this.adminFilterValue="",this.memberFilterValue="",this.displayedColumns=["id","name"],this.adminTableId=t.YF,this.memberTableId=t.gc}ngOnInit(){(this.isMyProfile=this.route.snapshot.data.showPrincipal)?this.userId=this.store.getPerunPrincipal().user.id:this.route.parent.params.subscribe(a=>this.userId=Number(a.userId)),this.refreshAdminTable(),this.refreshMemberTable()}refreshMemberTable(){this.memberRefresh=!0,this.usersService.getVosWhereUserIsMember(this.userId).subscribe(a=>{this.vosWhereIsMember=a,this.memberRefresh=!1},()=>this.memberRefresh=!1)}refreshAdminTable(){this.adminRefresh=!0,this.usersService.getVosWhereUserIsAdmin(this.userId).subscribe(a=>{this.vosWhereIsAdmin=a,this.adminRefresh=!1},()=>this.adminRefresh=!1)}applyMemberFilter(a){this.memberFilterValue=a}applyAdminFilter(a){this.adminFilterValue=a}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(p.Fv),e.Y36(m.x4),e.Y36(m.d6),e.Y36(c.gz))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-organizations"]],hostVars:2,hostBindings:function(o,l){2&o&&e.ekj("router-component",l.true)},decls:9,vars:6,consts:[["class","page-subtitle",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],[1,"position-relative"],[3,"displayedColumns","tableId","filterValue","vos",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["class","mt-5",4,"ngIf"],["spinner",""],[1,"page-subtitle"],[3,"displayedColumns","tableId","filterValue","vos"],[1,"mt-5"]],template:function(o,l){if(1&o&&(e.YNc(0,D,3,3,"h1",0),e.YNc(1,x,3,3,"h1",0),e.TgZ(2,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){return l.refreshMemberTable()}),e.qZA(),e.TgZ(3,"perun-web-apps-debounce-filter",2),e.NdJ("filter",function(Y){return l.applyMemberFilter(Y)}),e.qZA(),e.TgZ(4,"div",3),e.YNc(5,E,1,4,"perun-web-apps-vos-list",4),e.qZA(),e.YNc(6,I,8,6,"div",5),e.YNc(7,v,1,0,"ng-template",null,6,e.W1O)),2&o){const b=e.MAs(8);e.Q6J("ngIf",l.isMyProfile),e.xp6(1),e.Q6J("ngIf",!l.isMyProfile),e.xp6(2),e.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),e.xp6(2),e.Q6J("perunWebAppsLoader",l.memberRefresh)("perunWebAppsLoaderIndicator",b),e.xp6(1),e.Q6J("ngIf",!l.isMyProfile)}},dependencies:[U.O5,n.K,i.Z,C.t,h.P,Z.e,M.X$]})}return r})();var N=s(97500);function A(r,B){1&r&&(e.TgZ(0,"h1",7),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.YOU_ARE_MEMBER"),"\n"))}function O(r,B){1&r&&(e.TgZ(0,"h1",7),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.USER_IS_MEMBER"),"\n"))}const P=function(){return["id","vo","name","description"]};function S(r,B){if(1&r&&e._UZ(0,"perun-web-apps-groups-list",8),2&r){const a=e.oxw();e.Q6J("disableMembers",!1)("groups",a.membersGroups)("displayedColumns",e.DdM(5,P))("filter",a.memberFilterValue)("tableId",a.tableId)}}function f(r,B){if(1&r&&e._UZ(0,"perun-web-apps-groups-list",8),2&r){const a=e.oxw(2);e.Q6J("disableMembers",!1)("groups",a.adminsGroups)("displayedColumns",e.DdM(5,P))("filter",a.adminFilterValue)("tableId",a.adminTableId)}}function g(r,B){if(1&r){const a=e.EpF();e.TgZ(0,"div",9)(1,"h1",7),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){e.CHM(a);const l=e.oxw();return e.KtG(l.refreshAdminTable())}),e.qZA(),e.TgZ(5,"perun-web-apps-debounce-filter",2),e.NdJ("filter",function(l){e.CHM(a);const b=e.oxw();return e.KtG(b.adminFilter(l))}),e.qZA(),e.TgZ(6,"div",3),e.YNc(7,f,1,6,"perun-web-apps-groups-list",4),e.qZA()()}if(2&r){const a=e.oxw(),o=e.MAs(8);e.xp6(2),e.hij(" ",e.lcZ(3,4,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.USER_IS_ADMIN")," "),e.xp6(3),e.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),e.xp6(2),e.Q6J("perunWebAppsLoader",a.adminRefresh)("perunWebAppsLoaderIndicator",o)}}function _(r,B){1&r&&e._UZ(0,"perun-web-apps-loading-table")}let u=(()=>{class r{constructor(a,o,l,b,Y){this.usersService=a,this.memberService=o,this.groupService=l,this.store=b,this.route=Y,this.memberFilterValue="",this.adminFilterValue="",this.vos=[],this.membersGroups=[],this.adminsGroups=[],this.tableId=t.KE,this.adminTableId=t.Sb}ngOnInit(){(this.showPrincipal=this.route.snapshot.data.showPrincipal)?this.userId=this.store.getPerunPrincipal().user.id:this.route.parent.params.subscribe(a=>this.userId=Number(a.userId)),this.refreshAdminTable(),this.refreshMemberTable()}memberFilter(a){this.memberFilterValue=a}adminFilter(a){this.adminFilterValue=a}refreshAdminTable(){this.adminRefresh=!0,this.usersService.getGroupsWhereUserIsAdmin(this.userId).subscribe(a=>{this.adminsGroups=a,this.adminRefresh=!1})}refreshMemberTable(){this.memberRefresh=!0,this.membersGroups=[],this.usersService.getVosWhereUserIsMember(this.userId).subscribe(a=>{this.vos=a;for(const o of this.vos)this.memberService.getMemberByUser(o.id,this.userId).subscribe(l=>{this.groupService.getMemberGroups(l.id).subscribe(b=>{this.membersGroups=this.membersGroups.concat(b),this.vos.indexOf(o)===this.vos.length-1&&(this.memberRefresh=!1)})});0===a.length&&(this.memberRefresh=!1)})}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(p.Fv),e.Y36(p.uq),e.Y36(p.ff),e.Y36(m.d6),e.Y36(c.gz))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-groups"]],hostVars:2,hostBindings:function(o,l){2&o&&e.ekj("router-component",l.true)},decls:9,vars:6,consts:[["class","page-subtitle",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],[1,"position-relative"],[3,"disableMembers","groups","displayedColumns","filter","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["class","mt-5",4,"ngIf"],["spinner",""],[1,"page-subtitle"],[3,"disableMembers","groups","displayedColumns","filter","tableId"],[1,"mt-5"]],template:function(o,l){if(1&o&&(e.YNc(0,A,3,3,"h1",0),e.YNc(1,O,3,3,"h1",0),e.TgZ(2,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){return l.refreshMemberTable()}),e.qZA(),e.TgZ(3,"perun-web-apps-debounce-filter",2),e.NdJ("filter",function(Y){return l.memberFilter(Y)}),e.qZA(),e.TgZ(4,"div",3),e.YNc(5,S,1,6,"perun-web-apps-groups-list",4),e.qZA(),e.YNc(6,g,8,6,"div",5),e.YNc(7,_,1,0,"ng-template",null,6,e.W1O)),2&o){const b=e.MAs(8);e.Q6J("ngIf",l.showPrincipal),e.xp6(1),e.Q6J("ngIf",!l.showPrincipal),e.xp6(2),e.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),e.xp6(2),e.Q6J("perunWebAppsLoader",l.memberRefresh)("perunWebAppsLoaderIndicator",b),e.xp6(1),e.Q6J("ngIf",!l.showPrincipal)}},dependencies:[U.O5,n.K,N.W,C.t,h.P,Z.e,M.X$]})}return r})();var d=s(11712);let T=(()=>{class r{static#e=this.\u0275fac=function(o){return new(o||r)};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-settings"]],hostVars:2,hostBindings:function(o,l){2&o&&e.ekj("router-component",l.true)},decls:1,vars:0,template:function(o,l){1&o&&e._UZ(0,"app-animated-router-outlet")},dependencies:[d.A]})}return r})();var y=s(55940),w=s(39518);function j(r,B){1&r&&e._UZ(0,"mat-spinner",2)}function z(r,B){if(1&r&&(e.TgZ(0,"div"),e._UZ(1,"perun-web-apps-menu-buttons-field",3),e.qZA()),2&r){const a=e.oxw();e.xp6(1),e.Q6J("items",a.navItems)}}let pe=(()=>{class r{constructor(a,o){this.route=a,this.userManager=o,this.navItems=[],this.loading=!1}ngOnInit(){window.location.pathname.startsWith("/admin")?(this.loading=!0,this.route.parent.parent.params.subscribe(a=>{const o=Number(a.userId);this.userManager.getUserById(o).subscribe(l=>{this.isServiceUser=l.serviceUser,this.initNavItems(),this.loading=!1},()=>this.loading=!1)})):this.initNavItems()}initNavItems(){this.navItems=[],window.location.pathname.startsWith("/admin")||this.navItems.push({cssIcon:"perun-settings2",url:"/myProfile/settings/passwordReset",label:"MENU_ITEMS.USER.PASSWORD_RESET",style:"user-btn"},{cssIcon:"perun-settings1",url:"/myProfile/settings/guiConfig",label:"MENU_ITEMS.USER.GUI_CONFIG",style:"user-btn"})}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(c.gz),e.Y36(p.Fv))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-settings-overview"]],hostVars:2,hostBindings:function(o,l){2&o&&e.ekj("router-component",l.true)},decls:2,vars:2,consts:[["class","me-auto ms-auto",4,"ngIf"],[4,"ngIf"],[1,"me-auto","ms-auto"],[3,"items"]],template:function(o,l){1&o&&(e.YNc(0,j,1,0,"mat-spinner",0),e.YNc(1,z,2,1,"div",1)),2&o&&(e.Q6J("ngIf",l.loading),e.xp6(1),e.Q6J("ngIf",!l.loading))},dependencies:[U.O5,y.Ou,w.L]})}return r})();var ue=s(98836),X=s(78932),H=s(64124),$=s(38573),q=s(23680),k=s(64170),se=s(98525);function de(r,B){if(1&r&&(e.TgZ(0,"mat-option",5),e._uU(1),e.qZA()),2&r){const a=B.$implicit;e.Q6J("value",a),e.xp6(1),e.hij(" ",a," ")}}let me=(()=>{class r{constructor(a){this.guiConfigService=a,this.tablePageSizeOptions=H.f7}ngOnInit(){this.preferredTablePageSize=this.guiConfigService.getNumber($.Rc)}updatePreferredTablePageSize(){this.guiConfigService.setNumber($.Rc,this.preferredTablePageSize)}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36($.Ng))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-settings-app-configuration"]],decls:10,vars:8,consts:[[1,"page-subtitle"],[1,"col-12","col-lg-6","p-0"],[1,"w-100"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(o,l){1&o&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"div",1)(4,"mat-form-field",2)(5,"mat-label"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"mat-select",3),e.NdJ("valueChange",function(Y){return l.preferredTablePageSize=Y})("valueChange",function(){return l.updatePreferredTablePageSize()}),e.YNc(9,de,2,2,"mat-option",4),e.qZA()()()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,4,"USER_DETAIL.SETTINGS.GUI_CONFIG.TITLE")),e.xp6(5),e.Oqu(e.lcZ(7,6,"USER_DETAIL.SETTINGS.GUI_CONFIG.PREF_TABLE_PAGE_SIZE")),e.xp6(2),e.Q6J("value",l.preferredTablePageSize),e.xp6(1),e.Q6J("ngForOf",l.tablePageSizeOptions))},dependencies:[U.sg,q.ey,k.KE,k.hX,se.gD,M.X$]})}return r})();var he=s(5824),ne=s(39743),ee=s(30617),te=s(92596),ie=s(41419),ae=s(92738),re=s(52269),oe=s(37803);const ge=function(){return{color:"black"}},le=function(){return["/myProfile"]};function fe(r,B){if(1&r&&(e.TgZ(0,"div",1),e._UZ(1,"perun-web-apps-back-button"),e.TgZ(2,"div",2),e._UZ(3,"mat-icon",3),e.ALo(4,"translate"),e.TgZ(5,"div",4)(6,"div",5)(7,"a",6),e.NdJ("auxclick",function(o){return o.preventDefault()}),e._uU(8),e.ALo(9,"userFullName"),e.qZA(),e.TgZ(10,"span",7),e._uU(11),e.qZA()(),e.TgZ(12,"span",8),e._uU(13),e.ALo(14,"translate"),e.ALo(15,"translate"),e.qZA()()(),e._UZ(16,"app-animated-router-outlet"),e.qZA()),2&r){const a=e.oxw();e.xp6(3),e.s9C("matTooltip",e.lcZ(4,9,"MENU_ITEMS.USER.ENTITY")),e.Q6J("ngStyle",e.DdM(17,ge)),e.xp6(4),e.Q6J("perunWebAppsMiddleClickRouterLink",e.DdM(18,le))("routerLink",e.DdM(19,le)),e.xp6(1),e.hij(" ",e.lcZ(9,11,a.user)," "),e.xp6(3),e.hij(" \xa0#",a.user.id," "),e.xp6(2),e.lnq(" ",e.lcZ(14,13,"MENU_ITEMS.USER.ENTITY"),", ",e.lcZ(15,15,"MENU_ITEMS.USER.USER_TYPE"),": ",a.getUserType()," ")}}let Ee=(()=>{class r{constructor(a,o,l,b){this.sideMenuService=a,this.store=o,this.entityStore=l,this.router=b}ngOnInit(){this.path=this.router.url,this.router.events.subscribe(()=>{this.path=this.router.url}),this.principal=this.store.getPerunPrincipal(),this.user=this.principal.user,this.entityStore.setEntity(this.user),this.sideMenuService.setUserItems([])}getUserType(){return this.user.serviceUser?"Service":"Person"}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(ne.D),e.Y36(m.d6),e.Y36(m.fb),e.Y36(c.F0))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-profile"]],decls:1,vars:1,consts:[["class","container-fluid ps-xl-5 pe-xl-5 user-theme",4,"ngIf"],[1,"container-fluid","ps-xl-5","pe-xl-5","user-theme"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-user-dark",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"user-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],[1,"text-muted"],[1,"mt-1","entity-info"]],template:function(o,l){1&o&&e.YNc(0,fe,17,20,"div",0),2&o&&e.Q6J("ngIf",void 0!==l.user)},dependencies:[U.O5,U.PC,c.rH,ee.Hw,te.gM,ie.W,ae.Y,re.Q,d.A,M.X$,oe.d]})}return r})();var Ie=s(47406),Te=s(99497),ve=s(67582),Ae=s(13350),K=s(17700),Q=s(32296);function be(r,B){1&r&&e._UZ(0,"mat-spinner",11)}function Ue(r,B){if(1&r){const a=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(a);const l=e.oxw(2);return e.KtG(l.editUser())}),e.ALo(1,"translate"),e.TgZ(2,"mat-icon"),e._uU(3,"edit"),e.qZA()()}2&r&&e.s9C("matTooltip",e.lcZ(1,1,"MENU_ITEMS.USER.EDIT"))}const Se=function(){return{color:"black"}},ce=function(r){return["/myProfile/service-identities",r]};function Ce(r,B){if(1&r&&(e.TgZ(0,"div",1),e._UZ(1,"perun-web-apps-back-button"),e.YNc(2,be,1,0,"mat-spinner",2),e.TgZ(3,"div",3),e._UZ(4,"mat-icon",4),e.ALo(5,"translate"),e.TgZ(6,"div",5)(7,"div",6)(8,"a",7),e.NdJ("auxclick",function(o){return o.preventDefault()}),e._uU(9),e.ALo(10,"userFullName"),e.qZA(),e.TgZ(11,"span",8),e._uU(12),e.qZA(),e.YNc(13,Ue,4,3,"button",9),e.qZA(),e.TgZ(14,"div"),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"span",10),e._uU(18),e.ALo(19,"translate"),e.ALo(20,"translate"),e.qZA()()(),e._UZ(21,"app-animated-router-outlet"),e.qZA()),2&r){const a=e.oxw();e.xp6(2),e.Q6J("ngIf",a.loading),e.xp6(2),e.s9C("matTooltip",e.lcZ(5,13,"MENU_ITEMS.USER.ENTITY")),e.Q6J("ngStyle",e.DdM(23,Se)),e.xp6(4),e.Q6J("perunWebAppsMiddleClickRouterLink",e.VKq(24,ce,a.user.id.toString()))("routerLink",e.VKq(26,ce,a.user.id)),e.xp6(1),e.hij(" ",e.lcZ(10,15,a.user)," "),e.xp6(3),e.hij(" \xa0#",a.user.id," "),e.xp6(1),e.Q6J("ngIf",a.authResolver.isPerunAdmin()),e.xp6(2),e.AsE("",e.lcZ(16,17,"ADMIN_USER.UUID"),": ",a.user.uuid,""),e.xp6(3),e.lnq(" ",e.lcZ(19,19,"MENU_ITEMS.USER.ENTITY"),", ",e.lcZ(20,21,"MENU_ITEMS.USER.USER_TYPE"),": ",a.getUserType()," ")}}let De=(()=>{class r{constructor(a,o,l,b,Y,J,V){this.sideMenuService=a,this.usersService=o,this.sideMenuItemService=l,this.route=b,this.dialog=Y,this.authResolver=J,this.entityStorageService=V,this.loading=!1}ngOnInit(){this.loading=!0,this.route.params.subscribe(a=>{const o=Number(a.userId);this.entityStorageService.setEntity({id:o,beanName:"User"}),this.usersService.getUserById(o).subscribe(l=>{this.user=l;const b=this.sideMenuItemService.parseServiceIdentity(l);this.sideMenuService.setUserItems([b]),this.loading=!1},()=>this.loading=!1)})}getUserType(){return this.user.serviceUser?"Service":"Person"}editUser(){const a=(0,H.kZ)();a.width="450px",a.data={theme:"admin-theme",user:this.user},this.dialog.open(Ae.x,a).afterClosed().subscribe(l=>{l&&this.usersService.getUserById(this.user.id).subscribe(b=>{this.user=b})})}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(ne.D),e.Y36(p.Fv),e.Y36(ve.V),e.Y36(c.gz),e.Y36(K.uw),e.Y36(m.x4),e.Y36(m.fb))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-detail-page"]],decls:1,vars:1,consts:[["class","container-fluid ps-xl-5 pe-xl-5 user-theme",4,"ngIf"],[1,"container-fluid","ps-xl-5","pe-xl-5","user-theme"],["class","me-auto ms-auto",4,"ngIf"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-service-identity",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"user-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],[1,"text-muted"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],[1,"mt-1","entity-info"],[1,"me-auto","ms-auto"],["mat-icon-button","",3,"matTooltip","click"]],template:function(o,l){1&o&&e.YNc(0,Ce,22,28,"div",0),2&o&&e.Q6J("ngIf",void 0!==l.user)},dependencies:[U.O5,U.PC,c.rH,ee.Hw,Q.RK,y.Ou,te.gM,ie.W,ae.Y,re.Q,d.A,M.X$,oe.d]})}return r})();var Oe=s(19218);let Me=(()=>{class r{constructor(a){this.entityStorageService=a,this.navItems=[],this.authenticationItems=[]}ngOnInit(){this.serviceAccount=this.entityStorageService.getEntity(),this.initNavItems()}initNavItems(){this.navItems=[{cssIcon:"perun-manager",url:`/myProfile/service-identities/${this.serviceAccount.id}/associated-users`,label:"MENU_ITEMS.USER.ASSOCIATED_USERS",style:"user-btn"},{cssIcon:"perun-notification",url:`/myProfile/service-identities/${this.serviceAccount.id}/mailing-lists`,label:"MENU_ITEMS.USER.MAILING_LISTS",style:"user-btn"},{cssIcon:"perun-statistics",url:`/myProfile/service-identities/${this.serviceAccount.id}/data-quotas`,label:"MENU_ITEMS.USER.DATA_QUOTAS",style:"user-btn"}],this.authenticationItems=[{cssIcon:"perun-logins",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/logins`,label:"MENU_ITEMS.USER.LOGINS",style:"user-btn"},{cssIcon:"perun-certificates",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/certificates`,label:"MENU_ITEMS.USER.CERTIFICATES",style:"user-btn"},{cssIcon:"perun-key",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/ssh-keys`,label:"MENU_ITEMS.USER.SSH_KEYS",style:"user-btn"}]}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(m.fb))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-overview"]],decls:2,vars:4,consts:[[3,"items"],[3,"items","title","sectionId"]],template:function(o,l){1&o&&e._UZ(0,"perun-web-apps-menu-buttons-field",0)(1,"perun-web-apps-expandable-tiles",1),2&o&&(e.Q6J("items",l.navItems),e.xp6(1),e.Q6J("items",l.authenticationItems)("title","MENU_ITEMS.USER.AUTHENTICATION")("sectionId","authentication"))},dependencies:[w.L,Oe.A]})}return r})();var Re=s(35938),Le=s(60353);let ye=(()=>{class r{constructor(a){this.entityStorageService=a}ngOnInit(){this.user=this.entityStorageService.getEntity()}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(m.fb))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-user-settings-mailing-lists"]],decls:1,vars:2,consts:[[3,"user","isService"]],template:function(o,l){1&o&&e._UZ(0,"perun-web-apps-mailing-lists",0),2&o&&e.Q6J("user",l.user)("isService",!0)},dependencies:[Le.E]})}return r})();var Ne=s(71588);let Pe=(()=>{class r{constructor(a){this.entityStorageService=a}ngOnInit(){this.user=this.entityStorageService.getEntity()}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(m.fb))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-user-settings-data-quotas"]],decls:1,vars:1,consts:[[3,"user"]],template:function(o,l){1&o&&e._UZ(0,"perun-web-apps-data-quotas",0),2&o&&e.Q6J("user",l.user)},dependencies:[Ne.m]})}return r})(),Ze=(()=>{class r{constructor(a){this.entityStorageService=a,this.navItems=[]}ngOnInit(){this.serviceAccount=this.entityStorageService.getEntity(),this.initNavItems()}initNavItems(){this.navItems=[{cssIcon:"perun-logins",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/logins`,label:"MENU_ITEMS.USER.LOGINS",style:"user-btn"},{cssIcon:"perun-certificates",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/certificates`,label:"MENU_ITEMS.USER.CERTIFICATES",style:"user-btn"},{cssIcon:"perun-key",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/ssh-keys`,label:"MENU_ITEMS.USER.SSH_KEYS",style:"user-btn"}]}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(m.fb))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-authentication-overview"]],decls:1,vars:1,consts:[[3,"items"]],template:function(o,l){1&o&&e._UZ(0,"perun-web-apps-menu-buttons-field",0),2&o&&e.Q6J("items",l.navItems)},dependencies:[w.L]})}return r})();var F=s(56223),xe=s(50165),Be=s(12207),We=s(7831);function Ye(r,B){1&r&&e._UZ(0,"perun-web-apps-loading-dialog")}function we(r,B){if(1&r){const a=e.EpF();e.TgZ(0,"div")(1,"h1",3),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",4),e._UZ(5,"app-login-password-form-with-generate-option",5),e.qZA(),e.TgZ(6,"div",6)(7,"button",7),e.NdJ("click",function(){e.CHM(a);const l=e.oxw();return e.KtG(l.onCancel())}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",8),e.NdJ("click",function(){e.CHM(a);const l=e.oxw();return e.KtG(l.onSetLogin())}),e._uU(11),e.ALo(12,"translate"),e.qZA()()()}if(2&r){const a=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,6,"DIALOGS.SET_LOGIN.TITLE")),e.xp6(3),e.Q6J("formGroup",a.formGroup)("filteredNamespace",a.data.filteredNamespaces),e.xp6(3),e.hij(" ",e.lcZ(9,8,"DIALOGS.SET_LOGIN.CANCEL")," "),e.xp6(2),e.Q6J("disabled","Not selected"===a.formGroup.get("namespaceCtrl").value||a.formGroup.invalid||a.formGroup.pending||a.processing),e.xp6(1),e.hij(" ",e.lcZ(12,10,"DIALOGS.SET_LOGIN.SET_LOGIN")," ")}}let Ge=(()=>{class r{constructor(a,o,l,b,Y,J,V,yt,Nt,Pt){this.dialogRef=a,this.data=o,this.formBuilder=l,this.usersManagerService=b,this.membersManagerService=Y,this.attributesManagerService=J,this.apiRequestConfiguration=V,this.notificator=yt,this.translate=Nt,this.cd=Pt,this.processing=!1}ngOnInit(){this.userId=this.data.userId,this.formGroup=this.formBuilder.group({namespaceCtrl:["Not selected"],loginCtrl:["",[F.kI.pattern("^[a-z][a-z0-9_-]+$"),F.kI.maxLength(15),F.kI.minLength(2)]],passwordCtrl:["",F.kI.required,[(0,xe.yT)(null,this.usersManagerService,this.apiRequestConfiguration)]],passwordAgainCtrl:[""],generatePasswordCtrl:[!0]},{validators:H.dN.passwordMatchValidator})}ngAfterViewInit(){this.cd.detectChanges()}onSetLogin(){this.processing=!0;const a=this.formGroup.get("namespaceCtrl").value.toLowerCase(),o=this.formGroup.get("loginCtrl").value;if(o)this.setLogin(a,o);else{const l=`urn:perun:user:attribute-def:def:login-namespace:${a}`;this.attributesManagerService.getUserAttributeByName(this.userId,"urn:perun:user:attribute-def:core:lastName").subscribe(b=>{this.usersManagerService.generateAccountForName(a,b.value).subscribe(J=>{this.setLogin(a,J[l])},()=>this.processing=!1)})}}setLogin(a,o){this.usersManagerService.setLogin(this.userId,o,a).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.SET_LOGIN.SUCCESS_LOGIN")),this.setPassword()},()=>{this.processing=!1})}setPassword(){const a=this.formGroup.get("namespaceCtrl").value.toLowerCase(),o=this.formGroup.get("passwordCtrl").value;if(this.formGroup.get("generatePasswordCtrl").value){if(!this.formGroup.get("loginCtrl").value)return;this.usersManagerService.reserveRandomPassword(this.userId,a).subscribe(()=>{this.usersManagerService.validatePasswordForUser(this.userId,a).subscribe(()=>{this.dialogRef.close(!0)},()=>{this.processing=!1})},()=>{this.processing=!1})}else this.usersManagerService.reservePasswordForUser({user:this.userId,namespace:a,password:o}).subscribe(()=>{this.usersManagerService.validatePasswordForUser(this.userId,a).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.SET_LOGIN.SUCCESS_PASSWORD")),this.dialogRef.close(!0)},()=>{this.processing=!1})},()=>{this.processing=!1})}onCancel(){this.dialogRef.close(!1)}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(K.so),e.Y36(K.WI),e.Y36(F.QS),e.Y36(p.Fv),e.Y36(p.uq),e.Y36(p.H8),e.Y36(m.F5),e.Y36(m.V6),e.Y36(M.sK),e.Y36(e.sBO))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-set-login-dialog"]],decls:4,vars:2,consts:[["spinner",""],[1,"vo-theme","position-relative"],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],[3,"formGroup","filteredNamespace"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"disabled","click"]],template:function(o,l){if(1&o&&(e.YNc(0,Ye,1,0,"ng-template",null,0,e.W1O),e.TgZ(2,"div",1),e.YNc(3,we,13,12,"div",2),e.qZA()),2&o){const b=e.MAs(1);e.xp6(3),e.Q6J("perunWebAppsLoader",l.processing)("perunWebAppsLoaderIndicator",b)}},dependencies:[F.JL,F.sg,Q.lW,K.uh,K.xY,K.H8,Be.b,Z.e,We.r,M.X$]})}return r})();var Ke=s(97694);const Fe=["logins"];let Je=(()=>{class r{constructor(a,o){this.dialog=a,this.entityStorageService=o,this.filteredNamespaces=[]}ngOnInit(){this.userId=this.entityStorageService.getEntity().id}onAdd(){const a=(0,H.kZ)();a.width="500px",a.data={userId:this.userId,filteredNamespaces:this.filteredNamespaces},this.dialog.open(Ge,a).afterClosed().subscribe(l=>{l&&this.logins.refreshTable()})}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(K.uw),e.Y36(m.fb))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-user-settings-logins"]],viewQuery:function(o,l){if(1&o&&e.Gf(Fe,5),2&o){let b;e.iGM(b=e.CRH())&&(l.logins=b.first)}},decls:9,vars:7,consts:[[1,"page-title"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],[3,"authenticationPage","filteredNamespaces"],["logins",""]],template:function(o,l){if(1&o){const b=e.EpF();e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){e.CHM(b);const J=e.MAs(8);return e.KtG(J.refreshTable())}),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return l.onAdd()}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"perun-web-apps-password-reset",3,4),e.NdJ("filteredNamespaces",function(J){return l.filteredNamespaces=J}),e.qZA()}2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,3,"USER_DETAIL.SETTINGS.LOGINS.TITLE")),e.xp6(4),e.hij(" ",e.lcZ(6,5,"USER_DETAIL.SETTINGS.LOGINS.ADD"),"\n"),e.xp6(2),e.Q6J("authenticationPage",!0))},dependencies:[Q.lW,C.t,Ke.N,M.X$]})}return r})(),Qe=(()=>{class r{static#e=this.\u0275fac=function(o){return new(o||r)};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-authentication"]],hostVars:2,hostBindings:function(o,l){2&o&&e.ekj("router-component",l.true)},decls:1,vars:0,template:function(o,l){1&o&&e._UZ(0,"app-animated-router-outlet")},dependencies:[d.A]})}return r})();var He=s(1385),Ve=s(78337),je=s(37073),ze=s(25184);const Xe=["list"];function $e(r,B){1&r&&e._UZ(0,"perun-web-apps-loading-table")}const qe=function(r){return[r]};function ke(r,B){if(1&r&&e._UZ(0,"perun-web-apps-attributes-list",6,7),2&r){const a=e.oxw();e.Q6J("attributes",e.VKq(2,qe,a.certificates))("selection",a.selection)}}let et=(()=>{class r{constructor(a,o,l){this.entityStorageService=a,this.attributesManagerService=o,this.dialog=l,this.selection=new Ve.Ov(!0,[])}ngOnInit(){this.userId=this.entityStorageService.getEntity().id,this.refresh()}refresh(){this.loading=!0,this.attributesManagerService.getUserAttributeByName(this.userId,He.r.USER_DEF_CERTIFICATES).subscribe(a=>{this.certificates=a,this.selection.clear(),this.loading=!1})}save(){this.list.updateMapAttributes();const a=(0,H.kZ)();a.width="450px",a.data={entityId:this.userId,entity:"user",attributes:this.selection.selected},this.dialog.open(je.wA,a).afterClosed().subscribe(l=>{l&&this.refresh()})}static#e=this.\u0275fac=function(o){return new(o||r)(e.Y36(m.fb),e.Y36(p.H8),e.Y36(K.uw))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-certificates"]],viewQuery:function(o,l){if(1&o&&e.Gf(Xe,5),2&o){let b;e.iGM(b=e.CRH())&&(l.list=b.first)}},decls:11,vars:9,consts:[[1,"page-title"],[1,"mt-2",3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","mt-2",3,"disabled","click"],["spinner",""],[1,"position-relative"],[3,"attributes","selection",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"attributes","selection"],["list",""]],template:function(o,l){if(1&o&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){return l.refresh()}),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return l.save()}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.YNc(7,$e,1,0,"ng-template",null,3,e.W1O),e.TgZ(9,"div",4),e.YNc(10,ke,2,4,"perun-web-apps-attributes-list",5),e.qZA()),2&o){const b=e.MAs(8);e.xp6(1),e.Oqu(e.lcZ(2,5,"USER_DETAIL.SETTINGS.CERTIFICATES.TITLE")),e.xp6(3),e.Q6J("disabled",0===l.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(6,7,"USER_DETAIL.SETTINGS.CERTIFICATES.SAVE"),"\n"),e.xp6(5),e.Q6J("perunWebAppsLoader",l.loading)("perunWebAppsLoaderIndicator",b)}},dependencies:[Q.lW,n.K,C.t,ze.p,Z.e,M.X$]})}return r})();var tt=s(81381);const st=[{path:"",component:Ee,children:[{path:"",component:he.Z,data:{animation:"UserOverviewPage"}},{path:"attributes",component:ue.u,data:{animation:"UserAttributesPage"}},{path:"organizations",component:L,data:{animation:"UserOrganizationsPage",showPrincipal:!0}},{path:"groups",component:u,data:{animation:"UserGroupsPage",showPrincipal:!0}},{path:"roles",component:Ie.t,data:{animation:"UserRolesPage"}},{path:"service-identities",component:Te.R,data:{animation:"UserServiceIdentities"}},{path:"bans",component:tt.Q,data:{animation:"UserBansPage"}},{path:"settings",component:T,children:[{path:"",component:pe,data:{animation:"UserSettingsOverviewPage"}},{path:"passwordReset",component:X.Nj,data:{animation:"PasswordResetPage"}},{path:"guiConfig",component:me,data:{animation:"UserAppConfigurationPage"}}]}]},{path:"service-identities/:userId",component:De,children:[{path:"",component:Me},{path:"associated-users",component:Re.d},{path:"authentication",component:Qe,children:[{path:"",component:Ze},{path:"logins",component:Je},{path:"certificates",component:et},{path:"ssh-keys",component:X.N7}]},{path:"mailing-lists",component:ye},{path:"data-quotas",component:Pe}]}];let nt=(()=>{class r{static#e=this.\u0275fac=function(o){return new(o||r)};static#t=this.\u0275mod=e.oAB({type:r});static#s=this.\u0275inj=e.cJS({imports:[c.Bz.forChild(st),c.Bz]})}return r})();var it=s(24630),at=s(24516),rt=s(32651),ot=s(3305),lt=s(13566),ct=s(25313),_t=s(74104),pt=s(98445),ut=s(75986),dt=s(22939),mt=s(16007),ht=s(82599),gt=s(38034),ft=s(87466),Et=s(26385),It=s(21476),_e=s(95195),Tt=s(61545),vt=s(34423),At=s(22557),bt=s(77988),Ut=s(16672),St=s(62034),Ct=s(99441),Dt=s(39014),Ot=s(60060),Mt=s(80874),Rt=s(35050);let Lt=(()=>{class r{constructor(a){this.translate=a,a.addLangs(["en","cs"])}static#e=this.\u0275fac=function(o){return new(o||r)(e.LFG(M.sK))};static#t=this.\u0275mod=e.oAB({type:r});static#s=this.\u0275inj=e.cJS({imports:[U.ez,nt,it.Bb,at.c,k.lN,F.UX,F.u5,ee.Ps,rt.SJ,ot.To,M.aw.forChild({}),Q.ot,lt.JX,ct.p0,_t.Nh,pt.dp,Q.ot,ut.p9,K.Is,se.LD,dt.ZX,y.Cq,mt.Cv,te.AV,ht.rP,gt.FA,q.XK,ft.Fk,Et.t,q.si,It.TU,_e.QW,Tt.T5,vt._t,_e.QW,At.Hi,bt.Tx,Ut.Cl,St.r,Ct.A,Dt.g,X.ez,Ot.r,Mt.d4,Rt.m]})}return r})()}}]);