!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==i)return;var a,n,s=[],r=!0,l=!1;try{for(i=i.call(e);!(r=(a=i.next()).done)&&(s.push(a.value),!t||s.length!==t);r=!0);}catch(o){l=!0,n=o}finally{try{r||null==i.return||i.return()}finally{if(l)throw n}}return s}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=a(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,s=function(){};return{s:s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,l=!0,o=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return l=e.done,e},e:function(e){o=!0,r=e},f:function(){try{l||null==i.return||i.return()}finally{if(o)throw r}}}}function a(e,t){if(e){if("string"==typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function l(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}(self.webpackChunkperun_web_apps=self.webpackChunkperun_web_apps||[]).push([[722],{86722:function(a,n,r){"use strict";r.r(n),r.d(n,{FacilitiesModule:function(){return Vn}});var o=r(61511),c=r(57629),u=r(73916),d=r(17),h=r(75585),f=r(90474),p=r(84140),g=r(3681),m=r(6527),v=r(30570),A=r(31572),S=r(84608),I=r(48958),T=r(66297),y=r(67806),b=r(43691),E=r(36922),Z=r(21575),C=r(15980),_=r(48160);function L(e,t){1&e&&A._UZ(0,"mat-spinner",3)}function k(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",12),A.NdJ("click",function(){return A.CHM(i),A.oxw(2).editFacility()}),A.TgZ(1,"mat-icon"),A._uU(2,"edit"),A.qZA(),A.qZA()}}function O(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",12),A.NdJ("click",function(){return A.CHM(i),A.oxw(2).deleteFacility()}),A.TgZ(1,"mat-icon"),A._uU(2,"delete_forever"),A.qZA(),A.qZA()}}var x=function(){return{color:"black"}},R=function(e){return["/facilities",e]};function D(e,t){if(1&e&&(A.TgZ(0,"div"),A.TgZ(1,"div",4),A._UZ(2,"mat-icon",5),A.ALo(3,"translate"),A.TgZ(4,"div",6),A.TgZ(5,"div",7),A.TgZ(6,"a",8),A._uU(7),A.qZA(),A.TgZ(8,"span",9),A._uU(9),A.qZA(),A.YNc(10,k,3,0,"button",10),A.YNc(11,O,3,0,"button",10),A.qZA(),A.TgZ(12,"span",11),A._uU(13),A.ALo(14,"translate"),A.ALo(15,"translate"),A.qZA(),A.qZA(),A.qZA(),A._UZ(16,"app-animated-router-outlet"),A.qZA()),2&e){var i=A.oxw();A.xp6(2),A.s9C("matTooltip",A.lcZ(3,10,"FACILITY_DETAIL.ENTITY")),A.Q6J("ngStyle",A.DdM(16,x)),A.xp6(4),A.Q6J("routerLink",A.VKq(17,R,i.facility.id)),A.xp6(1),A.Oqu(i.facility.name),A.xp6(2),A.hij(" \xa0#",i.facility.id," "),A.xp6(1),A.Q6J("ngIf",i.editFacilityAuth),A.xp6(1),A.Q6J("ngIf",i.deleteAuth),A.xp6(2),A.lnq(" ",A.lcZ(14,12,"FACILITY_DETAIL.ENTITY"),", ",A.lcZ(15,14,"FACILITY_DETAIL.DESCRIPTION"),": ",i.facility.description," ")}}var N=function(){var e=function(){function e(t,i,a,n,r,l,o){s(this,e),this.dialog=t,this.facilityManager=i,this.route=a,this.sideMenuService=n,this.sideMenuItemService=r,this.guiAuthResolver=l,this.router=o,this.editFacilityAuth=!1,this.deleteAuth=!1,this.loading=!1}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.params.subscribe(function(t){e.facilityManager.getFacilityById(t.facilityId).subscribe(function(t){e.facility=t;var i=e.sideMenuItemService.parseFacility(t);e.sideMenuService.setFacilityMenuItems([i]),e.editFacilityAuth=e.guiAuthResolver.isAuthorized("updateFacility_Facility_policy",[e.facility]),e.deleteAuth=e.guiAuthResolver.isAuthorized("deleteFacility_Facility_Boolean_policy",[e.facility]),(0,p.sF)("facilities",e.facility),(0,p.XI)(e.facility),e.loading=!1},function(){return e.loading=!1})})}},{key:"editFacility",value:function(){var e=this,t=(0,p.kZ)();t.width="450px",t.data={theme:"facility-theme",facility:this.facility,dialogType:m.Eg.FACILITY},this.dialog.open(m.rd,t).afterClosed().subscribe(function(t){t&&e.facilityManager.getFacilityById(e.facility.id).subscribe(function(t){e.facility=t})})}},{key:"deleteFacility",value:function(){var e=this,t=(0,p.kZ)();t.width="500px",t.data={theme:"facility-theme",facility:this.facility},this.dialog.open(v.Y,t).afterClosed().subscribe(function(t){t&&e.router.navigate([""])})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(S.uw),A.Y36(f.IQ),A.Y36(c.gz),A.Y36(I.D),A.Y36(h.V),A.Y36(g.x4),A.Y36(c.F0))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-detail-page"]],decls:4,vars:2,consts:[[1,"container-fluid","pl-xl-5","pr-xl-5","facility-theme"],["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-facility-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],["queryParamsHandling","merge",1,"facility-link",3,"routerLink"],[1,"text-muted"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"mt-1","entity-info"],["mat-icon-button","",3,"click"]],template:function(e,t){1&e&&(A.TgZ(0,"div",0),A._UZ(1,"perun-web-apps-back-button"),A.YNc(2,L,1,0,"mat-spinner",1),A.YNc(3,D,17,19,"div",2),A.qZA()),2&e&&(A.xp6(2),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading&&void 0!==t.facility))},directives:[T.W,o.O5,y.$g,b.Hw,E.gM,o.PC,c.yS,Z.A,C.lW],pipes:[_.X$],styles:[""],data:{animation:[d.Ji]}}),e}(),w=r(8557);function Y(e,t){1&e&&A._UZ(0,"mat-spinner",2)}function F(e,t){if(1&e&&(A.TgZ(0,"div"),A._UZ(1,"perun-web-apps-menu-buttons-field",3),A.qZA()),2&e){var i=A.oxw();A.xp6(1),A.Q6J("items",i.navItems)("size","small")}}var M=function(){var e=function(){function e(t,i,a){s(this,e),this.facilityManager=t,this.route=i,this.authResolver=a,this.navItems=[],this.loading=!1}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.params.subscribe(function(t){e.facilityManager.getFacilityById(t.facilityId).subscribe(function(t){e.facility=t,e.initItems(),e.loading=!1},function(){return e.loading=!1})})}},{key:"initItems",value:function(){this.navItems=[],this.authResolver.isAuthorized("getAssignedRichResources_Facility_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-manage-facility",url:"/facilities/".concat(this.facility.id,"/resources"),label:"MENU_ITEMS.FACILITY.RESOURCES",style:"facility-btn"}),this.authResolver.isAuthorized("getAssignedUsers_Facility_Service_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-user",url:"/facilities/".concat(this.facility.id,"/allowed-users"),label:"MENU_ITEMS.FACILITY.ALLOWED_USERS",style:"facility-btn"}),this.authResolver.isAuthorized("getAllowedGroups_Facility_Vo_Service_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-group",url:"/facilities/".concat(this.facility.id,"/allowed-groups"),label:"MENU_ITEMS.FACILITY.ALLOWED_GROUPS",style:"facility-btn"}),this.authResolver.isAuthorized("getFacilityServicesState_Facility_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-service-status",url:"/facilities/".concat(this.facility.id,"/services-status"),label:"MENU_ITEMS.FACILITY.SERVICES_STATUS",style:"facility-btn"}),this.authResolver.isAuthorized("getAllRichDestinations_Facility_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-service_destination",url:"/facilities/".concat(this.facility.id,"/services-destinations"),label:"MENU_ITEMS.FACILITY.SERVICES_DESTINATIONS",style:"facility-btn"}),this.authResolver.isFacilityAdmin()&&this.navItems.push({cssIcon:"perun-hosts",url:"/facilities/".concat(this.facility.id,"/hosts"),label:"MENU_ITEMS.FACILITY.HOSTS",style:"facility-btn"}),this.navItems.push({cssIcon:"perun-attributes",url:"/facilities/".concat(this.facility.id,"/attributes"),label:"MENU_ITEMS.FACILITY.ATTRIBUTES",style:"facility-btn"}),(this.authResolver.isAuthorized("getBansForFacility_int_policy",[this.facility])||this.authResolver.isManagerPagePrivileged(this.facility)||this.authResolver.isAuthorized("getOwners_Facility_policy",[this.facility])||this.authResolver.isAuthorized("getAssignedSecurityTeams_Facility_policy",[this.facility]))&&this.navItems.push({cssIcon:"perun-settings2",url:"/facilities/".concat(this.facility.id,"/settings"),label:"MENU_ITEMS.FACILITY.SETTINGS",style:"facility-btn"})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(f.IQ),A.Y36(c.gz),A.Y36(g.x4))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&A.ekj("router-component",t.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(A.YNc(0,Y,1,0,"mat-spinner",0),A.YNc(1,F,2,2,"div",1)),2&e&&(A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[o.O5,y.$g,w.L],styles:[""]}),e}(),U=r(64467),q=r(39124),J=r(72920),Q=r(76527),V=function(){var e=function e(){s(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-settings"]],hostVars:2,hostBindings:function(e,t){2&e&&A.ekj("router-component",t.true)},decls:1,vars:0,template:function(e,t){1&e&&A._UZ(0,"app-animated-router-outlet")},directives:[Z.A],styles:[""],data:{animation:[d.Ji]}}),e}();function H(e,t){1&e&&A._UZ(0,"mat-spinner",2)}function P(e,t){if(1&e&&(A.TgZ(0,"div"),A._UZ(1,"perun-web-apps-menu-buttons-field",3),A.qZA()),2&e){var i=A.oxw();A.xp6(1),A.Q6J("items",i.items)("size","small")}}var B=function(){var e=function(){function e(t,i,a){s(this,e),this.route=t,this.facilityManager=i,this.authResolver=a,this.items=[],this.loading=!1}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.parent.parent.params.subscribe(function(t){e.facilityManager.getFacilityById(t.facilityId).subscribe(function(t){e.facility=t,e.initItems(),e.loading=!1},function(){return e.loading=!1})})}},{key:"initItems",value:function(){this.items=[],this.authResolver.isAuthorized("getOwners_Facility_policy",[this.facility])&&this.items.push({cssIcon:"perun-owner-grey",url:"/facilities/".concat(this.facility.id,"/settings/owners"),label:"MENU_ITEMS.FACILITY.OWNERS",style:"facility-btn"}),this.authResolver.isManagerPagePrivileged(this.facility)&&this.items.push({cssIcon:"perun-manager",url:"/facilities/".concat(this.facility.id,"/settings/managers"),label:"MENU_ITEMS.FACILITY.MANAGERS",style:"facility-btn"}),this.authResolver.isAuthorized("getAssignedSecurityTeams_Facility_policy",[this.facility])&&this.items.push({cssIcon:"perun-security-teams",url:"/facilities/".concat(this.facility.id,"/settings/security-teams"),label:"MENU_ITEMS.FACILITY.SECURITY_TEAMS",style:"facility-btn"}),this.authResolver.isAuthorized("getBansForFacility_int_policy",[this.facility])&&this.items.push({cssIcon:"perun-black-list",url:"/facilities/".concat(this.facility.id,"/settings/blacklist"),label:"MENU_ITEMS.FACILITY.BLACKLIST",style:"facility-btn"})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(c.gz),A.Y36(f.IQ),A.Y36(g.x4))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-settings-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&A.ekj("router-component",t.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(A.YNc(0,H,1,0,"mat-spinner",0),A.YNc(1,P,2,2,"div",1)),2&e&&(A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[o.O5,y.$g,w.L],styles:[""]}),e}(),G=r(55109),z=r(541),$=r(3417);function j(e,t){1&e&&(A._uU(0),A.ALo(1,"translate")),2&e&&A.hij(" ",A.lcZ(1,1,"FACILITY_DETAIL.ENTITY")," ")}function K(e,t){if(1&e&&A._UZ(0,"app-one-entity-attribute-page",4),2&e){var i=A.oxw();A.Q6J("entity","facility")("entityId",i.facilityId)}}function W(e,t){1&e&&(A._uU(0),A.ALo(1,"translate"),A.ALo(2,"translate")),2&e&&A.AsE(" ",A.lcZ(1,2,"FACILITY_DETAIL.ENTITY")," - ",A.lcZ(2,4,"ADMIN_USER.ENTITY")," ")}function X(e,t){if(1&e&&A._UZ(0,"app-two-entity-attribute-page",5),2&e){var i=A.oxw(2);A.Q6J("firstEntity","facility")("firstEntityId",i.facilityId)("secondEntity","user")}}function ee(e,t){1&e&&(A.TgZ(0,"mat-tab"),A.YNc(1,W,3,6,"ng-template",1),A.YNc(2,X,1,3,"ng-template",2),A.qZA())}var te=function(){var e=function(){function e(t,i){s(this,e),this.route=t,this.authResolver=i}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.route.parent.params.subscribe(function(t){e.facilityId=t.facilityId,e.facilityUserAttAuth=e.authResolver.isAuthorized("getAssignedUsers_Facility_policy",[{id:e.facilityId,beanName:"Facility"}])})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(c.gz),A.Y36(g.x4))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-attributes"]],hostVars:2,hostBindings:function(e,t){2&e&&A.ekj("router-component",t.true)},decls:9,vars:4,consts:[[1,"page-subtitle"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entity","entityId"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"mat-tab-group"),A.TgZ(5,"mat-tab"),A.YNc(6,j,2,3,"ng-template",1),A.YNc(7,K,1,2,"ng-template",2),A.qZA(),A.YNc(8,ee,3,0,"mat-tab",3),A.qZA(),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,2,"FACILITY_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),A.xp6(6),A.Q6J("ngIf",t.facilityUserAttAuth))},directives:[G.SP,G.uX,G.uD,G.Vc,o.O5,z.t,$.Y],pipes:[_.X$],styles:[""]}),e}(),ie=r(77968),ae=r(22927),ne=r(79472),se=r(42473),re=r(16073),le=r(56238),oe=r(79996),ce=r(22280),ue=r(29236),de=r(66283),he=r(80340),fe=r(40084),pe=r(71522),ge=r(22196);function me(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-option",10),A.NdJ("onSelectionChange",function(){var e=A.CHM(i).$implicit;return A.oxw(3).onSelectedService(e)}),A._uU(1),A.qZA()}if(2&e){var a=t.$implicit;A.Q6J("value",a),A.xp6(1),A.hij(" ",a.name," ")}}function ve(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-form-field",6),A.TgZ(1,"input",7),A.NdJ("keyup",function(e){return A.CHM(i),A.oxw(2).updatedSerVal(e)}),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"mat-autocomplete",8,9),A.TgZ(5,"mat-option",10),A.NdJ("onSelectionChange",function(){return A.CHM(i),A.oxw(2).onSelectedService("NOT_SELECTED")}),A._uU(6),A.ALo(7,"translate"),A.qZA(),A.TgZ(8,"mat-option",10),A.NdJ("onSelectionChange",function(){return A.CHM(i),A.oxw(2).onSelectedService("ALL")}),A._uU(9),A.ALo(10,"translate"),A.qZA(),A.YNc(11,me,2,2,"mat-option",11),A.ALo(12,"async"),A.qZA(),A.qZA()}if(2&e){var a=A.MAs(4),n=A.oxw(2);A.xp6(1),A.s9C("placeholder",A.lcZ(2,9,"FACILITY_DETAIL.SERVICE_CONFIG.SERVICE_SELECT")),A.Q6J("formControl",n.serviceField)("matAutocomplete",a),A.xp6(2),A.Q6J("displayWith",n.serviceDisplayFn.bind(n)),A.xp6(2),A.Q6J("value","NOT_SELECTED"),A.xp6(1),A.hij(" ",A.lcZ(7,11,"FACILITY_DETAIL.SERVICE_CONFIG.NOT_SELECTED")," "),A.xp6(2),A.Q6J("value","ALL"),A.xp6(1),A.hij(" ",A.lcZ(10,13,"FACILITY_DETAIL.SERVICE_CONFIG.ALL")," "),A.xp6(2),A.Q6J("ngForOf",A.lcZ(12,15,n.filteredServices))}}function Ae(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-option",10),A.NdJ("onSelectionChange",function(){var e=A.CHM(i).$implicit;return A.oxw(3).onSelectedResource(e)}),A._uU(1),A.qZA()}if(2&e){var a=t.$implicit;A.Q6J("value",a),A.xp6(1),A.hij(" ",a.name," ")}}function Se(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-form-field",6),A.TgZ(1,"input",12),A.NdJ("keyup",function(e){return A.CHM(i),A.oxw(2).updatedResVal(e)}),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"mat-autocomplete",8,9),A.YNc(5,Ae,2,2,"mat-option",11),A.ALo(6,"async"),A.qZA(),A.qZA()}if(2&e){var a=A.MAs(4),n=A.oxw(2);A.xp6(1),A.s9C("placeholder",A.lcZ(2,5,"FACILITY_DETAIL.SERVICE_CONFIG.RES_SELECT")),A.Q6J("matAutocomplete",a)("formControl",n.resourceField),A.xp6(2),A.Q6J("displayWith",n.resourceDisplayFn.bind(n)),A.xp6(2),A.Q6J("ngForOf",A.lcZ(6,7,n.filteredResources))}}function Ie(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-option",10),A.NdJ("onSelectionChange",function(){var e=A.CHM(i).$implicit;return A.oxw(3).onSelectedGroup(e)}),A._uU(1),A.qZA()}if(2&e){var a=t.$implicit;A.Q6J("value",a),A.xp6(1),A.hij(" ",a.name," ")}}function Te(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-form-field",6),A.TgZ(1,"input",12),A.NdJ("keyup",function(e){return A.CHM(i),A.oxw(2).updatedGroupVal(e)}),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"mat-autocomplete",13,9),A.YNc(5,Ie,2,2,"mat-option",11),A.ALo(6,"async"),A.qZA(),A.qZA()}if(2&e){var a=A.MAs(4),n=A.oxw(2);A.xp6(1),A.s9C("placeholder",A.lcZ(2,5,"FACILITY_DETAIL.SERVICE_CONFIG.GROUP_SELECT")),A.Q6J("matAutocomplete",a)("formControl",n.groupField),A.xp6(2),A.Q6J("displayWith",n.groupDisplayFn.bind(n)),A.xp6(2),A.Q6J("ngForOf",A.lcZ(6,7,n.filteredGroups))}}function ye(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-option",10),A.NdJ("onSelectionChange",function(){var e=A.CHM(i).$implicit;return A.oxw(3).onSelectedMember(e)}),A._uU(1),A.ALo(2,"userFullName"),A.qZA()}if(2&e){var a=t.$implicit;A.Q6J("value",a),A.xp6(1),A.hij(" ",A.lcZ(2,2,a.user)," ")}}function be(e,t){if(1&e&&(A.TgZ(0,"mat-form-field",6),A._UZ(1,"input",14),A.ALo(2,"translate"),A.TgZ(3,"mat-autocomplete",8,9),A.YNc(5,ye,3,4,"mat-option",11),A.ALo(6,"async"),A.qZA(),A.qZA()),2&e){var i=A.MAs(4),a=A.oxw(2);A.xp6(1),A.s9C("placeholder",A.lcZ(2,5,"FACILITY_DETAIL.SERVICE_CONFIG.MEMBER_SELECT")),A.Q6J("formControl",a.memberField)("matAutocomplete",i),A.xp6(2),A.Q6J("displayWith",a.memberDisplayFn.bind(a)),A.xp6(2),A.Q6J("ngForOf",A.lcZ(6,7,a.filteredMembers))}}function Ee(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"div",3),A.YNc(1,ve,13,17,"mat-form-field",4),A.TgZ(2,"mat-checkbox",5),A.NdJ("change",function(e){return A.CHM(i),A.oxw().onOfferAllServices(e)}),A._uU(3),A.ALo(4,"translate"),A.qZA(),A.YNc(5,Se,7,9,"mat-form-field",4),A.YNc(6,Te,7,9,"mat-form-field",4),A.YNc(7,be,7,9,"mat-form-field",4),A.qZA()}if(2&e){var a=A.oxw();A.xp6(1),A.Q6J("ngIf",void 0!==a.services),A.xp6(2),A.hij(" ",A.lcZ(4,5,"FACILITY_DETAIL.SERVICE_CONFIG.ALL_SERVICES")," "),A.xp6(2),A.Q6J("ngIf",void 0!==a.resources&&0!==a.resources.length),A.xp6(1),A.Q6J("ngIf",void 0!==a.selectedResource&&void 0!==a.groups&&0!==a.groups.length),A.xp6(1),A.Q6J("ngIf",void 0!==a.selectedGroup&&void 0!==a.members&&0!==a.members.length)}}function Ze(e,t){if(1&e&&A._UZ(0,"perun-web-apps-service-configurator",15),2&e){var i=A.oxw();A.Q6J("facility",i.facility)("resource",i.selectedResource)("group",i.selectedGroup)("service",i.selectedService)("member",i.selectedMember)}}var Ce=function(){var e=function(){function e(t,i,a,n,r,l,o){var c=this;s(this,e),this.route=t,this.facilityManager=i,this.resourceManager=a,this.serviceManager=n,this.membersManager=r,this.namePipe=l,this.translate=o,this.selectedService="NOT_SELECTED",this.attrNames=[],this.serviceField=new re.NI,this.resourceField=new re.NI,this.groupField=new re.NI,this.memberField=new re.NI,this.allowedStatuses=["INVALID","VALID"],this.translate.get("FACILITY_DETAIL.SERVICE_CONFIG.ALL").subscribe(function(e){return c.serviceAllTranslation=e}),this.translate.get("FACILITY_DETAIL.SERVICE_CONFIG.NOT_SELECTED").subscribe(function(e){return c.serviceNotSelectedTranslation=e})}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.route.parent.params.subscribe(function(t){e.facilityManager.getFacilityById(t.facilityId).subscribe(function(t){e.facility=t,e.facilityManager.getAssignedResourcesForFacility(t.id).subscribe(function(t){return e.resources=t}),e.serviceManager.getAssignedServices(t.id).subscribe(function(t){return e.services=t})})}),this.filteredServices=this.serviceField.valueChanges.pipe((0,le.O)(""),(0,oe.U)(function(t){return e._filterServices(t)})),this.filteredResources=this.resourceField.valueChanges.pipe((0,le.O)(""),(0,oe.U)(function(t){return e._filterResources(t)})),this.filteredGroups=this.groupField.valueChanges.pipe((0,le.O)(""),(0,oe.U)(function(t){return e._filterGroups(t)})),this.filteredMembers=this.memberField.valueChanges.pipe((0,le.O)(""),(0,oe.U)(function(t){return e._filterMembers(t)}))}},{key:"onSelectedService",value:function(e){this.selectedService=e}},{key:"onSelectedResource",value:function(e){var t=this;this.selectedResource=e,void 0!==this.selectedResource?(this.resourceManager.getAssignedGroups(this.selectedResource.id).subscribe(function(e){return t.groups=e}),this.selectedGroup=void 0,this.selectedMember=void 0):this.groups=void 0}},{key:"onOfferAllServices",value:function(e){var t=this;e.checked||this.serviceManager.getAssignedServices(this.facility.id).subscribe(function(e){return t.services=e})}},{key:"onSelectedGroup",value:function(e){var t=this;this.selectedGroup=e,void 0!==this.selectedGroup?(this.membersManager.getCompleteRichMembersForGroup(this.selectedGroup.id,!1,this.allowedStatuses,this.attrNames).subscribe(function(e){return t.members=e}),this.selectedMember=void 0):this.members=void 0}},{key:"onSelectedMember",value:function(e){this.selectedMember=e}},{key:"_filterServices",value:function(e){var t=e.toString().toLowerCase();return this.services.filter(function(e){return e.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)})}},{key:"_filterResources",value:function(e){var t=e.toString().toLowerCase();return this.resources.filter(function(e){return e.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)})}},{key:"_filterGroups",value:function(e){var t=e.toString().toLowerCase();return this.groups.filter(function(e){return e.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)})}},{key:"_filterMembers",value:function(e){var t=this,i=e.toString().toLowerCase();return this.members.filter(function(e){return t.namePipe.transform(e.user).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(i)})}},{key:"serviceDisplayFn",value:function(e){if(null!==e)return"ALL"===e?this.serviceAllTranslation:"NOT_SELECTED"===e?this.serviceNotSelectedTranslation:e.name}},{key:"resourceDisplayFn",value:function(e){if(null!==e)return e.name}},{key:"groupDisplayFn",value:function(e){if(null!==e)return e.name}},{key:"memberDisplayFn",value:function(e){if(null!==e)return this.namePipe.transform(e.user)}},{key:"updatedSerVal",value:function(e){""===e.target.value&&(this.selectedService="NOT_SELECTED")}},{key:"updatedResVal",value:function(e){""===e.target.value&&(this.groups=void 0,this.members=void 0)}},{key:"updatedGroupVal",value:function(e){""===e.target.value&&(this.members=void 0)}},{key:"updatedMemVal",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(c.gz),A.Y36(f.IQ),A.Y36(f.xk),A.Y36(f.KK),A.Y36(f.uq),A.Y36(ce.dp),A.Y36(_.sK))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-service-config"]],decls:6,vars:5,consts:[[1,"page-subtitle"],["class","col-12 col-lg-6 mb-2",4,"ngIf"],[3,"facility","resource","group","service","member",4,"ngIf"],[1,"col-12","col-lg-6","mb-2"],["class","w-100",4,"ngIf"],[3,"change"],[1,"w-100"],["type","text","matInput","",3,"placeholder","formControl","matAutocomplete","keyup"],["autoActiveFirstOption","",3,"displayWith"],["auto","matAutocomplete"],[3,"value","onSelectionChange"],[3,"value","onSelectionChange",4,"ngFor","ngForOf"],["type","text","matInput","",3,"placeholder","matAutocomplete","formControl","keyup"],["autoActiveFirstOption","",3,"ngClass","displayWith"],["type","text","matInput","",3,"placeholder","formControl","matAutocomplete"],[3,"facility","resource","group","service","member"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.YNc(4,Ee,8,7,"div",1),A.YNc(5,Ze,1,5,"perun-web-apps-service-configurator",2),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,3,"FACILITY_DETAIL.SERVICE_CONFIG.TITLE")),A.xp6(2),A.Q6J("ngIf",!!t.facility),A.xp6(1),A.Q6J("ngIf",!!t.facility))},directives:[o.O5,ue.oG,de.KE,he.Nt,re.Fj,fe.ZL,re.JJ,re.oH,fe.XC,pe.ey,o.sg,o.mk],pipes:[_.X$,o.Ov,ge.d],styles:[""]}),e}(),_e=r(489);function Le(e,t){if(1&e&&A._UZ(0,"app-managers-page",1),2&e){var i=A.oxw();A.Q6J("complementaryObject",i.facility)("complementaryObjectType",i.type)("theme",i.theme)("availableRoles",i.availableRoles)}}var ke=function(){var e=function(){function e(t,i,a){s(this,e),this.facilityService=t,this.route=i,this.guiAuthResolver=a,this.availableRoles=[],this.selected="user",this.type="Facility",this.theme="facility-theme"}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.route.parent.parent.params.subscribe(function(t){e.facilityService.getFacilityById(t.facilityId).subscribe(function(t){e.facility=t})}),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Facility")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(f.IQ),A.Y36(c.gz),A.Y36(g.x4))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-perun-web-apps-facility-settings-managers"]],hostVars:2,hostBindings:function(e,t){2&e&&A.ekj("router-component",t.true)},decls:1,vars:1,consts:[[3,"complementaryObject","complementaryObjectType","theme","availableRoles",4,"ngIf"],[3,"complementaryObject","complementaryObjectType","theme","availableRoles"]],template:function(e,t){1&e&&A.YNc(0,Le,1,4,"app-managers-page",0),2&e&&A.Q6J("ngIf",t.facility)},directives:[o.O5,_e.s],styles:[""]}),e}(),Oe=r(60611),xe=r(4230),Re=r(60547),De=r(4786);function Ne(e,t){1&e&&A._UZ(0,"mat-spinner",6)}function we(e,t){1&e&&(A.TgZ(0,"mat-option",19),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"DIALOGS.ADD_SERVICE_DESTINATION.SELECTION_ALL")))}function Ye(e,t){1&e&&(A.TgZ(0,"mat-option",20),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"DIALOGS.ADD_SERVICE_DESTINATION.NO_SERVICE")))}function Fe(e,t){if(1&e&&(A.TgZ(0,"mat-option",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.Q6J("value",i),A.xp6(1),A.hij(" ",i.name," ")}}function Me(e,t){1&e&&(A.TgZ(0,"mat-error"),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"DIALOGS.ADD_SERVICE_DESTINATION.CHOOSE_SERVICE")," "))}function Ue(e,t){if(1&e&&(A.TgZ(0,"mat-option",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit,a=A.oxw(2);A.Q6J("value",i),A.xp6(1),A.hij(" ",a.getTypeForView(i)," ")}}function qe(e,t){1&e&&(A.TgZ(0,"mat-error"),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"DIALOGS.ADD_SERVICE_DESTINATION.REQUIRED_FIELD")," "))}function Je(e,t){1&e&&(A.TgZ(0,"mat-error"),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"DIALOGS.ADD_SERVICE_DESTINATION.INVALID_DESTINATION")," "))}function Qe(e,t){if(1&e&&(A.TgZ(0,"mat-form-field",22),A._UZ(1,"input",23),A.YNc(2,qe,3,3,"mat-error",13),A.YNc(3,Je,3,3,"mat-error",13),A.qZA()),2&e){var i=A.oxw(2);A.xp6(1),A.s9C("placeholder",i.getTypeForView(i.selectedType)),A.Q6J("formControl",i.destinationControl),A.xp6(1),A.Q6J("ngIf","host"===i.selectedType&&!i.useFacilityHost&&i.destinationControl.hasError("required")),A.xp6(1),A.Q6J("ngIf",i.destinationControl.hasError("invalidDestination"))}}function Ve(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-checkbox",24),A.NdJ("ngModelChange",function(e){return A.CHM(i),A.oxw(2).useFacilityHost=e}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw(2);A.Q6J("ngModel",a.useFacilityHost),A.xp6(1),A.hij(" ",A.lcZ(2,2,"DIALOGS.ADD_SERVICE_DESTINATION.USE_FACILITY_HOST")," ")}}function He(e,t){if(1&e&&(A.TgZ(0,"mat-option",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.Q6J("value",i),A.xp6(1),A.hij(" ",i," ")}}function Pe(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"div",7),A.TgZ(1,"div",8),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"mat-form-field"),A.TgZ(5,"mat-select",9),A.ALo(6,"translate"),A.YNc(7,we,3,3,"mat-option",10),A.YNc(8,Ye,3,3,"mat-option",11),A.YNc(9,Fe,2,2,"mat-option",12),A.qZA(),A.YNc(10,Me,3,3,"mat-error",13),A.qZA(),A.TgZ(11,"mat-checkbox",14),A.NdJ("change",function(){return A.CHM(i),A.oxw().getServices()})("ngModelChange",function(e){return A.CHM(i),A.oxw().servicesOnFacility=e}),A._uU(12),A.ALo(13,"translate"),A.qZA(),A.TgZ(14,"mat-form-field"),A.TgZ(15,"mat-select",15),A.NdJ("ngModelChange",function(e){return A.CHM(i),A.oxw().selectedType=e})("selectionChange",function(){return A.CHM(i),A.oxw().destinationControl.updateValueAndValidity()}),A.ALo(16,"translate"),A.YNc(17,Ue,2,2,"mat-option",12),A.qZA(),A.qZA(),A.YNc(18,Qe,4,4,"mat-form-field",16),A.YNc(19,Ve,3,4,"mat-checkbox",17),A.TgZ(20,"mat-form-field"),A.TgZ(21,"mat-select",18),A.NdJ("ngModelChange",function(e){return A.CHM(i),A.oxw().selectedPropagation=e}),A.ALo(22,"translate"),A.YNc(23,He,2,2,"mat-option",12),A.qZA(),A.qZA(),A.TgZ(24,"div",8),A._uU(25),A.ALo(26,"translate"),A.qZA(),A.qZA()}if(2&e){var a=A.oxw();A.xp6(2),A.Oqu(A.lcZ(3,18,"DIALOGS.ADD_SERVICE_DESTINATION.DESCRIPTION")),A.xp6(3),A.s9C("placeholder",A.lcZ(6,20,"DIALOGS.ADD_SERVICE_DESTINATION.SERVICE")),A.Q6J("formControl",a.serviceControl),A.xp6(2),A.Q6J("ngIf",0!==a.services.length),A.xp6(1),A.Q6J("ngIf",0===a.services.length),A.xp6(1),A.Q6J("ngForOf",a.services),A.xp6(1),A.Q6J("ngIf",void 0===a.serviceControl.value),A.xp6(1),A.Q6J("ngModel",a.servicesOnFacility),A.xp6(1),A.Oqu(A.lcZ(13,22,"DIALOGS.ADD_SERVICE_DESTINATION.IS_SERVICES_ONLY_ON_FACILITY")),A.xp6(3),A.s9C("placeholder",A.lcZ(16,24,"DIALOGS.ADD_SERVICE_DESTINATION.TYPE")),A.Q6J("ngModel",a.selectedType),A.xp6(2),A.Q6J("ngForOf",a.types),A.xp6(1),A.Q6J("ngIf",!("host"===a.selectedType&&a.useFacilityHost)),A.xp6(1),A.Q6J("ngIf","host"===a.selectedType),A.xp6(2),A.s9C("placeholder",A.lcZ(22,26,"DIALOGS.ADD_SERVICE_DESTINATION.PROPAGATION")),A.Q6J("ngModel",a.selectedPropagation),A.xp6(2),A.Q6J("ngForOf",a.propagations),A.xp6(2),A.hij(" ",A.lcZ(26,28,"DIALOGS.ADD_SERVICE_DESTINATION.PROPAGATION_TYPE_"+a.selectedPropagation)," ")}}var Be=function(){var e=function(){function e(t,i,a,n){s(this,e),this.dialogRef=t,this.data=i,this.facilitiesManager=a,this.servicesManager=n,this.services=[],this.types=["host","user@host","user@host:port","user@host-windows","host-windows-proxy","url","email","semail","service-specific"],this.selectedType="host",this.propagations=["PARALLEL","DUMMY"],this.selectedPropagation="PARALLEL",this.useFacilityHost=!1,this.loading=!1,this.emailRegex=new RegExp(p.B2),this.hostPattern=new RegExp("^(?!:\\/\\/)(?=.{1,255}$)((.{1,63}\\.){1,127}(?![0-9]*$)[a-z0-9-]+\\.?)$|^(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)(\\.(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)){3}$"),this.urlPattern=new RegExp("^(https?|ftp|file)://[-a-zA-Z0-9+&@#/%?=~_|!:,.;()*$']*[-a-zA-Z0-9+&@#/%=~_|()*$']$"),this.userAtHostPattern=new RegExp("^[a-z_]([a-z0-9_-]{0,31}|[a-z0-9_-]{0,30}\\$)@(?:(?!:\\/\\/)(?=.{1,255}$)((.{1,63}\\.){1,127}(?![0-9]*$)[a-z0-9-]+\\.?)$|(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)(\\.(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)){3}$)"),this.userAtHostPortPattern=new RegExp("^[a-z_]([a-z0-9_-]{0,31}|[a-z0-9_-]{0,30}\\$)@(?:(?!:\\/\\/)(?=.{1,255}$)((.{1,63}\\.){1,127}(?![0-9]*$)[a-z0-9-]+\\.?)|(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)(\\.(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)){3}):[0-9]+"),this.serviceSpecificPattern=new RegExp("^(?!-)[a-zA-Z0-9-_.:/]*$")}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.serviceControl=new re.NI(void 0,re.kI.required),this.destinationControl=new re.NI("",this.getDestinationValidator()),this.emailControl=new re.NI("",[re.kI.required,re.kI.pattern(this.emailRegex)]),this.facilitiesManager.getHosts(this.data.facility.id).subscribe(function(t){e.hosts=t,e.servicesOnFacility=!0,e.getServices(),e.loading=!1},function(){return e.loading=!1})}},{key:"getDestinationValidator",value:function(){var e=this;return function(t){if(!t.value)return null;var i;switch(e.selectedType){case"host":case"host-windows-proxy":i=e.hostPattern;break;case"email":case"semail":i=e.emailRegex;break;case"url":i=e.urlPattern;break;case"user@host":case"user@host-windows":i=e.userAtHostPattern;break;case"user@host:port":i=e.userAtHostPortPattern;break;case"service-specific":i=e.serviceSpecificPattern;break;default:return null}return i.test(t.value)?null:{invalidDestination:{value:t.value}}}}},{key:"onCancel",value:function(){this.dialogRef.close()}},{key:"onSubmit",value:function(){var e=this;this.loading=!0,"all"===this.serviceControl.value?this.useFacilityHost?this.servicesManager.addDestinationsDefinedByHostsOnFacilityWithListOfServiceAndFacility({services:this.services,facility:this.data.facility.id}).subscribe(function(){e.dialogRef.close(!0)},function(){return e.loading=!1}):this.servicesManager.addDestinationToMultipleServices({services:this.services,facility:this.data.facility.id,destination:this.destinationControl.value,type:this.selectedType,propagationType:this.selectedPropagation}).subscribe(function(){e.dialogRef.close(!0)},function(){return e.loading=!1}):this.useFacilityHost?this.servicesManager.addDestinationsDefinedByHostsOnFacilityWithServiceAndFacility(this.serviceControl.value.id,this.data.facility.id).subscribe(function(){e.dialogRef.close(!0)},function(){return e.loading=!1}):this.servicesManager.addDestination(this.serviceControl.value.id,this.data.facility.id,this.destinationControl.value,this.selectedType,this.selectedPropagation).subscribe(function(){e.dialogRef.close(!0)},function(){return e.loading=!1})}},{key:"getServices",value:function(){var e=this;this.loading=!0,this.servicesOnFacility?this.servicesManager.getAssignedServices(this.data.facility.id).subscribe(function(t){e.services=t},function(){return e.loading=!1}):this.servicesManager.getServices().subscribe(function(t){e.services=t},function(){return e.loading=!1}),this.loading=!1,this.serviceControl.setValue(void 0)}},{key:"getTypeForView",value:function(e){return"semail"===e?"Send Mail":"service-specific"===e?"Service Specific":e}},{key:"invalidDestination",value:function(){return("host"!==this.selectedType||!this.useFacilityHost)&&this.destinationControl.invalid}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(S.so),A.Y36(S.WI),A.Y36(f.IQ),A.Y36(f.KK))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-perun-web-apps-add-services-destination-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","","class","dialog-container",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content","",1,"dialog-container"],[1,"font-italic"],["required","",3,"formControl","placeholder"],["value","all",4,"ngIf"],["value","noService",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"ngModel","change","ngModelChange"],[3,"ngModel","placeholder","ngModelChange","selectionChange"],["class","w-100",4,"ngIf"],[3,"ngModel","ngModelChange",4,"ngIf"],[3,"ngModel","placeholder","ngModelChange"],["value","all"],["value","noService"],[3,"value"],[1,"w-100"],["matInput","","required","",3,"formControl","placeholder"],[3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.YNc(4,Ne,1,0,"mat-spinner",1),A.YNc(5,Pe,27,30,"div",2),A.TgZ(6,"div",3),A.TgZ(7,"button",4),A.NdJ("click",function(){return t.onCancel()}),A._uU(8),A.ALo(9,"translate"),A.qZA(),A.TgZ(10,"button",5),A.NdJ("click",function(){return t.onSubmit()}),A._uU(11),A.ALo(12,"translate"),A.qZA(),A.qZA(),A.qZA()),2&e&&(A.Tol(t.data.theme),A.xp6(2),A.Oqu(A.lcZ(3,9,"DIALOGS.ADD_SERVICE_DESTINATION.TITLE")),A.xp6(2),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(3),A.hij(" ",A.lcZ(9,11,"DIALOGS.ADD_SERVICE_DESTINATION.CANCEL")," "),A.xp6(2),A.Q6J("disabled",t.loading||t.invalidDestination()||t.serviceControl.invalid||"noService"===t.serviceControl.value),A.xp6(1),A.hij(" ",A.lcZ(12,13,"DIALOGS.ADD_SERVICE_DESTINATION.ADD")," "))},directives:[S.uh,o.O5,S.H8,C.lW,y.$g,S.xY,de.KE,De.gD,re.Q7,re.JJ,re.oH,o.sg,ue.oG,re.On,pe.ey,de.TO,he.Nt,re.Fj],pipes:[_.X$],styles:[""],data:{animation:[d.BQ]}}),e}(),Ge=r(59403),ze=r(19139),$e=r(94357);function je(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",8),A.NdJ("click",function(){return A.CHM(i),A.oxw().addDestination()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"FACILITY_DETAIL.SERVICES_DESTINATIONS.ADD")," "))}function Ke(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",9),A.NdJ("click",function(){return A.CHM(i),A.oxw().removeDestination()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selected.selected.length),A.xp6(1),A.hij(" ",A.lcZ(2,2,"FACILITY_DETAIL.SERVICES_DESTINATIONS.REMOVE")," ")}}function We(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",10),A.NdJ("click",function(){return A.CHM(i),A.oxw().onAllow()}),A.TgZ(1,"mat-icon"),A._uU(2," check_circle_outline "),A.qZA(),A._uU(3),A.ALo(4,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selected.selected.length||a.allSelectedAllowed()),A.xp6(3),A.hij(" ",A.lcZ(4,2,"FACILITY_DETAIL.SERVICES_DESTINATIONS.ALLOW")," ")}}function Xe(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",10),A.NdJ("click",function(){return A.CHM(i),A.oxw().onBlock()}),A.TgZ(1,"mat-icon"),A._uU(2," block "),A.qZA(),A._uU(3),A.ALo(4,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selected.selected.length||a.allSelectedBlocked()),A.xp6(3),A.hij(" ",A.lcZ(4,2,"FACILITY_DETAIL.SERVICES_DESTINATIONS.BLOCK")," ")}}function et(e,t){1&e&&A._UZ(0,"mat-spinner",11)}function tt(e,t){if(1&e&&A._UZ(0,"app-perun-web-apps-destination-list",12),2&e){var i=A.oxw();A.Q6J("tableId",i.tableId)("filterValue",i.filterValue)("destinations",i.destinations)("selection",i.selected)("displayedColumns",i.displayedColumns)}}var it=function(){var e=function(){function e(t,i,a,n,r,l,o,c){s(this,e),this.dialog=t,this.facilitiesManager=i,this.servicesManager=a,this.translate=n,this.notificator=r,this.route=l,this.authResolver=o,this.serviceManager=c,this.selected=new xe.Ov(!0,[]),this.displayedColumns=["select","destinationId","service","destination","type","propagationType"],this.filterValue="",this.tableId=Oe.Cf}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.parent.params.subscribe(function(t){e.facilitiesManager.getFacilityById(t.facilityId).subscribe(function(t){e.facility=t,e.refreshTable()})})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.servicesManager.getAllRichDestinationsForFacility(this.facility.id).subscribe(function(t){e.destinations=t,e.selected.clear(),e.setAuthRights(),e.loading=!1})}},{key:"setAuthRights",value:function(){this.addAuth=this.authResolver.isAuthorized("addDestination_Service_Facility_Destination_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeDestination_Service_Facility_Destination_policy",[this.facility]),this.allowAuth=this.authResolver.isAuthorized("unblockServiceOnDestination_Service_int_policy",[this.facility]),this.blockAuth=this.authResolver.isAuthorized("blockServiceOnDestination_Service_int_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","destinationId","service","destination","type","status","propagationType"]:["destinationId","service","destination","type","status","propagationType"]}},{key:"addDestination",value:function(){var e=this,t=(0,p.kZ)();t.width="600px",t.data={facility:this.facility,theme:"facility-theme"},this.dialog.open(Be,t).afterClosed().subscribe(function(t){t&&e.translate.get("FACILITY_DETAIL.SERVICES_DESTINATIONS.ADD_SUCCESS").subscribe(function(t){e.refreshTable(),e.notificator.showSuccess(t)})})}},{key:"removeDestination",value:function(){var e=this,t=(0,p.kZ)();t.width="600px",t.data={destinations:this.selected.selected,theme:"facility-theme"},this.dialog.open(Re.u,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}},{key:"blockServiceOnDestinations",value:function(e){var t=this;if(0===e.length)return this.notificator.showSuccess(this.translate.instant("FACILITY_DETAIL.SERVICES_DESTINATIONS.BLOCK_SUCCESS")),void this.refreshTable();var i=e.pop();this.serviceManager.blockServiceOnDestination(i.service.id,i.id).subscribe(function(){t.blockServiceOnDestinations(e)},function(){return t.loading=!1})}},{key:"onBlock",value:function(){this.loading=!0,this.blockServiceOnDestinations(this.selected.selected)}},{key:"allowServiceOnDestinations",value:function(e){var t=this;if(0===e.length)return this.notificator.showSuccess(this.translate.instant("FACILITY_DETAIL.SERVICES_DESTINATIONS.ALLOW_SUCCESS")),void this.refreshTable();var i=e.pop();this.serviceManager.unblockServiceOnDestinationById(i.service.id,i.id).subscribe(function(){t.allowServiceOnDestinations(e)},function(){return t.loading=!1})}},{key:"onAllow",value:function(){this.loading=!0,this.allowServiceOnDestinations(this.selected.selected)}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"allSelectedAllowed",value:function(){return this.selected.selected.reduce(function(e,t){return e&&!t.blocked},!0)}},{key:"allSelectedBlocked",value:function(){return this.selected.selected.reduce(function(e,t){return e&&t.blocked},!0)}}]),e}();return e.id="FacilityServicesDestinationsComponent",e.\u0275fac=function(t){return new(t||e)(A.Y36(S.uw),A.Y36(f.IQ),A.Y36(f.KK),A.Y36(_.sK),A.Y36(g.V6),A.Y36(c.gz),A.Y36(g.x4),A.Y36(f.KK))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-perun-web-apps-facility-services-destinations"]],hostVars:2,hostBindings:function(e,t){2&e&&A.ekj("router-component",t.true)},decls:12,vars:10,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent","class","mr-2",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2",3,"disabled","click",4,"ngIf"],["mat-stroked-button","","class","mr-2",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","filterValue","destinations","selection","displayedColumns",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2",3,"click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],["mat-stroked-button","",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"tableId","filterValue","destinations","selection","displayedColumns"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"perun-web-apps-refresh-button",1),A.NdJ("refresh",function(){return t.refreshTable()}),A.qZA(),A.YNc(5,je,3,3,"button",2),A.YNc(6,Ke,3,4,"button",3),A.YNc(7,We,5,4,"button",4),A.YNc(8,Xe,5,4,"button",4),A.TgZ(9,"perun-web-apps-immediate-filter",5),A.NdJ("filter",function(e){return t.applyFilter(e)}),A.qZA(),A.YNc(10,et,1,0,"mat-spinner",6),A.YNc(11,tt,1,5,"app-perun-web-apps-destination-list",7),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,8,"FACILITY_DETAIL.SERVICES_DESTINATIONS.TITLE")),A.xp6(3),A.Q6J("ngIf",!t.loading&&t.addAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.removeAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.allowAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.blockAuth),A.xp6(1),A.Q6J("placeholder","FACILITY_DETAIL.SERVICES_DESTINATIONS.FILTER"),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[Ge.t,o.O5,ze.L,C.lW,b.Hw,y.$g,$e.q],pipes:[_.X$],styles:[""]}),e}(),at=r(17767);function nt(e,t){1&e&&A._UZ(0,"mat-spinner",3)}function st(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"div"),A.TgZ(1,"perun-web-apps-immediate-filter",4),A.NdJ("filter",function(e){return A.CHM(i),A.oxw().applyFilter(e)}),A.qZA(),A.TgZ(2,"div",5),A._UZ(3,"perun-web-apps-owners-list",6),A.qZA(),A.TgZ(4,"div",7),A.TgZ(5,"button",8),A.NdJ("click",function(){return A.CHM(i),A.oxw().onCancel()}),A._uU(6),A.ALo(7,"translate"),A.qZA(),A.TgZ(8,"button",9),A.NdJ("click",function(){return A.CHM(i),A.oxw().onAdd()}),A._uU(9),A.ALo(10,"translate"),A.qZA(),A.qZA(),A.qZA()}if(2&e){var a=A.oxw();A.xp6(1),A.Q6J("placeholder","DIALOGS.ADD_OWNERS.FILTER"),A.xp6(2),A.Q6J("filterValue",a.filterValue)("tableId",a.tableId)("owners",a.owners)("selection",a.selection),A.xp6(3),A.hij(" ",A.lcZ(7,8,"DIALOGS.ADD_OWNERS.CANCEL")," "),A.xp6(2),A.Q6J("disabled",0===a.selection.selected.length||a.loading),A.xp6(1),A.hij(" ",A.lcZ(10,10,"DIALOGS.ADD_OWNERS.ADD")," ")}}var rt=function(){var e=function(){function e(t,i,a,n,r,l){var o=this;s(this,e),this.dialogRef=t,this.data=i,this.notificator=a,this.translate=n,this.ownersManagerService=r,this.facilitiesManagerService=l,this.extSources=[],this.selection=new xe.Ov(!0,[]),this.filterValue="",this.tableId=Oe.BV,this.owners=[],this.translate.get("DIALOGS.ADD_OWNERS.SUCCESS").subscribe(function(e){return o.successMessage=e})}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.theme=this.data.theme,this.loading=!0,this.ownersManagerService.getAllOwners().subscribe(function(t){e.owners=t.filter(function(t){return!e.data.forbiddenOwners.includes(t.id)}),e.loading=!1},function(){return e.loading=!1})}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"onAdd",value:function(){var e=this;this.loading=!0,0!==this.selection.selected.length?this.facilitiesManagerService.addFacilityOwner(this.data.facilityId,this.selection.selected.pop().id).subscribe(function(){return e.onAdd()},function(){return e.loading=!1}):(this.loading=!1,this.notificator.showSuccess(this.successMessage),this.dialogRef.close(!0))}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(S.so),A.Y36(S.WI),A.Y36(g.V6),A.Y36(_.sK),A.Y36(f.aC),A.Y36(f.IQ))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-add-facility-owner-dialog"]],decls:6,vars:8,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[1,"font-size-1rem",3,"placeholder","filter"],["mat-dialog-content",""],[3,"filterValue","tableId","owners","selection"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"]],template:function(e,t){1&e&&(A.TgZ(0,"h1",0),A._uU(1),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"div"),A.YNc(4,nt,1,0,"mat-spinner",1),A.YNc(5,st,11,12,"div",2),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,6,"DIALOGS.ADD_OWNERS.TITLE")),A.xp6(2),A.Tol(t.theme),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[S.uh,o.O5,y.$g,ze.L,S.xY,at.Q,S.H8,C.lW],pipes:[_.X$],styles:[""]}),e}(),lt=r(67033);function ot(e,t){1&e&&A._UZ(0,"mat-spinner",6)}function ct(e,t){1&e&&A._UZ(0,"th",15)}function ut(e,t){if(1&e&&(A.TgZ(0,"td",16),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.hij(" ",i.name," ")}}function dt(e,t){1&e&&A._UZ(0,"tr",17)}function ht(e,t){1&e&&A._UZ(0,"tr",18)}function ft(e,t){if(1&e&&(A.TgZ(0,"div",7),A.TgZ(1,"p"),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"div",8),A._uU(5),A.ALo(6,"translate"),A.qZA(),A.TgZ(7,"table",9),A.ynx(8,10),A.YNc(9,ct,1,0,"th",11),A.YNc(10,ut,2,1,"td",12),A.BQk(),A.YNc(11,dt,1,0,"tr",13),A.YNc(12,ht,1,0,"tr",14),A.qZA(),A.qZA()),2&e){var i=A.oxw();A.xp6(2),A.hij(" ",A.lcZ(3,5,"DIALOGS.REMOVE_OWNERS.DESCRIPTION")," "),A.xp6(3),A.hij(" ",A.lcZ(6,7,"DIALOGS.REMOVE_OWNERS.ASK")," "),A.xp6(2),A.Q6J("dataSource",i.dataSource),A.xp6(4),A.Q6J("matHeaderRowDef",i.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",i.displayedColumns)}}var pt=function(){var e=function(){function e(t,i,a,n,r){var l=this;s(this,e),this.dialogRef=t,this.data=i,this.notificator=a,this.translate=n,this.facilitiesManagerService=r,this.displayedColumns=["name"],n.get("DIALOGS.REMOVE_OWNERS.SUCCESS").subscribe(function(e){return l.successMessage=e})}return l(e,[{key:"ngOnInit",value:function(){this.dataSource=new lt.by(this.data.owners),this.theme=this.data.theme}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}},{key:"onSubmit",value:function(){var e=this;this.loading=!0,0!==this.data.owners.length?this.facilitiesManagerService.removeFacilityOwner(this.data.facilityId,this.data.owners.pop().id).subscribe(function(){return e.onSubmit()},function(){return e.loading=!1}):(this.loading=!1,this.notificator.showSuccess(this.successMessage),this.dialogRef.close(!0))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(S.so),A.Y36(S.WI),A.Y36(g.V6),A.Y36(_.sK),A.Y36(f.IQ))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-remove-facility-owner-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","warn","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(A.TgZ(0,"h1",0),A._uU(1),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"div"),A.YNc(4,ot,1,0,"mat-spinner",1),A.YNc(5,ft,13,9,"div",2),A.TgZ(6,"div",3),A.TgZ(7,"button",4),A.NdJ("click",function(){return t.onCancel()}),A._uU(8),A.ALo(9,"translate"),A.qZA(),A.TgZ(10,"button",5),A.NdJ("click",function(){return t.onSubmit()}),A._uU(11),A.ALo(12,"translate"),A.qZA(),A.qZA(),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,9,"DIALOGS.REMOVE_OWNERS.TITLE")),A.xp6(2),A.Tol(t.theme),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(3),A.hij(" ",A.lcZ(9,11,"DIALOGS.REMOVE_OWNERS.CANCEL")," "),A.xp6(2),A.Q6J("disabled",t.loading),A.xp6(1),A.hij(" ",A.lcZ(12,13,"DIALOGS.REMOVE_OWNERS.DELETE")," "))},directives:[S.uh,o.O5,S.H8,C.lW,y.$g,S.xY,lt.BZ,lt.w1,lt.fO,lt.Dz,lt.as,lt.nj,lt.ge,lt.ev,lt.XQ,lt.Gk],pipes:[_.X$],styles:[""]}),e}();function gt(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"perun-web-apps-refresh-button",7),A.NdJ("refresh",function(){return A.CHM(i),A.oxw().refreshTable()}),A.qZA()}}function mt(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",8),A.NdJ("click",function(){return A.CHM(i),A.oxw().onCreate()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"FACILITY_DETAIL.SETTINGS.OWNERS.ADD"),"\n"))}function vt(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",9),A.NdJ("click",function(){return A.CHM(i),A.oxw().onRemove()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selection.selected.length),A.xp6(1),A.hij(" ",A.lcZ(2,2,"FACILITY_DETAIL.SETTINGS.OWNERS.DELETE"),"\n")}}function At(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"perun-web-apps-immediate-filter",10),A.NdJ("filter",function(e){return A.CHM(i),A.oxw().applyFilter(e)}),A.qZA()}2&e&&A.Q6J("placeholder","VO_MANAGEMENT.FILTER_PLACEHOLDER")}function St(e,t){1&e&&A._UZ(0,"mat-spinner",11)}function It(e,t){if(1&e&&A._UZ(0,"perun-web-apps-owners-list",12),2&e){var i=A.oxw();A.Q6J("tableId",i.tableId)("filterValue",i.filterValue)("owners",i.owners)("displayedColumns",i.displayedColumns)("selection",i.selection)}}var Tt=function(){var e=function(){function e(t,i,a,n){s(this,e),this.facilitiesManagerService=t,this.route=i,this.dialog=a,this.authResolver=n,this.owners=[],this.selection=new xe.Ov(!0,[]),this.displayedColumns=["id","name","contact","type"],this.tableId=Oe.zp}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.filterValue="",this.route.parent.parent.params.subscribe(function(t){e.facilityId=parseInt(t.facilityId,10),e.facility={id:e.facilityId,beanName:"Facility"},e.refreshTable()})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.selection.clear(),this.facilitiesManagerService.getFacilityOwners(this.facilityId).subscribe(function(t){e.owners=t,e.setAuthRights(),e.loading=!1})}},{key:"setAuthRights",value:function(){this.addAuth=this.authResolver.isAuthorized("addOwner_Facility_Owner_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeOwner_Facility_Owner_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","id","name","contact","type"]:["id","name","contact","type"]}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"onCreate",value:function(){var e=this,t=(0,p.kZ)();t.width="800px",t.data={theme:"facility-theme",facilityId:this.facilityId,forbiddenOwners:this.owners.map(function(e){return e.id})},this.dialog.open(rt,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}},{key:"onRemove",value:function(){var e=this,t=(0,p.kZ)();t.width="600px",t.data={theme:"facility-theme",owners:this.selection.selected,facilityId:this.facilityId},this.dialog.open(pt,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(f.IQ),A.Y36(c.gz),A.Y36(S.uw),A.Y36(g.x4))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-settings-owners"]],decls:9,vars:9,consts:[[1,"page-subtitle"],[3,"refresh",4,"ngIf"],["class","mr-2","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","filterValue","owners","displayedColumns","selection",4,"ngIf"],[3,"refresh"],["color","accent","mat-flat-button","",1,"mr-2",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[3,"placeholder","filter"],[1,"ml-auto","mr-auto"],[3,"tableId","filterValue","owners","displayedColumns","selection"]],template:function(e,t){1&e&&(A.TgZ(0,"h1",0),A._uU(1),A.ALo(2,"translate"),A.qZA(),A.YNc(3,gt,1,0,"perun-web-apps-refresh-button",1),A.YNc(4,mt,3,3,"button",2),A.YNc(5,vt,3,4,"button",3),A.YNc(6,At,1,1,"perun-web-apps-immediate-filter",4),A.YNc(7,St,1,0,"mat-spinner",5),A.YNc(8,It,1,5,"perun-web-apps-owners-list",6)),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,7,"FACILITY_DETAIL.SETTINGS.OWNERS.TITLE")),A.xp6(2),A.Q6J("ngIf",!t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.addAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.removeAuth),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[o.O5,Ge.t,C.lW,ze.L,y.$g,at.Q],pipes:[_.X$],styles:[""]}),e}();function yt(e,t){1&e&&A._UZ(0,"mat-spinner",7)}function bt(e,t){1&e&&(A.TgZ(0,"mat-error"),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"DIALOGS.ADD_HOST.EMPTY_MESSAGE")," "))}function Et(e,t){if(1&e&&(A.TgZ(0,"mat-error"),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e){var i=A.oxw(2);A.xp6(1),A.AsE(" ",A.lcZ(2,2,"DIALOGS.ADD_HOST.INVALID_HOST"),"",i.hostsCtrl.getError("invalidHost").value," ")}}function Zt(e,t){if(1&e&&(A.TgZ(0,"div",8),A.TgZ(1,"mat-form-field"),A.TgZ(2,"textarea",9),A._uU(3,"      "),A.qZA(),A.YNc(4,bt,3,3,"mat-error",10),A.YNc(5,Et,3,4,"mat-error",10),A.qZA(),A.TgZ(6,"div",11),A._uU(7),A.ALo(8,"translate"),A.qZA(),A.qZA()),2&e){var i=A.oxw();A.xp6(2),A.Q6J("formControl",i.hostsCtrl),A.xp6(2),A.Q6J("ngIf",i.hostsCtrl.hasError("required")),A.xp6(1),A.Q6J("ngIf",i.hostsCtrl.hasError("invalidHost")),A.xp6(2),A.Oqu(A.lcZ(8,4,"DIALOGS.ADD_HOST.HINT"))}}var Ct=function(){var e=function(){function e(t,i,a,n,r){s(this,e),this.dialogRef=t,this.data=i,this.facilitiesManager=a,this.notificator=n,this.translate=r,this.loading=!1,this.hostPattern=new RegExp("^(?!:\\/\\/)(?=.{1,255}$)((.{1,63}\\.){1,127}(?![0-9]*$)[a-z0-9-]+\\.?)$|^(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)(\\.(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)){3}$")}return l(e,[{key:"ngOnInit",value:function(){this.theme=this.data.theme,this.facilityName=this.data.facilityName,this.hostsCtrl=new re.NI("",[re.kI.required,this.hostsNameValidator()]),this.hostsCtrl.markAllAsTouched()}},{key:"onAdd",value:function(){var e=this;this.loading=!0;var t,a=[],n=i(this.hostsCtrl.value.split("\n"));try{for(n.s();!(t=n.n()).done;){var s=t.value;a=a.concat(this.parseHostName(s))}}catch(r){n.e(r)}finally{n.f()}this.facilitiesManager.addHosts(this.data.facilityId,a).subscribe(function(){e.notificator.showSuccess(e.translate.instant("DIALOGS.ADD_HOST.SUCCESS")),e.dialogRef.close(!0)},function(){return e.loading=!1})}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}},{key:"hostsNameValidator",value:function(){var e=this;return function(t){var a,n=[],s=i(t.value.split("\n"));try{for(s.s();!(a=s.n()).done;){var r=a.value;n=n.concat(e.parseHostName(r))}}catch(u){s.e(u)}finally{s.f()}var l,o=i(n);try{for(o.s();!(l=o.n()).done;){var c=l.value;if(!e.hostPattern.test(c))return{invalidHost:{value:c}}}}catch(u){o.e(u)}finally{o.f()}return null}}},{key:"parseHostName",value:function(e){var i=new RegExp("[[0-9]+-[0-9]+]","g"),a=e.split(i),n=e.match(i);if(null==n)return""===e?[]:[e];for(var s=[],r=0;r<a.length-1;r++){for(var l=t(this.parseRange(n[r]),2),o=l[0],c=l[1],u=[],d=o;d<=c;d++)u=u.concat(a[r].concat(d.toString()));s=s.concat([u])}return s=s.concat([a[a.length-1]]),this.joinHostNames(s,0)}},{key:"parseRange",value:function(e){var i=t(e.split("-"),2),a=i[0],n=i[1];return[parseInt(a.substring(1,a.length),10),parseInt(n.substring(0,n.length),10)]}},{key:"joinHostNames",value:function(e,t){if(t===e.length-1)return[e[t]];var a,n=this.joinHostNames(e,t+1),s=[],r=i(e[t]);try{for(r.s();!(a=r.n()).done;){var l,o=a.value,c=i(n);try{for(c.s();!(l=c.n()).done;){var u=l.value;s.push(o.concat(u))}}catch(d){c.e(d)}finally{c.f()}}}catch(d){r.e(d)}finally{r.f()}return s}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(S.so),A.Y36(S.WI),A.Y36(f.IQ),A.Y36(g.V6),A.Y36(_.sK))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-add-host-dialog"]],decls:16,vars:19,consts:[["mat-dialog-title",""],[1,"page-subtitle"],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-content","","class","dialog-container",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content","",1,"dialog-container"],["id","facilityAddHost","name","facilityAddHost","rows","8","cols","50","matInput","","required","",1,"md-textarea","form-control",3,"formControl"],[4,"ngIf"],[1,"text-muted"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"h1",1),A._uU(5),A.ALo(6,"translate"),A.qZA(),A.YNc(7,yt,1,0,"mat-spinner",2),A.YNc(8,Zt,9,6,"div",3),A.TgZ(9,"div",4),A.TgZ(10,"button",5),A.NdJ("click",function(){return t.onCancel()}),A._uU(11),A.ALo(12,"translate"),A.qZA(),A.TgZ(13,"button",6),A.NdJ("click",function(){return t.onAdd()}),A._uU(14),A.ALo(15,"translate"),A.qZA(),A.qZA(),A.qZA()),2&e&&(A.Tol(t.theme),A.xp6(2),A.AsE("",t.facilityName,": ",A.lcZ(3,11,"DIALOGS.ADD_HOST.TITLE"),""),A.xp6(3),A.hij("",A.lcZ(6,13,"DIALOGS.ADD_HOST.SUBTITLE"),":"),A.xp6(2),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(3),A.hij(" ",A.lcZ(12,15,"DIALOGS.ADD_HOST.CANCEL"),""),A.xp6(2),A.Q6J("disabled",t.hostsCtrl.invalid||t.loading),A.xp6(1),A.hij(" ",A.lcZ(15,17,"DIALOGS.ADD_HOST.ADD"),""))},directives:[S.uh,o.O5,S.H8,C.lW,y.$g,S.xY,de.KE,he.Nt,re.Fj,re.Q7,re.JJ,re.oH,de.TO],pipes:[_.X$],styles:[""]}),e}();function _t(e,t){1&e&&A._UZ(0,"mat-spinner",6)}function Lt(e,t){1&e&&A._UZ(0,"th",15)}function kt(e,t){if(1&e&&(A.TgZ(0,"td",16),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.hij(" ",i.hostname," ")}}function Ot(e,t){1&e&&A._UZ(0,"tr",17)}function xt(e,t){1&e&&A._UZ(0,"tr",18)}function Rt(e,t){if(1&e&&(A.TgZ(0,"div",7),A.TgZ(1,"p"),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"div",8),A._uU(5),A.ALo(6,"translate"),A.qZA(),A.TgZ(7,"table",9),A.ynx(8,10),A.YNc(9,Lt,1,0,"th",11),A.YNc(10,kt,2,1,"td",12),A.BQk(),A.YNc(11,Ot,1,0,"tr",13),A.YNc(12,xt,1,0,"tr",14),A.qZA(),A.qZA()),2&e){var i=A.oxw();A.xp6(2),A.Oqu(A.lcZ(3,5,"DIALOGS.REMOVE_HOST.DESCRIPTION")),A.xp6(3),A.hij(" ",A.lcZ(6,7,"DIALOGS.REMOVE_HOST.ASK")," "),A.xp6(2),A.Q6J("dataSource",i.dataSource),A.xp6(4),A.Q6J("matHeaderRowDef",i.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",i.displayedColumns)}}var Dt=function(){var e=function(){function e(t,i,a,n,r){s(this,e),this.dialogRef=t,this.data=i,this.facilitiesManager=a,this.notificator=n,this.translate=r,this.displayedColumns=["name"],this.loading=!1}return l(e,[{key:"ngOnInit",value:function(){this.theme=this.data.theme,this.hosts=this.data.hosts,this.dataSource=new lt.by(this.data.hosts)}},{key:"onConfirm",value:function(){var e=this;this.loading=!0,this.facilitiesManager.removeHosts(this.data.facilityId,this.hosts.map(function(e){return e.id})).subscribe(function(){e.notificator.showSuccess(e.translate.instant("DIALOGS.REMOVE_HOST.SUCCESS")),e.dialogRef.close(!0)},function(){return e.loading=!1})}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(S.so),A.Y36(S.WI),A.Y36(f.IQ),A.Y36(g.V6),A.Y36(_.sK))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-remove-host-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(A.TgZ(0,"h1",0),A._uU(1),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"div"),A.YNc(4,_t,1,0,"mat-spinner",1),A.YNc(5,Rt,13,9,"div",2),A.TgZ(6,"div",3),A.TgZ(7,"button",4),A.NdJ("click",function(){return t.onCancel()}),A._uU(8),A.ALo(9,"translate"),A.qZA(),A.TgZ(10,"button",5),A.NdJ("click",function(){return t.onConfirm()}),A._uU(11),A.ALo(12,"translate"),A.qZA(),A.qZA(),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,9,"DIALOGS.REMOVE_HOST.TITLE")),A.xp6(2),A.Tol(t.theme),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(3),A.hij(" ",A.lcZ(9,11,"DIALOGS.REMOVE_HOST.CANCEL"),""),A.xp6(2),A.Q6J("disabled",t.loading),A.xp6(1),A.hij(" ",A.lcZ(12,13,"DIALOGS.REMOVE_HOST.CONFIRM"),""))},directives:[S.uh,o.O5,S.H8,C.lW,y.$g,S.xY,lt.BZ,lt.w1,lt.fO,lt.Dz,lt.as,lt.nj,lt.ge,lt.ev,lt.XQ,lt.Gk],pipes:[_.X$],styles:[""]}),e}(),Nt=r(58623),wt=r(82819),Yt=r(84534),Ft=r(39571);function Mt(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"th",13),A.TgZ(1,"mat-checkbox",14),A.NdJ("change",function(e){A.CHM(i);var t=A.oxw();return e?t.masterToggle():null}),A.qZA(),A.qZA()}if(2&e){var a=A.oxw();A.xp6(1),A.Q6J("aria-label",a.checkboxLabel())("checked",a.selection.hasValue()&&a.isAllSelected())("indeterminate",a.selection.hasValue()&&!a.isAllSelected())}}function Ut(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"td",15),A.TgZ(1,"mat-checkbox",16),A.NdJ("change",function(e){var t=A.CHM(i).$implicit,a=A.oxw();return e?a.selection.toggle(t):null})("click",function(e){return e.stopPropagation()}),A.qZA(),A.qZA()}if(2&e){var a=t.$implicit,n=A.oxw();A.xp6(1),A.Q6J("aria-label",n.checkboxLabel(a))("checked",n.selection.isSelected(a))}}function qt(e,t){1&e&&(A.TgZ(0,"th",17),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.HOSTS_LIST.TABLE_HOST_ID")))}function Jt(e,t){if(1&e&&(A.TgZ(0,"td",15),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.id)}}function Qt(e,t){1&e&&(A.TgZ(0,"th",17),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.HOSTS_LIST.TABLE_HOST_NAME")))}function Vt(e,t){if(1&e&&(A.TgZ(0,"td",18),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.hostname)}}function Ht(e,t){1&e&&A._UZ(0,"tr",19)}var Pt=function(e,t){return["/facilities",e,"hosts",t]};function Bt(e,t){if(1&e&&A._UZ(0,"tr",20),2&e){var i=t.$implicit,a=A.oxw();A.Q6J("perunWebAppsMiddleClickRouterLink",a.disableRouting?null:A.WLB(2,Pt,a.facilityId,i.id))("routerLink",a.disableRouting?null:A.WLB(5,Pt,a.facilityId,i.id))}}function Gt(e,t){1&e&&(A.TgZ(0,"app-alert",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}function zt(e,t){1&e&&(A.TgZ(0,"app-alert",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED.COMPONENTS.HOSTS_LIST.NO_HOST_WARNING"),"\n"))}var $t=function(){var e=function(){function e(t,i){s(this,e),this.authResolver=t,this.tableCheckbox=i,this.hosts=[],this.selection=new xe.Ov(!0,[]),this.disableRouting=!1,this.displayedColumns=["select","id","name"],this.pageSizeOptions=p.f7}return l(e,[{key:"matSort",set:function(e){this.sort=e,this.setDataSource()}},{key:"ngOnChanges",value:function(){this.authResolver.isPerunAdminOrObserver()||(this.displayedColumns=this.displayedColumns.filter(function(e){return"id"!==e})),this.dataSource=new lt.by(this.hosts),this.setDataSource(),this.dataSource.filter=this.filterValue}},{key:"getDataForColumn",value:function(e,t){switch(t){case"id":return e.id.toString();case"name":return e.hostname;default:return""}}},{key:"exportData",value:function(e){(0,p.O6)((0,p.Xn)(this.dataSource.filteredData,this.displayedColumns,this.getDataForColumn,this),e)}},{key:"setDataSource",value:function(){var e=this;this.dataSource&&(this.dataSource.sort=this.sort,this.dataSource.filterPredicate=function(t,i){return(0,p.Sd)(t,i,e.displayedColumns,e.getDataForColumn,e)},this.dataSource.sortData=function(t,i){return(0,p.pR)(t,i,e.getDataForColumn,e)},this.dataSource.paginator=this.child.paginator)}},{key:"isAllSelected",value:function(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.child.paginator.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}},{key:"masterToggle",value:function(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}},{key:"checkboxLabel",value:function(e){return e?"".concat(this.selection.isSelected(e)?"deselect":"select"," row ").concat(e.id+1):(this.isAllSelected()?"select":"deselect")+" all"}},{key:"ngAfterViewInit",value:function(){this.dataSource.paginator=this.child.paginator}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(g.x4),A.Y36(g.UA))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-hosts-list"]],viewQuery:function(e,t){var i;(1&e&&(A.Gf(Nt.YE,7),A.Gf(p.l9,7)),2&e)&&(A.iGM(i=A.CRH())&&(t.matSort=i.first),A.iGM(i=A.CRH())&&(t.child=i.first))},inputs:{hosts:"hosts",selection:"selection",filterValue:"filterValue",tableId:"tableId",facilityId:"facilityId",disableRouting:"disableRouting",displayedColumns:"displayedColumns"},features:[A.TTD],decls:16,vars:9,consts:[[1,"card","mt-3",3,"hidden"],[3,"tableId","dataLength","pageSizeOptions","exportData"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","name"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",3,"perunWebAppsMiddleClickRouterLink","routerLink",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item",3,"perunWebAppsMiddleClickRouterLink","routerLink"],["alert_type","warn"]],template:function(e,t){1&e&&(A.TgZ(0,"div",0),A.TgZ(1,"perun-web-apps-table-wrapper",1),A.NdJ("exportData",function(e){return t.exportData(e)}),A.TgZ(2,"table",2),A.ynx(3,3),A.YNc(4,Mt,2,3,"th",4),A.YNc(5,Ut,2,2,"td",5),A.BQk(),A.ynx(6,6),A.YNc(7,qt,3,3,"th",7),A.YNc(8,Jt,2,1,"td",5),A.BQk(),A.ynx(9,8),A.YNc(10,Qt,3,3,"th",7),A.YNc(11,Vt,2,1,"td",9),A.BQk(),A.YNc(12,Ht,1,0,"tr",10),A.YNc(13,Bt,1,8,"tr",11),A.qZA(),A.qZA(),A.qZA(),A.YNc(14,Gt,3,3,"app-alert",12),A.YNc(15,zt,3,3,"app-alert",12)),2&e&&(A.Q6J("hidden",0===t.dataSource.filteredData.length||0===t.hosts.length),A.xp6(1),A.Q6J("tableId",t.tableId)("dataLength",t.dataSource.filteredData.length)("pageSizeOptions",t.pageSizeOptions),A.xp6(1),A.Q6J("dataSource",t.dataSource),A.xp6(10),A.Q6J("matHeaderRowDef",t.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",t.displayedColumns),A.xp6(1),A.Q6J("ngIf",0===t.dataSource.filteredData.length&&0!==t.hosts.length),A.xp6(1),A.Q6J("ngIf",0===t.hosts.length))},directives:[wt.l,lt.BZ,Nt.YE,lt.w1,lt.fO,lt.Dz,lt.as,lt.nj,o.O5,lt.ge,ue.oG,lt.ev,Nt.nU,lt.XQ,lt.Gk,Yt.YH,c.rH,Ft.w],pipes:[_.X$],styles:[".disable-outline[_ngcontent-%COMP%]{outline:none!important}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}"]}),e}();function jt(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",7),A.NdJ("click",function(){return A.CHM(i),A.oxw().addHost()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"FACILITY_DETAIL.HOSTS.ADD")," "))}function Kt(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",8),A.NdJ("click",function(){return A.CHM(i),A.oxw().removeHost()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selected.selected.length),A.xp6(1),A.hij(" ",A.lcZ(2,2,"FACILITY_DETAIL.HOSTS.REMOVE")," ")}}function Wt(e,t){1&e&&A._UZ(0,"mat-spinner",9)}function Xt(e,t){if(1&e&&A._UZ(0,"app-hosts-list",10),2&e){var i=A.oxw();A.Q6J("tableId",i.tableId)("filterValue",i.filterValue)("hosts",i.hosts)("selection",i.selected)("displayedColumns",i.displayedColumns)("disableRouting",!i.routeAuth)("facilityId",i.facilityId)}}var ei=function(){var e=function(){function e(t,i,a,n){s(this,e),this.dialog=t,this.facilitiesManager=i,this.route=a,this.authResolver=n,this.hosts=[],this.selected=new xe.Ov(!0,[]),this.filterValue="",this.tableId=Oe.eq,this.displayedColumns=["id","name"]}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.route.parent.params.subscribe(function(t){e.facilityId=t.facilityId,e.facilitiesManager.getFacilityById(e.facilityId).subscribe(function(t){e.facility=t,e.refreshTable()})})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.facilitiesManager.getHosts(this.facilityId).subscribe(function(t){e.hosts=t,e.selected.clear(),e.setAuthRights(),e.loading=!1})}},{key:"setAuthRights",value:function(){this.addAuth=this.authResolver.isAuthorized("addHosts_Facility_List<String>_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeHosts_List<Host>_Facility_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","id","name"]:["id","name"],0!==this.hosts.length&&(this.routeAuth=this.authResolver.isAuthorized("getHostById_int_policy",[this.facility,this.hosts[0]]))}},{key:"addHost",value:function(){var e=this,t=(0,p.kZ)();t.width="600px",t.data={facilityId:this.facility.id,facilityName:this.facility.name,theme:"facility-theme"},this.dialog.open(Ct,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}},{key:"removeHost",value:function(){var e=this,t=(0,p.kZ)();t.width="600px",t.data={facilityId:this.facility.id,theme:"facility-theme",hosts:this.selected.selected},this.dialog.open(Dt,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}},{key:"applyFilter",value:function(e){this.filterValue=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(S.uw),A.Y36(f.IQ),A.Y36(c.gz),A.Y36(g.x4))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-hosts"]],decls:10,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent","class","mr-2",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","filterValue","hosts","selection","displayedColumns","disableRouting","facilityId",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2",3,"click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"tableId","filterValue","hosts","selection","displayedColumns","disableRouting","facilityId"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"perun-web-apps-refresh-button",1),A.NdJ("refresh",function(){return t.refreshTable()}),A.qZA(),A.YNc(5,jt,3,3,"button",2),A.YNc(6,Kt,3,4,"button",3),A.TgZ(7,"perun-web-apps-immediate-filter",4),A.NdJ("filter",function(e){return t.applyFilter(e)}),A.qZA(),A.YNc(8,Wt,1,0,"mat-spinner",5),A.YNc(9,Xt,1,7,"app-hosts-list",6),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,6,"FACILITY_DETAIL.HOSTS.TITLE")),A.xp6(3),A.Q6J("ngIf",!t.loading&&t.addAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.removeAuth),A.xp6(1),A.Q6J("placeholder","FACILITY_DETAIL.HOSTS.FILTER"),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[Ge.t,o.O5,ze.L,C.lW,y.$g,$t],pipes:[_.X$],styles:[""]}),e}();function ti(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"th",14),A.TgZ(1,"mat-checkbox",15),A.NdJ("change",function(e){A.CHM(i);var t=A.oxw();return e?t.masterToggle():null}),A.qZA(),A.qZA()}if(2&e){var a=A.oxw();A.xp6(1),A.Q6J("aria-label",a.checkboxLabel())("checked",a.selection.hasValue()&&a.isAllSelected())("indeterminate",a.selection.hasValue()&&!a.isAllSelected())}}function ii(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"td",16),A.TgZ(1,"mat-checkbox",17),A.NdJ("change",function(e){var t=A.CHM(i).$implicit,a=A.oxw();return e?a.selection.toggle(t):null})("click",function(e){return e.stopPropagation()}),A.qZA(),A.qZA()}if(2&e){var a=t.$implicit,n=A.oxw();A.xp6(1),A.Q6J("aria-label",n.checkboxLabel(a))("checked",n.selection.isSelected(a))}}function ai(e,t){1&e&&(A.TgZ(0,"th",18),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.BLACKLIST_LIST.USER_ID")))}function ni(e,t){if(1&e&&(A.TgZ(0,"td",16),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i[1].id)}}function si(e,t){1&e&&(A.TgZ(0,"th",18),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.BLACKLIST_LIST.NAME")))}function ri(e,t){if(1&e&&(A.TgZ(0,"td",19),A._uU(1),A.ALo(2,"userFullName"),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(A.lcZ(2,1,i[1]))}}function li(e,t){1&e&&(A.TgZ(0,"th",18),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.BLACKLIST_LIST.REASON")))}function oi(e,t){if(1&e&&(A.TgZ(0,"td",19),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i[0].description)}}function ci(e,t){1&e&&A._UZ(0,"tr",20)}function ui(e,t){1&e&&A._UZ(0,"tr",21)}function di(e,t){1&e&&(A.TgZ(0,"app-alert",22),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}function hi(e,t){1&e&&(A.TgZ(0,"app-alert",22),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED.COMPONENTS.BLACKLIST_LIST.NO_BANS_WARNING"),"\n"))}var fi=function(){var e=function(){function e(t,i){s(this,e),this.authResolver=t,this.tableCheckbox=i,this.bansOnFacilitiesWithUsers=[],this.selection=new xe.Ov(!0,[]),this.displayedColumns=["select","userId","name","reason"],this.pageSizeOptions=p.f7}return l(e,[{key:"matSort",set:function(e){this.sort=e,this.setDataSource()}},{key:"ngOnChanges",value:function(){this.authResolver.isPerunAdminOrObserver()||(this.displayedColumns=this.displayedColumns.filter(function(e){return"userId"!==e})),this.dataSource=new lt.by(this.bansOnFacilitiesWithUsers),this.setDataSource(),this.dataSource.filter=this.filterValue}},{key:"getDataForColumn",value:function(e,t){switch(t){case"userId":return e[1].id.toString();case"reason":return e[0].description;case"name":return(0,p.hu)(e[1]);default:return""}}},{key:"exportData",value:function(e){(0,p.O6)((0,p.Xn)(this.dataSource.filteredData,this.displayedColumns,this.getDataForColumn,this),e)}},{key:"setDataSource",value:function(){var e=this;this.dataSource&&(this.dataSource.filterPredicate=function(t,i){return(0,p.Sd)(t,i,e.displayedColumns,e.getDataForColumn,e)},this.dataSource.sortData=function(t,i){return(0,p.pR)(t,i,e.getDataForColumn,e)},this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator)}},{key:"isAllSelected",value:function(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.child.paginator.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}},{key:"masterToggle",value:function(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}},{key:"checkboxLabel",value:function(e){return e?"".concat(this.selection.isSelected(e)?"deselect":"select"," row ").concat(e[0].userId+1):(this.isAllSelected()?"select":"deselect")+" all"}},{key:"ngAfterViewInit",value:function(){this.dataSource.paginator=this.child.paginator}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(g.x4),A.Y36(g.UA))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-perun-web-apps-blacklist-list"]],viewQuery:function(e,t){var i;(1&e&&(A.Gf(Nt.YE,7),A.Gf(p.l9,7)),2&e)&&(A.iGM(i=A.CRH())&&(t.matSort=i.first),A.iGM(i=A.CRH())&&(t.child=i.first))},inputs:{bansOnFacilitiesWithUsers:"bansOnFacilitiesWithUsers",selection:"selection",filterValue:"filterValue",tableId:"tableId"},features:[A.TTD],decls:19,vars:9,consts:[[1,"card","mt-3",3,"hidden"],[3,"tableId","dataLength","pageSizeOptions","exportData"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","userId"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","name"],["mat-cell","",4,"matCellDef"],["matColumnDef","reason"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"],["alert_type","warn"]],template:function(e,t){1&e&&(A.TgZ(0,"div",0),A.TgZ(1,"perun-web-apps-table-wrapper",1),A.NdJ("exportData",function(e){return t.exportData(e)}),A.TgZ(2,"table",2),A.ynx(3,3),A.YNc(4,ti,2,3,"th",4),A.YNc(5,ii,2,2,"td",5),A.BQk(),A.ynx(6,6),A.YNc(7,ai,3,3,"th",7),A.YNc(8,ni,2,1,"td",5),A.BQk(),A.ynx(9,8),A.YNc(10,si,3,3,"th",7),A.YNc(11,ri,3,3,"td",9),A.BQk(),A.ynx(12,10),A.YNc(13,li,3,3,"th",7),A.YNc(14,oi,2,1,"td",9),A.BQk(),A.YNc(15,ci,1,0,"tr",11),A.YNc(16,ui,1,0,"tr",12),A.qZA(),A.qZA(),A.qZA(),A.YNc(17,di,3,3,"app-alert",13),A.YNc(18,hi,3,3,"app-alert",13)),2&e&&(A.Q6J("hidden",0===t.dataSource.filteredData.length||0===t.bansOnFacilitiesWithUsers.length),A.xp6(1),A.Q6J("tableId",t.tableId)("dataLength",t.dataSource.filteredData.length)("pageSizeOptions",t.pageSizeOptions),A.xp6(1),A.Q6J("dataSource",t.dataSource),A.xp6(13),A.Q6J("matHeaderRowDef",t.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",t.displayedColumns),A.xp6(1),A.Q6J("ngIf",0===t.dataSource.filteredData.length&&0!==t.bansOnFacilitiesWithUsers.length),A.xp6(1),A.Q6J("ngIf",0===t.bansOnFacilitiesWithUsers.length))},directives:[wt.l,lt.BZ,Nt.YE,lt.w1,lt.fO,lt.Dz,lt.as,lt.nj,o.O5,lt.ge,ue.oG,lt.ev,Nt.nU,lt.XQ,lt.Gk,Ft.w],pipes:[_.X$,ge.d],styles:[""]}),e}();function pi(e,t){1&e&&A._UZ(0,"mat-spinner",5)}function gi(e,t){if(1&e&&A._UZ(0,"app-perun-web-apps-blacklist-list",6),2&e){var i=A.oxw();A.Q6J("tableId",i.tableId)("filterValue",i.filterValue)("bansOnFacilitiesWithUsers",i.bansOnFacilitiesWithUsers)("selection",i.selected)}}var mi=function(){var e=function(){function e(t,i,a){s(this,e),this.facilitiesManager=t,this.usersManager=i,this.route=a,this.bansOnFacilitiesWithUsers=[],this.selected=new xe.Ov(!0,[]),this.filterValue="",this.tableId=Oe.NG}return l(e,[{key:"ngOnInit",value:function(){this.refreshTable()}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.route.parent.parent.params.subscribe(function(t){e.facilitiesManager.getBansForFacility(t.facilityId).subscribe(function(t){var a,n=i(t);try{for(n.s();!(a=n.n()).done;){var s=a.value,r=void 0;e.usersManager.getUserById(s.userId).subscribe(function(e){r=e}),e.bansOnFacilitiesWithUsers.push([s,r])}}catch(l){n.e(l)}finally{n.f()}e.selected.clear(),e.loading=!1})})}},{key:"applyFilter",value:function(e){this.filterValue=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(f.IQ),A.Y36(f.Fv),A.Y36(c.gz))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-perun-web-apps-facility-settings-blacklist"]],decls:9,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","filterValue","bansOnFacilitiesWithUsers","selection",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"tableId","filterValue","bansOnFacilitiesWithUsers","selection"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"perun-web-apps-refresh-button",1),A.NdJ("refresh",function(){return t.refreshTable()}),A.qZA(),A.TgZ(5,"perun-web-apps-immediate-filter",2),A.NdJ("filter",function(e){return t.applyFilter(e)}),A.ALo(6,"translate"),A.qZA(),A.YNc(7,pi,1,0,"mat-spinner",3),A.YNc(8,gi,1,4,"app-perun-web-apps-blacklist-list",4),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,4,"FACILITY_DETAIL.SETTINGS.BLACKLIST.TITLE")),A.xp6(3),A.Q6J("placeholder",A.lcZ(6,6,"FACILITY_DETAIL.SETTINGS.BLACKLIST.FILTER")),A.xp6(2),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[Ge.t,ze.L,o.O5,y.$g,fi],pipes:[_.X$],styles:[""]}),e}(),vi=r(41939),Ai=r(13572),Si=r(40695),Ii=r(41186),Ti=["list"];function yi(e,t){if(1&e&&A._UZ(0,"perun-web-apps-attributes-list",6,7),2&e){var i=A.oxw();A.Q6J("tableId",i.tableId)("attributes",i.attributes)("selection",i.selected)}}var bi=function(){var e=function(){function e(t,i,a,n){s(this,e),this.dialog=t,this.attributesManager=i,this.facilityManager=a,this.route=n,this.attributes=[],this.selected=new xe.Ov(!0,[]),this.host={beanName:"",id:0},this.tableId=Oe.rF}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.route.params.subscribe(function(t){e.hostId=t.hostId,e.facilityManager.getHostById(e.hostId).subscribe(function(t){e.host=t}),e.refreshTable()})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.attributesManager.getHostAttributes(this.hostId).subscribe(function(t){e.attributes=(0,p.MX)(t),e.selected.clear(),e.loading=!1})}},{key:"onSave",value:function(){var e=this;this.list.updateMapAttributes();var t=(0,p.kZ)();t.width="450px",t.data={entityId:this.hostId,entity:"host",attributes:this.selected.selected},this.dialog.open(m.wA,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}},{key:"addAttribute",value:function(){var e=this,t=(0,p.kZ)();t.width="1050px",t.data={entityId:this.hostId,entity:"host",notEmptyAttributes:this.attributes,style:"facility-theme"},this.dialog.open(Si.n,t).afterClosed().subscribe(function(t){"saved"===t&&e.refreshTable()})}},{key:"removeAttribute",value:function(){var e=this,t=(0,p.kZ)();t.width="450px",t.data={entityId:this.hostId,entity:"host",attributes:this.selected.selected,theme:"facility-theme"},this.dialog.open(Ai.k,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(S.uw),A.Y36(f.H8),A.Y36(f.IQ),A.Y36(c.gz))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-hosts-detail"]],viewQuery:function(e,t){var i;(1&e&&A.Gf(Ti,5),2&e)&&(A.iGM(i=A.CRH())&&(t.list=i.first))},decls:15,vars:16,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent",1,"mr-2",3,"click"],["mat-flat-button","","color","accent",1,"mr-2",3,"disabled","click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[3,"tableId","attributes","selection",4,"ngIf"],[3,"tableId","attributes","selection"],["list",""]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"perun-web-apps-refresh-button",1),A.NdJ("refresh",function(){return t.refreshTable()}),A.qZA(),A.TgZ(5,"button",2),A.NdJ("click",function(){return t.addAttribute()}),A._uU(6),A.ALo(7,"translate"),A.qZA(),A.TgZ(8,"button",3),A.NdJ("click",function(){return t.onSave()}),A._uU(9),A.ALo(10,"translate"),A.qZA(),A.TgZ(11,"button",4),A.NdJ("click",function(){return t.removeAttribute()}),A._uU(12),A.ALo(13,"translate"),A.qZA(),A.YNc(14,yi,2,3,"perun-web-apps-attributes-list",5),A.qZA()),2&e&&(A.xp6(2),A.AsE(" ",A.lcZ(3,8,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.TITLE")," ",t.host.hostname,""),A.xp6(4),A.hij(" ",A.lcZ(7,10,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.ADD")," "),A.xp6(2),A.Q6J("disabled",0===t.selected.selected.length),A.xp6(1),A.hij(" ",A.lcZ(10,12,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.SAVE")," "),A.xp6(2),A.Q6J("disabled",0===t.selected.selected.length),A.xp6(1),A.hij(" ",A.lcZ(13,14,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.REMOVE")," "),A.xp6(2),A.Q6J("ngIf",!t.loading))},directives:[Ge.t,C.lW,o.O5,Ii.p],pipes:[_.X$],styles:[""]}),e}();function Ei(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"th",14),A.TgZ(1,"mat-checkbox",15),A.NdJ("change",function(e){A.CHM(i);var t=A.oxw();return e?t.masterToggle():null}),A.qZA(),A.qZA()}if(2&e){var a=A.oxw();A.xp6(1),A.Q6J("aria-label",a.checkboxLabel())("checked",a.selection.hasValue()&&a.isAllSelected())("indeterminate",a.selection.hasValue()&&!a.isAllSelected())}}function Zi(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"td",16),A.TgZ(1,"mat-checkbox",17),A.NdJ("change",function(e){var t=A.CHM(i).$implicit,a=A.oxw();return e?a.selection.toggle(t):null})("click",function(e){return e.stopPropagation()}),A.qZA(),A.qZA()}if(2&e){var a=t.$implicit,n=A.oxw();A.xp6(1),A.Q6J("aria-label",n.checkboxLabel(a))("checked",n.selection.isSelected(a))}}function Ci(e,t){1&e&&(A.TgZ(0,"th",18),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.SECURITY_TEAMS_LIST.ID")))}function _i(e,t){if(1&e&&(A.TgZ(0,"td",16),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.id)}}function Li(e,t){1&e&&(A.TgZ(0,"th",18),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.SECURITY_TEAMS_LIST.NAME")))}function ki(e,t){if(1&e&&(A.TgZ(0,"td",19),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.name)}}function Oi(e,t){1&e&&(A.TgZ(0,"th",18),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.SECURITY_TEAMS_LIST.DESCRIPTION")))}function xi(e,t){if(1&e&&(A.TgZ(0,"td",19),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.description)}}function Ri(e,t){1&e&&A._UZ(0,"tr",20)}function Di(e,t){1&e&&A._UZ(0,"tr",21)}function Ni(e,t){1&e&&(A.TgZ(0,"app-alert",22),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}function wi(e,t){1&e&&(A.TgZ(0,"app-alert",22),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED.COMPONENTS.SECURITY_TEAMS_LIST.NO_SECURITY_TEAMS_WARNING"),"\n"))}var Yi=function(){var e=function(){function e(t,i){s(this,e),this.authResolver=t,this.tableCheckbox=i,this.securityTeams=[],this.selection=new xe.Ov(!0,[]),this.displayedColumns=["select","id","name","description"],this.pageSizeOptions=p.f7}return l(e,[{key:"matSort",set:function(e){this.sort=e,this.setDataSource()}},{key:"ngOnChanges",value:function(){this.authResolver.isPerunAdminOrObserver()||(this.displayedColumns=this.displayedColumns.filter(function(e){return"id"!==e})),this.dataSource=new lt.by(this.securityTeams),this.setDataSource(),this.dataSource.filter=this.filterValue}},{key:"getDataForColumn",value:function(e,t){switch(t){case"id":return e.id.toString();case"name":return e.name;case"description":return e.description;default:return""}}},{key:"exportData",value:function(e){(0,p.O6)((0,p.Xn)(this.dataSource.filteredData,this.displayedColumns,this.getDataForColumn,this),e)}},{key:"setDataSource",value:function(){var e=this;this.dataSource&&(this.dataSource.filterPredicate=function(t,i){return(0,p.Sd)(t,i,e.displayedColumns,e.getDataForColumn,e)},this.dataSource.sortData=function(t,i){return(0,p.pR)(t,i,e.getDataForColumn,e)},this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator)}},{key:"isAllSelected",value:function(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.child.paginator.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}},{key:"masterToggle",value:function(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}},{key:"checkboxLabel",value:function(e){return e?"".concat(this.selection.isSelected(e)?"deselect":"select"," row ").concat(e.id+1):(this.isAllSelected()?"select":"deselect")+" all"}},{key:"ngAfterViewInit",value:function(){this.dataSource.paginator=this.child.paginator}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(g.x4),A.Y36(g.UA))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-security-teams-list"]],viewQuery:function(e,t){var i;(1&e&&(A.Gf(Nt.YE,7),A.Gf(p.l9,7)),2&e)&&(A.iGM(i=A.CRH())&&(t.matSort=i.first),A.iGM(i=A.CRH())&&(t.child=i.first))},inputs:{securityTeams:"securityTeams",selection:"selection",filterValue:"filterValue",tableId:"tableId",displayedColumns:"displayedColumns"},features:[A.TTD],decls:19,vars:9,consts:[[1,"card","mt-3",3,"hidden"],[3,"tableId","dataLength","pageSizeOptions","exportData"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","name"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"],["alert_type","warn"]],template:function(e,t){1&e&&(A.TgZ(0,"div",0),A.TgZ(1,"perun-web-apps-table-wrapper",1),A.NdJ("exportData",function(e){return t.exportData(e)}),A.TgZ(2,"table",2),A.ynx(3,3),A.YNc(4,Ei,2,3,"th",4),A.YNc(5,Zi,2,2,"td",5),A.BQk(),A.ynx(6,6),A.YNc(7,Ci,3,3,"th",7),A.YNc(8,_i,2,1,"td",5),A.BQk(),A.ynx(9,8),A.YNc(10,Li,3,3,"th",7),A.YNc(11,ki,2,1,"td",9),A.BQk(),A.ynx(12,10),A.YNc(13,Oi,3,3,"th",7),A.YNc(14,xi,2,1,"td",9),A.BQk(),A.YNc(15,Ri,1,0,"tr",11),A.YNc(16,Di,1,0,"tr",12),A.qZA(),A.qZA(),A.qZA(),A.YNc(17,Ni,3,3,"app-alert",13),A.YNc(18,wi,3,3,"app-alert",13)),2&e&&(A.Q6J("hidden",0===t.dataSource.filteredData.length||0===t.securityTeams.length),A.xp6(1),A.Q6J("tableId",t.tableId)("dataLength",t.dataSource.filteredData.length)("pageSizeOptions",t.pageSizeOptions),A.xp6(1),A.Q6J("dataSource",t.dataSource),A.xp6(13),A.Q6J("matHeaderRowDef",t.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",t.displayedColumns),A.xp6(1),A.Q6J("ngIf",0===t.dataSource.filteredData.length&&0!==t.securityTeams.length),A.xp6(1),A.Q6J("ngIf",0===t.securityTeams.length))},directives:[wt.l,lt.BZ,Nt.YE,lt.w1,lt.fO,lt.Dz,lt.as,lt.nj,o.O5,lt.ge,ue.oG,lt.ev,Nt.nU,lt.XQ,lt.Gk,Ft.w],pipes:[_.X$],styles:[""]}),e}();function Fi(e,t){1&e&&A._UZ(0,"mat-spinner",5)}function Mi(e,t){if(1&e&&A._UZ(0,"app-security-teams-list",6),2&e){var i=A.oxw();A.Q6J("tableId",i.tableId)("filterValue",i.filterValue)("securityTeams",i.securityTeams)("displayedColumns",i.displayedColumns)("selection",i.selected)}}var Ui=function(){var e=function(){function e(t,i,a,n){s(this,e),this.dialog=t,this.facilitiesManager=i,this.route=a,this.authResolver=n,this.securityTeams=[],this.selected=new xe.Ov(!0,[]),this.filterValue="",this.tableId=Oe.O9,this.displayedColumns=[]}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.route.parent.params.subscribe(function(t){e.facilitiesManager.getFacilityById(t.facilityId).subscribe(function(t){e.facility=t,e.refreshTable()})})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.facilitiesManager.getAssignedSecurityTeams(this.facility.id).subscribe(function(t){e.securityTeams=t,e.selected.clear(),e.setAuthRights(),e.loading=!1})}},{key:"setAuthRights",value:function(){this.addAuth=this.authResolver.isAuthorized("assignSecurityTeam_Facility_SecurityTeam_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeSecurityTeam_Facility_SecurityTeam_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","id","name","description"]:["id","name","description"]}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"addSecurityTeam",value:function(){}},{key:"removeSecurityTeam",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(S.uw),A.Y36(f.IQ),A.Y36(c.gz),A.Y36(g.x4))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-security-teams"]],decls:8,vars:6,consts:[[1,"page-subtitle"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","filterValue","securityTeams","displayedColumns","selection",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"tableId","filterValue","securityTeams","displayedColumns","selection"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"perun-web-apps-refresh-button",1),A.NdJ("refresh",function(){return t.refreshTable()}),A.qZA(),A.TgZ(5,"perun-web-apps-immediate-filter",2),A.NdJ("filter",function(e){return t.applyFilter(e)}),A.qZA(),A.YNc(6,Fi,1,0,"mat-spinner",3),A.YNc(7,Mi,1,5,"app-security-teams-list",4),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,4,"FACILITY_DETAIL.SECURITY_TEAMS.TITLE")),A.xp6(3),A.Q6J("placeholder","FACILITY_DETAIL.SECURITY_TEAMS.FILTER"),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[Ge.t,ze.L,o.O5,y.$g,Yi],pipes:[_.X$],styles:[""]}),e}(),qi=r(64359),Ji=r(8705);function Qi(e,t){1&e&&A._UZ(0,"mat-spinner",6)}function Vi(e,t){1&e&&(A.TgZ(0,"th",17),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"DIALOGS.DELETE_TASK_RESULT.RESULT_ID")))}function Hi(e,t){if(1&e&&(A.TgZ(0,"td",18),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.hij(" ",i.id," ")}}function Pi(e,t){1&e&&(A.TgZ(0,"th",17),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"DIALOGS.DELETE_TASK_RESULT.DESTINATION")))}function Bi(e,t){if(1&e&&(A.TgZ(0,"td",18),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.hij(" ",i.destination.destination," ")}}function Gi(e,t){1&e&&(A.TgZ(0,"th",17),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"DIALOGS.DELETE_TASK_RESULT.TIME")))}function zi(e,t){if(1&e&&(A.TgZ(0,"td",18),A._uU(1),A.ALo(2,"date"),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.hij(" ",A.xi3(2,1,i.timestamp,"d.M.y H:mm:ss")," ")}}function $i(e,t){1&e&&A._UZ(0,"tr",19)}function ji(e,t){1&e&&A._UZ(0,"tr",20)}function Ki(e,t){if(1&e&&(A.TgZ(0,"div",7),A.TgZ(1,"p"),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"div",8),A._uU(5),A.ALo(6,"translate"),A.qZA(),A.TgZ(7,"table",9),A.ynx(8,10),A.YNc(9,Vi,3,3,"th",11),A.YNc(10,Hi,2,1,"td",12),A.BQk(),A.ynx(11,13),A.YNc(12,Pi,3,3,"th",11),A.YNc(13,Bi,2,1,"td",12),A.BQk(),A.ynx(14,14),A.YNc(15,Gi,3,3,"th",11),A.YNc(16,zi,3,4,"td",12),A.BQk(),A.YNc(17,$i,1,0,"tr",15),A.YNc(18,ji,1,0,"tr",16),A.qZA(),A.qZA()),2&e){var i=A.oxw();A.xp6(2),A.Oqu(A.lcZ(3,5,"DIALOGS.DELETE_TASK_RESULT.DESCRIPTION")),A.xp6(3),A.hij(" ",A.lcZ(6,7,"DIALOGS.DELETE_TASK_RESULT.ASK")," "),A.xp6(2),A.Q6J("dataSource",i.dataSource),A.xp6(10),A.Q6J("matHeaderRowDef",i.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",i.displayedColumns)}}var Wi=function(){var e=function(){function e(t,i,a,n,r){s(this,e),this.dialogRef=t,this.data=i,this.taskManager=a,this.notificator=n,this.translate=r,this.loading=!1,this.dataSource=new lt.by(this.data.taskResults),this.displayedColumns=["id","destination","time"]}return l(e,[{key:"ngOnInit",value:function(){this.theme=this.data.theme,this.taskResults=this.data.taskResults}},{key:"deleteResults",value:function(){var e=this;if(this.loading=!0,0===this.taskResults.length)return this.dialogRef.close(!0),this.loading=!1,void this.notificator.showSuccess(this.translate.instant("DIALOGS.DELETE_TASK_RESULT.SUCCESS"));this.taskManager.deleteTaskResultById({taskResultId:this.taskResults.pop().id}).subscribe(function(){e.deleteResults()},function(){return e.loading=!1})}},{key:"onDelete",value:function(){this.deleteResults()}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(S.so),A.Y36(S.WI),A.Y36(f.Ob),A.Y36(g.V6),A.Y36(_.sK))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-delete-task-result-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","destination"],["matColumnDef","time"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(A.TgZ(0,"h1",0),A._uU(1),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"div"),A.YNc(4,Qi,1,0,"mat-spinner",1),A.YNc(5,Ki,19,9,"div",2),A.TgZ(6,"div",3),A.TgZ(7,"button",4),A.NdJ("click",function(){return t.onCancel()}),A._uU(8),A.ALo(9,"translate"),A.qZA(),A.TgZ(10,"button",5),A.NdJ("click",function(){return t.onDelete()}),A._uU(11),A.ALo(12,"translate"),A.qZA(),A.qZA(),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,9,"DIALOGS.DELETE_TASK_RESULT.TITLE")),A.xp6(2),A.Tol(t.theme),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(3),A.hij(" ",A.lcZ(9,11,"DIALOGS.DELETE_TASK_RESULT.CANCEL")," "),A.xp6(2),A.Q6J("disabled",t.loading),A.xp6(1),A.hij(" ",A.lcZ(12,13,"DIALOGS.DELETE_TASK_RESULT.REMOVE")," "))},directives:[S.uh,o.O5,S.H8,C.lW,y.$g,S.xY,lt.BZ,lt.w1,lt.fO,lt.Dz,lt.as,lt.nj,lt.ge,lt.ev,lt.XQ,lt.Gk],pipes:[_.X$,o.uU],styles:[""]}),e}(),Xi=r(88884);function ea(e,t){1&e&&A._UZ(0,"mat-spinner",6)}function ta(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-checkbox",13),A.NdJ("change",function(e){return A.CHM(i),A.oxw(2).change(e)}),A.ALo(1,"translate"),A._uU(2),A.ALo(3,"translate"),A.qZA()}if(2&e){var a=A.oxw(2);A.s9C("matTooltip",A.lcZ(1,5,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOXES_DISABLED")),A.Q6J("matTooltipDisabled",!a.checkboxesDisabled)("disabled",a.checkboxesDisabled)("checked",a.taskChecked),A.xp6(2),A.hij(" ",A.lcZ(3,7,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOX_TASK_AND_TASK_RESULTS")," ")}}function ia(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-checkbox",14),A.NdJ("change",function(e){return A.CHM(i),A.oxw(2).change(e)}),A.ALo(1,"translate"),A._uU(2),A.ALo(3,"translate"),A.qZA()}if(2&e){var a=A.oxw(2);A.s9C("matTooltip",A.lcZ(1,5,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOXES_DISABLED")),A.Q6J("matTooltipDisabled",!a.checkboxesDisabled)("disabled",a.checkboxesDisabled)("checked",a.taskResultsChecked),A.xp6(2),A.hij(" ",A.lcZ(3,7,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOX_TASK_RESULTS")," ")}}function aa(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"perun-web-apps-resources-list",15),A.NdJ("allSelected",function(e){return A.CHM(i),A.oxw(2).disableCheckboxes(e)}),A.qZA()}if(2&e){var a=A.oxw(2);A.Q6J("tableId",a.tableId)("disableRouting",!0)("resources",a.resources)("selection",a.selected)("displayedColumns",a.displayedColumns)}}function na(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"div",7),A.TgZ(1,"p"),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"div"),A.YNc(5,ta,4,9,"mat-checkbox",8),A.YNc(6,ia,4,9,"mat-checkbox",9),A.TgZ(7,"mat-checkbox",10),A.NdJ("change",function(e){return A.CHM(i),A.oxw().change(e)}),A.ALo(8,"translate"),A._uU(9),A.ALo(10,"translate"),A.qZA(),A.qZA(),A.TgZ(11,"p"),A._uU(12),A.ALo(13,"translate"),A.qZA(),A.TgZ(14,"div",11),A._uU(15),A.ALo(16,"translate"),A.qZA(),A.YNc(17,aa,1,5,"perun-web-apps-resources-list",12),A.qZA()}if(2&e){var a=A.oxw();A.xp6(2),A.Oqu(A.lcZ(3,11,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOXES_DESCRIPTION")),A.xp6(3),A.Q6J("ngIf",null!==a.taskId),A.xp6(1),A.Q6J("ngIf",null!==a.taskId),A.xp6(1),A.s9C("matTooltip",A.lcZ(8,13,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOXES_DISABLED")),A.Q6J("matTooltipDisabled",!a.checkboxesDisabled)("disabled",a.checkboxesDisabled)("checked",a.destinationChecked),A.xp6(2),A.hij(" ",A.lcZ(10,15,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOX_DESTINATION")," "),A.xp6(3),A.Oqu(A.lcZ(13,17,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.DESCRIPTION")),A.xp6(3),A.hij(" ",A.lcZ(16,19,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.ASK")," "),A.xp6(2),A.Q6J("ngIf",!a.loading)}}var sa=function(){var t=function(){function t(i,a,n,r,l,o,c,u){s(this,t),this.dialogRef=i,this.data=a,this.resourcesManager=n,this.tasksManager=r,this.serviceManager=l,this.translate=o,this.notificator=c,this.cd=u,this.loading=!1,this.dataSource=new lt.by(this.data.resource),this.selected=new xe.Ov(!0,e(this.dataSource.data)),this.resources=[],this.displayedColumns=["select","id","vo","name"],this.checkboxesDisabled=!1,this.taskChecked=!0,this.taskResultsChecked=!0,this.destinationChecked=!0,this.tableId=Oe.$V}return l(t,[{key:"ngOnInit",value:function(){this.theme=this.data.theme,this.taskId=this.data.taskId,this.serviceId=this.data.serviceId,this.facilityId=this.data.facilityId,this.resources=this.data.resource}},{key:"remove",value:function(){var e=this;this.loading=!0,this.taskResultsChecked&&!this.taskChecked&&null!==this.taskId&&this.tasksManager.getTaskResultsForGUIByTask(this.taskId).subscribe(function(t){t.forEach(function(t){e.tasksManager.deleteTaskResultById({taskResultId:t.id}).subscribe()})}),this.taskChecked&&null!==this.taskId&&this.tasksManager.deleteTask({task:this.taskId}).subscribe(),this.destinationChecked&&this.serviceManager.getDestinations(this.serviceId,this.facilityId).subscribe(function(t){t.forEach(function(t){e.serviceManager.removeDestination(e.serviceId,e.facilityId,t.destination,t.type).subscribe()})}),this.selected.selected.forEach(function(t){e.resourcesManager.removeService(t.id,e.serviceId).subscribe(function(){e.translate.get("DIALOGS.REMOVE_SERVICE_FROM_FACILITY.SUCCESS").subscribe(function(t){e.notificator.showSuccess(t),e.dialogRef.close(!0)})},function(){return e.loading=!1})})}},{key:"cancel",value:function(){this.dialogRef.close(!1)}},{key:"disableCheckboxes",value:function(e){e&&this.checkboxesDisabled&&this.changeCheckboxes(!0),e||this.checkboxesDisabled||this.changeCheckboxes(!1)}},{key:"changeCheckboxes",value:function(e){this.checkboxesDisabled=!e,this.taskChecked=e,this.taskResultsChecked=e,this.destinationChecked=e,this.cd.detectChanges()}},{key:"change",value:function(e){switch(e.source.id){case"task":this.taskChecked=e.checked;break;case"taskResults":this.taskResultsChecked=e.checked;break;case"destination":this.destinationChecked=e.checked}}}]),t}();return t.\u0275fac=function(e){return new(e||t)(A.Y36(S.so),A.Y36(S.WI),A.Y36(f.xk),A.Y36(f.Ob),A.Y36(f.KK),A.Y36(_.sK),A.Y36(g.V6),A.Y36(A.sBO))},t.\u0275cmp=A.Xpm({type:t,selectors:[["app-delete-service-from-facility"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content",""],["id","task","class","right-space","color","warn",3,"matTooltip","matTooltipDisabled","disabled","checked","change",4,"ngIf"],["id","taskResults","class","right-space","color","warn",3,"matTooltip","matTooltipDisabled","disabled","checked","change",4,"ngIf"],["id","destination","color","warn",3,"matTooltip","matTooltipDisabled","disabled","checked","change"],[1,"font-weight-bold"],[3,"tableId","disableRouting","resources","selection","displayedColumns","allSelected",4,"ngIf"],["id","task","color","warn",1,"right-space",3,"matTooltip","matTooltipDisabled","disabled","checked","change"],["id","taskResults","color","warn",1,"right-space",3,"matTooltip","matTooltipDisabled","disabled","checked","change"],[3,"tableId","disableRouting","resources","selection","displayedColumns","allSelected"]],template:function(e,t){1&e&&(A.TgZ(0,"h1",0),A._uU(1),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"div"),A.YNc(4,ea,1,0,"mat-spinner",1),A.YNc(5,na,18,21,"div",2),A.TgZ(6,"div",3),A.TgZ(7,"button",4),A.NdJ("click",function(){return t.cancel()}),A._uU(8),A.ALo(9,"translate"),A.qZA(),A.TgZ(10,"button",5),A.NdJ("click",function(){return t.remove()}),A._uU(11),A.ALo(12,"translate"),A.qZA(),A.qZA(),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,9,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.TITLE")),A.xp6(2),A.Tol(t.theme),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(3),A.hij(" ",A.lcZ(9,11,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CANCEL")," "),A.xp6(2),A.Q6J("disabled",t.loading||0===t.selected.selected.length),A.xp6(1),A.hij(" ",A.lcZ(12,13,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.REMOVE")," "))},directives:[S.uh,o.O5,S.H8,C.lW,y.$g,S.xY,ue.oG,E.gM,Xi.C],pipes:[_.X$],styles:[".right-space[_ngcontent-%COMP%]{margin-right:40px}"]}),t}();function ra(e,t){1&e&&A._UZ(0,"mat-spinner",6)}function la(e,t){1&e&&(A.TgZ(0,"div",7),A.TgZ(1,"div",8),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.qZA()),2&e&&(A.xp6(2),A.hij(" ",A.lcZ(3,1,"DIALOGS.DELETE_TASK.DESCRIPTION")," "))}var oa=function(){var e=function(){function e(t,i,a,n,r){s(this,e),this.dialogRef=t,this.data=i,this.tasksManager=a,this.translate=n,this.notificator=r,this.loading=!1}return l(e,[{key:"ngOnInit",value:function(){this.theme=this.data.theme,this.taskId=this.data.taskId}},{key:"remove",value:function(){var e=this;this.loading=!0,this.tasksManager.deleteTask({task:this.taskId}).subscribe(function(){e.translate.get("DIALOGS.DELETE_TASK.SUCCESS").subscribe(function(t){e.notificator.showSuccess(t),e.dialogRef.close(!0)})},function(){return e.loading=!1})}},{key:"cancel",value:function(){this.dialogRef.close(!1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(S.so),A.Y36(S.WI),A.Y36(f.Ob),A.Y36(_.sK),A.Y36(g.V6))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-delete-task-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content",""],[1,"font-weight-bold"]],template:function(e,t){1&e&&(A.TgZ(0,"h1",0),A._uU(1),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"div"),A.YNc(4,ra,1,0,"mat-spinner",1),A.YNc(5,la,4,3,"div",2),A.TgZ(6,"div",3),A.TgZ(7,"button",4),A.NdJ("click",function(){return t.cancel()}),A._uU(8),A.ALo(9,"translate"),A.qZA(),A.TgZ(10,"button",5),A.NdJ("click",function(){return t.remove()}),A._uU(11),A.ALo(12,"translate"),A.qZA(),A.qZA(),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,9,"DIALOGS.DELETE_TASK.TITLE")),A.xp6(2),A.Tol(t.theme),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(3),A.hij(" ",A.lcZ(9,11,"DIALOGS.DELETE_TASK.CANCEL")," "),A.xp6(2),A.Q6J("disabled",t.loading),A.xp6(1),A.hij(" ",A.lcZ(12,13,"DIALOGS.DELETE_TASK.DELETE")," "))},directives:[S.uh,o.O5,S.H8,C.lW,y.$g,S.xY],pipes:[_.X$],styles:[""]}),e}(),ca=r(8055),ua=function(){var e=function(){function e(){s(this,e)}return l(e,[{key:"transform",value:function(e){return e.blockedOnFacility?"BLOCKED":e.blockedGlobally?"BLOCKED GLOBALLY":"ALLOWED"}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=A.Yjl({name:"serviceStateBlockedToString",type:e,pure:!0}),e}();function da(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"th",17),A.TgZ(1,"mat-checkbox",18),A.NdJ("change",function(e){A.CHM(i);var t=A.oxw();return e&&t.masterToggle(),t.selectionChange.emit()}),A.qZA(),A.qZA()}if(2&e){var a=A.oxw();A.xp6(1),A.Q6J("checked",a.selection.hasValue()&&a.isAllSelected())("indeterminate",a.selection.hasValue()&&!a.isAllSelected())("aria-label",a.checkboxLabel())}}function ha(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"td",19),A.TgZ(1,"mat-checkbox",20),A.NdJ("click",function(e){return e.stopPropagation()})("change",function(e){var t=A.CHM(i).$implicit,a=A.oxw();return e&&a.selection.toggle(t),a.selectionChange.emit()}),A.qZA(),A.qZA()}if(2&e){var a=t.$implicit,n=A.oxw();A.xp6(1),A.Q6J("checked",n.selection.isSelected(a))("aria-label",n.checkboxLabel(a))}}function fa(e,t){1&e&&(A.TgZ(0,"th",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.TASK_ID")))}function pa(e,t){if(1&e&&(A.TgZ(0,"div"),A._uU(1),A.qZA()),2&e){var i=A.oxw().$implicit;A.xp6(1),A.Oqu(i.task.id)}}function ga(e,t){1&e&&(A.TgZ(0,"div"),A._uU(1,"0"),A.qZA())}function ma(e,t){if(1&e&&(A.TgZ(0,"td",19),A.YNc(1,pa,2,1,"div",22),A.YNc(2,ga,2,0,"div",22),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Q6J("ngIf",i.task),A.xp6(1),A.Q6J("ngIf",!i.task)}}function va(e,t){1&e&&(A.TgZ(0,"th",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.SERVICE_NAME")))}function Aa(e,t){if(1&e&&(A.TgZ(0,"td",23),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.service.name)}}function Sa(e,t){1&e&&(A.TgZ(0,"th",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.STATUS")))}function Ia(e,t){if(1&e&&(A.TgZ(0,"td",23),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.status)}}function Ta(e,t){1&e&&(A.TgZ(0,"th",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.BLOCKED")))}function ya(e,t){if(1&e&&(A.TgZ(0,"td",23),A._uU(1),A.ALo(2,"serviceStateBlockedToString"),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(A.lcZ(2,1,i))}}function ba(e,t){1&e&&(A.TgZ(0,"th",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.STARTED")))}function Ea(e,t){if(1&e&&(A.TgZ(0,"div"),A._uU(1),A.ALo(2,"date"),A.qZA()),2&e){var i=A.oxw().$implicit;A.xp6(1),A.Oqu(A.xi3(2,1,i.task.startTime,"d.M.y H:mm:ss"))}}function Za(e,t){1&e&&(A.TgZ(0,"div"),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.NOT_YET"),""))}function Ca(e,t){if(1&e&&(A.TgZ(0,"td",23),A.YNc(1,Ea,3,4,"div",22),A.YNc(2,Za,3,3,"div",22),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Q6J("ngIf",i.task&&i.task.startTime),A.xp6(1),A.Q6J("ngIf",!i.task||!i.task.startTime)}}function _a(e,t){1&e&&(A.TgZ(0,"th",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.ENDED")))}function La(e,t){if(1&e&&(A.TgZ(0,"div"),A._uU(1),A.ALo(2,"date"),A.qZA()),2&e){var i=A.oxw().$implicit;A.xp6(1),A.Oqu(A.xi3(2,1,i.task.endTime,"d.M.y H:mm:ss"))}}function ka(e,t){1&e&&(A.TgZ(0,"div"),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.NOT_YET")," "))}function Oa(e,t){if(1&e&&(A.TgZ(0,"td",23),A.YNc(1,La,3,4,"div",22),A.YNc(2,ka,3,3,"div",22),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Q6J("ngIf",i.task&&i.task.endTime),A.xp6(1),A.Q6J("ngIf",!i.task||!i.task.endTime)}}function xa(e,t){1&e&&A._UZ(0,"tr",24)}var Ra=function(e,t){return["/facilities",e,"services-status",t]};function Da(e,t){if(1&e&&A._UZ(0,"tr",25),2&e){var i=t.$implicit,a=A.oxw();A.ekj("disable-outline",a.disableRouting||!i.task)("make-yellow","WARNING"===i.status)("make-green","DONE"===i.status)("make-red","GENERROR"===i.status||"SENDERROR"===i.status||"ERROR"===i.status)("cursor-pointer",!a.disableRouting&&null!==i.task),A.Q6J("routerLink",a.disableRouting||null===i.task?null:A.WLB(12,Ra,i.facility.id,i.taskId))("perunWebAppsMiddleClickRouterLink",a.disableRouting||null===i.task?null:A.WLB(15,Ra,i.facility.id,i.taskId))}}function Na(e,t){1&e&&(A.TgZ(0,"app-alert",26),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}function wa(e,t){1&e&&(A.TgZ(0,"app-alert",26),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.NO_SERVICES_STATUS_WARNING"),"\n"))}var Ya=function(){var e=function(){function e(t,i){s(this,e),this.authResolver=t,this.tableCheckbox=i,this.servicesStatus=[],this.displayedColumns=["select","task.id","service.name","status","blocked","task.startTime","task.endTime"],this.selection=new xe.Ov(!0,[]),this.disableRouting=!0,this.selectionChange=new A.vpe,this.pageSizeOptions=p.f7}return l(e,[{key:"matSort",set:function(e){this.sort=e,this.setDataSource()}},{key:"ngOnChanges",value:function(){this.authResolver.isPerunAdminOrObserver()||(this.displayedColumns=this.displayedColumns.filter(function(e){return"task.id"!==e})),this.dataSource=new lt.by(this.servicesStatus),this.setDataSource(),this.dataSource.filterPredicate=function(e,t){var i=t.trim().toLowerCase();return function e(t){var i="";return Object.values(t).forEach(function(t){"object"!=typeof t?i=i+" "+t:null!==t&&(i=i+" "+e(t))}),i.trim().toLowerCase()}(e).includes(i)},this.dataSource.filter=this.filterValue}},{key:"getDataForColumn",value:function(e,t){switch(t){case"task.id":return e.task?e.task.id.toString():e[t];case"service.name":return e.service.name;case"status":return e.status;case"blocked":return e.blockedOnFacility?"BLOCKED":e.blockedGlobally?"BLOCKED GLOBALLY":"ALLOWED";case"task.startTime":return e.task&&e.task.startTime?(0,o.p6)(e.task.startTime,"d.M.y H:mm:ss","en"):e[t];case"task.endTime":return e.task&&e.task.endTime?(0,o.p6)(e.task.endTime,"d.M.y H:mm:ss","en"):e[t];default:return e[t]}}},{key:"getSortDataForColumn",value:function(e,t){switch(t){case"task.id":return e.task?e.task.id.toString():e[t];case"service.name":return e.service.name;case"status":return e.status;case"blocked":return e.blockedOnFacility?"BLOCKED":e.blockedGlobally?"BLOCKED GLOBALLY":"ALLOWED";case"task.startTime":return e.task&&e.task.startTime?(0,o.p6)(e.task.startTime,"yyyy.MM.dd HH:mm:ss","en"):e[t];case"task.endTime":return e.task&&e.task.endTime?(0,o.p6)(e.task.endTime,"yyyy.MM.dd HH:mm:ss","en"):e[t];default:return e[t]}}},{key:"exportData",value:function(e){(0,p.O6)((0,p.Xn)(this.dataSource.filteredData,this.displayedColumns,this.getDataForColumn,this),e)}},{key:"setDataSource",value:function(){var e=this;this.dataSource&&(this.dataSource.filterPredicate=function(t,i){return(0,p.Sd)(t,i,e.displayedColumns,e.getDataForColumn,e)},this.dataSource.sortData=function(t,i){return(0,p.pR)(t,i,e.getSortDataForColumn,e)},this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator)}},{key:"isAllSelected",value:function(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.child.paginator.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}},{key:"masterToggle",value:function(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}},{key:"checkboxLabel",value:function(e){return e?"".concat(this.selection.isSelected(e)?"deselect":"select"," row ").concat(e.service.id+1):(this.isAllSelected()?"select":"deselect")+" all"}},{key:"ngAfterViewInit",value:function(){this.dataSource.paginator=this.child.paginator}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(g.x4),A.Y36(g.UA))},e.\u0275cmp=A.Xpm({type:e,selectors:[["perun-web-apps-services-status-list"]],viewQuery:function(e,t){var i;(1&e&&(A.Gf(Nt.YE,7),A.Gf(p.l9,7)),2&e)&&(A.iGM(i=A.CRH())&&(t.matSort=i.first),A.iGM(i=A.CRH())&&(t.child=i.first))},inputs:{servicesStatus:"servicesStatus",displayedColumns:"displayedColumns",selection:"selection",filterValue:"filterValue",tableId:"tableId",disableRouting:"disableRouting"},outputs:{selectionChange:"selectionChange"},features:[A.TTD],decls:28,vars:9,consts:[[1,"card","mt-3",3,"hidden"],[3,"tableId","dataLength","pageSizeOptions","exportData"],["mat-table","","matSort","","matSortActive","service.name","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","static-column-size",4,"matCellDef"],["matColumnDef","task.id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","service.name"],["mat-cell","",4,"matCellDef"],["matColumnDef","status"],["matColumnDef","blocked"],["matColumnDef","task.startTime"],["matColumnDef","task.endTime"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","dark-hover-list-item",3,"disable-outline","make-yellow","make-green","make-red","cursor-pointer","routerLink","perunWebAppsMiddleClickRouterLink",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["color","primary",3,"checked","indeterminate","aria-label","change"],["mat-cell","",1,"static-column-size"],["color","primary",3,"checked","aria-label","click","change"],["mat-header-cell","","mat-sort-header",""],[4,"ngIf"],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item",3,"routerLink","perunWebAppsMiddleClickRouterLink"],["alert_type","warn"]],template:function(e,t){1&e&&(A.TgZ(0,"div",0),A.TgZ(1,"perun-web-apps-table-wrapper",1),A.NdJ("exportData",function(e){return t.exportData(e)}),A.TgZ(2,"table",2),A.ynx(3,3),A.YNc(4,da,2,3,"th",4),A.YNc(5,ha,2,2,"td",5),A.BQk(),A.ynx(6,6),A.YNc(7,fa,3,3,"th",7),A.YNc(8,ma,3,2,"td",5),A.BQk(),A.ynx(9,8),A.YNc(10,va,3,3,"th",7),A.YNc(11,Aa,2,1,"td",9),A.BQk(),A.ynx(12,10),A.YNc(13,Sa,3,3,"th",7),A.YNc(14,Ia,2,1,"td",9),A.BQk(),A.ynx(15,11),A.YNc(16,Ta,3,3,"th",7),A.YNc(17,ya,3,3,"td",9),A.BQk(),A.ynx(18,12),A.YNc(19,ba,3,3,"th",7),A.YNc(20,Ca,3,2,"td",9),A.BQk(),A.ynx(21,13),A.YNc(22,_a,3,3,"th",7),A.YNc(23,Oa,3,2,"td",9),A.BQk(),A.YNc(24,xa,1,0,"tr",14),A.YNc(25,Da,1,18,"tr",15),A.qZA(),A.qZA(),A.qZA(),A.YNc(26,Na,3,3,"app-alert",16),A.YNc(27,wa,3,3,"app-alert",16)),2&e&&(A.Q6J("hidden",0===t.dataSource.filteredData.length||0===t.servicesStatus.length),A.xp6(1),A.Q6J("tableId",t.tableId)("dataLength",t.dataSource.filteredData.length)("pageSizeOptions",t.pageSizeOptions),A.xp6(1),A.Q6J("dataSource",t.dataSource),A.xp6(22),A.Q6J("matHeaderRowDef",t.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",t.displayedColumns),A.xp6(1),A.Q6J("ngIf",0===t.dataSource.filteredData.length&&0!==t.servicesStatus.length),A.xp6(1),A.Q6J("ngIf",0===t.servicesStatus.length))},directives:[wt.l,lt.BZ,Nt.YE,lt.w1,lt.fO,lt.Dz,lt.as,lt.nj,o.O5,lt.ge,ue.oG,lt.ev,Nt.nU,lt.XQ,lt.Gk,c.rH,Yt.YH,Ft.w],pipes:[_.X$,ua,o.uU],styles:[".disable-outline[_ngcontent-%COMP%]{outline:none!important}.make-green[_ngcontent-%COMP%]{background-color:#c4ffcb}.make-yellow[_ngcontent-%COMP%]{background-color:#fffde7}.make-red[_ngcontent-%COMP%]{background-color:#ffcdd2}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}"]}),e}();function Fa(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",11),A.NdJ("click",function(){return A.CHM(i),A.oxw().forcePropagation()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selected.selected.length),A.xp6(1),A.hij(" ",A.lcZ(2,2,"FACILITY_DETAIL.SERVICES_STATUS.FORCE_PROPAGATION")," ")}}function Ma(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",11),A.NdJ("click",function(){return A.CHM(i),A.oxw().allow()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selected.selected.length||a.disableAllowButton),A.xp6(1),A.hij(" ",A.lcZ(2,2,"FACILITY_DETAIL.SERVICES_STATUS.ALLOW")," ")}}function Ua(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",12),A.NdJ("click",function(){return A.CHM(i),A.oxw().block()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selected.selected.length||a.disableBlockButton),A.xp6(1),A.hij(" ",A.lcZ(2,2,"FACILITY_DETAIL.SERVICES_STATUS.BLOCK")," ")}}function qa(e,t){if(1&e&&(A.TgZ(0,"button",13),A.ALo(1,"translate"),A._uU(2),A.ALo(3,"translate"),A.qZA()),2&e){var i=A.oxw(),a=A.MAs(10);A.s9C("matTooltip",A.lcZ(1,5,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOXES_DISABLED")),A.Q6J("matTooltipDisabled",!i.disableRemoveButton)("disabled",i.disableRemoveButton)("matMenuTriggerFor",a),A.xp6(2),A.hij(" ",A.lcZ(3,7,"FACILITY_DETAIL.SERVICES_STATUS.REMOVE")," ")}}function Ja(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",7),A.NdJ("click",function(){return A.CHM(i),A.oxw().removeTaskResults()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"FACILITY_DETAIL.SERVICES_STATUS.REMOVE_TASK_RESULTS")," "))}function Qa(e,t){1&e&&A._UZ(0,"mat-spinner",14)}function Va(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"perun-web-apps-services-status-list",15),A.NdJ("selectionChange",function(){return A.CHM(i),A.oxw().selectionChanged()}),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("tableId",a.tableId)("filterValue",a.filterValue)("servicesStatus",a.servicesStates)("selection",a.selected)("disableRouting",!a.routeAuth)}}var Ha=function(){var e=function(){function e(t,i,a,n,r,l,o,c,u){var d=this;s(this,e),this.route=t,this.tasksManager=i,this.servicesManager=a,this.notificator=n,this.translate=r,this.authResolver=l,this.facilityManager=o,this.resourcesManager=c,this.dialog=u,this.servicesStates=[],this.selected=new xe.Ov(!0,[]),this.filterValue="",this.tableId=Oe.oK,this.disableAllowButton=!0,this.disableBlockButton=!0,this.disableRemoveButton=!0,r.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_FORCE_PROPAGATION").subscribe(function(e){return d.successFPMessage=e}),r.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_ALLOW").subscribe(function(e){return d.successAllowMessage=e}),r.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_BLOCK").subscribe(function(e){return d.successBlockMessage=e}),r.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_DELETE").subscribe(function(e){return d.successDeleteMessage=e}),r.get("FACILITY_DETAIL.SERVICES_STATUS.ALREADY_DELETED").subscribe(function(e){return d.allreadyDeletedMessage=e})}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.parent.params.subscribe(function(t){e.facilityId=parseInt(t.facilityId,10),e.facility={id:e.facilityId,beanName:"Facility"},e.refreshTable()})}},{key:"forcePropagation",value:function(){var e,t=this,a=i(this.selected.selected);try{for(a.s();!(e=a.n()).done;){var n=e.value;this.servicesManager.forceServicePropagation(n.service.id,n.facility.id).subscribe(function(){t.refreshTable(),t.notificator.showSuccess(t.successFPMessage)})}}catch(s){a.e(s)}finally{a.f()}}},{key:"allow",value:function(){var e,t=this,a=i(this.selected.selected);try{for(a.s();!(e=a.n()).done;){var n=e.value;this.servicesManager.unblockServiceOnFacility(n.service.id,n.facility.id).subscribe(function(){t.refreshTable(),t.notificator.showSuccess(t.successAllowMessage)})}}catch(s){a.e(s)}finally{a.f()}}},{key:"block",value:function(){var e,t=this,a=i(this.selected.selected);try{for(a.s();!(e=a.n()).done;){var n=e.value;this.servicesManager.blockServiceOnFacility(n.service.id,n.facility.id).subscribe(function(){t.refreshTable(),t.notificator.showSuccess(t.successBlockMessage)})}}catch(s){a.e(s)}finally{a.f()}}},{key:"removeTaskResults",value:function(){var e=this;this.tasksManager.getTaskResultsForGUIByTask(this.selected.selected[0].task.id).subscribe(function(t){var i=(0,p.kZ)();i.width="600px",i.data={theme:"facility-theme",taskResults:t},e.dialog.open(Wi,i)})}},{key:"removeServiceFromFacility",value:function(){var e=this;this.facilityManager.getAssignedResourcesByAssignedServiceForFacility(this.selected.selected[0].facility.id,this.selected.selected[0].service.id).subscribe(function(t){var i=(0,p.kZ)();i.width="600px",e.taskId=e.taskIsNull?null:e.selected.selected[0].task.id,0===t.length?(i.data={theme:"facility-theme",taskId:e.taskId},e.dialog.open(oa,i).afterClosed().subscribe(function(t){t&&(e.disableRemoveButton=!0,e.refreshTable())})):e.resourcesManager.getRichResourcesByIds(t.map(function(e){return e.id})).subscribe(function(t){i.data={theme:"facility-theme",taskId:e.taskId,serviceId:e.selected.selected[0].service.id,facilityId:e.selected.selected[0].facility.id,resource:t},e.dialog.open(sa,i).afterClosed().subscribe(function(t){t&&(e.disableRemoveButton=!0,e.refreshTable())})})})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.tasksManager.getFacilityServicesState(this.facilityId).subscribe(function(t){e.servicesStates=t,e.selected.clear(),e.setAuthRights(),e.loading=!1})}},{key:"setAuthRights",value:function(){this.propagationAuth=this.authResolver.isAuthorized("forceServicePropagation_Facility_Service_policy",[this.facility]),this.blockAuth=this.authResolver.isAuthorized("blockServiceOnFacility_Service_Facility_policy",[this.facility]),this.allowAuth=this.authResolver.isAuthorized("unblockServiceOnFacility_Service_Facility_policy",[this.facility]),this.deleteAuth=this.authResolver.isAuthorized("deleteTask_Task_policy",[this.facility]),this.routeAuth=this.authResolver.isAuthorized("getTaskResultsByTask_int_policy",[this.facility])}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"selectionChanged",value:function(){this.disableBlockButton=!0,this.disableAllowButton=!0,this.disableRemoveButton=1!==this.selected.selected.length,this.disableRemoveButton||(this.taskIsNull=null===this.selected.selected[0].task);var e,t=i(this.selected.selected);try{for(t.s();!(e=t.n()).done;){e.value.blockedOnFacility?this.disableAllowButton=!1:this.disableBlockButton=!1}}catch(a){t.e(a)}finally{t.f()}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(c.gz),A.Y36(f.Ob),A.Y36(f.KK),A.Y36(g.V6),A.Y36(_.sK),A.Y36(g.x4),A.Y36(f.IQ),A.Y36(f.xk),A.Y36(S.uw))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-service-status"]],decls:18,vars:14,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent","class","mr-2",3,"disabled","click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2",3,"disabled","click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2 dropdown-toggle",3,"matTooltip","matTooltipDisabled","disabled","matMenuTriggerFor",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","filterValue","servicesStatus","selection","disableRouting","selectionChange",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2",3,"disabled","click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],["mat-flat-button","","color","warn",1,"mr-2","dropdown-toggle",3,"matTooltip","matTooltipDisabled","disabled","matMenuTriggerFor"],[1,"ml-auto","mr-auto"],[3,"tableId","filterValue","servicesStatus","selection","disableRouting","selectionChange"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"perun-web-apps-refresh-button",1),A.NdJ("refresh",function(){return t.refreshTable()}),A.qZA(),A.YNc(5,Fa,3,4,"button",2),A.YNc(6,Ma,3,4,"button",2),A.YNc(7,Ua,3,4,"button",3),A.YNc(8,qa,4,9,"button",4),A.TgZ(9,"mat-menu",null,5),A.YNc(11,Ja,3,3,"button",6),A.TgZ(12,"button",7),A.NdJ("click",function(){return t.removeServiceFromFacility()}),A._uU(13),A.ALo(14,"translate"),A.qZA(),A.qZA(),A.TgZ(15,"perun-web-apps-immediate-filter",8),A.NdJ("filter",function(e){return t.applyFilter(e)}),A.qZA(),A.YNc(16,Qa,1,0,"mat-spinner",9),A.YNc(17,Va,1,5,"perun-web-apps-services-status-list",10),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,10,"FACILITY_DETAIL.SERVICES_STATUS.TITLE")),A.xp6(3),A.Q6J("ngIf",!t.loading&&t.propagationAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.allowAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.blockAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.deleteAuth),A.xp6(3),A.Q6J("ngIf",!t.taskIsNull),A.xp6(2),A.Oqu(A.lcZ(14,12,"FACILITY_DETAIL.SERVICES_STATUS.REMOVE_SERVICE_FROM_FACILITY")),A.xp6(2),A.Q6J("placeholder","SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.TABLE_SEARCH"),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[Ge.t,o.O5,ca.VK,ca.OP,ze.L,C.lW,E.gM,ca.p6,y.$g,Ya],pipes:[_.X$],styles:[""]}),e}(),Pa=r(67004),Ba=r(91058),Ga=r(27521),za=r(19386),$a=r(42847),ja=r(44973),Ka=function(){var e=function e(){s(this,e),this.service=null,this.serviceSelected=new A.vpe,this.nameFunction=function(e){return e.name},this.secondaryFunction=function(){return null},this.searchFunction=function(e){return e.name}};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=A.Xpm({type:e,selectors:[["perun-web-apps-service-search-select"]],inputs:{service:"service",services:"services"},outputs:{serviceSelected:"serviceSelected"},decls:4,vars:14,consts:[[3,"entity","entities","searchFunction","mainTextFunction","secondaryTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","entitySelected"]],template:function(e,t){1&e&&(A.TgZ(0,"perun-web-apps-entity-search-select",0),A.NdJ("entitySelected",function(e){return t.serviceSelected.emit(e)}),A.ALo(1,"translate"),A.ALo(2,"translate"),A.ALo(3,"translate"),A.qZA()),2&e&&A.Q6J("entity",t.service)("entities",t.services)("searchFunction",t.searchFunction)("mainTextFunction",t.nameFunction)("secondaryTextFunction",t.secondaryFunction)("selectPlaceholder",A.lcZ(1,8,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_SEARCH_SELECT.SELECT_SERVICE"))("findPlaceholder",A.lcZ(2,10,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_SEARCH_SELECT.FIND_SERVICE"))("noEntriesText",A.lcZ(3,12,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_SEARCH_SELECT.NO_SERVICE_FOUND"))},directives:[ja.i],pipes:[_.X$],styles:[""]}),e}(),Wa=r(16247);function Xa(e,t){1&e&&A._UZ(0,"mat-spinner",12)}var en=function(){return["id","name","email","logins","organization"]};function tn(e,t){if(1&e&&A._UZ(0,"perun-web-apps-users-dynamic-list",13),2&e){var i=A.oxw();A.Q6J("tableId",i.tableId)("searchString",i.filterValue)("displayedColumns",A.DdM(10,en))("attrNames",i.attributes)("facilityId",i.facilityId)("voId",-1===i.selectedVo.id?null:i.selectedVo.id)("resourceId",-1===i.selectedResource.id?null:i.selectedResource.id)("serviceId",-1===i.selectedService.id?null:i.selectedService.id)("onlyAllowed",i.allowed)("disableRouting",!i.routeAuth)}}var an=function(){var e=function(){function e(t,i,a,n,r,l){s(this,e),this.route=t,this.facilityService=i,this.serviceService=a,this.resourceService=n,this.authResolver=r,this.storeService=l,this.loading=!1,this.filterValue="",this.attributes=[],this.allowed=!0,this.emptyResource={id:-1,beanName:"Resource",name:"No filter"},this.resources=[this.emptyResource],this.filteredResources=[this.emptyResource],this.selectedResource=this.emptyResource,this.emptyVo={id:-1,beanName:"Vo",name:"No filter"},this.vos=[this.emptyVo],this.selectedVo=this.emptyVo,this.emptyService={id:-1,beanName:"Service",name:"No filter"},this.services=[this.emptyService],this.filteredServices=[this.emptyService],this.selectedService=this.emptyService,this.resourceAssignedServices=new Map,this.tableId=Oe.z6,this.toggle_messages=["FACILITY_DETAIL.ALLOWED_USERS.FILTER_ASSIGNED_MSG","FACILITY_DETAIL.ALLOWED_USERS.FILTER_ALLOWED_MSG"]}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.attributes=[Pa.r.USER_DEF_ORGANIZATION,Pa.r.USER_DEF_PREFERRED_MAIL],this.attributes=this.attributes.concat(this.storeService.getLoginAttributeNames()),this.route.parent.params.subscribe(function(t){e.facilityId=t.facilityId,e.routeAuth=e.authResolver.isPerunAdminOrObserver(),e.refreshPage()},function(){return e.loading=!1})}},{key:"refreshPage",value:function(){var e=this;this.loading=!0,this.facilityService.getAssignedResourcesForFacility(this.facilityId).subscribe(function(t){e.resources=[e.emptyResource].concat(t),e.filteredResources=e.resources,e.selectedResource=e.emptyResource,e.facilityService.getAllowedVos(e.facilityId).subscribe(function(t){e.vos=[e.emptyVo].concat(t),e.selectedVo=e.emptyVo,e.services=[],e.getAssignedServices(e.resources,e.resources.length-1)},function(){return e.loading=!1})},function(){return e.loading=!1})}},{key:"getAssignedServices",value:function(e,t){var i=this;if(0===t)return this.services=[this.emptyService].concat(this.services),this.filteredServices=this.services,this.selectedService=this.emptyService,void(this.loading=!1);this.resourceService.getAssignedServicesToResource(e[t].id).subscribe(function(a){i.services=i.services.concat(a),i.resourceAssignedServices[e[t].id]=a.map(function(e){return e.id}),i.getAssignedServices(e,t-1)},function(){return i.loading=!1})}},{key:"getFilteredServices",value:function(e){var t=this,i=new Set;return e.forEach(function(e){t.resourceAssignedServices[e.id].forEach(function(e){return i.add(e)})}),[this.emptyService].concat(this.services.filter(function(e){return i.has(e.id)}))}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"voSelected",value:function(e){this.selectedVo.id!==e.id&&(this.selectedVo=e,this.selectedResource=this.emptyResource,this.selectedService=this.emptyService,-1===e.id?(this.filteredResources=this.resources,this.filteredServices=this.services):(this.filteredResources=this.resources.filter(function(t){return t.voId===e.id}),this.filteredServices=this.getFilteredServices(this.filteredResources),this.filteredResources=[this.emptyResource].concat(this.filteredResources)))}},{key:"resourceSelected",value:function(e){this.selectedResource.id!==e.id&&(this.selectedResource=e,this.selectedService=this.emptyService,this.filteredServices=-1===e.id?this.services:this.getFilteredServices([e]))}},{key:"serviceSelected",value:function(e){this.selectedService=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(c.gz),A.Y36(f.IQ),A.Y36(f.KK),A.Y36(f.xk),A.Y36(g.x4),A.Y36(g.d6))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-allowed-users"]],decls:20,vars:20,consts:[[1,"page-subtitle"],[1,"filters"],[1,"mr-2",3,"refresh"],[1,"mr-2","filter",3,"placeholder","filter"],[1,"toggle"],["labelPosition","before",1,"mr-2",3,"ngModel","ngModelChange"],[1,"text-muted"],[1,"search-select",3,"vo","vos","voSelected"],[1,"search-select",3,"displayStatus","resource","resources","resourceSelected"],[1,"search-select",3,"service","services","serviceSelected"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","searchString","displayedColumns","attrNames","facilityId","voId","resourceId","serviceId","onlyAllowed","disableRouting",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"tableId","searchString","displayedColumns","attrNames","facilityId","voId","resourceId","serviceId","onlyAllowed","disableRouting"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"div",1),A.TgZ(5,"perun-web-apps-refresh-button",2),A.NdJ("refresh",function(){return t.refreshPage()}),A.qZA(),A.TgZ(6,"perun-web-apps-debounce-filter",3),A.NdJ("filter",function(e){return t.applyFilter(e)}),A.qZA(),A.TgZ(7,"div",4),A.TgZ(8,"mat-slide-toggle",5),A.NdJ("ngModelChange",function(e){return t.allowed=e}),A._uU(9),A.ALo(10,"translate"),A.qZA(),A.TgZ(11,"span",6),A._uU(12),A.ALo(13,"translate"),A.qZA(),A.qZA(),A.qZA(),A.TgZ(14,"div",1),A.TgZ(15,"perun-web-apps-vo-search-select",7),A.NdJ("voSelected",function(e){return t.voSelected(e)}),A.qZA(),A.TgZ(16,"perun-web-apps-resource-search-select",8),A.NdJ("resourceSelected",function(e){return t.resourceSelected(e)}),A.qZA(),A.TgZ(17,"perun-web-apps-service-search-select",9),A.NdJ("serviceSelected",function(e){return t.serviceSelected(e)}),A.qZA(),A.qZA(),A.YNc(18,Xa,1,0,"mat-spinner",10),A.YNc(19,tn,1,11,"perun-web-apps-users-dynamic-list",11),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,14,"FACILITY_DETAIL.ALLOWED_USERS.TITLE")),A.xp6(4),A.Q6J("placeholder","FACILITY_DETAIL.ALLOWED_USERS.FILTER"),A.xp6(2),A.Q6J("ngModel",t.allowed),A.xp6(1),A.hij(" ",A.lcZ(10,16,"FACILITY_DETAIL.ALLOWED_USERS.FILTER_ALLOWED")," "),A.xp6(3),A.Oqu(A.lcZ(13,18,t.toggle_messages[t.allowed?1:0])),A.xp6(3),A.Q6J("vo",t.selectedVo)("vos",t.vos),A.xp6(1),A.Q6J("displayStatus",!1)("resource",t.selectedResource)("resources",t.filteredResources),A.xp6(1),A.Q6J("service",t.selectedService)("services",t.filteredServices),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[Ge.t,Ba.P,Ga.Rr,re.JJ,re.On,za.M,$a.L,Ka,o.O5,y.$g,Wa.M],pipes:[_.X$],styles:[".filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:baseline}.filter[_ngcontent-%COMP%]{min-width:350px}.search-select[_ngcontent-%COMP%]{width:32%;margin-right:20px;margin-top:30px}.toggle[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),e}(),nn=r(95142);function sn(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"th",19),A.TgZ(1,"mat-checkbox",20),A.NdJ("change",function(e){A.CHM(i);var t=A.oxw();return e?t.masterToggle():null}),A.qZA(),A.qZA()}if(2&e){var a=A.oxw();A.xp6(1),A.Q6J("aria-label",a.checkboxLabel())("checked",a.selection.hasValue()&&a.isAllSelected())("indeterminate",a.selection.hasValue()&&!a.isAllSelected())}}function rn(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"td",21),A.TgZ(1,"mat-checkbox",22),A.NdJ("change",function(e){var t=A.CHM(i).$implicit,a=A.oxw();return e?a.selection.toggle(t):null})("click",function(e){return e.stopPropagation()}),A.qZA(),A.qZA()}if(2&e){var a=t.$implicit,n=A.oxw();A.xp6(1),A.Q6J("aria-label",n.checkboxLabel(a))("checked",n.selection.isSelected(a))}}function ln(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.RESULT_ID")))}function on(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.id)}}function cn(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.DESTINATION")))}function un(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.destination.destination)}}function dn(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.TYPE")))}function hn(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.destination.type.toUpperCase())}}function fn(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.SERVICE")))}function pn(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.service.name)}}function gn(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.STATUS")))}function mn(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.status)}}function vn(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.TIME")))}function An(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.ALo(2,"date"),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(A.xi3(2,1,i.timestamp,"d.M.y H:mm:ss"))}}function Sn(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.RETURN_CODE")))}function In(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.returnCode)}}function Tn(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.STANDARD_MESSAGE")))}function yn(e,t){if(1&e&&(A.TgZ(0,"span"),A._uU(1),A._UZ(2,"br"),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i)}}function bn(e,t){if(1&e&&(A.TgZ(0,"td",21),A.YNc(1,yn,3,1,"span",24),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Q6J("ngForOf",i.standardMessage.split("\n"))}}function En(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.ERROR_MESSAGE")))}function Zn(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.errorMessage)}}function Cn(e,t){1&e&&A._UZ(0,"tr",25)}function _n(e,t){if(1&e&&A._UZ(0,"tr",26),2&e){var i=t.$implicit;A.ekj("greenTableItem","DONE"===i.status)("redTableItem","ERROR"===i.status||"DENIED"===i.status)("yellowTableItem","WARNING"===i.status)}}function Ln(e,t){1&e&&(A.TgZ(0,"app-alert",27),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}function kn(e,t){1&e&&(A.TgZ(0,"app-alert",27),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.NO_RESULTS_WARNING"),"\n"))}var On=function(){var e=function(){function e(t,i){s(this,e),this.authResolver=t,this.tableCheckbox=i,this.pageSizeOptions=p.f7,this.taskResults=[],this.selection=new xe.Ov(!0,[]),this.displayedColumns=["select","id","destination","type","service","status","time","returnCode","standardMessage","errorMessage"]}return l(e,[{key:"matSort",set:function(e){this.sort=e,this.setDataSource()}},{key:"ngOnChanges",value:function(){this.authResolver.isPerunAdminOrObserver()||(this.displayedColumns=this.displayedColumns.filter(function(e){return"id"!==e})),this.dataSource=new lt.by(this.taskResults),this.setDataSource(),this.dataSource.filter=this.filterValue}},{key:"getDataForColumn",value:function(e,t){switch(t){case"id":return e.id.toString();case"destination":return e.destination.destination;case"type":return e.destination.type;case"service":return e.service.name;case"status":return e.status;case"time":return(0,o.p6)(e.timestamp.toString(),"d.M.y H:mm:ss","en");case"returnCode":return e.returnCode.toString();case"standardMessage":return e.standardMessage;case"errorMessage":return e.errorMessage;default:return""}}},{key:"getSortDataForColumn",value:function(e,t){switch(t){case"id":return e.id.toString();case"destination":return e.destination.destination;case"type":return e.destination.type;case"service":return e.service.name;case"status":return e.status;case"time":return(0,o.p6)(e.timestamp.toString(),"yyyy.MM.dd HH:mm:ss","en");case"returnCode":return e.returnCode.toString();case"standardMessage":return e.standardMessage;case"errorMessage":return e.errorMessage;default:return""}}},{key:"exportData",value:function(e){(0,p.O6)((0,p.Xn)(this.dataSource.filteredData,this.displayedColumns,this.getDataForColumn,this),e)}},{key:"setDataSource",value:function(){var e=this;this.dataSource&&(this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue,this.dataSource.filterPredicate=function(t,i){return(0,p.Sd)(t,i,e.displayedColumns,e.getDataForColumn,e)},this.dataSource.sortData=function(t,i){return(0,p.pR)(t,i,e.getSortDataForColumn,e)})}},{key:"isAllSelected",value:function(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.child.paginator.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}},{key:"masterToggle",value:function(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}},{key:"checkboxLabel",value:function(e){return e?"".concat(this.selection.isSelected(e)?"deselect":"select"," row ").concat(e.id+1):(this.isAllSelected()?"select":"deselect")+" all"}},{key:"ngAfterViewInit",value:function(){this.dataSource.paginator=this.child.paginator}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(g.x4),A.Y36(g.UA))},e.\u0275cmp=A.Xpm({type:e,selectors:[["perun-web-apps-task-results-list"]],viewQuery:function(e,t){var i;(1&e&&(A.Gf(Nt.YE,7),A.Gf(p.l9,7)),2&e)&&(A.iGM(i=A.CRH())&&(t.matSort=i.first),A.iGM(i=A.CRH())&&(t.child=i.first))},inputs:{taskResults:"taskResults",selection:"selection",filterValue:"filterValue",tableId:"tableId",displayedColumns:"displayedColumns"},features:[A.TTD],decls:37,vars:9,consts:[[1,"card","mt-3",3,"hidden"],[3,"tableId","dataLength","pageSizeOptions","exportData"],["mat-table","","matSort","","matSortActive","time","matSortDirection","desc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","destination"],["matColumnDef","type"],["matColumnDef","service"],["matColumnDef","status"],["matColumnDef","time"],["matColumnDef","returnCode"],["matColumnDef","standardMessage"],["matColumnDef","errorMessage"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",3,"greenTableItem","redTableItem","yellowTableItem",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],[4,"ngFor","ngForOf"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"],["alert_type","warn"]],template:function(e,t){1&e&&(A.TgZ(0,"div",0),A.TgZ(1,"perun-web-apps-table-wrapper",1),A.NdJ("exportData",function(e){return t.exportData(e)}),A.TgZ(2,"table",2),A.ynx(3,3),A.YNc(4,sn,2,3,"th",4),A.YNc(5,rn,2,2,"td",5),A.BQk(),A.ynx(6,6),A.YNc(7,ln,3,3,"th",7),A.YNc(8,on,2,1,"td",5),A.BQk(),A.ynx(9,8),A.YNc(10,cn,3,3,"th",7),A.YNc(11,un,2,1,"td",5),A.BQk(),A.ynx(12,9),A.YNc(13,dn,3,3,"th",7),A.YNc(14,hn,2,1,"td",5),A.BQk(),A.ynx(15,10),A.YNc(16,fn,3,3,"th",7),A.YNc(17,pn,2,1,"td",5),A.BQk(),A.ynx(18,11),A.YNc(19,gn,3,3,"th",7),A.YNc(20,mn,2,1,"td",5),A.BQk(),A.ynx(21,12),A.YNc(22,vn,3,3,"th",7),A.YNc(23,An,3,4,"td",5),A.BQk(),A.ynx(24,13),A.YNc(25,Sn,3,3,"th",7),A.YNc(26,In,2,1,"td",5),A.BQk(),A.ynx(27,14),A.YNc(28,Tn,3,3,"th",7),A.YNc(29,bn,2,1,"td",5),A.BQk(),A.ynx(30,15),A.YNc(31,En,3,3,"th",7),A.YNc(32,Zn,2,1,"td",5),A.BQk(),A.YNc(33,Cn,1,0,"tr",16),A.YNc(34,_n,1,6,"tr",17),A.qZA(),A.qZA(),A.qZA(),A.YNc(35,Ln,3,3,"app-alert",18),A.YNc(36,kn,3,3,"app-alert",18)),2&e&&(A.Q6J("hidden",0===t.dataSource.filteredData.length||0===t.taskResults.length),A.xp6(1),A.Q6J("tableId",t.tableId)("dataLength",t.dataSource.filteredData.length)("pageSizeOptions",t.pageSizeOptions),A.xp6(1),A.Q6J("dataSource",t.dataSource),A.xp6(31),A.Q6J("matHeaderRowDef",t.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",t.displayedColumns),A.xp6(1),A.Q6J("ngIf",0===t.dataSource.filteredData.length&&0!==t.taskResults.length),A.xp6(1),A.Q6J("ngIf",0===t.taskResults.length))},directives:[wt.l,lt.BZ,Nt.YE,lt.w1,lt.fO,lt.Dz,lt.as,lt.nj,o.O5,lt.ge,ue.oG,lt.ev,Nt.nU,o.sg,lt.XQ,lt.Gk,Ft.w],pipes:[_.X$,o.uU],styles:[".greenTableItem[_ngcontent-%COMP%]{background-color:#c4ffcb}.yellowTableItem[_ngcontent-%COMP%]{background-color:#fffde7}.redTableItem[_ngcontent-%COMP%]{background-color:#ffcdd2}"]}),e}();function xn(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",8),A.NdJ("click",function(){return A.CHM(i),A.oxw(2).removeTaskResult()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw(2);A.Q6J("disabled",0===a.selection.selected.length),A.xp6(1),A.hij(" ",A.lcZ(2,2,"FACILITY_DETAIL.TASK_RESULTS.REMOVE")," ")}}function Rn(e,t){1&e&&A._UZ(0,"mat-spinner",9)}function Dn(e,t){if(1&e&&A._UZ(0,"perun-web-apps-task-results-list",10),2&e){var i=A.oxw(2);A.Q6J("tableId",i.tableId)("displayedColumns",i.displayedColumns)("filterValue",i.filterValue)("selection",i.selection)("taskResults",i.taskResults)}}function Nn(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"div"),A.TgZ(1,"h1",1),A._uU(2),A.ALo(3,"translate"),A.TgZ(4,"span",2),A._uU(5),A.qZA(),A.qZA(),A.TgZ(6,"perun-web-apps-refresh-button",3),A.NdJ("refresh",function(){return A.CHM(i),A.oxw().refreshTable()}),A.qZA(),A.YNc(7,xn,3,4,"button",4),A.TgZ(8,"perun-web-apps-immediate-filter",5),A.NdJ("filter",function(e){return A.CHM(i),A.oxw().applyFilter(e)}),A.qZA(),A.YNc(9,Rn,1,0,"mat-spinner",6),A.YNc(10,Dn,1,5,"perun-web-apps-task-results-list",7),A.qZA()}if(2&e){var a=A.oxw();A.xp6(2),A.AsE("",A.lcZ(3,7,"FACILITY_DETAIL.TASK_RESULTS.TITLE")," - ",a.task.service.name," "),A.xp6(3),A.hij(" \xa0#",a.task.id," "),A.xp6(2),A.Q6J("ngIf",!a.loading&&a.removeAuth),A.xp6(1),A.Q6J("placeholder","FACILITY_DETAIL.TASK_RESULTS.FILTER"),A.xp6(1),A.Q6J("ngIf",a.loading),A.xp6(1),A.Q6J("ngIf",!a.loading)}}var wn,Yn=function(){var e=function(){function e(t,i,a,n){s(this,e),this.route=t,this.taskManager=i,this.authResolver=a,this.dialog=n,this.loading=!1,this.filterValue="",this.selection=new xe.Ov(!0,[]),this.tableId=Oe.e5,this.displayedColumns=["select","id","destination","type","service","status","time","returnCode","standardMessage","errorMessage"],this.removeAuth=!1}return l(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.parent.params.subscribe(function(t){e.facility={id:parseInt(t.facilityId,10),beanName:"Facility"},e.removeAuth=e.authResolver.isAuthorized("deleteTask_Task_policy",[e.facility]),e.removeAuth||(e.displayedColumns=["id","destination","type","service","status","time","returnCode","standardMessage","errorMessage"]),e.route.params.subscribe(function(t){e.taskId=t.taskId,e.taskManager.getTaskById(e.taskId).subscribe(function(t){e.task=t,e.refreshTable()})})})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.taskManager.getTaskResultsForGUIByTask(this.taskId).subscribe(function(t){e.selection.clear(),e.taskResults=t,e.loading=!1})}},{key:"removeTaskResult",value:function(){var e=this,t=(0,p.kZ)();t.width="600px",t.data={theme:"facility-theme",taskResults:this.selection.selected},this.dialog.open(Wi,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}},{key:"applyFilter",value:function(e){this.filterValue=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(c.gz),A.Y36(f.Ob),A.Y36(g.x4),A.Y36(S.uw))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-task-results"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-subtitle"],[1,"text-muted"],[3,"refresh"],["class","mr-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","displayedColumns","filterValue","selection","taskResults",4,"ngIf"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"tableId","displayedColumns","filterValue","selection","taskResults"]],template:function(e,t){1&e&&A.YNc(0,Nn,11,9,"div",0),2&e&&A.Q6J("ngIf",!t.loading)},directives:[o.O5,Ge.t,ze.L,C.lW,y.$g,On],pipes:[_.X$],styles:[""]}),e}(),Fn=r(53134),Mn=[{path:"",component:u.P},{path:":facilityId",component:N,children:[{path:"",component:M,data:{animation:"FacilityOverviewPage"}},{path:"attributes",component:te,data:{animation:"FacilityAttributesPage"}},{path:"resources",component:U.f,data:{animation:"FacilityResourcesPage"}},{path:"allowed-users",component:an,data:{animation:"FacilityAllowedUsersPage"}},{path:"allowed-groups",component:q.o,data:{animation:"FacilityAllowedGroupsPage"}},{path:"services-status",component:Ha,data:{animation:"FacilityServiceStatusPage"}},{path:"services-status/:taskId",component:Yn,data:{animation:"FacilityTaskResultsPage"}},{path:"service-config",component:Ce,data:{animation:"FacilityServiceConfigPage"}},{path:"services-destinations",component:it,data:{animation:"FacilityServicesDestinationsPage"}},{path:"hosts",component:ei,data:{animation:"FacilityHostsPage"}},{path:"hosts/:hostId",component:bi,data:{animation:"FacilityHostsDetailPage"}},{path:"settings",component:V,children:[{path:"",component:B,data:{animation:"FacilitySettingsOverviewPage"}},{path:"owners",component:Tt,data:{animation:"FacilitySettingOwnersPage"}},{path:"managers",component:ke,data:{animation:"FacilitySettingsManagersPage"}},{path:"security-teams",component:Ui,data:{animation:"FacilitySecurityTeamsPage"}},{path:"blacklist",component:mi,data:{animation:"FacilitySettingsBlackListPage"}}]}]},{path:":facilityId/resources/:resourceId",component:J.b,children:[{path:"",component:Q.H,data:{animation:"ResourceOverviewPage"}},{path:"attributes",component:ne.X,data:{animation:"ResourceAttributesPage"}},{path:"groups",component:se.K,data:{animation:"ResourceGroupsComponent"}},{path:"services",component:Ji.D,data:{animation:"ResourceAssignedServicesComponent"}},{path:"members",component:nn.y,data:{animation:"ResourceAssignedMembersComponent"}},{path:"tags",component:Fn.v,data:{animation:"ResourceTagsComponent"}},{path:"settings",component:ie.t,children:[{path:"",component:ae.h,data:{animation:"ResourceSettingsOverviewPage"}},{path:"managers",component:qi.O,data:{animation:"ResourceSettingsManagersPage"}}]}]}],Un=function(){var e=function e(){s(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=A.oAB({type:e}),e.\u0275inj=A.cJS({imports:[[c.Bz.forChild(Mn)],c.Bz]}),e}(),qn=r(28780),Jn=r(22727),Qn=r(65515),Vn=((wn=function e(){s(this,e)}).\u0275fac=function(e){return new(e||wn)},wn.\u0275mod=A.oAB({type:wn}),wn.\u0275inj=A.cJS({providers:[ce.dp],imports:[[o.ez,Un,qn.m,Jn.r,vi.ez,ce.d4,Qn.UsersModule]]}),wn)}}])}();