"use strict";(self.webpackChunkadmin_gui=self.webpackChunkadmin_gui||[]).push([[243],{15003:($,K,o)=>{o.d(K,{G:()=>f});var S=o(94650);let f=(()=>{class n{constructor(){this.entityDetailChange=new S.vpe}reloadEntityDetail(){this.entityDetailChange.emit()}}return n.\u0275fac=function(C){return new(C||n)},n.\u0275prov=S.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},76023:($,K,o)=>{o.d(K,{y:()=>B});var S=o(32105),f=o(10036),n=o(69723),d=o(94650),C=o(94364),s=o(36895),t=o(51572),e=o(96214),Y=o(38383),w=o(64901),i=o(89383);function P(G,N){1&G&&d._UZ(0,"mat-spinner",5)}const M=function(){return["id","fullName"]};function x(G,N){if(1&G){const T=d.EpF();d.TgZ(0,"perun-web-apps-members-list",6),d.NdJ("updateTable",function(){d.CHM(T);const F=d.oxw();return d.KtG(F.refreshTable())}),d.qZA()}if(2&G){const T=d.oxw();d.Q6J("displayedColumns",d.DdM(5,M))("disableRouting",!T.routeAuth)("filter",T.filterValue)("members",T.members)("tableId",T.tableId)}}let B=(()=>{class G{constructor(T,J,F,W){this.route=T,this.resourceService=J,this.authResolver=F,this.entityStorageService=W,this.loading=!1,this.filterValue="",this.tableId=f.iQ}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.resourceService.getAssignedRichMembers(this.resource.id).subscribe(T=>{this.members=T,this.setAuthRights(),this.loading=!1})}setAuthRights(){0!==this.members.length&&(this.routeAuth=this.authResolver.isAuthorized("getMemberById_int_policy",[this.members[0]]))}applyFilter(T){this.filterValue=T}}return G.\u0275fac=function(T){return new(T||G)(d.Y36(C.gz),d.Y36(S.xk),d.Y36(n.x4),d.Y36(n.fb))},G.\u0275cmp=d.Xpm({type:G,selectors:[["app-resource-assigned-members"]],decls:7,vars:6,consts:[[1,"page-subtitle"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"displayedColumns","disableRouting","filter","members","tableId","updateTable",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"displayedColumns","disableRouting","filter","members","tableId","updateTable"]],template:function(T,J){1&T&&(d.TgZ(0,"h1",0),d._uU(1),d.ALo(2,"translate"),d.qZA(),d.TgZ(3,"perun-web-apps-refresh-button",1),d.NdJ("refresh",function(){return J.refreshTable()}),d.qZA(),d.TgZ(4,"perun-web-apps-debounce-filter",2),d.NdJ("filter",function(W){return J.applyFilter(W)}),d.qZA(),d.YNc(5,P,1,0,"mat-spinner",3),d.YNc(6,x,1,6,"perun-web-apps-members-list",4)),2&T&&(d.xp6(1),d.Oqu(d.lcZ(2,4,"RESOURCE_DETAIL.ASSIGNED_MEMBERS.TITLE")),d.xp6(3),d.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_MEMBERS.FILTER"),d.xp6(1),d.Q6J("ngIf",J.loading),d.xp6(1),d.Q6J("ngIf",!J.loading))},dependencies:[s.O5,t.Ou,e.t,Y.O,w.P,i.X$]}),G})()},49546:($,K,o)=>{o.d(K,{D:()=>L});var S=o(32105),f=o(10036),n=o(95017),d=o(9244),C=o(65412),s=o(69723),t=o(94650),e=o(89383),Y=o(36895),w=o(4859),i=o(3848),P=o(51572),M=o(64901),x=o(90439),B=o(60205);function G(E,m){1&E&&t._UZ(0,"mat-spinner",6)}const N=function(){return["id","name","enabled","description"]};function T(E,m){if(1&E&&t._UZ(0,"app-services-list",16),2&E){const c=t.oxw(2);t.Q6J("disableRouting",!0)("services",c.filteredServices)("displayedColumns",t.DdM(5,N))("selection",c.selection)("tableId",c.tableId)}}const J=function(){return["select","id","name","enabled","description"]};function F(E,m){if(1&E){const c=t.EpF();t.TgZ(0,"div",7)(1,"mat-tab-group",8),t.NdJ("selectedTabChange",function(){t.CHM(c);const u=t.oxw();return t.KtG(u.tabChanged())}),t.TgZ(2,"mat-tab",9),t.ALo(3,"translate"),t.TgZ(4,"div",10)(5,"perun-web-apps-debounce-filter",11),t.NdJ("filter",function(u){t.CHM(c);const U=t.oxw();return t.KtG(U.applyFilter(u))}),t.ALo(6,"translate"),t.qZA()(),t._UZ(7,"app-services-list",12),t.qZA(),t.TgZ(8,"mat-tab",9),t.ALo(9,"translate"),t.TgZ(10,"div",13)(11,"perun-web-apps-service-package-search-select",14),t.NdJ("packageSelected",function(u){t.CHM(c);const U=t.oxw();return t.KtG(U.servicePackageSelected(u))}),t.qZA()(),t.YNc(12,T,1,6,"app-services-list",15),t.qZA()()()}if(2&E){const c=t.oxw();t.xp6(2),t.s9C("label",t.lcZ(3,12,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SELECT_SERVICE")),t.xp6(3),t.s9C("placeholder",t.lcZ(6,14,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.FILTER_DESCRIPTION")),t.xp6(2),t.Q6J("services",c.unAssignedServices)("disableRouting",!0)("displayedColumns",t.DdM(18,J))("filterValue",c.filterValue)("selection",c.selection)("tableId",c.tableId),t.xp6(1),t.s9C("label",t.lcZ(9,16,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SELECT_PACKAGE")),t.xp6(3),t.Q6J("selectedPackage",c.selectedPackage)("servicePackages",c.servicePackages),t.xp6(1),t.Q6J("ngIf",-1!==c.selectedPackage.id)}}let W=(()=>{class E{constructor(c,h,u,U,g,O){this.dialogRef=c,this.data=h,this.notificator=u,this.translate=U,this.resourceManager=g,this.servicesManager=O,this.loading=!1,this.unAssignedServices=[],this.filteredServices=[],this.servicePackages=[],this.selectedPackage={name:"Not selected",description:"",id:-1,beanName:"ServicePackage"},this.selection=new n.Ov(!0,[]),this.tableId=f.DR,this.filterValue=""}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resourceManager.getAssignedServicesToResource(this.data.resourceId).subscribe(c=>{this.servicesManager.getServices().subscribe(h=>{this.servicesManager.getServicesPackages().subscribe(u=>{this.servicePackages.push(this.selectedPackage),this.servicePackages=this.servicePackages.concat(u),this.unAssignedServices=h;for(const U of c)for(const g of h)U.id===g.id&&this.unAssignedServices.splice(this.unAssignedServices.indexOf(g),1);this.loading=!1})})})}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0,-1!==this.selectedPackage.id?this.addServicePackage():this.addServices()}applyFilter(c){this.filterValue=c}servicePackageSelected(c){this.selectedPackage=c,-1!==c.id?this.servicesManager.getServicesFromServicesPackage(c.id).subscribe(h=>{this.filteredServices=h}):this.filteredServices=[]}tabChanged(){this.selection.clear(),this.filterValue="",this.selectedPackage=this.servicePackages[0]}addServicePackage(){this.resourceManager.assignServicesPackage(this.data.resourceId,this.selectedPackage.id).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.PACKAGE_SUCCESS_MESSAGE").subscribe(c=>{this.notificator.showSuccess(c),0!==this.selection.selected.length?this.addServices():this.dialogRef.close(!0)})},()=>this.loading=!1)}addServices(){const c=[];for(const h of this.selection.selected)c.push(h.id);this.resourceManager.assignServices(this.data.resourceId,c).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SERVICE_SUCCESS_MESSAGE").subscribe(h=>{this.notificator.showSuccess(h),this.dialogRef.close(!0)})},()=>this.loading=!1)}}return E.\u0275fac=function(c){return new(c||E)(t.Y36(C.so),t.Y36(C.WI),t.Y36(s.V6),t.Y36(e.sK),t.Y36(S.xk),t.Y36(S.KK))},E.\u0275cmp=t.Xpm({type:E,selectors:[["app-perun-web-apps-assign-service-to-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[3,"selectedTabChange"],[3,"label"],[1,"mt-2"],[3,"placeholder","filter"],[3,"services","disableRouting","displayedColumns","filterValue","selection","tableId"],[1,"mt-3"],[3,"selectedPackage","servicePackages","packageSelected"],[3,"disableRouting","services","displayedColumns","selection","tableId",4,"ngIf"],[3,"disableRouting","services","displayedColumns","selection","tableId"]],template:function(c,h){1&c&&(t.TgZ(0,"div")(1,"h1",0),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.YNc(4,G,1,0,"mat-spinner",1),t.YNc(5,F,13,19,"div",2),t.TgZ(6,"div",3)(7,"button",4),t.NdJ("click",function(){return h.onCancel()}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"button",5),t.NdJ("click",function(){return h.onAdd()}),t._uU(11),t.ALo(12,"translate"),t.qZA()()()),2&c&&(t.Tol(h.theme),t.xp6(2),t.Oqu(t.lcZ(3,9,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.TITLE")),t.xp6(2),t.Q6J("ngIf",h.loading),t.xp6(1),t.Q6J("ngIf",!h.loading),t.xp6(3),t.hij(" ",t.lcZ(9,11,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.CANCEL_BUTTON")," "),t.xp6(2),t.Q6J("disabled",0===h.selection.selected.length&&-1===h.selectedPackage.id||h.loading),t.xp6(1),t.hij(" ",t.lcZ(12,13,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE."+(-1===h.selectedPackage.id?"ADD_SERVICES":"ADD_PACKAGE"))," "))},dependencies:[Y.O5,w.lW,i.SP,i.uX,C.uh,C.xY,C.H8,P.Ou,M.P,x.F,B.Q,e.X$]}),E})();var j=o(30671);function q(E,m){1&E&&t._UZ(0,"mat-spinner",6)}function te(E,m){1&E&&t._UZ(0,"th",15)}function se(E,m){if(1&E&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&E){const c=m.$implicit;t.xp6(1),t.Oqu(c.name)}}function y(E,m){1&E&&t._UZ(0,"tr",17)}function k(E,m){1&E&&t._UZ(0,"tr",18)}function A(E,m){if(1&E&&(t.TgZ(0,"div",7)(1,"p"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",8),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"table",9),t.ynx(8,10),t.YNc(9,te,1,0,"th",11),t.YNc(10,se,2,1,"td",12),t.BQk(),t.YNc(11,y,1,0,"tr",13),t.YNc(12,k,1,0,"tr",14),t.qZA()()),2&E){const c=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,5,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DESCRIPTION")," "),t.xp6(3),t.hij(" ",t.lcZ(6,7,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.ASK")," "),t.xp6(2),t.Q6J("dataSource",c.dataSource),t.xp6(4),t.Q6J("matHeaderRowDef",c.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",c.displayedColumns)}}let v=(()=>{class E{constructor(c,h,u,U,g){this.dialogRef=c,this.data=h,this.notificator=u,this.translate=U,this.resourcesManager=g,this.displayedColumns=["name"]}ngOnInit(){this.theme=this.data.theme,this.dataSource=new j.by(this.data.services)}onSubmit(){this.loading=!0;const c=[];for(const h of this.data.services)c.push(h.id);this.resourcesManager.removeServices(this.data.resourceId,c).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.SUCCESS").subscribe(h=>{this.notificator.showSuccess(h),this.dialogRef.close(!0)})},()=>this.loading=!1)}onCancel(){this.dialogRef.close()}}return E.\u0275fac=function(c){return new(c||E)(t.Y36(C.so),t.Y36(C.WI),t.Y36(s.V6),t.Y36(e.sK),t.Y36(S.xk))},E.\u0275cmp=t.Xpm({type:E,selectors:[["app-perun-web-apps-remove-service-from-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","warn","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(c,h){1&c&&(t.TgZ(0,"div")(1,"h1",0),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.YNc(4,q,1,0,"mat-spinner",1),t.YNc(5,A,13,9,"div",2),t.TgZ(6,"div",3)(7,"button",4),t.NdJ("click",function(){return h.onCancel()}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"button",5),t.NdJ("click",function(){return h.onSubmit()}),t._uU(11),t.ALo(12,"translate"),t.qZA()()()),2&c&&(t.Tol(h.theme),t.xp6(2),t.Oqu(t.lcZ(3,9,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.TITLE")),t.xp6(2),t.Q6J("ngIf",h.loading),t.xp6(1),t.Q6J("ngIf",!h.loading),t.xp6(3),t.hij(" ",t.lcZ(9,11,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.CANCEL")," "),t.xp6(2),t.Q6J("disabled",h.loading),t.xp6(1),t.hij(" ",t.lcZ(12,13,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DELETE")," "))},dependencies:[Y.O5,w.lW,j.BZ,j.fO,j.as,j.w1,j.Dz,j.nj,j.ge,j.ev,j.XQ,j.Gk,C.uh,C.xY,C.H8,P.Ou,e.X$]}),E})();var Q=o(94364),X=o(96214),oe=o(7434);function ne(E,m){if(1&E){const c=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){t.CHM(c);const u=t.oxw();return t.KtG(u.addService())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&E&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_SERVICES.ADD_SERVICE"),"\n"))}function re(E,m){if(1&E){const c=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(c);const u=t.oxw();return t.KtG(u.removeServices())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&E){const c=t.oxw();t.Q6J("disabled",0===c.selected.selected.length),t.xp6(1),t.hij(" ",t.lcZ(2,2,"RESOURCE_DETAIL.ASSIGNED_SERVICES.REMOVE_SERVICE"),"\n")}}function ie(E,m){1&E&&t._UZ(0,"mat-spinner",9)}function le(E,m){if(1&E&&t._UZ(0,"app-services-list",10),2&E){const c=t.oxw();t.Q6J("disableRouting",!c.serviceRoutingAuth)("selection",c.selected)("displayedColumns",c.displayedColumns)("filterValue",c.filterValue)("services",c.assignedServices)("tableId",c.tableId)}}let L=(()=>{class E{constructor(c,h,u,U,g){this.route=c,this.resourcesManager=h,this.dialog=u,this.guiAuthResolver=U,this.entityStorageService=g,this.assignedServices=[],this.selected=new n.Ov(!0,[]),this.tableId=f.uC,this.filterValue="",this.displayedColumns=["select","id","name","enabled","script","description"]}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.getDataForAuthorization(),this.loadAllServices()}loadAllServices(){this.loading=!0,this.resourcesManager.getAssignedServicesToResource(this.resource.id).subscribe(c=>{this.assignedServices=c,this.selected.clear(),this.loading=!1})}addService(){const c=(0,d.kZ)();c.width="800px",c.data={theme:"resource-theme",resourceId:this.resource.id},this.dialog.open(W,c).afterClosed().subscribe(u=>{u&&this.loadAllServices()})}removeServices(){const c=(0,d.kZ)();c.width="500px",c.data={theme:"resource-theme",resourceId:this.resource.id,services:this.selected.selected},this.dialog.open(v,c).afterClosed().subscribe(u=>{u&&this.loadAllServices()})}applyFilter(c){this.filterValue=c}getDataForAuthorization(){this.assignServiceAuth=this.guiAuthResolver.isAuthorized("assignServices_Resource_List<Service>_policy",[this.resource]),this.removeServiceAuth=this.guiAuthResolver.isAuthorized("removeServices_Resource_List<Service>_policy",[this.resource]),this.displayedColumns=this.removeServiceAuth?["select","id","name","enabled","script","description"]:["id","name","enabled","script","description"],this.serviceRoutingAuth=this.guiAuthResolver.isPerunAdminOrObserver()}}return E.\u0275fac=function(c){return new(c||E)(t.Y36(Q.gz),t.Y36(S.xk),t.Y36(C.uw),t.Y36(s.x4),t.Y36(s.fb))},E.\u0275cmp=t.Xpm({type:E,selectors:[["app-perun-web-apps-resource-assigned-services"]],decls:9,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["class","action-button mr-2","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"disableRouting","selection","displayedColumns","filterValue","services","tableId",4,"ngIf"],["color","accent","mat-flat-button","",1,"action-button","mr-2",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"disableRouting","selection","displayedColumns","filterValue","services","tableId"]],template:function(c,h){1&c&&(t.TgZ(0,"h1",0),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.TgZ(3,"perun-web-apps-refresh-button",1),t.NdJ("refresh",function(){return h.loadAllServices()}),t.qZA(),t.YNc(4,ne,3,3,"button",2),t.YNc(5,re,3,4,"button",3),t.TgZ(6,"perun-web-apps-immediate-filter",4),t.NdJ("filter",function(U){return h.applyFilter(U)}),t.qZA(),t.YNc(7,ie,1,0,"mat-spinner",5),t.YNc(8,le,1,6,"app-services-list",6)),2&c&&(t.xp6(1),t.Oqu(t.lcZ(2,6,"RESOURCE_DETAIL.ASSIGNED_SERVICES.TITLE")),t.xp6(3),t.Q6J("ngIf",h.assignServiceAuth),t.xp6(1),t.Q6J("ngIf",h.removeServiceAuth),t.xp6(1),t.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_SERVICES.FILTER_SERVICES"),t.xp6(1),t.Q6J("ngIf",h.loading),t.xp6(1),t.Q6J("ngIf",!h.loading))},dependencies:[Y.O5,w.lW,P.Ou,B.Q,X.t,oe.L,e.X$]}),E})()},92090:($,K,o)=>{o.d(K,{X:()=>N});var S=o(69723),f=o(32105),n=o(94650),d=o(36895),C=o(3848),s=o(48323),t=o(12651),e=o(89383);function Y(T,J){1&T&&(n._uU(0),n.ALo(1,"translate")),2&T&&n.hij(" ",n.lcZ(1,1,"RESOURCE_DETAIL.ENTITY")," ")}function w(T,J){if(1&T&&n._UZ(0,"app-one-entity-attribute-page",4),2&T){const F=n.oxw();n.Q6J("entityId",F.resource.id)("entity","resource")}}function i(T,J){1&T&&(n._uU(0),n.ALo(1,"translate"),n.ALo(2,"translate")),2&T&&n.AsE(" ",n.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",n.lcZ(2,4,"MEMBER_DETAIL.ENTITY")," ")}function P(T,J){if(1&T&&n._UZ(0,"app-two-entity-attribute-page",5),2&T){const F=n.oxw(2);n.Q6J("firstEntity","resource")("firstEntityId",F.resource.id)("secondEntity","member")}}function M(T,J){1&T&&(n.TgZ(0,"mat-tab"),n.YNc(1,i,3,6,"ng-template",1),n.YNc(2,P,1,3,"ng-template",2),n.qZA())}function x(T,J){1&T&&(n._uU(0),n.ALo(1,"translate"),n.ALo(2,"translate")),2&T&&n.AsE(" ",n.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",n.lcZ(2,4,"GROUP_DETAIL.ENTITY")," ")}function B(T,J){if(1&T&&n._UZ(0,"app-two-entity-attribute-page",5),2&T){const F=n.oxw(2);n.Q6J("firstEntity","resource")("firstEntityId",F.resource.id)("secondEntity","group")}}function G(T,J){1&T&&(n.TgZ(0,"mat-tab"),n.YNc(1,x,3,6,"ng-template",1),n.YNc(2,B,1,3,"ng-template",2),n.qZA())}let N=(()=>{class T{constructor(F,W,j){this.authResolver=F,this.resourceManager=W,this.entityStorageService=j}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.resourceGroupAttAuth=this.authResolver.isAuthorized("getGroupAssignments_Resource_policy",[this.resource]),this.resourceMemberAttAuth=this.authResolver.isAuthorized("getAssignedMembersWithStatus_Resource_policy",[this.resource])}}return T.\u0275fac=function(F){return new(F||T)(n.Y36(S.x4),n.Y36(f.xk),n.Y36(S.fb))},T.\u0275cmp=n.Xpm({type:T,selectors:[["app-resource-attributes"]],hostVars:2,hostBindings:function(F,W){2&F&&n.ekj("router-component",W.true)},decls:10,vars:5,consts:[[1,"page-subtitle"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(F,W){1&F&&(n.TgZ(0,"div")(1,"h1",0),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"mat-tab-group")(5,"mat-tab"),n.YNc(6,Y,2,3,"ng-template",1),n.YNc(7,w,1,2,"ng-template",2),n.qZA(),n.YNc(8,M,3,0,"mat-tab",3),n.YNc(9,G,3,0,"mat-tab",3),n.qZA()()),2&F&&(n.xp6(2),n.Oqu(n.lcZ(3,3,"RESOURCE_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),n.xp6(6),n.Q6J("ngIf",W.resourceMemberAttAuth),n.xp6(1),n.Q6J("ngIf",W.resourceGroupAttAuth))},dependencies:[d.O5,C.SP,C.uD,C.uX,C.Vc,s.Y,t.t,e.X$]}),T})()},98918:($,K,o)=>{o.d(K,{b:()=>le});var S=o(36769),f=o(69024),n=o(32105),d=o(9244),C=o(69723),s=o(19516),t=o(36792),e=o(533),Y=o(22158),w=o(82722),i=o(94650),P=o(94364),M=o(77968),x=o(65412),B=o(15003),G=o(36895),N=o(97392),T=o(4859),J=o(51572),F=o(10266),W=o(61283),j=o(4235),q=o(89383);function te(L,E){1&L&&i._UZ(0,"mat-spinner",3)}function se(L,E){if(1&L){const m=i.EpF();i.TgZ(0,"button",15),i.NdJ("click",function(){i.CHM(m);const h=i.oxw(2);return i.KtG(h.editResource())}),i.TgZ(1,"mat-icon"),i._uU(2,"edit"),i.qZA()()}}function y(L,E){if(1&L){const m=i.EpF();i.TgZ(0,"button",16),i.NdJ("click",function(){i.CHM(m);const h=i.oxw(2);return i.KtG(h.deleteResource())}),i.TgZ(1,"mat-icon"),i._uU(2,"delete_forever"),i.qZA()()}}const k=function(L){return["/organizations",L]};function A(L,E){if(1&L&&(i.TgZ(0,"a",8),i._uU(1),i.qZA()),2&L){const m=i.oxw(2);i.Q6J("routerLink",i.VKq(3,k,m.resource.vo.id)),i.uIk("data-cy",m.resource.vo.name),i.xp6(1),i.Oqu(m.resource.vo.name)}}function v(L,E){if(1&L&&(i.TgZ(0,"span"),i._uU(1),i.qZA()),2&L){const m=i.oxw(2);i.xp6(1),i.hij(" ",m.resource.vo.name," ")}}const Q=function(L){return["/facilities",L]};function X(L,E){if(1&L&&(i.TgZ(0,"a",8),i._uU(1),i.qZA()),2&L){const m=i.oxw(2);i.Q6J("routerLink",i.VKq(3,Q,m.resource.facilityId)),i.uIk("data-cy",m.resource.facility.name),i.xp6(1),i.Oqu(m.resource.facility.name)}}function oe(L,E){if(1&L&&(i.TgZ(0,"span"),i._uU(1),i.qZA()),2&L){const m=i.oxw(2);i.xp6(1),i.hij(" ",m.resource.facility.name," ")}}const ne=function(){return{color:"black"}},re=function(L){return[L]};function ie(L,E){if(1&L&&(i.TgZ(0,"div")(1,"div",4),i._UZ(2,"mat-icon",5),i.ALo(3,"translate"),i.TgZ(4,"div",6)(5,"div",7)(6,"a",8),i._uU(7),i.qZA(),i.TgZ(8,"span",9),i._uU(9),i.qZA(),i.YNc(10,se,3,0,"button",10),i.YNc(11,y,3,0,"button",11),i.qZA(),i.TgZ(12,"div"),i._uU(13),i.ALo(14,"translate"),i.qZA(),i.TgZ(15,"span",12),i._uU(16),i.ALo(17,"translate"),i.ALo(18,"translate"),i.YNc(19,A,2,5,"a",13),i.YNc(20,v,2,1,"span",2),i._uU(21),i.ALo(22,"translate"),i.YNc(23,X,2,5,"a",14),i.YNc(24,oe,2,1,"span",2),i._uU(25),i.ALo(26,"translate"),i.qZA()()(),i._UZ(27,"app-animated-router-outlet"),i.qZA()),2&L){const m=i.oxw();i.xp6(2),i.s9C("matTooltip",i.lcZ(3,20,"RESOURCE_DETAIL.ENTITY")),i.Q6J("ngStyle",i.DdM(32,ne)),i.xp6(4),i.Q6J("routerLink",i.VKq(33,re,m.baseUrl)),i.xp6(1),i.hij(" ",m.resource.name," "),i.xp6(2),i.hij(" \xa0#",m.resource.id," "),i.xp6(1),i.Q6J("ngIf",m.editResourceAuth),i.xp6(1),i.Q6J("ngIf",m.deleteAuth),i.xp6(2),i.AsE("",i.lcZ(14,22,"RESOURCE_DETAIL.UUID"),": ",m.resource.uuid,""),i.xp6(3),i.AsE(" ",i.lcZ(17,24,"RESOURCE_DETAIL.ENTITY"),", ",i.lcZ(18,26,"RESOURCE_DETAIL.VO"),": "),i.xp6(3),i.Q6J("ngIf",m.voLinkAuth),i.xp6(1),i.Q6J("ngIf",!m.voLinkAuth),i.xp6(1),i.AsE(" #",m.resource.voId,", ",i.lcZ(22,28,"RESOURCE_DETAIL.FACILITY"),": "),i.xp6(2),i.Q6J("ngIf",m.facilityLinkAuth),i.xp6(1),i.Q6J("ngIf",!m.facilityLinkAuth),i.xp6(1),i.lnq(" #",m.resource.facilityId,", ",i.lcZ(26,30,"RESOURCE_DETAIL.DESCRIPTION"),": ",m.resource.description," ")}}let le=(()=>{class L extends((0,Y.T)()){constructor(m,c,h,u,U,g,O,p,Z,l,R){super(),this.route=m,this.facilityManager=c,this.vosManagerService=h,this.resourcesManager=u,this.sideMenuService=U,this.sideMenuItemService=g,this.dialog=O,this.guiAuthResolver=p,this.router=Z,this.entityStorageService=l,this.reloadEntityDetail=R,this.underVoUrl=!1,this.deleteAuth=!1,this.baseUrl="",this.loading=!1}ngOnInit(){this.reloadData(),this.reloadEntityDetail.entityDetailChange.pipe((0,w.R)(this.destroyed$)).subscribe(()=>{this.reloadData()})}reloadData(){this.loading=!0,this.route.params.subscribe(m=>{const c=Number(m.resourceId);this.resourcesManager.getRichResourceById(c).subscribe(h=>{this.resource=h,this.entityStorageService.setEntity({id:h.id,voId:h.voId,facilityId:h.facilityId,beanName:"Resource"}),this.setAuth(),"facilities"===this.route.parent.snapshot.url[0].path?(this.baseUrl=(new s.r5).transform(h,!1),this.facilityManager.getFacilityById(h.facilityId).subscribe(u=>{this.facility=u,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)):(this.baseUrl=(new s.r5).transform(h,!0),this.vosManagerService.getVoById(h.voId).subscribe(u=>{this.vo=u,this.underVoUrl=!0,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)),(0,d.sF)("resources",this.resource)})})}setMenuItems(){let m;const c=this.sideMenuItemService.parseResource(this.resource,this.underVoUrl);this.underVoUrl?(m=this.sideMenuItemService.parseVo(this.vo),this.sideMenuService.setAccessMenuItems([m,c])):(m=this.sideMenuItemService.parseFacility(this.facility),this.sideMenuService.setFacilityMenuItems([m,c]))}editResource(){let m;this.resourcesManager.getResourceById(this.resource.id).subscribe(c=>{m=c;const h=(0,d.kZ)();h.width="450px",h.data={theme:"resource-theme",resource:m,dialogType:t.Eg.RESOURCE},this.dialog.open(t.rd,h).afterClosed().subscribe(U=>{U&&this.resourcesManager.getRichResourceById(this.resource.id).subscribe(g=>{this.resource=g,this.setMenuItems()})})})}deleteResource(){const m=(0,d.kZ)();m.width="500px",m.data={theme:"resource-theme",resources:[this.resource]},this.dialog.open(e.f,m).afterClosed().subscribe(h=>{h&&this.router.navigate(["../"],{relativeTo:this.route})})}setAuth(){this.facilityLinkAuth=this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.resource]),this.editResourceAuth=this.guiAuthResolver.isAuthorized("updateResource_Resource_policy",[this.resource]),this.voLinkAuth=this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.resource]),this.deleteAuth=this.guiAuthResolver.isAuthorized("deleteResource_Resource_policy",[this.resource])}}return L.\u0275fac=function(m){return new(m||L)(i.Y36(P.gz),i.Y36(n.IQ),i.Y36(n.YF),i.Y36(n.xk),i.Y36(M.D),i.Y36(f.V),i.Y36(x.uw),i.Y36(C.x4),i.Y36(P.F0),i.Y36(C.fb),i.Y36(B.G))},L.\u0275cmp=i.Xpm({type:L,selectors:[["app-resource-detail-page"]],features:[i.qOj],decls:4,vars:2,consts:[[1,"container-fluid","pl-xl-5","pr-xl-5","resource-theme"],["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-resource-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],["queryParamsHandling","merge",1,"resource-link",3,"routerLink"],[1,"text-muted"],["aria-label","Edit resource","mat-icon-button","",3,"click",4,"ngIf"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"mt-1","entity-info"],["queryParamsHandling","merge","class","resource-link",3,"routerLink",4,"ngIf"],["class","resource-link","queryParamsHandling","merge",3,"routerLink",4,"ngIf"],["aria-label","Edit resource","mat-icon-button","",3,"click"],["mat-icon-button","",3,"click"]],template:function(m,c){1&m&&(i.TgZ(0,"div",0),i._UZ(1,"perun-web-apps-back-button"),i.YNc(2,te,1,0,"mat-spinner",1),i.YNc(3,ie,28,35,"div",2),i.qZA()),2&m&&(i.xp6(2),i.Q6J("ngIf",c.loading),i.xp6(1),i.Q6J("ngIf",!c.loading&&void 0!==c.resource))},dependencies:[G.O5,G.PC,P.yS,N.Hw,T.lW,J.Ou,F.gM,W.A,j.W,q.X$],styles:[".break-line[_ngcontent-%COMP%]{display:inline-block}"],data:{animation:[S.Ji]}}),L})()},258:($,K,o)=>{o.d(K,{K:()=>O});var S=o(32105),f=o(95017),n=o(65412),d=o(30671),C=o(69723),s=o(94650),t=o(89383),e=o(36895),Y=o(4859),w=o(51572);function i(p,Z){1&p&&s._UZ(0,"mat-spinner",6)}function P(p,Z){1&p&&s._UZ(0,"th",15)}function M(p,Z){if(1&p&&(s.TgZ(0,"td",16),s._uU(1),s.qZA()),2&p){const l=Z.$implicit;s.xp6(1),s.Oqu(l.name)}}function x(p,Z){1&p&&s._UZ(0,"tr",17)}function B(p,Z){1&p&&s._UZ(0,"tr",18)}function G(p,Z){if(1&p&&(s.TgZ(0,"div",7)(1,"p"),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.TgZ(4,"div",8),s._uU(5),s.ALo(6,"translate"),s.qZA(),s.TgZ(7,"table",9),s.ynx(8,10),s.YNc(9,P,1,0,"th",11),s.YNc(10,M,2,1,"td",12),s.BQk(),s.YNc(11,x,1,0,"tr",13),s.YNc(12,B,1,0,"tr",14),s.qZA()()),2&p){const l=s.oxw();s.xp6(2),s.hij(" ",s.lcZ(3,5,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DESCRIPTION")," "),s.xp6(3),s.hij(" ",s.lcZ(6,7,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.ASK")," "),s.xp6(2),s.Q6J("dataSource",l.dataSource),s.xp6(4),s.Q6J("matHeaderRowDef",l.displayedColumns),s.xp6(1),s.Q6J("matRowDefColumns",l.displayedColumns)}}let N=(()=>{class p{constructor(l,R,D,z,V){this.dialogRef=l,this.data=R,this.notificator=D,this.translate=z,this.resourceManager=V,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.dataSource=new d.by(this.data.groups)}onCancel(){this.dialogRef.close()}onSubmit(){const l=[];for(const R of this.data.groups)l.push(R.id);this.loading=!0,this.resourceManager.removeGroupsFromResource(l,this.data.resourceId).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUP_FROM_RESOURCE.SUCCESS").subscribe(R=>{this.notificator.showSuccess(R),this.dialogRef.close(!0)})},()=>this.loading=!1)}}return p.\u0275fac=function(l){return new(l||p)(s.Y36(n.so),s.Y36(n.WI),s.Y36(C.V6),s.Y36(t.sK),s.Y36(S.xk))},p.\u0275cmp=s.Xpm({type:p,selectors:[["app-perun-web-apps-remove-group-from-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","warn","mat-flat-button","","data-cy","delete-button",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(l,R){1&l&&(s.TgZ(0,"div")(1,"h1",0),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.YNc(4,i,1,0,"mat-spinner",1),s.YNc(5,G,13,9,"div",2),s.TgZ(6,"div",3)(7,"button",4),s.NdJ("click",function(){return R.onCancel()}),s._uU(8),s.ALo(9,"translate"),s.qZA(),s.TgZ(10,"button",5),s.NdJ("click",function(){return R.onSubmit()}),s._uU(11),s.ALo(12,"translate"),s.qZA()()()),2&l&&(s.Tol(R.theme),s.xp6(2),s.Oqu(s.lcZ(3,9,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.TITLE")),s.xp6(2),s.Q6J("ngIf",R.loading),s.xp6(1),s.Q6J("ngIf",!R.loading),s.xp6(3),s.hij(" ",s.lcZ(9,11,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.CANCEL")," "),s.xp6(2),s.Q6J("disabled",R.loading),s.xp6(1),s.hij(" ",s.lcZ(12,13,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DELETE")," "))},dependencies:[e.O5,Y.lW,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,n.uh,n.xY,n.H8,w.Ou,t.X$]}),p})();var T=o(10036),J=o(24006),F=o(90455),W=o(86257),j=o(25788),q=o(64901);const te=["stepper"];function se(p,Z){1&p&&s._UZ(0,"mat-spinner",4)}function y(p,Z){1&p&&(s._uU(0),s.ALo(1,"translate")),2&p&&s.Oqu(s.lcZ(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.GROUPS"))}function k(p,Z){1&p&&(s._uU(0),s.ALo(1,"translate")),2&p&&s.Oqu(s.lcZ(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.OPTIONS"))}const A=function(){return["select","id","name","description"]};function v(p,Z){if(1&p){const l=s.EpF();s.TgZ(0,"div",5)(1,"mat-stepper",6,7)(3,"mat-step",8),s.YNc(4,y,2,3,"ng-template",9),s.TgZ(5,"perun-web-apps-debounce-filter",10),s.NdJ("filter",function(D){s.CHM(l);const z=s.oxw();return s.KtG(z.applyFilter(D))}),s.ALo(6,"translate"),s.qZA(),s._UZ(7,"perun-web-apps-groups-list",11),s.qZA(),s.TgZ(8,"mat-step"),s.YNc(9,k,2,3,"ng-template",9),s.TgZ(10,"mat-slide-toggle",12),s.NdJ("toggleChange",function(){s.CHM(l);const D=s.oxw();return s.KtG(D.changeSubgroupsMessage())})("ngModelChange",function(D){s.CHM(l);const z=s.oxw();return s.KtG(z.autoAssignSubgroups=D)}),s._uU(11),s.ALo(12,"translate"),s.qZA(),s.TgZ(13,"div",13),s._UZ(14,"i",14),s.qZA(),s.TgZ(15,"mat-slide-toggle",12),s.NdJ("toggleChange",function(){s.CHM(l);const D=s.oxw();return s.KtG(D.changeInactiveMessage())})("ngModelChange",function(D){s.CHM(l);const z=s.oxw();return s.KtG(z.asActive=D)}),s._uU(16),s.ALo(17,"translate"),s.qZA(),s.TgZ(18,"div",13),s._uU(19),s.qZA(),s.TgZ(20,"mat-slide-toggle",12),s.NdJ("toggleChange",function(){s.CHM(l);const D=s.oxw();return s.KtG(D.changeAsyncMessage())})("ngModelChange",function(D){s.CHM(l);const z=s.oxw();return s.KtG(z.async=D)}),s._uU(21),s.ALo(22,"translate"),s.qZA(),s.TgZ(23,"div",13),s._uU(24),s.qZA()()()()}if(2&p){const l=s.oxw();s.xp6(1),s.Q6J("linear",!0),s.xp6(2),s.Q6J("completed",0!==l.selection.selected.length&&l.canAddGroups()),s.xp6(2),s.s9C("placeholder",s.lcZ(6,19,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.FILTER_DESCRIPTION")),s.xp6(2),s.Q6J("disableMembers",!1)("groups",l.unAssignedGroups)("selection",l.selection)("disableRouting",!0)("displayedColumns",s.DdM(27,A))("filter",l.filterValue)("tableId",l.tableId),s.xp6(3),s.Q6J("ngModel",l.autoAssignSubgroups),s.xp6(1),s.hij(" ",s.lcZ(12,21,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS")," "),s.xp6(3),s.Q6J("innerHTML",l.autoAssignHint,s.oJD),s.xp6(1),s.Q6J("ngModel",l.asActive),s.xp6(1),s.hij(" ",s.lcZ(17,23,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AS_ACTIVE")," "),s.xp6(3),s.hij(" ",l.asActiveHint," "),s.xp6(1),s.Q6J("ngModel",l.async),s.xp6(1),s.hij(" ",s.lcZ(22,25,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OPT")," "),s.xp6(3),s.hij(" ",l.asyncHint," ")}}function Q(p,Z){if(1&p){const l=s.EpF();s.TgZ(0,"button",20),s.NdJ("click",function(){s.CHM(l);const D=s.oxw(2);return s.KtG(D.stepperPrevious())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&p&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.BACK")," "))}function X(p,Z){if(1&p){const l=s.EpF();s.TgZ(0,"button",21),s.NdJ("click",function(){s.CHM(l);const D=s.oxw(2);return s.KtG(D.stepperNext())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}if(2&p){const l=s.oxw(2);s.ekj("ml-2",void 0!==l.stepper&&0!==l.stepper.selectedIndex)("ml-auto",!(void 0!==l.stepper&&0!==l.stepper.selectedIndex)),s.Q6J("disabled",0===l.selection.selected.length||!l.canAddGroups()),s.xp6(1),s.hij(" ",s.lcZ(2,6,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.NEXT")," ")}}function oe(p,Z){if(1&p){const l=s.EpF();s.TgZ(0,"button",22),s.NdJ("click",function(){s.CHM(l);const D=s.oxw(2);return s.KtG(D.onAdd())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&p&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ADD_BUTTON")," "))}function ne(p,Z){if(1&p){const l=s.EpF();s.TgZ(0,"div",15)(1,"button",16),s.NdJ("click",function(){s.CHM(l);const D=s.oxw();return s.KtG(D.onCancel())}),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.YNc(4,Q,3,3,"button",17),s.YNc(5,X,3,8,"button",18),s.YNc(6,oe,3,3,"button",19),s.qZA()}if(2&p){const l=s.oxw();s.xp6(2),s.hij(" ",s.lcZ(3,4,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.CANCEL_BUTTON")," "),s.xp6(2),s.Q6J("ngIf",void 0!==l.stepper&&0!==l.stepper.selectedIndex),s.xp6(1),s.Q6J("ngIf",void 0!==l.stepper&&l.stepper.selectedIndex!==l.stepper._steps.length-1),s.xp6(1),s.Q6J("ngIf",void 0!==l.stepper&&l.stepper.selectedIndex===l.stepper._steps.length-1)}}let re=(()=>{class p{constructor(l,R,D,z,V,ee,pe,ge){this.dialogRef=l,this.data=R,this.notificator=D,this.translate=z,this.resourceManager=V,this.groupService=ee,this.guiAuthResolver=pe,this.cd=ge,this.loading=!1,this.unAssignedGroups=this.data.onlyAutoAssignedGroups,this.async=!0,this.autoAssignSubgroups=!1,this.asActive=!0,this.selection=new f.Ov(!0,[]),this.filterValue="",this.tableId=T.cL}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resource=this.data.resource,this.autoAssignHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT"),this.asActiveHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT"),this.asyncHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT"),this.resourceManager.getAssignedGroups(this.resource.id).subscribe(l=>{this.groupService.getAllGroups(this.resource.voId).subscribe(R=>{for(const D of R)-1===l.findIndex(z=>z.id===D.id)&&this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,D])&&this.unAssignedGroups.push(D);this.loading=!1,this.cd.detectChanges()},()=>this.loading=!1)},()=>this.loading=!1)}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0;const l=[];for(const R of this.selection.selected)l.push(R.id);this.resourceManager.assignGroupsToResource(l,this.resource.id,this.async,!this.asActive,this.autoAssignSubgroups).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.SUCCESS_MESSAGE").subscribe(R=>{this.notificator.showSuccess(R),this.dialogRef.close(!0)})},()=>this.loading=!1)}applyFilter(l){this.filterValue=l}canAddGroups(){let l=!0;return this.selection.selected.forEach(R=>{this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,R])||(l=!1)}),l}changeSubgroupsMessage(){this.autoAssignHint=this.translate.instant(this.autoAssignSubgroups?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_ON_HINT")}changeInactiveMessage(){this.asActiveHint=this.translate.instant(this.asActive?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT")}changeAsyncMessage(){this.asyncHint=this.translate.instant(this.async?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT")}stepperPrevious(){this.stepper.previous()}stepperNext(){this.stepper.next()}}return p.\u0275fac=function(l){return new(l||p)(s.Y36(n.so),s.Y36(n.WI),s.Y36(C.V6),s.Y36(t.sK),s.Y36(S.xk),s.Y36(S.ff),s.Y36(C.x4),s.Y36(s.sBO))},p.\u0275cmp=s.Xpm({type:p,selectors:[["app-perun-web-apps-assign-group-to-resource-dialog"]],viewQuery:function(l,R){if(1&l&&s.Gf(te,5),2&l){let D;s.iGM(D=s.CRH())&&(R.stepper=D.first)}},decls:7,vars:9,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["class","dialog-container","mat-dialog-content","",4,"ngIf"],["mat-dialog-actions","",4,"ngIf"],[1,"mr-auto","ml-auto"],["mat-dialog-content","",1,"dialog-container"],[3,"linear"],["stepper",""],[3,"completed"],["matStepLabel",""],[3,"placeholder","filter"],[3,"disableMembers","groups","selection","disableRouting","displayedColumns","filter","tableId"],["labelPosition","before",1,"mt-3","slide-text",3,"ngModel","toggleChange","ngModelChange"],[1,"text-muted","new-line","mt-2"],[3,"innerHTML"],["mat-dialog-actions",""],["mat-flat-button","",3,"click"],["class","ml-auto","mat-flat-button","",3,"click",4,"ngIf"],["color","accent","mat-flat-button","","type","button","data-cy","next-button",3,"ml-2","ml-auto","disabled","click",4,"ngIf"],["class","ml-2","color","accent","mat-flat-button","","type","button","data-cy","assign-button",3,"click",4,"ngIf"],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","","type","button","data-cy","next-button",3,"disabled","click"],["color","accent","mat-flat-button","","type","button","data-cy","assign-button",1,"ml-2",3,"click"]],template:function(l,R){1&l&&(s.TgZ(0,"div")(1,"h1",0),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.YNc(4,se,1,0,"mat-spinner",1),s.YNc(5,v,25,28,"div",2),s.YNc(6,ne,7,6,"div",3),s.qZA()),2&l&&(s.Tol(R.theme),s.xp6(2),s.Oqu(s.lcZ(3,7,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.TITLE")),s.xp6(2),s.Q6J("ngIf",R.loading),s.xp6(1),s.Q6J("ngIf",!R.loading),s.xp6(1),s.Q6J("ngIf",!R.loading&&R.stepper))},dependencies:[e.O5,J.JJ,J.On,Y.lW,n.uh,n.xY,n.H8,w.Ou,F.Rr,W.C0,W.VY,W.Vq,j.W,q.P,t.X$],styles:[".slide-text[_ngcontent-%COMP%]{font-size:1.1rem}"]}),p})();var ie=o(9244),le=o(64080),L=o(94364),E=o(10266),m=o(96214);function c(p,Z){if(1&p){const l=s.EpF();s.TgZ(0,"button",8),s.NdJ("click",function(){s.CHM(l);const D=s.oxw();return s.KtG(D.addGroup())}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&p&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_GROUPS.ADD_GROUP"),"\n"))}function h(p,Z){1&p&&s._UZ(0,"mat-spinner",9)}const u=function(p){return[p]},U=function(){return["select","id","indirectGroupAssigment","name","status","description"]};function g(p,Z){if(1&p){const l=s.EpF();s.TgZ(0,"perun-web-apps-groups-list",10),s.NdJ("refreshTable",function(){s.CHM(l);const D=s.oxw();return s.KtG(D.loadAllGroups())}),s.qZA()}if(2&p){const l=s.oxw();s.Q6J("disableGroups",!0)("groupsToDisableCheckbox",l.groupsToDisable)("disableMembers",!1)("groups",l.assignedGroups)("disableRouting",!!l.assignedGroups[0]&&!l.guiAuthResolver.isAuthorized("getGroupById_int_policy",s.VKq(10,u,l.assignedGroups[0])))("displayedColumns",s.DdM(12,U))("filter",l.filteredValue)("resourceId",l.resource.id)("selection",l.selected)("tableId",l.tableId)}}let O=(()=>{class p{constructor(l,R,D,z,V){this.route=l,this.resourcesManager=R,this.dialog=D,this.guiAuthResolver=z,this.entityStorageService=V,this.assignedGroups=[],this.selected=new f.Ov(!0,[]),this.filteredValue="",this.tableId=T.Ad}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.loadAllGroups()}loadAllGroups(){this.loading=!0,this.resourcesManager.getGroupAssignments(this.resource.id,[le.r.GROUP_SYNC_ENABLED]).subscribe(l=>{this.assignedGroups=l.map(V=>{const ee=V.enrichedGroup.group;return ee.status=V.status,ee.failureCause=V.failureCause,ee.sourceGroupId=V.sourceGroupId,ee});const R=this.assignedGroups.map(V=>V.id),D=this.assignedGroups.filter((V,ee)=>R.indexOf(V.id)===ee),z=this.assignedGroups.filter((V,ee)=>{const pe=R.indexOf(V.id);return pe!==ee&&(null===V.sourceGroupId||null===this.assignedGroups[pe].sourceGroupId)}).map(V=>V.id);D.forEach(V=>{z.includes(V.id)&&(V.moreTypesOfAssignment=!0)}),this.assignedGroups=D,this.groupsToDisable=new Set(this.assignedGroups.filter(V=>!!V.sourceGroupId&&!V.moreTypesOfAssignment).map(V=>V.id)),this.selected.clear(),this.loading=!1})}addGroup(){const l=(0,ie.kZ)();l.width="1000px",l.data={theme:"resource-theme",resource:this.resource,onlyAutoAssignedGroups:this.assignedGroups.filter(D=>this.groupsToDisable.has(D.id))},this.dialog.open(re,l).afterClosed().subscribe(D=>{D&&this.loadAllGroups()})}removeGroups(){const l=(0,ie.kZ)();l.width="500px",l.data={resourceId:this.resource.id,groups:this.selected.selected,theme:"resource-theme"},this.dialog.open(N,l).afterClosed().subscribe(D=>{D&&this.loadAllGroups()})}canRemoveGroups(){let l=!0;return this.selected.selected.forEach(R=>{this.guiAuthResolver.isAuthorized("removeGroupsFromResource_List<Group>_Resource_policy",[this.resource,R])||(l=!1)}),l}applyFilter(l){this.filteredValue=l}}return p.\u0275fac=function(l){return new(l||p)(s.Y36(L.gz),s.Y36(S.xk),s.Y36(n.uw),s.Y36(C.x4),s.Y36(C.fb))},p.\u0275cmp=s.Xpm({type:p,selectors:[["app-perun-web-apps-resource-groups"]],decls:13,vars:17,consts:[[1,"page-subtitle"],[3,"refresh"],["class","action-button","color","accent","mat-flat-button","","data-cy","add-group-button",3,"click",4,"ngIf"],["color","warn","mat-flat-button","","data-cy","remove-group-button",1,"ml-2","mr-2",3,"disabled","click"],[3,"matTooltipDisabled","matTooltip"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"disableGroups","groupsToDisableCheckbox","disableMembers","groups","disableRouting","displayedColumns","filter","resourceId","selection","tableId","refreshTable",4,"ngIf"],["color","accent","mat-flat-button","","data-cy","add-group-button",1,"action-button",3,"click"],[1,"ml-auto","mr-auto"],[3,"disableGroups","groupsToDisableCheckbox","disableMembers","groups","disableRouting","displayedColumns","filter","resourceId","selection","tableId","refreshTable"]],template:function(l,R){1&l&&(s.TgZ(0,"h1",0),s._uU(1),s.ALo(2,"translate"),s.qZA(),s.TgZ(3,"perun-web-apps-refresh-button",1),s.NdJ("refresh",function(){return R.loadAllGroups()}),s.qZA(),s.YNc(4,c,3,3,"button",2),s.TgZ(5,"button",3),s.NdJ("click",function(){return R.removeGroups()}),s.TgZ(6,"span",4),s.ALo(7,"translate"),s._uU(8),s.ALo(9,"translate"),s.qZA()(),s.TgZ(10,"perun-web-apps-debounce-filter",5),s.NdJ("filter",function(z){return R.applyFilter(z)}),s.qZA(),s.YNc(11,h,1,0,"mat-spinner",6),s.YNc(12,g,1,13,"perun-web-apps-groups-list",7)),2&l&&(s.xp6(1),s.Oqu(s.lcZ(2,9,"RESOURCE_DETAIL.ASSIGNED_GROUPS.TITLE")),s.xp6(3),s.Q6J("ngIf",R.guiAuthResolver.isAuthorized("getAllGroups_Vo_policy",s.VKq(15,u,R.resource))),s.xp6(1),s.Q6J("disabled",0===R.selected.selected.length||!R.canRemoveGroups()),s.xp6(1),s.s9C("matTooltip",s.lcZ(7,11,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_TOOLTIP")),s.Q6J("matTooltipDisabled",R.canRemoveGroups()),s.xp6(2),s.hij(" ",s.lcZ(9,13,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_GROUP")," "),s.xp6(2),s.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_GROUPS.FILTER_GROUPS"),s.xp6(1),s.Q6J("ngIf",R.loading),s.xp6(1),s.Q6J("ngIf",!R.loading))},dependencies:[e.O5,Y.lW,w.Ou,E.gM,j.W,m.t,q.P,t.X$]}),p})()},4675:($,K,o)=>{o.d(K,{H:()=>w});var S=o(32105),f=o(69723),n=o(94650),d=o(94364),C=o(36895),s=o(51572),t=o(71135);function e(i,P){1&i&&n._UZ(0,"mat-spinner",2)}function Y(i,P){if(1&i&&(n.TgZ(0,"div"),n._UZ(1,"perun-web-apps-menu-buttons-field",3),n.qZA()),2&i){const M=n.oxw();n.xp6(1),n.Q6J("items",M.navItems)("size","small")}}let w=(()=>{class i{constructor(M,x,B,G,N){this.resourcesManager=M,this.route=x,this.guiAuthResolver=B,this.entityStorageService=G,this.routePolicyService=N,this.navItems=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.initItems("facilities"!==this.route.parent.parent.snapshot.url[0].path),this.loading=!1}initItems(M){const x=M?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`;this.navItems=[],this.routePolicyService.canNavigate("resources-groups",this.resource)&&this.navItems.push({cssIcon:"perun-group",url:`${x}/resources/${this.resource.id}/groups`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_GROUPS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-services",this.resource)&&this.navItems.push({cssIcon:"perun-service",url:`/${x}/resources/${this.resource.id}/services`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_SERVICES",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-members",this.resource)&&this.navItems.push({cssIcon:"perun-user",url:`${x}/resources/${this.resource.id}/members`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_MEMBERS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-tags",this.resource)&&this.navItems.push({cssIcon:"perun-resource-tags",url:`${x}/resources/${this.resource.id}/tags`,label:"MENU_ITEMS.RESOURCE.RESOURCE_TAGS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-attributes",this.resource)&&this.navItems.push({cssIcon:"perun-attributes",url:`${x}/resources/${this.resource.id}/attributes`,label:"MENU_ITEMS.RESOURCE.ATTRIBUTES",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-settings",this.resource)&&this.navItems.push({cssIcon:"perun-settings2",url:`${x}/resources/${this.resource.id}/settings`,label:"MENU_ITEMS.RESOURCE.SETTINGS",style:"resource-btn"})}}return i.\u0275fac=function(M){return new(M||i)(n.Y36(S.xk),n.Y36(d.gz),n.Y36(f.x4),n.Y36(f.fb),n.Y36(f.Ip))},i.\u0275cmp=n.Xpm({type:i,selectors:[["app-resource-overview"]],hostVars:2,hostBindings:function(M,x){2&M&&n.ekj("router-component",x.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(M,x){1&M&&(n.YNc(0,e,1,0,"mat-spinner",0),n.YNc(1,Y,2,2,"div",1)),2&M&&(n.Q6J("ngIf",x.loading),n.xp6(1),n.Q6J("ngIf",!x.loading))},dependencies:[C.O5,s.Ou,t.L]}),i})()},20057:($,K,o)=>{o.d(K,{O:()=>d});var S=o(69723),f=o(94650),n=o(28361);let d=(()=>{class C{constructor(t,e){this.guiAuthResolver=t,this.entityStorageService=e,this.availableRoles=[],this.type="Resource",this.theme="resource-theme"}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Resource")}}return C.\u0275fac=function(t){return new(t||C)(f.Y36(S.x4),f.Y36(S.fb))},C.\u0275cmp=f.Xpm({type:C,selectors:[["app-resource-settings-managers"]],decls:1,vars:4,consts:[[3,"complementaryObject","availableRoles","complementaryObjectType","theme"]],template:function(t,e){1&t&&f._UZ(0,"app-managers-page",0),2&t&&f.Q6J("complementaryObject",e.resource)("availableRoles",e.availableRoles)("complementaryObjectType",e.type)("theme",e.theme)},dependencies:[n.s]}),C})()},16500:($,K,o)=>{o.d(K,{h:()=>w});var S=o(32105),f=o(69723),n=o(94650),d=o(94364),C=o(36895),s=o(51572),t=o(71135);function e(i,P){1&i&&n._UZ(0,"mat-spinner",2)}function Y(i,P){if(1&i&&(n.TgZ(0,"div"),n._UZ(1,"perun-web-apps-menu-buttons-field",3),n.qZA()),2&i){const M=n.oxw();n.xp6(1),n.Q6J("items",M.items)("size","small")}}let w=(()=>{class i{constructor(M,x,B,G,N){this.route=M,this.resourceManager=x,this.authResolver=B,this.entityStorageService=G,this.routePolicyService=N,this.items=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.initItems("facilities"!==this.route.parent.parent.parent.snapshot.url[0].path),this.loading=!1}initItems(M){this.items=[],this.routePolicyService.canNavigate("resources-settings-managers",this.resource)&&this.items.push({cssIcon:"perun-manager",url:`${M?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/managers`,label:"MENU_ITEMS.RESOURCE.MANAGERS",style:"resource-btn"})}}return i.\u0275fac=function(M){return new(M||i)(n.Y36(d.gz),n.Y36(S.xk),n.Y36(f.x4),n.Y36(f.fb),n.Y36(f.Ip))},i.\u0275cmp=n.Xpm({type:i,selectors:[["app-resource-settings-overview"]],hostVars:2,hostBindings:function(M,x){2&M&&n.ekj("router-component",x.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(M,x){1&M&&(n.YNc(0,e,1,0,"mat-spinner",0),n.YNc(1,Y,2,2,"div",1)),2&M&&(n.Q6J("ngIf",x.loading),n.xp6(1),n.Q6J("ngIf",!x.loading))},dependencies:[C.O5,s.Ou,t.L]}),i})()},60113:($,K,o)=>{o.d(K,{t:()=>d});var S=o(36769),f=o(94650),n=o(61283);let d=(()=>{class C{}return C.\u0275fac=function(t){return new(t||C)},C.\u0275cmp=f.Xpm({type:C,selectors:[["app-resource-settings"]],hostVars:2,hostBindings:function(t,e){2&t&&f.ekj("router-component",e.true)},decls:1,vars:0,template:function(t,e){1&t&&f._UZ(0,"app-animated-router-outlet")},dependencies:[n.A],data:{animation:[S.Ji]}}),C})()},20872:($,K,o)=>{o.d(K,{v:()=>se});var S=o(32105),f=o(95017),n=o(10036),d=o(9244),C=o(69723),s=o(36792),t=o(65412),e=o(94650),Y=o(36895),w=o(4859),i=o(51572),P=o(17672),M=o(89383);function x(y,k){1&y&&e._UZ(0,"mat-spinner",8)}function B(y,k){if(1&y&&e._UZ(0,"app-resources-tags-list",9),2&y){const A=e.oxw();e.Q6J("selection",A.selection)("displayedColumns",A.displayedColumns)("entity","resource")("filterValue",A.filterValue)("resourceTags",A.resourceTags)("tableId",A.tableId)}}let G=(()=>{class y{constructor(A,v,Q){this.dialogRef=A,this.data=v,this.resourcesManager=Q,this.tableId=n.g,this.selection=new f.Ov(!0,[]),this.resourceTags=[],this.displayedColumns=["select","id","name"]}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.voId=this.data.voId,this.resourceId=this.data.resourceId,this.assignedTags=this.data.assignedTags,this.resourcesManager.getAllResourcesTagsForVo(this.voId).subscribe(A=>{this.resourceTags=A.filter(v=>!this.assignedTags.map(Q=>Q.id).includes(v.id)),this.loading=!1})}onCancel(){this.dialogRef.close(!1)}onSubmit(A){if(0===A.length)return this.dialogRef.close(!0);const v=A.pop();this.resourcesManager.assignResourceTagToResource({resource:this.resourceId,resourceTag:v}).subscribe(()=>{this.onSubmit(A)})}applyFilter(A){this.filterValue=A}}return y.\u0275fac=function(A){return new(A||y)(e.Y36(t.so),e.Y36(t.WI),e.Y36(S.xk))},y.\u0275cmp=e.Xpm({type:y,selectors:[["app-add-resource-tag-to-resource-dialog"]],decls:15,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],[3,"selection","displayedColumns","entity","filterValue","resourceTags","tableId",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],[3,"selection","displayedColumns","entity","filterValue","resourceTags","tableId"]],template:function(A,v){1&A&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1)(5,"div",2),e.YNc(6,x,1,0,"mat-spinner",3),e.qZA(),e.YNc(7,B,1,6,"app-resources-tags-list",4),e.qZA(),e.TgZ(8,"div",5)(9,"button",6),e.NdJ("click",function(){return v.onCancel()}),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"button",7),e.NdJ("click",function(){return v.onSubmit(v.selection.selected)}),e._uU(13),e.ALo(14,"translate"),e.qZA()()()),2&A&&(e.Tol(v.theme),e.xp6(2),e.Oqu(e.lcZ(3,9,"RESOURCE_DETAIL.TAGS.ADD_TAGS")),e.xp6(4),e.Q6J("ngIf",v.loading),e.xp6(1),e.Q6J("ngIf",!v.loading),e.xp6(3),e.hij(" ",e.lcZ(11,11,"RESOURCE_DETAIL.TAGS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",v.loading||0===v.resourceTags.length),e.xp6(1),e.hij(" ",e.lcZ(14,13,"RESOURCE_DETAIL.TAGS.ADD_BUTTON")," "))},dependencies:[Y.O5,w.lW,t.uh,t.xY,t.H8,i.Ou,P.o,M.X$]}),y})();var N=o(17584),T=o(96214),J=o(7434);function F(y,k){if(1&y){const A=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){e.CHM(A);const Q=e.oxw();return e.KtG(Q.create())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&y&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.CREATE_BUTTON"),"\n"))}function W(y,k){if(1&y){const A=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){e.CHM(A);const Q=e.oxw();return e.KtG(Q.addTag())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&y&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"RESOURCE_DETAIL.TAGS.ADD_BUTTON"),"\n"))}function j(y,k){if(1&y){const A=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){e.CHM(A);const Q=e.oxw();return e.KtG(Q.removeTags())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&y){const A=e.oxw();e.Q6J("disabled",0===A.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"RESOURCE_DETAIL.TAGS.REMOVE_BUTTON"),"\n")}}function q(y,k){1&y&&e._UZ(0,"mat-spinner",9)}function te(y,k){if(1&y&&e._UZ(0,"app-resources-tags-list",10),2&y){const A=e.oxw();e.Q6J("displayedColumns",A.displayedColumns)("entity","resource")("resourceTags",A.resourceTags)("filterValue",A.filterValue)("selection",A.selection)("tableId",A.tableId)}}let se=(()=>{class y{constructor(A,v,Q,X,oe,ne){this.authResolver=A,this.resourcesManager=v,this.dialog=Q,this.notificator=X,this.translate=oe,this.entityStorageService=ne,this.loading=!1,this.resourceTags=[],this.selection=new f.Ov(!0,[]),this.tableId=n.M8,this.displayedColumns=[]}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.setAuthRights(),this.updateData()}removeTags(){const A=(0,d.kZ)();A.width="450px",A.data={items:this.selection.selected.map(Q=>Q.tagName),title:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_TITLE",description:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_DESCRIPTION",theme:"resource-theme",type:"remove",showAsk:!0},this.dialog.open(s.Ts,A).afterClosed().subscribe(Q=>{Q&&this.removeTag(this.selection.selected)})}removeTag(A){if(0===A.length)return this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.REMOVED_SUCCESSFULLY")),this.updateData();const v=A.pop();this.resourcesManager.removeResourceTagFromResource({resource:this.resource.id,resourceTag:v}).subscribe(()=>{this.removeTag(A)})}addTag(){const A=(0,d.kZ)();A.width="600px",A.data={voId:this.resource.voId,resourceId:this.resource.id,assignedTags:this.resourceTags,theme:"resource-theme"},this.dialog.open(G,A).afterClosed().subscribe(Q=>{Q&&(this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.ADDED_SUCCESSFULLY")),this.updateData())})}create(){const A=(0,d.kZ)();A.width="450px",A.data={voId:this.resource.voId,theme:"resource-theme"},this.dialog.open(N.p,A).afterClosed().subscribe(Q=>{Q&&(this.translate.get("VO_DETAIL.RESOURCES.TAGS.CREATE_SUCCESS").subscribe(X=>{this.notificator.showSuccess(X)}),this.updateData())})}updateData(){this.loading=!0,this.selection.clear(),this.resourcesManager.getAllResourcesTagsForResource(this.resource.id).subscribe(A=>{this.resourceTags=A,this.selection.clear(),this.loading=!1})}setAuthRights(){const A={id:this.resource.voId,beanName:"Vo"};this.displayedColumns=[],this.createAuth=this.authResolver.isAuthorized("createResourceTag_ResourceTag_Vo_policy",[A]),this.addAuth=this.authResolver.isAuthorized("assignResourceTagToResource_ResourceTag_Resource_policy",[this.resource]),this.removeAuth=this.authResolver.isAuthorized("removeResourceTagFromResource_ResourceTag_Resource_policy",[this.resource]),this.displayedColumns=this.removeAuth?["select","id","name"]:["id","name"]}applyFilter(A){this.filterValue=A}}return y.\u0275fac=function(A){return new(A||y)(e.Y36(C.x4),e.Y36(S.xk),e.Y36(t.uw),e.Y36(C.V6),e.Y36(M.sK),e.Y36(C.fb))},y.\u0275cmp=e.Xpm({type:y,selectors:[["app-perun-web-apps-resource-tags"]],decls:10,vars:9,consts:[[1,"page-subtitle"],[3,"refresh"],["class","mr-2 action-button","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"displayedColumns","entity","resourceTags","filterValue","selection","tableId",4,"ngIf"],["color","accent","mat-flat-button","",1,"mr-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"displayedColumns","entity","resourceTags","filterValue","selection","tableId"]],template:function(A,v){1&A&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){return v.updateData()}),e.qZA(),e.YNc(4,F,3,3,"button",2),e.YNc(5,W,3,3,"button",2),e.YNc(6,j,3,4,"button",3),e.TgZ(7,"perun-web-apps-immediate-filter",4),e.NdJ("filter",function(X){return v.applyFilter(X)}),e.qZA(),e.YNc(8,q,1,0,"mat-spinner",5),e.YNc(9,te,1,6,"app-resources-tags-list",6)),2&A&&(e.xp6(1),e.Oqu(e.lcZ(2,7,"RESOURCE_DETAIL.TAGS.TITLE")),e.xp6(3),e.Q6J("ngIf",v.createAuth),e.xp6(1),e.Q6J("ngIf",v.addAuth),e.xp6(1),e.Q6J("ngIf",v.removeAuth),e.xp6(1),e.Q6J("placeholder","RESOURCE_DETAIL.TAGS.SEARCH"),e.xp6(1),e.Q6J("ngIf",v.loading),e.xp6(1),e.Q6J("ngIf",!v.loading))},dependencies:[Y.O5,w.lW,i.Ou,P.o,T.t,J.L,M.X$]}),y})()},17584:($,K,o)=>{o.d(K,{p:()=>M});var S=o(65412),f=o(32105),n=o(94650),d=o(36895),C=o(59549),s=o(284),t=o(24006),e=o(4859),Y=o(51572),w=o(89383);function i(x,B){1&x&&n._UZ(0,"mat-spinner",6)}function P(x,B){if(1&x){const G=n.EpF();n.TgZ(0,"div",7)(1,"mat-form-field")(2,"input",8),n.NdJ("ngModelChange",function(T){n.CHM(G);const J=n.oxw();return n.KtG(J.name=T)}),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"mat-error"),n._uU(5),n.ALo(6,"translate"),n.qZA()()()}if(2&x){const G=n.oxw();n.xp6(2),n.s9C("placeholder",n.lcZ(3,3,"DIALOGS.CREATE_RESOURCE_TAG.NAME")),n.Q6J("ngModel",G.name),n.xp6(3),n.Oqu(n.lcZ(6,5,"DIALOGS.CREATE_RESOURCE_TAG.EMPTY_NAME"))}}let M=(()=>{class x{constructor(G,N,T){this.dialogRef=G,this.data=N,this.resourceManager=T,this.name="",this.loading=!1}ngOnInit(){this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){""!==this.name&&(this.loading=!0,this.resourceManager.createResourceTagWithTagName(this.name,this.data.voId).subscribe(()=>{this.dialogRef.close(!0)},()=>this.loading=!1))}}return x.\u0275fac=function(G){return new(G||x)(n.Y36(S.so),n.Y36(S.WI),n.Y36(f.xk))},x.\u0275cmp=n.Xpm({type:x,selectors:[["app-create-resource-tag-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","ml-auto mr-auto",4,"ngIf"],["class","dialog-container","mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content","",1,"dialog-container"],["matInput","","required","",3,"placeholder","ngModel","ngModelChange"]],template:function(G,N){1&G&&(n.TgZ(0,"div")(1,"h1",0),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.YNc(4,i,1,0,"mat-spinner",1),n.YNc(5,P,7,7,"div",2),n.TgZ(6,"div",3)(7,"button",4),n.NdJ("click",function(){return N.onCancel()}),n._uU(8),n.ALo(9,"translate"),n.qZA(),n.TgZ(10,"button",5),n.NdJ("click",function(){return N.onSubmit()}),n._uU(11),n.ALo(12,"translate"),n.qZA()()()),2&G&&(n.Tol(N.theme),n.xp6(2),n.Oqu(n.lcZ(3,9,"DIALOGS.CREATE_RESOURCE_TAG.TITLE")),n.xp6(2),n.Q6J("ngIf",N.loading),n.xp6(1),n.Q6J("ngIf",!N.loading),n.xp6(3),n.hij(" ",n.lcZ(9,11,"DIALOGS.CREATE_RESOURCE_TAG.CANCEL")," "),n.xp6(2),n.Q6J("disabled",N.loading),n.xp6(1),n.hij(" ",n.lcZ(12,13,"DIALOGS.CREATE_RESOURCE_TAG.CREATE")," "))},dependencies:[d.O5,C.TO,C.KE,s.Nt,t.Fj,t.JJ,t.Q7,t.On,e.lW,S.uh,S.xY,S.H8,Y.Ou,w.X$]}),x})()},28361:($,K,o)=>{o.d(K,{s:()=>Ne});var S=o(95017),f=o(65412),n=o(69723),d=o(32105),C=o(10036),s=o(64080),t=o(24006),e=o(94650),Y=o(89383),w=o(94364),i=o(36895),P=o(3238),M=o(59549),x=o(284),B=o(4859),G=o(84385),N=o(51572),T=o(98380),J=o(19309),F=o(64877),W=o(23123);function j(r,b){if(1&r&&(e.TgZ(0,"mat-option",15),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&r){const a=b.$implicit;e.Q6J("value",a.roleName),e.xp6(1),e.hij(" ",e.lcZ(2,2,a)," ")}}function q(r,b){1&r&&e._UZ(0,"mat-spinner",16)}function te(r,b){1&r&&(e.TgZ(0,"perun-web-apps-alert",20),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"DIALOGS.ADD_MANAGERS.NO_USERS_FOUND")," "))}const se=function(){return["select","id","name","email","logins","organization"]};function y(r,b){if(1&r&&e._UZ(0,"app-users-list",21),2&r){const a=e.oxw(2);e.Q6J("disableRouting",!0)("selection",a.selection)("displayedColumns",e.DdM(5,se))("tableId",a.tableId)("users",a.users)}}function k(r,b){if(1&r&&(e.TgZ(0,"div",17),e.YNc(1,te,3,3,"perun-web-apps-alert",18),e.YNc(2,y,1,6,"app-users-list",19),e.qZA()),2&r){const a=e.oxw();e.xp6(1),e.Q6J("ngIf",0===a.users.length&&a.firstSearchDone),e.xp6(1),e.Q6J("ngIf",0!==a.users.length)}}let A=(()=>{class r{constructor(a,_,I,H,ae,ce,ue,he,fe){this.dialogRef=a,this.data=_,this.authzService=I,this.usersService=H,this.translate=ae,this.notificator=ce,this.storeService=ue,this.route=he,this.router=fe,this.selection=new S.Ov(!0,[]),this.users=[],this.firstSearchDone=!1,this.tableId=C.H2,ae.get("DIALOGS.ADD_MANAGERS.TITLE").subscribe(_e=>this.title=_e),ae.get("DIALOGS.ADD_MANAGERS.SUCCESS").subscribe(_e=>this.successMessage=_e)}ngOnInit(){this.theme=this.data.theme,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.searchCtrl=new t.p4("",[t.kI.required,t.kI.pattern(".*[\\S]+.*")])}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.setRoleWithUserComplementaryObject({role:this.selectedRole,users:this.selection.selected.map(a=>a.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}onSearchByString(){if(this.searchCtrl.invalid)return void this.searchCtrl.markAllAsTouched();this.loading=!0,this.selection.clear();let a=[s.r.USER_DEF_ORGANIZATION,s.r.USER_DEF_PREFERRED_MAIL];a=a.concat(this.storeService.getLoginAttributeNames()),this.usersService.findRichUsersWithAttributes(this.searchCtrl.value,a).subscribe({next:_=>{this.users=_,this.loading=!1,this.firstSearchDone=!0},error:()=>this.loading=!1})}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(f.so),e.Y36(f.WI),e.Y36(d.Ct),e.Y36(d.Fv),e.Y36(Y.sK),e.Y36(n.V6),e.Y36(n.d6),e.Y36(w.gz),e.Y36(w.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-add-manager-dialog"]],decls:31,vars:31,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"mr-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"mr-2","w-100"],["matInput","","autocomplete","false","data-cy","search-manager-input","perunWebAppsAutoFocus","",3,"placeholder","formControl","keyup.enter"],["color","accent","data-cy","search-manager-button","mat-flat-button","",1,"ml-auto",3,"disabled","click"],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","data-cy","add-manager-button-dialog","mat-flat-button","",1,"ml-2",3,"disabled","click"],[3,"value"],[1,"mr-auto","ml-auto"],[1,"mt-3"],["alert_type","warn",4,"ngIf"],[3,"disableRouting","selection","displayedColumns","tableId","users",4,"ngIf"],["alert_type","warn"],[3,"disableRouting","selection","displayedColumns","tableId","users"]],template:function(a,_){1&a&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1)(5,"div",2)(6,"mat-form-field",3)(7,"mat-label"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"mat-select",4),e.NdJ("valueChange",function(H){return _.selectedRole=H}),e.YNc(11,j,3,4,"mat-option",5),e.qZA()(),e.TgZ(12,"mat-form-field",6)(13,"input",7),e.NdJ("keyup.enter",function(){return _.onSearchByString()}),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"mat-error"),e._uU(16),e.ALo(17,"translate"),e.qZA()()(),e.TgZ(18,"button",8),e.NdJ("click",function(){return _.onSearchByString()}),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"div",9),e.YNc(22,q,1,0,"mat-spinner",10),e.qZA(),e.YNc(23,k,3,2,"div",11),e.qZA(),e.TgZ(24,"div",12)(25,"button",13),e.NdJ("click",function(){return _.onCancel()}),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"button",14),e.NdJ("click",function(){return _.onSubmit()}),e._uU(29),e.ALo(30,"translate"),e.qZA()()()),2&a&&(e.Tol(_.theme),e.xp6(2),e.Oqu(e.lcZ(3,17,"DIALOGS.ADD_MANAGERS.TITLE")),e.xp6(6),e.Oqu(e.lcZ(9,19,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",_.selectedRole),e.xp6(1),e.Q6J("ngForOf",_.availableRoles),e.xp6(2),e.s9C("placeholder",e.lcZ(14,21,"DIALOGS.ADD_MANAGERS.DESCRIPTION")),e.Q6J("formControl",_.searchCtrl),e.xp6(3),e.hij(" ",e.lcZ(17,23,"DIALOGS.ADD_MANAGERS.EMPTY_SEARCH_MESSAGE")," "),e.xp6(2),e.Q6J("disabled",_.loading),e.xp6(1),e.hij(" ",e.lcZ(20,25,"DIALOGS.ADD_MANAGERS.SEARCH")," "),e.xp6(3),e.Q6J("ngIf",_.loading),e.xp6(1),e.Q6J("ngIf",null!==_.users&&!_.loading),e.xp6(3),e.hij(" ",e.lcZ(27,27,"DIALOGS.ADD_MANAGERS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",0===_.selection.selected.length||void 0===_.selectedRole||_.loading),e.xp6(1),e.hij(" ",e.lcZ(30,29,"DIALOGS.ADD_MANAGERS.CREATE")," "))},dependencies:[i.sg,i.O5,P.ey,M.TO,M.KE,M.hX,x.Nt,t.Fj,t.JJ,t.oH,B.lW,f.uh,f.xY,f.H8,G.gD,N.Ou,T.w,J.hT,F.C,Y.X$,W.i],styles:[".inline-dialog-items[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]}),r})();var v=o(30671);function Q(r,b){1&r&&e._UZ(0,"th",15)}function X(r,b){if(1&r&&(e.TgZ(0,"td",16),e._uU(1),e.qZA()),2&r){const a=b.$implicit;e.xp6(1),e.AsE("",a.firstName," ",a.lastName,"")}}function oe(r,b){1&r&&e._UZ(0,"tr",17)}function ne(r,b){1&r&&e._UZ(0,"tr",18)}const re=function(r){return{role:r}};function ie(r,b){if(1&r&&(e.TgZ(0,"perun-web-apps-alert",19),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"displayedRole"),e.qZA()),2&r){const a=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,"DIALOGS.REMOVE_MANAGERS.WARNING_REMOVE_YOURSELF",e.VKq(6,re,e.lcZ(3,4,a.data.role)))," ")}}function le(r,b){if(1&r&&(e.TgZ(0,"div",6)(1,"p"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",7),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"table",8),e.ynx(8,9),e.YNc(9,Q,1,0,"th",10),e.YNc(10,X,2,2,"td",11),e.BQk(),e.YNc(11,oe,1,0,"tr",12),e.YNc(12,ne,1,0,"tr",13),e.qZA(),e.YNc(13,ie,4,8,"perun-web-apps-alert",14),e.qZA()),2&r){const a=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,6,"DIALOGS.REMOVE_MANAGERS.DESCRIPTION")," "),e.xp6(3),e.hij(" ",e.lcZ(6,8,"DIALOGS.REMOVE_MANAGERS.ASK")," "),e.xp6(2),e.Q6J("dataSource",a.dataSource),e.xp6(4),e.Q6J("matHeaderRowDef",a.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",a.displayedColumns),e.xp6(1),e.Q6J("ngIf",a.removeSelf)}}function L(r,b){1&r&&e._UZ(0,"mat-spinner",20)}let E=(()=>{class r{constructor(a,_,I,H,ae,ce,ue){this.dialogRef=a,this.data=_,this.notificator=I,this.translate=H,this.authzService=ae,this.store=ce,this.authService=ue,this.displayedColumns=["name"]}ngOnInit(){this.dataSource=new v.by(this.data.managers),this.theme=this.data.theme,this.removeSelf=this.data.managers.map(a=>a.id).includes(this.store.getPerunPrincipal().userId)&&!this.authService.isPerunAdmin()}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithUserComplementaryObject({role:this.data.role,users:this.data.managers.map(a=>a.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_MANAGERS.SUCCESS").subscribe(a=>{this.notificator.showSuccess(a),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)},()=>this.loading=!1)}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(f.so),e.Y36(f.WI),e.Y36(n.V6),e.Y36(Y.sK),e.Y36(d.Ct),e.Y36(n.d6),e.Y36(n.x4))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-remove-manager-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content","",4,"ngIf"],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","warn","data-cy","remove-manager-button-dialog","mat-flat-button","",1,"ml-2",3,"disabled","click"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""],["alert_type","warn"],[1,"mr-auto","ml-auto"]],template:function(a,_){1&a&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,le,14,10,"div",1),e.YNc(5,L,1,0,"mat-spinner",2),e.TgZ(6,"div",3)(7,"button",4),e.NdJ("click",function(){return _.onCancel()}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",5),e.NdJ("click",function(){return _.onSubmit()}),e._uU(11),e.ALo(12,"translate"),e.qZA()()()),2&a&&(e.Tol(_.theme),e.xp6(2),e.Oqu(e.lcZ(3,9,"DIALOGS.REMOVE_MANAGERS.TITLE")),e.xp6(2),e.Q6J("ngIf",!_.loading),e.xp6(1),e.Q6J("ngIf",_.loading),e.xp6(3),e.hij(" ",e.lcZ(9,11,"DIALOGS.REMOVE_MANAGERS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",_.loading),e.xp6(1),e.hij(" ",e.lcZ(12,13,"DIALOGS.REMOVE_MANAGERS.DELETE")," "))},dependencies:[i.O5,B.lW,v.BZ,v.fO,v.as,v.w1,v.Dz,v.nj,v.ge,v.ev,v.XQ,v.Gk,f.uh,f.xY,f.H8,N.Ou,T.w,Y.X$,W.i]}),r})();function m(r,b){1&r&&e._UZ(0,"mat-spinner",6)}function c(r,b){1&r&&e._UZ(0,"th",15)}function h(r,b){if(1&r&&(e.TgZ(0,"td",16),e._uU(1),e.qZA()),2&r){const a=b.$implicit;e.xp6(1),e.Oqu(a.name)}}function u(r,b){1&r&&e._UZ(0,"tr",17)}function U(r,b){1&r&&e._UZ(0,"tr",18)}function g(r,b){if(1&r&&(e.TgZ(0,"div",7)(1,"p"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",8),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"table",9),e.ynx(8,10),e.YNc(9,c,1,0,"th",11),e.YNc(10,h,2,1,"td",12),e.BQk(),e.YNc(11,u,1,0,"tr",13),e.YNc(12,U,1,0,"tr",14),e.qZA()()),2&r){const a=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,5,"DIALOGS.REMOVE_GROUPS.DESCRIPTION")," "),e.xp6(3),e.hij(" ",e.lcZ(6,7,"DIALOGS.REMOVE_GROUPS.ASK")," "),e.xp6(2),e.Q6J("dataSource",a.dataSource),e.xp6(4),e.Q6J("matHeaderRowDef",a.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",a.displayedColumns)}}let O=(()=>{class r{constructor(a,_,I,H,ae){this.dialogRef=a,this.data=_,this.notificator=I,this.translate=H,this.authzService=ae,this.displayedColumns=["name"]}ngOnInit(){this.dataSource=new v.by(this.data.groups),this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithGroupComplementaryObject({role:this.data.role,authorizedGroups:this.data.groups.map(a=>a.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUPS.SUCCESS").subscribe(a=>{this.notificator.showSuccess(a),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)},()=>this.loading=!1)}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(f.so),e.Y36(f.WI),e.Y36(n.V6),e.Y36(Y.sK),e.Y36(d.Ct))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-remove-group-manager-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","warn","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(a,_){1&a&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,m,1,0,"mat-spinner",1),e.YNc(5,g,13,9,"div",2),e.TgZ(6,"div",3)(7,"button",4),e.NdJ("click",function(){return _.onCancel()}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",5),e.NdJ("click",function(){return _.onSubmit()}),e._uU(11),e.ALo(12,"translate"),e.qZA()()()),2&a&&(e.Tol(_.theme),e.xp6(2),e.Oqu(e.lcZ(3,9,"DIALOGS.REMOVE_GROUPS.TITLE")),e.xp6(2),e.Q6J("ngIf",_.loading),e.xp6(1),e.Q6J("ngIf",!_.loading),e.xp6(3),e.hij(" ",e.lcZ(9,11,"DIALOGS.REMOVE_GROUPS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",_.loading),e.xp6(1),e.hij(" ",e.lcZ(12,13,"DIALOGS.REMOVE_GROUPS.DELETE")," "))},dependencies:[i.O5,B.lW,v.BZ,v.fO,v.as,v.w1,v.Dz,v.nj,v.ge,v.ev,v.XQ,v.Gk,f.uh,f.xY,f.H8,N.Ou,Y.X$]}),r})();var p=o(68675),Z=o(54004),l=o(47957),R=o(25788),D=o(64901);function z(r,b){if(1&r&&(e.TgZ(0,"mat-option",17),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&r){const a=b.$implicit;e.Q6J("value",a.roleName),e.xp6(1),e.hij(" ",e.lcZ(2,2,a)," ")}}function V(r,b){if(1&r&&(e.TgZ(0,"mat-option",17),e._uU(1),e.qZA()),2&r){const a=b.$implicit;e.Q6J("value",a),e.xp6(1),e.hij(" ",a.name," ")}}function ee(r,b){if(1&r){const a=e.EpF();e.TgZ(0,"perun-web-apps-debounce-filter",18),e.NdJ("filter",function(I){e.CHM(a);const H=e.oxw();return e.KtG(H.applyFilter(I))}),e.ALo(1,"translate"),e.qZA()}2&r&&e.s9C("placeholder",e.lcZ(1,1,"DIALOGS.ADD_GROUPS.FILTER_GROUPS"))}function pe(r,b){1&r&&e._UZ(0,"mat-spinner",19)}const ge=function(){return["select","id","name","description"]};function Ae(r,b){if(1&r&&(e.TgZ(0,"div",20),e._UZ(1,"perun-web-apps-groups-list",21),e.qZA()),2&r){const a=e.oxw();e.xp6(1),e.Q6J("disableMembers",!1)("disableRouting",!0)("displayedColumns",e.DdM(7,ge))("selection",a.selection)("groups",a.groups)("filter",a.filterValue)("tableId",a.tableId)}}let Re=(()=>{class r{constructor(a,_,I,H,ae,ce,ue,he,fe){this.dialogRef=a,this.data=_,this.authzService=I,this.voService=H,this.groupService=ae,this.translate=ce,this.notificator=ue,this.route=he,this.router=fe,this.searchString="",this.selection=new S.Ov(!0,[]),this.groups=[],this.vos=[],this.filterValue="",this.myControl=new t.p4,this.firstSearchDone=!1,this.tableId=C.kZ,ce.get("DIALOGS.ADD_GROUPS.TITLE").subscribe(_e=>this.title=_e),ce.get("DIALOGS.ADD_GROUPS.SUCCESS").subscribe(_e=>this.successMessage=_e)}displayFn(a){return a?a.name:null}onCancel(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.authzService.setRoleWithGroupComplementaryObject({role:this.selectedRole,authorizedGroups:this.selection.selected.map(a=>a.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}ngOnInit(){this.loading=!0,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.theme=this.data.theme,this.voService.getMyVos().subscribe({next:a=>{this.filteredOptions=this.myControl.valueChanges.pipe((0,p.O)(""),(0,Z.U)(_=>this._filter(_))),this.vos=a,this.loading=!1},error:()=>this.loading=!1})}showVoGroups(a){this.loading=!0,this.groupService.getAllGroups(a.option.value.id).subscribe({next:_=>{this.groups=_,this.loading=!1,this.firstSearchDone=!0},error:()=>this.loading=!1})}applyFilter(a){this.filterValue=a}_filter(a){const _="string"==typeof a?a.toLowerCase():a.name.toLowerCase();return this.vos.filter(I=>I.name.toLowerCase().includes(_))}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(f.so),e.Y36(f.WI),e.Y36(d.Ct),e.Y36(d.YF),e.Y36(d.ff),e.Y36(Y.sK),e.Y36(n.V6),e.Y36(w.gz),e.Y36(w.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-add-group-manager-dialog"]],decls:33,vars:33,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"mr-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"mr-2","w-75"],["aria-label","Assignee","matInput","","type","text",3,"formControl","matAutocomplete","placeholder"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"placeholder","filter",4,"ngIf"],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],[3,"value"],[3,"placeholder","filter"],[1,"mr-auto","ml-auto"],[1,"mt-3"],[3,"disableMembers","disableRouting","displayedColumns","selection","groups","filter","tableId"]],template:function(a,_){if(1&a&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1)(5,"div",2)(6,"mat-form-field",3)(7,"mat-label"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"mat-select",4),e.NdJ("valueChange",function(H){return _.selectedRole=H}),e.YNc(11,z,3,4,"mat-option",5),e.qZA()(),e.TgZ(12,"mat-form-field",6)(13,"mat-label"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e._UZ(16,"input",7),e.ALo(17,"translate"),e.TgZ(18,"mat-autocomplete",8,9),e.NdJ("optionSelected",function(H){return _.showVoGroups(H)}),e.YNc(20,V,2,2,"mat-option",5),e.ALo(21,"async"),e.qZA()()(),e.YNc(22,ee,2,3,"perun-web-apps-debounce-filter",10),e.TgZ(23,"div",11),e.YNc(24,pe,1,0,"mat-spinner",12),e.qZA(),e.YNc(25,Ae,2,8,"div",13),e.qZA(),e.TgZ(26,"div",14)(27,"button",15),e.NdJ("click",function(){return _.onCancel()}),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"button",16),e.NdJ("click",function(){return _.onSubmit()}),e._uU(31),e.ALo(32,"translate"),e.qZA()()()),2&a){const I=e.MAs(19);e.Tol(_.theme),e.xp6(2),e.Oqu(e.lcZ(3,19,"DIALOGS.ADD_GROUPS.TITLE")),e.xp6(6),e.Oqu(e.lcZ(9,21,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",_.selectedRole),e.xp6(1),e.Q6J("ngForOf",_.availableRoles),e.xp6(3),e.Oqu(e.lcZ(15,23,"DIALOGS.ADD_GROUPS.SELECT_VO")),e.xp6(2),e.s9C("placeholder",e.lcZ(17,25,"DIALOGS.ADD_GROUPS.SELECT_VO")),e.Q6J("formControl",_.myControl)("matAutocomplete",I),e.xp6(2),e.Q6J("displayWith",_.displayFn),e.xp6(2),e.Q6J("ngForOf",e.lcZ(21,27,_.filteredOptions)),e.xp6(2),e.Q6J("ngIf",null!==_.groups&&_.groups.length>0&&!_.loading),e.xp6(2),e.Q6J("ngIf",_.loading),e.xp6(1),e.Q6J("ngIf",null!==_.groups&&!_.loading),e.xp6(3),e.hij(" ",e.lcZ(29,29,"DIALOGS.ADD_MANAGERS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",0===_.selection.selected.length||_.loading),e.xp6(1),e.hij(" ",e.lcZ(32,31,"DIALOGS.ADD_MANAGERS.CREATE")," ")}},dependencies:[i.sg,i.O5,l.XC,l.ZL,P.ey,M.KE,M.hX,x.Nt,t.Fj,t.JJ,t.oH,B.lW,f.uh,f.xY,f.H8,G.gD,N.Ou,R.W,D.P,i.Ov,Y.X$,W.i]}),r})();var de=o(9244),Ee=o(15003),me=o(3848),Te=o(96214);function Ce(r,b){1&r&&(e._uU(0),e.ALo(1,"translate")),2&r&&e.hij(" ",e.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.USER")," ")}function ve(r,b){if(1&r){const a=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(a);const I=e.oxw(2);return e.KtG(I.addManager())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function Se(r,b){if(1&r){const a=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){e.CHM(a);const I=e.oxw(2);return e.KtG(I.removeManager())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&r){const a=e.oxw(2);e.Q6J("disabled",0===a.selectionUsers.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function be(r,b){if(1&r&&(e.TgZ(0,"mat-option",15),e.ALo(1,"lowercase"),e._uU(2),e.ALo(3,"displayedRole"),e.qZA()),2&r){const a=b.$implicit;e.Q6J("value",a.roleName),e.uIk("data-cy",e.lcZ(1,3,a.roleName)),e.xp6(2),e.hij(" ",e.lcZ(3,5,a)," ")}}function Oe(r,b){1&r&&e._UZ(0,"mat-spinner",16)}function Ie(r,b){if(1&r&&e._UZ(0,"app-users-list",17),2&r){const a=e.oxw(2);e.Q6J("disableSelf",a.disableSelf)("tableId",a.tableId)("disableRouting",!a.routeAuth||a.disableRouting)("displayedColumns",a.displayedUserColumns)("selection",a.selectionUsers)("users",a.managers)}}function De(r,b){if(1&r){const a=e.EpF();e.TgZ(0,"perun-web-apps-refresh-button",5),e.NdJ("refresh",function(){e.CHM(a);const I=e.oxw();return e.KtG(I.refreshUsers())}),e.qZA(),e.YNc(1,ve,3,3,"button",6),e.YNc(2,Se,3,4,"button",7),e.TgZ(3,"mat-form-field",8)(4,"mat-label"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"mat-select",9),e.NdJ("selectionChange",function(){e.CHM(a);const I=e.oxw();return e.KtG(I.refreshUsers())})("valueChange",function(I){e.CHM(a);const H=e.oxw();return e.KtG(H.selectedRole=I)}),e.YNc(8,be,4,7,"mat-option",10),e.qZA()(),e.YNc(9,Oe,1,0,"mat-spinner",11),e.YNc(10,Ie,1,6,"app-users-list",12)}if(2&r){const a=e.oxw();e.xp6(1),e.Q6J("ngIf",a.manageAuth&&!a.configMode),e.xp6(1),e.Q6J("ngIf",a.manageAuth&&!a.configMode),e.xp6(3),e.Oqu(e.lcZ(6,7,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",a.selectedRole),e.xp6(1),e.Q6J("ngForOf",a.availableRoles),e.xp6(1),e.Q6J("ngIf",a.loading),e.xp6(1),e.Q6J("ngIf",!a.loading&&a.managers)}}function Me(r,b){1&r&&(e._uU(0),e.ALo(1,"translate")),2&r&&e.hij(" ",e.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.GROUP")," ")}function xe(r,b){if(1&r){const a=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(a);const I=e.oxw(2);return e.KtG(I.addGroup())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function Ze(r,b){if(1&r){const a=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(a);const I=e.oxw(2);return e.KtG(I.removeGroup())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&r){const a=e.oxw(2);e.Q6J("disabled",0===a.selectionGroups.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function Ue(r,b){if(1&r&&(e.TgZ(0,"mat-option",15),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&r){const a=b.$implicit;e.Q6J("value",a.roleName),e.xp6(1),e.Oqu(e.lcZ(2,2,a))}}function Ge(r,b){1&r&&e._UZ(0,"mat-spinner",16)}function ye(r,b){if(1&r&&e._UZ(0,"perun-web-apps-groups-list",24),2&r){const a=e.oxw(2);e.Q6J("disableMembers",!1)("disableRouting",a.disableRouting)("displayedColumns",a.displayedGroupColumns)("groups",a.groups)("selection",a.selectionGroups)("tableId",a.tableId)}}function Le(r,b){if(1&r){const a=e.EpF();e.TgZ(0,"perun-web-apps-refresh-button",5),e.NdJ("refresh",function(){e.CHM(a);const I=e.oxw();return e.KtG(I.refreshGroups())}),e.qZA(),e.YNc(1,xe,3,3,"button",18),e.YNc(2,Ze,3,4,"button",19),e.TgZ(3,"mat-form-field",20)(4,"mat-label"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"mat-select",9),e.NdJ("selectionChange",function(){e.CHM(a);const I=e.oxw();return e.KtG(I.refreshGroups())})("valueChange",function(I){e.CHM(a);const H=e.oxw();return e.KtG(H.selectedRole=I)}),e.YNc(8,Ue,3,4,"mat-option",10),e.qZA()(),e.YNc(9,Ge,1,0,"mat-spinner",11),e.YNc(10,ye,1,6,"perun-web-apps-groups-list",21)}if(2&r){const a=e.oxw();e.xp6(1),e.Q6J("ngIf",a.manageAuth&&!a.configMode),e.xp6(1),e.Q6J("ngIf",a.manageAuth&&!a.configMode),e.xp6(3),e.Oqu(e.lcZ(6,7,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",a.selectedRole),e.xp6(1),e.Q6J("ngForOf",a.availableRoles),e.xp6(1),e.Q6J("ngIf",a.loading),e.xp6(1),e.Q6J("ngIf",!a.loading&&a.groups)}}function Pe(r,b){1&r&&(e.TgZ(0,"perun-web-apps-alert",25),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.NO_AVAILABLE_ROLES"),"\n"))}let Ne=(()=>{class r{constructor(a,_,I,H,ae,ce,ue){this.dialog=a,this.authzService=_,this.storeService=I,this.guiAuthResolver=H,this.router=ae,this.reloadEntityDetail=ce,this.route=ue,this.configMode=!1,this.disableRouting=!1,this.disableSelf=!1,this.displayedUserColumns=["select","id","name","email","logins","organization"],this.displayedGroupColumns=["select","id","vo","name","description"],this.groups=[],this.managers=null,this.selectionUsers=new S.Ov(!0,[]),this.selectionGroups=new S.Ov(!0,[]),this.selectedMode="",this.loading=!1,this.tableId=C.HC,this.availableRolesPrivileges=new Map}ngOnInit(){this.loading=!0,this.routeAuth=this.guiAuthResolver.isPerunAdminOrObserver(),this.guiAuthResolver.setRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(a=>this.availableRolesPrivileges.get(a.roleName).readAuth),0!==this.availableRoles.length&&(this.selectedRole=this.availableRoles[0].roleName),this.refreshUsers()}changeRolePrivileges(){this.guiAuthResolver.setRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(_=>this.availableRolesPrivileges.get(_.roleName).readAuth),this.manageAuth=this.availableRolesPrivileges.get(this.selectedRole).manageAuth,this.displayedUserColumns=this.manageAuth?this.displayedUserColumns:this.displayedUserColumns.filter(_=>"select"!==_),this.displayedGroupColumns=this.manageAuth?this.displayedGroupColumns:this.displayedGroupColumns.filter(_=>"select"!==_),this.roleModes=this.availableRolesPrivileges.get(this.selectedRole).modes;let a=!1;for(const _ of this.roleModes)if(this.selectedMode===_.toLowerCase()){a=!0;break}a||(this.selectedMode=this.roleModes[0].toLowerCase())}tabChanged(a){this.loading=!0,0===a.index?(this.selectedMode="user",this.refreshUsers()):(this.selectedMode="group",this.refreshGroups())}refreshUsers(){this.loading=!0,this.changeRolePrivileges();let a=[s.r.USER_DEF_ORGANIZATION,s.r.USER_DEF_PREFERRED_MAIL];a=a.concat(this.storeService.getLoginAttributeNames()),this.authzService.getAuthzRichAdmins(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType,a,!1,!0).subscribe({next:_=>{this.managers=_,this.selectionUsers.clear(),this.loading=!1},error:()=>{this.loading=!1}})}refreshGroups(){this.loading=!0,this.changeRolePrivileges(),this.authzService.getAuthzAdminGroups(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType).subscribe({next:a=>{this.groups=a,this.selectionGroups.clear(),this.loading=!1},error:()=>{this.loading=!1}})}addManager(){const a=(0,de.kZ)();a.width="1000px",a.data={complementaryObject:this.complementaryObject,theme:this.theme,availableRoles:this.availableRoles,selectedRole:this.selectedRole},this.dialog.open(A,a).afterClosed().subscribe(I=>{I&&this.refreshUsers()})}removeManager(){const a=(0,de.kZ)();a.width="450px",a.data={managers:this.selectionUsers.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(E,a).afterClosed().subscribe(I=>{I&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?this.reloadEntityDetail.reloadEntityDetail():this.redirectToAuthRoute())})}removeGroup(){const a=(0,de.kZ)();a.width="450px",a.data={groups:this.selectionGroups.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(O,a).afterClosed().subscribe(I=>{I&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?this.refreshGroups():this.redirectToAuthRoute())})}addGroup(){const a=(0,de.kZ)();a.width="1000px",a.data={complementaryObject:this.complementaryObject,availableRoles:this.availableRoles,theme:this.theme,selectedRole:this.selectedRole},this.dialog.open(Re,a).afterClosed().subscribe(I=>{I&&this.refreshGroups()})}redirectToAuthRoute(){if("Group"===this.complementaryObjectType&&(this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])||this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])))this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])?this.router.navigate(["/organizations",this.complementaryObject.voId,"groups",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"}):this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])&&this.router.navigate(["/organizations",this.complementaryObject.voId],{queryParamsHandling:"merge"});else if("Facility"===this.complementaryObjectType&&this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.complementaryObject]))this.router.navigate(["/facilities",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else if("Vo"===this.complementaryObjectType&&this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject]))this.router.navigate(["/organizations",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else{if("Resource"!==this.complementaryObjectType||!this.guiAuthResolver.isAuthorized("getRichResourceById_int_policy",[this.complementaryObject]))return void this.router.navigate(["/home"],{queryParamsHandling:"merge"});this.router.navigate(["../../"],{relativeTo:this.route,queryParamsHandling:"merge"})}this.reloadEntityDetail.reloadEntityDetail()}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(f.uw),e.Y36(d.Ct),e.Y36(n.d6),e.Y36(n.x4),e.Y36(w.F0),e.Y36(Ee.G),e.Y36(w.gz))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-managers-page"]],hostVars:2,hostBindings:function(a,_){2&a&&e.ekj("router-component",_.true)},inputs:{complementaryObject:"complementaryObject",availableRoles:"availableRoles",complementaryObjectType:"complementaryObjectType",theme:"theme",configMode:"configMode",disableRouting:"disableRouting",disableSelf:"disableSelf",displayedUserColumns:"displayedUserColumns",displayedGroupColumns:"displayedGroupColumns"},decls:11,vars:4,consts:[[1,"page-subtitle"],[3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["alert_type","warn",4,"ngIf"],[1,"mt-2",3,"refresh"],["color","accent","class","mr-2 mt-2 action-button","data-cy","add-manager-button","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","data-cy","remove-manager-button","class","mr-2 mt-2","mat-flat-button","",3,"disabled","click",4,"ngIf"],["data-cy","role-filter",1,"mr-2","mt-2"],[3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],["class","ml-auto mr-auto",4,"ngIf"],[3,"disableSelf","tableId","disableRouting","displayedColumns","selection","users",4,"ngIf"],["color","accent","data-cy","add-manager-button","mat-flat-button","",1,"mr-2","mt-2","action-button",3,"click"],["color","warn","data-cy","remove-manager-button","mat-flat-button","",1,"mr-2","mt-2",3,"disabled","click"],[3,"value"],[1,"ml-auto","mr-auto"],[3,"disableSelf","tableId","disableRouting","displayedColumns","selection","users"],["color","accent","class","mr-2 mt-2 action-button","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-2 mt-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[1,"mr-2","mt-2"],[3,"disableMembers","disableRouting","displayedColumns","groups","selection","tableId",4,"ngIf"],["color","accent","mat-flat-button","",1,"mr-2","mt-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"mr-2","mt-2",3,"disabled","click"],[3,"disableMembers","disableRouting","displayedColumns","groups","selection","tableId"],["alert_type","warn"]],template:function(a,_){1&a&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"mat-tab-group",1),e.NdJ("selectedTabChange",function(H){return _.tabChanged(H)}),e.TgZ(4,"mat-tab"),e.YNc(5,Ce,2,3,"ng-template",2),e.YNc(6,De,11,9,"ng-template",3),e.qZA(),e.TgZ(7,"mat-tab"),e.YNc(8,Me,2,3,"ng-template",2),e.YNc(9,Le,11,9,"ng-template",3),e.qZA()(),e.YNc(10,Pe,3,3,"perun-web-apps-alert",4)),2&a&&(e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.TITLE"),"\n"),e.xp6(9),e.Q6J("ngIf",0===_.availableRoles.length))},dependencies:[i.sg,i.O5,P.ey,M.KE,M.hX,B.lW,me.SP,me.uD,me.uX,me.Vc,G.gD,N.Ou,T.w,R.W,Te.t,F.C,i.i8,Y.X$,W.i]}),r})()},17672:($,K,o)=>{o.d(K,{o:()=>h});var S=o(96308),f=o(30671),n=o(95017),d=o(69723),C=o(32105),s=o(9244),t=o(94650),e=o(89383),Y=o(36895),w=o(59549),i=o(284),P=o(24006),M=o(97392),x=o(4859),B=o(56709),G=o(10266),N=o(98380),T=o(18750),J=o(9185),F=o(8231),W=o(14849);function j(u,U){if(1&u){const g=t.EpF();t.TgZ(0,"th",17)(1,"mat-checkbox",18),t.NdJ("change",function(p){t.CHM(g);const Z=t.oxw(2);return t.KtG(p?Z.masterToggle():null)}),t.ALo(2,"translate"),t.ALo(3,"masterCheckboxLabel"),t.qZA()()}if(2&u){const g=t.oxw().ngIf,O=t.oxw();t.xp6(1),t.Q6J("aria-label",t.lcZ(2,3,t.lcZ(3,5,g.all)))("checked",O.selection.hasValue()&&g.all)("indeterminate",O.selection.hasValue()&&!g.all)}}const q=function(u){return{name:u}};function te(u,U){if(1&u){const g=t.EpF();t.TgZ(0,"td",19)(1,"mat-checkbox",20),t.NdJ("change",function(p){const l=t.CHM(g).$implicit,R=t.oxw(2);return t.KtG(p?R.selection.toggle(l):null)})("click",function(p){return p.stopPropagation()}),t.ALo(2,"translate"),t.ALo(3,"checkboxLabel"),t.qZA()()}if(2&u){const g=U.$implicit,O=t.oxw(2);t.xp6(1),t.Q6J("aria-label",t.xi3(2,2,t.lcZ(3,5,O.selection.isSelected(g)),t.VKq(7,q,g.tagName)))("checked",O.selection.isSelected(g))}}function se(u,U){1&u&&(t.ynx(0,14),t.YNc(1,j,4,7,"th",15),t.YNc(2,te,4,9,"td",16),t.BQk())}function y(u,U){1&u&&(t.TgZ(0,"th",21),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&u&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_ID")," "))}function k(u,U){if(1&u&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&u){const g=U.$implicit;t.xp6(1),t.Oqu(g.id)}}function A(u,U){1&u&&(t.TgZ(0,"th",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&u&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_NAME")," "))}function v(u,U){if(1&u&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&u){const g=t.oxw().$implicit;t.xp6(1),t.hij(" ",g.tagName," ")}}function Q(u,U){if(1&u){const g=t.EpF();t.TgZ(0,"div")(1,"mat-form-field")(2,"input",26),t.NdJ("ngModelChange",function(p){t.CHM(g);const Z=t.oxw().$implicit;return t.KtG(Z.tagName=p)}),t.qZA()()()}if(2&u){const g=t.oxw().$implicit;t.xp6(2),t.Q6J("ngModel",g.tagName)}}function X(u,U){if(1&u&&(t.TgZ(0,"td",24),t.YNc(1,v,2,1,"div",25),t.YNc(2,Q,3,1,"div",25),t.qZA()),2&u){const g=U.$implicit,O=t.oxw();t.xp6(1),t.Q6J("ngIf",!O.isChanging.isSelected(g)),t.xp6(1),t.Q6J("ngIf",O.isChanging.isSelected(g))}}function oe(u,U){1&u&&t._UZ(0,"th",23)}function ne(u,U){if(1&u){const g=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(g);const p=t.oxw().$implicit,Z=t.oxw();return t.KtG(Z.edit(p))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()()}2&u&&t.s9C("matTooltip",t.lcZ(1,1,"VO_DETAIL.RESOURCES.TAGS.EDIT_BUTTON"))}function re(u,U){if(1&u){const g=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(g);const p=t.oxw().$implicit,Z=t.oxw();return t.KtG(Z.save(p))}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"save"),t.qZA()()}2&u&&t.s9C("matTooltip",t.lcZ(1,1,"VO_DETAIL.RESOURCES.TAGS.SAVE_BUTTON"))}function ie(u,U){if(1&u&&(t.TgZ(0,"td",24)(1,"div",27),t.YNc(2,ne,4,3,"button",28),t.YNc(3,re,4,3,"button",28),t.qZA()()),2&u){const g=U.$implicit,O=t.oxw();t.xp6(2),t.Q6J("ngIf",!O.isChanging.isSelected(g)),t.xp6(1),t.Q6J("ngIf",O.isChanging.isSelected(g))}}function le(u,U){1&u&&t._UZ(0,"tr",30)}function L(u,U){1&u&&t._UZ(0,"tr",31)}function E(u,U){if(1&u&&(t.TgZ(0,"perun-web-apps-alert",32),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&u){const g=t.oxw();t.xp6(1),t.hij(" ","vo"===g.entity?t.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.NO_TAGS"):t.lcZ(3,3,"RESOURCE_DETAIL.TAGS.NO_TAGS"),"\n")}}function m(u,U){1&u&&(t.TgZ(0,"perun-web-apps-alert",32),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&u&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}const c=function(u){return{all:u}};let h=(()=>{class u{constructor(g,O,p,Z,l){this.resourceManager=g,this.notificator=O,this.translator=p,this.authResolver=Z,this.tableCheckbox=l,this.resourceTags=[],this.selection=new n.Ov(!0,[]),this.displayedColumns=["select","id","name","edit"],this.isChanging=new n.Ov(!0,[]),this.pageSizeOptions=s.f7}set matSort(g){this.sort=g,this.setDataSource()}static getDataForColumn(g,O){switch(O){case"id":return g.id.toString();case"name":return g.tagName;default:return""}}ngOnChanges(){this.authResolver.isPerunAdminOrObserver()||(this.displayedColumns=this.displayedColumns.filter(g=>"id"!==g)),this.dataSource=new f.by(this.resourceTags),this.setDataSource()}ngAfterViewInit(){this.dataSource.paginator=this.child.paginator}exportAllData(g){(0,s.O6)((0,s.Xn)(this.dataSource.filteredData,this.displayedColumns,u.getDataForColumn),g)}exportDisplayedData(g){const O=this.dataSource.paginator.pageIndex*this.dataSource.paginator.pageSize,p=O+this.dataSource.paginator.pageSize;(0,s.O6)((0,s.Xn)(this.dataSource.sortData(this.dataSource.filteredData,this.dataSource.sort).slice(O,p),this.displayedColumns,u.getDataForColumn),g)}setDataSource(){this.dataSource&&(this.dataSource.filterPredicate=(g,O)=>(0,s.Sd)(g,O,this.displayedColumns,u.getDataForColumn),this.dataSource.sortData=(g,O)=>(0,s.pR)(g,O,u.getDataForColumn),this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue)}isAllSelected(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.dataSource)}masterToggle(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}save(g){this.resourceManager.updateResourceTag({resourceTag:g}).subscribe(()=>{this.translator.get("SHARED.COMPONENTS.RESOURCES_TAGS_LIST.EDIT_SUCCESS").subscribe(O=>{this.notificator.showSuccess(O)}),this.isChanging.deselect(g)})}edit(g){this.isChanging.select(g)}}return u.\u0275fac=function(g){return new(g||u)(t.Y36(C.xk),t.Y36(d.V6),t.Y36(e.sK),t.Y36(d.x4),t.Y36(d.UA))},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-resources-tags-list"]],viewQuery:function(g,O){if(1&g&&(t.Gf(s.l9,7),t.Gf(S.YE,7)),2&g){let p;t.iGM(p=t.CRH())&&(O.child=p.first),t.iGM(p=t.CRH())&&(O.matSort=p.first)}},inputs:{resourceTags:"resourceTags",filterValue:"filterValue",selection:"selection",tableId:"tableId",displayedColumns:"displayedColumns",entity:"entity"},features:[t.TTD],decls:18,vars:15,consts:[[1,"card","mt-2",3,"hidden"],[3,"pageSizeOptions","dataLength","tableId","exportDisplayedData","exportAllData"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select",4,"ngIf"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","edit"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["matColumnDef","select"],["class","align-checkbox","mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size align-checkbox","mat-cell","",4,"matCellDef"],["mat-header-cell","",1,"align-checkbox"],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size","align-checkbox"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"static-column-size"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],["matInput","",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-end"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","",3,"matTooltip","click"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"],["alert_type","warn"]],template:function(g,O){1&g&&(t.TgZ(0,"div",0)(1,"perun-web-apps-table-wrapper",1),t.NdJ("exportDisplayedData",function(Z){return O.exportDisplayedData(Z)})("exportAllData",function(Z){return O.exportAllData(Z)}),t.TgZ(2,"table",2),t.YNc(3,se,3,0,"ng-container",3),t.ALo(4,"isAllSelected"),t.ynx(5,4),t.YNc(6,y,3,3,"th",5),t.YNc(7,k,2,1,"td",6),t.BQk(),t.ynx(8,7),t.YNc(9,A,3,3,"th",8),t.YNc(10,X,3,2,"td",9),t.BQk(),t.ynx(11,10),t.YNc(12,oe,1,0,"th",8),t.YNc(13,ie,4,2,"td",9),t.BQk(),t.YNc(14,le,1,0,"tr",11),t.YNc(15,L,1,0,"tr",12),t.qZA()()(),t.YNc(16,E,4,5,"perun-web-apps-alert",13),t.YNc(17,m,3,3,"perun-web-apps-alert",13)),2&g&&(t.Q6J("hidden",0===O.resourceTags.length||0===O.dataSource.filteredData.length),t.xp6(1),t.Q6J("pageSizeOptions",O.pageSizeOptions)("dataLength",O.dataSource.filteredData.length)("tableId",O.tableId),t.xp6(1),t.Q6J("dataSource",O.dataSource),t.xp6(1),t.Q6J("ngIf",t.VKq(13,c,t.xi3(4,10,O.dataSource,O.selection.selected.length))),t.xp6(11),t.Q6J("matHeaderRowDef",O.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",O.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===O.resourceTags.length),t.xp6(1),t.Q6J("ngIf",0===O.dataSource.filteredData.length&&0!==O.resourceTags.length))},dependencies:[Y.O5,w.KE,i.Nt,P.Fj,P.JJ,P.On,M.Hw,x.lW,S.YE,S.nU,f.BZ,f.fO,f.as,f.w1,f.Dz,f.nj,f.ge,f.ev,f.XQ,f.Gk,B.oG,G.gM,N.w,T.l,e.X$,J.I,F.G,W.r]}),u})()},22158:($,K,o)=>{o.d(K,{T:()=>f});var S=o(77579);const f=(n=class{})=>class extends n{constructor(){super(...arguments),this.destroyed$=new S.x}ngOnDestroy(){this.destroyed$.next()}}},90439:($,K,o)=>{o.d(K,{F:()=>d});var S=o(94650),f=o(42377),n=o(89383);let d=(()=>{class C{constructor(){this.servicePackages=[],this.selectedPackage=null,this.multiple=!1,this.disableAutoSelect=!1,this.theme="",this.packageSelected=new S.vpe,this.nameFunction=t=>t.name,this.shortNameFunction=t=>t.description,this.searchFunction=t=>t.name+t.description}}return C.\u0275fac=function(t){return new(t||C)},C.\u0275cmp=S.Xpm({type:C,selectors:[["perun-web-apps-service-package-search-select"]],inputs:{servicePackages:"servicePackages",selectedPackage:"selectedPackage",multiple:"multiple",disableAutoSelect:"disableAutoSelect",theme:"theme"},outputs:{packageSelected:"packageSelected"},decls:4,vars:17,consts:[[3,"entities","entity","multiple","disableAutoSelect","searchFunction","mainTextFunction","secondaryTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","theme","entitySelected"]],template:function(t,e){1&t&&(S.TgZ(0,"perun-web-apps-entity-search-select",0),S.NdJ("entitySelected",function(w){return e.packageSelected.emit(w)}),S.ALo(1,"translate"),S.ALo(2,"translate"),S.ALo(3,"translate"),S.qZA()),2&t&&S.Q6J("entities",e.servicePackages)("entity",e.selectedPackage)("multiple",e.multiple)("disableAutoSelect",e.disableAutoSelect)("searchFunction",e.searchFunction)("mainTextFunction",e.nameFunction)("secondaryTextFunction",e.shortNameFunction)("selectPlaceholder",S.lcZ(1,11,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.SELECT_PACKAGE"))("findPlaceholder",S.lcZ(2,13,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.FIND_PACKAGE"))("noEntriesText",S.lcZ(3,15,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.NO_PACKAGE_FOUND"))("theme",e.theme)},dependencies:[f.i,n.X$]}),C})()}}]);