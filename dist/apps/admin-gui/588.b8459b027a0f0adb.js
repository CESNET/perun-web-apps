"use strict";(self.webpackChunkadmin_gui=self.webpackChunkadmin_gui||[]).push([[588],{11712:(F,U,s)=>{s.d(U,{A:()=>r});var e=s(53117),_=s(65879),v=s(44112);let r=(()=>{class i{prepareRoute(n){return n?.activatedRouteData&&null!==n?.activatedRouteData.animation}static#t=this.\u0275fac=function(S){return new(S||i)};static#e=this.\u0275cmp=_.Xpm({type:i,selectors:[["app-animated-router-outlet"]],decls:3,vars:0,consts:[["outlet","outlet"]],template:function(S,t){1&S&&(_.TgZ(0,"div"),_._UZ(1,"router-outlet",null,0),_.qZA())},dependencies:[v.lC],data:{animation:[e.Ji]}})}return i})()},25186:(F,U,s)=>{s.d(U,{n:()=>I});var e=s(17700),_=s(78337),v=s(73615),r=s(27618),i=s(38106),n=(s(78932),s(65879)),S=s(89515),t=s(96814),E=s(32296),y=s(11186),f=s(55959),P=s(25184),N=s(2730),T=s(69755);const D=["list"];function u(A,G){1&A&&(n.TgZ(0,"perun-web-apps-alert",11),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&A&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"DIALOGS.CREATE_ATTRIBUTE.ERROR_EMPTY_VALUE")," "))}function w(A,G){1&A&&n._UZ(0,"perun-web-apps-loading-table")}function c(A,G){if(1&A&&n._UZ(0,"perun-web-apps-attributes-list",12,13),2&A){const C=n.oxw();n.Q6J("loading",C.loading)("emptyListText","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.EMPTY_ATTRIBUTES")("attributes",C.attributes)("filterValue",C.filterValue)("selection",C.selected)("tableId",C.tableId)}}let I=(()=>{class A{constructor(C,M,Z,l,x){this.dialogRef=C,this.data=M,this.attributesManager=Z,this.notificator=l,this.translate=x,this.attributes=[],this.selected=new _.Ov(!0,[]),this.showError=!1,this.filterValue="",this.tableId=i.rF,this.translate.get("DIALOGS.CREATE_ATTRIBUTE.SUCCESS_SAVE").subscribe(O=>this.saveSuccessMessage=O)}ngOnInit(){const C=new Array;let M,Z,l,x,O,p,B,m;switch(this.data.notEmptyAttributes.forEach(g=>{C.push(g.id)}),this.data.entity){case"member":M=this.data.entityId;break;case"user":Z=this.data.entityId;break;case"vo":l=this.data.entityId;break;case"group":x=this.data.entityId;break;case"resource":O=this.data.entityId;break;case"facility":p=this.data.entityId;break;case"host":B=this.data.entityId;break;case"ues":m=this.data.entityId}switch(this.data.secondEntity){case"member":M=this.data.secondEntityId;break;case"user":Z=this.data.secondEntityId;break;case"vo":l=this.data.secondEntityId;break;case"group":x=this.data.secondEntityId;break;case"resource":O=this.data.secondEntityId;break;case"facility":p=this.data.secondEntityId;break;case"host":B=this.data.secondEntityId;break;case"ues":m=this.data.secondEntityId}this.loading=!0,this.attributesManager.getAttributesDefinitionWithRights(M,Z,l,x,O,p,B,m).subscribe(g=>{this.attributes=g,this.attributes=this.attributes.filter(h=>!C.includes(h.id)&&this.twoEntityValid(h)),this.loading=!1})}onCancel(){this.dialogRef.close()}onSave(){this.list.updateMapAttributes();let C=!1;for(const M of this.selected.selected)"java.util.ArrayList"===M.type&&0===M.value.length&&(C=!0),void 0===M.value&&(C=!0);if(C)return this.showError=!0,void setTimeout(()=>{this.showError=!1},5e3);switch(this.data.entity){case"facility":"user"===this.data.secondEntity?this.attributesManager.setUserFacilityAttributes({facility:this.data.entityId,user:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()}):this.attributesManager.setFacilityAttributes({facility:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"group":"resource"===this.data.secondEntity?this.attributesManager.setGroupResourceAttributes({group:this.data.entityId,resource:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()}):this.attributesManager.setGroupAttributes({group:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"member":switch(this.data.secondEntity){case"resource":this.attributesManager.setMemberResourceAttributes({member:this.data.entityId,resource:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"group":this.attributesManager.setMemberGroupAttributes({member:this.data.entityId,group:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;default:this.attributesManager.setMemberAttributes({member:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()})}break;case"resource":switch(this.data.secondEntity){case"member":this.attributesManager.setMemberResourceAttributes({resource:this.data.entityId,member:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"group":this.attributesManager.setGroupResourceAttributes({resource:this.data.entityId,group:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;default:this.attributesManager.setResourceAttributes({resource:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()})}break;case"user":"facility"===this.data.secondEntity?this.attributesManager.setUserFacilityAttributes({user:this.data.entityId,facility:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()}):this.attributesManager.setUserAttributes({user:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"vo":this.attributesManager.setVoAttributes({vo:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"host":this.attributesManager.setHostAttributes({host:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"ues":this.attributesManager.setUserExtSourceAttributes({userExtSource:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()})}}applyFilter(C){this.filterValue=C}handleSuccess(){this.notificator.showSuccess(this.saveSuccessMessage),this.selected.clear(),this.dialogRef.close("saved")}twoEntityValid(C){return!this.data.secondEntity||C.entity===`${this.data.entity}_${this.data.secondEntity}`||C.entity===`${this.data.secondEntity}_${this.data.entity}`}static#t=this.\u0275fac=function(M){return new(M||A)(n.Y36(e.so),n.Y36(e.WI),n.Y36(r.H8),n.Y36(v.V6),n.Y36(S.sK))};static#e=this.\u0275cmp=n.Xpm({type:A,selectors:[["app-create-attribute-dialog"]],viewQuery:function(M,Z){if(1&M&&n.Gf(D,5),2&M){let l;n.iGM(l=n.CRH())&&(Z.list=l.first)}},decls:19,vars:17,consts:[["mat-dialog-title",""],[1,"page-subtitle"],["data-cy","filter-attributes",1,"font-size-1rem",3,"placeholder","filter"],["class","ms-3 font-size-1rem","alert_type","error",4,"ngIf"],["mat-dialog-content",""],["spinner",""],[1,"position-relative","table-min-height"],[3,"loading","emptyListText","attributes","filterValue","selection","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","data-cy","save-selected-attributes","mat-flat-button","",1,"ms-2",3,"disabled","click"],["alert_type","error",1,"ms-3","font-size-1rem"],[3,"loading","emptyListText","attributes","filterValue","selection","tableId"],["list",""]],template:function(M,Z){if(1&M&&(n.TgZ(0,"div")(1,"div",0)(2,"h1",1),n._uU(3),n.ALo(4,"translate"),n.qZA(),n.TgZ(5,"perun-web-apps-debounce-filter",2),n.NdJ("filter",function(x){return Z.applyFilter(x)}),n.qZA(),n.YNc(6,u,3,3,"perun-web-apps-alert",3),n.qZA(),n.TgZ(7,"div",4),n.YNc(8,w,1,0,"ng-template",null,5,n.W1O),n.TgZ(10,"div",6),n.YNc(11,c,2,6,"perun-web-apps-attributes-list",7),n.qZA()(),n.TgZ(12,"div",8)(13,"button",9),n.NdJ("click",function(){return Z.onCancel()}),n._uU(14),n.ALo(15,"translate"),n.qZA(),n.TgZ(16,"button",10),n.NdJ("click",function(){return Z.onSave()}),n._uU(17),n.ALo(18,"translate"),n.qZA()()()),2&M){const l=n.MAs(9);n.Tol(Z.data.style),n.xp6(3),n.Oqu(n.lcZ(4,11,"DIALOGS.CREATE_ATTRIBUTE.SET_NEW")),n.xp6(2),n.Q6J("placeholder","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.FILTER"),n.xp6(1),n.Q6J("ngIf",Z.showError),n.xp6(5),n.Q6J("perunWebAppsLoader",Z.loading)("perunWebAppsLoaderIndicator",l),n.xp6(3),n.hij(" ",n.lcZ(15,13,"DIALOGS.CREATE_ATTRIBUTE.CANCEL")," "),n.xp6(2),n.Q6J("disabled",0===Z.selected.selected.length),n.xp6(1),n.hij(" ",n.lcZ(18,15,"DIALOGS.CREATE_ATTRIBUTE.SAVE")," ")}},dependencies:[t.O5,E.lW,e.uh,e.xY,e.H8,y.w,f.K,P.p,N.P,T.e,S.X$],styles:[".font-size-1rem[_ngcontent-%COMP%]{font-size:1rem!important}"]})}return A})()},26426:(F,U,s)=>{s.d(U,{k:()=>D});var e=s(17700),_=s(25313),v=s(73615),r=s(27618),i=s(65879),L=s(89515),n=s(32296),S=s(12207),t=s(69755);function E(u,w){1&u&&i._UZ(0,"perun-web-apps-loading-dialog")}function y(u,w){1&u&&i._UZ(0,"th",14)}function f(u,w){if(1&u&&(i.TgZ(0,"td",15),i._uU(1),i.qZA()),2&u){const c=w.$implicit;i.xp6(1),i.Oqu(c.displayName)}}function P(u,w){1&u&&i._UZ(0,"tr",16)}function N(u,w){1&u&&i._UZ(0,"tr",17)}function T(u,w){if(1&u){const c=i.EpF();i.TgZ(0,"div")(1,"h1",2),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"div",3)(5,"div"),i._uU(6),i.ALo(7,"translate"),i.qZA(),i.TgZ(8,"div",4),i._uU(9),i.ALo(10,"translate"),i.qZA(),i.TgZ(11,"table",5),i.ynx(12,6),i.YNc(13,y,1,0,"th",7),i.YNc(14,f,2,1,"td",8),i.BQk(),i.YNc(15,P,1,0,"tr",9),i.YNc(16,N,1,0,"tr",10),i.qZA()(),i.TgZ(17,"div",11)(18,"button",12),i.NdJ("click",function(){i.CHM(c);const A=i.oxw();return i.KtG(A.onCancel())}),i._uU(19),i.ALo(20,"translate"),i.qZA(),i.TgZ(21,"button",13),i.NdJ("click",function(){i.CHM(c);const A=i.oxw();return i.KtG(A.onSubmit())}),i._uU(22),i.ALo(23,"translate"),i.qZA()()()}if(2&u){const c=i.oxw();i.xp6(2),i.Oqu(i.lcZ(3,9,"DIALOGS.DELETE_ATTRIBUTES.TITLE")),i.xp6(4),i.hij(" ",i.lcZ(7,11,"DIALOGS.DELETE_ATTRIBUTES.DESCRIPTION")," "),i.xp6(3),i.hij(" ",i.lcZ(10,13,"DIALOGS.DELETE_ATTRIBUTES.ASK")," "),i.xp6(2),i.Q6J("dataSource",c.dataSource),i.xp6(4),i.Q6J("matHeaderRowDef",c.displayedColumns),i.xp6(1),i.Q6J("matRowDefColumns",c.displayedColumns),i.xp6(3),i.hij(" ",i.lcZ(20,15,"DIALOGS.DELETE_ATTRIBUTES.CANCEL")," "),i.xp6(2),i.Q6J("disabled",c.loading),i.xp6(1),i.hij(" ",i.lcZ(23,17,"DIALOGS.DELETE_ATTRIBUTES.DELETE")," ")}}let D=(()=>{class u{constructor(c,I,A,G,C){this.dialogRef=c,this.data=I,this.notificator=A,this.translate=G,this.attributesManager=C,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.dataSource=new _.by(this.data.attributes),this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){const c=[];for(const A of this.data.attributes)c.push(A.id);const I={};switch(I[this.data.entity]=this.data.entityId,I.attributes=c,void 0!==this.data.secondEntity&&(I[this.data.secondEntity]=this.data.secondEntityId),this.loading=!0,this.data.entity){case"vo":this.attributesManager.removeVoAttributes(this.data.entityId,c).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"group":"resource"===this.data.secondEntity?this.attributesManager.removeGroupResourceAttributes(this.data.entityId,this.data.secondEntityId,c).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1}):this.attributesManager.removeGroupAttributes(this.data.entityId,c).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"user":"facility"===this.data.secondEntity?this.attributesManager.removeUserFacilityAttributes(this.data.entityId,this.data.secondEntityId,c).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1}):this.attributesManager.removeUserAttributes(this.data.entityId,c).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"member":switch(this.data.secondEntity){case"resource":this.attributesManager.removeMemberResourceAttributes(this.data.entityId,this.data.secondEntityId,c).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"group":this.attributesManager.removeMemberGroupAttributes(this.data.entityId,this.data.secondEntityId,c).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;default:this.attributesManager.removeMemberAttributes(this.data.entityId,c).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1})}break;case"facility":"user"===this.data.secondEntity?this.attributesManager.removeUserFacilityAttributes(this.data.secondEntityId,this.data.entityId,c).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1}):this.attributesManager.removeFacilityAttributes(this.data.entityId,c).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"host":this.attributesManager.removeHostAttributes(this.data.entityId,c).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"ues":this.attributesManager.removeUesAttributes(this.data.entityId,c).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"resource":switch(this.data.secondEntity){case"member":this.attributesManager.removeMemberResourceAttributes(this.data.secondEntityId,this.data.entityId,c).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"group":this.attributesManager.removeGroupResourceAttributes(this.data.secondEntityId,this.data.entityId,c).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;default:this.attributesManager.removeResourceAttributes(this.data.entityId,c).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1})}}}onSuccess(){this.translate.get("DIALOGS.DELETE_ATTRIBUTES.SUCCESS").subscribe(c=>{this.notificator.showSuccess(c),this.dialogRef.close(!0)})}static#t=this.\u0275fac=function(I){return new(I||u)(i.Y36(e.so),i.Y36(e.WI),i.Y36(v.V6),i.Y36(L.sK),i.Y36(r.H8))};static#e=this.\u0275cmp=i.Xpm({type:u,selectors:[["app-delete-attribute-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","data-cy","delete-attributes","mat-flat-button","",1,"ms-2",3,"disabled","click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(I,A){if(1&I&&(i.YNc(0,E,1,0,"ng-template",null,0,i.W1O),i.TgZ(2,"div"),i.YNc(3,T,24,19,"div",1),i.qZA()),2&I){const G=i.MAs(1);i.xp6(2),i.Gre("",A.theme," position-relative"),i.xp6(1),i.Q6J("perunWebAppsLoader",A.loading)("perunWebAppsLoaderIndicator",G)}},dependencies:[n.lW,_.BZ,_.fO,_.as,_.w1,_.Dz,_.nj,_.ge,_.ev,_.XQ,_.Gk,e.uh,e.xY,e.H8,S.b,t.e,L.X$]})}return u})()},54200:(F,U,s)=>{s.d(U,{l:()=>y});var e=s(65879),_=s(78932),v=s(32296),r=s(17700),i=s(12207),L=s(88185),n=s(69755),S=s(89515);function t(f,P){1&f&&e._UZ(0,"perun-web-apps-loading-dialog")}function E(f,P){if(1&f){const N=e.EpF();e.TgZ(0,"div")(1,"h1",2),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",3),e._UZ(5,"perun-web-apps-ban-specification",4),e.qZA(),e.TgZ(6,"div",5)(7,"button",6),e.NdJ("click",function(){e.CHM(N);const D=e.oxw();return e.KtG(D.cancel.emit())}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",7),e.NdJ("click",function(){e.CHM(N);const D=e.oxw();return e.KtG(D.updateBan())}),e._uU(11),e.ALo(12,"translate"),e.qZA()()()}if(2&f){const N=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,5,"DIALOGS.UPDATE_BAN.TITLE")),e.xp6(3),e.Q6J("description",N.ban.description)("validity",N.ban.validityTo),e.xp6(3),e.hij(" ",e.lcZ(9,7,"DIALOGS.UPDATE_BAN.CANCEL")," "),e.xp6(3),e.hij(" ",e.lcZ(12,9,"DIALOGS.UPDATE_BAN.UPDATE")," ")}}let y=(()=>{class f{constructor(){this.loading=!1,this.cancel=new e.vpe,this.update=new e.vpe}updateBan(){this.update.emit({description:this.banForm.getDescription(),validity:this.banForm.getValidity()})}static#t=this.\u0275fac=function(T){return new(T||f)};static#e=this.\u0275cmp=e.Xpm({type:f,selectors:[["app-update-ban-dialog"]],viewQuery:function(T,D){if(1&T&&e.Gf(_.CZ,5),2&T){let u;e.iGM(u=e.CRH())&&(D.banForm=u.first)}},inputs:{loading:"loading",ban:"ban",theme:"theme"},outputs:{cancel:"cancel",update:"update"},decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[3,"description","validity"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto","me-2",3,"click"],["mat-flat-button","","color","accent",3,"click"]],template:function(T,D){if(1&T&&(e.YNc(0,t,1,0,"ng-template",null,0,e.W1O),e.TgZ(2,"div"),e.YNc(3,E,13,11,"div",1),e.qZA()),2&T){const u=e.MAs(1);e.xp6(2),e.Gre("",D.theme," position-relative"),e.xp6(1),e.Q6J("perunWebAppsLoader",D.loading)("perunWebAppsLoaderIndicator",u)}},dependencies:[v.lW,r.uh,r.xY,r.H8,i.b,L.C,n.e,S.X$]})}return f})()},52260:(F,U,s)=>{s.d(U,{e:()=>L});var e=s(17700),_=s(27618),v=s(73615),r=s(65879),i=s(54200);let L=(()=>{class n{constructor(t,E,y,f){this.data=t,this.dialogRef=E,this.resourceService=y,this.notificator=f,this.loading=!1}update(t){this.loading=!0,this.resourceService.updateResourceBan({banOnResource:{id:this.data.ban.id,beanName:"BanOnFacility",resourceId:this.data.ban.resourceId,memberId:this.data.ban.memberId,description:t.description,validityTo:t.validity}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.UPDATE_BAN.SUCCESS"),this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}cancel(){this.dialogRef.close(!1)}static#t=this.\u0275fac=function(E){return new(E||n)(r.Y36(e.WI),r.Y36(e.so),r.Y36(_.xk),r.Y36(v.V6))};static#e=this.\u0275cmp=r.Xpm({type:n,selectors:[["app-update-resource-ban-dialog"]],decls:1,vars:3,consts:[[3,"ban","theme","loading","cancel","update"]],template:function(E,y){1&E&&(r.TgZ(0,"app-update-ban-dialog",0),r.NdJ("cancel",function(){return y.cancel()})("update",function(P){return y.update(P)}),r.qZA()),2&E&&r.Q6J("ban",y.data.ban)("theme","facility-theme")("loading",y.loading)},dependencies:[i.l]})}return n})()},82060:(F,U,s)=>{s.d(U,{A:()=>L});var e=s(17700),_=s(27618),v=s(73615),r=s(65879),i=s(54200);let L=(()=>{class n{constructor(t,E,y,f){this.data=t,this.dialogRef=E,this.voService=y,this.notificator=f,this.loading=!1}update(t){this.loading=!0,this.voService.updateVoBan({banOnVo:{id:this.data.ban.id,beanName:"BanOnVo",voId:this.data.ban.voId,memberId:this.data.ban.memberId,description:t.description,validityTo:t.validity}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.UPDATE_BAN.SUCCESS"),this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}cancel(){this.dialogRef.close(!1)}static#t=this.\u0275fac=function(E){return new(E||n)(r.Y36(e.WI),r.Y36(e.so),r.Y36(_.YF),r.Y36(v.V6))};static#e=this.\u0275cmp=r.Xpm({type:n,selectors:[["app-update-vo-ban-dialog"]],decls:1,vars:3,consts:[[3,"ban","theme","loading","cancel","update"]],template:function(E,y){1&E&&(r.TgZ(0,"app-update-ban-dialog",0),r.NdJ("cancel",function(){return y.cancel()})("update",function(P){return y.update(P)}),r.qZA()),2&E&&r.Q6J("ban",y.data.ban)("theme","vo-theme")("loading",y.loading)},dependencies:[i.l]})}return n})()},7831:(F,U,s)=>{s.d(U,{r:()=>O});var e=s(65879),_=s(56223),v=s(64124),r=s(50165),i=s(27618),L=s(73615),n=s(92596),S=s(87466),t=s(91762),E=s(83620),y=s(48180),f=s(94664),P=s(37398),N=s(96814),T=s(23680),D=s(24516),u=s(64170),w=s(98525),c=s(89515);function I(p,B){if(1&p&&(e.TgZ(0,"mat-option",7),e._uU(1),e.qZA()),2&p){const m=B.$implicit;e.Q6J("value",m),e.xp6(1),e.hij(" ",m," ")}}function A(p,B){1&p&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&p&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.FIELD_EMPTY")))}function G(p,B){1&p&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&p&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_EXISTS")))}function C(p,B){1&p&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&p&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_FORMAT")))}function M(p,B){1&p&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&p&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_LONG")))}function Z(p,B){1&p&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&p&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_SHORT")))}function l(p,B){if(1&p&&(e.TgZ(0,"span",8),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&p){const m=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,"Not selected"===m.formGroup.get("namespaceCtrl").value?"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_DISABLED":"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_DISABLED_FOR_NAMESPACE")," ")}}let x=(()=>{class p{constructor(m,g){this.membersManagerService=m,this.usersManagerService=g,this.filteredNamespaces=null,this.namespaceChanged=new e.vpe,this.parsedRulesChanged=new e.vpe,this.namespaceOptions=[],this.selectedNamespace=null,this.namespaceRules=[],this.parsedRules=new Map}ngOnInit(){this.namespaceOptions=["Not selected"],this.membersManagerService.getAllNamespacesRules().subscribe(m=>{this.namespaceRules=m,this.parseNamespaceRules()}),this.onNamespaceChanged("Not selected")}existingLoginValidator(){return m=>{let g=this.formGroup.get("namespaceCtrl").value.toLowerCase();return g="not selected"===g?"mu":g,m.valueChanges.pipe((0,E.b)(500),(0,y.q)(1),(0,f.w)(()=>this.usersManagerService.isLoginAvailable(g,m.value).pipe((0,P.U)(h=>h?null:{loginExists:!0}))))}}parseNamespaceRules(){for(const m of this.namespaceRules)if(null===this.filteredNamespaces||!this.filteredNamespaces.includes(m.namespaceName)){this.namespaceOptions.push(m.namespaceName);const g={login:"disabled"};this.parseAttributes(g,m.requiredAttributes,"required"),this.parseAttributes(g,m.optionalAttributes,"optional"),this.parsedRules.set(m.namespaceName,g)}this.parsedRulesChanged.emit(this.parsedRules)}parseAttributes(m,g,h){for(const W of g)"login"===W&&(m.login=h)}onNamespaceChanged(m){this.selectedNamespace=m.toLowerCase();const g=this.formGroup.get("loginCtrl");if("Not selected"!==m)if("disabled"===this.parsedRules.get(this.selectedNamespace).login)g.disable(),g.setValue("");else{const h=[_.kI.required,_.kI.pattern("^[a-z][a-z0-9_-]+$"),_.kI.maxLength(15),_.kI.minLength(2)];(0,v.mH)(g,h,[this.existingLoginValidator()])}else g.disable(),g.setValue("");this.namespaceChanged.emit(m)}static#t=this.\u0275fac=function(g){return new(g||p)(e.Y36(i.uq),e.Y36(i.Fv))};static#e=this.\u0275cmp=e.Xpm({type:p,selectors:[["app-login-for-namespace"]],inputs:{formGroup:"formGroup",filteredNamespaces:"filteredNamespaces"},outputs:{namespaceChanged:"namespaceChanged",parsedRulesChanged:"parsedRulesChanged"},decls:18,vars:16,consts:[[1,"display-flex",3,"formGroup"],["formControlName","namespaceCtrl",3,"valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"floatLabel"],["formControlName","loginCtrl","matInput","","required","",3,"hidden"],[4,"ngIf"],["class","input-disabled",4,"ngIf"],[3,"value"],[1,"input-disabled"]],template:function(g,h){1&g&&(e.TgZ(0,"div",0)(1,"mat-form-field")(2,"mat-label"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"mat-select",1),e.NdJ("valueChange",function(J){return h.onNamespaceChanged(J)}),e.YNc(6,I,2,2,"mat-option",2),e.qZA()(),e.TgZ(7,"mat-form-field",3)(8,"mat-label"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e._UZ(11,"input",4),e.YNc(12,A,3,3,"mat-error",5),e.YNc(13,G,3,3,"mat-error",5),e.YNc(14,C,3,3,"mat-error",5),e.YNc(15,M,3,3,"mat-error",5),e.YNc(16,Z,3,3,"mat-error",5),e.YNc(17,l,3,3,"span",6),e.qZA()()),2&g&&(e.Q6J("formGroup",h.formGroup),e.xp6(3),e.Oqu(e.lcZ(4,12,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.NAMESPACE")),e.xp6(3),e.Q6J("ngForOf",h.namespaceOptions),e.xp6(1),e.Q6J("floatLabel",h.formGroup.get("loginCtrl").disabled?"always":null),e.xp6(2),e.Oqu(e.lcZ(10,14,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN")),e.xp6(2),e.Q6J("hidden",h.formGroup.get("loginCtrl").disabled),e.xp6(1),e.Q6J("ngIf",h.formGroup.get("loginCtrl").hasError("required")),e.xp6(1),e.Q6J("ngIf",h.formGroup.get("loginCtrl").hasError("loginExists")),e.xp6(1),e.Q6J("ngIf",h.formGroup.get("loginCtrl").hasError("pattern")&&!h.formGroup.get("loginCtrl").hasError("minlength")),e.xp6(1),e.Q6J("ngIf",h.formGroup.get("loginCtrl").hasError("maxlength")),e.xp6(1),e.Q6J("ngIf",h.formGroup.get("loginCtrl").hasError("minlength")),e.xp6(1),e.Q6J("ngIf",h.formGroup.get("loginCtrl").disabled))},dependencies:[N.sg,N.O5,T.ey,D.Nt,u.KE,u.hX,u.TO,_.Fj,_.JJ,_.JL,_.Q7,_.sg,_.u,w.gD,c.X$],styles:[".display-flex[_ngcontent-%COMP%]{display:flex;flex-direction:column}.input-disabled[_ngcontent-%COMP%]{pointer-events:none;color:#888}"]})}return p})(),O=(()=>{class p{constructor(m,g,h){this.membersManagerService=m,this.usersManagerService=g,this.apiRequestConfiguration=h,this.filteredNamespace=null,this.parsedRulesOutput=new e.vpe,this.selectedNamespace=null,this.parsedRules=new Map}parsedRulesFunction(m){this.parsedRules=m,this.parsedRulesOutput.emit(m)}onNamespaceChanged(m){this.selectedNamespace=m.toLowerCase();const g=this.formGroup.get("passwordCtrl"),h=this.formGroup.get("passwordAgainCtrl"),W=this.formGroup.get("generatePasswordCtrl");"Not selected"!==m?((0,v.mH)(W,[]),this.passwordOptionChanged()):(g.disable(),g.setValue(""),h.disable(),h.setValue(""),W.disable(),W.dirty||W.setValue(!0))}passwordOptionChanged(){const m=this.formGroup.get("passwordCtrl"),g=this.formGroup.get("passwordAgainCtrl");this.formGroup.get("generatePasswordCtrl").value?(m.disable(),m.setValue(""),g.disable(),g.setValue("")):((0,v.mH)(m,[_.kI.required],[(0,r.yT)(this.selectedNamespace,this.usersManagerService,this.apiRequestConfiguration)]),(0,v.mH)(g,[]))}static#t=this.\u0275fac=function(g){return new(g||p)(e.Y36(i.uq),e.Y36(i.Fv),e.Y36(L.F5))};static#e=this.\u0275cmp=e.Xpm({type:p,selectors:[["app-login-password-form-with-generate-option"]],inputs:{formGroup:"formGroup",filteredNamespace:"filteredNamespace"},outputs:{parsedRulesOutput:"parsedRulesOutput"},decls:12,vars:23,consts:[[1,"display-flex",3,"formGroup"],[3,"formGroup","filteredNamespaces","namespaceChanged","parsedRulesChanged"],["formControlName","generatePasswordCtrl","matTooltipPosition","left",1,"display-flex","mt-3",3,"matTooltipDisabled","matTooltip","ngModelChange"],[3,"checked","value"],[1,"display-flex"],[3,"formGroup","namespace","passwordRequired","tooltipPwdDisabledForNamespace"]],template:function(g,h){1&g&&(e.TgZ(0,"div",0)(1,"app-login-for-namespace",1),e.NdJ("namespaceChanged",function(J){return h.onNamespaceChanged(J)})("parsedRulesChanged",function(J){return h.parsedRulesFunction(J)}),e.qZA(),e.TgZ(2,"mat-radio-group",2),e.NdJ("ngModelChange",function(){return h.passwordOptionChanged()}),e.ALo(3,"translate"),e.TgZ(4,"mat-radio-button",3),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"mat-radio-button",3),e._uU(8),e.ALo(9,"translate"),e.qZA()(),e.TgZ(10,"div",4),e._UZ(11,"perun-web-apps-password-form",5),e.qZA()()),2&g&&(e.Q6J("formGroup",h.formGroup),e.xp6(1),e.Q6J("formGroup",h.formGroup)("filteredNamespaces",h.filteredNamespace),e.xp6(1),e.s9C("matTooltip",e.lcZ(3,17,"DIALOGS.CREATE_SERVICE_MEMBER.PASSWORD_NOT_SUPPORTED")),e.Q6J("matTooltipDisabled","Not selected"!==h.formGroup.get("namespaceCtrl").value),e.xp6(2),e.Q6J("checked",h.formGroup.get("generatePasswordCtrl").value&&h.formGroup.get("generatePasswordCtrl").enabled)("value",!0),e.xp6(1),e.hij(" ",e.lcZ(6,19,"DIALOGS.CREATE_SERVICE_MEMBER.PASSWORD_RANDOM")," "),e.xp6(2),e.Q6J("checked",!h.formGroup.get("generatePasswordCtrl").value&&h.formGroup.get("generatePasswordCtrl").enabled)("value",!1),e.xp6(1),e.hij(" ",e.lcZ(9,21,"DIALOGS.CREATE_SERVICE_MEMBER.ENTER_PASSWORD")," "),e.xp6(2),e.ekj("input-disabled",h.formGroup.get("generatePasswordCtrl").value),e.xp6(1),e.Q6J("formGroup",h.formGroup)("namespace",h.selectedNamespace)("passwordRequired",!h.formGroup.get("generatePasswordCtrl").value)("tooltipPwdDisabledForNamespace",h.formGroup.get("generatePasswordCtrl").enabled))},dependencies:[_.JJ,_.JL,_.sg,_.u,n.gM,S.VQ,S.U0,t.G,x,c.X$],styles:[".display-flex[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]})}return p})()},5786:(F,U,s)=>{s.d(U,{t:()=>C});var e=s(27618),_=s(78337),v=s(64124),r=s(25186),i=s(37073),L=s(26426),S=(s(78932),s(38106)),t=s(65879),E=s(17700),y=s(56223),f=s(32296),P=s(82599),N=s(55959),T=s(62481),D=s(25184),u=s(2730),w=s(69755),c=s(89515);const I=["list"];function A(M,Z){1&M&&t._UZ(0,"perun-web-apps-loading-table")}function G(M,Z){if(1&M&&t._UZ(0,"perun-web-apps-attributes-list",9,10),2&M){const l=t.oxw();t.Q6J("loading",l.loading)("attributes",l.attributes)("filterValue",l.filterValue)("filterEmpty",l.filterEmpty)("selection",l.selection)("tableId",l.tableId)}}let C=(()=>{class M{constructor(l,x){this.attributesManagerService=l,this.dialog=x,this.attributes=[],this.selection=new _.Ov(!0,[]),this.filterValue="",this.filterEmpty=!0,this.tableId=S.rF,this.loading=!1}ngOnInit(){this.refreshTable()}refreshTable(){switch(this.loading=!0,this.entity){case"member":this.attributesManagerService.getMemberAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"group":this.attributesManagerService.getGroupAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"user":this.attributesManagerService.getUserAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"resource":this.attributesManagerService.getResourceAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"facility":this.attributesManagerService.getFacilityAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"vo":this.attributesManagerService.getVoAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"host":this.attributesManagerService.getHostAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1})}}applyFilter(l){this.filterValue=l}onCreate(){const l=(0,v.kZ)();l.width="1050px",l.data={entityId:this.entityId,entity:this.entity,notEmptyAttributes:this.attributes,style:this.entity+"-theme"},this.dialog.open(r.n,l).afterClosed().subscribe(O=>{O&&this.refreshTable()})}onSave(){this.list.updateMapAttributes();const l=(0,v.kZ)();l.width="450px",l.data={entityId:this.entityId,entity:this.entity,attributes:this.selection.selected},this.dialog.open(i.wA,l).afterClosed().subscribe(O=>{O&&this.refreshTable()})}onDelete(){const l=(0,v.kZ)();l.width="450px",l.data={entityId:this.entityId,entity:this.entity,attributes:this.selection.selected},this.dialog.open(L.k,l).afterClosed().subscribe(O=>{O&&this.refreshTable()})}static#t=this.\u0275fac=function(x){return new(x||M)(t.Y36(e.H8),t.Y36(E.uw))};static#e=this.\u0275cmp=t.Xpm({type:M,selectors:[["app-one-entity-attribute-page"]],viewQuery:function(x,O){if(1&x&&t.Gf(I,5),2&x){let p;t.iGM(p=t.CRH())&&(O.list=p.first)}},inputs:{entity:"entity",entityId:"entityId"},decls:18,vars:18,consts:[[3,"refresh"],["color","accent","data-cy","add-attributes","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","accent","mat-flat-button","",1,"me-2",3,"disabled","click"],["color","warn","data-cy","remove-attributes","mat-flat-button","",1,"me-2",3,"disabled","click"],[1,"me-2",3,"placeholder","filter"],["labelPosition","before",3,"ngModel","ngModelChange"],["spinner",""],[1,"position-relative","table-min-height"],[3,"loading","attributes","filterValue","filterEmpty","selection","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","attributes","filterValue","filterEmpty","selection","tableId"],["list",""]],template:function(x,O){if(1&x&&(t.TgZ(0,"perun-web-apps-refresh-button",0),t.NdJ("refresh",function(){return O.refreshTable()}),t.qZA(),t.TgZ(1,"button",1),t.NdJ("click",function(){return O.onCreate()}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",2),t.NdJ("click",function(){return O.onSave()}),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"button",3),t.NdJ("click",function(){return O.onDelete()}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"perun-web-apps-debounce-filter",4),t.NdJ("filter",function(B){return O.applyFilter(B)}),t.qZA(),t.TgZ(11,"mat-slide-toggle",5),t.NdJ("ngModelChange",function(B){return O.filterEmpty=B}),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.YNc(14,A,1,0,"ng-template",null,6,t.W1O),t.TgZ(16,"div",7),t.YNc(17,G,2,6,"perun-web-apps-attributes-list",8),t.qZA()),2&x){const p=t.MAs(15);t.xp6(2),t.hij(" ",t.lcZ(3,10,"ATTRIBUTE_PAGE.CREATE"),"\n"),t.xp6(2),t.Q6J("disabled",0===O.selection.selected.length),t.xp6(1),t.hij(" ",t.lcZ(6,12,"ATTRIBUTE_PAGE.SAVE"),"\n"),t.xp6(2),t.Q6J("disabled",0===O.selection.selected.length),t.xp6(1),t.hij(" ",t.lcZ(9,14,"ATTRIBUTE_PAGE.DELETE"),"\n"),t.xp6(2),t.Q6J("placeholder","ATTRIBUTE_PAGE.FILTER"),t.xp6(1),t.Q6J("ngModel",O.filterEmpty),t.xp6(1),t.hij(" ",t.lcZ(13,16,"ATTRIBUTE_PAGE.FILTER_EMPTY"),"\n"),t.xp6(5),t.Q6J("perunWebAppsLoader",O.loading)("perunWebAppsLoaderIndicator",p)}},dependencies:[y.JJ,y.On,f.lW,P.Rr,N.K,T.t,D.p,u.P,w.e,c.X$]})}return M})()},95845:(F,U,s)=>{s.d(U,{Y:()=>X});var e=s(27618),v=(s(78932),s(78337)),r=s(26426),i=s(64124),L=s(37073),n=s(25186),S=s(1385),t=s(65879),E=s(17700),y=s(96814),f=s(56223),P=s(32296),N=s(55940),T=s(82599),D=s(11186),u=s(55959),w=s(62481),c=s(25184),I=s(10781),A=s(89655),G=s(4675),C=s(89515);let M=(()=>{class b{constructor(){this.memberSelected=new t.vpe,this.memberFullNameFunction=a=>(0,i.bD)(a.user)}ngOnInit(){this.members=this.members.sort(i.fx)}static#t=this.\u0275fac=function(o){return new(o||b)};static#e=this.\u0275cmp=t.Xpm({type:b,selectors:[["perun-web-apps-member-search-select"]],inputs:{members:"members"},outputs:{memberSelected:"memberSelected"},decls:4,vars:12,consts:[[3,"entities","searchFunction","mainTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","entitySelected"]],template:function(o,d){1&o&&(t.TgZ(0,"perun-web-apps-entity-search-select",0),t.NdJ("entitySelected",function(Y){return d.memberSelected.emit(Y)}),t.ALo(1,"translate"),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&o&&t.Q6J("entities",d.members)("searchFunction",d.memberFullNameFunction)("mainTextFunction",d.memberFullNameFunction)("selectPlaceholder",t.lcZ(1,6,"SHARED_LIB.PERUN.COMPONENTS.MEMBER_SEARCH_SELECT.SELECT_MEMBER"))("findPlaceholder",t.lcZ(2,8,"SHARED_LIB.PERUN.COMPONENTS.MEMBER_SEARCH_SELECT.FIND_MEMBER"))("noEntriesText",t.lcZ(3,10,"SHARED_LIB.PERUN.COMPONENTS.MEMBER_SEARCH_SELECT.NO_MEMBER_FOUND"))},dependencies:[G.i,C.X$]})}return b})();var Z=s(4646),l=s(10350),x=s(2730),O=s(69755);const p=["list"];function B(b,K){1&b&&t._UZ(0,"mat-spinner",4)}function m(b,K){if(1&b&&(t.TgZ(0,"perun-web-apps-alert",5),t._uU(1),t.qZA()),2&b){const a=t.oxw();t.xp6(1),t.Oqu(a.noEntityMessage)}}function g(b,K){if(1&b){const a=t.EpF();t.TgZ(0,"perun-web-apps-group-search-select",22),t.NdJ("groupSelected",function(d){t.CHM(a);const R=t.oxw(3);return t.KtG(R.specifySecondEntity(d))}),t.qZA()}if(2&b){const a=t.oxw(3);t.Q6J("firstSelectedGroup",a.specificSecondEntity)("displayStatus",!0)("groups",a.entityValues)}}function h(b,K){if(1&b){const a=t.EpF();t.TgZ(0,"perun-web-apps-resource-search-select",23),t.NdJ("resourceSelected",function(d){t.CHM(a);const R=t.oxw(3);return t.KtG(R.specifySecondEntity(d))}),t.qZA()}if(2&b){const a=t.oxw(3);t.Q6J("resources",a.entityValues)}}function W(b,K){if(1&b){const a=t.EpF();t.TgZ(0,"perun-web-apps-member-search-select",24),t.NdJ("memberSelected",function(d){t.CHM(a);const R=t.oxw(3);return t.KtG(R.specifySecondEntity(d))}),t.qZA()}if(2&b){const a=t.oxw(3);t.Q6J("members",a.entityValues)}}function J(b,K){if(1&b){const a=t.EpF();t.TgZ(0,"perun-web-apps-facility-search-select",25),t.NdJ("facilitySelected",function(d){t.CHM(a);const R=t.oxw(3);return t.KtG(R.specifySecondEntity(d))}),t.qZA()}if(2&b){const a=t.oxw(3);t.Q6J("facilities",a.entityValues)}}function Q(b,K){if(1&b){const a=t.EpF();t.TgZ(0,"perun-web-apps-user-search-select",26),t.NdJ("userSelected",function(d){t.CHM(a);const R=t.oxw(3);return t.KtG(R.specifySecondEntity(d))}),t.qZA()}if(2&b){const a=t.oxw(3);t.Q6J("users",a.entityValues)}}function V(b,K){if(1&b&&(t.TgZ(0,"div",16),t.YNc(1,g,1,3,"perun-web-apps-group-search-select",17),t.YNc(2,h,1,1,"perun-web-apps-resource-search-select",18),t.YNc(3,W,1,1,"perun-web-apps-member-search-select",19),t.YNc(4,J,1,1,"perun-web-apps-facility-search-select",20),t.YNc(5,Q,1,1,"perun-web-apps-user-search-select",21),t.qZA()),2&b){const a=t.oxw(2);t.xp6(1),t.Q6J("ngIf","group"===a.secondEntity),t.xp6(1),t.Q6J("ngIf","resource"===a.secondEntity),t.xp6(1),t.Q6J("ngIf","member"===a.secondEntity),t.xp6(1),t.Q6J("ngIf","facility"===a.secondEntity),t.xp6(1),t.Q6J("ngIf","user"===a.secondEntity)}}function H(b,K){1&b&&t._UZ(0,"perun-web-apps-loading-table")}function k(b,K){if(1&b&&t._UZ(0,"perun-web-apps-attributes-list",27,28),2&b){const a=t.oxw(2);t.Q6J("loading",a.innerLoading)("attributes",a.attributes)("filterValue",a.filterValue)("filterEmpty",a.filterEmpty)("selection",a.selection)}}function j(b,K){if(1&b){const a=t.EpF();t.TgZ(0,"div"),t.YNc(1,V,6,5,"div",6),t.TgZ(2,"perun-web-apps-refresh-button",7),t.NdJ("refresh",function(){t.CHM(a);const d=t.oxw();return t.KtG(d.getAttributes(d.specificSecondEntity.id))}),t.qZA(),t.TgZ(3,"button",8),t.NdJ("click",function(){t.CHM(a);const d=t.oxw();return t.KtG(d.onAdd(d.specificSecondEntity.id))}),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"button",9),t.NdJ("click",function(){t.CHM(a);const d=t.oxw();return t.KtG(d.onSave(d.specificSecondEntity.id))}),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"button",10),t.NdJ("click",function(){t.CHM(a);const d=t.oxw();return t.KtG(d.onDelete(d.specificSecondEntity.id))}),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"perun-web-apps-debounce-filter",11),t.NdJ("filter",function(d){t.CHM(a);const R=t.oxw();return t.KtG(R.applyFilter(d))}),t.qZA(),t.TgZ(13,"mat-slide-toggle",12),t.NdJ("ngModelChange",function(d){t.CHM(a);const R=t.oxw();return t.KtG(R.filterEmpty=d)}),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.YNc(16,H,1,0,"ng-template",null,13,t.W1O),t.TgZ(18,"div",14),t.YNc(19,k,2,5,"perun-web-apps-attributes-list",15),t.qZA()()}if(2&b){const a=t.MAs(17),o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.showSelect),t.xp6(3),t.hij(" ",t.lcZ(5,11,"ATTRIBUTE_PAGE.CREATE")," "),t.xp6(2),t.Q6J("disabled",0===o.selection.selected.length),t.xp6(1),t.hij(" ",t.lcZ(8,13,"ATTRIBUTE_PAGE.SAVE")," "),t.xp6(2),t.Q6J("disabled",0===o.selection.selected.length),t.xp6(1),t.hij(" ",t.lcZ(11,15,"ATTRIBUTE_PAGE.DELETE")," "),t.xp6(2),t.Q6J("placeholder","ATTRIBUTE_PAGE.FILTER"),t.xp6(1),t.Q6J("ngModel",o.filterEmpty),t.xp6(1),t.hij(" ",t.lcZ(15,17,"ATTRIBUTE_PAGE.FILTER_EMPTY")," "),t.xp6(5),t.Q6J("perunWebAppsLoader",o.innerLoading)("perunWebAppsLoaderIndicator",a)}}let X=(()=>{class b{constructor(a,o,d,R,Y,$,z){this.attributesManagerService=a,this.resourcesManagerService=o,this.facilitiesManagerService=d,this.groupsManagerService=R,this.membersManager=Y,this.usersManager=$,this.dialog=z,this.specificSecondEntity=null,this.entityValues=[],this.attributes=[],this.selection=new v.Ov(!0,[]),this.allowedStatuses=["INVALID","VALID"],this.loading=!1,this.innerLoading=!1,this.filterValue="",this.filterEmpty=!0,this.showSelect=!0}ngOnInit(){this.showSelect=null===this.specificSecondEntity,this.loadEntityValues(),this.setMessages(this.secondEntity.toLowerCase())}loadEntityValues(){switch(this.loading=!0,this.firstEntity){case"member":switch(this.secondEntity){case"resource":this.resourcesManagerService.getAssignedResourcesWithStatus(this.firstEntityId).subscribe(a=>{this.entityValues=a.map(o=>o.enrichedResource.resource),this.preselectEntity(),this.loading=!1});break;case"group":this.groupsManagerService.getMemberGroups(this.firstEntityId).subscribe(a=>{this.entityValues=a,this.preselectEntity(),this.loading=!1})}break;case"group":switch(this.secondEntity){case"resource":this.resourcesManagerService.getResourceAssignments(this.firstEntityId).subscribe(a=>{this.entityValues=a.map(o=>{const d=o.enrichedResource.resource;return d.status=o.status,d}),this.preselectEntity(),this.loading=!1});break;case"member":this.membersManager.getCompleteRichMembersForGroup(this.firstEntityId,!1,this.allowedStatuses,null,[S.r.MEMBER_CORE_ID]).subscribe(a=>{this.entityValues=a,this.preselectEntity(),this.loading=!1})}break;case"user":"resource"===this.secondEntity?this.usersManager.getAssociatedResourcesForUser(this.facilityId,this.firstEntityId).subscribe(a=>{this.entityValues=a,this.preselectEntity(),this.loading=!1}):this.facilitiesManagerService.getAssignedFacilitiesByUser(this.firstEntityId).subscribe(a=>{this.entityValues=a,this.preselectEntity(),this.loading=!1});break;case"resource":switch(this.secondEntity){case"member":this.resourcesManagerService.getAssignedMembersWithStatus(this.firstEntityId).subscribe(a=>{this.entityValues=a.map(o=>o.richMember),this.preselectEntity(),this.loading=!1});break;case"group":this.resourcesManagerService.getGroupAssignments(this.firstEntityId).subscribe(a=>{this.entityValues=a.map(o=>{const d=o.enrichedGroup.group;return d.status=o.status,d}),this.preselectEntity(),this.loading=!1})}break;case"facility":this.facilitiesManagerService.getAssignedUsers(this.firstEntityId).subscribe(a=>{this.entityValues=a,this.preselectEntity(),this.loading=!1})}}preselectEntity(){null!==this.specificSecondEntity?this.specifySecondEntity(this.specificSecondEntity):0!==this.entityValues.length&&this.findInitiallySelectedEntity()}findInitiallySelectedEntity(){let a="member"===this.secondEntity||"user"===this.secondEntity?this.entityValues.sort(i.fx)[0]:this.entityValues.sort(i.aC)[0];const o=(0,i.vL)(this.entityKey());if(o)for(const d of this.entityValues)if(d.id===o[0]){a=d;break}this.specifySecondEntity(a)}entityKey(){return"group"===this.secondEntity?"groups":""}getAttributes(a){switch(this.innerLoading=!0,this.selection.clear(),this.firstEntity){case"member":switch(this.secondEntity){case"resource":this.attributesManagerService.getMemberResourceAttributes(this.firstEntityId,a).subscribe(o=>{this.attributes=o,this.innerLoading=!1});break;case"group":this.attributesManagerService.getMemberGroupAttributes(this.firstEntityId,a).subscribe(o=>{this.attributes=o,this.innerLoading=!1})}break;case"group":switch(this.secondEntity){case"resource":this.attributesManagerService.getGroupResourceAttributes(this.firstEntityId,a).subscribe(o=>{this.attributes=o,this.innerLoading=!1});break;case"member":this.attributesManagerService.getMemberGroupAttributes(a,this.firstEntityId).subscribe(o=>{this.attributes=o,this.innerLoading=!1})}break;case"user":"resource"===this.secondEntity?this.membersManager.getMemberByUser(this.specificSecondEntity.voId,this.firstEntityId).subscribe(o=>{this.attributesManagerService.getMemberResourceAttributes(o.id,a).subscribe(d=>{this.attributes=d,this.innerLoading=!1})}):this.attributesManagerService.getUserFacilityAttributes(this.firstEntityId,a).subscribe(o=>{this.attributes=o,this.innerLoading=!1});break;case"resource":switch(this.secondEntity){case"member":this.attributesManagerService.getMemberResourceAttributes(a,this.firstEntityId).subscribe(o=>{this.attributes=o,this.innerLoading=!1});break;case"group":this.attributesManagerService.getGroupResourceAttributes(a,this.firstEntityId).subscribe(o=>{this.attributes=o,this.innerLoading=!1})}break;case"facility":this.attributesManagerService.getUserFacilityAttributes(a,this.firstEntityId).subscribe(o=>{this.attributes=o,this.innerLoading=!1})}}setMessages(a){this.noEntityMessage=`No ${a} assigned`}onSave(a){this.list.updateMapAttributes();const o=(0,i.kZ)();o.width="450px",o.data={entityId:this.firstEntityId,entity:this.firstEntity,secondEntity:this.secondEntity,secondEntityId:a,attributes:this.selection.selected},this.dialog.open(L.wA,o).afterClosed().subscribe(R=>{R&&(this.selection.clear(),this.getAttributes(a))})}onDelete(a){const o=(0,i.kZ)();o.width="450px",o.data={entityId:this.firstEntityId,entity:this.firstEntity,secondEntity:this.secondEntity,secondEntityId:a,attributes:this.selection.selected,theme:`${this.firstEntity}-theme`},this.dialog.open(r.k,o).afterClosed().subscribe(R=>{R&&(this.selection.clear(),this.getAttributes(a))})}onAdd(a){const o=(0,i.kZ)();o.width="1050px",o.data={entityId:this.firstEntityId,entity:this.firstEntity,secondEntity:this.secondEntity,secondEntityId:a,notEmptyAttributes:this.attributes,style:`${this.firstEntity}-theme`},this.dialog.open(n.n,o).afterClosed().subscribe(R=>{R&&(this.selection.clear(),this.getAttributes(a))})}specifySecondEntity(a){a&&(this.specificSecondEntity=a,this.getAttributes(this.specificSecondEntity.id))}applyFilter(a){this.filterValue=a}static#t=this.\u0275fac=function(o){return new(o||b)(t.Y36(e.H8),t.Y36(e.xk),t.Y36(e.IQ),t.Y36(e.ff),t.Y36(e.uq),t.Y36(e.Fv),t.Y36(E.uw))};static#e=this.\u0275cmp=t.Xpm({type:b,selectors:[["app-two-entity-attribute-page"]],viewQuery:function(o,d){if(1&o&&t.Gf(p,5),2&o){let R;t.iGM(R=t.CRH())&&(d.list=R.first)}},inputs:{firstEntityId:"firstEntityId",firstEntity:"firstEntity",secondEntity:"secondEntity",specificSecondEntity:"specificSecondEntity",facilityId:"facilityId"},decls:4,vars:3,consts:[[1,"mt-3"],["class","ms-auto me-auto",4,"ngIf"],["alert_type","warn",4,"ngIf"],[4,"ngIf"],[1,"ms-auto","me-auto"],["alert_type","warn"],["class","flex-row",4,"ngIf"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","accent","mat-flat-button","",1,"me-2",3,"disabled","click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[1,"me-2",3,"placeholder","filter"],["labelPosition","before",3,"ngModel","ngModelChange"],["spinner",""],[1,"position-relative","table-min-height"],[3,"loading","attributes","filterValue","filterEmpty","selection",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[1,"flex-row"],[3,"firstSelectedGroup","displayStatus","groups","groupSelected",4,"ngIf"],[3,"resources","resourceSelected",4,"ngIf"],[3,"members","memberSelected",4,"ngIf"],[3,"facilities","facilitySelected",4,"ngIf"],[3,"users","userSelected",4,"ngIf"],[3,"firstSelectedGroup","displayStatus","groups","groupSelected"],[3,"resources","resourceSelected"],[3,"members","memberSelected"],[3,"facilities","facilitySelected"],[3,"users","userSelected"],[3,"loading","attributes","filterValue","filterEmpty","selection"],["list",""]],template:function(o,d){1&o&&(t.TgZ(0,"div",0),t.YNc(1,B,1,0,"mat-spinner",1),t.YNc(2,m,2,1,"perun-web-apps-alert",2),t.YNc(3,j,20,19,"div",3),t.qZA()),2&o&&(t.xp6(1),t.Q6J("ngIf",d.loading),t.xp6(1),t.Q6J("ngIf",0===d.entityValues.length&&!d.loading),t.xp6(1),t.Q6J("ngIf",0!==d.entityValues.length))},dependencies:[y.O5,f.JJ,f.On,P.lW,N.Ou,T.Rr,D.w,u.K,w.t,c.p,I.h,A.L,M,Z.R,l.S,x.P,O.e,C.X$],styles:[".w-35[_ngcontent-%COMP%]{width:35%}"]})}return b})()},19218:(F,U,s)=>{s.d(U,{A:()=>D});var e=s(73615),_=s(94664),v=s(22096),r=s(65879),i=s(96814),L=s(30617),n=s(32296),S=s(26385),t=s(39518),E=s(89515);function y(u,w){1&u&&(r.TgZ(0,"mat-icon"),r._uU(1,"keyboard_arrow_down"),r.qZA())}function f(u,w){1&u&&(r.TgZ(0,"mat-icon"),r._uU(1,"keyboard_arrow_right"),r.qZA())}function P(u,w){if(1&u&&r._UZ(0,"perun-web-apps-menu-buttons-field",8),2&u){const c=r.oxw(2);r.Q6J("items",c.items)}}function N(u,w){if(1&u){const c=r.EpF();r.TgZ(0,"div",1)(1,"button",2),r.NdJ("click",function(){r.CHM(c);const A=r.oxw();return r.KtG(A.toggle())}),r.TgZ(2,"div",3)(3,"span",4),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.YNc(6,y,2,0,"mat-icon",5),r.YNc(7,f,2,0,"mat-icon",5),r.qZA()(),r._UZ(8,"mat-divider",6),r.YNc(9,P,1,1,"perun-web-apps-menu-buttons-field",7),r.qZA()}if(2&u){const c=w.ngIf,I=r.oxw();r.xp6(4),r.Oqu(r.lcZ(5,4,I.title)),r.xp6(2),r.Q6J("ngIf",c.expanded),r.xp6(1),r.Q6J("ngIf",!c.expanded),r.xp6(2),r.Q6J("ngIf",c.expanded)}}const T=function(u){return{expanded:u}};let D=(()=>{class u{constructor(c){this.expandedTilesStore=c}ngOnInit(){this.expanded=this.expandedTilesStore.getStates().pipe((0,_.w)(c=>(0,v.of)(c.get(this.sectionId))))}toggle(){this.expandedTilesStore.setItem(this.sectionId)}static#t=this.\u0275fac=function(I){return new(I||u)(r.Y36(e.SA))};static#e=this.\u0275cmp=r.Xpm({type:u,selectors:[["perun-web-apps-expandable-tiles"]],inputs:{items:"items",title:"title",sectionId:"sectionId"},decls:2,vars:5,consts:[["class","mt-4",4,"ngIf"],[1,"mt-4"],["mat-button","",3,"click"],[1,"d-flex","align-items-center","justify-content-start"],[1,"fs-5"],[4,"ngIf"],[1,"max-divider-width","mb-3"],[3,"items",4,"ngIf"],[3,"items"]],template:function(I,A){1&I&&(r.YNc(0,N,10,6,"div",0),r.ALo(1,"async")),2&I&&r.Q6J("ngIf",0!==A.items.length&&r.VKq(3,T,r.lcZ(1,1,A.expanded)))},dependencies:[i.O5,L.Hw,n.lW,S.d,t.L,i.Ov,E.X$],styles:[".max-divider-width[_ngcontent-%COMP%]{max-width:1600px}"]})}return u})()},4646:(F,U,s)=>{s.d(U,{R:()=>i});var e=s(65879),_=s(64124),v=s(4675),r=s(89515);let i=(()=>{class L{constructor(){this.disableAutoSelect=!1,this.selectPlaceholder="SHARED_LIB.PERUN.COMPONENTS.FACILITY_SEARCH_SELECT.SELECT_FACILITY",this.facilitySelected=new e.vpe,this.nameFunction=S=>S.name}ngOnInit(){this.facilities=this.facilities.sort(_.aC)}static#t=this.\u0275fac=function(t){return new(t||L)};static#e=this.\u0275cmp=e.Xpm({type:L,selectors:[["perun-web-apps-facility-search-select"]],inputs:{facilities:"facilities",disableAutoSelect:"disableAutoSelect",selectPlaceholder:"selectPlaceholder"},outputs:{facilitySelected:"facilitySelected"},decls:4,vars:13,consts:[[3,"entities","disableAutoSelect","searchFunction","mainTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","entitySelected"]],template:function(t,E){1&t&&(e.TgZ(0,"perun-web-apps-entity-search-select",0),e.NdJ("entitySelected",function(f){return E.facilitySelected.emit(f)}),e.ALo(1,"translate"),e.ALo(2,"translate"),e.ALo(3,"translate"),e.qZA()),2&t&&e.Q6J("entities",E.facilities)("disableAutoSelect",E.disableAutoSelect)("searchFunction",E.nameFunction)("mainTextFunction",E.nameFunction)("selectPlaceholder",e.lcZ(1,7,E.selectPlaceholder))("findPlaceholder",e.lcZ(2,9,"SHARED_LIB.PERUN.COMPONENTS.FACILITY_SEARCH_SELECT.FIND_FACILITY"))("noEntriesText",e.lcZ(3,11,"SHARED_LIB.PERUN.COMPONENTS.FACILITY_SEARCH_SELECT.NO_FACILITY_FOUND"))},dependencies:[v.i,r.X$]})}return L})()},39518:(F,U,s)=>{s.d(U,{L:()=>f});var e=s(65879),_=s(96814),v=s(44112),r=s(30617),i=s(23680),L=s(92738),n=s(52269),S=s(89515),t=s(56881);const E=function(P){return[P]};function y(P,N){if(1&P&&(e.TgZ(0,"div",2)(1,"a",3),e.NdJ("auxclick",function(D){return D.preventDefault()}),e.ALo(2,"multiWordDataCy"),e.ALo(3,"translate"),e._UZ(4,"mat-icon",4),e._uU(5),e.ALo(6,"translate"),e.qZA()()),2&P){const T=N.$implicit;e.xp6(1),e.Gre("",T.style," item-itself"),e.Q6J("perunWebAppsMiddleClickRouterLink",e.VKq(14,E,T.url))("routerLink",T.url),e.uIk("data-cy",e.lcZ(2,8,e.lcZ(3,10,T.label))),e.xp6(3),e.Q6J("svgIcon",T.cssIcon),e.xp6(1),e.hij(" ",e.lcZ(6,12,T.label)," ")}}let f=(()=>{class P{static#t=this.\u0275fac=function(D){return new(D||P)};static#e=this.\u0275cmp=e.Xpm({type:P,selectors:[["perun-web-apps-menu-buttons-field"]],inputs:{items:"items"},decls:2,vars:1,consts:[[1,"items-container"],["class","item-itself-container","mat-ripple","",4,"ngFor","ngForOf"],["mat-ripple","",1,"item-itself-container"],[3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],[1,"item-pic","perun-icon",3,"svgIcon"]],template:function(D,u){1&D&&(e.TgZ(0,"div",0),e.YNc(1,y,7,16,"div",1),e.qZA()),2&D&&(e.xp6(1),e.Q6J("ngForOf",u.items))},dependencies:[_.sg,v.rH,r.Hw,i.wG,L.Y,n.Q,S.X$,t.R],styles:[".items-container[_ngcontent-%COMP%]{display:grid;grid-gap:0;grid-template-columns:repeat(auto-fill,minmax(208px,1fr));margin:0 -8px}@media (max-width: 768px){.items-container[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(148px,1fr))}}.item-pic[_ngcontent-%COMP%]{color:currentColor;transform:scale(3);height:74px;margin-bottom:22px}.item-itself-container[_ngcontent-%COMP%]{margin:8px;transition:.25s}.item-itself-container[_ngcontent-%COMP%]:hover{box-shadow:0 0 25px 5px #00000054;transform:scale(1.02);border-radius:var(--bs-border-radius)}.item-itself[_ngcontent-%COMP%]{text-align:center;min-height:186px;height:100%;padding:20px;display:flex;flex-direction:column;align-items:center;font-size:1.25rem;text-decoration:none;border-radius:var(--bs-border-radius)}.item-itself[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:120px;margin-bottom:10px}@media (max-width: 768px){.item-itself[_ngcontent-%COMP%]{min-height:150px;padding:10px}.item-itself[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:80px;margin-bottom:10px}}"]})}return P})()}}]);