"use strict";(self.webpackChunkadmin_gui=self.webpackChunkadmin_gui||[]).push([[338],{54668:(W,Z,t)=>{t.d(Z,{l:()=>p});var C=t(65412),c=t(61744),L=t(81591),n=t(10036),e=t(95017),D=t(64080),s=t(24006),i=t(94650),A=t(89383),d=t(36895),y=t(59549),S=t(284),b=t(97392),N=t(4859),U=t(51572),P=t(98380),T=t(64877);function v(o,_){if(1&o&&i._UZ(0,"app-users-list",14),2&o){const l=i.oxw(2);i.Q6J("displayedColumns",l.displayedColumns)("selection",l.selection)("tableId",l.tableId)("disableRouting",!0)("users",l.identities)}}function O(o,_){if(1&o&&(i.TgZ(0,"div"),i.YNc(1,v,1,5,"app-users-list",13),i.qZA()),2&o){const l=i.oxw();i.xp6(1),i.Q6J("ngIf",void 0!==l.identities&&l.identities.length>0)}}function g(o,_){1&o&&(i.TgZ(0,"perun-web-apps-alert",15),i._uU(1),i.ALo(2,"translate"),i.qZA()),2&o&&(i.xp6(1),i.hij(" ",i.lcZ(2,1,"DIALOGS.CONNECT_IDENTITY.SEARCH_HINT")," "))}function h(o,_){1&o&&(i.TgZ(0,"perun-web-apps-alert",16),i._uU(1),i.ALo(2,"translate"),i.qZA()),2&o&&(i.xp6(1),i.hij(" ",i.lcZ(2,1,"DIALOGS.CONNECT_IDENTITY.NO_IDENTITIES")," "))}function u(o,_){1&o&&i._UZ(0,"mat-spinner",17)}let p=(()=>{class o{constructor(l,I,f,R,B,x){this.dialogRef=l,this.data=I,this.userManager=f,this.storeService=R,this.notificator=B,this.translate=x,this.loading=!1,this.selection=new e.Ov(!1,[]),this.firstSearchDone=!1,this.displayedColumns=["select","id","user","name","email","logins","organization"],this.tableId=n.Iz}ngOnInit(){this.target=this.data.target,this.theme=this.data.theme,this.userId=this.data.userId,this.isService=this.data.isService,this.searchCtrl=new s.p4("",[s.kI.required,s.kI.pattern(".*[\\S]+.*")])}onAdd(){let l,I;this.loading=!0,this.isService?(l=this.selection.selected[0].id,I=this.userId):(l=this.userId,I=this.selection.selected[0].id),this.userManager.addSpecificUserOwner(l,I).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.CONNECT_IDENTITY.SUCCESS")),this.dialogRef.close(!0)},error:()=>this.loading=!1})}onCancel(){this.dialogRef.close(!1)}onSearchByString(){if(this.searchCtrl.invalid)return void this.searchCtrl.markAllAsTouched();this.loading=!0,this.firstSearchDone=!0;let l=[D.r.USER_DEF_ORGANIZATION,D.r.USER_DEF_PREFERRED_MAIL];l=l.concat(this.storeService.getLoginAttributeNames()),this.userManager.findRichUsersWithAttributes(this.searchCtrl.value,l).subscribe(I=>{this.identities=this.filterIdentities(I),this.loading=!1},()=>{this.loading=!1})}onKeyInput(l){"Enter"===l.key&&this.onSearchByString()}filterIdentities(l){return l.filter(this.isService?I=>!I.serviceUser:I=>I.serviceUser)}}return o.\u0275fac=function(l){return new(l||o)(i.Y36(C.so),i.Y36(C.WI),i.Y36(c.Fv),i.Y36(L.d6),i.Y36(L.V6),i.Y36(A.sK))},o.\u0275cmp=i.Xpm({type:o,selectors:[["app-connect-identity-dialog"]],decls:25,vars:25,consts:[[3,"keyup"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],[1,"mr-2","search-field","no-border-mat-input"],["matInput","","autocomplete","false",3,"placeholder","formControl"],["color","primary","mat-flat-button","",1,"mr-2","search-btn",3,"disabled","click"],[4,"ngIf"],["alert_type","info",4,"ngIf"],["alert_type","warn",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],[3,"displayedColumns","selection","tableId","disableRouting","users",4,"ngIf"],[3,"displayedColumns","selection","tableId","disableRouting","users"],["alert_type","info"],["alert_type","warn"],[1,"ml-auto","mr-auto"]],template:function(l,I){1&l&&(i.TgZ(0,"div",0),i.NdJ("keyup",function(R){return I.onKeyInput(R)}),i.TgZ(1,"h1",1),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"div",2)(5,"mat-form-field",3),i._UZ(6,"input",4),i.ALo(7,"translate"),i.TgZ(8,"mat-error"),i._uU(9),i.ALo(10,"translate"),i.qZA()(),i.TgZ(11,"button",5),i.NdJ("click",function(){return I.onSearchByString()}),i.TgZ(12,"mat-icon"),i._uU(13,"search"),i.qZA()(),i.YNc(14,O,2,1,"div",6),i.YNc(15,g,3,3,"perun-web-apps-alert",7),i.YNc(16,h,3,3,"perun-web-apps-alert",8),i.qZA(),i.YNc(17,u,1,0,"mat-spinner",9),i.TgZ(18,"div",10)(19,"button",11),i.NdJ("click",function(){return I.onCancel()}),i._uU(20),i.ALo(21,"translate"),i.qZA(),i.TgZ(22,"button",12),i.NdJ("click",function(){return I.onAdd()}),i._uU(23),i.ALo(24,"translate"),i.qZA()()()),2&l&&(i.Tol(I.theme),i.xp6(2),i.Oqu(i.lcZ(3,15,"DIALOGS.CONNECT_IDENTITY.TITLE_"+I.target)),i.xp6(4),i.s9C("placeholder",i.lcZ(7,17,"DIALOGS.CONNECT_IDENTITY.SEARCH")),i.Q6J("formControl",I.searchCtrl),i.xp6(3),i.hij(" ",i.lcZ(10,19,"DIALOGS.CONNECT_IDENTITY.EMPTY_SEARCH_MESSAGE")," "),i.xp6(2),i.Q6J("disabled",I.loading),i.xp6(3),i.Q6J("ngIf",!I.loading),i.xp6(1),i.Q6J("ngIf",!I.firstSearchDone),i.xp6(1),i.Q6J("ngIf",!I.loading&&I.firstSearchDone&&0===I.identities.length),i.xp6(1),i.Q6J("ngIf",I.loading),i.xp6(3),i.hij(" ",i.lcZ(21,21,"DIALOGS.CONNECT_IDENTITY.CANCEL")," "),i.xp6(2),i.Q6J("disabled",0===I.selection.selected.length),i.xp6(1),i.hij(" ",i.lcZ(24,23,"DIALOGS.CONNECT_IDENTITY.CONNECT")," "))},dependencies:[d.O5,y.TO,y.KE,S.Nt,s.Fj,s.JJ,s.oH,b.Hw,N.lW,C.uh,C.xY,C.H8,U.Ou,P.w,T.C,A.X$],styles:[".search-field[_ngcontent-%COMP%]{width:300px}.search-btn[_ngcontent-%COMP%]{width:50px}"]}),o})()},94814:(W,Z,t)=>{t.d(Z,{B:()=>T});var C=t(61744),c=t(65412),L=t(81591),n=t(30671),e=t(94650),D=t(89383),s=t(36895),i=t(4859),A=t(98380),d=t(31359);function y(v,O){1&v&&e._UZ(0,"th",13)}function S(v,O){if(1&v&&(e.TgZ(0,"td",14),e._uU(1),e.ALo(2,"userFullName"),e.qZA()),2&v){const g=O.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,g))}}function b(v,O){1&v&&e._UZ(0,"tr",15)}function N(v,O){1&v&&e._UZ(0,"tr",16)}function U(v,O){1&v&&(e.TgZ(0,"perun-web-apps-alert",17),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&v&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"DIALOGS.DISCONNECT_IDENTITY.WARNING_DISCONNECT_YOURSELF")," "))}function P(v,O){1&v&&(e.TgZ(0,"perun-web-apps-alert",17),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&v&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"DIALOGS.DISCONNECT_IDENTITY.WARNING_LAST_USER")," "))}let T=(()=>{class v{constructor(g,h,u,p,o,_){this.dialogRef=g,this.data=h,this.userManager=u,this.notificator=p,this.translate=o,this.store=_,this.displayedColumns=["name"]}ngOnInit(){let g;this.targetTitle=this.data.targetTitle,this.targetDescription=this.data.targetDescription,this.theme=this.data.theme,this.userId=Number(this.data.userId),this.dataSource=new n.by([this.data.specificUser]),this.isService=this.data.isService,this.isService?(g=this.userId,this.disconnectingSelf=this.dataSource.data[0].id===this.store.getPerunPrincipal().userId):(g=this.dataSource.data[0].id,this.disconnectingSelf=this.userId===this.store.getPerunPrincipal().userId),this.userManager.getUsersBySpecificUser(g).subscribe(h=>{this.disconnectingLastOwner=1===h.length})}onConfirm(){let g,h;this.isService?(g=this.dataSource.data[0].id,h=this.userId):(g=this.userId,h=this.dataSource.data[0].id),this.userManager.removeSpecificUserOwner(g,h).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.DISCONNECT_IDENTITY.SUCCESS")),this.dialogRef.close(!0)})}onCancel(){this.dialogRef.close(!1)}}return v.\u0275fac=function(g){return new(g||v)(e.Y36(c.so),e.Y36(c.WI),e.Y36(C.Fv),e.Y36(L.V6),e.Y36(D.sK),e.Y36(L.d6))},v.\u0275cmp=e.Xpm({type:v,selectors:[["app-disconnect-identity-dialog"]],decls:26,vars:23,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","warn","mat-flat-button","",1,"ml-2",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""],["alert_type","warn"]],template:function(g,h){1&g&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"div")(4,"div",1)(5,"p"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div",2),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"table",3),e.ynx(12,4),e.YNc(13,y,1,0,"th",5),e.YNc(14,S,3,3,"td",6),e.BQk(),e.YNc(15,b,1,0,"tr",7),e.YNc(16,N,1,0,"tr",8),e.qZA(),e.YNc(17,U,3,3,"perun-web-apps-alert",9),e.YNc(18,P,3,3,"perun-web-apps-alert",9),e.qZA(),e.TgZ(19,"div",10)(20,"button",11),e.NdJ("click",function(){return h.onCancel()}),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"button",12),e.NdJ("click",function(){return h.onConfirm()}),e._uU(24),e.ALo(25,"translate"),e.qZA()()()),2&g&&(e.xp6(1),e.Oqu(e.lcZ(2,13,"DIALOGS.DISCONNECT_IDENTITY.TITLE_"+h.targetTitle)),e.xp6(2),e.Tol(h.theme),e.xp6(3),e.Oqu(e.lcZ(7,15,"DIALOGS.DISCONNECT_IDENTITY.DESCRIPTION_"+h.targetDescription)),e.xp6(3),e.hij(" ",e.lcZ(10,17,"DIALOGS.DISCONNECT_IDENTITY.ASK")," "),e.xp6(2),e.Q6J("dataSource",h.dataSource),e.xp6(4),e.Q6J("matHeaderRowDef",h.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",h.displayedColumns),e.xp6(1),e.Q6J("ngIf",h.disconnectingSelf),e.xp6(1),e.Q6J("ngIf",h.disconnectingLastOwner),e.xp6(3),e.hij(" ",e.lcZ(22,19,"DIALOGS.DISCONNECT_IDENTITY.CANCEL")," "),e.xp6(3),e.hij(" ",e.lcZ(25,21,"DIALOGS.DISCONNECT_IDENTITY.REMOVE")," "))},dependencies:[s.O5,i.lW,n.BZ,n.fO,n.as,n.w1,n.Dz,n.nj,n.ge,n.ev,n.XQ,n.Gk,c.uh,c.xY,c.H8,A.w,D.X$,d.d]}),v})()},29862:(W,Z,t)=>{t.d(Z,{x:()=>P});var C=t(61744),c=t(65412),L=t(81591),n=t(24006),e=t(94650),D=t(89383),s=t(36895),i=t(59549),A=t(284),d=t(4859);function y(T,v){1&T&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&T&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LENGTH")))}function S(T,v){1&T&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&T&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LENGTH")))}function b(T,v){1&T&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&T&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_FIRST_NAME")))}function N(T,v){1&T&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&T&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LENGTH")))}function U(T,v){1&T&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&T&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LAST_NAME")))}let P=(()=>{class T{constructor(O,g,h,u,p){this.dialogRef=O,this.data=g,this.userService=h,this.notificator=u,this.translateService=p,this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.titleBefore=new n.p4(this.data.user.titleBefore,[n.kI.pattern(".*[\\S]+.*"),n.kI.maxLength(129)]),this.titleAfter=new n.p4(this.data.user.titleAfter,[n.kI.pattern(".*[\\S]+.*"),n.kI.maxLength(129)]),this.firstName=new n.p4(this.data.user.firstName,[n.kI.required,n.kI.pattern(".*[\\S]+.*"),n.kI.maxLength(129)]),this.middleName=new n.p4(this.data.user.middleName,[n.kI.pattern(".*[\\S]+.*"),n.kI.maxLength(129)]),this.lastName=new n.p4(this.data.user.lastName,[n.kI.required,n.kI.pattern(".*[\\S]+.*"),n.kI.maxLength(129)])}onCancel(){this.dialogRef.close(!1)}onSave(){this.loading=!0,this.data.user.titleBefore=this.titleBefore.value,this.data.user.titleAfter=this.titleAfter.value,this.data.user.firstName=this.firstName.value,this.data.user.middleName=this.middleName.value,this.data.user.lastName=this.lastName.value,this.userService.updateUser({user:this.data.user}).subscribe(()=>{this.translateService.get("DIALOGS.EDIT_USER.SUCCESS").subscribe(O=>{this.notificator.showSuccess(O),this.dialogRef.close(!0)})},()=>this.loading=!1)}}return T.\u0275fac=function(O){return new(O||T)(e.Y36(c.so),e.Y36(c.WI),e.Y36(C.Fv),e.Y36(L.V6),e.Y36(D.sK))},T.\u0275cmp=e.Xpm({type:T,selectors:[["app-edit-user-dialog"]],decls:32,vars:38,consts:[[1,"mat-dialog-title"],["mat-dialog-content","",1,"dialog-container"],["matInput","",3,"formControl","placeholder"],[4,"ngIf"],["matInput","","data-cy","user-first-name-input","required","",3,"placeholder","formControl"],["matInput","","required","",3,"formControl","placeholder"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","data-cy","user-save-button","mat-flat-button","",1,"ml-2",3,"disabled","click"]],template:function(O,g){1&O&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1)(5,"mat-form-field"),e._UZ(6,"input",2),e.ALo(7,"translate"),e.YNc(8,y,3,3,"mat-error",3),e.qZA(),e.TgZ(9,"mat-form-field"),e._UZ(10,"input",2),e.ALo(11,"translate"),e.YNc(12,S,3,3,"mat-error",3),e.qZA(),e.TgZ(13,"mat-form-field"),e._UZ(14,"input",4),e.ALo(15,"translate"),e.YNc(16,b,3,3,"mat-error",3),e.qZA(),e.TgZ(17,"mat-form-field"),e._UZ(18,"input",2),e.ALo(19,"translate"),e.YNc(20,N,3,3,"mat-error",3),e.qZA(),e.TgZ(21,"mat-form-field"),e._UZ(22,"input",5),e.ALo(23,"translate"),e.YNc(24,U,3,3,"mat-error",3),e.qZA()(),e.TgZ(25,"div",6)(26,"button",7),e.NdJ("click",function(){return g.onCancel()}),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"button",8),e.NdJ("click",function(){return g.onSave()}),e._uU(30),e.ALo(31,"translate"),e.qZA()()()),2&O&&(e.Tol(g.theme),e.xp6(2),e.Oqu(e.lcZ(3,22,"DIALOGS.EDIT_USER.DIALOG_TITLE")),e.xp6(4),e.s9C("placeholder",e.lcZ(7,24,"DIALOGS.EDIT_USER.TITLE_BEFORE")),e.Q6J("formControl",g.titleBefore),e.xp6(2),e.Q6J("ngIf",g.titleBefore.invalid),e.xp6(2),e.s9C("placeholder",e.lcZ(11,26,"DIALOGS.EDIT_USER.TITLE_AFTER")),e.Q6J("formControl",g.titleAfter),e.xp6(2),e.Q6J("ngIf",g.titleAfter.invalid),e.xp6(2),e.s9C("placeholder",e.lcZ(15,28,"DIALOGS.EDIT_USER.FIRST_NAME")),e.Q6J("formControl",g.firstName),e.xp6(2),e.Q6J("ngIf",g.firstName.invalid),e.xp6(2),e.s9C("placeholder",e.lcZ(19,30,"DIALOGS.EDIT_USER.MIDDLE_NAME")),e.Q6J("formControl",g.middleName),e.xp6(2),e.Q6J("ngIf",g.middleName.invalid),e.xp6(2),e.s9C("placeholder",e.lcZ(23,32,"DIALOGS.EDIT_USER.LAST_NAME")),e.Q6J("formControl",g.lastName),e.xp6(2),e.Q6J("ngIf",g.lastName.invalid),e.xp6(3),e.hij(" ",e.lcZ(28,34,"DIALOGS.EDIT_USER.CANCEL")," "),e.xp6(2),e.Q6J("disabled",g.loading||g.firstName.invalid||g.lastName.invalid||g.titleBefore.invalid||g.titleAfter.invalid||g.middleName.invalid),e.xp6(1),e.hij(" ",e.lcZ(31,36,"DIALOGS.EDIT_USER.SAVE")," "))},dependencies:[s.O5,i.TO,i.KE,A.Nt,n.Fj,n.JJ,n.Q7,n.oH,d.lW,c.xY,c.H8,D.X$]}),T})()},90979:(W,Z,t)=>{t.d(Z,{G:()=>D});var C=t(65412),c=t(81591),L=t(61744),n=t(94650),e=t(1415);let D=(()=>{class s{constructor(A,d,y,S){this.data=A,this.dialogRef=d,this.facilityService=y,this.notificator=S,this.loading=!1}update(A){this.loading=!0,this.facilityService.updateFacilityBan({banOnFacility:{id:this.data.ban.id,beanName:"BanOnFacility",facilityId:this.data.ban.facilityId,userId:this.data.ban.userId,description:A.description,validityTo:A.validity}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.UPDATE_BAN.SUCCESS"),this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}cancel(){this.dialogRef.close(!1)}}return s.\u0275fac=function(A){return new(A||s)(n.Y36(C.WI),n.Y36(C.so),n.Y36(L.IQ),n.Y36(c.V6))},s.\u0275cmp=n.Xpm({type:s,selectors:[["app-update-facility-ban-dialog"]],decls:1,vars:2,consts:[[3,"ban","theme","cancel","update"]],template:function(A,d){1&A&&(n.TgZ(0,"app-update-ban-dialog",0),n.NdJ("cancel",function(){return d.cancel()})("update",function(S){return d.update(S)}),n.qZA()),2&A&&n.Q6J("ban",d.data.ban)("theme","facility-theme")},dependencies:[e.l]}),s})()},98973:(W,Z,t)=>{t.d(Z,{u:()=>N});var C=t(81591),c=t(94650),L=t(94364),n=t(36895),e=t(3848),D=t(48323),s=t(12651),i=t(89383);function A(U,P){1&U&&(c._uU(0),c.ALo(1,"translate")),2&U&&c.hij(" ",c.lcZ(1,1,"ADMIN_USER.ENTITY")," ")}function d(U,P){if(1&U&&c._UZ(0,"app-one-entity-attribute-page",5),2&U){const T=c.oxw();c.Q6J("entityId",T.userId)("entity","user")}}function y(U,P){1&U&&(c._uU(0),c.ALo(1,"translate"),c.ALo(2,"translate")),2&U&&c.AsE(" ",c.lcZ(1,2,"ADMIN_USER.ENTITY")," - ",c.lcZ(2,4,"FACILITY_DETAIL.ENTITY")," ")}function S(U,P){if(1&U&&c._UZ(0,"app-two-entity-attribute-page",6),2&U){const T=c.oxw(2);c.Q6J("firstEntity","user")("firstEntityId",T.userId)("secondEntity","facility")}}function b(U,P){1&U&&(c.TgZ(0,"mat-tab"),c.YNc(1,y,3,6,"ng-template",2),c.YNc(2,S,1,3,"ng-template",3),c.qZA())}let N=(()=>{class U{constructor(T,v,O){this.route=T,this.store=v,this.authResolver=O}ngOnInit(){this.route.parent.params.subscribe(T=>{this.userId=Number(T.userId),this.userId||(this.userId=this.store.getPerunPrincipal().userId),this.userFacilityAttAuth=this.authResolver.isAuthorized("getAssignedFacilities_User_policy",[{id:this.userId,beanName:"User"}])})}}return U.\u0275fac=function(T){return new(T||U)(c.Y36(L.gz),c.Y36(C.d6),c.Y36(C.x4))},U.\u0275cmp=c.Xpm({type:U,selectors:[["app-user-settings-attributes"]],hostVars:2,hostBindings:function(T,v){2&T&&c.ekj("router-component",v.true)},decls:8,vars:4,consts:[[1,"page-subtitle"],[1,"mb-2"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(T,v){1&T&&(c.TgZ(0,"h1",0),c._uU(1),c.ALo(2,"translate"),c.qZA(),c.TgZ(3,"mat-tab-group")(4,"mat-tab",1),c.YNc(5,A,2,3,"ng-template",2),c.YNc(6,d,1,2,"ng-template",3),c.qZA(),c.YNc(7,b,3,0,"mat-tab",4),c.qZA()),2&T&&(c.xp6(1),c.Oqu(c.lcZ(2,2,"USER_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),c.xp6(6),c.Q6J("ngIf",v.userFacilityAttAuth))},dependencies:[n.O5,e.SP,e.uD,e.uX,e.Vc,D.Y,s.t,i.X$]}),U})()},51403:(W,Z,t)=>{t.d(Z,{Q:()=>_});var C=t(61744),c=t(81591),L=t(9244),n=t(32316),e=t(28943),D=t(90979),s=t(94650),i=t(65412),A=t(3848),d=t(51572),y=t(64901),S=t(73358),b=t(91880),N=t(89383);function U(l,I){1&l&&(s._uU(0),s.ALo(1,"translate")),2&l&&s.hij(" ",s.lcZ(1,1,"USER_DETAIL.BANS.VO")," ")}function P(l,I){if(1&l){const f=s.EpF();s.TgZ(0,"perun-web-apps-ban-on-entity-list",8),s.NdJ("updateBan",function(B){s.CHM(f);const x=s.oxw(2);return s.KtG(x.updateVoBan(B))}),s.qZA()}if(2&l){const f=s.oxw(2);s.Q6J("bans",f.voBans)("displayedColumns",f.displayedColumns)("filter",f.filter)("updatePolicy","updateBan_BanOnVo_policy")}}function T(l,I){if(1&l){const f=s.EpF();s.TgZ(0,"perun-web-apps-debounce-filter",5),s.NdJ("filter",function(B){s.CHM(f);const x=s.oxw();return s.KtG(x.filter=B)}),s.qZA(),s.TgZ(1,"div",6),s.YNc(2,P,1,4,"perun-web-apps-ban-on-entity-list",7),s.qZA()}if(2&l){const f=s.oxw(),R=s.MAs(14);s.Q6J("placeholder","USER_DETAIL.BANS.FILTER"),s.xp6(2),s.Q6J("perunWebAppsLoader",f.loading)("perunWebAppsLoaderIndicator",R)}}function v(l,I){1&l&&(s._uU(0),s.ALo(1,"translate")),2&l&&s.hij(" ",s.lcZ(1,1,"USER_DETAIL.BANS.RESOURCE")," ")}function O(l,I){if(1&l){const f=s.EpF();s.TgZ(0,"perun-web-apps-ban-on-entity-list",8),s.NdJ("updateBan",function(B){s.CHM(f);const x=s.oxw(2);return s.KtG(x.updateResourceBan(B))}),s.qZA()}if(2&l){const f=s.oxw(2);s.Q6J("bans",f.resourceBans)("displayedColumns",f.displayedColumns)("filter",f.filter)("updatePolicy","updateBan_BanOnResource_policy")}}function g(l,I){if(1&l){const f=s.EpF();s.TgZ(0,"perun-web-apps-debounce-filter",5),s.NdJ("filter",function(B){s.CHM(f);const x=s.oxw();return s.KtG(x.filter=B)}),s.qZA(),s.TgZ(1,"div",6),s.YNc(2,O,1,4,"perun-web-apps-ban-on-entity-list",7),s.qZA()}if(2&l){const f=s.oxw(),R=s.MAs(14);s.Q6J("placeholder","USER_DETAIL.BANS.FILTER"),s.xp6(2),s.Q6J("perunWebAppsLoader",f.loading)("perunWebAppsLoaderIndicator",R)}}function h(l,I){1&l&&(s._uU(0),s.ALo(1,"translate")),2&l&&s.hij(" ",s.lcZ(1,1,"USER_DETAIL.BANS.FACILITY")," ")}function u(l,I){if(1&l){const f=s.EpF();s.TgZ(0,"perun-web-apps-ban-on-entity-list",8),s.NdJ("updateBan",function(B){s.CHM(f);const x=s.oxw(2);return s.KtG(x.updateFacilityBan(B))}),s.qZA()}if(2&l){const f=s.oxw(2);s.Q6J("bans",f.facilityBans)("displayedColumns",f.displayedColumns)("filter",f.filter)("updatePolicy","updateBan_BanOnFacility_policy")}}function p(l,I){if(1&l){const f=s.EpF();s.TgZ(0,"perun-web-apps-debounce-filter",5),s.NdJ("filter",function(B){s.CHM(f);const x=s.oxw();return s.KtG(x.filter=B)}),s.qZA(),s.TgZ(1,"div",6),s.YNc(2,u,1,4,"perun-web-apps-ban-on-entity-list",7),s.qZA()}if(2&l){const f=s.oxw(),R=s.MAs(14);s.Q6J("placeholder","USER_DETAIL.BANS.FILTER"),s.xp6(2),s.Q6J("perunWebAppsLoader",f.loading)("perunWebAppsLoaderIndicator",R)}}function o(l,I){1&l&&(s.TgZ(0,"div",9),s._UZ(1,"mat-spinner"),s.qZA())}let _=(()=>{class l{constructor(f,R,B,x,z){this.voService=f,this.resourceService=R,this.facilityService=B,this.entityService=x,this.dialog=z,this.loading=!1,this.voBans=[],this.resourceBans=[],this.facilityBans=[],this.filter="",this.displayedColumns=["banId","targetId","targetName","description","expiration","edit"]}ngOnInit(){this.loading=!0,this.user=this.entityService.getEntity(),this.refreshVoBans()}refreshVoBans(){this.loading=!0,this.voService.getEnrichedVoBansForUser(this.user.id).subscribe({next:f=>{this.voBans=f,this.loading=!1},error:()=>this.loading=!1})}refreshResourceBans(){this.loading=!0,this.resourceService.getEnrichedBansForUser(this.user.id).subscribe({next:f=>{this.resourceBans=f,this.loading=!1},error:()=>this.loading=!1})}refreshFacilityBans(){this.loading=!0,this.facilityService.getEnricheFacilitydBansForUser(this.user.id).subscribe({next:f=>{this.facilityBans=f,this.loading=!1},error:()=>this.loading=!1})}updateVoBan(f){this.dialog.open(n.A,this.getConfig(f)).afterClosed().subscribe(B=>{B&&this.refreshVoBans()})}updateResourceBan(f){this.dialog.open(e.e,this.getConfig(f)).afterClosed().subscribe(B=>{B&&this.refreshResourceBans()})}updateFacilityBan(f){this.dialog.open(D.G,this.getConfig(f)).afterClosed().subscribe(B=>{B&&this.refreshFacilityBans()})}getConfig(f){const R=(0,L.kZ)();return R.width="600px",R.data={ban:f.ban,theme:"user-theme"},R}refresh(f){0===f.index?this.refreshVoBans():1===f.index?this.refreshResourceBans():this.refreshFacilityBans()}}return l.\u0275fac=function(f){return new(f||l)(s.Y36(C.YF),s.Y36(C.xk),s.Y36(C.IQ),s.Y36(c.fb),s.Y36(i.uw))},l.\u0275cmp=s.Xpm({type:l,selectors:[["app-user-bans"]],decls:15,vars:3,consts:[[1,"page-subtitle"],[1,"mt-3",3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["spinner",""],[1,"mt-2","search-field",3,"placeholder","filter"],[1,"position-relative"],[3,"bans","displayedColumns","filter","updatePolicy","updateBan",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"bans","displayedColumns","filter","updatePolicy","updateBan"],[1,"spinner-container"]],template:function(f,R){1&f&&(s.TgZ(0,"h1",0),s._uU(1),s.ALo(2,"translate"),s.qZA(),s.TgZ(3,"mat-tab-group",1),s.NdJ("selectedTabChange",function(x){return R.refresh(x)}),s.TgZ(4,"mat-tab"),s.YNc(5,U,2,3,"ng-template",2),s.YNc(6,T,3,3,"ng-template",3),s.qZA(),s.TgZ(7,"mat-tab"),s.YNc(8,v,2,3,"ng-template",2),s.YNc(9,g,3,3,"ng-template",3),s.qZA(),s.TgZ(10,"mat-tab"),s.YNc(11,h,2,3,"ng-template",2),s.YNc(12,p,3,3,"ng-template",3),s.qZA()(),s.YNc(13,o,2,0,"ng-template",null,4,s.W1O)),2&f&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"USER_DETAIL.BANS.TITLE"),"\n"))},dependencies:[A.SP,A.uD,A.uX,A.Vc,d.Ou,y.P,S.e,b.s,N.X$]}),l})()},85985:(W,Z,t)=>{t.d(Z,{u:()=>g});var C=t(81591),c=t(61744),L=t(10036),n=t(94650),e=t(94364),D=t(36895),s=t(51572),i=t(25788),A=t(96214),d=t(7434),y=t(89383);function S(h,u){1&h&&(n.TgZ(0,"h1",6),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&h&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.YOU_ARE_MEMBER"),"\n"))}function b(h,u){1&h&&(n.TgZ(0,"h1",6),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&h&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.USER_IS_MEMBER"),"\n"))}function N(h,u){1&h&&n._UZ(0,"mat-spinner",7)}const U=function(){return["id","vo","name","description"]};function P(h,u){if(1&h&&n._UZ(0,"perun-web-apps-groups-list",8),2&h){const p=n.oxw();n.Q6J("disableMembers",!1)("groups",p.membersGroups)("displayedColumns",n.DdM(5,U))("filter",p.memberFilterValue)("tableId",p.tableId)}}function T(h,u){1&h&&n._UZ(0,"mat-spinner",7)}function v(h,u){if(1&h&&n._UZ(0,"perun-web-apps-groups-list",8),2&h){const p=n.oxw(2);n.Q6J("disableMembers",!1)("groups",p.adminsGroups)("displayedColumns",n.DdM(5,U))("filter",p.adminFilterValue)("tableId",p.adminTableId)}}function O(h,u){if(1&h){const p=n.EpF();n.TgZ(0,"div",9)(1,"h1",6),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"perun-web-apps-refresh-button",1),n.NdJ("refresh",function(){n.CHM(p);const _=n.oxw();return n.KtG(_.refreshAdminTable())}),n.qZA(),n.TgZ(5,"perun-web-apps-immediate-filter",2),n.NdJ("filter",function(_){n.CHM(p);const l=n.oxw();return n.KtG(l.adminFilter(_))}),n.qZA(),n.YNc(6,T,1,0,"mat-spinner",3),n.YNc(7,v,1,6,"perun-web-apps-groups-list",4),n.qZA()}if(2&h){const p=n.oxw();n.xp6(2),n.hij(" ",n.lcZ(3,4,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.USER_IS_ADMIN")," "),n.xp6(3),n.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),n.xp6(1),n.Q6J("ngIf",p.adminRefresh),n.xp6(1),n.Q6J("ngIf",!p.adminRefresh)}}let g=(()=>{class h{constructor(p,o,_,l,I){this.usersService=p,this.memberService=o,this.groupService=_,this.store=l,this.route=I,this.memberFilterValue="",this.adminFilterValue="",this.vos=[],this.membersGroups=[],this.adminsGroups=[],this.tableId=L.KE,this.adminTableId=L.Sb}ngOnInit(){(this.showPrincipal=this.route.snapshot.data.showPrincipal)?this.userId=this.store.getPerunPrincipal().user.id:this.route.parent.params.subscribe(p=>this.userId=Number(p.userId)),this.refreshAdminTable(),this.refreshMemberTable()}memberFilter(p){this.memberFilterValue=p}adminFilter(p){this.adminFilterValue=p}refreshAdminTable(){this.adminRefresh=!0,this.usersService.getGroupsWhereUserIsAdmin(this.userId).subscribe(p=>{this.adminsGroups=p,this.adminRefresh=!1})}refreshMemberTable(){this.memberRefresh=!0,this.membersGroups=[],this.usersService.getVosWhereUserIsMember(this.userId).subscribe(p=>{this.vos=p;for(const o of this.vos)this.memberService.getMemberByUser(o.id,this.userId).subscribe(_=>{this.groupService.getMemberGroups(_.id).subscribe(l=>{this.membersGroups=this.membersGroups.concat(l),this.vos.indexOf(o)===this.vos.length-1&&(this.memberRefresh=!1)})});0===p.length&&(this.memberRefresh=!1)})}}return h.\u0275fac=function(p){return new(p||h)(n.Y36(c.Fv),n.Y36(c.uq),n.Y36(c.ff),n.Y36(C.d6),n.Y36(e.gz))},h.\u0275cmp=n.Xpm({type:h,selectors:[["app-user-groups"]],hostVars:2,hostBindings:function(p,o){2&p&&n.ekj("router-component",o.true)},decls:7,vars:6,consts:[["class","page-subtitle",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"disableMembers","groups","displayedColumns","filter","tableId",4,"ngIf"],["class","mt-5",4,"ngIf"],[1,"page-subtitle"],[1,"ml-auto","mr-auto"],[3,"disableMembers","groups","displayedColumns","filter","tableId"],[1,"mt-5"]],template:function(p,o){1&p&&(n.YNc(0,S,3,3,"h1",0),n.YNc(1,b,3,3,"h1",0),n.TgZ(2,"perun-web-apps-refresh-button",1),n.NdJ("refresh",function(){return o.refreshMemberTable()}),n.qZA(),n.TgZ(3,"perun-web-apps-immediate-filter",2),n.NdJ("filter",function(l){return o.memberFilter(l)}),n.qZA(),n.YNc(4,N,1,0,"mat-spinner",3),n.YNc(5,P,1,6,"perun-web-apps-groups-list",4),n.YNc(6,O,8,6,"div",5)),2&p&&(n.Q6J("ngIf",o.showPrincipal),n.xp6(1),n.Q6J("ngIf",!o.showPrincipal),n.xp6(2),n.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),n.xp6(1),n.Q6J("ngIf",o.memberRefresh),n.xp6(1),n.Q6J("ngIf",!o.memberRefresh),n.xp6(1),n.Q6J("ngIf",!o.showPrincipal))},dependencies:[D.O5,s.Ou,i.W,A.t,d.L,y.X$]}),h})()},74837:(W,Z,t)=>{t.d(Z,{j:()=>O});var C=t(61744),c=t(81591),L=t(10036),n=t(94650),e=t(94364),D=t(36895),s=t(51572),i=t(87831),A=t(96214),d=t(7434),y=t(89383);function S(g,h){1&g&&(n.TgZ(0,"h1",6),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&g&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"SHARED_LIB.PERUN.ORGANIZATIONS.YOU_ARE_MEMBER"),"\n"))}function b(g,h){1&g&&(n.TgZ(0,"h1",6),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&g&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"SHARED_LIB.PERUN.ORGANIZATIONS.USER_IS_MEMBER"),"\n"))}function N(g,h){1&g&&n._UZ(0,"mat-spinner",7)}function U(g,h){if(1&g&&n._UZ(0,"perun-web-apps-vos-list",8),2&g){const u=n.oxw();n.Q6J("displayedColumns",u.displayedColumns)("tableId",u.memberTableId)("filterValue",u.memberFilterValue)("vos",u.vosWhereIsMember)}}function P(g,h){1&g&&n._UZ(0,"mat-spinner",7)}function T(g,h){if(1&g&&n._UZ(0,"perun-web-apps-vos-list",8),2&g){const u=n.oxw(2);n.Q6J("displayedColumns",u.displayedColumns)("tableId",u.adminTableId)("filterValue",u.adminFilterValue)("vos",u.vosWhereIsAdmin)}}function v(g,h){if(1&g){const u=n.EpF();n.TgZ(0,"div",9)(1,"h1",6),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"perun-web-apps-refresh-button",1),n.NdJ("refresh",function(){n.CHM(u);const o=n.oxw();return n.KtG(o.refreshAdminTable())}),n.qZA(),n.TgZ(5,"perun-web-apps-immediate-filter",2),n.NdJ("filter",function(o){n.CHM(u);const _=n.oxw();return n.KtG(_.applyAdminFilter(o))}),n.qZA(),n.YNc(6,P,1,0,"mat-spinner",3),n.YNc(7,T,1,4,"perun-web-apps-vos-list",4),n.qZA()}if(2&g){const u=n.oxw();n.xp6(2),n.Oqu(n.lcZ(3,4,"SHARED_LIB.PERUN.ORGANIZATIONS.USER_IS_ADMIN")),n.xp6(3),n.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),n.xp6(1),n.Q6J("ngIf",u.adminRefresh),n.xp6(1),n.Q6J("ngIf",!u.adminRefresh)}}let O=(()=>{class g{constructor(u,p,o,_){this.usersService=u,this.authResolver=p,this.store=o,this.route=_,this.adminFilterValue="",this.memberFilterValue="",this.displayedColumns=["id","name"],this.adminTableId=L.YF,this.memberTableId=L.gc}ngOnInit(){(this.isMyProfile=this.route.snapshot.data.showPrincipal)?this.userId=this.store.getPerunPrincipal().user.id:this.route.parent.params.subscribe(u=>this.userId=Number(u.userId)),this.refreshAdminTable(),this.refreshMemberTable()}refreshMemberTable(){this.memberRefresh=!0,this.usersService.getVosWhereUserIsMember(this.userId).subscribe(u=>{this.vosWhereIsMember=u,this.memberRefresh=!1},()=>this.memberRefresh=!1)}refreshAdminTable(){this.adminRefresh=!0,this.usersService.getVosWhereUserIsAdmin(this.userId).subscribe(u=>{this.vosWhereIsAdmin=u,this.adminRefresh=!1},()=>this.adminRefresh=!1)}applyMemberFilter(u){this.memberFilterValue=u}applyAdminFilter(u){this.adminFilterValue=u}}return g.\u0275fac=function(u){return new(u||g)(n.Y36(C.Fv),n.Y36(c.x4),n.Y36(c.d6),n.Y36(e.gz))},g.\u0275cmp=n.Xpm({type:g,selectors:[["app-user-organizations"]],hostVars:2,hostBindings:function(u,p){2&u&&n.ekj("router-component",p.true)},decls:7,vars:6,consts:[["class","page-subtitle",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],["class","mr-auto ml-auto",4,"ngIf"],[3,"displayedColumns","tableId","filterValue","vos",4,"ngIf"],["class","mt-5",4,"ngIf"],[1,"page-subtitle"],[1,"mr-auto","ml-auto"],[3,"displayedColumns","tableId","filterValue","vos"],[1,"mt-5"]],template:function(u,p){1&u&&(n.YNc(0,S,3,3,"h1",0),n.YNc(1,b,3,3,"h1",0),n.TgZ(2,"perun-web-apps-refresh-button",1),n.NdJ("refresh",function(){return p.refreshMemberTable()}),n.qZA(),n.TgZ(3,"perun-web-apps-immediate-filter",2),n.NdJ("filter",function(_){return p.applyMemberFilter(_)}),n.qZA(),n.YNc(4,N,1,0,"mat-spinner",3),n.YNc(5,U,1,4,"perun-web-apps-vos-list",4),n.YNc(6,v,8,6,"div",5)),2&u&&(n.Q6J("ngIf",p.isMyProfile),n.xp6(1),n.Q6J("ngIf",!p.isMyProfile),n.xp6(2),n.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),n.xp6(1),n.Q6J("ngIf",p.memberRefresh),n.xp6(1),n.Q6J("ngIf",!p.memberRefresh),n.xp6(1),n.Q6J("ngIf",!p.isMyProfile))},dependencies:[D.O5,s.Ou,i.Z,A.t,d.L,y.X$]}),g})()},17755:(W,Z,t)=>{t.d(Z,{Z:()=>u});var C=t(61744),c=t(30671),L=t(81591),n=t(64080),e=t(9244),D=t(21029),s=t(94650),i=t(94364),A=t(65412),d=t(36895),y=t(97392),S=t(4859),b=t(73546),N=t(71135),U=t(89383);function P(p,o){1&p&&s._UZ(0,"th",12)}function T(p,o){if(1&p&&(s.TgZ(0,"td",13),s._uU(1),s.qZA()),2&p){const _=o.$implicit;s.xp6(1),s.hij(" ",_.displayName,": ")}}function v(p,o){1&p&&s._UZ(0,"th",12)}function O(p,o){if(1&p){const _=s.EpF();s.TgZ(0,"td",14),s._uU(1),s.TgZ(2,"button",15),s.NdJ("click",function(){s.CHM(_);const I=s.oxw(2);return s.KtG(I.changeEmail())}),s.TgZ(3,"mat-icon"),s._uU(4,"edit"),s.qZA()()()}if(2&p){const _=o.$implicit;s.xp6(1),s.hij(" ",_.value," ")}}function g(p,o){1&p&&s._UZ(0,"tr",16)}function h(p,o){if(1&p&&(s.TgZ(0,"div",2)(1,"mat-card",3)(2,"mat-card-header")(3,"mat-card-title")(4,"h1",4),s._uU(5),s.ALo(6,"translate"),s.qZA()()(),s.TgZ(7,"mat-card-content")(8,"table",5),s.ynx(9,6),s.YNc(10,P,1,0,"th",7),s.YNc(11,T,2,1,"td",8),s.BQk(),s.ynx(12,9),s.YNc(13,v,1,0,"th",7),s.YNc(14,O,5,1,"td",10),s.BQk(),s.YNc(15,g,1,0,"tr",11),s.qZA()()()()),2&p){const _=s.oxw();s.xp6(5),s.Oqu(s.lcZ(6,3,"USER_DETAIL.OVERVIEW.GENERAL_SETTINGS")),s.xp6(3),s.Q6J("dataSource",_.mailDataSource),s.xp6(7),s.Q6J("matRowDefColumns",_.displayedColumns)}}let u=(()=>{class p{constructor(_,l,I,f,R){this.userService=_,this.attributeService=l,this.storeService=I,this.route=f,this.dialog=R,this.navItems=[],this.isServiceUser=!1,this.displayedColumns=["name","value"],this.inMyProfile=!1}ngOnInit(){this.route.params.subscribe(_=>{_.userId?this.userService.getUserById(Number(_.userId)).subscribe(l=>{this.user=l,this.isServiceUser=l.serviceUser,this.initNavItems(`/admin/users/${this.user.id}`)}):(this.inMyProfile=!0,this.userID=this.storeService.getPerunPrincipal().user.id,this.attributeService.getUserAttributeByName(this.userID,n.r.USER_DEF_PREFERRED_MAIL).subscribe(l=>{this.preferredMail=l,this.handleMailNotDefined(),this.mailDataSource=new c.by([this.preferredMail]),this.initNavItems("/myProfile")}))})}changeEmail(){const _=(0,e.kZ)();_.width="350px",_.data={userId:this.userID},this.dialog.open(D.gr,_).afterClosed().subscribe(I=>{I&&this.attributeService.getUserAttributeByName(this.userID,n.r.USER_DEF_PREFERRED_MAIL).subscribe(f=>{this.preferredMail=f,this.handleMailNotDefined(),this.mailDataSource=new c.by([this.preferredMail])})})}handleMailNotDefined(){null==this.preferredMail&&(this.preferredMail={id:-1,beanName:"Attribute",displayName:(0,e.Cz)(n.r.USER_DEF_PREFERRED_MAIL.split(":").pop()),value:new Object("-")})}initNavItems(_){this.navItems=[{cssIcon:"perun-vo",url:`${_}/organizations`,label:"MENU_ITEMS.ADMIN.ORGANIZATIONS",style:"user-btn"},{cssIcon:"perun-group",url:`${_}/groups`,label:"MENU_ITEMS.ADMIN.GROUPS",style:"user-btn"}],window.location.pathname.startsWith("/admin")&&this.navItems.push({cssIcon:"perun-user",url:`${_}/accounts`,label:"MENU_ITEMS.USER.ACCOUNTS",style:"user-btn"},{cssIcon:"perun-identity",url:`${_}/identities`,label:"MENU_ITEMS.USER.IDENTITIES",style:"user-btn"},{cssIcon:"perun-facility-white",url:`${_}/facilities`,label:"MENU_ITEMS.USER.FACILITIES",style:"user-btn"},{cssIcon:"perun-resource",url:`${_}/resources`,label:"MENU_ITEMS.USER.RESOURCES",style:"user-btn"}),this.navItems.push({cssIcon:"perun-attributes",url:`${_}/attributes`,label:"MENU_ITEMS.USER.ATTRIBUTES",style:"user-btn"}),this.navItems.push({cssIcon:"perun-roles",url:`${_}/roles`,label:"MENU_ITEMS.USER.ROLES",style:"user-btn"}),this.navItems.push(this.isServiceUser?{cssIcon:"perun-manager",url:`${_}/associated-users`,label:"MENU_ITEMS.USER.ASSOCIATED_USERS",style:"user-btn"}:{cssIcon:"perun-service-identity",url:`${_}/service-identities`,label:"MENU_ITEMS.USER.SERVICE_IDENTITIES",style:"user-btn"}),this.navItems.push({cssIcon:"perun-ban",url:"bans",label:"MENU_ITEMS.USER.BANS",style:"user-btn"}),window.location.pathname.startsWith("/admin")||this.navItems.push({cssIcon:"perun-settings2",url:`${_}/settings`,label:"MENU_ITEMS.ADMIN.SETTINGS",style:"user-btn"})}}return p.\u0275fac=function(_){return new(_||p)(s.Y36(C.Fv),s.Y36(C.H8),s.Y36(L.d6),s.Y36(i.gz),s.Y36(A.uw))},p.\u0275cmp=s.Xpm({type:p,selectors:[["app-user-overview"]],hostVars:2,hostBindings:function(_,l){2&_&&s.ekj("router-component",l.true)},decls:2,vars:3,consts:[["class","align-cards",4,"ngIf"],[3,"items","size"],[1,"align-cards"],[1,"mat-elevation-z3"],[1,"page-subtitle"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["class","font-weight-bold","mat-cell","",4,"matCellDef"],["matColumnDef","value"],["mat-cell","",4,"matCellDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"font-weight-bold"],["mat-cell",""],["mat-icon-button","",1,"ml-3",3,"click"],["mat-row",""]],template:function(_,l){1&_&&(s.YNc(0,h,16,5,"div",0),s._UZ(1,"perun-web-apps-menu-buttons-field",1)),2&_&&(s.Q6J("ngIf",l.inMyProfile),s.xp6(1),s.Q6J("items",l.navItems)("size","small"))},dependencies:[d.O5,y.Hw,S.lW,c.BZ,c.fO,c.w1,c.Dz,c.nj,c.ge,c.ev,c.Gk,b.a8,b.dk,b.dn,b.n5,N.L,U.X$],styles:[".align-cards[_ngcontent-%COMP%]{margin:1rem;display:inline-block;vertical-align:top}"]}),p})()},6097:(W,Z,t)=>{t.d(Z,{t:()=>A});var C=t(61744),c=t(81591),L=t(39646),n=t(48382),e=t(86099),D=t(94650),s=t(94364),i=t(90820);let A=(()=>{class d{constructor(S,b,N,U){this.authzResolverService=S,this.route=b,this.store=N,this.roleService=U,this.roles=new Map,this.showDescription=!0}ngOnInit(){this.outerLoading=!0,this.route.parent.params.subscribe(S=>{S.userId?(this.entityType="USER",this.userId=Number(S.userId)):(this.userId=this.store.getPerunPrincipal().userId,this.entityType="SELF"),this.getData()})}getData(){this.outerLoading=!0,this.roles.clear(),(0,L.of)(this.entityType).pipe((0,e.z)(S=>(0,n.s)(()=>"SELF"===S,(0,L.of)(this.store.getPerunPrincipal().roles),this.authzResolverService.getUserRoles(this.userId)))).subscribe(S=>{const b=Object.keys(S).map(N=>N.toUpperCase());this.roles=this.roleService.prepareRoles(S,b),this.outerLoading=!1})}}return d.\u0275fac=function(S){return new(S||d)(D.Y36(C.Ct),D.Y36(s.gz),D.Y36(c.d6),D.Y36(c.Nj))},d.\u0275cmp=D.Xpm({type:d,selectors:[["app-user-roles"]],hostVars:2,hostBindings:function(S,b){2&S&&D.ekj("router-component",b.true)},decls:1,vars:5,consts:[[3,"outerLoading","roles","entityId","showDescription","entityType","reload","startLoading"]],template:function(S,b){1&S&&(D.TgZ(0,"app-perun-web-apps-roles-page",0),D.NdJ("reload",function(){return b.getData()})("startLoading",function(){return b.outerLoading=!0}),D.qZA()),2&S&&D.Q6J("outerLoading",b.outerLoading)("roles",b.roles)("entityId",b.userId)("showDescription",b.showDescription)("entityType",b.entityType)},dependencies:[i._]}),d})()},46597:(W,Z,t)=>{t.d(Z,{d:()=>h});var C=t(10036),c=t(61744),L=t(95017),n=t(9244),e=t(54668),D=t(94814),s=t(81591),i=t(54004),A=t(63900),d=t(94650),y=t(65412),S=t(94364),b=t(36895),N=t(4859),U=t(51572),P=t(96214),T=t(64877),v=t(89383);function O(u,p){if(1&u&&(d._UZ(0,"app-users-list",6),d.ALo(1,"translate")),2&u){const o=d.oxw();d.Q6J("noUsersFoundLabel",d.lcZ(1,6,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.NO_ASSOCIATED_USERS"))("disableRouting",o.disableRouting)("displayedColumns",o.displayedColumns)("selection",o.selection)("tableId",o.tableId)("users",o.associatedUsers)}}function g(u,p){1&u&&d._UZ(0,"mat-spinner",7)}let h=(()=>{class u{constructor(o,_,l,I,f){this.dialog=o,this.router=_,this.authResolver=l,this.userManager=I,this.entityStorageService=f,this.loading=!1,this.selection=new L.Ov(!1,[]),this.associatedUsers=[],this.tableId=C.It,this.displayedColumns=["select","id","user","name","email","logins","organization"]}ngOnInit(){this.loading=!0,this.user=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.userManager.getUsersBySpecificUser(this.user.id).pipe((0,i.U)(o=>o.map(_=>_.id)),(0,A.w)(o=>this.userManager.getRichUsersWithAttributesByIds(o))).subscribe(o=>{this.associatedUsers=o,this.selection.clear(),this.setAuth(),this.loading=!1})}setAuth(){this.addAuth=this.authResolver.isAuthorized("addSpecificUserOwner_User_User_policy",[this.user]),this.removeAuth=this.authResolver.isAuthorized("removeSpecificUserOwner_User_User_policy",[this.user]),this.disableRouting=!this.authResolver.isPerunAdminOrObserver()}onAdd(){const o=(0,n.kZ)();o.width="1250px",o.data={userId:this.user.id,theme:"user-theme",isService:!0,target:"USER"},this.dialog.open(e.l,o).afterClosed().subscribe(l=>{l&&this.refreshTable()})}onRemove(){const o=(0,n.kZ)();o.width="650px",o.data={identities:this.selection.selected,userId:this.user.id,specificUser:this.selection.selected[0],isService:!0,theme:"user-theme",targetTitle:"USER",targetDescription:"SERVICE"},this.dialog.open(D.B,o).afterClosed().subscribe(l=>{l&&(this.authResolver.isAuthorized("getUsersBySpecificUser_User_policy",[this.user])?this.refreshTable():this.router.navigate(["/myProfile"],{queryParamsHandling:"preserve"}))})}}return u.\u0275fac=function(o){return new(o||u)(d.Y36(y.uw),d.Y36(S.F0),d.Y36(s.x4),d.Y36(c.Fv),d.Y36(s.fb))},u.\u0275cmp=d.Xpm({type:u,selectors:[["app-user-settings-associated-users"]],decls:13,vars:12,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"mr-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[3,"noUsersFoundLabel","disableRouting","displayedColumns","selection","tableId","users",4,"ngIf"],["class","mr-auto ml-auto",4,"ngIf"],[3,"noUsersFoundLabel","disableRouting","displayedColumns","selection","tableId","users"],[1,"mr-auto","ml-auto"]],template:function(o,_){1&o&&(d.TgZ(0,"div")(1,"h1",0),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"perun-web-apps-refresh-button",1),d.NdJ("refresh",function(){return _.refreshTable()}),d.qZA(),d.TgZ(5,"button",2),d.NdJ("click",function(){return _.onAdd()}),d._uU(6),d.ALo(7,"translate"),d.qZA(),d.TgZ(8,"button",3),d.NdJ("click",function(){return _.onRemove()}),d._uU(9),d.ALo(10,"translate"),d.qZA(),d.YNc(11,O,2,8,"app-users-list",4),d.qZA(),d.YNc(12,g,1,0,"mat-spinner",5)),2&o&&(d.xp6(2),d.Oqu(d.lcZ(3,6,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.TITLE")),d.xp6(4),d.hij(" ",d.lcZ(7,8,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.ADD")," "),d.xp6(2),d.Q6J("disabled",0===_.selection.selected.length),d.xp6(1),d.hij(" ",d.lcZ(10,10,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.REMOVE")," "),d.xp6(2),d.Q6J("ngIf",!_.loading),d.xp6(1),d.Q6J("ngIf",_.loading))},dependencies:[b.O5,N.lW,U.Ou,P.t,T.C,v.X$]}),u})()},97453:(W,Z,t)=>{t.d(Z,{R:()=>h});var C=t(95017),c=t(61744),L=t(10036),n=t(9244),e=t(54668),D=t(94814),s=t(81591),i=t(94650),A=t(94364),d=t(65412),y=t(36895),S=t(4859),b=t(51572),N=t(96214),U=t(64877),P=t(89383);function T(u,p){if(1&u){const o=i.EpF();i.TgZ(0,"button",6),i.NdJ("click",function(){i.CHM(o);const l=i.oxw();return i.KtG(l.onAdd())}),i._uU(1),i.ALo(2,"translate"),i.qZA()}2&u&&(i.xp6(1),i.hij(" ",i.lcZ(2,1,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.CREATE"),"\n"))}function v(u,p){if(1&u){const o=i.EpF();i.TgZ(0,"button",7),i.NdJ("click",function(){i.CHM(o);const l=i.oxw();return i.KtG(l.onRemove())}),i._uU(1),i.ALo(2,"translate"),i.qZA()}if(2&u){const o=i.oxw();i.Q6J("disabled",0===o.selection.selected.length),i.xp6(1),i.hij(" ",i.lcZ(2,2,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.DELETE"),"\n")}}function O(u,p){1&u&&i._UZ(0,"mat-spinner",8)}function g(u,p){if(1&u&&(i._UZ(0,"app-users-list",9),i.ALo(1,"translate")),2&u){const o=i.oxw();i.Q6J("noUsersFoundLabel",i.lcZ(1,6,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.NO_IDENTITIES"))("displayedColumns",o.displayedColumns)("selection",o.selection)("tableId",o.tableId)("routeToAdmin",o.routeToAdminSection)("users",o.identities)}}let h=(()=>{class u{constructor(o,_,l,I,f,R){this.route=o,this.dialog=_,this.router=l,this.userManager=I,this.authResolver=f,this.store=R,this.loading=!1,this.selection=new C.Ov(!1,[]),this.identities=[],this.tableId=L.Iz,this.displayedColumns=["select","id","user","name"],this.routeToAdminSection=!0,this.targetTitle="SERVICE",this.targetDescription="SERVICE"}ngOnDestroy(){this.subscription.unsubscribe()}ngOnInit(){this.loading=!0,this.subscription=this.route.parent.params.subscribe(o=>{this.userId=Number(o.userId),this.userId||(this.targetTitle="SERVICE",this.targetDescription="SELF",this.userId=this.store.getPerunPrincipal().userId,this.routeToAdminSection=!1),this.setAuthRights(),this.refreshTable()})}refreshTable(){this.loading=!0,this.userManager.getSpecificUsersByUser(this.userId).subscribe(o=>{this.identities=o,this.selection.clear(),this.loading=!1})}setAuthRights(){this.addIdentity=this.authResolver.isPerunAdmin(),this.removeIdentity=this.authResolver.isAuthorized("removeSpecificUserOwner_User_User_policy",[{id:this.userId,beanName:"User"}])}onAdd(){const o=(0,n.kZ)();o.width="1250px",o.data={userId:this.userId,theme:"user-theme",isService:!1,target:this.targetTitle},this.dialog.open(e.l,o).afterClosed().subscribe(l=>{l&&this.refreshTable()})}onRemove(){const o=(0,n.kZ)();o.width="650px",o.data={identities:this.selection.selected,userId:this.userId,specificUser:this.selection.selected[0],theme:"user-theme",targetTitle:this.targetTitle,targetDescription:this.targetDescription},this.dialog.open(D.B,o).afterClosed().subscribe(l=>{l&&this.refreshTable()})}}return u.\u0275fac=function(o){return new(o||u)(i.Y36(A.gz),i.Y36(d.uw),i.Y36(A.F0),i.Y36(c.Fv),i.Y36(s.x4),i.Y36(s.d6))},u.\u0275cmp=i.Xpm({type:u,selectors:[["app-user-settings-service-identities"]],decls:8,vars:7,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","class","mr-2 action-button","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","class","mr-2","mat-flat-button","",3,"disabled","click",4,"ngIf"],["class","mr-auto ml-auto",4,"ngIf"],[3,"noUsersFoundLabel","displayedColumns","selection","tableId","routeToAdmin","users",4,"ngIf"],["color","accent","mat-flat-button","",1,"mr-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],[3,"noUsersFoundLabel","displayedColumns","selection","tableId","routeToAdmin","users"]],template:function(o,_){1&o&&(i.TgZ(0,"h1",0),i._uU(1),i.ALo(2,"translate"),i.qZA(),i.TgZ(3,"perun-web-apps-refresh-button",1),i.NdJ("refresh",function(){return _.refreshTable()}),i.qZA(),i.YNc(4,T,3,3,"button",2),i.YNc(5,v,3,4,"button",3),i.YNc(6,O,1,0,"mat-spinner",4),i.YNc(7,g,2,8,"app-users-list",5)),2&o&&(i.xp6(1),i.Oqu(i.lcZ(2,5,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.TITLE")),i.xp6(3),i.Q6J("ngIf",_.addIdentity),i.xp6(1),i.Q6J("ngIf",_.removeIdentity),i.xp6(1),i.Q6J("ngIf",_.loading),i.xp6(1),i.Q6J("ngIf",!_.loading))},dependencies:[y.O5,S.lW,b.Ou,N.t,U.C,P.X$]}),u})()},38338:(W,Z,t)=>{t.r(Z),t.d(Z,{UsersModule:()=>_t});var C=t(36895),c=t(94364),L=t(74837),n=t(85985),e=t(94650),D=t(61283);let s=(()=>{class r{}return r.\u0275fac=function(a){return new(a||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-settings"]],hostVars:2,hostBindings:function(a,m){2&a&&e.ekj("router-component",m.true)},decls:1,vars:0,template:function(a,m){1&a&&e._UZ(0,"app-animated-router-outlet")},dependencies:[D.A]}),r})();var i=t(61744),A=t(51572),d=t(71135);function y(r,E){1&r&&e._UZ(0,"mat-spinner",2)}function S(r,E){if(1&r&&(e.TgZ(0,"div"),e._UZ(1,"perun-web-apps-menu-buttons-field",3),e.qZA()),2&r){const a=e.oxw();e.xp6(1),e.Q6J("items",a.navItems)("size","small")}}let b=(()=>{class r{constructor(a,m){this.route=a,this.userManager=m,this.navItems=[],this.loading=!1}ngOnInit(){window.location.pathname.startsWith("/admin")?(this.loading=!0,this.route.parent.parent.params.subscribe(a=>{const m=Number(a.userId);this.userManager.getUserById(m).subscribe(M=>{this.isServiceUser=M.serviceUser,this.initNavItems(),this.loading=!1},()=>this.loading=!1)})):this.initNavItems()}initNavItems(){this.navItems=[],window.location.pathname.startsWith("/admin")||this.navItems.push({cssIcon:"perun-settings2",url:"/myProfile/settings/passwordReset",label:"MENU_ITEMS.USER.PASSWORD_RESET",style:"user-btn"},{cssIcon:"perun-settings1",url:"/myProfile/settings/guiConfig",label:"MENU_ITEMS.USER.GUI_CONFIG",style:"user-btn"})}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(c.gz),e.Y36(i.Fv))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-settings-overview"]],hostVars:2,hostBindings:function(a,m){2&a&&e.ekj("router-component",m.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(a,m){1&a&&(e.YNc(0,y,1,0,"mat-spinner",0),e.YNc(1,S,2,2,"div",1)),2&a&&(e.Q6J("ngIf",m.loading),e.xp6(1),e.Q6J("ngIf",!m.loading))},dependencies:[C.O5,A.Ou,d.L]}),r})();var N=t(98973),U=t(37433),P=t(9244),T=t(6335),v=t(3238),O=t(59549),g=t(84385),h=t(89383);function u(r,E){if(1&r&&(e.TgZ(0,"mat-option",5),e._uU(1),e.qZA()),2&r){const a=E.$implicit;e.Q6J("value",a),e.xp6(1),e.hij(" ",a," ")}}let p=(()=>{class r{constructor(a){this.guiConfigService=a,this.tablePageSizeOptions=P.f7}ngOnInit(){this.preferredTablePageSize=this.guiConfigService.getNumber(T.Rc)}updatePreferredTablePageSize(){this.guiConfigService.setNumber(T.Rc,this.preferredTablePageSize)}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(T.Ng))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-settings-app-configuration"]],decls:10,vars:8,consts:[[1,"page-subtitle"],[1,"col-12","col-lg-6","p-0"],[1,"w-100"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(a,m){1&a&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"div",1)(4,"mat-form-field",2)(5,"mat-label"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"mat-select",3),e.NdJ("valueChange",function(Y){return m.preferredTablePageSize=Y})("valueChange",function(){return m.updatePreferredTablePageSize()}),e.YNc(9,u,2,2,"mat-option",4),e.qZA()()()),2&a&&(e.xp6(1),e.Oqu(e.lcZ(2,4,"USER_DETAIL.SETTINGS.GUI_CONFIG.TITLE")),e.xp6(5),e.Oqu(e.lcZ(7,6,"USER_DETAIL.SETTINGS.GUI_CONFIG.PREF_TABLE_PAGE_SIZE")),e.xp6(2),e.Q6J("value",m.preferredTablePageSize),e.xp6(1),e.Q6J("ngForOf",m.tablePageSizeOptions))},dependencies:[C.sg,v.ey,O.KE,O.hX,g.gD,h.X$]}),r})();var o=t(17755),_=t(81591),l=t(77968),I=t(97392),f=t(10266),R=t(4235),B=t(34198),x=t(55660),z=t(31359);const $=function(){return{color:"black"}},V=function(){return["/myProfile"]};function k(r,E){if(1&r&&(e.TgZ(0,"div",1),e._UZ(1,"perun-web-apps-back-button"),e.TgZ(2,"div",2),e._UZ(3,"mat-icon",3),e.ALo(4,"translate"),e.TgZ(5,"div",4)(6,"div",5)(7,"a",6),e.NdJ("auxclick",function(m){return m.preventDefault()}),e._uU(8),e.ALo(9,"userFullName"),e.qZA(),e.TgZ(10,"span",7),e._uU(11),e.qZA()(),e.TgZ(12,"span",8),e._uU(13),e.ALo(14,"translate"),e.ALo(15,"translate"),e.qZA()()(),e._UZ(16,"app-animated-router-outlet"),e.qZA()),2&r){const a=e.oxw();e.xp6(3),e.s9C("matTooltip",e.lcZ(4,9,"MENU_ITEMS.USER.ENTITY")),e.Q6J("ngStyle",e.DdM(17,$)),e.xp6(4),e.Q6J("perunWebAppsMiddleClickRouterLink",e.DdM(18,V))("routerLink",e.DdM(19,V)),e.xp6(1),e.hij(" ",e.lcZ(9,11,a.user)," "),e.xp6(3),e.hij(" \xa0#",a.user.id," "),e.xp6(2),e.lnq(" ",e.lcZ(14,13,"MENU_ITEMS.USER.ENTITY"),", ",e.lcZ(15,15,"MENU_ITEMS.USER.USER_TYPE"),": ",a.getUserType()," ")}}let q=(()=>{class r{constructor(a,m,M,Y){this.sideMenuService=a,this.store=m,this.entityStore=M,this.router=Y}ngOnInit(){this.path=this.router.url,this.router.events.subscribe(()=>{this.path=this.router.url}),this.principal=this.store.getPerunPrincipal(),this.user=this.principal.user,this.entityStore.setEntity(this.user),this.sideMenuService.setUserItems([])}getUserType(){return this.user.serviceUser?"Service":"Person"}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(l.D),e.Y36(_.d6),e.Y36(_.fb),e.Y36(c.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-profile"]],decls:1,vars:1,consts:[["class","container-fluid pl-xl-5 pr-xl-5 user-theme",4,"ngIf"],[1,"container-fluid","pl-xl-5","pr-xl-5","user-theme"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-user-dark",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"user-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],[1,"text-muted"],[1,"mt-1","entity-info"]],template:function(a,m){1&a&&e.YNc(0,k,17,20,"div",0),2&a&&e.Q6J("ngIf",void 0!==m.user)},dependencies:[C.O5,C.PC,c.yS,I.Hw,f.gM,R.W,B.Y,x.Q,D.A,h.X$,z.d]}),r})();var ee=t(6097),te=t(97453),ne=t(69024),se=t(29862),G=t(65412),F=t(4859);function ie(r,E){1&r&&e._UZ(0,"mat-spinner",11)}function ae(r,E){if(1&r){const a=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(a);const M=e.oxw(2);return e.KtG(M.editUser())}),e.TgZ(1,"mat-icon"),e._uU(2,"edit"),e.qZA()()}}const re=function(){return{color:"black"}},H=function(r){return["/myProfile/service-identities",r]};function oe(r,E){if(1&r&&(e.TgZ(0,"div",1),e._UZ(1,"perun-web-apps-back-button"),e.YNc(2,ie,1,0,"mat-spinner",2),e.TgZ(3,"div",3),e._UZ(4,"mat-icon",4),e.ALo(5,"translate"),e.TgZ(6,"div",5)(7,"div",6)(8,"a",7),e.NdJ("auxclick",function(m){return m.preventDefault()}),e._uU(9),e.ALo(10,"userFullName"),e.qZA(),e.TgZ(11,"span",8),e._uU(12),e.qZA(),e.YNc(13,ae,3,0,"button",9),e.qZA(),e.TgZ(14,"div"),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"span",10),e._uU(18),e.ALo(19,"translate"),e.ALo(20,"translate"),e.qZA()()(),e._UZ(21,"app-animated-router-outlet"),e.qZA()),2&r){const a=e.oxw();e.xp6(2),e.Q6J("ngIf",a.loading),e.xp6(2),e.s9C("matTooltip",e.lcZ(5,13,"MENU_ITEMS.USER.ENTITY")),e.Q6J("ngStyle",e.DdM(23,re)),e.xp6(4),e.Q6J("perunWebAppsMiddleClickRouterLink",e.VKq(24,H,a.user.id.toString()))("routerLink",e.VKq(26,H,a.user.id)),e.xp6(1),e.hij(" ",e.lcZ(10,15,a.user)," "),e.xp6(3),e.hij(" \xa0#",a.user.id," "),e.xp6(1),e.Q6J("ngIf",a.authResolver.isPerunAdmin()),e.xp6(2),e.AsE("",e.lcZ(16,17,"ADMIN_USER.UUID"),": ",a.user.uuid,""),e.xp6(3),e.lnq(" ",e.lcZ(19,19,"MENU_ITEMS.USER.ENTITY"),", ",e.lcZ(20,21,"MENU_ITEMS.USER.USER_TYPE"),": ",a.getUserType()," ")}}let le=(()=>{class r{constructor(a,m,M,Y,w,J,Q){this.sideMenuService=a,this.usersService=m,this.sideMenuItemService=M,this.route=Y,this.dialog=w,this.authResolver=J,this.entityStorageService=Q,this.loading=!1}ngOnInit(){this.loading=!0,this.route.params.subscribe(a=>{const m=Number(a.userId);this.entityStorageService.setEntity({id:m,beanName:"User"}),this.usersService.getUserById(m).subscribe(M=>{this.user=M;const Y=this.sideMenuItemService.parseServiceIdentity(M);this.sideMenuService.setUserItems([Y]),this.loading=!1},()=>this.loading=!1)})}getUserType(){return this.user.serviceUser?"Service":"Person"}editUser(){const a=(0,P.kZ)();a.width="450px",a.data={theme:"admin-theme",user:this.user},this.dialog.open(se.x,a).afterClosed().subscribe(M=>{M&&this.usersService.getUserById(this.user.id).subscribe(Y=>{this.user=Y})})}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(l.D),e.Y36(i.Fv),e.Y36(ne.V),e.Y36(c.gz),e.Y36(G.uw),e.Y36(_.x4),e.Y36(_.fb))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-detail-page"]],decls:1,vars:1,consts:[["class","container-fluid pl-xl-5 pr-xl-5 user-theme",4,"ngIf"],[1,"container-fluid","pl-xl-5","pr-xl-5","user-theme"],["class","mr-auto ml-auto",4,"ngIf"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-service-identity",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"user-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],[1,"text-muted"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"mt-1","entity-info"],[1,"mr-auto","ml-auto"],["mat-icon-button","",3,"click"]],template:function(a,m){1&a&&e.YNc(0,oe,22,28,"div",0),2&a&&e.Q6J("ngIf",void 0!==m.user)},dependencies:[C.O5,C.PC,c.yS,I.Hw,F.lW,A.Ou,f.gM,R.W,B.Y,x.Q,D.A,h.X$,z.d]}),r})(),_e=(()=>{class r{constructor(a){this.entityStorageService=a,this.navItems=[]}ngOnInit(){this.serviceAccount=this.entityStorageService.getEntity(),this.initNavItems()}initNavItems(){this.navItems=[{cssIcon:"perun-manager",url:`/myProfile/service-identities/${this.serviceAccount.id}/associated-users`,label:"MENU_ITEMS.USER.ASSOCIATED_USERS",style:"user-btn"},{cssIcon:"perun-notification",url:`/myProfile/service-identities/${this.serviceAccount.id}/mailing-lists`,label:"MENU_ITEMS.USER.MAILING_LISTS",style:"user-btn"},{cssIcon:"perun-statistics",url:`/myProfile/service-identities/${this.serviceAccount.id}/data-quotas`,label:"MENU_ITEMS.USER.DATA_QUOTAS",style:"user-btn"},{cssIcon:"perun-authentication",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication`,label:"MENU_ITEMS.USER.AUTHENTICATION",style:"user-btn"}]}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(_.fb))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-overview"]],decls:1,vars:2,consts:[[3,"items","size"]],template:function(a,m){1&a&&e._UZ(0,"perun-web-apps-menu-buttons-field",0),2&a&&e.Q6J("items",m.navItems)("size","small")},dependencies:[d.L]}),r})();var ce=t(46597),pe=t(74006);let ue=(()=>{class r{constructor(a){this.entityStorageService=a}ngOnInit(){this.user=this.entityStorageService.getEntity()}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(_.fb))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-user-settings-mailing-lists"]],decls:1,vars:2,consts:[[3,"user","isService"]],template:function(a,m){1&a&&e._UZ(0,"perun-web-apps-mailing-lists",0),2&a&&e.Q6J("user",m.user)("isService",!0)},dependencies:[pe.E]}),r})();var de=t(2541);let me=(()=>{class r{constructor(a){this.entityStorageService=a}ngOnInit(){this.user=this.entityStorageService.getEntity()}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(_.fb))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-user-settings-data-quotas"]],decls:1,vars:1,consts:[[3,"user"]],template:function(a,m){1&a&&e._UZ(0,"perun-web-apps-data-quotas",0),2&a&&e.Q6J("user",m.user)},dependencies:[de.m]}),r})(),ge=(()=>{class r{constructor(a){this.entityStorageService=a,this.navItems=[]}ngOnInit(){this.serviceAccount=this.entityStorageService.getEntity(),this.initNavItems()}initNavItems(){this.navItems=[{cssIcon:"perun-logins",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/logins`,label:"MENU_ITEMS.USER.LOGINS",style:"user-btn"},{cssIcon:"perun-certificates",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/certificates`,label:"MENU_ITEMS.USER.CERTIFICATES",style:"user-btn"},{cssIcon:"perun-key",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/ssh-keys`,label:"MENU_ITEMS.USER.SSH_KEYS",style:"user-btn"}]}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(_.fb))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-authentication-overview"]],decls:1,vars:2,consts:[[3,"items","size"]],template:function(a,m){1&a&&e._UZ(0,"perun-web-apps-menu-buttons-field",0),2&a&&e.Q6J("items",m.navItems)("size","small")},dependencies:[d.L]}),r})();var K=t(24006),he=t(28499),fe=t(95406);function Ee(r,E){if(1&r&&(e.TgZ(0,"div",7),e._UZ(1,"app-login-password-form-with-generate-option",8),e.qZA()),2&r){const a=e.oxw();e.xp6(1),e.Q6J("formGroup",a.formGroup)("filteredNamespace",a.data.filteredNamespaces)}}function Ie(r,E){1&r&&e._UZ(0,"mat-spinner",9)}let Te=(()=>{class r{constructor(a,m,M,Y,w,J,Q,ct,pt,ut){this.dialogRef=a,this.data=m,this.formBuilder=M,this.usersManagerService=Y,this.membersManagerService=w,this.attributesManagerService=J,this.apiRequestConfiguration=Q,this.notificator=ct,this.translate=pt,this.cd=ut,this.processing=!1}ngOnInit(){this.userId=this.data.userId,this.formGroup=this.formBuilder.group({namespaceCtrl:["Not selected"],loginCtrl:["",[K.kI.pattern("^[a-z][a-z0-9_-]+$"),K.kI.maxLength(15),K.kI.minLength(2)]],passwordCtrl:["",K.kI.required,[(0,he.yT)(null,this.usersManagerService,this.apiRequestConfiguration)]],passwordAgainCtrl:[""],generatePasswordCtrl:[!0]},{validators:P.dN.passwordMatchValidator})}ngAfterViewInit(){this.cd.detectChanges()}onSetLogin(){this.processing=!0;const a=this.formGroup.get("namespaceCtrl").value.toLowerCase(),m=this.formGroup.get("loginCtrl").value;if(m)this.setLogin(a,m);else{const M=`urn:perun:user:attribute-def:def:login-namespace:${a}`;this.attributesManagerService.getUserAttributeByName(this.userId,"urn:perun:user:attribute-def:core:lastName").subscribe(Y=>{this.usersManagerService.generateAccountForName(a,Y.value).subscribe(J=>{this.setLogin(a,J[M])},()=>this.processing=!1)})}}setLogin(a,m){this.usersManagerService.setLogin(this.userId,m,a).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.SET_LOGIN.SUCCESS_LOGIN")),this.setPassword()},()=>{this.processing=!1})}setPassword(){const a=this.formGroup.get("namespaceCtrl").value.toLowerCase(),m=this.formGroup.get("passwordCtrl").value;if(this.formGroup.get("generatePasswordCtrl").value){if(!this.formGroup.get("loginCtrl").value)return;this.usersManagerService.reserveRandomPassword(this.userId,a).subscribe(()=>{this.usersManagerService.validatePasswordForUser(this.userId,a).subscribe(()=>{this.dialogRef.close(!0)},()=>{this.processing=!1})},()=>{this.processing=!1})}else this.usersManagerService.reservePasswordForUser({user:this.userId,namespace:a,password:m}).subscribe(()=>{this.usersManagerService.validatePasswordForUser(this.userId,a).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.SET_LOGIN.SUCCESS_PASSWORD")),this.dialogRef.close(!0)},()=>{this.processing=!1})},()=>{this.processing=!1})}onCancel(){this.dialogRef.close(!1)}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(G.so),e.Y36(G.WI),e.Y36(K.QS),e.Y36(i.Fv),e.Y36(i.uq),e.Y36(i.H8),e.Y36(_.F5),e.Y36(_.V6),e.Y36(h.sK),e.Y36(e.sBO))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-set-login-dialog"]],decls:13,vars:12,consts:[[1,"vo-theme"],[1,"mat-dialog-title"],["class","dialog-container","mat-dialog-content","",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],["mat-dialog-content","",1,"dialog-container"],[3,"formGroup","filteredNamespace"],[1,"ml-auto","mr-auto"]],template:function(a,m){1&a&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,Ee,2,2,"div",2),e.YNc(5,Ie,1,0,"mat-spinner",3),e.TgZ(6,"div",4)(7,"button",5),e.NdJ("click",function(){return m.onCancel()}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",6),e.NdJ("click",function(){return m.onSetLogin()}),e._uU(11),e.ALo(12,"translate"),e.qZA()()()),2&a&&(e.xp6(2),e.Oqu(e.lcZ(3,6,"DIALOGS.SET_LOGIN.TITLE")),e.xp6(2),e.Q6J("ngIf",!m.processing),e.xp6(1),e.Q6J("ngIf",m.processing),e.xp6(3),e.hij(" ",e.lcZ(9,8,"DIALOGS.SET_LOGIN.CANCEL")," "),e.xp6(2),e.Q6J("disabled","Not selected"===m.formGroup.get("namespaceCtrl").value||m.formGroup.invalid||m.formGroup.pending||m.processing),e.xp6(1),e.hij(" ",e.lcZ(12,10,"DIALOGS.SET_LOGIN.SET_LOGIN")," "))},dependencies:[C.O5,K.JL,K.sg,F.lW,G.xY,G.H8,A.Ou,fe.r,h.X$]}),r})();var j=t(96214),ve=t(53599);const Ue=["logins"];let Ce=(()=>{class r{constructor(a,m){this.dialog=a,this.entityStorageService=m,this.filteredNamespaces=[]}ngOnInit(){this.userId=this.entityStorageService.getEntity().id}onAdd(){const a=(0,P.kZ)();a.width="500px",a.data={userId:this.userId,filteredNamespaces:this.filteredNamespaces},this.dialog.open(Te,a).afterClosed().subscribe(M=>{M&&this.logins.refreshTable()})}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(G.uw),e.Y36(_.fb))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-user-settings-logins"]],viewQuery:function(a,m){if(1&a&&e.Gf(Ue,5),2&a){let M;e.iGM(M=e.CRH())&&(m.logins=M.first)}},decls:9,vars:7,consts:[[1,"page-title"],[3,"refresh"],["color","accent","mat-flat-button","",1,"mr-2","action-button",3,"click"],[3,"authenticationPage","filteredNamespaces"],["logins",""]],template:function(a,m){if(1&a){const M=e.EpF();e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){e.CHM(M);const w=e.MAs(8);return e.KtG(w.refreshTable())}),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return m.onAdd()}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"perun-web-apps-password-reset",3,4),e.NdJ("filteredNamespaces",function(w){return m.filteredNamespaces=w}),e.qZA()}2&a&&(e.xp6(1),e.Oqu(e.lcZ(2,3,"USER_DETAIL.SETTINGS.LOGINS.TITLE")),e.xp6(4),e.hij(" ",e.lcZ(6,5,"USER_DETAIL.SETTINGS.LOGINS.ADD"),"\n"),e.xp6(2),e.Q6J("authenticationPage",!0))},dependencies:[F.lW,j.t,ve.N,h.X$]}),r})(),Ae=(()=>{class r{}return r.\u0275fac=function(a){return new(a||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-authentication"]],hostVars:2,hostBindings:function(a,m){2&a&&e.ekj("router-component",m.true)},decls:1,vars:0,template:function(a,m){1&a&&e._UZ(0,"app-animated-router-outlet")},dependencies:[D.A]}),r})();var Se=t(64080),De=t(95017),be=t(21029),Oe=t(53984);const Me=["list"];function Re(r,E){1&r&&e._UZ(0,"mat-spinner",5)}const Pe=function(r){return[r]};function Le(r,E){if(1&r&&e._UZ(0,"perun-web-apps-attributes-list",6,7),2&r){const a=e.oxw();e.Q6J("attributes",e.VKq(2,Pe,a.certificates))("selection",a.selection)}}let ye=(()=>{class r{constructor(a,m,M){this.entityStorageService=a,this.attributesManagerService=m,this.dialog=M,this.selection=new De.Ov(!0,[])}ngOnInit(){this.userId=this.entityStorageService.getEntity().id,this.refresh()}refresh(){this.loading=!0,this.attributesManagerService.getUserAttributeByName(this.userId,Se.r.USER_DEF_CERTIFICATES).subscribe(a=>{this.certificates=a,this.selection.clear(),this.loading=!1})}save(){this.list.updateMapAttributes();const a=(0,P.kZ)();a.width="450px",a.data={entityId:this.userId,entity:"user",attributes:this.selection.selected},this.dialog.open(be.wA,a).afterClosed().subscribe(M=>{M&&this.refresh()})}}return r.\u0275fac=function(a){return new(a||r)(e.Y36(_.fb),e.Y36(i.H8),e.Y36(G.uw))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-certificates"]],viewQuery:function(a,m){if(1&a&&e.Gf(Me,5),2&a){let M;e.iGM(M=e.CRH())&&(m.list=M.first)}},decls:9,vars:9,consts:[[1,"page-title"],[1,"mt-2",3,"refresh"],["color","accent","mat-flat-button","",1,"mr-2","mt-2",3,"disabled","click"],["class","ml-auto mr-auto",4,"ngIf"],[3,"attributes","selection",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"attributes","selection"],["list",""]],template:function(a,m){1&a&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){return m.refresh()}),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return m.save()}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.YNc(7,Re,1,0,"mat-spinner",3),e.YNc(8,Le,2,4,"perun-web-apps-attributes-list",4)),2&a&&(e.xp6(1),e.Oqu(e.lcZ(2,5,"USER_DETAIL.SETTINGS.CERTIFICATES.TITLE")),e.xp6(3),e.Q6J("disabled",0===m.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(6,7,"USER_DETAIL.SETTINGS.CERTIFICATES.SAVE"),"\n"),e.xp6(2),e.Q6J("ngIf",m.loading),e.xp6(1),e.Q6J("ngIf",!m.loading))},dependencies:[C.O5,F.lW,A.Ou,j.t,Oe.p,h.X$]}),r})();var Ne=t(51403);const Ze=[{path:"",component:q,children:[{path:"",component:o.Z,data:{animation:"UserOverviewPage"}},{path:"attributes",component:N.u,data:{animation:"UserAttributesPage"}},{path:"organizations",component:L.j,data:{animation:"UserOrganizationsPage",showPrincipal:!0}},{path:"groups",component:n.u,data:{animation:"UserGroupsPage",showPrincipal:!0}},{path:"roles",component:ee.t,data:{animation:"UserRolesPage"}},{path:"service-identities",component:te.R,data:{animation:"UserServiceIdentities"}},{path:"bans",component:Ne.Q,data:{animation:"UserBansPage"}},{path:"settings",component:s,children:[{path:"",component:b,data:{animation:"UserSettingsOverviewPage"}},{path:"passwordReset",component:U.Nj,data:{animation:"PasswordResetPage"}},{path:"guiConfig",component:p,data:{animation:"UserAppConfigurationPage"}}]}]},{path:"service-identities/:userId",component:le,children:[{path:"",component:_e},{path:"associated-users",component:ce.d},{path:"authentication",component:Ae,children:[{path:"",component:ge},{path:"logins",component:Ce},{path:"certificates",component:ye},{path:"ssh-keys",component:U.N7}]},{path:"mailing-lists",component:ue},{path:"data-quotas",component:me}]}];let Be=(()=>{class r{}return r.\u0275fac=function(a){return new(a||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[c.Bz.forChild(Ze),c.Bz]}),r})();var xe=t(47957),Ye=t(284),We=t(23267),Ke=t(37084),we=t(96308),Ge=t(30671),Fe=t(3848),Je=t(35423),Qe=t(56709),ze=t(17009),Ve=t(73162),He=t(90455),je=t(99602),Xe=t(71948),$e=t(44850),ke=t(98739),X=t(73546),qe=t(86257),et=t(73555),tt=t(77331),nt=t(28255),st=t(67376),it=t(63189),at=t(42673),rt=t(11243),ot=t(19516),lt=t(14264);let _t=(()=>{class r{constructor(a){this.translate=a,a.addLangs(["en","cs"])}}return r.\u0275fac=function(a){return new(a||r)(e.LFG(h.sK))},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[C.ez,Be,xe.Bb,Ye.c,O.lN,K.UX,K.u5,I.Ps,We.SJ,Ke.To,h.aw.forChild({}),F.ot,we.JX,Ge.p0,Fe.Nh,Je.dp,F.ot,Qe.p9,G.Is,g.LD,ze.ZX,A.Cq,Ve.Cv,f.AV,He.rP,je.FA,v.XK,Xe.Fk,$e.t,v.si,ke.TU,X.QW,qe.T5,et._t,X.QW,tt.Hi,nt.Tx,st.Cl,it.r,at.g,U.ez,rt.r,ot.d4,lt.m]}),r})()}}]);