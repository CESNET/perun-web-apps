"use strict";(self.webpackChunkadmin_gui=self.webpackChunkadmin_gui||[]).push([[283],{61283:(W,L,s)=>{s.d(L,{A:()=>g});var t=s(36769),u=s(94650),I=s(94364);let g=(()=>{class i{prepareRoute(n){return n?.activatedRouteData&&null!==n?.activatedRouteData.animation}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=u.Xpm({type:i,selectors:[["app-animated-router-outlet"]],decls:3,vars:0,consts:[["outlet","outlet"]],template:function(n,y){1&n&&(u.TgZ(0,"div"),u._UZ(1,"router-outlet",null,0),u.qZA())},dependencies:[I.lC],data:{animation:[t.Ji]}}),i})()},71103:(W,L,s)=>{s.d(L,{n:()=>_});var t=s(65412),u=s(95017),I=s(81591),g=s(61744),i=s(10036),n=(s(37433),s(94650)),y=s(89383),e=s(36895),O=s(4859),S=s(51572),T=s(98380),w=s(7434),v=s(53984);const A=["list"];function R(f,U){1&f&&(n.TgZ(0,"perun-web-apps-alert",10),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&f&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"DIALOGS.CREATE_ATTRIBUTE.ERROR_EMPTY_VALUE")," "))}function d(f,U){1&f&&n._UZ(0,"mat-spinner",11)}function D(f,U){if(1&f&&n._UZ(0,"perun-web-apps-attributes-list",12,13),2&f){const p=n.oxw();n.Q6J("emptyListText","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.EMPTY_ATTRIBUTES")("attributes",p.attributes)("filterValue",p.filterValue)("inDialog",!0)("selection",p.selected)("tableId",p.tableId)}}let _=(()=>{class f{constructor(p,E,l,C,P){this.dialogRef=p,this.data=E,this.attributesManager=l,this.notificator=C,this.translate=P,this.attributes=[],this.selected=new u.Ov(!0,[]),this.showError=!1,this.filterValue="",this.tableId=i.rF,this.translate.get("DIALOGS.CREATE_ATTRIBUTE.SUCCESS_SAVE").subscribe(F=>this.saveSuccessMessage=F)}ngOnInit(){const p=new Array;let E,l,C,P,F,J,b,x;switch(this.data.notEmptyAttributes.forEach(c=>{p.push(c.id)}),this.data.entity){case"member":E=this.data.entityId;break;case"user":l=this.data.entityId;break;case"vo":C=this.data.entityId;break;case"group":P=this.data.entityId;break;case"resource":F=this.data.entityId;break;case"facility":J=this.data.entityId;break;case"host":b=this.data.entityId;break;case"ues":x=this.data.entityId}switch(this.data.secondEntity){case"member":E=this.data.secondEntityId;break;case"user":l=this.data.secondEntityId;break;case"vo":C=this.data.secondEntityId;break;case"group":P=this.data.secondEntityId;break;case"resource":F=this.data.secondEntityId;break;case"facility":J=this.data.secondEntityId;break;case"host":b=this.data.secondEntityId;break;case"ues":x=this.data.secondEntityId}this.loading=!0,this.attributesManager.getAttributesDefinitionWithRights(E,l,C,P,F,J,b,x).subscribe(c=>{this.attributes=c,this.attributes=this.attributes.filter(o=>!p.includes(o.id)&&this.twoEntityValid(o)),this.loading=!1})}onCancel(){this.dialogRef.close()}onSave(){this.list.updateMapAttributes();let p=!1;for(const E of this.selected.selected)"java.util.ArrayList"===E.type&&0===E.value.length&&(p=!0),void 0===E.value&&(p=!0);if(p)return this.showError=!0,void setTimeout(()=>{this.showError=!1},5e3);switch(this.data.entity){case"facility":"user"===this.data.secondEntity?this.attributesManager.setUserFacilityAttributes({facility:this.data.entityId,user:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()}):this.attributesManager.setFacilityAttributes({facility:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"group":"resource"===this.data.secondEntity?this.attributesManager.setGroupResourceAttributes({group:this.data.entityId,resource:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()}):this.attributesManager.setGroupAttributes({group:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"member":switch(this.data.secondEntity){case"resource":this.attributesManager.setMemberResourceAttributes({member:this.data.entityId,resource:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"group":this.attributesManager.setMemberGroupAttributes({member:this.data.entityId,group:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;default:this.attributesManager.setMemberAttributes({member:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()})}break;case"resource":switch(this.data.secondEntity){case"member":this.attributesManager.setMemberResourceAttributes({resource:this.data.entityId,member:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"group":this.attributesManager.setGroupResourceAttributes({resource:this.data.entityId,group:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;default:this.attributesManager.setResourceAttributes({resource:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()})}break;case"user":"facility"===this.data.secondEntity?this.attributesManager.setUserFacilityAttributes({user:this.data.entityId,facility:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()}):this.attributesManager.setUserAttributes({user:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"vo":this.attributesManager.setVoAttributes({vo:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"host":this.attributesManager.setHostAttributes({host:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"ues":this.attributesManager.setUserExtSourceAttributes({userExtSource:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()})}}applyFilter(p){this.filterValue=p}handleSuccess(){this.notificator.showSuccess(this.saveSuccessMessage),this.selected.clear(),this.dialogRef.close("saved")}twoEntityValid(p){return!this.data.secondEntity||p.entity===`${this.data.entity}_${this.data.secondEntity}`||p.entity===`${this.data.secondEntity}_${this.data.entity}`}}return f.\u0275fac=function(p){return new(p||f)(n.Y36(t.so),n.Y36(t.WI),n.Y36(g.H8),n.Y36(I.V6),n.Y36(y.sK))},f.\u0275cmp=n.Xpm({type:f,selectors:[["app-create-attribute-dialog"]],viewQuery:function(p,E){if(1&p&&n.Gf(A,5),2&p){let l;n.iGM(l=n.CRH())&&(E.list=l.first)}},decls:17,vars:17,consts:[["mat-dialog-title",""],[1,"page-subtitle"],["data-cy","filter-attributes",1,"font-size-1rem",3,"placeholder","filter"],["class","ml-3 font-size-1rem","alert_type","error",4,"ngIf"],["mat-dialog-content",""],["class","ml-auto mr-auto",4,"ngIf"],[3,"emptyListText","attributes","filterValue","inDialog","selection","tableId",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","data-cy","save-selected-attributes","mat-flat-button","",1,"ml-2",3,"disabled","click"],["alert_type","error",1,"ml-3","font-size-1rem"],[1,"ml-auto","mr-auto"],[3,"emptyListText","attributes","filterValue","inDialog","selection","tableId"],["list",""]],template:function(p,E){1&p&&(n.TgZ(0,"div")(1,"div",0)(2,"h1",1),n._uU(3),n.ALo(4,"translate"),n.qZA(),n.TgZ(5,"perun-web-apps-immediate-filter",2),n.NdJ("filter",function(C){return E.applyFilter(C)}),n.qZA(),n.YNc(6,R,3,3,"perun-web-apps-alert",3),n.qZA(),n.TgZ(7,"div",4),n.YNc(8,d,1,0,"mat-spinner",5),n.YNc(9,D,2,6,"perun-web-apps-attributes-list",6),n.qZA(),n.TgZ(10,"div",7)(11,"button",8),n.NdJ("click",function(){return E.onCancel()}),n._uU(12),n.ALo(13,"translate"),n.qZA(),n.TgZ(14,"button",9),n.NdJ("click",function(){return E.onSave()}),n._uU(15),n.ALo(16,"translate"),n.qZA()()()),2&p&&(n.Tol(E.data.style),n.xp6(3),n.Oqu(n.lcZ(4,11,"DIALOGS.CREATE_ATTRIBUTE.SET_NEW")),n.xp6(2),n.Q6J("placeholder","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.FILTER"),n.xp6(1),n.Q6J("ngIf",E.showError),n.xp6(2),n.Q6J("ngIf",E.loading),n.xp6(1),n.Q6J("ngIf",!E.loading),n.xp6(3),n.hij(" ",n.lcZ(13,13,"DIALOGS.CREATE_ATTRIBUTE.CANCEL")," "),n.xp6(2),n.Q6J("disabled",0===E.selected.selected.length),n.xp6(1),n.hij(" ",n.lcZ(16,15,"DIALOGS.CREATE_ATTRIBUTE.SAVE")," "))},dependencies:[e.O5,O.lW,t.uh,t.xY,t.H8,S.Ou,T.w,w.L,v.p,y.X$],styles:[".font-size-1rem[_ngcontent-%COMP%]{font-size:1rem!important}"]}),f})()},61365:(W,L,s)=>{s.d(L,{k:()=>R});var t=s(65412),u=s(30671),I=s(81591),g=s(61744),i=s(94650),M=s(89383),n=s(36895),y=s(4859),e=s(51572);function O(d,D){1&d&&i._UZ(0,"mat-spinner",6)}function S(d,D){1&d&&i._UZ(0,"th",15)}function T(d,D){if(1&d&&(i.TgZ(0,"td",16),i._uU(1),i.qZA()),2&d){const _=D.$implicit;i.xp6(1),i.Oqu(_.displayName)}}function w(d,D){1&d&&i._UZ(0,"tr",17)}function v(d,D){1&d&&i._UZ(0,"tr",18)}function A(d,D){if(1&d&&(i.TgZ(0,"div",7)(1,"div"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"div",8),i._uU(5),i.ALo(6,"translate"),i.qZA(),i.TgZ(7,"table",9),i.ynx(8,10),i.YNc(9,S,1,0,"th",11),i.YNc(10,T,2,1,"td",12),i.BQk(),i.YNc(11,w,1,0,"tr",13),i.YNc(12,v,1,0,"tr",14),i.qZA()()),2&d){const _=i.oxw();i.xp6(2),i.hij(" ",i.lcZ(3,5,"DIALOGS.DELETE_ATTRIBUTES.DESCRIPTION")," "),i.xp6(3),i.hij(" ",i.lcZ(6,7,"DIALOGS.DELETE_ATTRIBUTES.ASK")," "),i.xp6(2),i.Q6J("dataSource",_.dataSource),i.xp6(4),i.Q6J("matHeaderRowDef",_.displayedColumns),i.xp6(1),i.Q6J("matRowDefColumns",_.displayedColumns)}}let R=(()=>{class d{constructor(_,f,U,p,E){this.dialogRef=_,this.data=f,this.notificator=U,this.translate=p,this.attributesManager=E,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.dataSource=new u.by(this.data.attributes),this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){const _=[];for(const U of this.data.attributes)_.push(U.id);const f={};switch(f[this.data.entity]=this.data.entityId,f.attributes=_,void 0!==this.data.secondEntity&&(f[this.data.secondEntity]=this.data.secondEntityId),this.loading=!0,this.data.entity){case"vo":this.attributesManager.removeVoAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"group":"resource"===this.data.secondEntity?this.attributesManager.removeGroupResourceAttributes(this.data.entityId,this.data.secondEntityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1}):this.attributesManager.removeGroupAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"user":"facility"===this.data.secondEntity?this.attributesManager.removeUserFacilityAttributes(this.data.entityId,this.data.secondEntityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1}):this.attributesManager.removeUserAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"member":switch(this.data.secondEntity){case"resource":this.attributesManager.removeMemberResourceAttributes(this.data.entityId,this.data.secondEntityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"group":this.attributesManager.removeMemberGroupAttributes(this.data.entityId,this.data.secondEntityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;default:this.attributesManager.removeMemberAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1})}break;case"facility":"user"===this.data.secondEntity?this.attributesManager.removeUserFacilityAttributes(this.data.secondEntityId,this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1}):this.attributesManager.removeFacilityAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"host":this.attributesManager.removeHostAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"ues":this.attributesManager.removeUesAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"resource":switch(this.data.secondEntity){case"member":this.attributesManager.removeMemberResourceAttributes(this.data.secondEntityId,this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"group":this.attributesManager.removeGroupResourceAttributes(this.data.secondEntityId,this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;default:this.attributesManager.removeResourceAttributes(this.data.entityId,_).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1})}}}onSuccess(){this.translate.get("DIALOGS.DELETE_ATTRIBUTES.SUCCESS").subscribe(_=>{this.notificator.showSuccess(_),this.dialogRef.close(!0)})}}return d.\u0275fac=function(_){return new(_||d)(i.Y36(t.so),i.Y36(t.WI),i.Y36(I.V6),i.Y36(M.sK),i.Y36(g.H8))},d.\u0275cmp=i.Xpm({type:d,selectors:[["app-delete-attribute-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","warn","data-cy","delete-attributes","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(_,f){1&_&&(i.TgZ(0,"div")(1,"h1",0),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.YNc(4,O,1,0,"mat-spinner",1),i.YNc(5,A,13,9,"div",2),i.TgZ(6,"div",3)(7,"button",4),i.NdJ("click",function(){return f.onCancel()}),i._uU(8),i.ALo(9,"translate"),i.qZA(),i.TgZ(10,"button",5),i.NdJ("click",function(){return f.onSubmit()}),i._uU(11),i.ALo(12,"translate"),i.qZA()()()),2&_&&(i.Tol(f.theme),i.xp6(2),i.Oqu(i.lcZ(3,9,"DIALOGS.DELETE_ATTRIBUTES.TITLE")),i.xp6(2),i.Q6J("ngIf",f.loading),i.xp6(1),i.Q6J("ngIf",!f.loading),i.xp6(3),i.hij(" ",i.lcZ(9,11,"DIALOGS.DELETE_ATTRIBUTES.CANCEL")," "),i.xp6(2),i.Q6J("disabled",f.loading),i.xp6(1),i.hij(" ",i.lcZ(12,13,"DIALOGS.DELETE_ATTRIBUTES.DELETE")," "))},dependencies:[n.O5,y.lW,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk,t.uh,t.xY,t.H8,e.Ou,M.X$]}),d})()},1415:(W,L,s)=>{s.d(L,{l:()=>S});var t=s(94650),u=s(37433),I=s(36895),g=s(4859),i=s(65412),M=s(51572),n=s(29926),y=s(89383);function e(T,w){1&T&&t._UZ(0,"mat-spinner",7)}function O(T,w){if(1&T&&t._UZ(0,"perun-web-apps-ban-specification",8),2&T){const v=t.oxw();t.Q6J("description",v.ban.description)("validity",v.ban.validityTo)}}let S=(()=>{class T{constructor(){this.loading=!1,this.cancel=new t.vpe,this.update=new t.vpe}updateBan(){this.update.emit({description:this.banForm.getDescription(),validity:this.banForm.getValidity()})}}return T.\u0275fac=function(v){return new(v||T)},T.\u0275cmp=t.Xpm({type:T,selectors:[["app-update-ban-dialog"]],viewQuery:function(v,A){if(1&v&&t.Gf(u.CZ,5),2&v){let R;t.iGM(R=t.CRH())&&(A.banForm=R.first)}},inputs:{loading:"loading",ban:"ban",theme:"theme"},outputs:{cancel:"cancel",update:"update"},decls:14,vars:14,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["class","ml-auto mr-auto",4,"ngIf"],[3,"description","validity",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto","mr-2",3,"click"],["mat-flat-button","","color","accent",3,"click"],[1,"ml-auto","mr-auto"],[3,"description","validity"]],template:function(v,A){1&v&&(t.TgZ(0,"div")(1,"h1",0),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",1),t.YNc(5,e,1,0,"mat-spinner",2),t.YNc(6,O,1,2,"perun-web-apps-ban-specification",3),t.qZA(),t.TgZ(7,"div",4)(8,"button",5),t.NdJ("click",function(){return A.cancel.emit()}),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"button",6),t.NdJ("click",function(){return A.updateBan()}),t._uU(12),t.ALo(13,"translate"),t.qZA()()()),2&v&&(t.Tol(A.theme),t.xp6(2),t.Oqu(t.lcZ(3,8,"DIALOGS.UPDATE_BAN.TITLE")),t.xp6(3),t.Q6J("ngIf",A.loading),t.xp6(1),t.Q6J("ngIf",!A.loading),t.xp6(3),t.hij(" ",t.lcZ(10,10,"DIALOGS.UPDATE_BAN.CANCEL")," "),t.xp6(3),t.hij(" ",t.lcZ(13,12,"DIALOGS.UPDATE_BAN.UPDATE")," "))},dependencies:[I.O5,g.lW,i.uh,i.xY,i.H8,M.Ou,n.C,y.X$]}),T})()},28943:(W,L,s)=>{s.d(L,{e:()=>M});var t=s(65412),u=s(61744),I=s(81591),g=s(94650),i=s(1415);let M=(()=>{class n{constructor(e,O,S,T){this.data=e,this.dialogRef=O,this.resourceService=S,this.notificator=T,this.loading=!1}update(e){this.loading=!0,this.resourceService.updateResourceBan({banOnResource:{id:this.data.ban.id,beanName:"BanOnFacility",resourceId:this.data.ban.resourceId,memberId:this.data.ban.memberId,description:e.description,validityTo:e.validity}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.UPDATE_BAN.SUCCESS"),this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}cancel(){this.dialogRef.close(!1)}}return n.\u0275fac=function(e){return new(e||n)(g.Y36(t.WI),g.Y36(t.so),g.Y36(u.xk),g.Y36(I.V6))},n.\u0275cmp=g.Xpm({type:n,selectors:[["app-update-resource-ban-dialog"]],decls:1,vars:2,consts:[[3,"ban","theme","cancel","update"]],template:function(e,O){1&e&&(g.TgZ(0,"app-update-ban-dialog",0),g.NdJ("cancel",function(){return O.cancel()})("update",function(T){return O.update(T)}),g.qZA()),2&e&&g.Q6J("ban",O.data.ban)("theme","facility-theme")},dependencies:[i.l]}),n})()},32316:(W,L,s)=>{s.d(L,{A:()=>M});var t=s(65412),u=s(61744),I=s(81591),g=s(94650),i=s(1415);let M=(()=>{class n{constructor(e,O,S,T){this.data=e,this.dialogRef=O,this.voService=S,this.notificator=T,this.loading=!1}update(e){this.loading=!0,this.voService.updateVoBan({banOnVo:{id:this.data.ban.id,beanName:"BanOnVo",voId:this.data.ban.voId,memberId:this.data.ban.memberId,description:e.description,validityTo:e.validity}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.UPDATE_BAN.SUCCESS"),this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}cancel(){this.dialogRef.close(!1)}}return n.\u0275fac=function(e){return new(e||n)(g.Y36(t.WI),g.Y36(t.so),g.Y36(u.YF),g.Y36(I.V6))},n.\u0275cmp=g.Xpm({type:n,selectors:[["app-update-vo-ban-dialog"]],decls:1,vars:2,consts:[[3,"ban","theme","cancel","update"]],template:function(e,O){1&e&&(g.TgZ(0,"app-update-ban-dialog",0),g.NdJ("cancel",function(){return O.cancel()})("update",function(T){return O.update(T)}),g.qZA()),2&e&&g.Q6J("ban",O.data.ban)("theme","vo-theme")},dependencies:[i.l]}),n})()},95406:(W,L,s)=>{s.d(L,{r:()=>J});var t=s(94650),u=s(24006),I=s(9244),g=s(28499),i=s(61744),M=s(81591),n=s(10266),y=s(71948),e=s(13469),O=s(78372),S=s(95698),T=s(63900),w=s(54004),v=s(36895),A=s(3238),R=s(59549),d=s(284),D=s(84385),_=s(89383);function f(b,x){if(1&b&&(t.TgZ(0,"mat-option",7),t._uU(1),t.qZA()),2&b){const c=x.$implicit;t.Q6J("value",c),t.xp6(1),t.hij(" ",c," ")}}function U(b,x){1&b&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&b&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.FIELD_EMPTY")))}function p(b,x){1&b&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&b&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_EXISTS")))}function E(b,x){1&b&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&b&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_FORMAT")))}function l(b,x){1&b&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&b&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_LONG")))}function C(b,x){1&b&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&b&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_SHORT")))}function P(b,x){if(1&b&&(t.TgZ(0,"span",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&b){const c=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,1,"Not selected"===c.formGroup.get("namespaceCtrl").value?"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_DISABLED":"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_DISABLED_FOR_NAMESPACE")," ")}}let F=(()=>{class b{constructor(c,o){this.membersManagerService=c,this.usersManagerService=o,this.filteredNamespaces=null,this.namespaceChanged=new t.vpe,this.parsedRulesChanged=new t.vpe,this.namespaceOptions=[],this.selectedNamespace=null,this.namespaceRules=[],this.parsedRules=new Map}ngOnInit(){this.namespaceOptions=["Not selected"],this.membersManagerService.getAllNamespacesRules().subscribe(c=>{this.namespaceRules=c,this.parseNamespaceRules()}),this.onNamespaceChanged("Not selected")}existingLoginValidator(){return c=>{let o=this.formGroup.get("namespaceCtrl").value.toLowerCase();return o="not selected"===o?"mu":o,c.valueChanges.pipe((0,O.b)(500),(0,S.q)(1),(0,T.w)(()=>this.usersManagerService.isLoginAvailable(o,c.value).pipe((0,w.U)(Z=>Z?null:{loginExists:!0}))))}}parseNamespaceRules(){for(const c of this.namespaceRules)if(null===this.filteredNamespaces||!this.filteredNamespaces.includes(c.namespaceName)){this.namespaceOptions.push(c.namespaceName);const o={login:"disabled"};this.parseAttributes(o,c.requiredAttributes,"required"),this.parseAttributes(o,c.optionalAttributes,"optional"),this.parsedRules.set(c.namespaceName,o)}this.parsedRulesChanged.emit(this.parsedRules)}parseAttributes(c,o,Z){for(const G of o)"login"===G&&(c.login=Z)}onNamespaceChanged(c){this.selectedNamespace=c.toLowerCase();const o=this.formGroup.get("loginCtrl");if("Not selected"!==c)if("disabled"===this.parsedRules.get(this.selectedNamespace).login)o.disable(),o.setValue("");else{const Z=[u.kI.required,u.kI.pattern("^[a-z][a-z0-9_-]+$"),u.kI.maxLength(15),u.kI.minLength(2)];(0,I.mH)(o,Z,[this.existingLoginValidator()])}else o.disable(),o.setValue("");this.namespaceChanged.emit(c)}}return b.\u0275fac=function(c){return new(c||b)(t.Y36(i.uq),t.Y36(i.Fv))},b.\u0275cmp=t.Xpm({type:b,selectors:[["app-login-for-namespace"]],inputs:{formGroup:"formGroup",filteredNamespaces:"filteredNamespaces"},outputs:{namespaceChanged:"namespaceChanged",parsedRulesChanged:"parsedRulesChanged"},decls:18,vars:16,consts:[[1,"display-flex",3,"formGroup"],["formControlName","namespaceCtrl",3,"valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"floatLabel"],["formControlName","loginCtrl","matInput","","required","",3,"hidden"],[4,"ngIf"],["class","input-disabled",4,"ngIf"],[3,"value"],[1,"input-disabled"]],template:function(c,o){1&c&&(t.TgZ(0,"div",0)(1,"mat-form-field")(2,"mat-label"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"mat-select",1),t.NdJ("valueChange",function(G){return o.onNamespaceChanged(G)}),t.YNc(6,f,2,2,"mat-option",2),t.qZA()(),t.TgZ(7,"mat-form-field",3)(8,"mat-label"),t._uU(9),t.ALo(10,"translate"),t.qZA(),t._UZ(11,"input",4),t.YNc(12,U,3,3,"mat-error",5),t.YNc(13,p,3,3,"mat-error",5),t.YNc(14,E,3,3,"mat-error",5),t.YNc(15,l,3,3,"mat-error",5),t.YNc(16,C,3,3,"mat-error",5),t.YNc(17,P,3,3,"span",6),t.qZA()()),2&c&&(t.Q6J("formGroup",o.formGroup),t.xp6(3),t.Oqu(t.lcZ(4,12,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.NAMESPACE")),t.xp6(3),t.Q6J("ngForOf",o.namespaceOptions),t.xp6(1),t.Q6J("floatLabel",o.formGroup.get("loginCtrl").disabled?"always":null),t.xp6(2),t.Oqu(t.lcZ(10,14,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN")),t.xp6(2),t.Q6J("hidden",o.formGroup.get("loginCtrl").disabled),t.xp6(1),t.Q6J("ngIf",o.formGroup.get("loginCtrl").hasError("required")),t.xp6(1),t.Q6J("ngIf",o.formGroup.get("loginCtrl").hasError("loginExists")),t.xp6(1),t.Q6J("ngIf",o.formGroup.get("loginCtrl").hasError("pattern")&&!o.formGroup.get("loginCtrl").hasError("minlength")),t.xp6(1),t.Q6J("ngIf",o.formGroup.get("loginCtrl").hasError("maxlength")),t.xp6(1),t.Q6J("ngIf",o.formGroup.get("loginCtrl").hasError("minlength")),t.xp6(1),t.Q6J("ngIf",o.formGroup.get("loginCtrl").disabled))},dependencies:[v.sg,v.O5,A.ey,R.TO,R.KE,R.hX,d.Nt,u.Fj,u.JJ,u.JL,u.Q7,u.sg,u.u,D.gD,_.X$],styles:[".display-flex[_ngcontent-%COMP%]{display:flex;flex-direction:column}.input-disabled[_ngcontent-%COMP%]{pointer-events:none;color:#888}"]}),b})(),J=(()=>{class b{constructor(c,o,Z){this.membersManagerService=c,this.usersManagerService=o,this.apiRequestConfiguration=Z,this.filteredNamespace=null,this.parsedRulesOutput=new t.vpe,this.selectedNamespace=null,this.parsedRules=new Map}parsedRulesFunction(c){this.parsedRules=c,this.parsedRulesOutput.emit(c)}onNamespaceChanged(c){this.selectedNamespace=c.toLowerCase();const o=this.formGroup.get("passwordCtrl"),Z=this.formGroup.get("passwordAgainCtrl"),G=this.formGroup.get("generatePasswordCtrl");"Not selected"!==c?((0,I.mH)(G,[]),this.passwordOptionChanged()):(o.disable(),o.setValue(""),Z.disable(),Z.setValue(""),G.disable(),G.dirty||G.setValue(!0))}passwordOptionChanged(){const c=this.formGroup.get("passwordCtrl"),o=this.formGroup.get("passwordAgainCtrl");this.formGroup.get("generatePasswordCtrl").value?(c.disable(),c.setValue(""),o.disable(),o.setValue("")):((0,I.mH)(c,[u.kI.required],[(0,g.yT)(this.selectedNamespace,this.usersManagerService,this.apiRequestConfiguration)]),(0,I.mH)(o,[]))}}return b.\u0275fac=function(c){return new(c||b)(t.Y36(i.uq),t.Y36(i.Fv),t.Y36(M.F5))},b.\u0275cmp=t.Xpm({type:b,selectors:[["app-login-password-form-with-generate-option"]],inputs:{formGroup:"formGroup",filteredNamespace:"filteredNamespace"},outputs:{parsedRulesOutput:"parsedRulesOutput"},decls:12,vars:23,consts:[[1,"display-flex",3,"formGroup"],[3,"formGroup","filteredNamespaces","namespaceChanged","parsedRulesChanged"],["formControlName","generatePasswordCtrl","matTooltipPosition","left",1,"display-flex","mt-3",3,"matTooltipDisabled","matTooltip","ngModelChange"],[3,"checked","value"],[1,"display-flex"],[3,"formGroup","namespace","passwordRequired","tooltipPwdDisabledForNamespace"]],template:function(c,o){1&c&&(t.TgZ(0,"div",0)(1,"app-login-for-namespace",1),t.NdJ("namespaceChanged",function(G){return o.onNamespaceChanged(G)})("parsedRulesChanged",function(G){return o.parsedRulesFunction(G)}),t.qZA(),t.TgZ(2,"mat-radio-group",2),t.NdJ("ngModelChange",function(){return o.passwordOptionChanged()}),t.ALo(3,"translate"),t.TgZ(4,"mat-radio-button",3),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"mat-radio-button",3),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"div",4),t._UZ(11,"perun-web-apps-password-form",5),t.qZA()()),2&c&&(t.Q6J("formGroup",o.formGroup),t.xp6(1),t.Q6J("formGroup",o.formGroup)("filteredNamespaces",o.filteredNamespace),t.xp6(1),t.s9C("matTooltip",t.lcZ(3,17,"DIALOGS.CREATE_SERVICE_MEMBER.PASSWORD_NOT_SUPPORTED")),t.Q6J("matTooltipDisabled","Not selected"!==o.formGroup.get("namespaceCtrl").value),t.xp6(2),t.Q6J("checked",o.formGroup.get("generatePasswordCtrl").value&&o.formGroup.get("generatePasswordCtrl").enabled)("value",!0),t.xp6(1),t.hij(" ",t.lcZ(6,19,"DIALOGS.CREATE_SERVICE_MEMBER.PASSWORD_RANDOM")," "),t.xp6(2),t.Q6J("checked",!o.formGroup.get("generatePasswordCtrl").value&&o.formGroup.get("generatePasswordCtrl").enabled)("value",!1),t.xp6(1),t.hij(" ",t.lcZ(9,21,"DIALOGS.CREATE_SERVICE_MEMBER.ENTER_PASSWORD")," "),t.xp6(2),t.ekj("input-disabled",o.formGroup.get("generatePasswordCtrl").value),t.xp6(1),t.Q6J("formGroup",o.formGroup)("namespace",o.selectedNamespace)("passwordRequired",!o.formGroup.get("generatePasswordCtrl").value)("tooltipPwdDisabledForNamespace",o.formGroup.get("generatePasswordCtrl").enabled))},dependencies:[u.JJ,u.JL,u.sg,u.u,n.gM,y.VQ,y.U0,e.G,F,_.X$],styles:[".display-flex[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),b})()},12651:(W,L,s)=>{s.d(L,{t:()=>U});var t=s(61744),u=s(95017),I=s(9244),g=s(71103),i=s(21029),M=s(61365),y=(s(37433),s(10036)),e=s(94650),O=s(65412),S=s(36895),T=s(4859),w=s(51572),v=s(96214),A=s(7434),R=s(53984),d=s(89383);const D=["list"];function _(p,E){1&p&&e._UZ(0,"mat-spinner",7)}function f(p,E){if(1&p&&e._UZ(0,"perun-web-apps-attributes-list",8,9),2&p){const l=e.oxw();e.Q6J("attributes",l.attributes)("filterValue",l.filterValue)("selection",l.selection)("tableId",l.tableId)}}let U=(()=>{class p{constructor(l,C){this.attributesManagerService=l,this.dialog=C,this.attributes=[],this.selection=new u.Ov(!0,[]),this.filterValue="",this.tableId=y.rF,this.loading=!1}ngOnInit(){this.refreshTable()}refreshTable(){switch(this.loading=!0,this.entity){case"member":this.attributesManagerService.getMemberAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"group":this.attributesManagerService.getGroupAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"user":this.attributesManagerService.getUserAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"resource":this.attributesManagerService.getResourceAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"facility":this.attributesManagerService.getFacilityAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"vo":this.attributesManagerService.getVoAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1})}}applyFilter(l){this.filterValue=l}onCreate(){const l=(0,I.kZ)();l.width="1050px",l.data={entityId:this.entityId,entity:this.entity,notEmptyAttributes:this.attributes,style:this.entity+"-theme"},this.dialog.open(g.n,l).afterClosed().subscribe(P=>{P&&this.refreshTable()})}onSave(){this.list.updateMapAttributes();const l=(0,I.kZ)();l.width="450px",l.data={entityId:this.entityId,entity:this.entity,attributes:this.selection.selected},this.dialog.open(i.wA,l).afterClosed().subscribe(P=>{P&&this.refreshTable()})}onDelete(){const l=(0,I.kZ)();l.width="450px",l.data={entityId:this.entityId,entity:this.entity,attributes:this.selection.selected},this.dialog.open(M.k,l).afterClosed().subscribe(P=>{P&&this.refreshTable()})}}return p.\u0275fac=function(l){return new(l||p)(e.Y36(t.H8),e.Y36(O.uw))},p.\u0275cmp=e.Xpm({type:p,selectors:[["app-one-entity-attribute-page"]],viewQuery:function(l,C){if(1&l&&e.Gf(D,5),2&l){let P;e.iGM(P=e.CRH())&&(C.list=P.first)}},inputs:{entity:"entity",entityId:"entityId"},decls:13,vars:14,consts:[[1,"mt-2",3,"refresh"],["color","accent","data-cy","add-attributes","mat-flat-button","",1,"mr-2","mt-2","action-button",3,"click"],["color","accent","mat-flat-button","",1,"mr-2","mt-2",3,"disabled","click"],["color","warn","data-cy","remove-attributes","mat-flat-button","",1,"mt-2","mr-2",3,"disabled","click"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"attributes","filterValue","selection","tableId",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"attributes","filterValue","selection","tableId"],["list",""]],template:function(l,C){1&l&&(e.TgZ(0,"perun-web-apps-refresh-button",0),e.NdJ("refresh",function(){return C.refreshTable()}),e.qZA(),e.TgZ(1,"button",1),e.NdJ("click",function(){return C.onCreate()}),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return C.onSave()}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"button",3),e.NdJ("click",function(){return C.onDelete()}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"perun-web-apps-immediate-filter",4),e.NdJ("filter",function(F){return C.applyFilter(F)}),e.qZA(),e.YNc(11,_,1,0,"mat-spinner",5),e.YNc(12,f,2,4,"perun-web-apps-attributes-list",6)),2&l&&(e.xp6(2),e.hij(" ",e.lcZ(3,8,"USER_DETAIL.SETTINGS.ATTRIBUTES.CREATE"),"\n"),e.xp6(2),e.Q6J("disabled",0===C.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(6,10,"USER_DETAIL.SETTINGS.ATTRIBUTES.SAVE"),"\n"),e.xp6(2),e.Q6J("disabled",0===C.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(9,12,"USER_DETAIL.SETTINGS.ATTRIBUTES.DELETE"),"\n"),e.xp6(2),e.Q6J("placeholder","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.FILTER"),e.xp6(1),e.Q6J("ngIf",C.loading),e.xp6(1),e.Q6J("ngIf",!C.loading))},dependencies:[S.O5,T.lW,w.Ou,v.t,A.L,R.p,d.X$]}),p})()},48323:(W,L,s)=>{s.d(L,{Y:()=>V});var t=s(61744),I=(s(37433),s(95017)),g=s(61365),i=s(9244),M=s(21029),n=s(71103),y=s(64080),e=s(94650),O=s(65412),S=s(36895),T=s(4859),w=s(51572),v=s(98380),A=s(96214),R=s(7434),d=s(53984),D=s(82322),_=s(45703),f=s(89593),U=s(89383);let p=(()=>{class h{constructor(){this.memberSelected=new e.vpe,this.memberFullNameFunction=a=>(0,i.bD)(a.user)}ngOnInit(){this.members=this.members.sort(i.fx)}}return h.\u0275fac=function(a){return new(a||h)},h.\u0275cmp=e.Xpm({type:h,selectors:[["perun-web-apps-member-search-select"]],inputs:{members:"members"},outputs:{memberSelected:"memberSelected"},decls:4,vars:12,consts:[[3,"entities","searchFunction","mainTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","entitySelected"]],template:function(a,r){1&a&&(e.TgZ(0,"perun-web-apps-entity-search-select",0),e.NdJ("entitySelected",function(N){return r.memberSelected.emit(N)}),e.ALo(1,"translate"),e.ALo(2,"translate"),e.ALo(3,"translate"),e.qZA()),2&a&&e.Q6J("entities",r.members)("searchFunction",r.memberFullNameFunction)("mainTextFunction",r.memberFullNameFunction)("selectPlaceholder",e.lcZ(1,6,"SHARED_LIB.PERUN.COMPONENTS.MEMBER_SEARCH_SELECT.SELECT_MEMBER"))("findPlaceholder",e.lcZ(2,8,"SHARED_LIB.PERUN.COMPONENTS.MEMBER_SEARCH_SELECT.FIND_MEMBER"))("noEntriesText",e.lcZ(3,10,"SHARED_LIB.PERUN.COMPONENTS.MEMBER_SEARCH_SELECT.NO_MEMBER_FOUND"))},dependencies:[f.i,U.X$]}),h})();var E=s(79707),l=s(74250);const C=["list"];function P(h,B){1&h&&e._UZ(0,"mat-spinner",4)}function F(h,B){if(1&h&&(e.TgZ(0,"perun-web-apps-alert",5),e._uU(1),e.qZA()),2&h){const a=e.oxw();e.xp6(1),e.Oqu(a.noEntityMessage)}}function J(h,B){if(1&h){const a=e.EpF();e.TgZ(0,"perun-web-apps-group-search-select",18),e.NdJ("groupSelected",function(m){e.CHM(a);const N=e.oxw(2);return e.KtG(N.specifySecondEntity(m))}),e.qZA()}if(2&h){const a=e.oxw(2);e.Q6J("firstSelectedGroup",a.specificSecondEntity)("displayStatus",!0)("groups",a.entityValues)}}function b(h,B){if(1&h){const a=e.EpF();e.TgZ(0,"perun-web-apps-resource-search-select",19),e.NdJ("resourceSelected",function(m){e.CHM(a);const N=e.oxw(2);return e.KtG(N.specifySecondEntity(m))}),e.qZA()}if(2&h){const a=e.oxw(2);e.Q6J("resources",a.entityValues)}}function x(h,B){if(1&h){const a=e.EpF();e.TgZ(0,"perun-web-apps-member-search-select",20),e.NdJ("memberSelected",function(m){e.CHM(a);const N=e.oxw(2);return e.KtG(N.specifySecondEntity(m))}),e.qZA()}if(2&h){const a=e.oxw(2);e.Q6J("members",a.entityValues)}}function c(h,B){if(1&h){const a=e.EpF();e.TgZ(0,"perun-web-apps-facility-search-select",21),e.NdJ("facilitySelected",function(m){e.CHM(a);const N=e.oxw(2);return e.KtG(N.specifySecondEntity(m))}),e.qZA()}if(2&h){const a=e.oxw(2);e.Q6J("facilities",a.entityValues)}}function o(h,B){if(1&h){const a=e.EpF();e.TgZ(0,"perun-web-apps-user-search-select",22),e.NdJ("userSelected",function(m){e.CHM(a);const N=e.oxw(2);return e.KtG(N.specifySecondEntity(m))}),e.qZA()}if(2&h){const a=e.oxw(2);e.Q6J("users",a.entityValues)}}function Z(h,B){1&h&&e._UZ(0,"mat-spinner",4)}function G(h,B){if(1&h&&e._UZ(0,"perun-web-apps-attributes-list",23,24),2&h){const a=e.oxw(2);e.Q6J("attributes",a.attributes)("filterValue",a.filterValue)("selection",a.selection)}}function K(h,B){if(1&h){const a=e.EpF();e.TgZ(0,"div")(1,"div",6),e.YNc(2,J,1,3,"perun-web-apps-group-search-select",7),e.YNc(3,b,1,1,"perun-web-apps-resource-search-select",8),e.YNc(4,x,1,1,"perun-web-apps-member-search-select",9),e.YNc(5,c,1,1,"perun-web-apps-facility-search-select",10),e.YNc(6,o,1,1,"perun-web-apps-user-search-select",11),e.qZA(),e.TgZ(7,"perun-web-apps-refresh-button",12),e.NdJ("refresh",function(){e.CHM(a);const m=e.oxw();return e.KtG(m.getAttributes(m.specificSecondEntity.id))}),e.qZA(),e.TgZ(8,"button",13),e.NdJ("click",function(){e.CHM(a);const m=e.oxw();return e.KtG(m.onAdd(m.specificSecondEntity.id))}),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"button",14),e.NdJ("click",function(){e.CHM(a);const m=e.oxw();return e.KtG(m.onSave(m.specificSecondEntity.id))}),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"button",15),e.NdJ("click",function(){e.CHM(a);const m=e.oxw();return e.KtG(m.onDelete(m.specificSecondEntity.id))}),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"perun-web-apps-immediate-filter",16),e.NdJ("filter",function(m){e.CHM(a);const N=e.oxw();return e.KtG(N.applyFilter(m))}),e.qZA(),e.YNc(18,Z,1,0,"mat-spinner",1),e.YNc(19,G,2,3,"perun-web-apps-attributes-list",17),e.qZA()}if(2&h){const a=e.oxw();e.xp6(2),e.Q6J("ngIf","group"===a.secondEntity),e.xp6(1),e.Q6J("ngIf","resource"===a.secondEntity),e.xp6(1),e.Q6J("ngIf","member"===a.secondEntity),e.xp6(1),e.Q6J("ngIf","facility"===a.secondEntity),e.xp6(1),e.Q6J("ngIf","user"===a.secondEntity),e.xp6(3),e.hij(" ",e.lcZ(10,13,"MEMBER_DETAIL.SETTINGS.ATTRIBUTES.CREATE")," "),e.xp6(2),e.Q6J("disabled",0===a.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(13,15,"MEMBER_DETAIL.SETTINGS.ATTRIBUTES.SAVE")," "),e.xp6(2),e.Q6J("disabled",0===a.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(16,17,"MEMBER_DETAIL.SETTINGS.ATTRIBUTES.DELETE")," "),e.xp6(2),e.Q6J("placeholder","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.FILTER"),e.xp6(1),e.Q6J("ngIf",a.innerLoading),e.xp6(1),e.Q6J("ngIf",!a.innerLoading)}}let V=(()=>{class h{constructor(a,r,m,N,Y,Q){this.attributesManagerService=a,this.resourcesManagerService=r,this.facilitiesManagerService=m,this.groupsManagerService=N,this.membersManager=Y,this.dialog=Q,this.entityValues=[],this.attributes=[],this.selection=new I.Ov(!0,[]),this.allowedStatuses=["INVALID","VALID"],this.loading=!1,this.innerLoading=!1,this.filterValue=""}ngOnInit(){this.loadEntityValues(),this.setMessages(this.secondEntity.toLowerCase())}loadEntityValues(){switch(this.loading=!0,this.firstEntity){case"member":switch(this.secondEntity){case"resource":this.resourcesManagerService.getAssignedResourcesWithStatus(this.firstEntityId).subscribe(a=>{this.entityValues=a.map(r=>r.enrichedResource.resource),this.preselectEntity(),this.loading=!1});break;case"group":this.groupsManagerService.getMemberGroups(this.firstEntityId).subscribe(a=>{this.entityValues=a,this.preselectEntity(),this.loading=!1})}break;case"group":switch(this.secondEntity){case"resource":this.resourcesManagerService.getResourceAssignments(this.firstEntityId).subscribe(a=>{this.entityValues=a.map(r=>{const m=r.enrichedResource.resource;return m.status=r.status,m}),this.preselectEntity(),this.loading=!1});break;case"member":this.membersManager.getCompleteRichMembersForGroup(this.firstEntityId,!1,this.allowedStatuses,null,[y.r.MEMBER_CORE_ID]).subscribe(a=>{this.entityValues=a,this.preselectEntity(),this.loading=!1})}break;case"user":this.facilitiesManagerService.getAssignedFacilitiesByUser(this.firstEntityId).subscribe(a=>{this.entityValues=a,this.preselectEntity(),this.loading=!1});break;case"resource":switch(this.secondEntity){case"member":this.resourcesManagerService.getAssignedMembersWithStatus(this.firstEntityId).subscribe(a=>{this.entityValues=a.map(r=>r.richMember),this.preselectEntity(),this.loading=!1});break;case"group":this.resourcesManagerService.getGroupAssignments(this.firstEntityId).subscribe(a=>{this.entityValues=a.map(r=>{const m=r.enrichedGroup.group;return m.status=r.status,m}),this.preselectEntity(),this.loading=!1})}break;case"facility":this.facilitiesManagerService.getAssignedUsers(this.firstEntityId).subscribe(a=>{this.entityValues=a,this.preselectEntity(),this.loading=!1})}}preselectEntity(){0!==this.entityValues.length&&this.findInitiallySelectedEntity()}findInitiallySelectedEntity(){let a=this.entityValues[0];const r=(0,i.vL)(this.entityKey());if(r)for(const m of this.entityValues)if(m.id===r[0]){a=m;break}this.specifySecondEntity(a)}entityKey(){return"group"===this.secondEntity?"groups":""}getAttributes(a){switch(this.innerLoading=!0,this.selection.clear(),this.firstEntity){case"member":switch(this.secondEntity){case"resource":this.attributesManagerService.getMemberResourceAttributes(this.firstEntityId,a).subscribe(r=>{this.attributes=r,this.innerLoading=!1});break;case"group":this.attributesManagerService.getMemberGroupAttributes(this.firstEntityId,a).subscribe(r=>{this.attributes=r,this.innerLoading=!1})}break;case"group":switch(this.secondEntity){case"resource":this.attributesManagerService.getGroupResourceAttributes(this.firstEntityId,a).subscribe(r=>{this.attributes=r,this.innerLoading=!1});break;case"member":this.attributesManagerService.getMemberGroupAttributes(a,this.firstEntityId).subscribe(r=>{this.attributes=r,this.innerLoading=!1})}break;case"user":this.attributesManagerService.getUserFacilityAttributes(this.firstEntityId,a).subscribe(r=>{this.attributes=r,this.innerLoading=!1});break;case"resource":switch(this.secondEntity){case"member":this.attributesManagerService.getMemberResourceAttributes(a,this.firstEntityId).subscribe(r=>{this.attributes=r,this.innerLoading=!1});break;case"group":this.attributesManagerService.getGroupResourceAttributes(a,this.firstEntityId).subscribe(r=>{this.attributes=r,this.innerLoading=!1})}break;case"facility":this.attributesManagerService.getUserFacilityAttributes(a,this.firstEntityId).subscribe(r=>{this.attributes=r,this.innerLoading=!1})}}setMessages(a){this.noEntityMessage=`No ${a} assigned`}onSave(a){this.list.updateMapAttributes();const r=(0,i.kZ)();r.width="450px",r.data={entityId:this.firstEntityId,entity:this.firstEntity,secondEntity:this.secondEntity,secondEntityId:a,attributes:this.selection.selected},this.dialog.open(M.wA,r).afterClosed().subscribe(N=>{N&&(this.selection.clear(),this.getAttributes(a))})}onDelete(a){const r=(0,i.kZ)();r.width="450px",r.data={entityId:this.firstEntityId,entity:this.firstEntity,secondEntity:this.secondEntity,secondEntityId:a,attributes:this.selection.selected,theme:`${this.firstEntity}-theme`},this.dialog.open(g.k,r).afterClosed().subscribe(N=>{N&&(this.selection.clear(),this.getAttributes(a))})}onAdd(a){const r=(0,i.kZ)();r.width="1050px",r.data={entityId:this.firstEntityId,entity:this.firstEntity,secondEntity:this.secondEntity,secondEntityId:a,notEmptyAttributes:this.attributes,style:`${this.firstEntity}-theme`},this.dialog.open(n.n,r).afterClosed().subscribe(N=>{N&&(this.selection.clear(),this.getAttributes(a))})}specifySecondEntity(a){a&&(this.specificSecondEntity=a,this.getAttributes(this.specificSecondEntity.id))}applyFilter(a){this.filterValue=a}}return h.\u0275fac=function(a){return new(a||h)(e.Y36(t.H8),e.Y36(t.xk),e.Y36(t.IQ),e.Y36(t.ff),e.Y36(t.uq),e.Y36(O.uw))},h.\u0275cmp=e.Xpm({type:h,selectors:[["app-two-entity-attribute-page"]],viewQuery:function(a,r){if(1&a&&e.Gf(C,5),2&a){let m;e.iGM(m=e.CRH())&&(r.list=m.first)}},inputs:{firstEntityId:"firstEntityId",firstEntity:"firstEntity",secondEntity:"secondEntity"},decls:4,vars:3,consts:[[1,"mt-3"],["class","ml-auto mr-auto",4,"ngIf"],["alert_type","warn",4,"ngIf"],[4,"ngIf"],[1,"ml-auto","mr-auto"],["alert_type","warn"],[1,"flex-row"],[3,"firstSelectedGroup","displayStatus","groups","groupSelected",4,"ngIf"],[3,"resources","resourceSelected",4,"ngIf"],[3,"members","memberSelected",4,"ngIf"],[3,"facilities","facilitySelected",4,"ngIf"],[3,"users","userSelected",4,"ngIf"],[3,"refresh"],["color","accent","mat-flat-button","",1,"mr-2","action-button",3,"click"],["color","accent","mat-flat-button","",1,"mr-2",3,"disabled","click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[3,"placeholder","filter"],[3,"attributes","filterValue","selection",4,"ngIf"],[3,"firstSelectedGroup","displayStatus","groups","groupSelected"],[3,"resources","resourceSelected"],[3,"members","memberSelected"],[3,"facilities","facilitySelected"],[3,"users","userSelected"],[3,"attributes","filterValue","selection"],["list",""]],template:function(a,r){1&a&&(e.TgZ(0,"div",0),e.YNc(1,P,1,0,"mat-spinner",1),e.YNc(2,F,2,1,"perun-web-apps-alert",2),e.YNc(3,K,20,19,"div",3),e.qZA()),2&a&&(e.xp6(1),e.Q6J("ngIf",r.loading),e.xp6(1),e.Q6J("ngIf",0===r.entityValues.length&&!r.loading),e.xp6(1),e.Q6J("ngIf",0!==r.entityValues.length))},dependencies:[S.O5,T.lW,w.Ou,v.w,A.t,R.L,d.p,D.h,_.L,p,E.R,l.S,U.X$],styles:[".w-35[_ngcontent-%COMP%]{width:35%}"]}),h})()},79707:(W,L,s)=>{s.d(L,{R:()=>i});var t=s(94650),u=s(9244),I=s(89593),g=s(89383);let i=(()=>{class M{constructor(){this.disableAutoSelect=!1,this.selectPlaceholder="SHARED_LIB.PERUN.COMPONENTS.FACILITY_SEARCH_SELECT.SELECT_FACILITY",this.facilitySelected=new t.vpe,this.nameFunction=y=>y.name}ngOnInit(){this.facilities=this.facilities.sort(u.aC)}}return M.\u0275fac=function(y){return new(y||M)},M.\u0275cmp=t.Xpm({type:M,selectors:[["perun-web-apps-facility-search-select"]],inputs:{facilities:"facilities",disableAutoSelect:"disableAutoSelect",selectPlaceholder:"selectPlaceholder"},outputs:{facilitySelected:"facilitySelected"},decls:4,vars:13,consts:[[3,"entities","disableAutoSelect","searchFunction","mainTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","entitySelected"]],template:function(y,e){1&y&&(t.TgZ(0,"perun-web-apps-entity-search-select",0),t.NdJ("entitySelected",function(S){return e.facilitySelected.emit(S)}),t.ALo(1,"translate"),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&y&&t.Q6J("entities",e.facilities)("disableAutoSelect",e.disableAutoSelect)("searchFunction",e.nameFunction)("mainTextFunction",e.nameFunction)("selectPlaceholder",t.lcZ(1,7,e.selectPlaceholder))("findPlaceholder",t.lcZ(2,9,"SHARED_LIB.PERUN.COMPONENTS.FACILITY_SEARCH_SELECT.FIND_FACILITY"))("noEntriesText",t.lcZ(3,11,"SHARED_LIB.PERUN.COMPONENTS.FACILITY_SEARCH_SELECT.NO_FACILITY_FOUND"))},dependencies:[I.i,g.X$]}),M})()},71135:(W,L,s)=>{s.d(L,{L:()=>v});var t=s(94650),u=s(65412),I=s(94364),g=s(36895),i=s(97392),M=s(3238),n=s(34198),y=s(55660),e=s(89383),O=s(64597);const S=function(A){return[A]};function T(A,R){if(1&A&&(t.TgZ(0,"div",3)(1,"a",4),t.NdJ("auxclick",function(D){return D.preventDefault()}),t.ALo(2,"multiWordDataCy"),t.ALo(3,"translate"),t._UZ(4,"mat-icon",5),t._uU(5),t.ALo(6,"translate"),t.qZA()()),2&A){const d=R.$implicit;t.xp6(1),t.Gre("",d.style," item-itself"),t.Q6J("perunWebAppsMiddleClickRouterLink",t.VKq(14,S,d.url))("routerLink",d.url),t.uIk("data-cy",t.lcZ(2,8,t.lcZ(3,10,d.label))),t.xp6(3),t.Q6J("svgIcon",d.cssIcon),t.xp6(1),t.hij(" ",t.lcZ(6,12,d.label)," ")}}function w(A,R){if(1&A&&(t.TgZ(0,"div",1),t.YNc(1,T,7,16,"div",2),t.qZA()),2&A){const d=t.oxw();t.xp6(1),t.Q6J("ngForOf",d.items)}}let v=(()=>{class A{constructor(d,D){this.dialog=d,this.route=D,this.size="large"}ngOnInit(){this.route.params.subscribe(d=>{this.voId=Number(d.voId)})}}return A.\u0275fac=function(d){return new(d||A)(t.Y36(u.uw),t.Y36(I.gz))},A.\u0275cmp=t.Xpm({type:A,selectors:[["perun-web-apps-menu-buttons-field"]],inputs:{items:"items",size:"size"},decls:1,vars:1,consts:[["class","items-container",4,"ngIf"],[1,"items-container"],["class","item-itself-container","mat-ripple","",4,"ngFor","ngForOf"],["mat-ripple","",1,"item-itself-container"],[3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],[1,"item-pic","perun-icon",3,"svgIcon"]],template:function(d,D){1&d&&t.YNc(0,w,2,1,"div",0),2&d&&t.Q6J("ngIf","small"===D.size)},dependencies:[g.sg,g.O5,I.yS,i.Hw,M.wG,n.Y,y.Q,e.X$,O.R],styles:[".items-container[_ngcontent-%COMP%]{display:grid;grid-gap:0;grid-template-columns:repeat(auto-fill,minmax(208px,1fr));margin:0 -8px}@media (max-width: 768px){.items-container[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(148px,1fr))}}.item-pic[_ngcontent-%COMP%]{color:currentColor;transform:scale(3);height:74px;margin-bottom:22px}.item-itself-container[_ngcontent-%COMP%]{margin:8px}.item-itself[_ngcontent-%COMP%]{text-align:center;min-height:186px;height:100%;padding:20px;display:flex;flex-direction:column;align-items:center;font-size:1.25rem}.item-itself[_ngcontent-%COMP%]:hover{text-decoration:none}.item-itself[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:120px;margin-bottom:10px}@media (max-width: 768px){.item-itself[_ngcontent-%COMP%]{min-height:150px;padding:10px}.item-itself[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:80px;margin-bottom:10px}}"]}),A})()}}]);