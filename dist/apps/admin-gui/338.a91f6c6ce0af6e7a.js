"use strict";(self.webpackChunkadmin_gui=self.webpackChunkadmin_gui||[]).push([[338],{54668:(x,N,s)=>{s.d(N,{l:()=>l});var A=s(65412),_=s(32105),O=s(74702),t=s(10036),e=s(95017),R=s(64080),c=s(24006),n=s(94650),v=s(89383),o=s(36895),b=s(59549),P=s(284),M=s(97392),L=s(4859),U=s(51572),D=s(98380),E=s(64877);function I(a,p){if(1&a&&n._UZ(0,"app-users-list",14),2&a){const h=n.oxw(2);n.Q6J("displayedColumns",h.displayedColumns)("selection",h.selection)("tableId",h.tableId)("disableRouting",!0)("users",h.identities)}}function C(a,p){if(1&a&&(n.TgZ(0,"div"),n.YNc(1,I,1,5,"app-users-list",13),n.qZA()),2&a){const h=n.oxw();n.xp6(1),n.Q6J("ngIf",void 0!==h.identities&&h.identities.length>0)}}function d(a,p){1&a&&(n.TgZ(0,"perun-web-apps-alert",15),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&a&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"DIALOGS.CONNECT_IDENTITY.SEARCH_HINT")," "))}function g(a,p){1&a&&(n.TgZ(0,"perun-web-apps-alert",16),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&a&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"DIALOGS.CONNECT_IDENTITY.NO_IDENTITIES")," "))}function u(a,p){1&a&&n._UZ(0,"mat-spinner",17)}let l=(()=>{class a{constructor(h,T,y,B,F,Q){this.dialogRef=h,this.data=T,this.userManager=y,this.storeService=B,this.notificator=F,this.translate=Q,this.loading=!1,this.selection=new e.Ov(!1,[]),this.firstSearchDone=!1,this.displayedColumns=["select","id","user","name","email","logins","organization"],this.tableId=t.Iz}ngOnInit(){this.target=this.data.target,this.theme=this.data.theme,this.userId=this.data.userId,this.isService=this.data.isService,this.searchCtrl=new c.p4("",[c.kI.required,c.kI.pattern(".*[\\S]+.*")])}onAdd(){let h,T;this.loading=!0,this.isService?(h=this.selection.selected[0].id,T=this.userId):(h=this.userId,T=this.selection.selected[0].id),this.userManager.addSpecificUserOwner(h,T).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.CONNECT_IDENTITY.SUCCESS")),this.dialogRef.close(!0)},error:()=>this.loading=!1})}onCancel(){this.dialogRef.close(!1)}onSearchByString(){if(this.searchCtrl.invalid)return void this.searchCtrl.markAllAsTouched();this.loading=!0,this.firstSearchDone=!0;let h=[R.r.USER_DEF_ORGANIZATION,R.r.USER_DEF_PREFERRED_MAIL];h=h.concat(this.storeService.getLoginAttributeNames()),this.userManager.findRichUsersWithAttributes(this.searchCtrl.value,h).subscribe(T=>{this.identities=this.filterIdentities(T),this.loading=!1},()=>{this.loading=!1})}onKeyInput(h){"Enter"===h.key&&this.onSearchByString()}filterIdentities(h){return h.filter(this.isService?T=>!T.serviceUser:T=>T.serviceUser)}}return a.\u0275fac=function(h){return new(h||a)(n.Y36(A.so),n.Y36(A.WI),n.Y36(_.Fv),n.Y36(O.d6),n.Y36(O.V6),n.Y36(v.sK))},a.\u0275cmp=n.Xpm({type:a,selectors:[["app-connect-identity-dialog"]],decls:25,vars:25,consts:[[3,"keyup"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],[1,"mr-2","search-field","no-border-mat-input"],["matInput","","autocomplete","false",3,"placeholder","formControl"],["color","primary","mat-flat-button","",1,"mr-2","search-btn",3,"disabled","click"],[4,"ngIf"],["alert_type","info",4,"ngIf"],["alert_type","warn",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],[3,"displayedColumns","selection","tableId","disableRouting","users",4,"ngIf"],[3,"displayedColumns","selection","tableId","disableRouting","users"],["alert_type","info"],["alert_type","warn"],[1,"ml-auto","mr-auto"]],template:function(h,T){1&h&&(n.TgZ(0,"div",0),n.NdJ("keyup",function(B){return T.onKeyInput(B)}),n.TgZ(1,"h1",1),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"div",2)(5,"mat-form-field",3),n._UZ(6,"input",4),n.ALo(7,"translate"),n.TgZ(8,"mat-error"),n._uU(9),n.ALo(10,"translate"),n.qZA()(),n.TgZ(11,"button",5),n.NdJ("click",function(){return T.onSearchByString()}),n.TgZ(12,"mat-icon"),n._uU(13,"search"),n.qZA()(),n.YNc(14,C,2,1,"div",6),n.YNc(15,d,3,3,"perun-web-apps-alert",7),n.YNc(16,g,3,3,"perun-web-apps-alert",8),n.qZA(),n.YNc(17,u,1,0,"mat-spinner",9),n.TgZ(18,"div",10)(19,"button",11),n.NdJ("click",function(){return T.onCancel()}),n._uU(20),n.ALo(21,"translate"),n.qZA(),n.TgZ(22,"button",12),n.NdJ("click",function(){return T.onAdd()}),n._uU(23),n.ALo(24,"translate"),n.qZA()()()),2&h&&(n.Tol(T.theme),n.xp6(2),n.Oqu(n.lcZ(3,15,"DIALOGS.CONNECT_IDENTITY.TITLE_"+T.target)),n.xp6(4),n.s9C("placeholder",n.lcZ(7,17,"DIALOGS.CONNECT_IDENTITY.SEARCH")),n.Q6J("formControl",T.searchCtrl),n.xp6(3),n.hij(" ",n.lcZ(10,19,"DIALOGS.CONNECT_IDENTITY.EMPTY_SEARCH_MESSAGE")," "),n.xp6(2),n.Q6J("disabled",T.loading),n.xp6(3),n.Q6J("ngIf",!T.loading),n.xp6(1),n.Q6J("ngIf",!T.firstSearchDone),n.xp6(1),n.Q6J("ngIf",!T.loading&&T.firstSearchDone&&0===T.identities.length),n.xp6(1),n.Q6J("ngIf",T.loading),n.xp6(3),n.hij(" ",n.lcZ(21,21,"DIALOGS.CONNECT_IDENTITY.CANCEL")," "),n.xp6(2),n.Q6J("disabled",0===T.selection.selected.length),n.xp6(1),n.hij(" ",n.lcZ(24,23,"DIALOGS.CONNECT_IDENTITY.CONNECT")," "))},dependencies:[o.O5,b.TO,b.KE,P.Nt,c.Fj,c.JJ,c.oH,M.Hw,L.lW,A.uh,A.xY,A.H8,U.Ou,D.w,E.C,v.X$],styles:[".search-field[_ngcontent-%COMP%]{width:300px}.search-btn[_ngcontent-%COMP%]{width:50px}"]}),a})()},94814:(x,N,s)=>{s.d(N,{B:()=>E});var A=s(32105),_=s(65412),O=s(74702),t=s(30671),e=s(94650),R=s(89383),c=s(36895),n=s(4859),v=s(98380),o=s(31359);function b(I,C){1&I&&e._UZ(0,"th",13)}function P(I,C){if(1&I&&(e.TgZ(0,"td",14),e._uU(1),e.ALo(2,"userFullName"),e.qZA()),2&I){const d=C.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,d))}}function M(I,C){1&I&&e._UZ(0,"tr",15)}function L(I,C){1&I&&e._UZ(0,"tr",16)}function U(I,C){1&I&&(e.TgZ(0,"perun-web-apps-alert",17),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&I&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"DIALOGS.DISCONNECT_IDENTITY.WARNING_DISCONNECT_YOURSELF")," "))}function D(I,C){1&I&&(e.TgZ(0,"perun-web-apps-alert",17),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&I&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"DIALOGS.DISCONNECT_IDENTITY.WARNING_LAST_USER")," "))}let E=(()=>{class I{constructor(d,g,u,l,a,p){this.dialogRef=d,this.data=g,this.userManager=u,this.notificator=l,this.translate=a,this.store=p,this.displayedColumns=["name"]}ngOnInit(){let d;this.targetTitle=this.data.targetTitle,this.targetDescription=this.data.targetDescription,this.theme=this.data.theme,this.userId=Number(this.data.userId),this.dataSource=new t.by([this.data.specificUser]),this.isService=this.data.isService,this.isService?(d=this.userId,this.disconnectingSelf=this.dataSource.data[0].id===this.store.getPerunPrincipal().userId):(d=this.dataSource.data[0].id,this.disconnectingSelf=this.userId===this.store.getPerunPrincipal().userId),this.userManager.getUsersBySpecificUser(d).subscribe(g=>{this.disconnectingLastOwner=1===g.length})}onConfirm(){let d,g;this.isService?(d=this.dataSource.data[0].id,g=this.userId):(d=this.userId,g=this.dataSource.data[0].id),this.userManager.removeSpecificUserOwner(d,g).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.DISCONNECT_IDENTITY.SUCCESS")),this.dialogRef.close(!0)})}onCancel(){this.dialogRef.close(!1)}}return I.\u0275fac=function(d){return new(d||I)(e.Y36(_.so),e.Y36(_.WI),e.Y36(A.Fv),e.Y36(O.V6),e.Y36(R.sK),e.Y36(O.d6))},I.\u0275cmp=e.Xpm({type:I,selectors:[["app-disconnect-identity-dialog"]],decls:26,vars:23,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","warn","mat-flat-button","",1,"ml-2",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""],["alert_type","warn"]],template:function(d,g){1&d&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"div")(4,"div",1)(5,"p"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div",2),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"table",3),e.ynx(12,4),e.YNc(13,b,1,0,"th",5),e.YNc(14,P,3,3,"td",6),e.BQk(),e.YNc(15,M,1,0,"tr",7),e.YNc(16,L,1,0,"tr",8),e.qZA(),e.YNc(17,U,3,3,"perun-web-apps-alert",9),e.YNc(18,D,3,3,"perun-web-apps-alert",9),e.qZA(),e.TgZ(19,"div",10)(20,"button",11),e.NdJ("click",function(){return g.onCancel()}),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"button",12),e.NdJ("click",function(){return g.onConfirm()}),e._uU(24),e.ALo(25,"translate"),e.qZA()()()),2&d&&(e.xp6(1),e.Oqu(e.lcZ(2,13,"DIALOGS.DISCONNECT_IDENTITY.TITLE_"+g.targetTitle)),e.xp6(2),e.Tol(g.theme),e.xp6(3),e.Oqu(e.lcZ(7,15,"DIALOGS.DISCONNECT_IDENTITY.DESCRIPTION_"+g.targetDescription)),e.xp6(3),e.hij(" ",e.lcZ(10,17,"DIALOGS.DISCONNECT_IDENTITY.ASK")," "),e.xp6(2),e.Q6J("dataSource",g.dataSource),e.xp6(4),e.Q6J("matHeaderRowDef",g.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",g.displayedColumns),e.xp6(1),e.Q6J("ngIf",g.disconnectingSelf),e.xp6(1),e.Q6J("ngIf",g.disconnectingLastOwner),e.xp6(3),e.hij(" ",e.lcZ(22,19,"DIALOGS.DISCONNECT_IDENTITY.CANCEL")," "),e.xp6(3),e.hij(" ",e.lcZ(25,21,"DIALOGS.DISCONNECT_IDENTITY.REMOVE")," "))},dependencies:[c.O5,n.lW,t.BZ,t.fO,t.as,t.w1,t.Dz,t.nj,t.ge,t.ev,t.XQ,t.Gk,_.uh,_.xY,_.H8,v.w,R.X$,o.d]}),I})()},29862:(x,N,s)=>{s.d(N,{x:()=>D});var A=s(32105),_=s(65412),O=s(74702),t=s(24006),e=s(94650),R=s(89383),c=s(36895),n=s(59549),v=s(284),o=s(4859);function b(E,I){1&E&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&E&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LENGTH")))}function P(E,I){1&E&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&E&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LENGTH")))}function M(E,I){1&E&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&E&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_FIRST_NAME")))}function L(E,I){1&E&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&E&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LENGTH")))}function U(E,I){1&E&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&E&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"DIALOGS.EDIT_USER.ERROR_LAST_NAME")))}let D=(()=>{class E{constructor(C,d,g,u,l){this.dialogRef=C,this.data=d,this.userService=g,this.notificator=u,this.translateService=l,this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.titleBefore=new t.p4(this.data.user.titleBefore,[t.kI.pattern(".*[\\S]+.*"),t.kI.maxLength(129)]),this.titleAfter=new t.p4(this.data.user.titleAfter,[t.kI.pattern(".*[\\S]+.*"),t.kI.maxLength(129)]),this.firstName=new t.p4(this.data.user.firstName,[t.kI.required,t.kI.pattern(".*[\\S]+.*"),t.kI.maxLength(129)]),this.middleName=new t.p4(this.data.user.middleName,[t.kI.pattern(".*[\\S]+.*"),t.kI.maxLength(129)]),this.lastName=new t.p4(this.data.user.lastName,[t.kI.required,t.kI.pattern(".*[\\S]+.*"),t.kI.maxLength(129)])}onCancel(){this.dialogRef.close(!1)}onSave(){this.loading=!0,this.data.user.titleBefore=this.titleBefore.value,this.data.user.titleAfter=this.titleAfter.value,this.data.user.firstName=this.firstName.value,this.data.user.middleName=this.middleName.value,this.data.user.lastName=this.lastName.value,this.userService.updateUser({user:this.data.user}).subscribe(()=>{this.translateService.get("DIALOGS.EDIT_USER.SUCCESS").subscribe(C=>{this.notificator.showSuccess(C),this.dialogRef.close(!0)})},()=>this.loading=!1)}}return E.\u0275fac=function(C){return new(C||E)(e.Y36(_.so),e.Y36(_.WI),e.Y36(A.Fv),e.Y36(O.V6),e.Y36(R.sK))},E.\u0275cmp=e.Xpm({type:E,selectors:[["app-edit-user-dialog"]],decls:32,vars:38,consts:[[1,"mat-dialog-title"],["mat-dialog-content","",1,"dialog-container"],["matInput","",3,"formControl","placeholder"],[4,"ngIf"],["matInput","","data-cy","user-first-name-input","required","",3,"placeholder","formControl"],["matInput","","required","",3,"formControl","placeholder"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","data-cy","user-save-button","mat-flat-button","",1,"ml-2",3,"disabled","click"]],template:function(C,d){1&C&&(e.TgZ(0,"div")(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1)(5,"mat-form-field"),e._UZ(6,"input",2),e.ALo(7,"translate"),e.YNc(8,b,3,3,"mat-error",3),e.qZA(),e.TgZ(9,"mat-form-field"),e._UZ(10,"input",2),e.ALo(11,"translate"),e.YNc(12,P,3,3,"mat-error",3),e.qZA(),e.TgZ(13,"mat-form-field"),e._UZ(14,"input",4),e.ALo(15,"translate"),e.YNc(16,M,3,3,"mat-error",3),e.qZA(),e.TgZ(17,"mat-form-field"),e._UZ(18,"input",2),e.ALo(19,"translate"),e.YNc(20,L,3,3,"mat-error",3),e.qZA(),e.TgZ(21,"mat-form-field"),e._UZ(22,"input",5),e.ALo(23,"translate"),e.YNc(24,U,3,3,"mat-error",3),e.qZA()(),e.TgZ(25,"div",6)(26,"button",7),e.NdJ("click",function(){return d.onCancel()}),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"button",8),e.NdJ("click",function(){return d.onSave()}),e._uU(30),e.ALo(31,"translate"),e.qZA()()()),2&C&&(e.Tol(d.theme),e.xp6(2),e.Oqu(e.lcZ(3,22,"DIALOGS.EDIT_USER.DIALOG_TITLE")),e.xp6(4),e.s9C("placeholder",e.lcZ(7,24,"DIALOGS.EDIT_USER.TITLE_BEFORE")),e.Q6J("formControl",d.titleBefore),e.xp6(2),e.Q6J("ngIf",d.titleBefore.invalid),e.xp6(2),e.s9C("placeholder",e.lcZ(11,26,"DIALOGS.EDIT_USER.TITLE_AFTER")),e.Q6J("formControl",d.titleAfter),e.xp6(2),e.Q6J("ngIf",d.titleAfter.invalid),e.xp6(2),e.s9C("placeholder",e.lcZ(15,28,"DIALOGS.EDIT_USER.FIRST_NAME")),e.Q6J("formControl",d.firstName),e.xp6(2),e.Q6J("ngIf",d.firstName.invalid),e.xp6(2),e.s9C("placeholder",e.lcZ(19,30,"DIALOGS.EDIT_USER.MIDDLE_NAME")),e.Q6J("formControl",d.middleName),e.xp6(2),e.Q6J("ngIf",d.middleName.invalid),e.xp6(2),e.s9C("placeholder",e.lcZ(23,32,"DIALOGS.EDIT_USER.LAST_NAME")),e.Q6J("formControl",d.lastName),e.xp6(2),e.Q6J("ngIf",d.lastName.invalid),e.xp6(3),e.hij(" ",e.lcZ(28,34,"DIALOGS.EDIT_USER.CANCEL")," "),e.xp6(2),e.Q6J("disabled",d.loading||d.firstName.invalid||d.lastName.invalid||d.titleBefore.invalid||d.titleAfter.invalid||d.middleName.invalid),e.xp6(1),e.hij(" ",e.lcZ(31,36,"DIALOGS.EDIT_USER.SAVE")," "))},dependencies:[c.O5,n.TO,n.KE,v.Nt,t.Fj,t.JJ,t.Q7,t.oH,o.lW,_.xY,_.H8,R.X$]}),E})()},98973:(x,N,s)=>{s.d(N,{u:()=>L});var A=s(74702),_=s(94650),O=s(94364),t=s(36895),e=s(3848),R=s(48323),c=s(12651),n=s(89383);function v(U,D){1&U&&(_._uU(0),_.ALo(1,"translate")),2&U&&_.hij(" ",_.lcZ(1,1,"ADMIN_USER.ENTITY")," ")}function o(U,D){if(1&U&&_._UZ(0,"app-one-entity-attribute-page",5),2&U){const E=_.oxw();_.Q6J("entityId",E.userId)("entity","user")}}function b(U,D){1&U&&(_._uU(0),_.ALo(1,"translate"),_.ALo(2,"translate")),2&U&&_.AsE(" ",_.lcZ(1,2,"ADMIN_USER.ENTITY")," - ",_.lcZ(2,4,"FACILITY_DETAIL.ENTITY")," ")}function P(U,D){if(1&U&&_._UZ(0,"app-two-entity-attribute-page",6),2&U){const E=_.oxw(2);_.Q6J("firstEntity","user")("firstEntityId",E.userId)("secondEntity","facility")}}function M(U,D){1&U&&(_.TgZ(0,"mat-tab"),_.YNc(1,b,3,6,"ng-template",2),_.YNc(2,P,1,3,"ng-template",3),_.qZA())}let L=(()=>{class U{constructor(E,I,C){this.route=E,this.store=I,this.authResolver=C}ngOnInit(){this.route.parent.params.subscribe(E=>{this.userId=Number(E.userId),this.userId||(this.userId=this.store.getPerunPrincipal().userId),this.userFacilityAttAuth=this.authResolver.isAuthorized("getAssignedFacilities_User_policy",[{id:this.userId,beanName:"User"}])})}}return U.\u0275fac=function(E){return new(E||U)(_.Y36(O.gz),_.Y36(A.d6),_.Y36(A.x4))},U.\u0275cmp=_.Xpm({type:U,selectors:[["app-user-settings-attributes"]],hostVars:2,hostBindings:function(E,I){2&E&&_.ekj("router-component",I.true)},decls:8,vars:4,consts:[[1,"page-subtitle"],[1,"mb-2"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(E,I){1&E&&(_.TgZ(0,"h1",0),_._uU(1),_.ALo(2,"translate"),_.qZA(),_.TgZ(3,"mat-tab-group")(4,"mat-tab",1),_.YNc(5,v,2,3,"ng-template",2),_.YNc(6,o,1,2,"ng-template",3),_.qZA(),_.YNc(7,M,3,0,"mat-tab",4),_.qZA()),2&E&&(_.xp6(1),_.Oqu(_.lcZ(2,2,"USER_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),_.xp6(6),_.Q6J("ngIf",I.userFacilityAttAuth))},dependencies:[t.O5,e.SP,e.uD,e.uX,e.Vc,R.Y,c.t,n.X$]}),U})()},85985:(x,N,s)=>{s.d(N,{u:()=>d});var A=s(74702),_=s(32105),O=s(10036),t=s(94650),e=s(94364),R=s(36895),c=s(51572),n=s(25788),v=s(96214),o=s(7434),b=s(89383);function P(g,u){1&g&&(t.TgZ(0,"h1",6),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&g&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.YOU_ARE_MEMBER"),"\n"))}function M(g,u){1&g&&(t.TgZ(0,"h1",6),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&g&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.USER_IS_MEMBER"),"\n"))}function L(g,u){1&g&&t._UZ(0,"mat-spinner",7)}const U=function(){return["id","vo","name","description"]};function D(g,u){if(1&g&&t._UZ(0,"perun-web-apps-groups-list",8),2&g){const l=t.oxw();t.Q6J("disableMembers",!1)("groups",l.membersGroups)("displayedColumns",t.DdM(5,U))("filter",l.memberFilterValue)("tableId",l.tableId)}}function E(g,u){1&g&&t._UZ(0,"mat-spinner",7)}function I(g,u){if(1&g&&t._UZ(0,"perun-web-apps-groups-list",8),2&g){const l=t.oxw(2);t.Q6J("disableMembers",!1)("groups",l.adminsGroups)("displayedColumns",t.DdM(5,U))("filter",l.adminFilterValue)("tableId",l.adminTableId)}}function C(g,u){if(1&g){const l=t.EpF();t.TgZ(0,"div",9)(1,"h1",6),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"perun-web-apps-refresh-button",1),t.NdJ("refresh",function(){t.CHM(l);const p=t.oxw();return t.KtG(p.refreshAdminTable())}),t.qZA(),t.TgZ(5,"perun-web-apps-immediate-filter",2),t.NdJ("filter",function(p){t.CHM(l);const h=t.oxw();return t.KtG(h.adminFilter(p))}),t.qZA(),t.YNc(6,E,1,0,"mat-spinner",3),t.YNc(7,I,1,6,"perun-web-apps-groups-list",4),t.qZA()}if(2&g){const l=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,4,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.USER_IS_ADMIN")," "),t.xp6(3),t.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),t.xp6(1),t.Q6J("ngIf",l.adminRefresh),t.xp6(1),t.Q6J("ngIf",!l.adminRefresh)}}let d=(()=>{class g{constructor(l,a,p,h,T){this.usersService=l,this.memberService=a,this.groupService=p,this.store=h,this.route=T,this.memberFilterValue="",this.adminFilterValue="",this.vos=[],this.membersGroups=[],this.adminsGroups=[],this.tableId=O.KE,this.adminTableId=O.Sb}ngOnInit(){(this.showPrincipal=this.route.snapshot.data.showPrincipal)?this.userId=this.store.getPerunPrincipal().user.id:this.route.parent.params.subscribe(l=>this.userId=Number(l.userId)),this.refreshAdminTable(),this.refreshMemberTable()}memberFilter(l){this.memberFilterValue=l}adminFilter(l){this.adminFilterValue=l}refreshAdminTable(){this.adminRefresh=!0,this.usersService.getGroupsWhereUserIsAdmin(this.userId).subscribe(l=>{this.adminsGroups=l,this.adminRefresh=!1})}refreshMemberTable(){this.memberRefresh=!0,this.membersGroups=[],this.usersService.getVosWhereUserIsMember(this.userId).subscribe(l=>{this.vos=l;for(const a of this.vos)this.memberService.getMemberByUser(a.id,this.userId).subscribe(p=>{this.groupService.getMemberGroups(p.id).subscribe(h=>{this.membersGroups=this.membersGroups.concat(h),this.vos.indexOf(a)===this.vos.length-1&&(this.memberRefresh=!1)})});0===l.length&&(this.memberRefresh=!1)})}}return g.\u0275fac=function(l){return new(l||g)(t.Y36(_.Fv),t.Y36(_.uq),t.Y36(_.ff),t.Y36(A.d6),t.Y36(e.gz))},g.\u0275cmp=t.Xpm({type:g,selectors:[["app-user-groups"]],hostVars:2,hostBindings:function(l,a){2&l&&t.ekj("router-component",a.true)},decls:7,vars:6,consts:[["class","page-subtitle",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"disableMembers","groups","displayedColumns","filter","tableId",4,"ngIf"],["class","mt-5",4,"ngIf"],[1,"page-subtitle"],[1,"ml-auto","mr-auto"],[3,"disableMembers","groups","displayedColumns","filter","tableId"],[1,"mt-5"]],template:function(l,a){1&l&&(t.YNc(0,P,3,3,"h1",0),t.YNc(1,M,3,3,"h1",0),t.TgZ(2,"perun-web-apps-refresh-button",1),t.NdJ("refresh",function(){return a.refreshMemberTable()}),t.qZA(),t.TgZ(3,"perun-web-apps-immediate-filter",2),t.NdJ("filter",function(h){return a.memberFilter(h)}),t.qZA(),t.YNc(4,L,1,0,"mat-spinner",3),t.YNc(5,D,1,6,"perun-web-apps-groups-list",4),t.YNc(6,C,8,6,"div",5)),2&l&&(t.Q6J("ngIf",a.showPrincipal),t.xp6(1),t.Q6J("ngIf",!a.showPrincipal),t.xp6(2),t.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),t.xp6(1),t.Q6J("ngIf",a.memberRefresh),t.xp6(1),t.Q6J("ngIf",!a.memberRefresh),t.xp6(1),t.Q6J("ngIf",!a.showPrincipal))},dependencies:[R.O5,c.Ou,n.W,v.t,o.L,b.X$]}),g})()},74837:(x,N,s)=>{s.d(N,{j:()=>C});var A=s(32105),_=s(74702),O=s(10036),t=s(94650),e=s(94364),R=s(36895),c=s(51572),n=s(87831),v=s(96214),o=s(7434),b=s(89383);function P(d,g){1&d&&(t.TgZ(0,"h1",6),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&d&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED_LIB.PERUN.ORGANIZATIONS.YOU_ARE_MEMBER"),"\n"))}function M(d,g){1&d&&(t.TgZ(0,"h1",6),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&d&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED_LIB.PERUN.ORGANIZATIONS.USER_IS_MEMBER"),"\n"))}function L(d,g){1&d&&t._UZ(0,"mat-spinner",7)}function U(d,g){if(1&d&&t._UZ(0,"perun-web-apps-vos-list",8),2&d){const u=t.oxw();t.Q6J("displayedColumns",u.displayedColumns)("tableId",u.memberTableId)("filterValue",u.memberFilterValue)("vos",u.vosWhereIsMember)}}function D(d,g){1&d&&t._UZ(0,"mat-spinner",7)}function E(d,g){if(1&d&&t._UZ(0,"perun-web-apps-vos-list",8),2&d){const u=t.oxw(2);t.Q6J("displayedColumns",u.displayedColumns)("tableId",u.adminTableId)("filterValue",u.adminFilterValue)("vos",u.vosWhereIsAdmin)}}function I(d,g){if(1&d){const u=t.EpF();t.TgZ(0,"div",9)(1,"h1",6),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"perun-web-apps-refresh-button",1),t.NdJ("refresh",function(){t.CHM(u);const a=t.oxw();return t.KtG(a.refreshAdminTable())}),t.qZA(),t.TgZ(5,"perun-web-apps-immediate-filter",2),t.NdJ("filter",function(a){t.CHM(u);const p=t.oxw();return t.KtG(p.applyAdminFilter(a))}),t.qZA(),t.YNc(6,D,1,0,"mat-spinner",3),t.YNc(7,E,1,4,"perun-web-apps-vos-list",4),t.qZA()}if(2&d){const u=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,4,"SHARED_LIB.PERUN.ORGANIZATIONS.USER_IS_ADMIN")),t.xp6(3),t.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),t.xp6(1),t.Q6J("ngIf",u.adminRefresh),t.xp6(1),t.Q6J("ngIf",!u.adminRefresh)}}let C=(()=>{class d{constructor(u,l,a,p){this.usersService=u,this.authResolver=l,this.store=a,this.route=p,this.adminFilterValue="",this.memberFilterValue="",this.displayedColumns=["id","name"],this.adminTableId=O.YF,this.memberTableId=O.gc}ngOnInit(){(this.isMyProfile=this.route.snapshot.data.showPrincipal)?this.userId=this.store.getPerunPrincipal().user.id:this.route.parent.params.subscribe(u=>this.userId=Number(u.userId)),this.refreshAdminTable(),this.refreshMemberTable()}refreshMemberTable(){this.memberRefresh=!0,this.usersService.getVosWhereUserIsMember(this.userId).subscribe(u=>{this.vosWhereIsMember=u,this.memberRefresh=!1},()=>this.memberRefresh=!1)}refreshAdminTable(){this.adminRefresh=!0,this.usersService.getVosWhereUserIsAdmin(this.userId).subscribe(u=>{this.vosWhereIsAdmin=u,this.adminRefresh=!1},()=>this.adminRefresh=!1)}applyMemberFilter(u){this.memberFilterValue=u}applyAdminFilter(u){this.adminFilterValue=u}}return d.\u0275fac=function(u){return new(u||d)(t.Y36(A.Fv),t.Y36(_.x4),t.Y36(_.d6),t.Y36(e.gz))},d.\u0275cmp=t.Xpm({type:d,selectors:[["app-user-organizations"]],hostVars:2,hostBindings:function(u,l){2&u&&t.ekj("router-component",l.true)},decls:7,vars:6,consts:[["class","page-subtitle",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],["class","mr-auto ml-auto",4,"ngIf"],[3,"displayedColumns","tableId","filterValue","vos",4,"ngIf"],["class","mt-5",4,"ngIf"],[1,"page-subtitle"],[1,"mr-auto","ml-auto"],[3,"displayedColumns","tableId","filterValue","vos"],[1,"mt-5"]],template:function(u,l){1&u&&(t.YNc(0,P,3,3,"h1",0),t.YNc(1,M,3,3,"h1",0),t.TgZ(2,"perun-web-apps-refresh-button",1),t.NdJ("refresh",function(){return l.refreshMemberTable()}),t.qZA(),t.TgZ(3,"perun-web-apps-immediate-filter",2),t.NdJ("filter",function(p){return l.applyMemberFilter(p)}),t.qZA(),t.YNc(4,L,1,0,"mat-spinner",3),t.YNc(5,U,1,4,"perun-web-apps-vos-list",4),t.YNc(6,I,8,6,"div",5)),2&u&&(t.Q6J("ngIf",l.isMyProfile),t.xp6(1),t.Q6J("ngIf",!l.isMyProfile),t.xp6(2),t.Q6J("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),t.xp6(1),t.Q6J("ngIf",l.memberRefresh),t.xp6(1),t.Q6J("ngIf",!l.memberRefresh),t.xp6(1),t.Q6J("ngIf",!l.isMyProfile))},dependencies:[R.O5,c.Ou,n.Z,v.t,o.L,b.X$]}),d})()},17755:(x,N,s)=>{s.d(N,{Z:()=>u});var A=s(32105),_=s(30671),O=s(74702),t=s(64080),e=s(9244),R=s(36792),c=s(94650),n=s(94364),v=s(65412),o=s(36895),b=s(97392),P=s(4859),M=s(73546),L=s(71135),U=s(89383);function D(l,a){1&l&&c._UZ(0,"th",12)}function E(l,a){if(1&l&&(c.TgZ(0,"td",13),c._uU(1),c.qZA()),2&l){const p=a.$implicit;c.xp6(1),c.hij(" ",p.displayName,": ")}}function I(l,a){1&l&&c._UZ(0,"th",12)}function C(l,a){if(1&l){const p=c.EpF();c.TgZ(0,"td",14),c._uU(1),c.TgZ(2,"button",15),c.NdJ("click",function(){c.CHM(p);const T=c.oxw(2);return c.KtG(T.changeEmail())}),c.TgZ(3,"mat-icon"),c._uU(4,"edit"),c.qZA()()()}if(2&l){const p=a.$implicit;c.xp6(1),c.hij(" ",p.value," ")}}function d(l,a){1&l&&c._UZ(0,"tr",16)}function g(l,a){if(1&l&&(c.TgZ(0,"div",2)(1,"mat-card",3)(2,"mat-card-header")(3,"mat-card-title")(4,"h1",4),c._uU(5),c.ALo(6,"translate"),c.qZA()()(),c.TgZ(7,"mat-card-content")(8,"table",5),c.ynx(9,6),c.YNc(10,D,1,0,"th",7),c.YNc(11,E,2,1,"td",8),c.BQk(),c.ynx(12,9),c.YNc(13,I,1,0,"th",7),c.YNc(14,C,5,1,"td",10),c.BQk(),c.YNc(15,d,1,0,"tr",11),c.qZA()()()()),2&l){const p=c.oxw();c.xp6(5),c.Oqu(c.lcZ(6,3,"USER_DETAIL.OVERVIEW.GENERAL_SETTINGS")),c.xp6(3),c.Q6J("dataSource",p.mailDataSource),c.xp6(7),c.Q6J("matRowDefColumns",p.displayedColumns)}}let u=(()=>{class l{constructor(p,h,T,y,B){this.userService=p,this.attributeService=h,this.storeService=T,this.route=y,this.dialog=B,this.navItems=[],this.isServiceUser=!1,this.displayedColumns=["name","value"],this.inMyProfile=!1}ngOnInit(){this.route.params.subscribe(p=>{p.userId?this.userService.getUserById(Number(p.userId)).subscribe(h=>{this.user=h,this.isServiceUser=h.serviceUser,this.initNavItems()}):(this.inMyProfile=!0,this.userID=this.storeService.getPerunPrincipal().user.id,this.attributeService.getUserAttributeByName(this.userID,t.r.USER_DEF_PREFERRED_MAIL).subscribe(h=>{this.preferredMail=h,this.handleMailNotDefined(),this.mailDataSource=new _.by([this.preferredMail]),this.initNavItems()}))})}changeEmail(){const p=(0,e.kZ)();p.width="350px",p.data={userId:this.userID},this.dialog.open(R.gr,p).afterClosed().subscribe(T=>{T&&this.attributeService.getUserAttributeByName(this.userID,t.r.USER_DEF_PREFERRED_MAIL).subscribe(y=>{this.preferredMail=y,this.handleMailNotDefined(),this.mailDataSource=new _.by([this.preferredMail])})})}handleMailNotDefined(){null==this.preferredMail&&(this.preferredMail={id:-1,beanName:"Attribute",displayName:(0,e.Cz)(t.r.USER_DEF_PREFERRED_MAIL.split(":").pop()),value:new Object("-")})}initNavItems(){this.navItems=[{cssIcon:"perun-vo",url:"organizations",label:"MENU_ITEMS.ADMIN.ORGANIZATIONS",style:"user-btn"},{cssIcon:"perun-group",url:"groups",label:"MENU_ITEMS.ADMIN.GROUPS",style:"user-btn"}],window.location.pathname.startsWith("/admin")&&this.navItems.push({cssIcon:"perun-user",url:"accounts",label:"MENU_ITEMS.USER.ACCOUNTS",style:"user-btn"},{cssIcon:"perun-identity",url:"identities",label:"MENU_ITEMS.USER.IDENTITIES",style:"user-btn"},{cssIcon:"perun-facility-white",url:"facilities",label:"MENU_ITEMS.USER.FACILITIES",style:"user-btn"},{cssIcon:"perun-resource",url:"resources",label:"MENU_ITEMS.USER.RESOURCES",style:"user-btn"}),this.navItems.push({cssIcon:"perun-attributes",url:"attributes",label:"MENU_ITEMS.USER.ATTRIBUTES",style:"user-btn"}),this.navItems.push({cssIcon:"perun-roles",url:"roles",label:"MENU_ITEMS.USER.ROLES",style:"user-btn"}),this.navItems.push(this.isServiceUser?{cssIcon:"perun-manager",url:"associated-users",label:"MENU_ITEMS.USER.ASSOCIATED_USERS",style:"user-btn"}:{cssIcon:"perun-service-identity",url:"service-identities",label:"MENU_ITEMS.USER.SERVICE_IDENTITIES",style:"user-btn"}),window.location.pathname.startsWith("/admin")||this.navItems.push({cssIcon:"perun-settings2",url:"settings",label:"MENU_ITEMS.ADMIN.SETTINGS",style:"user-btn"})}}return l.\u0275fac=function(p){return new(p||l)(c.Y36(A.Fv),c.Y36(A.H8),c.Y36(O.d6),c.Y36(n.gz),c.Y36(v.uw))},l.\u0275cmp=c.Xpm({type:l,selectors:[["app-user-overview"]],hostVars:2,hostBindings:function(p,h){2&p&&c.ekj("router-component",h.true)},decls:2,vars:3,consts:[["class","align-cards",4,"ngIf"],[3,"items","size"],[1,"align-cards"],[1,"mat-elevation-z3"],[1,"page-subtitle"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["class","font-weight-bold","mat-cell","",4,"matCellDef"],["matColumnDef","value"],["mat-cell","",4,"matCellDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"font-weight-bold"],["mat-cell",""],["mat-icon-button","",1,"ml-3",3,"click"],["mat-row",""]],template:function(p,h){1&p&&(c.YNc(0,g,16,5,"div",0),c._UZ(1,"perun-web-apps-menu-buttons-field",1)),2&p&&(c.Q6J("ngIf",h.inMyProfile),c.xp6(1),c.Q6J("items",h.navItems)("size","small"))},dependencies:[o.O5,b.Hw,P.lW,_.BZ,_.fO,_.w1,_.Dz,_.nj,_.ge,_.ev,_.Gk,M.a8,M.dk,M.dn,M.n5,L.L,U.X$],styles:[".align-cards[_ngcontent-%COMP%]{margin:1rem;display:inline-block;vertical-align:top}"]}),l})()},6097:(x,N,s)=>{s.d(N,{t:()=>R});var A=s(32105),_=s(74702),O=s(94650),t=s(94364),e=s(79394);let R=(()=>{class c{constructor(v,o,b){this.authzResolverService=v,this.route=o,this.store=b,this.roles=new Map,this.roleNames=[],this.roleFilter=["SELF","GROUPADMIN","VOADMIN","RESOURCEADMIN","FACILITYADMIN","TOPGROUPCREATOR","SPONSORSHIP","SPONSOR","RESOURCESELFSERVICE","VOOBSERVER","RESOURCEOBSERVER","GROUPOBSERVER","TRUSTEDFACILITYADMIN","FACILITYOBSERVER","PERUNADMIN","PERUNOBSERVER","MEMBERSHIP","GROUPMEMBERSHIPMANAGER"]}ngOnInit(){this.getData()}getData(){this.outerLoading=!0,this.showDescription=!0,this.roles.clear(),this.route.parent.params.subscribe(v=>{if(v.userId)this.userId=Number(v.userId),this.authzResolverService.getUserRoles(this.userId).subscribe(o=>{this.roleNames=Object.keys(o).map(b=>b.toUpperCase()),this.entityType="USER",this.prepareRoles(o)});else{const o=this.store.getPerunPrincipal();this.userId=o.userId,this.roleNames=Object.keys(o.roles),this.entityType="SELF",this.prepareRoles(o.roles)}})}prepareRoles(v){this.roleNames.forEach(o=>{const b=new Map;Object.keys(v[o]).forEach(M=>{b.set(M,v[o][M])}),this.roles.set(o,b)}),this.roleNames=this.roleNames.filter(o=>!this.roleFilter.includes(o)),this.outerLoading=!1}}return c.\u0275fac=function(v){return new(v||c)(O.Y36(A.Ct),O.Y36(t.gz),O.Y36(_.d6))},c.\u0275cmp=O.Xpm({type:c,selectors:[["app-user-roles"]],hostVars:2,hostBindings:function(v,o){2&v&&O.ekj("router-component",o.true)},decls:1,vars:6,consts:[[3,"outerLoading","roles","roleNames","entityId","showDescription","entityType","reload"]],template:function(v,o){1&v&&(O.TgZ(0,"app-perun-web-apps-roles-page",0),O.NdJ("reload",function(){return o.getData()}),O.qZA()),2&v&&O.Q6J("outerLoading",o.outerLoading)("roles",o.roles)("roleNames",o.roleNames)("entityId",o.userId)("showDescription",o.showDescription)("entityType",o.entityType)},dependencies:[e._]}),c})()},46597:(x,N,s)=>{s.d(N,{d:()=>g});var A=s(10036),_=s(32105),O=s(95017),t=s(9244),e=s(54668),R=s(94814),c=s(74702),n=s(54004),v=s(63900),o=s(94650),b=s(65412),P=s(94364),M=s(36895),L=s(4859),U=s(51572),D=s(96214),E=s(64877),I=s(89383);function C(u,l){if(1&u&&(o._UZ(0,"app-users-list",6),o.ALo(1,"translate")),2&u){const a=o.oxw();o.Q6J("noUsersFoundLabel",o.lcZ(1,6,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.NO_ASSOCIATED_USERS"))("disableRouting",a.disableRouting)("displayedColumns",a.displayedColumns)("selection",a.selection)("tableId",a.tableId)("users",a.associatedUsers)}}function d(u,l){1&u&&o._UZ(0,"mat-spinner",7)}let g=(()=>{class u{constructor(a,p,h,T,y){this.dialog=a,this.router=p,this.authResolver=h,this.userManager=T,this.entityStorageService=y,this.loading=!1,this.selection=new O.Ov(!1,[]),this.associatedUsers=[],this.tableId=A.It,this.displayedColumns=["select","id","user","name","email","logins","organization"]}ngOnInit(){this.loading=!0,this.user=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.userManager.getUsersBySpecificUser(this.user.id).pipe((0,n.U)(a=>a.map(p=>p.id)),(0,v.w)(a=>this.userManager.getRichUsersWithAttributesByIds(a))).subscribe(a=>{this.associatedUsers=a,this.selection.clear(),this.setAuth(),this.loading=!1})}setAuth(){this.addAuth=this.authResolver.isAuthorized("addSpecificUserOwner_User_User_policy",[this.user]),this.removeAuth=this.authResolver.isAuthorized("removeSpecificUserOwner_User_User_policy",[this.user]),this.disableRouting=!this.authResolver.isPerunAdminOrObserver()}onAdd(){const a=(0,t.kZ)();a.width="1250px",a.data={userId:this.user.id,theme:"user-theme",isService:!0,target:"USER"},this.dialog.open(e.l,a).afterClosed().subscribe(h=>{h&&this.refreshTable()})}onRemove(){const a=(0,t.kZ)();a.width="650px",a.data={identities:this.selection.selected,userId:this.user.id,specificUser:this.selection.selected[0],isService:!0,theme:"user-theme",targetTitle:"USER",targetDescription:"SERVICE"},this.dialog.open(R.B,a).afterClosed().subscribe(h=>{h&&(this.authResolver.isAuthorized("getUsersBySpecificUser_User_policy",[this.user])?this.refreshTable():this.router.navigate(["/myProfile"]))})}}return u.\u0275fac=function(a){return new(a||u)(o.Y36(b.uw),o.Y36(P.F0),o.Y36(c.x4),o.Y36(_.Fv),o.Y36(c.fb))},u.\u0275cmp=o.Xpm({type:u,selectors:[["app-user-settings-associated-users"]],decls:13,vars:12,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"mr-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[3,"noUsersFoundLabel","disableRouting","displayedColumns","selection","tableId","users",4,"ngIf"],["class","mr-auto ml-auto",4,"ngIf"],[3,"noUsersFoundLabel","disableRouting","displayedColumns","selection","tableId","users"],[1,"mr-auto","ml-auto"]],template:function(a,p){1&a&&(o.TgZ(0,"div")(1,"h1",0),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"perun-web-apps-refresh-button",1),o.NdJ("refresh",function(){return p.refreshTable()}),o.qZA(),o.TgZ(5,"button",2),o.NdJ("click",function(){return p.onAdd()}),o._uU(6),o.ALo(7,"translate"),o.qZA(),o.TgZ(8,"button",3),o.NdJ("click",function(){return p.onRemove()}),o._uU(9),o.ALo(10,"translate"),o.qZA(),o.YNc(11,C,2,8,"app-users-list",4),o.qZA(),o.YNc(12,d,1,0,"mat-spinner",5)),2&a&&(o.xp6(2),o.Oqu(o.lcZ(3,6,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.TITLE")),o.xp6(4),o.hij(" ",o.lcZ(7,8,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.ADD")," "),o.xp6(2),o.Q6J("disabled",0===p.selection.selected.length),o.xp6(1),o.hij(" ",o.lcZ(10,10,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.REMOVE")," "),o.xp6(2),o.Q6J("ngIf",!p.loading),o.xp6(1),o.Q6J("ngIf",p.loading))},dependencies:[M.O5,L.lW,U.Ou,D.t,E.C,I.X$]}),u})()},97453:(x,N,s)=>{s.d(N,{R:()=>g});var A=s(95017),_=s(32105),O=s(10036),t=s(9244),e=s(54668),R=s(94814),c=s(74702),n=s(94650),v=s(94364),o=s(65412),b=s(36895),P=s(4859),M=s(51572),L=s(96214),U=s(64877),D=s(89383);function E(u,l){if(1&u){const a=n.EpF();n.TgZ(0,"button",6),n.NdJ("click",function(){n.CHM(a);const h=n.oxw();return n.KtG(h.onAdd())}),n._uU(1),n.ALo(2,"translate"),n.qZA()}2&u&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.CREATE"),"\n"))}function I(u,l){if(1&u){const a=n.EpF();n.TgZ(0,"button",7),n.NdJ("click",function(){n.CHM(a);const h=n.oxw();return n.KtG(h.onRemove())}),n._uU(1),n.ALo(2,"translate"),n.qZA()}if(2&u){const a=n.oxw();n.Q6J("disabled",0===a.selection.selected.length),n.xp6(1),n.hij(" ",n.lcZ(2,2,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.DELETE"),"\n")}}function C(u,l){1&u&&n._UZ(0,"mat-spinner",8)}function d(u,l){if(1&u&&(n._UZ(0,"app-users-list",9),n.ALo(1,"translate")),2&u){const a=n.oxw();n.Q6J("noUsersFoundLabel",n.lcZ(1,6,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.NO_IDENTITIES"))("displayedColumns",a.displayedColumns)("selection",a.selection)("tableId",a.tableId)("routeToAdmin",a.routeToAdminSection)("users",a.identities)}}let g=(()=>{class u{constructor(a,p,h,T,y,B){this.route=a,this.dialog=p,this.router=h,this.userManager=T,this.authResolver=y,this.store=B,this.loading=!1,this.selection=new A.Ov(!1,[]),this.identities=[],this.tableId=O.Iz,this.displayedColumns=["select","id","user","name"],this.routeToAdminSection=!0,this.targetTitle="SERVICE",this.targetDescription="SERVICE"}ngOnInit(){this.loading=!0,this.route.parent.params.subscribe(a=>{this.userId=Number(a.userId),this.userId||(this.targetTitle="SERVICE",this.targetDescription="SELF",this.userId=this.store.getPerunPrincipal().userId,this.routeToAdminSection=!1),this.setAuthRights(),this.refreshTable()})}refreshTable(){this.loading=!0,this.userManager.getSpecificUsersByUser(this.userId).subscribe(a=>{this.identities=a,this.selection.clear(),this.loading=!1})}setAuthRights(){this.addIdentity=this.authResolver.isPerunAdmin(),this.removeIdentity=this.authResolver.isAuthorized("removeSpecificUserOwner_User_User_policy",[{id:this.userId,beanName:"User"}])}onAdd(){const a=(0,t.kZ)();a.width="1250px",a.data={userId:this.userId,theme:"user-theme",isService:!1,target:this.targetTitle},this.dialog.open(e.l,a).afterClosed().subscribe(h=>{h&&this.refreshTable()})}onRemove(){const a=(0,t.kZ)();a.width="650px",a.data={identities:this.selection.selected,userId:this.userId,specificUser:this.selection.selected[0],theme:"user-theme",targetTitle:this.targetTitle,targetDescription:this.targetDescription},this.dialog.open(R.B,a).afterClosed().subscribe(h=>{h&&this.refreshTable()})}}return u.\u0275fac=function(a){return new(a||u)(n.Y36(v.gz),n.Y36(o.uw),n.Y36(v.F0),n.Y36(_.Fv),n.Y36(c.x4),n.Y36(c.d6))},u.\u0275cmp=n.Xpm({type:u,selectors:[["app-user-settings-service-identities"]],decls:8,vars:7,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","class","mr-2 action-button","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","class","mr-2","mat-flat-button","",3,"disabled","click",4,"ngIf"],["class","mr-auto ml-auto",4,"ngIf"],[3,"noUsersFoundLabel","displayedColumns","selection","tableId","routeToAdmin","users",4,"ngIf"],["color","accent","mat-flat-button","",1,"mr-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],[3,"noUsersFoundLabel","displayedColumns","selection","tableId","routeToAdmin","users"]],template:function(a,p){1&a&&(n.TgZ(0,"h1",0),n._uU(1),n.ALo(2,"translate"),n.qZA(),n.TgZ(3,"perun-web-apps-refresh-button",1),n.NdJ("refresh",function(){return p.refreshTable()}),n.qZA(),n.YNc(4,E,3,3,"button",2),n.YNc(5,I,3,4,"button",3),n.YNc(6,C,1,0,"mat-spinner",4),n.YNc(7,d,2,8,"app-users-list",5)),2&a&&(n.xp6(1),n.Oqu(n.lcZ(2,5,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.TITLE")),n.xp6(3),n.Q6J("ngIf",p.addIdentity),n.xp6(1),n.Q6J("ngIf",p.removeIdentity),n.xp6(1),n.Q6J("ngIf",p.loading),n.xp6(1),n.Q6J("ngIf",!p.loading))},dependencies:[b.O5,P.lW,M.Ou,L.t,U.C,D.X$]}),u})()},38338:(x,N,s)=>{s.r(N),s.d(N,{UsersModule:()=>at});var A=s(36895),_=s(94364),O=s(74837),t=s(85985),e=s(94650),R=s(61283);let c=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-settings"]],hostVars:2,hostBindings:function(i,m){2&i&&e.ekj("router-component",m.true)},decls:1,vars:0,template:function(i,m){1&i&&e._UZ(0,"app-animated-router-outlet")},dependencies:[R.A]}),r})();var n=s(32105),v=s(51572),o=s(71135);function b(r,f){1&r&&e._UZ(0,"mat-spinner",2)}function P(r,f){if(1&r&&(e.TgZ(0,"div"),e._UZ(1,"perun-web-apps-menu-buttons-field",3),e.qZA()),2&r){const i=e.oxw();e.xp6(1),e.Q6J("items",i.navItems)("size","small")}}let M=(()=>{class r{constructor(i,m){this.route=i,this.userManager=m,this.navItems=[],this.loading=!1}ngOnInit(){window.location.pathname.startsWith("/admin")?(this.loading=!0,this.route.parent.parent.params.subscribe(i=>{const m=Number(i.userId);this.userManager.getUserById(m).subscribe(S=>{this.isServiceUser=S.serviceUser,this.initNavItems(),this.loading=!1},()=>this.loading=!1)})):this.initNavItems()}initNavItems(){this.navItems=[],window.location.pathname.startsWith("/admin")||this.navItems.push({cssIcon:"perun-settings2",url:"passwordReset",label:"MENU_ITEMS.USER.PASSWORD_RESET",style:"user-btn"},{cssIcon:"perun-settings1",url:"guiConfig",label:"MENU_ITEMS.USER.GUI_CONFIG",style:"user-btn"})}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(_.gz),e.Y36(n.Fv))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-settings-overview"]],hostVars:2,hostBindings:function(i,m){2&i&&e.ekj("router-component",m.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(i,m){1&i&&(e.YNc(0,b,1,0,"mat-spinner",0),e.YNc(1,P,2,2,"div",1)),2&i&&(e.Q6J("ngIf",m.loading),e.xp6(1),e.Q6J("ngIf",!m.loading))},dependencies:[A.O5,v.Ou,o.L]}),r})();var L=s(98973),U=s(85147),D=s(9244),E=s(6335),I=s(3238),C=s(59549),d=s(84385),g=s(89383);function u(r,f){if(1&r&&(e.TgZ(0,"mat-option",5),e._uU(1),e.qZA()),2&r){const i=f.$implicit;e.Q6J("value",i),e.xp6(1),e.hij(" ",i," ")}}let l=(()=>{class r{constructor(i){this.guiConfigService=i,this.tablePageSizeOptions=D.f7}ngOnInit(){this.preferredTablePageSize=this.guiConfigService.getNumber(E.Rc)}updatePreferredTablePageSize(){this.guiConfigService.setNumber(E.Rc,this.preferredTablePageSize)}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(E.Ng))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-settings-app-configuration"]],decls:10,vars:8,consts:[[1,"page-subtitle"],[1,"col-12","col-lg-6","p-0"],[1,"w-100"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,m){1&i&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"div",1)(4,"mat-form-field",2)(5,"mat-label"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"mat-select",3),e.NdJ("valueChange",function(){return m.updatePreferredTablePageSize()})("valueChange",function(Z){return m.preferredTablePageSize=Z}),e.YNc(9,u,2,2,"mat-option",4),e.qZA()()()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,4,"USER_DETAIL.SETTINGS.GUI_CONFIG.TITLE")),e.xp6(5),e.Oqu(e.lcZ(7,6,"USER_DETAIL.SETTINGS.GUI_CONFIG.PREF_TABLE_PAGE_SIZE")),e.xp6(2),e.Q6J("value",m.preferredTablePageSize),e.xp6(1),e.Q6J("ngForOf",m.tablePageSizeOptions))},dependencies:[A.sg,I.ey,C.KE,C.hX,d.gD,g.X$]}),r})();var a=s(17755),p=s(74702),h=s(77968),T=s(97392),y=s(10266),B=s(4235),F=s(31359);const Q=function(){return{color:"black"}},V=function(){return["/myProfile"]};function j(r,f){if(1&r&&(e.TgZ(0,"div",1),e._UZ(1,"perun-web-apps-back-button"),e.TgZ(2,"div",2),e._UZ(3,"mat-icon",3),e.ALo(4,"translate"),e.TgZ(5,"div",4)(6,"div",5)(7,"a",6),e._uU(8),e.ALo(9,"userFullName"),e.qZA(),e.TgZ(10,"span",7),e._uU(11),e.qZA()(),e.TgZ(12,"span",8),e._uU(13),e.ALo(14,"translate"),e.ALo(15,"translate"),e.qZA()()(),e._UZ(16,"app-animated-router-outlet"),e.qZA()),2&r){const i=e.oxw();e.xp6(3),e.s9C("matTooltip",e.lcZ(4,8,"MENU_ITEMS.USER.ENTITY")),e.Q6J("ngStyle",e.DdM(16,Q)),e.xp6(4),e.Q6J("routerLink",e.DdM(17,V)),e.xp6(1),e.hij(" ",e.lcZ(9,10,i.user)," "),e.xp6(3),e.hij(" \xa0#",i.user.id," "),e.xp6(2),e.lnq(" ",e.lcZ(14,12,"MENU_ITEMS.USER.ENTITY"),", ",e.lcZ(15,14,"MENU_ITEMS.USER.USER_TYPE"),": ",i.getUserType()," ")}}let X=(()=>{class r{constructor(i,m,S){this.sideMenuService=i,this.store=m,this.router=S}ngOnInit(){this.path=this.router.url,this.router.events.subscribe(()=>{this.path=this.router.url}),this.principal=this.store.getPerunPrincipal(),this.user=this.principal.user,this.sideMenuService.setUserItems([])}getUserType(){return this.user.serviceUser?"Service":"Person"}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(h.D),e.Y36(p.d6),e.Y36(_.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-user-profile"]],decls:1,vars:1,consts:[["class","container-fluid pl-xl-5 pr-xl-5 user-theme",4,"ngIf"],[1,"container-fluid","pl-xl-5","pr-xl-5","user-theme"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-user-dark",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],["queryParamsHandling","merge",1,"user-link",3,"routerLink"],[1,"text-muted"],[1,"mt-1","entity-info"]],template:function(i,m){1&i&&e.YNc(0,j,17,18,"div",0),2&i&&e.Q6J("ngIf",void 0!==m.user)},dependencies:[A.O5,A.PC,_.yS,T.Hw,y.gM,B.W,R.A,g.X$,F.d]}),r})();var $=s(6097),k=s(97453),q=s(69024),ee=s(29862),G=s(65412),K=s(4859);function te(r,f){1&r&&e._UZ(0,"mat-spinner",11)}function se(r,f){if(1&r){const i=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(i);const S=e.oxw(2);return e.KtG(S.editUser())}),e.TgZ(1,"mat-icon"),e._uU(2,"edit"),e.qZA()()}}const ne=function(){return{color:"black"}},ie=function(r){return["/myProfile/service-identities",r]};function re(r,f){if(1&r&&(e.TgZ(0,"div",1),e._UZ(1,"perun-web-apps-back-button"),e.YNc(2,te,1,0,"mat-spinner",2),e.TgZ(3,"div",3),e._UZ(4,"mat-icon",4),e.ALo(5,"translate"),e.TgZ(6,"div",5)(7,"div",6)(8,"a",7),e._uU(9),e.ALo(10,"userFullName"),e.qZA(),e.TgZ(11,"span",8),e._uU(12),e.qZA(),e.YNc(13,se,3,0,"button",9),e.qZA(),e.TgZ(14,"div"),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"span",10),e._uU(18),e.ALo(19,"translate"),e.ALo(20,"translate"),e.qZA()()(),e._UZ(21,"app-animated-router-outlet"),e.qZA()),2&r){const i=e.oxw();e.xp6(2),e.Q6J("ngIf",i.loading),e.xp6(2),e.s9C("matTooltip",e.lcZ(5,12,"MENU_ITEMS.USER.ENTITY")),e.Q6J("ngStyle",e.DdM(22,ne)),e.xp6(4),e.Q6J("routerLink",e.VKq(23,ie,i.user.id)),e.xp6(1),e.hij(" ",e.lcZ(10,14,i.user)," "),e.xp6(3),e.hij(" \xa0#",i.user.id," "),e.xp6(1),e.Q6J("ngIf",i.authResolver.isPerunAdmin()),e.xp6(2),e.AsE("",e.lcZ(16,16,"ADMIN_USER.UUID"),": ",i.user.uuid,""),e.xp6(3),e.lnq(" ",e.lcZ(19,18,"MENU_ITEMS.USER.ENTITY"),", ",e.lcZ(20,20,"MENU_ITEMS.USER.USER_TYPE"),": ",i.getUserType()," ")}}let ae=(()=>{class r{constructor(i,m,S,Z,W,w,J){this.sideMenuService=i,this.usersService=m,this.sideMenuItemService=S,this.route=Z,this.dialog=W,this.authResolver=w,this.entityStorageService=J,this.loading=!1}ngOnInit(){this.loading=!0,this.route.params.subscribe(i=>{const m=Number(i.userId);this.entityStorageService.setEntity({id:m,beanName:"User"}),this.usersService.getUserById(m).subscribe(S=>{this.user=S;const Z=this.sideMenuItemService.parseServiceIdentity(S);this.sideMenuService.setUserItems([Z]),this.loading=!1},()=>this.loading=!1)})}getUserType(){return this.user.serviceUser?"Service":"Person"}editUser(){const i=(0,D.kZ)();i.width="450px",i.data={theme:"admin-theme",user:this.user},this.dialog.open(ee.x,i).afterClosed().subscribe(S=>{S&&this.usersService.getUserById(this.user.id).subscribe(Z=>{this.user=Z})})}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(h.D),e.Y36(n.Fv),e.Y36(q.V),e.Y36(_.gz),e.Y36(G.uw),e.Y36(p.x4),e.Y36(p.fb))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-detail-page"]],decls:1,vars:1,consts:[["class","container-fluid pl-xl-5 pr-xl-5 user-theme",4,"ngIf"],[1,"container-fluid","pl-xl-5","pr-xl-5","user-theme"],["class","mr-auto ml-auto",4,"ngIf"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-service-identity",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],["queryParamsHandling","merge",1,"user-link",3,"routerLink"],[1,"text-muted"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"mt-1","entity-info"],[1,"mr-auto","ml-auto"],["mat-icon-button","",3,"click"]],template:function(i,m){1&i&&e.YNc(0,re,22,25,"div",0),2&i&&e.Q6J("ngIf",void 0!==m.user)},dependencies:[A.O5,A.PC,_.yS,T.Hw,K.lW,v.Ou,y.gM,B.W,R.A,g.X$,F.d]}),r})(),oe=(()=>{class r{constructor(){this.navItems=[]}ngOnInit(){this.initNavItems()}initNavItems(){this.navItems=[{cssIcon:"perun-manager",url:"associated-users",label:"MENU_ITEMS.USER.ASSOCIATED_USERS",style:"user-btn"},{cssIcon:"perun-notification",url:"mailing-lists",label:"MENU_ITEMS.USER.MAILING_LISTS",style:"user-btn"},{cssIcon:"perun-statistics",url:"data-quotas",label:"MENU_ITEMS.USER.DATA_QUOTAS",style:"user-btn"},{cssIcon:"perun-authentication",url:"authentication",label:"MENU_ITEMS.USER.AUTHENTICATION",style:"user-btn"}]}}return r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-overview"]],decls:1,vars:2,consts:[[3,"items","size"]],template:function(i,m){1&i&&e._UZ(0,"perun-web-apps-menu-buttons-field",0),2&i&&e.Q6J("items",m.navItems)("size","small")},dependencies:[o.L]}),r})();var le=s(46597),ce=s(74006);let _e=(()=>{class r{constructor(i){this.entityStorageService=i}ngOnInit(){this.user=this.entityStorageService.getEntity()}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(p.fb))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-user-settings-mailing-lists"]],decls:1,vars:2,consts:[[3,"user","isService"]],template:function(i,m){1&i&&e._UZ(0,"perun-web-apps-mailing-lists",0),2&i&&e.Q6J("user",m.user)("isService",!0)},dependencies:[ce.E]}),r})();var ue=s(2541);let pe=(()=>{class r{constructor(i){this.entityStorageService=i}ngOnInit(){this.user=this.entityStorageService.getEntity()}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(p.fb))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-user-settings-data-quotas"]],decls:1,vars:1,consts:[[3,"user"]],template:function(i,m){1&i&&e._UZ(0,"perun-web-apps-data-quotas",0),2&i&&e.Q6J("user",m.user)},dependencies:[ue.m]}),r})(),me=(()=>{class r{constructor(){this.navItems=[]}ngOnInit(){this.initNavItems()}initNavItems(){this.navItems=[{cssIcon:"perun-logins",url:"logins",label:"MENU_ITEMS.USER.LOGINS",style:"user-btn"},{cssIcon:"perun-certificates",url:"certificates",label:"MENU_ITEMS.USER.CERTIFICATES",style:"user-btn"},{cssIcon:"perun-key",url:"ssh-keys",label:"MENU_ITEMS.USER.SSH_KEYS",style:"user-btn"}]}}return r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-authentication-overview"]],decls:1,vars:2,consts:[[3,"items","size"]],template:function(i,m){1&i&&e._UZ(0,"perun-web-apps-menu-buttons-field",0),2&i&&e.Q6J("items",m.navItems)("size","small")},dependencies:[o.L]}),r})();var Y=s(24006),de=s(28499),ge=s(95406);function he(r,f){if(1&r&&(e.TgZ(0,"div",7),e._UZ(1,"app-login-password-form-with-generate-option",8),e.qZA()),2&r){const i=e.oxw();e.xp6(1),e.Q6J("formGroup",i.formGroup)("filteredNamespace",i.data.filteredNamespaces)}}function fe(r,f){1&r&&e._UZ(0,"mat-spinner",9)}let Ee=(()=>{class r{constructor(i,m,S,Z,W,w,J,ot,lt,ct){this.dialogRef=i,this.data=m,this.formBuilder=S,this.usersManagerService=Z,this.membersManagerService=W,this.attributesManagerService=w,this.apiRequestConfiguration=J,this.notificator=ot,this.translate=lt,this.cd=ct,this.processing=!1}ngOnInit(){this.userId=this.data.userId,this.formGroup=this.formBuilder.group({namespaceCtrl:["Not selected"],loginCtrl:["",[Y.kI.pattern("^[a-z][a-z0-9_-]+$"),Y.kI.maxLength(15),Y.kI.minLength(2)]],passwordCtrl:["",Y.kI.required,[(0,de.yT)(null,this.usersManagerService,this.apiRequestConfiguration)]],passwordAgainCtrl:[""],generatePasswordCtrl:[!0]},{validators:D.dN.passwordMatchValidator})}ngAfterViewInit(){this.cd.detectChanges()}onSetLogin(){this.processing=!0;const i=this.formGroup.get("namespaceCtrl").value.toLowerCase(),m=this.formGroup.get("loginCtrl").value;if(m)this.setLogin(i,m);else{const S=`urn:perun:user:attribute-def:def:login-namespace:${i}`;this.attributesManagerService.getUserAttributeByName(this.userId,"urn:perun:user:attribute-def:core:lastName").subscribe(Z=>{this.usersManagerService.generateAccountForName(i,Z.value).subscribe(w=>{this.setLogin(i,w[S])},()=>this.processing=!1)})}}setLogin(i,m){this.usersManagerService.setLogin(this.userId,m,i).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.SET_LOGIN.SUCCESS_LOGIN")),this.setPassword()},()=>{this.processing=!1})}setPassword(){const i=this.formGroup.get("namespaceCtrl").value.toLowerCase(),m=this.formGroup.get("passwordCtrl").value;if(this.formGroup.get("generatePasswordCtrl").value){if(!this.formGroup.get("loginCtrl").value)return;this.usersManagerService.reserveRandomPassword(this.userId,i).subscribe(()=>{this.usersManagerService.validatePasswordForUser(this.userId,i).subscribe(()=>{this.dialogRef.close(!0)},()=>{this.processing=!1})},()=>{this.processing=!1})}else this.usersManagerService.reservePasswordForUser({user:this.userId,namespace:i,password:m}).subscribe(()=>{this.usersManagerService.validatePasswordForUser(this.userId,i).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.SET_LOGIN.SUCCESS_PASSWORD")),this.dialogRef.close(!0)},()=>{this.processing=!1})},()=>{this.processing=!1})}onCancel(){this.dialogRef.close(!1)}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(G.so),e.Y36(G.WI),e.Y36(Y.QS),e.Y36(n.Fv),e.Y36(n.uq),e.Y36(n.H8),e.Y36(p.F5),e.Y36(p.V6),e.Y36(g.sK),e.Y36(e.sBO))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-set-login-dialog"]],decls:13,vars:12,consts:[[1,"vo-theme"],[1,"mat-dialog-title"],["class","dialog-container","mat-dialog-content","",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],["mat-dialog-content","",1,"dialog-container"],[3,"formGroup","filteredNamespace"],[1,"ml-auto","mr-auto"]],template:function(i,m){1&i&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,he,2,2,"div",2),e.YNc(5,fe,1,0,"mat-spinner",3),e.TgZ(6,"div",4)(7,"button",5),e.NdJ("click",function(){return m.onCancel()}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",6),e.NdJ("click",function(){return m.onSetLogin()}),e._uU(11),e.ALo(12,"translate"),e.qZA()()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,6,"DIALOGS.SET_LOGIN.TITLE")),e.xp6(2),e.Q6J("ngIf",!m.processing),e.xp6(1),e.Q6J("ngIf",m.processing),e.xp6(3),e.hij(" ",e.lcZ(9,8,"DIALOGS.SET_LOGIN.CANCEL")," "),e.xp6(2),e.Q6J("disabled","Not selected"===m.formGroup.get("namespaceCtrl").value||m.formGroup.invalid||m.formGroup.pending||m.processing),e.xp6(1),e.hij(" ",e.lcZ(12,10,"DIALOGS.SET_LOGIN.SET_LOGIN")," "))},dependencies:[A.O5,Y.JL,Y.sg,K.lW,G.xY,G.H8,v.Ou,ge.r,g.X$]}),r})();var z=s(96214),Ie=s(53599);const Te=["logins"];let ve=(()=>{class r{constructor(i,m){this.dialog=i,this.entityStorageService=m,this.filteredNamespaces=[]}ngOnInit(){this.userId=this.entityStorageService.getEntity().id}onAdd(){const i=(0,D.kZ)();i.width="500px",i.data={userId:this.userId,filteredNamespaces:this.filteredNamespaces},this.dialog.open(Ee,i).afterClosed().subscribe(S=>{S&&this.logins.refreshTable()})}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(G.uw),e.Y36(p.fb))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-perun-web-apps-user-settings-logins"]],viewQuery:function(i,m){if(1&i&&e.Gf(Te,5),2&i){let S;e.iGM(S=e.CRH())&&(m.logins=S.first)}},decls:9,vars:7,consts:[[1,"page-title"],[3,"refresh"],["color","accent","mat-flat-button","",1,"mr-2","action-button",3,"click"],[3,"authenticationPage","filteredNamespaces"],["logins",""]],template:function(i,m){if(1&i){const S=e.EpF();e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){e.CHM(S);const W=e.MAs(8);return e.KtG(W.refreshTable())}),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return m.onAdd()}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"perun-web-apps-password-reset",3,4),e.NdJ("filteredNamespaces",function(W){return m.filteredNamespaces=W}),e.qZA()}2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,3,"USER_DETAIL.SETTINGS.LOGINS.TITLE")),e.xp6(4),e.hij(" ",e.lcZ(6,5,"USER_DETAIL.SETTINGS.LOGINS.ADD"),"\n"),e.xp6(2),e.Q6J("authenticationPage",!0))},dependencies:[K.lW,z.t,Ie.N,g.X$]}),r})(),Ue=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-authentication"]],hostVars:2,hostBindings:function(i,m){2&i&&e.ekj("router-component",m.true)},decls:1,vars:0,template:function(i,m){1&i&&e._UZ(0,"app-animated-router-outlet")},dependencies:[R.A]}),r})();var Se=s(64080),Ce=s(95017),Ae=s(36792),Oe=s(53984);const De=["list"];function be(r,f){1&r&&e._UZ(0,"mat-spinner",5)}const Re=function(r){return[r]};function Me(r,f){if(1&r&&e._UZ(0,"perun-web-apps-attributes-list",6,7),2&r){const i=e.oxw();e.Q6J("attributes",e.VKq(2,Re,i.certificates))("selection",i.selection)}}const Pe=[{path:"",component:X,children:[{path:"",component:a.Z,data:{animation:"UserOverviewPage"}},{path:"attributes",component:L.u,data:{animation:"UserAttributesPage"}},{path:"organizations",component:O.j,data:{animation:"UserOrganizationsPage",showPrincipal:!0}},{path:"groups",component:t.u,data:{animation:"UserGroupsPage",showPrincipal:!0}},{path:"roles",component:$.t,data:{animation:"UserRolesPage"}},{path:"service-identities",component:k.R,data:{animation:"UserServiceIdentities"}},{path:"settings",component:c,children:[{path:"",component:M,data:{animation:"UserSettingsOverviewPage"}},{path:"passwordReset",component:U.Nj,data:{animation:"PasswordResetPage"}},{path:"guiConfig",component:l,data:{animation:"UserAppConfigurationPage"}}]}]},{path:"service-identities/:userId",component:ae,children:[{path:"",component:oe},{path:"associated-users",component:le.d},{path:"authentication",component:Ue,children:[{path:"",component:me},{path:"logins",component:ve},{path:"certificates",component:(()=>{class r{constructor(i,m,S){this.entityStorageService=i,this.attributesManagerService=m,this.dialog=S,this.selection=new Ce.Ov(!0,[])}ngOnInit(){this.userId=this.entityStorageService.getEntity().id,this.refresh()}refresh(){this.loading=!0,this.attributesManagerService.getUserAttributeByName(this.userId,Se.r.USER_DEF_CERTIFICATES).subscribe(i=>{this.certificates=i,this.selection.clear(),this.loading=!1})}save(){this.list.updateMapAttributes();const i=(0,D.kZ)();i.width="450px",i.data={entityId:this.userId,entity:"user",attributes:this.selection.selected},this.dialog.open(Ae.wA,i).afterClosed().subscribe(S=>{S&&this.refresh()})}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(p.fb),e.Y36(n.H8),e.Y36(G.uw))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-service-identity-certificates"]],viewQuery:function(i,m){if(1&i&&e.Gf(De,5),2&i){let S;e.iGM(S=e.CRH())&&(m.list=S.first)}},decls:9,vars:9,consts:[[1,"page-title"],[1,"mt-2",3,"refresh"],["color","accent","mat-flat-button","",1,"mr-2","mt-2",3,"disabled","click"],["class","ml-auto mr-auto",4,"ngIf"],[3,"attributes","selection",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"attributes","selection"],["list",""]],template:function(i,m){1&i&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){return m.refresh()}),e.qZA(),e.TgZ(4,"button",2),e.NdJ("click",function(){return m.save()}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.YNc(7,be,1,0,"mat-spinner",3),e.YNc(8,Me,2,4,"perun-web-apps-attributes-list",4)),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,5,"USER_DETAIL.SETTINGS.CERTIFICATES.TITLE")),e.xp6(3),e.Q6J("disabled",0===m.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(6,7,"USER_DETAIL.SETTINGS.CERTIFICATES.SAVE"),"\n"),e.xp6(2),e.Q6J("ngIf",m.loading),e.xp6(1),e.Q6J("ngIf",!m.loading))},dependencies:[A.O5,K.lW,v.Ou,z.t,Oe.p,g.X$]}),r})()},{path:"ssh-keys",component:U.N7}]},{path:"mailing-lists",component:_e},{path:"data-quotas",component:pe}]}];let Le=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[_.Bz.forChild(Pe),_.Bz]}),r})();var ye=s(47957),Ze=s(284),xe=s(23267),Be=s(37084),Ye=s(96308),We=s(30671),Ge=s(3848),Ke=s(35423),we=s(56709),Je=s(17009),Fe=s(73162),Qe=s(90455),ze=s(99602),He=s(71948),Ve=s(44850),je=s(98739),H=s(73546),Xe=s(86257),$e=s(73555),ke=s(77331),qe=s(28255),et=s(67376),tt=s(63189),st=s(42673),nt=s(11243),it=s(19516),rt=s(14264);let at=(()=>{class r{constructor(i){this.translate=i,i.addLangs(["en","cs"])}}return r.\u0275fac=function(i){return new(i||r)(e.LFG(g.sK))},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[A.ez,Le,ye.Bb,Ze.c,C.lN,Y.UX,Y.u5,T.Ps,xe.SJ,Be.To,g.aw.forChild({}),K.ot,Ye.JX,We.p0,Ge.Nh,Ke.dp,K.ot,we.p9,G.Is,d.LD,Je.ZX,v.Cq,Fe.Cv,y.AV,Qe.rP,ze.FA,I.XK,He.Fk,Ve.t,I.si,je.TU,H.QW,Xe.T5,$e._t,H.QW,ke.Hi,qe.Tx,et.Cl,tt.r,st.g,U.ez,nt.r,it.d4,rt.m]}),r})()}}]);