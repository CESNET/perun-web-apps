import{$c as Nt,$g as ot,$h as re,$j as Xi,Aa as x,Ab as vt,Ac as Q,Ba as _,Bc as Ne,Be as Zt,Bf as bi,Bi as he,Ca as U,Cc as tt,Cf as Z,Da as v,Db as Se,Dc as Mt,Df as q,Ea as xe,Eb as we,Ee as qt,Ef as K,Eh as ze,Ej as qi,F as Ee,Fa as Ae,Fb as De,Fe as fe,Ff as X,Gc as Rt,Ge as Kt,Gf as vi,H as gt,Hb as St,Hc as wt,Ib as Le,If as Si,Jf as Ii,Jh as Oi,K as S,Ka as z,Ke as Xt,Kh as Fi,L as Ce,La as ve,Lh as Vi,Ma as Je,Mb as w,Me as Oe,Mg as Ui,Mh as Gi,Ne as Jt,Ng as B,O as I,Oa as u,Ob as It,Oe as ei,Oh as ki,P as E,Pa as f,Pg as xi,Qe as ti,Qg as _e,Re as nt,Rg as ge,Rj as Ye,Sa as P,Sb as Et,Sd as zt,Sg as Ai,Sh as He,Sj as Qe,Tb as C,Td as Ht,Te as ii,Tf as Fe,Tj as Ki,Ub as Ct,Uf as Ei,Ug as Mi,Uh as ji,Ve as ni,Xa as ht,Xb as Be,Xc as Dt,Ya as M,Yb as H,Yc as Lt,Yh as Wi,Z as p,Za as Me,Zb as F,Zc as Bt,Zg as Ri,_ as m,_g as ke,ad as ue,af as ri,bd as Pt,bf as se,bh as je,bk as Ji,cb as bt,cd as Ot,cf as oi,dd as ne,dg as D,dh as G,di as zi,ea as d,ec as oe,ed as Ft,ek as en,fc as yt,fd as Vt,gc as Tt,ge as $t,ha as s,he as Yt,hf as si,hg as Ci,i as ft,ia as O,ic as Ut,if as ai,ih as wi,ij as Hi,jc as xt,jf as pi,jg as Ve,kf as li,kh as Di,kj as $i,la as a,ld as N,lf as mi,lg as L,lh as ae,ma as l,mf as ci,mh as Li,mj as Yi,na as h,ne as Qt,nf as di,nh as We,oa as Ke,pa as Xe,pd as Pe,pf as ui,pj as Qi,qa as T,qb as R,qh as Bi,qj as Zi,ra as b,rf as fi,rg as yi,sa as c,sd as Gt,sf as _i,si as $e,tb as ce,tc as V,td as it,tf as rt,th as Ni,ub as de,ud as kt,uf as gi,ug as Ti,va as le,vg as Ge,vh as J,wb as et,wh as Pi,xa as ye,xc as At,y as _t,ya as Te,yb as Re,yd as jt,yf as hi,za as Ue,zd as Wt}from"./chunk-CJG2O2I4.js";function Un(e,t){e&1&&(a(0,"h1",7),_(1),u(2,"translate"),l()),e&2&&(p(),v(" ",f(2,1,"SHARED_LIB.PERUN.ORGANIZATIONS.YOU_ARE_MEMBER"),`
`))}function xn(e,t){e&1&&(a(0,"h1",7),_(1),u(2,"translate"),l()),e&2&&(p(),v(" ",f(2,1,"SHARED_LIB.PERUN.ORGANIZATIONS.USER_IS_MEMBER"),`
`))}function An(e,t){if(e&1&&h(0,"perun-web-apps-vos-list",8),e&2){let r=c();s("loading",r.memberRefresh)("displayedColumns",r.displayedColumns)("tableId",r.memberTableId)("filterValue",r.memberFilterValue)("vos",r.vosWhereIsMember)}}function Mn(e,t){if(e&1&&h(0,"perun-web-apps-vos-list",8),e&2){let r=c(2);s("loading",r.adminRefresh)("displayedColumns",r.displayedColumns)("tableId",r.adminTableId)("filterValue",r.adminFilterValue)("vos",r.vosWhereIsAdmin)}}function Rn(e,t){if(e&1){let r=T();a(0,"div",9)(1,"h1",7),_(2),u(3,"translate"),l(),a(4,"perun-web-apps-refresh-button",1),b("refresh",function(){I(r);let n=c();return E(n.refreshAdminTable())}),l(),a(5,"perun-web-apps-debounce-filter",2),b("filter",function(n){I(r);let o=c();return E(o.applyAdminFilter(n))}),l(),a(6,"div",3),d(7,Mn,1,5,"perun-web-apps-vos-list",4),l()()}if(e&2){let r=c(),i=x(8);p(2),U(f(3,4,"SHARED_LIB.PERUN.ORGANIZATIONS.USER_IS_ADMIN")),p(3),s("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),p(2),s("perunWebAppsLoader",r.adminRefresh)("perunWebAppsLoaderIndicator",i)}}function wn(e,t){e&1&&h(0,"perun-web-apps-loading-table")}var st=(()=>{let t=class t{constructor(i,n,o,g){this.usersService=i,this.authResolver=n,this.store=o,this.route=g,this.vosWhereIsAdmin=[],this.vosWhereIsMember=[],this.adminFilterValue="",this.memberFilterValue="",this.displayedColumns=["id","name"],this.adminTableId=jt,this.memberTableId=Wt}ngOnInit(){(this.isMyProfile=this.route.snapshot.data.showPrincipal)?this.userId=this.store.getPerunPrincipal().user.id:this.route.parent.params.subscribe(i=>this.userId=Number(i.userId)),this.refreshAdminTable(),this.refreshMemberTable()}refreshMemberTable(){this.memberRefresh=!0,this.usersService.getVosWhereUserIsMember(this.userId).subscribe(i=>{this.vosWhereIsMember=i,this.memberRefresh=!1},()=>this.memberRefresh=!1)}refreshAdminTable(){this.adminRefresh=!0,this.usersService.getVosWhereUserIsAdmin(this.userId).subscribe(i=>{this.vosWhereIsAdmin=i,this.adminRefresh=!1},()=>this.adminRefresh=!1)}applyMemberFilter(i){this.memberFilterValue=i}applyAdminFilter(i){this.adminFilterValue=i}};t.\u0275fac=function(n){return new(n||t)(m(w),m(H),m(F),m(R))},t.\u0275cmp=S({type:t,selectors:[["app-user-organizations"]],hostVars:2,hostBindings:function(n,o){n&2&&O("router-component",o.true)},decls:9,vars:6,consts:[["class","page-subtitle",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],[1,"position-relative","table-min-height"],[3,"loading","displayedColumns","tableId","filterValue","vos",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["class","mt-5",4,"ngIf"],["spinner",""],[1,"page-subtitle"],[3,"loading","displayedColumns","tableId","filterValue","vos"],[1,"mt-5"]],template:function(n,o){if(n&1&&(d(0,Un,3,3,"h1",0)(1,xn,3,3,"h1",0),a(2,"perun-web-apps-refresh-button",1),b("refresh",function(){return o.refreshMemberTable()}),l(),a(3,"perun-web-apps-debounce-filter",2),b("filter",function(y){return o.applyMemberFilter(y)}),l(),a(4,"div",3),d(5,An,1,5,"perun-web-apps-vos-list",4),l(),d(6,Rn,8,6,"div",5)(7,wn,1,0,"ng-template",null,6,P)),n&2){let g=x(8);s("ngIf",o.isMyProfile),p(),s("ngIf",!o.isMyProfile),p(2),s("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),p(2),s("perunWebAppsLoader",o.memberRefresh)("perunWebAppsLoaderIndicator",g),p(),s("ngIf",!o.isMyProfile)}},dependencies:[M,B,Ri,G,J,L,C]});let e=t;return e})();function Ln(e,t){e&1&&(a(0,"h1",7),_(1),u(2,"translate"),l()),e&2&&(p(),v(" ",f(2,1,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.YOU_ARE_MEMBER"),`
`))}function Bn(e,t){e&1&&(a(0,"h1",7),_(1),u(2,"translate"),l()),e&2&&(p(),v(" ",f(2,1,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.USER_IS_MEMBER"),`
`))}var tn=()=>["id","vo","name","description"];function Nn(e,t){if(e&1&&h(0,"perun-web-apps-groups-list",8),e&2){let r=c();s("loading",r.memberRefresh)("disableMembers",!1)("groups",r.membersGroups)("displayedColumns",z(6,tn))("filter",r.memberFilterValue)("tableId",r.tableId)}}function Pn(e,t){if(e&1&&h(0,"perun-web-apps-groups-list",8),e&2){let r=c(2);s("loading",r.adminRefresh)("disableMembers",!1)("groups",r.adminsGroups)("displayedColumns",z(6,tn))("filter",r.adminFilterValue)("tableId",r.adminTableId)}}function On(e,t){if(e&1){let r=T();a(0,"div",9)(1,"h1",7),_(2),u(3,"translate"),l(),a(4,"perun-web-apps-refresh-button",1),b("refresh",function(){I(r);let n=c();return E(n.refreshAdminTable())}),l(),a(5,"perun-web-apps-debounce-filter",2),b("filter",function(n){I(r);let o=c();return E(o.adminFilter(n))}),l(),a(6,"div",3),d(7,Pn,1,7,"perun-web-apps-groups-list",4),l()()}if(e&2){let r=c(),i=x(8);p(2),v(" ",f(3,4,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.USER_IS_ADMIN")," "),p(3),s("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),p(2),s("perunWebAppsLoader",r.adminRefresh)("perunWebAppsLoaderIndicator",i)}}function Fn(e,t){e&1&&h(0,"perun-web-apps-loading-table")}var at=(()=>{let t=class t{constructor(i,n,o,g,y){this.usersService=i,this.memberService=n,this.groupService=o,this.store=g,this.route=y,this.memberFilterValue="",this.adminFilterValue="",this.vos=[],this.membersGroups=[],this.adminsGroups=[],this.tableId=zt,this.adminTableId=Ht}ngOnInit(){(this.showPrincipal=this.route.snapshot.data.showPrincipal)?this.userId=this.store.getPerunPrincipal().user.id:this.route.parent.params.subscribe(i=>this.userId=Number(i.userId)),this.refreshAdminTable(),this.refreshMemberTable()}memberFilter(i){this.memberFilterValue=i}adminFilter(i){this.adminFilterValue=i}refreshAdminTable(){this.adminRefresh=!0,this.usersService.getGroupsWhereUserIsAdmin(this.userId).subscribe(i=>{this.adminsGroups=i,this.adminRefresh=!1})}refreshMemberTable(){this.memberRefresh=!0,this.membersGroups=[],this.usersService.getVosWhereUserIsMember(this.userId).subscribe(i=>{this.vos=i;for(let n of this.vos)this.memberService.getMemberByUser(n.id,this.userId).subscribe(o=>{this.groupService.getMemberGroups(o.id).subscribe(g=>{this.membersGroups=this.membersGroups.concat(g),this.vos.indexOf(n)===this.vos.length-1&&(this.memberRefresh=!1)})});i.length===0&&(this.memberRefresh=!1)})}};t.\u0275fac=function(n){return new(n||t)(m(w),m(De),m(we),m(F),m(R))},t.\u0275cmp=S({type:t,selectors:[["app-user-groups"]],hostVars:2,hostBindings:function(n,o){n&2&&O("router-component",o.true)},decls:9,vars:6,consts:[["class","page-subtitle",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],[1,"position-relative","table-min-height"],[3,"loading","disableMembers","groups","displayedColumns","filter","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["class","mt-5",4,"ngIf"],["spinner",""],[1,"page-subtitle"],[3,"loading","disableMembers","groups","displayedColumns","filter","tableId"],[1,"mt-5"]],template:function(n,o){if(n&1&&(d(0,Ln,3,3,"h1",0)(1,Bn,3,3,"h1",0),a(2,"perun-web-apps-refresh-button",1),b("refresh",function(){return o.refreshMemberTable()}),l(),a(3,"perun-web-apps-debounce-filter",2),b("filter",function(y){return o.memberFilter(y)}),l(),a(4,"div",3),d(5,Nn,1,7,"perun-web-apps-groups-list",4),l(),d(6,On,8,6,"div",5)(7,Fn,1,0,"ng-template",null,6,P)),n&2){let g=x(8);s("ngIf",o.showPrincipal),p(),s("ngIf",!o.showPrincipal),p(2),s("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),p(2),s("perunWebAppsLoader",o.memberRefresh)("perunWebAppsLoaderIndicator",g),p(),s("ngIf",!o.showPrincipal)}},dependencies:[M,B,ke,G,J,L,C]});let e=t;return e})();var nn=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=S({type:t,selectors:[["app-user-settings"]],hostVars:2,hostBindings:function(n,o){n&2&&O("router-component",o.true)},decls:1,vars:0,template:function(n,o){n&1&&h(0,"app-animated-router-outlet")},dependencies:[re]});let e=t;return e})();function Vn(e,t){e&1&&h(0,"mat-spinner",2)}function Gn(e,t){if(e&1&&(a(0,"div"),h(1,"perun-web-apps-menu-buttons-field",3),l()),e&2){let r=c();p(),s("items",r.navItems)}}var rn=(()=>{let t=class t{constructor(i,n){this.route=i,this.userManager=n,this.navItems=[],this.loading=!1}ngOnInit(){window.location.pathname.startsWith("/admin")?(this.loading=!0,this.route.parent.parent.params.subscribe(i=>{let n=Number(i.userId);this.userManager.getUserById(n).subscribe(o=>{this.isServiceUser=o.serviceUser,this.initNavItems(),this.loading=!1},()=>this.loading=!1)})):this.initNavItems()}initNavItems(){this.navItems=[],window.location.pathname.startsWith("/admin")||this.navItems.push({cssIcon:"perun-settings2",url:"/myProfile/settings/passwordReset",label:"MENU_ITEMS.USER.PASSWORD_RESET",style:"user-btn"},{cssIcon:"perun-settings1",url:"/myProfile/settings/guiConfig",label:"MENU_ITEMS.USER.GUI_CONFIG",style:"user-btn"})}};t.\u0275fac=function(n){return new(n||t)(m(R),m(w))},t.\u0275cmp=S({type:t,selectors:[["app-user-settings-overview"]],hostVars:2,hostBindings:function(n,o){n&2&&O("router-component",o.true)},decls:2,vars:2,consts:[["class","me-auto ms-auto",4,"ngIf"],[4,"ngIf"],[1,"me-auto","ms-auto"],[3,"items"]],template:function(n,o){n&1&&d(0,Vn,1,0,"mat-spinner",0)(1,Gn,2,1,"div",1),n&2&&(s("ngIf",o.loading),p(),s("ngIf",!o.loading))},dependencies:[M,se,ae]});let e=t;return e})();function jn(e,t){e&1&&(_(0),u(1,"translate")),e&2&&v(" ",f(1,1,"ADMIN_USER.ENTITY")," ")}function Wn(e,t){if(e&1&&h(0,"app-one-entity-attribute-page",6),e&2){let r=c();s("entityId",r.userId)("entity","user")}}function zn(e,t){e&1&&(_(0),u(1,"translate"),u(2,"translate")),e&2&&xe(" ",f(1,2,"ADMIN_USER.ENTITY")," - ",f(2,4,"FACILITY_DETAIL.ENTITY")," ")}function Hn(e,t){if(e&1&&h(0,"app-two-entity-attribute-page",7),e&2){let r=c(2);s("firstEntity","user")("firstEntityId",r.userId)("secondEntity","facility")}}function $n(e,t){e&1&&(a(0,"mat-tab"),d(1,zn,3,6,"ng-template",3)(2,Hn,1,3,"ng-template",4),l())}var mt=(()=>{let t=class t{constructor(i,n,o){this.route=i,this.store=n,this.authResolver=o}ngOnInit(){this.route.parent.params.subscribe(i=>{this.userId=Number(i.userId),this.userId||(this.userId=this.store.getPerunPrincipal().userId);let n={id:this.userId,beanName:"User"};this.userFacilityAttAuth=this.authResolver.isAuthorized("getAssignedFacilities_User_policy",[n])})}};t.\u0275fac=function(n){return new(n||t)(m(R),m(F),m(H))},t.\u0275cmp=S({type:t,selectors:[["app-user-settings-attributes"]],hostVars:2,hostBindings:function(n,o){n&2&&O("router-component",o.true)},decls:8,vars:4,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false"],[1,"mb-2"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(n,o){n&1&&(a(0,"h1",0),_(1),u(2,"translate"),l(),a(3,"mat-tab-group",1)(4,"mat-tab",2),d(5,jn,2,3,"ng-template",3)(6,Wn,1,2,"ng-template",4),l(),d(7,$n,3,0,"mat-tab",5),l()),n&2&&(p(),U(f(2,2,"USER_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),p(6),s("ngIf",o.userFacilityAttAuth))},dependencies:[M,Z,q,K,X,he,$e,C]});let e=t;return e})();function Yn(e,t){if(e&1&&(a(0,"mat-option",5),_(1),l()),e&2){let r=t.$implicit;s("value",r),p(),v(" ",r," ")}}var sn=(()=>{let t=class t{constructor(i){this.guiConfigService=i,this.tablePageSizeOptions=Ft}ngOnInit(){this.preferredTablePageSize=this.guiConfigService.getNumber(it)}updatePreferredTablePageSize(){this.guiConfigService.setNumber(it,this.preferredTablePageSize)}};t.\u0275fac=function(n){return new(n||t)(m(kt))},t.\u0275cmp=S({type:t,selectors:[["app-user-settings-app-configuration"]],decls:10,vars:8,consts:[[1,"page-subtitle"],[1,"col-12","col-lg-6","p-0"],[1,"w-100"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(n,o){n&1&&(a(0,"h1",0),_(1),u(2,"translate"),l(),a(3,"div",1)(4,"mat-form-field",2)(5,"mat-label"),_(6),u(7,"translate"),l(),a(8,"mat-select",3),b("valueChange",function(y){return o.preferredTablePageSize=y})("valueChange",function(){return o.updatePreferredTablePageSize()}),d(9,Yn,2,2,"mat-option",4),l()()()),n&2&&(p(),U(f(2,4,"USER_DETAIL.SETTINGS.GUI_CONFIG.TITLE")),p(5),U(f(7,6,"USER_DETAIL.SETTINGS.GUI_CONFIG.PREF_TABLE_PAGE_SIZE")),p(2),s("value",o.preferredTablePageSize),p(),s("ngForOf",o.tablePageSizeOptions))},dependencies:[ht,xt,Rt,Mt,Bt,C]});let e=t;return e})();function qn(e,t){e&1&&h(0,"th",13)}function Kn(e,t){if(e&1&&(a(0,"td",14),_(1),l()),e&2){let r=t.$implicit;p(),v("",r.displayName,":")}}function Xn(e,t){e&1&&h(0,"th",13)}function Jn(e,t){if(e&1){let r=T();a(0,"td",15)(1,"div",16),_(2),a(3,"button",17),b("click",function(){I(r);let n=c(2);return E(n.changeEmail())}),u(4,"translate"),a(5,"mat-icon"),_(6,"edit"),l()()()()}if(e&2){let r=t.$implicit;p(2),v(" ",r.value," "),p(),le("matTooltip",f(4,2,"USER_DETAIL.OVERVIEW.CHANGE_EMAIL"))}}function er(e,t){e&1&&h(0,"tr",18)}function tr(e,t){if(e&1&&(a(0,"div",3)(1,"mat-card",4)(2,"mat-card-header")(3,"mat-card-title")(4,"h1",5),_(5),u(6,"translate"),l()()(),a(7,"mat-card-content")(8,"table",6),Ke(9,7),d(10,qn,1,0,"th",8)(11,Kn,2,1,"td",9),Xe(),Ke(12,10),d(13,Xn,1,0,"th",8)(14,Jn,7,4,"td",11),Xe(),d(15,er,1,0,"tr",12),l()()()()),e&2){let r=c();p(5),U(f(6,3,"USER_DETAIL.OVERVIEW.GENERAL_SETTINGS")),p(3),s("dataSource",r.mailDataSource),p(7),s("matRowDefColumns",r.displayedColumns)}}var ln=(()=>{let t=class t{constructor(i,n,o,g,y){this.userService=i,this.attributeService=n,this.storeService=o,this.route=g,this.dialog=y,this.items=[],this.settingsItems=[],this.isServiceUser=!1,this.displayedColumns=["name","value"],this.inMyProfile=!1}ngOnInit(){this.route.params.subscribe(i=>{i.userId?this.userService.getUserById(Number(i.userId)).subscribe(n=>{this.user=n,this.isServiceUser=n.serviceUser,this.setItems(`/admin/users/${this.user.id}`),this.setSettingsItems()}):(this.inMyProfile=!0,this.userID=this.storeService.getPerunPrincipal().user.id,this.attributeService.getUserAttributeByName(this.userID,ne.USER_DEF_PREFERRED_MAIL).subscribe(n=>{this.preferredMail=n,this.handleMailNotDefined(),this.mailDataSource=new rt([this.preferredMail]),this.setItems("/myProfile"),this.setSettingsItems()}))})}changeEmail(){let i=N();i.width="350px",i.data={userId:this.userID},this.dialog.open(Ai,i).afterClosed().subscribe(o=>{o&&this.attributeService.getUserAttributeByName(this.userID,ne.USER_DEF_PREFERRED_MAIL).subscribe(g=>{this.preferredMail=g,this.handleMailNotDefined(),this.mailDataSource=new rt([this.preferredMail])})})}handleMailNotDefined(){(this.preferredMail===null||this.preferredMail===void 0)&&(this.preferredMail={id:-1,beanName:"Attribute",displayName:Vt(ne.USER_DEF_PREFERRED_MAIL.split(":").pop()),value:new Object("-")})}setItems(i){this.items=[],this.inMyProfile?this.items.push({cssIcon:"perun-vo",url:`${i}/organizations`,label:"MENU_ITEMS.ADMIN.ORGANIZATIONS",style:"user-btn"},{cssIcon:"perun-group",url:`${i}/groups`,label:"MENU_ITEMS.ADMIN.GROUPS",style:"user-btn"}):this.items.push({cssIcon:"perun-user",url:`${i}/accounts`,label:"MENU_ITEMS.USER.ACCOUNTS",style:"user-btn"},{cssIcon:"perun-facility-white",url:`${i}/assignments`,label:"MENU_ITEMS.USER.ASSIGNMENTS",style:"user-btn"},{cssIcon:"perun-identity",url:`${i}/identities`,label:"MENU_ITEMS.USER.IDENTITIES",style:"user-btn"}),this.items.push({cssIcon:"perun-attributes",url:`${i}/attributes`,label:"MENU_ITEMS.USER.ATTRIBUTES",style:"user-btn"}),this.items.push({cssIcon:"perun-roles",url:`${i}/roles`,label:"MENU_ITEMS.USER.ROLES",style:"user-btn"}),this.isServiceUser?this.items.push({cssIcon:"perun-manager",url:`${i}/associated-users`,label:"MENU_ITEMS.USER.ASSOCIATED_USERS",style:"user-btn"}):this.items.push({cssIcon:"perun-service-identity",url:`${i}/service-identities`,label:"MENU_ITEMS.USER.SERVICE_IDENTITIES",style:"user-btn"}),this.items.push({cssIcon:"perun-ban",url:"bans",label:"MENU_ITEMS.USER.BANS",style:"user-btn"})}setSettingsItems(){this.settingsItems=[],this.inMyProfile&&this.settingsItems.push({cssIcon:"perun-settings2",url:"/myProfile/settings/passwordReset",label:"MENU_ITEMS.USER.PASSWORD_RESET",style:"user-btn"},{cssIcon:"perun-settings1",url:"/myProfile/settings/guiConfig",label:"MENU_ITEMS.USER.GUI_CONFIG",style:"user-btn"})}};t.\u0275fac=function(n){return new(n||t)(m(w),m(Re),m(F),m(R),m(V))},t.\u0275cmp=S({type:t,selectors:[["app-user-overview"]],hostVars:2,hostBindings:function(n,o){n&2&&O("router-component",o.true)},decls:3,vars:5,consts:[["class","align-cards",4,"ngIf"],[3,"items"],[3,"items","title","sectionId"],[1,"align-cards"],["appearance","outlined",1,"card","mat-elevation-z3"],[1,"page-subtitle"],["mat-table","",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["class","fw-bold","mat-cell","",4,"matCellDef"],["matColumnDef","value"],["mat-cell","",4,"matCellDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"fw-bold"],["mat-cell",""],[1,"d-flex","align-items-center"],["mat-icon-button","",1,"ms-3",3,"matTooltip","click"],["mat-row",""]],template:function(n,o){n&1&&(d(0,tr,16,5,"div",0),h(1,"perun-web-apps-menu-buttons-field",1)(2,"perun-web-apps-expandable-tiles",2)),n&2&&(s("ngIf",o.inMyProfile),p(),s("items",o.items),p(),s("items",o.settingsItems)("title","MENU_ITEMS.USER.SETTINGS")("sectionId","settings"))},dependencies:[M,fe,Ne,ai,li,mi,pi,ui,ci,di,fi,ue,Oe,ei,ti,Jt,ae,He,C],styles:[".align-cards[_ngcontent-%COMP%]{margin:1rem 0;display:inline-block;vertical-align:top}"]});let e=t;return e})();var or=()=>({color:"black"}),mn=()=>["/myProfile"];function sr(e,t){if(e&1&&(a(0,"div",1),h(1,"perun-web-apps-back-button"),a(2,"div",2),h(3,"mat-icon",3),u(4,"translate"),a(5,"div",4)(6,"div",5)(7,"a",6),b("auxclick",function(i){return i.preventDefault()}),_(8),u(9,"userFullName"),l(),a(10,"span",7),_(11),l()(),a(12,"span",8),_(13),u(14,"translate"),u(15,"translate"),l()()(),h(16,"app-animated-router-outlet"),l()),e&2){let r=c();p(3),le("matTooltip",f(4,9,"MENU_ITEMS.USER.ENTITY")),s("ngStyle",z(17,or)),p(4),s("perunWebAppsMiddleClickRouterLink",z(18,mn))("routerLink",z(19,mn)),p(),v(" ",f(9,11,r.user)," "),p(3),v(" \xA0#",r.user.id," "),p(2),Ae(" ",f(14,13,"MENU_ITEMS.USER.ENTITY"),", ",f(15,15,"MENU_ITEMS.USER.USER_TYPE"),": ",r.getUserType()," ")}}var dn=(()=>{let t=class t{constructor(i,n,o,g){this.sideMenuService=i,this.store=n,this.entityStore=o,this.router=g}ngOnInit(){this.path=this.router.url,this.router.events.subscribe(()=>{this.path=this.router.url}),this.principal=this.store.getPerunPrincipal(),this.user=this.principal.user,this.entityStore.setEntityAndPathParam(this.user,Be.User),this.sideMenuService.setUserItems([])}getUserType(){return this.user.serviceUser?"Service":"Person"}};t.\u0275fac=function(n){return new(n||t)(m(Ve),m(F),m(D),m(ce))},t.\u0275cmp=S({type:t,selectors:[["app-user-profile"]],decls:1,vars:1,consts:[["class","container-fluid ps-xl-5 pe-xl-5 user-theme",4,"ngIf"],[1,"container-fluid","ps-xl-5","pe-xl-5","user-theme"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-user-dark",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"user-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],[1,"text-muted"],[1,"mt-1","entity-info"]],template:function(n,o){n&1&&d(0,sr,17,20,"div",0),n&2&&s("ngIf",o.user!==void 0)},dependencies:[M,Me,de,fe,ue,je,_e,ge,re,C,Ge]});let e=t;return e})();function ar(e,t){e&1&&(_(0),u(1,"translate")),e&2&&v(" ",f(1,1,"USER_DETAIL.DASHBOARD.DIRECT_ROLES")," ")}function pr(e,t){if(e&1){let r=T();a(0,"app-perun-web-apps-roles-page",4),b("currentlyOpenPanelChange",function(n){I(r);let o=c();return E(o.userBasedOpenPanel=n)})("reload",function(){I(r);let n=c();return E(n.getData())})("startLoading",function(){I(r);let n=c();return E(n.outerLoading=!0)}),l()}if(e&2){let r=c();s("outerLoading",r.outerLoading)("roles",r.roles)("entityId",r.userId)("showDescription",r.showDescription)("entityType",r.entityType)("editable",!0)("currentlyOpenPanel",r.userBasedOpenPanel)}}function lr(e,t){e&1&&(_(0),u(1,"translate")),e&2&&v(" ",f(1,1,"USER_DETAIL.DASHBOARD.AUTHORIZED_GROUP_BASED_ROLES")," ")}function mr(e,t){if(e&1){let r=T();a(0,"app-perun-web-apps-roles-page",5),b("currentlyOpenPanelChange",function(n){I(r);let o=c();return E(o.groupBasedOpenPanel=n)})("reload",function(){I(r);let n=c();return E(n.getData())})("startLoading",function(){I(r);let n=c();return E(n.outerLoading=!0)}),l()}if(e&2){let r=c();s("outerLoading",r.outerLoading)("roles",r.indirectRoles)("entityId",r.userId)("showDescription",r.showDescription)("entityType",r.entityType)("editable",!1)("complementaryObjectsWithAuthzGroups",r.rolesComplementaryObjectsWithAuthzGroups)("currentlyOpenPanel",r.groupBasedOpenPanel)}}var ct=(()=>{let t=class t{constructor(i,n,o,g){this.authzResolverService=i,this.route=n,this.store=o,this.roleService=g,this.roles=new Map,this.indirectRoles=new Map,this.rolesComplementaryObjectsWithAuthzGroups=new Map,this.showDescription=!0,this.userBasedOpenPanel=null,this.groupBasedOpenPanel=null}ngOnInit(){this.outerLoading=!0,this.route.parent.params.subscribe(i=>{i.userId?(this.entityType="USER",this.userId=Number(i.userId)):(this.userId=this.store.getPerunPrincipal().userId,this.entityType="SELF"),this.getData()})}getData(){this.outerLoading=!0,this.roles.clear(),this.authzResolverService.getUserDirectRoles(this.userId).subscribe({next:i=>{let n=Object.keys(i).map(o=>o.toUpperCase());this.roles=this.roleService.prepareRoles(i,n),this.indirectRoles.clear(),this.authzResolverService.getUserRolesObtainedFromAuthorizedGroupMemberships(this.userId).subscribe({next:o=>{let g=Object.keys(o).map(y=>y.toUpperCase());this.indirectRoles=this.roleService.prepareRoles(o,g),this.rolesComplementaryObjectsWithAuthzGroups.clear(),this.authzResolverService.getRoleComplementaryObjectsWithAuthorizedGroups(this.userId).subscribe({next:y=>{this.rolesComplementaryObjectsWithAuthzGroups=this.roleService.prepareComplementaryObjects(Object.keys(y),y),this.outerLoading=!1},error:()=>this.outerLoading=!1})},error:()=>this.outerLoading=!1})},error:()=>this.outerLoading=!1})}};t.\u0275fac=function(n){return new(n||t)(m(vt),m(R),m(F),m(Ci))},t.\u0275cmp=S({type:t,selectors:[["app-user-roles"]],hostVars:2,hostBindings:function(n,o){n&2&&O("router-component",o.true)},decls:10,vars:3,consts:[[1,"page-subtitle","d-flex"],["mat-stretch-tabs","false"],["matTabLabel",""],["matTabContent",""],[3,"outerLoading","roles","entityId","showDescription","entityType","editable","currentlyOpenPanel","currentlyOpenPanelChange","reload","startLoading"],[3,"outerLoading","roles","entityId","showDescription","entityType","editable","complementaryObjectsWithAuthzGroups","currentlyOpenPanel","currentlyOpenPanelChange","reload","startLoading"]],template:function(n,o){n&1&&(a(0,"h1",0),_(1),u(2,"translate"),l(),a(3,"mat-tab-group",1)(4,"mat-tab"),d(5,ar,2,3,"ng-template",2)(6,pr,1,7,"ng-template",3),l(),a(7,"mat-tab"),d(8,lr,2,3,"ng-template",2)(9,mr,1,8,"ng-template",3),l()()),n&2&&(p(),U(f(2,1,"ROLES.TITLE")))},dependencies:[Z,q,K,X,Hi,C]});let e=t;return e})();function dr(e,t){if(e&1){let r=T();a(0,"button",7),b("click",function(){I(r);let n=c();return E(n.onAdd())}),_(1),u(2,"translate"),l()}e&2&&(p(),v(" ",f(2,1,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.CREATE"),`
`))}function ur(e,t){if(e&1){let r=T();a(0,"button",8),b("click",function(){I(r);let n=c();return E(n.onRemove())}),_(1),u(2,"translate"),l()}if(e&2){let r=c();s("disabled",r.selection.selected.length===0),p(),v(" ",f(2,2,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.DELETE"),`
`)}}function fr(e,t){e&1&&h(0,"perun-web-apps-loading-table")}function _r(e,t){if(e&1&&(h(0,"perun-web-apps-users-list",9),u(1,"translate")),e&2){let r=c();s("loading",r.loading)("noUsersFoundLabel",f(1,7,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.NO_IDENTITIES"))("routeToAdmin",r.routeToAdminSection)("displayColumns",r.displayedColumns)("selection",r.selection)("tableId",r.tableId)("users",r.identities)}}var dt=(()=>{let t=class t{constructor(i,n,o,g,y,ie){this.route=i,this.dialog=n,this.router=o,this.userManager=g,this.authResolver=y,this.store=ie,this.loading=!1,this.selection=new oe(!1,[]),this.identities=[],this.tableId=$t,this.displayedColumns=["select","id","user","name"],this.routeToAdminSection=!0,this.targetTitle="SERVICE",this.targetDescription="SERVICE"}ngOnDestroy(){this.subscription.unsubscribe()}ngOnInit(){this.loading=!0,this.subscription=this.route.parent.params.subscribe(i=>{this.userId=Number(i.userId),this.userId||(this.targetTitle="SERVICE",this.targetDescription="SELF",this.userId=this.store.getPerunPrincipal().userId,this.routeToAdminSection=!1),this.setAuthRights(),this.refreshTable()})}refreshTable(){this.loading=!0,this.userManager.getSpecificUsersByUser(this.userId).subscribe(i=>{this.identities=i,this.selection.clear(),this.loading=!1})}setAuthRights(){this.addIdentity=this.authResolver.isPerunAdmin(),this.removeIdentity=this.authResolver.isAuthorized("removeSpecificUserOwner_User_User_policy",[{id:this.userId,beanName:"User"}])}onAdd(){let i=N();i.width="1250px",i.data={userId:this.userId,theme:"user-theme",isService:!1,target:this.targetTitle},this.dialog.open(Ye,i).afterClosed().subscribe(o=>{o&&this.refreshTable()})}onRemove(){let i=N();i.width="650px",i.data={identities:this.selection.selected,userId:this.userId,specificUser:this.selection.selected[0],theme:"user-theme",targetTitle:this.targetTitle,targetDescription:this.targetDescription},this.dialog.open(Qe,i).afterClosed().subscribe(o=>{o&&this.refreshTable()})}};t.\u0275fac=function(n){return new(n||t)(m(R),m(V),m(ce),m(w),m(H),m(F))},t.\u0275cmp=S({type:t,selectors:[["app-user-settings-service-identities"]],decls:10,vars:7,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","class","me-2 action-button","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","class","me-2","mat-flat-button","",3,"disabled","click",4,"ngIf"],["spinner",""],[1,"position-relative","table-min-height"],[3,"loading","noUsersFoundLabel","routeToAdmin","displayColumns","selection","tableId","users",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"loading","noUsersFoundLabel","routeToAdmin","displayColumns","selection","tableId","users"]],template:function(n,o){if(n&1&&(a(0,"h1",0),_(1),u(2,"translate"),l(),a(3,"perun-web-apps-refresh-button",1),b("refresh",function(){return o.refreshTable()}),l(),d(4,dr,3,3,"button",2)(5,ur,3,4,"button",3)(6,fr,1,0,"ng-template",null,4,P),a(8,"div",5),d(9,_r,2,9,"perun-web-apps-users-list",6),l()),n&2){let g=x(7);p(),U(f(2,5,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.TITLE")),p(3),s("ngIf",o.addIdentity),p(),s("ngIf",o.removeIdentity),p(4),s("perunWebAppsLoader",o.loading)("perunWebAppsLoaderIndicator",g)}},dependencies:[M,Q,B,G,ze,L,C]});let e=t;return e})();function gr(e,t){e&1&&h(0,"mat-spinner",11)}function hr(e,t){if(e&1){let r=T();a(0,"button",12),b("click",function(){I(r);let n=c(2);return E(n.editUser())}),u(1,"translate"),a(2,"mat-icon"),_(3,"edit"),l()()}e&2&&le("matTooltip",f(1,1,"MENU_ITEMS.USER.EDIT"))}var br=()=>({color:"black"}),un=e=>["/myProfile/service-identities",e];function vr(e,t){if(e&1&&(a(0,"div",1),h(1,"perun-web-apps-back-button"),d(2,gr,1,0,"mat-spinner",2),a(3,"div",3),h(4,"mat-icon",4),u(5,"translate"),a(6,"div",5)(7,"div",6)(8,"a",7),b("auxclick",function(i){return i.preventDefault()}),_(9),u(10,"userFullName"),l(),a(11,"span",8),_(12),l(),d(13,hr,4,3,"button",9),l(),a(14,"div"),_(15),u(16,"translate"),l(),a(17,"span",10),_(18),u(19,"translate"),u(20,"translate"),l()()(),h(21,"app-animated-router-outlet"),l()),e&2){let r=c();p(2),s("ngIf",r.loading),p(2),le("matTooltip",f(5,13,"MENU_ITEMS.USER.ENTITY")),s("ngStyle",z(23,br)),p(4),s("perunWebAppsMiddleClickRouterLink",ve(24,un,r.user.id.toString()))("routerLink",ve(26,un,r.user.id)),p(),v(" ",f(10,15,r.user)," "),p(3),v(" \xA0#",r.user.id," "),p(),s("ngIf",r.authResolver.isPerunAdmin()),p(2),xe("",f(16,17,"ADMIN_USER.UUID"),": ",r.user.uuid,""),p(3),Ae(" ",f(19,19,"MENU_ITEMS.USER.ENTITY"),", ",f(20,21,"MENU_ITEMS.USER.USER_TYPE"),": ",r.getUserType()," ")}}var fn=(()=>{let t=class t{constructor(i,n,o,g,y,ie,Tn){this.sideMenuService=i,this.usersService=n,this.sideMenuItemService=o,this.route=g,this.dialog=y,this.authResolver=ie,this.entityStorageService=Tn,this.loading=!1}ngOnInit(){this.loading=!0,this.route.params.subscribe(i=>{let n=Number(i.userId);this.entityStorageService.setEntityAndPathParam({id:n,beanName:"User"},Be.User),this.usersService.getUserById(n).subscribe({next:o=>{this.user=o;let g=this.sideMenuItemService.parseServiceIdentity(o);this.sideMenuService.setUserItems([g]),this.loading=!1},error:()=>this.loading=!1})})}getUserType(){return this.user.serviceUser?"Service":"Person"}editUser(){let i=N();i.width="450px",i.data={theme:"admin-theme",user:this.user},this.dialog.open(Ki,i).afterClosed().subscribe(o=>{o&&this.usersService.getUserById(this.user.id).subscribe(g=>{this.user=g})})}};t.\u0275fac=function(n){return new(n||t)(m(Ve),m(w),m(Wi),m(R),m(V),m(H),m(D))},t.\u0275cmp=S({type:t,selectors:[["app-service-identity-detail-page"]],decls:1,vars:1,consts:[["class","container-fluid ps-xl-5 pe-xl-5 user-theme",4,"ngIf"],[1,"container-fluid","ps-xl-5","pe-xl-5","user-theme"],["class","me-auto ms-auto",4,"ngIf"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-service-identity",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"user-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],[1,"text-muted"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],[1,"mt-1","entity-info"],[1,"me-auto","ms-auto"],["mat-icon-button","",3,"matTooltip","click"]],template:function(n,o){n&1&&d(0,vr,22,28,"div",0),n&2&&s("ngIf",o.user!==void 0)},dependencies:[M,Me,de,fe,Ne,se,ue,je,_e,ge,re,C,Ge]});let e=t;return e})();var _n=(()=>{let t=class t{constructor(i){this.entityStorageService=i,this.navItems=[],this.authenticationItems=[]}ngOnInit(){this.serviceAccount=this.entityStorageService.getEntity(),this.initNavItems()}initNavItems(){this.navItems=[{cssIcon:"perun-vo",url:`/myProfile/service-identities/${this.serviceAccount.id}/organizations`,label:"MENU_ITEMS.ADMIN.ORGANIZATIONS",style:"user-btn"},{cssIcon:"perun-group",url:`/myProfile/service-identities/${this.serviceAccount.id}/groups`,label:"MENU_ITEMS.ADMIN.GROUPS",style:"user-btn"},{cssIcon:"perun-attributes",url:`/myProfile/service-identities/${this.serviceAccount.id}/attributes`,label:"MENU_ITEMS.USER.ATTRIBUTES",style:"user-btn"},{cssIcon:"perun-roles",url:`/myProfile/service-identities/${this.serviceAccount.id}/roles`,label:"MENU_ITEMS.USER.ROLES",style:"user-btn"},{cssIcon:"perun-ban",url:`/myProfile/service-identities/${this.serviceAccount.id}/bans`,label:"MENU_ITEMS.USER.BANS",style:"user-btn"},{cssIcon:"perun-manager",url:`/myProfile/service-identities/${this.serviceAccount.id}/associated-users`,label:"MENU_ITEMS.USER.ASSOCIATED_USERS",style:"user-btn"},{cssIcon:"perun-notification",url:`/myProfile/service-identities/${this.serviceAccount.id}/mailing-lists`,label:"MENU_ITEMS.USER.MAILING_LISTS",style:"user-btn"},{cssIcon:"perun-statistics",url:`/myProfile/service-identities/${this.serviceAccount.id}/data-quotas`,label:"MENU_ITEMS.USER.DATA_QUOTAS",style:"user-btn"}],this.authenticationItems=[{cssIcon:"perun-logins",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/logins`,label:"MENU_ITEMS.USER.LOGINS",style:"user-btn"},{cssIcon:"perun-certificates",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/certificates`,label:"MENU_ITEMS.USER.CERTIFICATES",style:"user-btn"},{cssIcon:"perun-key",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/ssh-keys`,label:"MENU_ITEMS.USER.SSH_KEYS",style:"user-btn"}]}};t.\u0275fac=function(n){return new(n||t)(m(D))},t.\u0275cmp=S({type:t,selectors:[["app-service-identity-overview"]],decls:2,vars:4,consts:[[3,"items"],[3,"items","title","sectionId"]],template:function(n,o){n&1&&h(0,"perun-web-apps-menu-buttons-field",0)(1,"perun-web-apps-expandable-tiles",1),n&2&&(s("items",o.navItems),p(),s("items",o.authenticationItems)("title","MENU_ITEMS.USER.AUTHENTICATION")("sectionId","authentication"))},dependencies:[ae,He]});let e=t;return e})();function Sr(e,t){e&1&&h(0,"perun-web-apps-loading-table")}function Ir(e,t){if(e&1&&(h(0,"perun-web-apps-users-list",7),u(1,"translate")),e&2){let r=c();s("loading",r.loading)("noUsersFoundLabel",f(1,8,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.NO_ASSOCIATED_USERS"))("disableRouting",r.disableRouting)("routeToAdmin",!0)("displayColumns",r.displayedColumns)("selection",r.selection)("tableId",r.tableId)("users",r.associatedUsers)}}var gn=(()=>{let t=class t{constructor(i,n,o,g,y){this.dialog=i,this.router=n,this.authResolver=o,this.userManager=g,this.entityStorageService=y,this.loading=!1,this.selection=new oe(!1,[]),this.associatedUsers=[],this.tableId=Yt,this.displayedColumns=["select","id","user","name","email","logins","organization"]}ngOnInit(){this.loading=!0,this.user=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.userManager.getUsersBySpecificUser(this.user.id).pipe(ft(i=>i.map(n=>n.id)),_t(i=>this.userManager.getRichUsersWithAttributesByIds(i))).subscribe(i=>{this.associatedUsers=i,this.selection.clear(),this.setAuth(),this.loading=!1})}setAuth(){this.addAuth=this.authResolver.isAuthorized("addSpecificUserOwner_User_User_policy",[this.user]),this.removeAuth=this.authResolver.isAuthorized("removeSpecificUserOwner_User_User_policy",[this.user]),this.disableRouting=!this.authResolver.isPerunAdminOrObserver()}onAdd(){let i=N();i.width="1250px",i.data={userId:this.user.id,theme:"user-theme",isService:!0,target:"USER"},this.dialog.open(Ye,i).afterClosed().subscribe(o=>{o&&this.refreshTable()})}onRemove(){let i=N();i.width="650px",i.data={identities:this.selection.selected,userId:this.user.id,specificUser:this.selection.selected[0],isService:!0,theme:"user-theme",targetTitle:"USER",targetDescription:"SERVICE"},this.dialog.open(Qe,i).afterClosed().subscribe(o=>{o&&(this.authResolver.isAuthorized("getUsersBySpecificUser_User_policy",[this.user])?this.refreshTable():this.router.navigate(["/myProfile"],{queryParamsHandling:"preserve"}))})}};t.\u0275fac=function(n){return new(n||t)(m(V),m(ce),m(H),m(w),m(D))},t.\u0275cmp=S({type:t,selectors:[["app-user-settings-associated-users"]],decls:15,vars:12,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],["spinner",""],[1,"position-relative","table-min-height"],[3,"loading","noUsersFoundLabel","disableRouting","routeToAdmin","displayColumns","selection","tableId","users",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","noUsersFoundLabel","disableRouting","routeToAdmin","displayColumns","selection","tableId","users"]],template:function(n,o){if(n&1&&(a(0,"div")(1,"h1",0),_(2),u(3,"translate"),l(),a(4,"perun-web-apps-refresh-button",1),b("refresh",function(){return o.refreshTable()}),l(),a(5,"button",2),b("click",function(){return o.onAdd()}),_(6),u(7,"translate"),l(),a(8,"button",3),b("click",function(){return o.onRemove()}),_(9),u(10,"translate"),l(),d(11,Sr,1,0,"ng-template",null,4,P),a(13,"div",5),d(14,Ir,2,10,"perun-web-apps-users-list",6),l()()),n&2){let g=x(12);p(2),U(f(3,6,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.TITLE")),p(4),v(" ",f(7,8,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.ADD")," "),p(2),s("disabled",o.selection.selected.length===0),p(),v(" ",f(10,10,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.REMOVE")," "),p(5),s("perunWebAppsLoader",o.loading)("perunWebAppsLoaderIndicator",g)}},dependencies:[Q,B,G,ze,L,C]});let e=t;return e})();var hn=(()=>{let t=class t{constructor(i){this.entityStorageService=i}ngOnInit(){this.user=this.entityStorageService.getEntity()}};t.\u0275fac=function(n){return new(n||t)(m(D))},t.\u0275cmp=S({type:t,selectors:[["app-perun-web-apps-user-settings-mailing-lists"]],decls:1,vars:2,consts:[[3,"user","isService"]],template:function(n,o){n&1&&h(0,"perun-web-apps-mailing-lists",0),n&2&&s("user",o.user)("isService",!0)},dependencies:[Oi]});let e=t;return e})();var bn=(()=>{let t=class t{constructor(i){this.entityStorageService=i}ngOnInit(){this.user=this.entityStorageService.getEntity()}};t.\u0275fac=function(n){return new(n||t)(m(D))},t.\u0275cmp=S({type:t,selectors:[["app-perun-web-apps-user-settings-data-quotas"]],decls:1,vars:1,consts:[[3,"user"]],template:function(n,o){n&1&&h(0,"perun-web-apps-data-quotas",0),n&2&&s("user",o.user)},dependencies:[Fi]});let e=t;return e})();var vn=(()=>{let t=class t{constructor(i){this.entityStorageService=i,this.navItems=[]}ngOnInit(){this.serviceAccount=this.entityStorageService.getEntity(),this.initNavItems()}initNavItems(){this.navItems=[{cssIcon:"perun-logins",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/logins`,label:"MENU_ITEMS.USER.LOGINS",style:"user-btn"},{cssIcon:"perun-certificates",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/certificates`,label:"MENU_ITEMS.USER.CERTIFICATES",style:"user-btn"},{cssIcon:"perun-key",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/ssh-keys`,label:"MENU_ITEMS.USER.SSH_KEYS",style:"user-btn"}]}};t.\u0275fac=function(n){return new(n||t)(m(D))},t.\u0275cmp=S({type:t,selectors:[["app-service-identity-authentication-overview"]],decls:1,vars:1,consts:[[3,"items"]],template:function(n,o){n&1&&h(0,"perun-web-apps-menu-buttons-field",0),n&2&&s("items",o.navItems)},dependencies:[ae]});let e=t;return e})();var Er=["logins"],Sn=(()=>{let t=class t{constructor(i,n){this.dialog=i,this.entityStorageService=n,this.filteredNamespaces=[]}ngOnInit(){this.userId=this.entityStorageService.getEntity().id}onAdd(){let i=N();i.width="500px",i.data={userId:this.userId,filteredNamespaces:this.filteredNamespaces},this.dialog.open(Xi,i).afterClosed().subscribe(o=>{o&&this.logins.refreshTable()})}};t.\u0275fac=function(n){return new(n||t)(m(V),m(D))},t.\u0275cmp=S({type:t,selectors:[["app-perun-web-apps-user-settings-logins"]],viewQuery:function(n,o){if(n&1&&ye(Er,5),n&2){let g;Te(g=Ue())&&(o.logins=g.first)}},decls:9,vars:7,consts:[[1,"page-title"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],[3,"authenticationPage","filteredNamespaces"],["logins",""]],template:function(n,o){if(n&1){let g=T();a(0,"h1",0),_(1),u(2,"translate"),l(),a(3,"perun-web-apps-refresh-button",1),b("refresh",function(){I(g);let ie=x(8);return E(ie.refreshTable())}),l(),a(4,"button",2),b("click",function(){return o.onAdd()}),_(5),u(6,"translate"),l(),a(7,"perun-web-apps-password-reset",3,4),b("filteredNamespaces",function(ie){return o.filteredNamespaces=ie}),l()}n&2&&(p(),U(f(2,3,"USER_DETAIL.SETTINGS.LOGINS.TITLE")),p(4),v(" ",f(6,5,"USER_DETAIL.SETTINGS.LOGINS.ADD"),`
`),p(2),s("authenticationPage",!0))},dependencies:[Q,G,We,C]});let e=t;return e})();var In=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=S({type:t,selectors:[["app-service-identity-authentication"]],hostVars:2,hostBindings:function(n,o){n&2&&O("router-component",o.true)},decls:1,vars:0,template:function(n,o){n&1&&h(0,"app-animated-router-outlet")},dependencies:[re]});let e=t;return e})();var Cr=["list"];function yr(e,t){e&1&&h(0,"perun-web-apps-loading-table")}var Tr=e=>[e];function Ur(e,t){if(e&1&&h(0,"perun-web-apps-attributes-list",6,7),e&2){let r=c();s("loading",r.loading)("attributes",ve(3,Tr,r.certificates))("selection",r.selection)}}var En=(()=>{let t=class t{constructor(i,n,o){this.entityStorageService=i,this.attributesManagerService=n,this.dialog=o,this.selection=new oe(!0,[])}ngOnInit(){this.userId=this.entityStorageService.getEntity().id,this.refresh()}refresh(){this.loading=!0,this.attributesManagerService.getUserAttributeByName(this.userId,ne.USER_DEF_CERTIFICATES).subscribe(i=>{this.certificates=i,this.selection.clear(),this.loading=!1})}save(){this.list.updateMapAttributes();let i=N();i.width="450px",i.data={entityId:this.userId,entity:"user",attributes:this.selection.selected},this.dialog.open(Ti,i).afterClosed().subscribe(o=>{o&&this.refresh()})}};t.\u0275fac=function(n){return new(n||t)(m(D),m(Re),m(V))},t.\u0275cmp=S({type:t,selectors:[["app-service-identity-certificates"]],viewQuery:function(n,o){if(n&1&&ye(Cr,5),n&2){let g;Te(g=Ue())&&(o.list=g.first)}},decls:11,vars:9,consts:[[1,"page-title"],[1,"mt-2",3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","mt-2",3,"disabled","click"],["spinner",""],[1,"position-relative","table-min-height"],[3,"loading","attributes","selection",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","attributes","selection"],["list",""]],template:function(n,o){if(n&1&&(a(0,"h1",0),_(1),u(2,"translate"),l(),a(3,"perun-web-apps-refresh-button",1),b("refresh",function(){return o.refresh()}),l(),a(4,"button",2),b("click",function(){return o.save()}),_(5),u(6,"translate"),l(),d(7,yr,1,0,"ng-template",null,3,P),a(9,"div",4),d(10,Ur,2,5,"perun-web-apps-attributes-list",5),l()),n&2){let g=x(8);p(),U(f(2,5,"USER_DETAIL.SETTINGS.CERTIFICATES.TITLE")),p(3),s("disabled",o.selection.selected.length===0),p(),v(" ",f(6,7,"USER_DETAIL.SETTINGS.CERTIFICATES.SAVE"),`
`),p(5),s("perunWebAppsLoader",o.loading)("perunWebAppsLoaderIndicator",g)}},dependencies:[Q,B,G,Di,L,C]});let e=t;return e})();function xr(e,t){e&1&&(_(0),u(1,"translate")),e&2&&v(" ",f(1,1,"USER_DETAIL.BANS.VO")," ")}function Ar(e,t){if(e&1){let r=T();a(0,"perun-web-apps-ban-on-entity-list",8),b("updateBan",function(n){I(r);let o=c(2);return E(o.updateVoBan(n))}),l()}if(e&2){let r=c(2);s("loading",r.loading)("bans",r.voBans)("displayedColumns",r.displayedColumns)("filter",r.filter)("updatePolicy","updateBan_BanOnVo_policy")}}function Mr(e,t){if(e&1){let r=T();a(0,"perun-web-apps-debounce-filter",5),b("filter",function(n){I(r);let o=c();return E(o.filter=n)}),l(),a(1,"div",6),d(2,Ar,1,5,"perun-web-apps-ban-on-entity-list",7),l()}if(e&2){let r=c(),i=x(14);s("placeholder","USER_DETAIL.BANS.FILTER"),p(2),s("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",i)}}function Rr(e,t){e&1&&(_(0),u(1,"translate")),e&2&&v(" ",f(1,1,"USER_DETAIL.BANS.RESOURCE")," ")}function wr(e,t){if(e&1){let r=T();a(0,"perun-web-apps-ban-on-entity-list",8),b("updateBan",function(n){I(r);let o=c(2);return E(o.updateResourceBan(n))}),l()}if(e&2){let r=c(2);s("loading",r.loading)("bans",r.resourceBans)("displayedColumns",r.displayedColumns)("filter",r.filter)("updatePolicy","updateBan_BanOnResource_policy")}}function Dr(e,t){if(e&1){let r=T();a(0,"perun-web-apps-debounce-filter",5),b("filter",function(n){I(r);let o=c();return E(o.filter=n)}),l(),a(1,"div",6),d(2,wr,1,5,"perun-web-apps-ban-on-entity-list",7),l()}if(e&2){let r=c(),i=x(14);s("placeholder","USER_DETAIL.BANS.FILTER"),p(2),s("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",i)}}function Lr(e,t){e&1&&(_(0),u(1,"translate")),e&2&&v(" ",f(1,1,"USER_DETAIL.BANS.FACILITY")," ")}function Br(e,t){if(e&1){let r=T();a(0,"perun-web-apps-ban-on-entity-list",8),b("updateBan",function(n){I(r);let o=c(2);return E(o.updateFacilityBan(n))}),l()}if(e&2){let r=c(2);s("loading",r.loading)("bans",r.facilityBans)("displayedColumns",r.displayedColumns)("filter",r.filter)("updatePolicy","updateBan_BanOnFacility_policy")}}function Nr(e,t){if(e&1){let r=T();a(0,"perun-web-apps-debounce-filter",5),b("filter",function(n){I(r);let o=c();return E(o.filter=n)}),l(),a(1,"div",6),d(2,Br,1,5,"perun-web-apps-ban-on-entity-list",7),l()}if(e&2){let r=c(),i=x(14);s("placeholder","USER_DETAIL.BANS.FILTER"),p(2),s("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",i)}}function Pr(e,t){e&1&&h(0,"perun-web-apps-loading-table")}var ut=(()=>{let t=class t{constructor(i,n,o,g,y){this.voService=i,this.resourceService=n,this.facilityService=o,this.entityService=g,this.dialog=y,this.loading=!1,this.voBans=[],this.resourceBans=[],this.facilityBans=[],this.filter="",this.displayedColumns=["banId","targetId","targetName","description","expiration","edit"]}ngOnInit(){this.loading=!0,this.user=this.entityService.getEntity(),this.refreshVoBans()}refreshVoBans(){this.loading=!0,this.voService.getEnrichedVoBansForUser(this.user.id).subscribe({next:i=>{this.voBans=i,this.loading=!1},error:()=>this.loading=!1})}refreshResourceBans(){this.loading=!0,this.resourceService.getEnrichedBansForUser(this.user.id).subscribe({next:i=>{this.resourceBans=i,this.loading=!1},error:()=>this.loading=!1})}refreshFacilityBans(){this.loading=!0,this.facilityService.getEnricheFacilitydBansForUser(this.user.id).subscribe({next:i=>{this.facilityBans=i,this.loading=!1},error:()=>this.loading=!1})}updateVoBan(i){this.dialog.open($i,this.getConfig(i)).afterClosed().subscribe(o=>{o&&this.refreshVoBans()})}updateResourceBan(i){this.dialog.open(Yi,this.getConfig(i)).afterClosed().subscribe(o=>{o&&this.refreshResourceBans()})}updateFacilityBan(i){this.dialog.open(Ji,this.getConfig(i)).afterClosed().subscribe(o=>{o&&this.refreshFacilityBans()})}getConfig(i){let n=N();return n.width="600px",n.data={ban:i.ban,theme:"user-theme"},n}refresh(i){i.index===0?this.refreshVoBans():i.index===1?this.refreshResourceBans():this.refreshFacilityBans()}};t.\u0275fac=function(n){return new(n||t)(m(It),m(Le),m(Se),m(D),m(V))},t.\u0275cmp=S({type:t,selectors:[["app-user-bans"]],decls:15,vars:3,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false",1,"mt-3",3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["spinner",""],[1,"mt-2","search-field",3,"placeholder","filter"],[1,"position-relative","table-min-height"],[3,"loading","bans","displayedColumns","filter","updatePolicy","updateBan",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","bans","displayedColumns","filter","updatePolicy","updateBan"]],template:function(n,o){n&1&&(a(0,"h1",0),_(1),u(2,"translate"),l(),a(3,"mat-tab-group",1),b("selectedTabChange",function(y){return o.refresh(y)}),a(4,"mat-tab"),d(5,xr,2,3,"ng-template",2)(6,Mr,3,3,"ng-template",3),l(),a(7,"mat-tab"),d(8,Rr,2,3,"ng-template",2)(9,Dr,3,3,"ng-template",3),l(),a(10,"mat-tab"),d(11,Lr,2,3,"ng-template",2)(12,Nr,3,3,"ng-template",3),l()(),d(13,Pr,1,0,"ng-template",null,4,P)),n&2&&(p(),v(" ",f(2,1,"USER_DETAIL.BANS.TITLE"),`
`))},dependencies:[Z,q,K,X,B,J,ki,L,C]});let e=t;return e})();var Or=[{path:"",component:dn,children:[{path:"",component:ln,data:{animation:"UserOverviewPage"}},{path:"attributes",component:mt,data:{animation:"UserAttributesPage"}},{path:"organizations",component:st,data:{animation:"UserOrganizationsPage",showPrincipal:!0}},{path:"groups",component:at,data:{animation:"UserGroupsPage",showPrincipal:!0}},{path:"roles",component:ct,data:{animation:"UserRolesPage"}},{path:"service-identities",component:dt,data:{animation:"UserServiceIdentities"}},{path:"bans",component:ut,data:{animation:"UserBansPage"}},{path:"settings",component:nn,children:[{path:"",component:rn,data:{animation:"UserSettingsOverviewPage"}},{path:"passwordReset",component:We,data:{animation:"PasswordResetPage"}},{path:"guiConfig",component:sn,data:{animation:"UserAppConfigurationPage"}}]}]},{path:"service-identities/:userId",component:fn,children:[{path:"",component:_n},{path:"attributes",component:mt,data:{animation:"UserAttributesPage"}},{path:"organizations",component:st,data:{animation:"UserOrganizationsPage"}},{path:"groups",component:at,data:{animation:"UserGroupsPage"}},{path:"roles",component:ct,data:{animation:"UserRolesPage"}},{path:"service-identities",component:dt,data:{animation:"UserServiceIdentities"}},{path:"bans",component:ut,data:{animation:"UserBansPage"}},{path:"associated-users",component:gn},{path:"authentication",component:In,children:[{path:"",component:vn},{path:"logins",component:Sn},{path:"certificates",component:En},{path:"ssh-keys",component:Vi}]},{path:"mailing-lists",component:hn},{path:"data-quotas",component:bn}]}],Cn=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Ce({type:t}),t.\u0275inj=Ee({imports:[et.forChild(Or),et]});let e=t;return e})();function Fr(e,t){if(e&1){let r=T();a(0,"button",8),b("click",function(){I(r);let n=c();return E(n.addIdentity())}),_(1),u(2,"translate"),l()}e&2&&(p(),v(" ",f(2,1,"USER_DETAIL.IDENTITIES.ADD"),`
`))}function Vr(e,t){if(e&1){let r=T();a(0,"button",9),b("click",function(){I(r);let n=c();return E(n.removeIdentity())}),_(1),u(2,"translate"),l()}if(e&2){let r=c();s("disabled",r.selection.selected.length===0),p(),v(" ",f(2,2,"USER_DETAIL.IDENTITIES.REMOVE"),`
`)}}function Gr(e,t){e&1&&h(0,"perun-web-apps-loading-table")}function kr(e,t){if(e&1&&h(0,"perun-web-apps-user-ext-sources-list",10),e&2){let r=c();s("loading",r.loading)("displayedColumns",r.displayedColumns)("filterValue",r.filterValue)("selection",r.selection)("tableId",r.tableId)("userExtSources",r.userExtSources)}}var Zp=(()=>{let t=class t{constructor(i,n,o,g,y,ie){this.usersManagerService=i,this.storage=n,this.registrarManagerService=o,this.dialog=g,this.route=y,this.authResolver=ie,this.userExtSources=[],this.selection=new oe(!1,[]),this.displayedColumns=["select","id","extSourceName","login","lastAccess"],this.tableId=Qt,this.filterValue=""}ngOnInit(){this.route.parent.params.subscribe(i=>{this.userId=Number(i.userId)}),this.refreshTable()}refreshTable(){this.loading=!0,this.selection.clear(),this.usersManagerService.getRichUserExtSources(this.userId).subscribe(i=>{this.userExtSources=i,this.loading=!1},()=>this.loading=!1)}addIdentity(){let i=N();i.width="1000px",i.data={userId:this.userId},this.dialog.open(qi,i).afterClosed().subscribe(o=>{o&&this.refreshTable()})}removeIdentity(){let i=N();i.width="450px",i.data={showSuccess:!0,theme:"user-theme",userId:this.userId,extSources:this.selection.selected},this.dialog.open(yi,i).afterClosed().subscribe(o=>{o&&this.refreshTable()})}applyFilter(i){this.filterValue=i}};t.\u0275fac=function(n){return new(n||t)(m(w),m(F),m(St),m(V),m(R),m(H))},t.\u0275cmp=S({type:t,selectors:[["app-user-identities"]],decls:11,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["class","me-2 action-button","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","me-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative","table-min-height"],[3,"loading","displayedColumns","filterValue","selection","tableId","userExtSources",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"loading","displayedColumns","filterValue","selection","tableId","userExtSources"]],template:function(n,o){if(n&1&&(a(0,"h1",0),_(1),u(2,"translate"),l(),a(3,"perun-web-apps-refresh-button",1),b("refresh",function(){return o.refreshTable()}),l(),d(4,Fr,3,3,"button",2)(5,Vr,3,4,"button",3),a(6,"perun-web-apps-debounce-filter",4),b("filter",function(y){return o.applyFilter(y)}),l(),d(7,Gr,1,0,"ng-template",null,5,P),a(9,"div",6),d(10,kr,1,6,"perun-web-apps-user-ext-sources-list",7),l()),n&2){let g=x(8);p(),U(f(2,6,"USER_DETAIL.IDENTITIES.TITLE")),p(3),s("ngIf",o.authResolver.isPerunAdmin()),p(),s("ngIf",o.authResolver.isPerunAdmin()),p(),s("placeholder","USER_DETAIL.IDENTITIES.FILTER_PLACEHOLDER"),p(4),s("perunWebAppsLoader",o.loading)("perunWebAppsLoaderIndicator",g)}},dependencies:[M,Q,B,G,Li,J,L,C]});let e=t;return e})();function zr(e,t){e&1&&h(0,"perun-web-apps-loading-table")}function Hr(e,t){if(e&1){let r=T();a(0,"perun-web-apps-vo-search-select",7),b("voSelected",function(n){I(r);let o=c(2);return E(o.loadMember(n))}),l()}if(e&2){let r=c(2);s("vos",r.vos)}}function $r(e,t){e&1&&(_(0),u(1,"translate")),e&2&&v(" ",f(1,1,"USER_DETAIL.ACCOUNTS.STATUS")," ")}function Yr(e,t){e&1&&h(0,"mat-spinner",13)}var yn=(e,t)=>["/organizations",e,"members",t],Qr=()=>["id","recent","name","description","expiration","groupStatus"];function Zr(e,t){if(e&1){let r=T();a(0,"div")(1,"div",14)(2,"span",15),_(3),u(4,"translate"),l(),a(5,"a",16),b("auxclick",function(n){return n.preventDefault()}),_(6),l()(),a(7,"mat-card",17),h(8,"perun-web-apps-member-overview-membership",18),l(),a(9,"p",19),_(10),u(11,"translate"),l(),a(12,"perun-web-apps-groups-list",20),b("refreshTable",function(){I(r);let n=c(4);return E(n.loadMember(n.selectedVo))}),l()()}if(e&2){let r=c(4);p(3),v("",f(4,12,"USER_DETAIL.ACCOUNTS.MEMBER"),":"),p(2),s("perunWebAppsMiddleClickRouterLink",Je(16,yn,r.selectedVo.id.toString(),r.member.id.toString()))("routerLink",Je(19,yn,r.selectedVo.id,r.member.id)),p(),v("",r.member.id," "),p(2),s("member",r.member)("voId",r.selectedVo.id),p(2),U(f(11,14,"USER_DETAIL.ACCOUNTS.GROUPS")),p(2),s("loading",r.loading)("groups",r.groups)("memberId",r.member==null?null:r.member.id)("memberGroupStatus",r.member.groupStatus)("displayedColumns",z(22,Qr))}}function qr(e,t){if(e&1&&d(0,Yr,1,0,"mat-spinner",11)(1,Zr,13,23,"div",12),e&2){let r=c(3);s("ngIf",r.loading),p(),s("ngIf",!r.loading)}}function Kr(e,t){e&1&&(_(0),u(1,"translate")),e&2&&v(" ",f(1,1,"USER_DETAIL.ACCOUNTS.MEMBER_ATT")," ")}function Xr(e,t){e&1&&h(0,"mat-spinner",13)}function Jr(e,t){if(e&1&&h(0,"app-one-entity-attribute-page",22),e&2){let r=c(5);s("entity","member")("entityId",r.member.id)}}function eo(e,t){if(e&1&&d(0,Xr,1,0,"mat-spinner",11)(1,Jr,1,2,"app-one-entity-attribute-page",21),e&2){let r=c(4);s("ngIf",r.loading),p(),s("ngIf",!r.loading)}}function to(e,t){e&1&&(a(0,"mat-tab"),d(1,Kr,2,3,"ng-template",9)(2,eo,2,2,"ng-template",10),l())}function io(e,t){e&1&&(_(0),u(1,"translate")),e&2&&v(" ",f(1,1,"USER_DETAIL.ACCOUNTS.MEMBER_GROUP_ATT")," ")}function no(e,t){e&1&&h(0,"mat-spinner",13)}function ro(e,t){if(e&1&&h(0,"app-two-entity-attribute-page",24),e&2){let r=c(5);s("firstEntity","member")("firstEntityId",r.member.id)("secondEntity","group")}}function oo(e,t){if(e&1&&d(0,no,1,0,"mat-spinner",11)(1,ro,1,3,"app-two-entity-attribute-page",23),e&2){let r=c(4);s("ngIf",r.loading),p(),s("ngIf",!r.loading)}}function so(e,t){e&1&&(a(0,"mat-tab"),d(1,io,2,3,"ng-template",9)(2,oo,2,2,"ng-template",10),l())}function ao(e,t){e&1&&(_(0),u(1,"translate")),e&2&&v(" ",f(1,1,"USER_DETAIL.ACCOUNTS.MEMBER_RESOURCE_ATT")," ")}function po(e,t){e&1&&h(0,"mat-spinner",13)}function lo(e,t){if(e&1&&h(0,"app-two-entity-attribute-page",24),e&2){let r=c(4);s("firstEntity","member")("firstEntityId",r.member.id)("secondEntity","resource")}}function mo(e,t){if(e&1&&d(0,po,1,0,"mat-spinner",11)(1,lo,1,3,"app-two-entity-attribute-page",23),e&2){let r=c(3);s("ngIf",r.loading),p(),s("ngIf",!r.loading)}}function co(e,t){if(e&1&&(a(0,"mat-tab-group",8)(1,"mat-tab"),d(2,$r,2,3,"ng-template",9)(3,qr,2,2,"ng-template",10),l(),d(4,to,3,0,"mat-tab",2)(5,so,3,0,"mat-tab",2),a(6,"mat-tab"),d(7,ao,2,3,"ng-template",9)(8,mo,2,2,"ng-template",10),l()()),e&2){let r=c(2),i=x(4);p(4),s("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",i),p(),s("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",i)}}function uo(e,t){e&1&&(a(0,"perun-web-apps-alert",25),_(1),u(2,"translate"),l()),e&2&&(p(),U(f(2,1,"USER_DETAIL.ACCOUNTS.NO_VOS")))}function fo(e,t){if(e&1&&(a(0,"div")(1,"div",3),d(2,Hr,1,1,"perun-web-apps-vo-search-select",4),l(),d(3,co,9,4,"mat-tab-group",5)(4,uo,3,3,"perun-web-apps-alert",6),l()),e&2){let r=c();p(2),s("ngIf",!(r.initLoading||r.vos.length===0)),p(),s("ngIf",!(r.initLoading||r.vos.length===0)),p(),s("ngIf",!r.initLoading&&r.vos.length===0)}}var hl=(()=>{let t=class t{constructor(i,n,o,g){this.route=i,this.usersService=n,this.membersService=o,this.groupService=g,this.initLoading=!1,this.loading=!1,this.vos=[],this.selectedVo=null,this.member=null,this.groups=[]}ngOnInit(){this.initLoading=!0,this.route.parent.params.subscribe(i=>{this.userId=Number(i.userId),this.usersService.getVosWhereUserIsMember(this.userId).subscribe({next:n=>{this.vos=n,this.vos.length&&this.loadMember(this.vos.sort(Pe)[0]),this.initLoading=!1},error:()=>this.initLoading=!1})})}loadMember(i){this.loading=!0,this.selectedVo=i,this.membersService.getMemberByUser(this.selectedVo.id,this.userId).subscribe({next:n=>{this.membersService.getRichMemberWithAttributes(n.id).subscribe({next:o=>{this.member=o,this.groupService.getMemberRichGroupsWithAttributesByNames(this.member.id,[ne.MEMBER_DEF_GROUP_EXPIRATION,ne.MEMBER_GROUP_STATUS]).subscribe({next:g=>{this.groups=g,this.loading=!1},error:()=>this.loading=!1})},error:()=>this.loading=!1})},error:()=>this.loading=!1})}};t.\u0275fac=function(n){return new(n||t)(m(R),m(w),m(De),m(we))},t.\u0275cmp=S({type:t,selectors:[["app-perun-web-apps-user-accounts"]],decls:6,vars:5,consts:[[1,"page-title"],["spinner1",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[1,"d-flex"],["class","w-50",3,"vos","voSelected",4,"ngIf"],["mat-stretch-tabs","false",4,"ngIf"],["alert_type","warn",4,"ngIf"],[1,"w-50",3,"vos","voSelected"],["mat-stretch-tabs","false"],["matTabLabel",""],["matTabContent",""],["class","ms-auto me-auto",4,"ngIf"],[4,"ngIf"],[1,"ms-auto","me-auto"],[1,"mt-4","mb-4"],[1,"subtitle","me-2"],[1,"member-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],["appearance","outlined",1,"mat-elevation-z3","membership-card"],[3,"member","voId"],[1,"mt-4","subtitle"],[3,"loading","groups","memberId","memberGroupStatus","displayedColumns","refreshTable"],[3,"entity","entityId",4,"ngIf"],[3,"entity","entityId"],[3,"firstEntity","firstEntityId","secondEntity",4,"ngIf"],[3,"firstEntity","firstEntityId","secondEntity"],["alert_type","warn"]],template:function(n,o){if(n&1&&(a(0,"h1",0),_(1),u(2,"translate"),l(),d(3,zr,1,0,"ng-template",null,1,P)(5,fo,5,3,"div",2)),n&2){let g=x(4);p(),U(f(2,3,"USER_DETAIL.ACCOUNTS.TITLE")),p(4),s("perunWebAppsLoader",o.initLoading)("perunWebAppsLoaderIndicator",g)}},dependencies:[M,de,Z,q,K,X,se,Oe,Fe,B,ke,Bi,_e,ge,Pi,L,he,$e,C],styles:[".subtitle[_ngcontent-%COMP%]{font-size:1.2rem}.membership-card[_ngcontent-%COMP%]{max-width:400px}"]});let e=t;return e})();function _o(e,t){e&1&&h(0,"perun-web-apps-loading-table")}function go(e,t){if(e&1){let r=T();a(0,"perun-web-apps-facility-search-select",7),b("facilitySelected",function(n){I(r);let o=c(2);return E(o.loadFacility(n))}),l()}if(e&2){let r=c(2);s("facilities",r.facilities)}}function ho(e,t){e&1&&(_(0),u(1,"translate")),e&2&&v(" ",f(1,1,"USER_DETAIL.ASSIGNMENTS.OVERVIEW")," ")}var bo=()=>["id","name","vo","description"];function vo(e,t){if(e&1&&h(0,"perun-web-apps-resources-list",14),e&2){let r=c(4);s("loading",r.loading)("resources",r.resources)("displayedColumns",z(3,bo))}}function So(e,t){if(e&1&&(a(0,"p",11),_(1),u(2,"translate"),l(),a(3,"div",12),d(4,vo,1,4,"perun-web-apps-resources-list",13),l()),e&2){let r=c(3),i=x(4);p(),U(f(2,3,"USER_DETAIL.ASSIGNMENTS.RESOURCES")),p(3),s("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",i)}}function Io(e,t){e&1&&(_(0),u(1,"translate")),e&2&&v(" ",f(1,1,"USER_DETAIL.ASSIGNMENTS.USER_FACILITY_ATT")," ")}function Eo(e,t){e&1&&h(0,"mat-spinner",17)}function Co(e,t){if(e&1&&h(0,"app-two-entity-attribute-page",18),e&2){let r=c(4);s("firstEntity","user")("firstEntityId",r.userId)("secondEntity","facility")("specificSecondEntity",r.selectedFacility)}}function yo(e,t){if(e&1&&d(0,Eo,1,0,"mat-spinner",15)(1,Co,1,4,"app-two-entity-attribute-page",16),e&2){let r=c(3);s("ngIf",r.loading),p(),s("ngIf",!r.loading)}}function To(e,t){e&1&&(_(0),u(1,"translate")),e&2&&v(" ",f(1,1,"USER_DETAIL.ASSIGNMENTS.MEMBER_RESOURCE_ATT")," ")}function Uo(e,t){e&1&&h(0,"mat-spinner",17)}function xo(e,t){if(e&1&&h(0,"app-two-entity-attribute-page",20),e&2){let r=c(4);s("firstEntity","user")("firstEntityId",r.userId)("secondEntity","resource")("facilityId",r.selectedFacility.id)}}function Ao(e,t){if(e&1&&d(0,Uo,1,0,"mat-spinner",15)(1,xo,1,4,"app-two-entity-attribute-page",19),e&2){let r=c(3);s("ngIf",r.loading),p(),s("ngIf",!r.loading)}}function Mo(e,t){e&1&&(a(0,"mat-tab-group",8)(1,"mat-tab"),d(2,ho,2,3,"ng-template",9)(3,So,5,5,"ng-template",10),l(),a(4,"mat-tab"),d(5,Io,2,3,"ng-template",9)(6,yo,2,2,"ng-template",10),l(),a(7,"mat-tab"),d(8,To,2,3,"ng-template",9)(9,Ao,2,2,"ng-template",10),l()())}function Ro(e,t){e&1&&(a(0,"perun-web-apps-alert",21),_(1),u(2,"translate"),l()),e&2&&(p(),U(f(2,1,"USER_DETAIL.ASSIGNMENTS.NO_FACILITIES")))}function wo(e,t){if(e&1&&(a(0,"div")(1,"div",3),d(2,go,1,1,"perun-web-apps-facility-search-select",4),l(),d(3,Mo,10,0,"mat-tab-group",5)(4,Ro,3,3,"perun-web-apps-alert",6),l()),e&2){let r=c();p(2),s("ngIf",!(r.initLoading||r.facilities.length===0)),p(),s("ngIf",!(r.initLoading||r.facilities.length===0)),p(),s("ngIf",!r.initLoading&&r.facilities.length===0)}}var Tl=(()=>{let t=class t{constructor(i,n,o,g){this.route=i,this.facilityService=n,this.usersService=o,this.resourcesService=g,this.initLoading=!0,this.loading=!1,this.facilities=[],this.selectedFacility=null,this.member=null,this.resources=[]}ngOnInit(){this.initLoading=!0,this.route.parent.params.subscribe(i=>{this.userId=Number(i.userId),this.facilityService.getAssignedFacilitiesByUser(this.userId).subscribe({next:n=>{this.facilities=n,this.facilities.length&&this.loadFacility(this.facilities.sort(Pe)[0]),this.initLoading=!1},error:()=>this.initLoading=!1})})}loadFacility(i){this.loading=!0,this.selectedFacility=i,this.usersService.getAssociatedResourcesForUser(this.selectedFacility.id,this.userId).subscribe({next:n=>{this.resourcesService.getRichResourcesByIds(n.map(o=>o.id)).subscribe({next:o=>{this.resources=o,this.loading=!1},error:()=>this.loading=!1})},error:()=>this.loading=!1})}};t.\u0275fac=function(n){return new(n||t)(m(R),m(Se),m(w),m(Le))},t.\u0275cmp=S({type:t,selectors:[["app-perun-web-apps-user-assignments"]],decls:6,vars:5,consts:[[1,"page-title"],["spinner1",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[1,"d-flex"],["class","w-50",3,"facilities","facilitySelected",4,"ngIf"],["mat-stretch-tabs","false",4,"ngIf"],["alert_type","warn",4,"ngIf"],[1,"w-50",3,"facilities","facilitySelected"],["mat-stretch-tabs","false"],["matTabLabel",""],["matTabContent",""],[1,"mt-4","subtitle"],[1,"position-relative","table-min-height"],[3,"loading","resources","displayedColumns",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","resources","displayedColumns"],["class","ms-auto me-auto",4,"ngIf"],[3,"firstEntity","firstEntityId","secondEntity","specificSecondEntity",4,"ngIf"],[1,"ms-auto","me-auto"],[3,"firstEntity","firstEntityId","secondEntity","specificSecondEntity"],[3,"firstEntity","firstEntityId","secondEntity","facilityId",4,"ngIf"],[3,"firstEntity","firstEntityId","secondEntity","facilityId"],["alert_type","warn"]],template:function(n,o){if(n&1&&(a(0,"h1",0),_(1),u(2,"translate"),l(),d(3,_o,1,0,"ng-template",null,1,P)(5,wo,5,3,"div",2)),n&2){let g=x(4);p(),U(f(2,3,"USER_DETAIL.ASSIGNMENTS.TITLE")),p(4),s("perunWebAppsLoader",o.initLoading)("perunWebAppsLoaderIndicator",g)}},dependencies:[M,Z,q,K,X,se,Fe,B,ot,Ni,L,he,C],styles:[".subtitle[_ngcontent-%COMP%]{font-size:1.2rem}"]});let e=t;return e})();var vc=(()=>{let t=class t{constructor(i){this.translate=i,i.addLangs(["en","cs"])}};t.\u0275fac=function(n){return new(n||t)(gt(Et))},t.\u0275mod=Ce({type:t}),t.\u0275inj=Ee({imports:[bt,Cn,zi,Zt,wt,Lt,Dt,Kt,hi,ri,Ct.forChild({}),tt,bi,_i,vi,Mi,tt,ii,At,Nt,Zi,oi,Qi,Pt,Si,gi,Tt,qt,ni,Ut,Ot,nt,si,wi,nt,Ii,Xt,yt,Ei,xi,Gi,ji,Gt,Ui,en]});let e=t;return e})();export{ln as a,mt as b,ct as c,dt as d,Zp as e,gn as f,hl as g,ut as h,Tl as i,vc as j};
