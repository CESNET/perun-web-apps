import{a as Mo}from"./chunk-SNWGTD2Z.js";import{c as To,d as Io,f as Do}from"./chunk-FLZRQCEZ.js";import{b as Jt}from"./chunk-WTPDKVAL.js";import{a as Zt}from"./chunk-LSWI4NHO.js";import{$c as tt,$d as gt,$h as po,Aa as Ce,Ad as ze,Ag as eo,Ba as b,Bc as We,Bh as ao,Bi as Yt,Ca as S,Cc as x,Da as u,Dc as y,De as $i,Ea as Ai,Ed as $e,Ej as Xt,Fa as Ti,Fd as ki,Fe as Bt,G as hi,Ge as Nt,Ha as st,Hd as Fi,I as fi,Ia as lt,Ic as ne,Id as Lt,Ja as ct,K as Si,Ka as w,Ki as nt,La as Re,Lb as qe,Lc as Ze,Lh as so,Li as De,Ma as F,Mc as Gi,Md as V,Mh as lo,Mi as ho,N as Ci,Na as d,Oa as I,Oc as Li,Od as Wi,Of as k,Pa as f,Pc as yt,Pe as Ut,Qa as Ye,Qb as Qe,Qc as Vi,Qd as Hi,Qe as Pt,Ra as Ii,Rb as oi,Rc as Bi,Re as jt,S as g,Sb as ge,Sc as He,Sd as Vt,Se as kt,Sf as Xi,Sh as co,Sj as fo,T as h,Ta as ee,Tc as wt,Te as Ft,Tj as So,Ua as te,Ue as Wt,Uj as Co,V as vi,Va as ie,Ve as Ht,Vi as qt,W as Ri,Wa as se,Wb as wi,Wc as be,Wj as pi,Xa as pe,Xb as Mt,Xc as Je,Xf as X,Xg as li,Xj as vo,Ya as Tt,Yb as Ke,Yc as Ee,Yf as zt,Za as de,Zc as et,Ze as ve,Zg as to,_ as bi,_a as ue,_b as pt,_c as Ni,_e as Yi,aa as n,ad as Ot,ai as mo,bd as B,bk as Ro,c as ui,cb as c,cd as O,d as _e,db as p,de as zi,ea as l,eb as bt,ec as Oi,ed as dt,ee as Ie,fa as M,fb as Mi,fd as mt,fe as P,ff as qi,fk as bo,gd as ut,ge as W,gh as io,hd as _t,he as H,hg as ai,hk as Eo,ib as G,ic as Xe,id as Ae,ie as Me,ik as Ao,ja as Ei,jb as It,jc as he,jd as Te,je as z,jj as ae,k as _i,ka as R,kd as re,ke as $,l as gi,la as Ct,lc as Dt,ld as me,le as Y,li as uo,mc as xt,me as q,mf as Q,mj as Qt,nc as U,oa as vt,ob as Di,oc as we,oi as ci,pb as xi,pc as Oe,pf as Qi,qa as E,qb as yi,qc as Ge,qf as Ki,ra as A,rc as Le,rf as ni,sa as Rt,sc as Ve,sf as ri,ta as xe,tb as D,tc as Be,td as it,ti as _o,ua as ye,uc as Ne,ud as ot,ug as ht,ui as go,va as _,vc as Ue,vd as Ui,wa as r,wc as Pe,wd as Pi,wg as Zi,xa as a,xc as je,xd as L,xg as $t,xh as oo,ya as v,yc as ke,yd as ji,yg as si,yh as no,yj as Kt,za as Se,zc as Fe,zd as Gt,zg as Ji,zh as ro}from"./chunk-UBNEIEIQ.js";var ei=(()=>{class t{constructor(){this.entityDetailChange=new Ct}reloadEntityDetail(){this.entityDetailChange.emit()}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275prov=Ci({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var yo=(t=class{})=>class extends t{constructor(){super(...arguments),this.destroyed$=new ui}ngOnDestroy(){this.destroyed$.next()}};var Xo=()=>({color:"black"}),wo=t=>[t],Oo=t=>["/organizations",t],Go=t=>["/facilities",t];function Zo(t,m){t&1&&v(0,"mat-spinner",1)}function Jo(t,m){if(t&1){let e=b();r(0,"button",12),c(1,"translate"),S("click",function(){g(e);let i=u(2);return h(i.editResource())}),r(2,"mat-icon"),d(3,"edit"),a()()}t&2&&_("matTooltip",se(p(1,2,"RESOURCE_DETAIL.EDIT")))}function en(t,m){if(t&1){let e=b();r(0,"button",13),c(1,"translate"),S("click",function(){g(e);let i=u(2);return h(i.deleteResource())}),r(2,"mat-icon"),d(3,"delete_forever"),a()()}t&2&&_("matTooltip",se(p(1,2,"RESOURCE_DETAIL.DELETE")))}function tn(t,m){if(t&1){let e=b();r(0,"a",6),S("auxclick",function(i){return g(e),h(i.preventDefault())}),d(1),a()}if(t&2){let e=u(2);_("perunWebAppsMiddleClickRouterLink",ue(4,Oo,e.resource.vo.id.toString()))("routerLink",ue(6,Oo,e.resource.vo.id)),vt("data-cy",e.resource.vo.name),n(),I(e.resource.vo.name)}}function on(t,m){if(t&1&&(r(0,"span"),d(1),a()),t&2){let e=u(2);n(),f(" ",e.resource.vo.name," ")}}function nn(t,m){if(t&1){let e=b();r(0,"a",6),S("auxclick",function(i){return g(e),h(i.preventDefault())}),d(1),a()}if(t&2){let e=u(2);_("perunWebAppsMiddleClickRouterLink",ue(4,Go,e.resource.facilityId.toString()))("routerLink",ue(6,Go,e.resource.facilityId)),vt("data-cy",e.resource.facility.name),n(),I(e.resource.facility.name)}}function rn(t,m){if(t&1&&(r(0,"span"),d(1),a()),t&2){let e=u(2);n(),f(" ",e.resource.facility.name," ")}}function an(t,m){if(t&1){let e=b();r(0,"div")(1,"div",2),v(2,"mat-icon",3),c(3,"translate"),r(4,"div",4)(5,"div",5)(6,"a",6),S("auxclick",function(i){return g(e),h(i.preventDefault())}),d(7),a(),r(8,"span",7),d(9),a(),E(10,Jo,4,4,"button",8),E(11,en,4,4,"button",9),a(),r(12,"div"),d(13),c(14,"translate"),a(),r(15,"span",10),d(16),c(17,"translate"),c(18,"translate"),E(19,tn,2,8,"a",11),E(20,on,2,1,"span"),d(21),c(22,"translate"),E(23,nn,2,8,"a",11),E(24,rn,2,1,"span"),d(25),c(26,"translate"),a()()(),v(27,"app-animated-router-outlet"),a()}if(t&2){let e=u();n(2),_("matTooltip",se(p(3,22,"RESOURCE_DETAIL.ENTITY")))("ngStyle",de(34,Xo)),n(4),_("perunWebAppsMiddleClickRouterLink",ue(35,wo,e.baseUrl))("routerLink",ue(37,wo,e.baseUrl)),n(),f(" ",e.resource.name," "),n(2),f(" \xA0#",e.resource.id," "),n(),A(e.editResourceAuth?10:-1),n(),A(e.deleteAuth?11:-1),n(2),Ye("",p(14,24,"RESOURCE_DETAIL.UUID"),": ",e.resource.uuid),n(3),Ye(" ",p(17,26,"RESOURCE_DETAIL.ENTITY"),", ",p(18,28,"RESOURCE_DETAIL.VO"),": "),n(3),A(e.voLinkAuth?19:-1),n(),A(e.voLinkAuth?-1:20),n(),Ye(" #",e.resource.voId,", ",p(22,30,"RESOURCE_DETAIL.FACILITY"),": "),n(2),A(e.facilityLinkAuth?23:-1),n(),A(e.facilityLinkAuth?-1:24),n(),Ii(" #",e.resource.facilityId,", ",p(26,32,"RESOURCE_DETAIL.DESCRIPTION"),": ",e.resource.description," ")}}var Os=(()=>{class t extends yo(){constructor(e,o,i,s,C,T,N,J,fe,at,St){super(),this.route=e,this.facilityManager=o,this.vosManagerService=i,this.resourcesManager=s,this.sideMenuService=C,this.sideMenuItemService=T,this.dialog=N,this.guiAuthResolver=J,this.router=fe,this.entityStorageService=at,this.reloadEntityDetail=St,this.underVoUrl=!1,this.deleteAuth=!1,this.baseUrl="",this.loading=!1}ngOnInit(){this.reloadData(),this.reloadEntityDetail.entityDetailChange.pipe(fi(this.destroyed$)).subscribe(()=>{this.reloadData()})}reloadData(){this.loading=!0,this.route.params.subscribe(e=>{let o=Number(e.resourceId);this.resourcesManager.getRichResourceById(o).subscribe(i=>{this.resource=i,this.entityStorageService.setEntityAndPathParam({id:i.id,voId:i.voId,facilityId:i.facilityId,beanName:"Resource"},zi.Resource),this.setAuth(),this.route.parent.snapshot.url[0].path==="facilities"?(this.baseUrl=new ai().transform(i,!1),this.facilityManager.getFacilityById(i.facilityId).subscribe(s=>{this.facility=s,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)):(this.baseUrl=new ai().transform(i,!0),this.vosManagerService.getVoById(i.voId).subscribe(s=>{this.vo=s,this.underVoUrl=!0,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)),qi("resources",this.resource)})})}setMenuItems(){let e,o=this.sideMenuItemService.parseResource(this.resource,this.underVoUrl);this.underVoUrl?(e=this.sideMenuItemService.parseVo(this.vo),this.sideMenuService.setAccessMenuItems([e,o])):(e=this.sideMenuItemService.parseFacility(this.facility),this.sideMenuService.setFacilityMenuItems([e,o]))}editResource(){let e;this.resourcesManager.getResourceById(this.resource.id).subscribe(o=>{e=o;let i=Q();i.width="450px",i.data={theme:"resource-theme",resource:e,dialogType:_o.RESOURCE},this.dialog.open(go,i).afterClosed().subscribe(C=>{C&&this.resourcesManager.getRichResourceById(this.resource.id).subscribe(T=>{this.resource=T,this.setMenuItems()})})})}deleteResource(){let e=Q();e.width="500px",e.data={theme:"resource-theme",resources:[this.resource]},this.dialog.open(Mo,e).afterClosed().subscribe(i=>{i&&this.router.navigate(["../"],{relativeTo:this.route,queryParamsHandling:"preserve"})})}setAuth(){this.facilityLinkAuth=this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.resource]),this.editResourceAuth=this.guiAuthResolver.isAuthorized("updateResource_Resource_policy",[this.resource]),this.voLinkAuth=this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.resource]),this.deleteAuth=this.guiAuthResolver.isAuthorized("deleteResource_Resource_policy",[this.resource])}static{this.\u0275fac=function(o){return new(o||t)(l(ne),l(Fi),l(Vt),l(V),l(Eo),l(Ao),l(Me),l(P),l(Ze),l(X),l(ei))}}static{this.\u0275cmp=M({type:t,selectors:[["app-resource-detail-page"]],features:[Ei],decls:4,vars:2,consts:[[1,"container-fluid","ps-xl-5","pe-xl-5","resource-theme"],[1,"me-auto","ms-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-resource-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"resource-link",3,"auxclick","perunWebAppsMiddleClickRouterLink","routerLink"],[1,"text-muted"],["aria-label","Edit resource","mat-icon-button","",3,"matTooltip"],["mat-icon-button","",3,"matTooltip"],[1,"mt-1","entity-info"],[1,"resource-link",3,"perunWebAppsMiddleClickRouterLink","routerLink"],["aria-label","Edit resource","mat-icon-button","",3,"click","matTooltip"],["mat-icon-button","",3,"click","matTooltip"]],template:function(o,i){o&1&&(r(0,"div",0),v(1,"perun-web-apps-back-button"),E(2,Zo,1,0,"mat-spinner",1),E(3,an,28,39,"div"),a()),o&2&&(n(2),A(i.loading?2:-1),n(),A(!i.loading&&i.resource!==void 0?3:-1))},dependencies:[D,Di,O,Ot,_t,ut,Pi,bo,ho,ji,Zt,Li,Gi,mt,dt,y,qe,x],styles:[".break-line[_ngcontent-%COMP%]{display:inline-block}"],data:{animation:[Kt]}})}}return t})();function sn(t,m){t&1&&v(0,"mat-spinner",0)}function ln(t,m){if(t&1&&(r(0,"div"),v(1,"perun-web-apps-menu-buttons-field",1)(2,"perun-web-apps-expandable-tiles",2),a()),t&2){let e=u();n(),_("items",e.items),n(),_("items",e.settingsItems)("title","MENU_ITEMS.RESOURCE.SETTINGS")("sectionId","settings")}}var Ws=(()=>{class t{constructor(e,o,i,s,C){this.resourcesManager=e,this.route=o,this.guiAuthResolver=i,this.entityStorageService=s,this.routePolicyService=C,this.items=[],this.settingsItems=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity();let e=this.route.parent.parent.snapshot.url[0].path==="facilities";this.setItems(e),this.setSettingsItems(e),this.loading=!1}setItems(e){let o=e?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`;this.items=[],this.routePolicyService.canNavigate("resources-groups",this.resource)&&this.items.push({cssIcon:"perun-group",url:`${o}/resources/${this.resource.id}/groups`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_GROUPS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-services",this.resource)&&this.items.push({cssIcon:"perun-service",url:`${o}/resources/${this.resource.id}/services`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_SERVICES",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-members",this.resource)&&this.items.push({cssIcon:"perun-user",url:`${o}/resources/${this.resource.id}/members`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_MEMBERS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-tags",this.resource)&&this.items.push({cssIcon:"perun-resource-tags",url:`${o}/resources/${this.resource.id}/tags`,label:"MENU_ITEMS.RESOURCE.RESOURCE_TAGS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-attributes",this.resource)&&this.items.push({cssIcon:"perun-attributes",url:`${o}/resources/${this.resource.id}/attributes`,label:"MENU_ITEMS.RESOURCE.ATTRIBUTES",style:"resource-btn"})}setSettingsItems(e){this.settingsItems=[],this.routePolicyService.canNavigate("resources-settings-managers",this.resource)&&this.settingsItems.push({cssIcon:"perun-manager",url:`${e?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/managers`,label:"MENU_ITEMS.RESOURCE.MANAGERS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-settings-bans",this.resource)&&this.settingsItems.push({cssIcon:"perun-ban",url:`${e?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/bans`,label:"MENU_ITEMS.RESOURCE.BANS",style:"resource-btn"})}static{this.\u0275fac=function(o){return new(o||t)(l(V),l(ne),l(P),l(X),l(zt))}}static{this.\u0275cmp=M({type:t,selectors:[["app-resource-overview"]],hostVars:2,hostBindings:function(o,i){o&2&&Re("router-component",i.true)},decls:2,vars:2,consts:[[1,"me-auto","ms-auto"],[3,"items"],[3,"items","title","sectionId"]],template:function(o,i){o&1&&(E(0,sn,1,0,"mat-spinner",0),E(1,ln,3,4,"div")),o&2&&(A(i.loading?0:-1),n(),A(i.loading?-1:1))},dependencies:[D,qt,Ro,mt,dt],encapsulation:2})}}return t})();function cn(t,m){t&1&&v(0,"perun-web-apps-loading-dialog")}function pn(t,m){t&1&&v(0,"th",14)}function dn(t,m){if(t&1&&(r(0,"td",15),d(1),a()),t&2){let e=m.$implicit;n(),I(e.name)}}function mn(t,m){t&1&&v(0,"tr",16)}function un(t,m){t&1&&v(0,"tr",17)}function _n(t,m){if(t&1){let e=b();r(0,"div")(1,"h1",2),d(2),c(3,"translate"),a(),r(4,"div",3)(5,"p"),d(6),c(7,"translate"),a(),r(8,"div",4),d(9),c(10,"translate"),a(),r(11,"table",5),Se(12,6),R(13,pn,1,0,"th",7)(14,dn,2,1,"td",8),Ce(),R(15,mn,1,0,"tr",9)(16,un,1,0,"tr",10),a()(),r(17,"div",11)(18,"button",12),S("click",function(){g(e);let i=u();return h(i.onCancel())}),d(19),c(20,"translate"),a(),r(21,"button",13),S("click",function(){g(e);let i=u();return h(i.onSubmit())}),d(22),c(23,"translate"),a()()()}if(t&2){let e=u();n(2),I(p(3,9,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.TITLE")),n(4),f(" ",p(7,11,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DESCRIPTION")," "),n(3),f(" ",p(10,13,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.ASK")," "),n(2),_("dataSource",e.dataSource),n(4),_("matHeaderRowDef",e.displayedColumns),n(),_("matRowDefColumns",e.displayedColumns),n(3),f(" ",p(20,15,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.CANCEL")," "),n(2),_("disabled",e.loading),n(),f(" ",p(23,17,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DELETE")," ")}}var No=(()=>{class t{constructor(e,o,i,s,C){this.dialogRef=e,this.data=o,this.notificator=i,this.translate=s,this.resourceManager=C,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.dataSource=new Fe(this.data.groups)}onCancel(){this.dialogRef.close()}onSubmit(){let e=[];for(let o of this.data.groups)e.push(o.id);this.loading=!0,this.resourceManager.removeGroupsFromResource(e,this.data.resourceId).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUP_FROM_RESOURCE.SUCCESS").subscribe(o=>{this.notificator.showSuccess(o),this.dialogRef.close(!0)})},()=>this.loading=!1)}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(k),l(We),l(V))}}static{this.\u0275cmp=M({type:t,selectors:[["app-perun-web-apps-remove-group-from-resource-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","","data-cy","delete-button",1,"ms-2",3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(o,i){if(o&1&&(R(0,cn,1,0,"ng-template",null,0,G),r(2,"div"),R(3,_n,24,19,"div",1),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,q,z,Y,$,me,ke,we,Ge,Ne,Le,Oe,Ue,Ve,Be,Pe,je,y,L,x],encapsulation:2})}}return t})();var hn=["stepper"],fn=()=>["select","id","name","description"];function Sn(t,m){t&1&&v(0,"perun-web-apps-loading-dialog")}function Cn(t,m){t&1&&(d(0),c(1,"translate")),t&2&&I(p(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.GROUPS"))}function vn(t,m){t&1&&(d(0),c(1,"translate")),t&2&&I(p(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.OPTIONS"))}function Rn(t,m){if(t&1){let e=b();r(0,"div",4)(1,"mat-stepper",6,1)(3,"mat-step",7),R(4,Cn,2,3,"ng-template",8),r(5,"perun-web-apps-debounce-filter",9),c(6,"translate"),S("filter",function(i){g(e);let s=u(2);return h(s.applyFilter(i))}),a(),v(7,"perun-web-apps-groups-list",10),a(),r(8,"mat-step"),R(9,vn,2,3,"ng-template",8),r(10,"mat-slide-toggle",11),S("toggleChange",function(){g(e);let i=u(2);return h(i.changeSubgroupsMessage())}),ie("ngModelChange",function(i){g(e);let s=u(2);return te(s.autoAssignSubgroups,i)||(s.autoAssignSubgroups=i),h(i)}),d(11),c(12,"translate"),a(),r(13,"div",12),v(14,"i",13),a(),r(15,"mat-slide-toggle",11),S("toggleChange",function(){g(e);let i=u(2);return h(i.changeInactiveMessage())}),ie("ngModelChange",function(i){g(e);let s=u(2);return te(s.asActive,i)||(s.asActive=i),h(i)}),d(16),c(17,"translate"),a(),r(18,"div",12),d(19),a(),r(20,"mat-slide-toggle",11),S("toggleChange",function(){g(e);let i=u(2);return h(i.changeAsyncMessage())}),ie("ngModelChange",function(i){g(e);let s=u(2);return te(s.async,i)||(s.async=i),h(i)}),d(21),c(22,"translate"),a(),r(23,"div",12),d(24),a()()()()}if(t&2){let e=u(2);n(),_("linear",!0),n(2),_("completed",e.selection.selected.length!==0&&e.canAddGroups()),n(2),_("placeholder",se(p(6,21,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.FILTER_DESCRIPTION"))),n(2),_("loading",e.loading)("disableMembers",!1)("groups",e.unAssignedGroups)("selection",e.selection)("disableRouting",!0)("displayColumns",de(29,fn))("filter",e.filterValue)("tableId",e.tableId),n(3),ee("ngModel",e.autoAssignSubgroups),n(),f(" ",p(12,23,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS")," "),n(3),_("innerHTML",e.autoAssignHint,bi),n(),ee("ngModel",e.asActive),n(),f(" ",p(17,25,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AS_ACTIVE")," "),n(3),f(" ",e.asActiveHint," "),n(),ee("ngModel",e.async),n(),f(" ",p(22,27,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OPT")," "),n(3),f(" ",e.asyncHint," ")}}function bn(t,m){if(t&1){let e=b();r(0,"button",18),S("click",function(){g(e);let i=u(3);return h(i.stepperPrevious())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.BACK")," "))}function En(t,m){if(t&1){let e=b();r(0,"button",19),S("click",function(){g(e);let i=u(3);return h(i.stepperNext())}),d(1),c(2,"translate"),a()}if(t&2){let e=u(3);Re("ms-2",e.stepper!==void 0&&e.stepper.selectedIndex!==0)("ms-auto",!(e.stepper!==void 0&&e.stepper.selectedIndex!==0)),_("disabled",e.loading||e.selection.selected.length===0||!e.canAddGroups()),n(),f(" ",p(2,6,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.NEXT")," ")}}function An(t,m){if(t&1){let e=b();r(0,"button",20),S("click",function(){g(e);let i=u(3);return h(i.onAdd())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ADD_BUTTON")," "))}function Tn(t,m){if(t&1){let e=b();r(0,"div",5)(1,"div")(2,"button",14),S("click",function(){g(e);let i=u(2);return h(i.onCancel())}),d(3),c(4,"translate"),a(),E(5,bn,3,3,"button",15),E(6,En,3,8,"button",16),E(7,An,3,3,"button",17),a()()}if(t&2){let e=u(2);n(3),f(" ",p(4,4,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.CANCEL_BUTTON")," "),n(2),A(e.stepper!==void 0&&e.stepper.selectedIndex!==0?5:-1),n(),A(e.stepper!==void 0&&e.stepper.selectedIndex!==e.stepper._steps.length-1?6:-1),n(),A(e.stepper!==void 0&&e.stepper.selectedIndex===e.stepper._steps.length-1?7:-1)}}function In(t,m){if(t&1&&(r(0,"div")(1,"h1",3),d(2),c(3,"translate"),a(),E(4,Rn,25,30,"div",4),E(5,Tn,8,6,"div",5),a()),t&2){let e=u();n(2),I(p(3,3,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.TITLE")),n(2),A(e.unAssignedGroups?4:-1),n(),A(e.stepper?5:-1)}}var Uo=(()=>{class t{constructor(e,o,i,s,C,T,N,J){this.dialogRef=e,this.data=o,this.notificator=i,this.translate=s,this.resourceManager=C,this.groupService=T,this.guiAuthResolver=N,this.cd=J,this.loading=!1,this.unAssignedGroups=null,this.async=!0,this.autoAssignSubgroups=!1,this.asActive=!0,this.selection=new U(!0,[],!0,(fe,at)=>fe.id===at.id),this.filterValue="",this.tableId=ro}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resource=this.data.resource,this.autoAssignHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT"),this.asActiveHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT"),this.asyncHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT"),this.resourceManager.getAssignedGroups(this.resource.id).subscribe({next:e=>{this.groupService.getAllGroups(this.resource.voId).subscribe({next:o=>{this.unAssignedGroups=this.data.onlyAutoAssignedGroups;for(let i of o)e.findIndex(s=>s.id===i.id)===-1&&this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,i])&&this.unAssignedGroups.push(i);this.loading=!1,this.cd.detectChanges()},error:()=>this.loading=!1})},error:()=>this.loading=!1})}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0;let e=[];for(let o of this.selection.selected)e.push(o.id);this.resourceManager.assignGroupsToResource(e,this.resource.id,this.async,!this.asActive,this.autoAssignSubgroups).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.SUCCESS_MESSAGE").subscribe(o=>{this.notificator.showSuccess(o),this.dialogRef.close(!0)})},()=>this.loading=!1)}applyFilter(e){this.filterValue=e,this.selection.clear()}canAddGroups(){let e=!0;return this.selection.selected.forEach(o=>{this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,o])||(e=!1)}),e}changeSubgroupsMessage(){this.autoAssignHint=this.autoAssignSubgroups?this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT"):this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_ON_HINT")}changeInactiveMessage(){this.asActiveHint=this.asActive?this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_OFF_HINT"):this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT")}changeAsyncMessage(){this.asyncHint=this.async?this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OFF_HINT"):this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT")}stepperPrevious(){this.stepper.previous()}stepperNext(){this.stepper.next()}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(k),l(We),l(V),l(Lt),l(P),l(It))}}static{this.\u0275cmp=M({type:t,selectors:[["app-perun-web-apps-assign-group-to-resource-dialog"]],viewQuery:function(o,i){if(o&1&&st(hn,5),o&2){let s;lt(s=ct())&&(i.stepper=s.first)}},decls:4,vars:5,consts:[["spinner",""],["stepper",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],["mat-dialog-actions","",1,"justify-content-end"],[3,"linear"],[3,"completed"],["matStepLabel",""],[3,"filter","placeholder"],[3,"loading","disableMembers","groups","selection","disableRouting","displayColumns","filter","tableId"],["labelPosition","before",1,"mt-3","slide-text",3,"toggleChange","ngModelChange","ngModel"],[1,"text-muted","new-line","mt-2"],[3,"innerHTML"],["mat-stroked-button","",1,"me-2",3,"click"],["mat-stroked-button","",1,"ms-auto"],["color","accent","mat-flat-button","","type","button","data-cy","next-button",3,"ms-2","ms-auto","disabled"],["color","accent","mat-flat-button","","type","button","data-cy","assign-button",1,"ms-2"],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","","type","button","data-cy","next-button",3,"click","disabled"],["color","accent","mat-flat-button","","type","button","data-cy","assign-button",1,"ms-2",3,"click"]],template:function(o,i){if(o&1&&(R(0,Sn,1,0,"ng-template",null,0,G),r(2,"div"),R(3,In,6,5,"div",2),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,Ht,Wt,Xe,ge,Ke,he,q,z,Y,$,me,ae,y,nt,$i,L,Bt,Nt,x],styles:[".slide-text[_ngcontent-%COMP%]{font-size:1.1rem}"]})}}return t})();var Po=t=>[t],Mn=()=>["select","id","indirectGroupAssigment","name","status","description"];function Dn(t,m){if(t&1){let e=b();r(0,"button",9),S("click",function(){g(e);let i=u();return h(i.addGroup())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"RESOURCE_DETAIL.ASSIGNED_GROUPS.ADD_GROUP")," "))}function xn(t,m){t&1&&v(0,"perun-web-apps-loading-table")}function yn(t,m){if(t&1){let e=b();r(0,"perun-web-apps-groups-list",10),S("refreshTable",function(){g(e);let i=u();return h(i.loadAllGroups())}),a()}if(t&2){let e=u();_("loading",e.loading)("disableGroups",!0)("groupsToDisableCheckbox",e.groupsToDisable)("disableMembers",!1)("groups",e.assignedGroups)("disableRouting",e.assignedGroups[0]?!e.guiAuthResolver.isAuthorized("getGroupById_int_policy",ue(12,Po,e.assignedGroups[0])):!1)("displayColumns",de(14,Mn))("filter",e.filteredValue)("resourceId",e.resource.id)("selection",e.selected)("tableId",e.tableId)("cacheSubject",e.cacheSubject)}}var zl=(()=>{class t{constructor(e,o,i,s,C){this.route=e,this.resourcesManager=o,this.dialog=i,this.guiAuthResolver=s,this.entityStorageService=C,this.assignedGroups=[],this.selected=new U(!0,[],!0,(T,N)=>T.id===N.id),this.filteredValue="",this.tableId=oo,this.cacheSubject=new _e(!0)}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.loadAllGroups()}loadAllGroups(){this.loading=!0,this.resourcesManager.getGroupAssignments(this.resource.id,[ve.GROUP_SYNC_ENABLED]).subscribe(e=>{this.assignedGroups=e.map(C=>{let T=C.enrichedGroup.group;return T.status=C.status,T.failureCause=C.failureCause,T.sourceGroupId=C.sourceGroupId,T});let o=this.assignedGroups.map(C=>C.id),i=this.assignedGroups.filter((C,T)=>o.indexOf(C.id)===T),s=this.assignedGroups.filter((C,T)=>{let N=o.indexOf(C.id);return N!==T&&(C.sourceGroupId===null||this.assignedGroups[N].sourceGroupId===null)}).map(C=>C.id);i.forEach(C=>{s.includes(C.id)&&(C.moreTypesOfAssignment=!0)}),this.assignedGroups=i,this.groupsToDisable=new Set(this.assignedGroups.filter(C=>!!C.sourceGroupId&&!C.moreTypesOfAssignment).map(C=>C.id)),this.cacheSubject.next(!0),this.selected.clear(),this.loading=!1})}addGroup(){let e=Q();e.width="1000px",e.data={theme:"resource-theme",resource:this.resource,onlyAutoAssignedGroups:this.assignedGroups.filter(i=>this.groupsToDisable.has(i.id))},this.dialog.open(Uo,e).afterClosed().subscribe(i=>{i&&this.loadAllGroups()})}removeGroups(){let e=Q();e.width="500px",e.data={resourceId:this.resource.id,groups:this.selected.selected,theme:"resource-theme"},this.dialog.open(No,e).afterClosed().subscribe(i=>{i&&this.loadAllGroups()})}canRemoveGroups(){let e=!0;return this.selected.selected.forEach(o=>{this.guiAuthResolver.isAuthorized("removeGroupsFromResource_List<Group>_Resource_policy",[this.resource,o])||(e=!1)}),e}applyFilter(e){this.filteredValue=e}static{this.\u0275fac=function(o){return new(o||t)(l(ne),l(V),l(Me),l(P),l(X))}}static{this.\u0275cmp=M({type:t,selectors:[["app-perun-web-apps-resource-groups"]],decls:15,vars:18,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","","data-cy","add-group-button",1,"action-button"],["color","warn","mat-flat-button","","data-cy","remove-group-button",1,"ms-2","me-2",3,"click","disabled"],[3,"matTooltipDisabled","matTooltip"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","disableGroups","groupsToDisableCheckbox","disableMembers","groups","disableRouting","displayColumns","filter","resourceId","selection","tableId","cacheSubject","refreshTable",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","","data-cy","add-group-button",1,"action-button",3,"click"],[3,"refreshTable","loading","disableGroups","groupsToDisableCheckbox","disableMembers","groups","disableRouting","displayColumns","filter","resourceId","selection","tableId","cacheSubject"]],template:function(o,i){if(o&1){let s=b();r(0,"h1",1),d(1),c(2,"translate"),a(),r(3,"perun-web-apps-refresh-button",2),S("refresh",function(){return g(s),h(i.loadAllGroups())}),a(),E(4,Dn,3,3,"button",3),r(5,"button",4),S("click",function(){return g(s),h(i.removeGroups())}),r(6,"span",5),c(7,"translate"),d(8),c(9,"translate"),a()(),r(10,"perun-web-apps-debounce-filter",6),S("filter",function(T){return g(s),h(i.applyFilter(T))}),a(),R(11,xn,1,0,"ng-template",null,0,G),r(13,"div",7),R(14,yn,1,15,"perun-web-apps-groups-list",8),a()}if(o&2){let s=w(12);n(),I(p(2,10,"RESOURCE_DETAIL.ASSIGNED_GROUPS.TITLE")),n(3),A(i.guiAuthResolver.isAuthorized("getAllGroups_Vo_policy",ue(16,Po,i.resource))?4:-1),n(),_("disabled",i.loading||i.selected.selected.length===0||!i.canRemoveGroups()),n(),_("matTooltip",se(p(7,12,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_TOOLTIP")))("matTooltipDisabled",i.canRemoveGroups()),n(2),f(" ",p(9,14,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_GROUP")," "),n(2),_("placeholder","RESOURCE_DETAIL.ASSIGNED_GROUPS.FILTER_GROUPS"),n(4),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,ae,De,y,qe,nt,L,re,x],encapsulation:2})}}return t})();var Kl=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275cmp=M({type:t,selectors:[["app-resource-settings"]],hostVars:2,hostBindings:function(o,i){o&2&&Re("router-component",i.true)},decls:1,vars:0,template:function(o,i){o&1&&v(0,"app-animated-router-outlet")},dependencies:[D,Zt],encapsulation:2,data:{animation:[Kt]}})}}return t})();function wn(t,m){t&1&&v(0,"mat-spinner",0)}function On(t,m){if(t&1&&(r(0,"div"),v(1,"perun-web-apps-menu-buttons-field",1),a()),t&2){let e=u();n(),_("items",e.items)}}var sc=(()=>{class t{constructor(e,o,i,s,C){this.route=e,this.resourceManager=o,this.authResolver=i,this.entityStorageService=s,this.routePolicyService=C,this.items=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.route.parent.parent.parent.snapshot.url[0].path==="facilities"?this.initItems(!1):this.initItems(!0),this.loading=!1}initItems(e){this.items=[],this.routePolicyService.canNavigate("resources-settings-managers",this.resource)&&this.items.push({cssIcon:"perun-manager",url:`${e?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/managers`,label:"MENU_ITEMS.RESOURCE.MANAGERS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-settings-bans",this.resource)&&this.items.push({cssIcon:"perun-ban",url:`${e?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/bans`,label:"MENU_ITEMS.RESOURCE.BANS",style:"resource-btn"})}static{this.\u0275fac=function(o){return new(o||t)(l(ne),l(V),l(P),l(X),l(zt))}}static{this.\u0275cmp=M({type:t,selectors:[["app-resource-settings-overview"]],hostVars:2,hostBindings:function(o,i){o&2&&Re("router-component",i.true)},decls:2,vars:2,consts:[[1,"me-auto","ms-auto"],[3,"items"]],template:function(o,i){o&1&&(E(0,wn,1,0,"mat-spinner",0),E(1,On,2,1,"div")),o&2&&(A(i.loading?0:-1),n(),A(i.loading?-1:1))},dependencies:[D,qt,mt,dt],encapsulation:2})}}return t})();function Ln(t,m){t&1&&(d(0),c(1,"translate")),t&2&&f(" ",p(1,1,"RESOURCE_DETAIL.ENTITY")," ")}function Vn(t,m){if(t&1&&v(0,"app-one-entity-attribute-page",4),t&2){let e=u();_("entityId",e.resource.id)("entity","resource")}}function Bn(t,m){t&1&&(d(0),c(1,"translate"),c(2,"translate")),t&2&&Ye(" ",p(1,2,"RESOURCE_DETAIL.ENTITY")," - ",p(2,4,"MEMBER_DETAIL.ENTITY")," ")}function Nn(t,m){if(t&1&&v(0,"app-two-entity-attribute-page",5),t&2){let e=u(2);_("firstEntity","resource")("firstEntityId",e.resource.id)("secondEntity","member")}}function Un(t,m){t&1&&(r(0,"mat-tab"),R(1,Bn,3,6,"ng-template",2)(2,Nn,1,3,"ng-template",3),a())}function Pn(t,m){t&1&&(d(0),c(1,"translate"),c(2,"translate")),t&2&&Ye(" ",p(1,2,"RESOURCE_DETAIL.ENTITY")," - ",p(2,4,"GROUP_DETAIL.ENTITY")," ")}function jn(t,m){if(t&1&&v(0,"app-two-entity-attribute-page",5),t&2){let e=u(2);_("firstEntity","resource")("firstEntityId",e.resource.id)("secondEntity","group")}}function kn(t,m){t&1&&(r(0,"mat-tab"),R(1,Pn,3,6,"ng-template",2)(2,jn,1,3,"ng-template",3),a())}var Cc=(()=>{class t{constructor(e,o,i){this.authResolver=e,this.resourceManager=o,this.entityStorageService=i}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.resourceGroupAttAuth=this.authResolver.isAuthorized("getGroupAssignments_Resource_policy",[this.resource]),this.resourceMemberAttAuth=this.authResolver.isAuthorized("getAssignedMembersWithStatus_Resource_policy",[this.resource])}static{this.\u0275fac=function(o){return new(o||t)(l(P),l(V),l(X))}}static{this.\u0275cmp=M({type:t,selectors:[["app-resource-attributes"]],hostVars:2,hostBindings:function(o,i){o&2&&Re("router-component",i.true)},decls:10,vars:5,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false"],["matTabLabel",""],["matTabContent",""],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(o,i){o&1&&(r(0,"div")(1,"h1",0),d(2),c(3,"translate"),a(),r(4,"mat-tab-group",1)(5,"mat-tab"),R(6,Ln,2,3,"ng-template",2)(7,Vn,1,2,"ng-template",3),a(),E(8,Un,3,0,"mat-tab"),E(9,kn,3,0,"mat-tab"),a()()),o&2&&(n(2),I(p(3,3,"RESOURCE_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),n(6),A(i.resourceMemberAttAuth?8:-1),n(),A(i.resourceGroupAttAuth?9:-1))},dependencies:[D,To,Io,Ft,Ut,Pt,jt,kt,y,x],encapsulation:2})}}return t})();var Fn=()=>["select","id","name","email","logins","organization"],Wn=(t,m)=>m.roleName;function Hn(t,m){if(t&1&&(r(0,"mat-option",6),d(1),c(2,"displayedRole"),a()),t&2){let e=m.$implicit;_("value",e.roleName),n(),f(" ",p(2,2,e)," ")}}function zn(t,m){t&1&&v(0,"perun-web-apps-loading-table")}function $n(t,m){if(t&1&&v(0,"perun-web-apps-users-list",15),t&2){let e=u(2);_("loading",e.loading)("disableRouting",!0)("selection",e.selection)("displayColumns",de(7,Fn))("tableId",e.tableId)("users",e.users)("cacheSubject",e.cacheSubject)}}function Yn(t,m){if(t&1&&(r(0,"div",10),R(1,$n,1,8,"perun-web-apps-users-list",14),a()),t&2){let e=u(),o=w(25);n(),_("perunWebAppsLoader",e.loading)("perunWebAppsLoaderIndicator",o)}}var jo=(()=>{class t{constructor(e,o,i,s,C,T,N,J,fe){this.dialogRef=e,this.data=o,this.authzService=i,this.usersService=s,this.translate=C,this.notificator=T,this.storeService=N,this.route=J,this.router=fe,this.selection=new U(!0,[],!0,(at,St)=>at.id===St.id),this.users=[],this.firstSearchDone=!1,this.tableId=io,this.cacheSubject=new _e(!0),this.title=this.translate.instant("DIALOGS.ADD_MANAGERS.TITLE"),this.successMessage=this.translate.instant("DIALOGS.ADD_MANAGERS.SUCCESS")}ngOnInit(){this.theme=this.data.theme,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.searchCtrl=new Mt("",[oi.required,oi.pattern(".*[\\S]+.*")])}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.setRoleWithUserComplementaryObject({role:this.selectedRole,users:this.selection.selected.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}onSearchByString(){if(this.searchCtrl.invalid){this.searchCtrl.markAllAsTouched();return}this.loading=!0,this.firstSearchDone=!0,this.cacheSubject.next(!0),this.selection.clear();let e=[ve.USER_DEF_ORGANIZATION,ve.USER_DEF_PREFERRED_MAIL];e=e.concat(this.storeService.getLoginAttributeNames()),this.usersService.findRichUsersWithAttributes(this.searchCtrl.value,e).subscribe({next:o=>{this.users=o,this.loading=!1},error:()=>this.loading=!1})}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l($e),l(Hi),l(ze),l(k),l(Ie),l(ne),l(Ze))}}static{this.\u0275cmp=M({type:t,selectors:[["app-add-manager-dialog"]],decls:34,vars:28,consts:[["spinner",""],["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"me-2"],[3,"valueChange","value"],[3,"value"],[1,"me-2","w-100"],["matInput","","autocomplete","false","data-cy","search-manager-input","perunWebAppsAutoFocus","",3,"keyup.enter","formControl"],["color","accent","data-cy","search-manager-button","mat-flat-button","",1,"ms-auto",3,"click","disabled"],[1,"position-relative","mt-3","table-min-height"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","data-cy","add-manager-button-dialog","mat-flat-button","",1,"ms-2",3,"click","disabled"],[3,"loading","disableRouting","selection","displayColumns","tableId","users","cacheSubject",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","disableRouting","selection","displayColumns","tableId","users","cacheSubject"]],template:function(o,i){if(o&1){let s=b();r(0,"div")(1,"h1",1),d(2),c(3,"translate"),a(),r(4,"div",2)(5,"div",3)(6,"mat-form-field",4)(7,"mat-label"),d(8),c(9,"translate"),a(),r(10,"mat-select",5),ie("valueChange",function(T){return g(s),te(i.selectedRole,T)||(i.selectedRole=T),h(T)}),xe(11,Hn,3,4,"mat-option",6,Wn),a()(),r(13,"mat-form-field",7)(14,"mat-label"),d(15),c(16,"translate"),a(),r(17,"input",8),S("keyup.enter",function(){return g(s),h(i.onSearchByString())}),a(),r(18,"mat-error"),d(19),c(20,"translate"),a()()(),r(21,"button",9),S("click",function(){return g(s),h(i.onSearchByString())}),d(22),c(23,"translate"),a(),R(24,zn,1,0,"ng-template",null,0,G),E(26,Yn,2,2,"div",10),a(),r(27,"div",11)(28,"button",12),S("click",function(){return g(s),h(i.onCancel())}),d(29),c(30,"translate"),a(),r(31,"button",13),S("click",function(){return g(s),h(i.onSubmit())}),d(32),c(33,"translate"),a()()()}o&2&&(F(i.theme),n(2),I(p(3,14,"DIALOGS.ADD_MANAGERS.TITLE")),n(6),I(p(9,16,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),n(2),ee("value",i.selectedRole),n(),ye(i.availableRoles),n(4),I(p(16,18,"DIALOGS.ADD_MANAGERS.DESCRIPTION")),n(2),_("formControl",i.searchCtrl),n(2),f(" ",p(20,20,"DIALOGS.ADD_MANAGERS.EMPTY_SEARCH_MESSAGE")," "),n(2),_("disabled",i.loading),n(),f(" ",p(23,22,"DIALOGS.ADD_MANAGERS.SEARCH")," "),n(4),A(i.firstSearchDone?26:-1),n(3),f(" ",p(30,24,"DIALOGS.ADD_MANAGERS.CANCEL")," "),n(2),_("disabled",i.selection.selected.length===0||i.selectedRole===void 0||i.loading),n(),f(" ",p(33,26,"DIALOGS.ADD_MANAGERS.CREATE")," "))},dependencies:[D,O,B,Ee,be,He,wt,ot,it,tt,et,Je,he,Qe,ge,pt,q,z,Y,$,y,L,Xt,Ui,re,x,ht],styles:[".inline-dialog-items[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]})}}return t})();var qn=t=>({role:t});function Qn(t,m){t&1&&v(0,"perun-web-apps-loading-dialog")}function Kn(t,m){if(t&1&&(r(0,"perun-web-apps-alert",4),d(1),c(2,"translate"),a()),t&2){let e=u(2);n(),f(" ",p(2,1,e.warningMessage)," ")}}function Xn(t,m){if(t&1&&(r(0,"perun-web-apps-alert",4),d(1),c(2,"translate"),c(3,"translate"),a()),t&2){let e=u(2);n(),f(" ",bt(3,3,"DIALOGS.REMOVE_MANAGERS.WARNING_REMOVE_YOURSELF",ue(6,qn,p(2,1,"ROLES."+e.data.role)))," ")}}function Zn(t,m){t&1&&v(0,"th",15)}function Jn(t,m){if(t&1&&(r(0,"td",16),d(1),a()),t&2){let e=m.$implicit;n(),Ye("",e.firstName," ",e.lastName)}}function er(t,m){t&1&&v(0,"tr",17)}function tr(t,m){t&1&&v(0,"tr",18)}function ir(t,m){if(t&1){let e=b();r(0,"div")(1,"h1",2),d(2),c(3,"translate"),a(),r(4,"div",3),E(5,Kn,3,3,"perun-web-apps-alert",4),E(6,Xn,4,8,"perun-web-apps-alert",4),r(7,"p"),d(8),c(9,"translate"),a(),r(10,"div",5),d(11),c(12,"translate"),a(),r(13,"table",6),Se(14,7),R(15,Zn,1,0,"th",8)(16,Jn,2,2,"td",9),Ce(),R(17,er,1,0,"tr",10)(18,tr,1,0,"tr",11),a()(),r(19,"div",12)(20,"button",13),S("click",function(){g(e);let i=u();return h(i.onCancel())}),d(21),c(22,"translate"),a(),r(23,"button",14),S("click",function(){g(e);let i=u();return h(i.onSubmit())}),d(24),c(25,"translate"),a()()()}if(t&2){let e=u();n(2),I(p(3,11,"DIALOGS.REMOVE_MANAGERS.TITLE")),n(3),A(e.doLastWarning?5:-1),n(),A(e.removeSelf?6:-1),n(2),f(" ",p(9,13,"DIALOGS.REMOVE_MANAGERS.DESCRIPTION")," "),n(3),f(" ",p(12,15,"DIALOGS.REMOVE_MANAGERS.ASK")," "),n(2),_("dataSource",e.dataSource),n(4),_("matHeaderRowDef",e.displayedColumns),n(),_("matRowDefColumns",e.displayedColumns),n(3),f(" ",p(22,17,"DIALOGS.REMOVE_MANAGERS.CANCEL")," "),n(2),_("disabled",e.loading),n(),f(" ",p(25,19,"DIALOGS.REMOVE_MANAGERS.DELETE")," ")}}var ko=(()=>{class t{constructor(e,o,i,s,C,T,N){this.dialogRef=e,this.data=o,this.notificator=i,this.translate=s,this.authzService=C,this.store=T,this.authService=N,this.displayedColumns=["name"],this.doLastWarning=!1}ngOnInit(){this.loading=!0,this.dataSource=new Fe(this.data.managers),this.theme=this.data.theme,this.removeSelf=this.data.managers.map(e=>e.id).includes(this.store.getPerunPrincipal().userId)&&!this.authService.isPerunAdmin(),this.theme==="vo-theme"?this.warningMessage="DIALOGS.REMOVE_MANAGERS.WARNING_REMOVE_LAST_VO":this.theme==="facility-theme"&&(this.warningMessage="DIALOGS.REMOVE_MANAGERS.WARNING_REMOVE_LAST_FACILITY"),this.data.checkLastWarning&&(this.data.role===gt.VOADMIN||this.data.role===gt.FACILITYADMIN)?this.authzService.getAuthzAdminGroups(this.data.role.toString(),this.data.complementaryObject.id,this.data.complementaryObject.beanName).subscribe({next:e=>{this.doLastWarning=e.length===0,this.loading=!1},error:()=>{this.loading=!1}}):this.loading=!1}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithUserComplementaryObject({role:this.data.role,users:this.data.managers.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.REMOVE_MANAGERS.SUCCESS")),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(k),l(ze),l($e),l(Ie),l(P))}}static{this.\u0275cmp=M({type:t,selectors:[["app-remove-manager-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],["alert_type","warn"],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","data-cy","remove-manager-button-dialog","mat-flat-button","",1,"ms-2",3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(o,i){if(o&1&&(R(0,Qn,1,0,"ng-template",null,0,G),r(2,"div"),R(3,ir,26,21,"div",1),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,q,z,Y,$,Te,Ae,me,ke,we,Ge,Ne,Le,Oe,Ue,Ve,Be,Pe,je,y,L,x],encapsulation:2})}}return t})();function or(t,m){t&1&&v(0,"perun-web-apps-loading-dialog")}function nr(t,m){if(t&1&&(r(0,"perun-web-apps-alert",4),d(1),c(2,"translate"),a()),t&2){let e=u(2);n(),f(" ",p(2,1,e.warningMessage)," ")}}function rr(t,m){t&1&&v(0,"th",15)}function ar(t,m){if(t&1&&(r(0,"td",16),d(1),a()),t&2){let e=m.$implicit;n(),I(e.name)}}function sr(t,m){t&1&&v(0,"tr",17)}function lr(t,m){t&1&&v(0,"tr",18)}function cr(t,m){if(t&1){let e=b();r(0,"div")(1,"h1",2),d(2),c(3,"translate"),a(),r(4,"div",3),E(5,nr,3,3,"perun-web-apps-alert",4),r(6,"p"),d(7),c(8,"translate"),a(),r(9,"div",5),d(10),c(11,"translate"),a(),r(12,"table",6),Se(13,7),R(14,rr,1,0,"th",8)(15,ar,2,1,"td",9),Ce(),R(16,sr,1,0,"tr",10)(17,lr,1,0,"tr",11),a()(),r(18,"div",12)(19,"button",13),S("click",function(){g(e);let i=u();return h(i.onCancel())}),d(20),c(21,"translate"),a(),r(22,"button",14),S("click",function(){g(e);let i=u();return h(i.onSubmit())}),d(23),c(24,"translate"),a()()()}if(t&2){let e=u();n(2),I(p(3,10,"DIALOGS.REMOVE_GROUPS.TITLE")),n(3),A(e.doLastWarning?5:-1),n(2),f(" ",p(8,12,"DIALOGS.REMOVE_GROUPS.DESCRIPTION")," "),n(3),f(" ",p(11,14,"DIALOGS.REMOVE_GROUPS.ASK")," "),n(2),_("dataSource",e.dataSource),n(4),_("matHeaderRowDef",e.displayedColumns),n(),_("matRowDefColumns",e.displayedColumns),n(3),f(" ",p(21,16,"DIALOGS.REMOVE_GROUPS.CANCEL")," "),n(2),_("disabled",e.loading),n(),f(" ",p(24,18,"DIALOGS.REMOVE_GROUPS.DELETE")," ")}}var Fo=(()=>{class t{constructor(e,o,i,s,C){this.dialogRef=e,this.data=o,this.notificator=i,this.translate=s,this.authzService=C,this.displayedColumns=["name"],this.doLastWarning=!1}ngOnInit(){this.loading=!0,this.dataSource=new Fe(this.data.groups),this.theme=this.data.theme,this.theme==="vo-theme"?this.warningMessage="DIALOGS.REMOVE_GROUPS.WARNING_REMOVE_LAST_VO":this.theme==="facility-theme"&&(this.warningMessage="DIALOGS.REMOVE_GROUPS.WARNING_REMOVE_LAST_FACILITY"),this.data.doCheckLastWarning&&(this.data.role===gt.VOADMIN||this.data.role===gt.FACILITYADMIN)?this.authzService.getAuthzRichAdmins(this.data.role.toString(),this.data.complementaryObject.id,this.data.complementaryObject.beanName,[ve.USER_DEF_ORGANIZATION],!1,!0).subscribe({next:e=>{this.doLastWarning=e.length===0,this.loading=!1},error:()=>{this.loading=!1}}):this.loading=!1}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithGroupComplementaryObject({role:this.data.role,authorizedGroups:this.data.groups.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.REMOVE_GROUPS.SUCCESS")),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(k),l(ze),l($e))}}static{this.\u0275cmp=M({type:t,selectors:[["app-remove-group-manager-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],["alert_type","warn"],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(o,i){if(o&1&&(R(0,or,1,0,"ng-template",null,0,G),r(2,"div"),R(3,cr,25,20,"div",1),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,q,z,Y,$,Te,Ae,me,ke,we,Ge,Ne,Le,Oe,Ue,Ve,Be,Pe,je,y,L,x],encapsulation:2})}}return t})();var pr=()=>["select","id","name","description"],dr=(t,m)=>m.roleName,mr=(t,m)=>m.id;function ur(t,m){if(t&1&&(r(0,"mat-option",7),d(1),c(2,"displayedRole"),a()),t&2){let e=m.$implicit;_("value",e.roleName),n(),f(" ",p(2,2,e)," ")}}function _r(t,m){if(t&1&&(r(0,"mat-option",7),d(1),r(2,"span",16),d(3),a()()),t&2){let e=m.$implicit;_("value",e),n(),f(" ",e.name," "),n(2),I(e.shortName)}}function gr(t,m){if(t&1){let e=b();r(0,"perun-web-apps-debounce-filter",17),c(1,"translate"),S("filter",function(i){g(e);let s=u();return h(s.applyFilter(i))}),a()}t&2&&_("placeholder",se(p(1,2,"DIALOGS.ADD_GROUPS.FILTER_GROUPS")))}function hr(t,m){t&1&&v(0,"perun-web-apps-loading-table")}function fr(t,m){if(t&1&&v(0,"perun-web-apps-groups-list",19),t&2){let e=u(2);_("loading",e.loading)("disableMembers",!1)("disableRouting",!0)("displayColumns",de(8,pr))("selection",e.selection)("groups",e.groups)("filter",e.filterValue)("tableId",e.tableId)}}function Sr(t,m){if(t&1&&(r(0,"div",12),R(1,fr,1,9,"perun-web-apps-groups-list",18),a()),t&2){let e=u(),o=w(26);n(),_("perunWebAppsLoader",e.loading)("perunWebAppsLoaderIndicator",o)}}var Wo=(()=>{class t{constructor(e,o,i,s,C,T,N,J,fe){this.dialogRef=e,this.data=o,this.authzService=i,this.voService=s,this.groupService=C,this.translate=T,this.notificator=N,this.route=J,this.router=fe,this.searchString="",this.selection=new U(!0,[],!0,(at,St)=>at.id===St.id),this.groups=[],this.vos=[],this.filterValue="",this.myControl=new Mt,this.firstSearchDone=!1,this.tableId=no,this.title=this.translate.instant("DIALOGS.ADD_GROUPS.TITLE"),this.successMessage=this.translate.instant("DIALOGS.ADD_GROUPS.SUCCESS")}displayFn(e){return e?e.name:null}onCancel(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.authzService.setRoleWithGroupComplementaryObject({role:this.selectedRole,authorizedGroups:this.selection.selected.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}ngOnInit(){this.loading=!0,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.theme=this.data.theme,this.voService.getMyVos().subscribe({next:e=>{this.filteredOptions=this.myControl.valueChanges.pipe(hi(""),_i(o=>this._filter(o))),this.vos=e,this.loading=!1},error:()=>this.loading=!1})}showVoGroups(e){this.loading=!0,this.firstSearchDone=!0,this.groupService.getAllGroups(e.option.value.id).subscribe({next:o=>{this.groups=o,this.loading=!1},error:()=>this.loading=!1})}applyFilter(e){this.filterValue=e}_filter(e){let o=typeof e=="string"?e.toLowerCase():e.name.toLowerCase();return this.vos.filter(i=>i.name.toLowerCase().includes(o)||i.shortName.toLowerCase().includes(o))}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l($e),l(Vt),l(Lt),l(ze),l(k),l(ne),l(Ze))}}static{this.\u0275cmp=M({type:t,selectors:[["app-add-group-manager-dialog"]],decls:35,vars:30,consts:[["auto","matAutocomplete"],["spinner",""],["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"me-2"],[3,"valueChange","value"],[3,"value"],[1,"me-2","w-75"],["aria-label","Assignee","matInput","","type","text",3,"formControl","matAutocomplete","placeholder"],[3,"optionSelected","displayWith"],[3,"placeholder"],[1,"position-relative","mt-3","table-min-height"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"],[1,"text-muted"],[3,"filter","placeholder"],[3,"loading","disableMembers","disableRouting","displayColumns","selection","groups","filter","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","disableMembers","disableRouting","displayColumns","selection","groups","filter","tableId"]],template:function(o,i){if(o&1){let s=b();r(0,"div")(1,"h1",2),d(2),c(3,"translate"),a(),r(4,"div",3)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),d(8),c(9,"translate"),a(),r(10,"mat-select",6),ie("valueChange",function(T){return g(s),te(i.selectedRole,T)||(i.selectedRole=T),h(T)}),xe(11,ur,3,4,"mat-option",7,dr),a()(),r(13,"mat-form-field",8)(14,"mat-label"),d(15),c(16,"translate"),a(),v(17,"input",9),c(18,"translate"),r(19,"mat-autocomplete",10,0),S("optionSelected",function(T){return g(s),h(i.showVoGroups(T))}),xe(21,_r,4,3,"mat-option",7,mr),c(23,"async"),a()()(),E(24,gr,2,4,"perun-web-apps-debounce-filter",11),R(25,hr,1,0,"ng-template",null,1,G),E(27,Sr,2,2,"div",12),a(),r(28,"div",13)(29,"button",14),S("click",function(){return g(s),h(i.onCancel())}),d(30),c(31,"translate"),a(),r(32,"button",15),S("click",function(){return g(s),h(i.onSubmit())}),d(33),c(34,"translate"),a()()()}if(o&2){let s=w(20);F(i.theme),n(2),I(p(3,16,"DIALOGS.ADD_GROUPS.TITLE")),n(6),I(p(9,18,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),n(2),ee("value",i.selectedRole),n(),ye(i.availableRoles),n(4),I(p(16,20,"DIALOGS.ADD_GROUPS.SELECT_VO")),n(2),_("placeholder",se(p(18,22,"DIALOGS.ADD_GROUPS.SELECT_VO")))("formControl",i.myControl)("matAutocomplete",s),n(2),_("displayWith",i.displayFn),n(2),ye(p(23,24,i.filteredOptions)),n(3),A(i.groups!==null&&i.groups.length>0&&!i.loading?24:-1),n(3),A(i.firstSearchDone?27:-1),n(3),f(" ",p(31,26,"DIALOGS.ADD_MANAGERS.CANCEL")," "),n(2),_("disabled",i.selection.selected.length===0||i.loading),n(),f(" ",p(34,28,"DIALOGS.ADD_MANAGERS.CREATE")," ")}},dependencies:[D,O,B,Ee,be,He,ot,it,tt,et,Je,he,Qe,ge,pt,Co,fo,So,q,z,Y,$,ae,y,nt,L,re,xi,x,ht],encapsulation:2})}}return t})();var Cr=()=>["id","name","email","logins","organization"];function vr(t,m){t&1&&v(0,"perun-web-apps-loading-table")}function Rr(t,m){t&1&&(d(0),c(1,"translate")),t&2&&f(" ",p(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.USER")," ")}function br(t,m){if(t&1){let e=b();r(0,"button",15),S("click",function(){g(e);let i=u(2);return h(i.addManager())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function Er(t,m){if(t&1){let e=b();r(0,"button",16),S("click",function(){g(e);let i=u(2);return h(i.removeManager())}),d(1),c(2,"translate"),a()}if(t&2){let e=u(2);_("disabled",e.loading||e.selectionUsers.selected.length===0),n(),f(" ",p(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function Ar(t,m){if(t&1&&(r(0,"mat-option",11),c(1,"lowercase"),d(2),c(3,"displayedRole"),a()),t&2){let e=m.$implicit;_("value",e.roleName),vt("data-cy",p(1,3,e.roleName)),n(2),f(" ",p(3,5,e)," ")}}function Tr(t,m){if(t&1){let e=b();r(0,"mat-slide-toggle",17),S("change",function(){g(e);let i=u(2);return i.showIndirectAdmins=!i.showIndirectAdmins,h(i.refreshUsers())}),d(1),c(2,"translate"),a()}if(t&2){let e=u(2);_("checked",e.showIndirectAdmins),n(),f(" ",p(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.SHOW_DERIVED_ADMINS")," ")}}function Ir(t,m){if(t&1&&v(0,"perun-web-apps-users-list",18),t&2){let e=u(2);_("routeToAdmin",e.routeAuth)("loading",e.loading)("tableId",e.tableId)("disableRouting",!e.routeAuth||e.disableRouting)("sortableColumns",de(11,Cr))("displayColumns",e.displayedUserColumns)("selection",e.selectionUsers)("users",e.managers)("disableCheckbox",!0)("directManagerIds",e.directAdminsIds)("cacheSubject",e.cacheSubject)}}function Mr(t,m){if(t&1){let e=b();r(0,"perun-web-apps-refresh-button",6),S("refresh",function(){g(e);let i=u();return h(i.refreshUsers())}),a(),E(1,br,3,3,"button",7),E(2,Er,3,4,"button",8),r(3,"mat-form-field",9)(4,"mat-label"),d(5),c(6,"translate"),a(),r(7,"mat-select",10),S("selectionChange",function(){g(e);let i=u();return h(i.refreshUsers(!0))}),ie("valueChange",function(i){g(e);let s=u();return te(s.selectedRole,i)||(s.selectedRole=i),h(i)}),xe(8,Ar,4,7,"mat-option",11,Rt),a()(),E(10,Tr,3,4,"mat-slide-toggle",12),r(11,"div",13),R(12,Ir,1,12,"perun-web-apps-users-list",14),a()}if(t&2){let e=u(),o=w(5);n(),A(e.manageAuth&&!e.configMode?1:-1),n(),A(e.manageAuth&&!e.configMode?2:-1),n(3),I(p(6,7,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),n(2),ee("value",e.selectedRole),n(),ye(e.availableRoles),n(2),A(e.complementaryObject.beanName.includes("Group")?10:-1),n(2),_("perunWebAppsLoader",e.loading)("perunWebAppsLoaderIndicator",o)}}function Dr(t,m){t&1&&(d(0),c(1,"translate")),t&2&&f(" ",p(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.GROUP")," ")}function xr(t,m){if(t&1){let e=b();r(0,"button",23),S("click",function(){g(e);let i=u(2);return h(i.addGroup())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function yr(t,m){if(t&1){let e=b();r(0,"button",24),S("click",function(){g(e);let i=u(2);return h(i.removeGroup())}),d(1),c(2,"translate"),a()}if(t&2){let e=u(2);_("disabled",e.loading||e.selectionGroups.selected.length===0),n(),f(" ",p(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function wr(t,m){if(t&1&&(r(0,"mat-option",11),d(1),c(2,"displayedRole"),a()),t&2){let e=m.$implicit;_("value",e.roleName),n(),I(p(2,2,e))}}function Or(t,m){if(t&1&&v(0,"perun-web-apps-groups-list",25),t&2){let e=u(2);_("loading",e.loading)("disableMembers",!1)("disableRouting",e.disableRouting)("displayColumns",e.displayedGroupColumns)("groups",e.groups)("selection",e.selectionGroups)("tableId",e.tableId)("cacheSubject",e.cacheSubject)}}function Gr(t,m){if(t&1){let e=b();r(0,"perun-web-apps-refresh-button",6),S("refresh",function(){g(e);let i=u();return h(i.refreshGroups())}),a(),E(1,xr,3,3,"button",19),E(2,yr,3,4,"button",20),r(3,"mat-form-field",21)(4,"mat-label"),d(5),c(6,"translate"),a(),r(7,"mat-select",10),S("selectionChange",function(){g(e);let i=u();return h(i.refreshGroups())}),ie("valueChange",function(i){g(e);let s=u();return te(s.selectedRole,i)||(s.selectedRole=i),h(i)}),xe(8,wr,3,4,"mat-option",11,Rt),a()(),r(10,"div",13),R(11,Or,1,8,"perun-web-apps-groups-list",22),a()}if(t&2){let e=u(),o=w(5);n(),A(e.manageAuth&&!e.configMode?1:-1),n(),A(e.manageAuth&&!e.configMode?2:-1),n(3),I(p(6,6,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),n(2),ee("value",e.selectedRole),n(),ye(e.availableRoles),n(3),_("perunWebAppsLoader",e.loading)("perunWebAppsLoaderIndicator",o)}}function Lr(t,m){t&1&&(r(0,"perun-web-apps-alert",5),d(1),c(2,"translate"),a()),t&2&&(n(),f(" ",p(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.NO_AVAILABLE_ROLES")," "))}var Ho=(()=>{class t{constructor(e,o,i,s,C,T,N){this.dialog=e,this.authzService=o,this.storeService=i,this.guiAuthResolver=s,this.router=C,this.reloadEntityDetail=T,this.route=N,this.configMode=!1,this.disableRouting=!1,this.disableSelf=!1,this.displayedUserColumns=["select","id","name","email","logins","organization"],this.displayedGroupColumns=["select","id","vo","name","description"],this.groups=[],this.managers=[],this.managers$=null,this.selectionUsers=new U(!0,[],!0,(J,fe)=>J.id===fe.id),this.selectionGroups=new U(!0,[],!0,(J,fe)=>J.id===fe.id),this.selectedMode="",this.showIndirectAdmins=!1,this.directAdminsIds=null,this.loading=!1,this.tableId=ao,this.availableRolesPrivileges=new Map,this.cacheSubject=new _e(!0)}ngOnInit(){this.loading=!0,this.routeAuth=this.guiAuthResolver.isPerunAdminOrObserver(),this.guiAuthResolver.setRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(e=>this.availableRolesPrivileges.get(e.roleName).readAuth),this.availableRoles.length!==0&&(this.selectedRole=this.availableRoles[0].roleName),this.refreshUsers()}changeRolePrivileges(){this.guiAuthResolver.setRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(o=>this.availableRolesPrivileges.get(o.roleName).readAuth),this.manageAuth=this.availableRolesPrivileges.get(this.selectedRole).manageAuth,this.displayedUserColumns=this.manageAuth?this.displayedUserColumns:this.displayedUserColumns.filter(o=>o!=="select"),this.displayedGroupColumns=this.manageAuth?this.displayedGroupColumns:this.displayedGroupColumns.filter(o=>o!=="select"),this.roleModes=this.availableRolesPrivileges.get(this.selectedRole).modes;let e=!1;for(let o of this.roleModes)if(this.selectedMode===o.toLowerCase()){e=!0;break}e||(this.selectedMode=this.roleModes[0].toLowerCase())}tabChanged(e){this.loading=!0,e.index===0?(this.selectedMode="user",this.refreshUsers()):(this.selectedMode="group",this.refreshGroups())}refreshUsers(e=!1){this.loading=!0,this.changeRolePrivileges();let o=[ve.USER_DEF_ORGANIZATION,ve.USER_DEF_PREFERRED_MAIL];o=o.concat(this.storeService.getLoginAttributeNames()),this.showIndirectAdmins?e?this.managers$=this.getDirectAdmins(o).pipe(gi(()=>this.getIndirectAdmins(o))):this.managers$=this.getIndirectAdmins(o):this.managers$=this.getDirectAdmins(o),this.managers$.subscribe({next:i=>{this.managers=i,this.selectionUsers.clear(),this.loading=!1},error:()=>{this.loading=!1}}),this.cacheSubject.next(!0),this.selectionUsers.clear()}getDirectAdmins(e){return this.authzService.getAuthzRichAdmins(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType,e,!1,!0).pipe(Si(o=>this.directAdminsIds=o.map(i=>i.id)))}getIndirectAdmins(e){return this.loading=!0,this.authzService.getAuthzRichAdmins(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType,e,!1,!1)}refreshGroups(){this.loading=!0,this.changeRolePrivileges(),this.authzService.getAuthzAdminGroups(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType).subscribe({next:e=>{this.groups=e,this.selectionGroups.clear(),this.loading=!1},error:()=>{this.loading=!1}}),this.cacheSubject.next(!0),this.selectionGroups.clear()}addManager(){let e=Q();e.width="1000px",e.data={complementaryObject:this.complementaryObject,theme:this.theme,availableRoles:this.availableRoles,selectedRole:this.selectedRole},this.dialog.open(jo,e).afterClosed().subscribe(i=>{i&&this.refreshUsers(!0)})}removeManager(){let e=Q();e.width="450px",e.data={managers:this.selectionUsers.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme,checkLastWarning:this.selectionUsers.selected.length===this.directAdminsIds.length},this.dialog.open(ko,e).afterClosed().subscribe(i=>{i&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?this.reloadEntityDetail.reloadEntityDetail():this.redirectToAuthRoute())})}removeGroup(){let e=Q();e.width="450px",e.data={groups:this.selectionGroups.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme,doCheckLastWarning:this.selectionGroups.selected.length===this.groups.length},this.dialog.open(Fo,e).afterClosed().subscribe(i=>{i&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?this.refreshGroups():this.redirectToAuthRoute())})}addGroup(){let e=Q();e.width="1000px",e.data={complementaryObject:this.complementaryObject,availableRoles:this.availableRoles,theme:this.theme,selectedRole:this.selectedRole},this.dialog.open(Wo,e).afterClosed().subscribe(i=>{i&&this.refreshGroups()})}redirectToAuthRoute(){if(this.complementaryObjectType==="Group"&&(this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])||this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])))if(this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])){let e=this.complementaryObject;this.router.navigate(["/organizations",e.voId,"groups",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"})}else this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])&&this.router.navigate(["/organizations",this.complementaryObject.voId],{queryParamsHandling:"merge"});else if(this.complementaryObjectType==="Facility"&&this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.complementaryObject]))this.router.navigate(["/facilities",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else if(this.complementaryObjectType==="Vo"&&this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject]))this.router.navigate(["/organizations",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else if(this.complementaryObjectType==="Resource"&&this.guiAuthResolver.isAuthorized("getRichResourceById_int_policy",[this.complementaryObject]))this.router.navigate(["../../"],{relativeTo:this.route,queryParamsHandling:"merge"});else{this.router.navigate(["/home"],{queryParamsHandling:"merge"});return}this.reloadEntityDetail.reloadEntityDetail()}static{this.\u0275fac=function(o){return new(o||t)(l(Me),l($e),l(Ie),l(P),l(Ze),l(ei),l(ne))}}static{this.\u0275cmp=M({type:t,selectors:[["app-managers-page"]],hostVars:2,hostBindings:function(o,i){o&2&&Re("router-component",i.true)},inputs:{complementaryObject:"complementaryObject",availableRoles:"availableRoles",complementaryObjectType:"complementaryObjectType",theme:"theme",configMode:"configMode",disableRouting:"disableRouting",disableSelf:"disableSelf",displayedUserColumns:"displayedUserColumns",displayedGroupColumns:"displayedGroupColumns"},decls:13,vars:4,consts:[["spinner",""],[1,"page-subtitle"],["mat-stretch-tabs","false","preserveContent","true",3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["alert_type","warn"],[1,"mt-2",3,"refresh"],["color","accent","data-cy","add-manager-button","mat-flat-button","",1,"me-2","action-button"],["color","warn","data-cy","remove-manager-button","mat-flat-button","",1,"me-2",3,"disabled"],["data-cy","role-filter",1,"me-2","mt-2"],[3,"selectionChange","valueChange","value"],[3,"value"],[3,"checked"],[1,"position-relative","table-min-height"],[3,"routeToAdmin","loading","tableId","disableRouting","sortableColumns","displayColumns","selection","users","disableCheckbox","directManagerIds","cacheSubject",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","data-cy","add-manager-button","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","data-cy","remove-manager-button","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"change","checked"],[3,"routeToAdmin","loading","tableId","disableRouting","sortableColumns","displayColumns","selection","users","disableCheckbox","directManagerIds","cacheSubject"],["color","accent","mat-flat-button","",1,"me-2","action-button"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[1,"me-2","mt-2"],[3,"loading","disableMembers","disableRouting","displayColumns","groups","selection","tableId","cacheSubject",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"loading","disableMembers","disableRouting","displayColumns","groups","selection","tableId","cacheSubject"]],template:function(o,i){if(o&1){let s=b();r(0,"h1",1),d(1),c(2,"translate"),a(),r(3,"mat-tab-group",2),S("selectedTabChange",function(T){return g(s),h(i.tabChanged(T))}),R(4,vr,1,0,"ng-template",null,0,G),r(6,"mat-tab"),R(7,Rr,2,3,"ng-template",3)(8,Mr,13,9,"ng-template",4),a(),r(9,"mat-tab"),R(10,Dr,2,3,"ng-template",3)(11,Gr,12,8,"ng-template",4),a()(),E(12,Lr,3,3,"perun-web-apps-alert",5)}o&2&&(n(),f(" ",p(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.TITLE"),`
`),n(11),A(i.availableRoles.length===0?12:-1))},dependencies:[D,O,B,Ee,be,He,tt,et,Je,Ht,Wt,Te,Ae,De,Ft,Ut,Pt,jt,kt,y,Xt,nt,L,re,yi,x,ht],encapsulation:2})}}return t})();var Ld=(()=>{class t{constructor(e,o){this.guiAuthResolver=e,this.entityStorageService=o,this.availableRoles=[],this.type="Resource",this.theme="resource-theme"}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Resource")}static{this.\u0275fac=function(o){return new(o||t)(l(P),l(X))}}static{this.\u0275cmp=M({type:t,selectors:[["app-resource-settings-managers"]],decls:1,vars:4,consts:[[3,"complementaryObject","availableRoles","complementaryObjectType","theme"]],template:function(o,i){o&1&&v(0,"app-managers-page",0),o&2&&_("complementaryObject",i.resource)("availableRoles",i.availableRoles)("complementaryObjectType",i.type)("theme",i.theme)},dependencies:[D,Ho],encapsulation:2})}}return t})();var Vr=()=>["select","id","name","enabled","description"];function Br(t,m){t&1&&v(0,"perun-web-apps-loading-dialog")}function Nr(t,m){if(t&1){let e=b();r(0,"div")(1,"h1",2),d(2),c(3,"translate"),a(),r(4,"div",3)(5,"div",4)(6,"perun-web-apps-debounce-filter",5),c(7,"translate"),S("filter",function(i){g(e);let s=u();return h(s.applyFilter(i))}),a()(),v(8,"app-services-list",6),a(),r(9,"div",7)(10,"button",8),S("click",function(){g(e);let i=u();return h(i.onCancel())}),d(11),c(12,"translate"),a(),r(13,"button",9),S("click",function(){g(e);let i=u();return h(i.onAdd())}),d(14),c(15,"translate"),a()()()}if(t&2){let e=u();n(2),I(p(3,14,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.TITLE")),n(4),_("placeholder",se(p(7,16,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.FILTER_DESCRIPTION"))),n(2),_("loading",e.loading)("services",e.unAssignedServices)("disableRouting",!0)("displayColumns",de(22,Vr))("filterValue",e.filterValue)("selection",e.selection)("cachedSubject",e.cachedSubject)("tableId",e.tableId),n(3),f(" ",p(12,18,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.CANCEL_BUTTON")," "),n(2),_("disabled",e.selection.selected.length===0||e.loading),n(),f(" ",p(15,20,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.ADD_SERVICES")," ")}}var zo=(()=>{class t{constructor(e,o,i,s,C,T){this.dialogRef=e,this.data=o,this.notificator=i,this.translate=s,this.resourceManager=C,this.servicesManager=T,this.loading=!1,this.unAssignedServices=[],this.filteredServices=[],this.selection=new U(!0,[],!0,(N,J)=>N.id===J.id),this.cachedSubject=new _e(!0),this.tableId=so,this.filterValue=""}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resourceManager.getAssignedServicesToResource(this.data.resourceId).subscribe(e=>{this.servicesManager.getServices().subscribe(o=>{this.unAssignedServices=o;for(let i of e)for(let s of o)i.id===s.id&&this.unAssignedServices.splice(this.unAssignedServices.indexOf(s),1);this.loading=!1})})}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0,this.addServices()}applyFilter(e){this.filterValue=e,this.selection.clear(),this.cachedSubject.next(!0)}addServices(){let e=[];for(let o of this.selection.selected)e.push(o.id);this.resourceManager.assignServices(this.data.resourceId,e).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SERVICE_SUCCESS_MESSAGE").subscribe(o=>{this.notificator.showSuccess(o),this.dialogRef.close(!0)})},()=>this.loading=!1)}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(k),l(We),l(V),l(Wi))}}static{this.\u0275cmp=M({type:t,selectors:[["app-perun-web-apps-assign-service-to-resource-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"mt-2"],[3,"filter","placeholder"],[3,"loading","services","disableRouting","displayColumns","filterValue","selection","cachedSubject","tableId"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(o,i){if(o&1&&(R(0,Br,1,0,"ng-template",null,0,G),r(2,"div"),R(3,Nr,16,23,"div",1),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,q,z,Y,$,me,ae,y,Jt,L,x],encapsulation:2})}}return t})();function Pr(t,m){t&1&&v(0,"perun-web-apps-loading-dialog")}function jr(t,m){if(t&1){let e=b();r(0,"div",4)(1,"perun-web-apps-alert",15),d(2),c(3,"translate"),a(),r(4,"p"),d(5),c(6,"translate"),a(),r(7,"p",16),d(8),c(9,"translate"),a(),r(10,"div",17)(11,"mat-checkbox",18),ie("ngModelChange",function(i){g(e);let s=u(2);return te(s.removeTask,i)||(s.removeTask=i),h(i)}),S("change",function(){g(e);let i=u(2);return h(i.removeTaskResults=!1)}),d(12),c(13,"translate"),a(),r(14,"mat-checkbox",19),ie("ngModelChange",function(i){g(e);let s=u(2);return te(s.removeTaskResults,i)||(s.removeTaskResults=i),h(i)}),d(15),c(16,"translate"),a(),r(17,"mat-checkbox",20),ie("ngModelChange",function(i){g(e);let s=u(2);return te(s.removeDestinations,i)||(s.removeDestinations=i),h(i)}),d(18),c(19,"translate"),a()()()}if(t&2){let e=u(2);n(2),f(" ",p(3,10,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.WARN_LAST_ASSIGNED")," "),n(3),f(" ",p(6,12,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.OPTIONAL_REMOVAL")," "),n(3),f(" ",p(9,14,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.OPTIONAL_REMOVAL_EXTRA")," "),n(3),ee("ngModel",e.removeTask),n(),f(" ",p(13,16,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.REMOVE_TASK")," "),n(2),ee("ngModel",e.removeTaskResults),_("disabled",e.removeTask),n(),f(" ",p(16,18,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.REMOVE_TASK_RESULTS")," "),n(2),ee("ngModel",e.removeDestinations),n(),f(" ",p(19,20,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.REMOVE_DESTINATIONS")," ")}}function kr(t,m){t&1&&v(0,"th",21)}function Fr(t,m){t&1&&(r(0,"mat-icon",24),d(1,"warning"),a())}function Wr(t,m){if(t&1&&(r(0,"td",22),c(1,"translate"),r(2,"div",23),d(3),E(4,Fr,2,0,"mat-icon",24),a()()),t&2){let e=m.$implicit,o=u(2);_("matTooltip",p(1,4,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.TOOLTIP"))("matTooltipDisabled",!o.servicesLastAssignedIds.includes(e.id)),n(3),f(" ",e.name," "),n(),A(o.servicesLastAssignedIds.includes(e.id)?4:-1)}}function Hr(t,m){t&1&&v(0,"tr",25)}function zr(t,m){t&1&&v(0,"tr",26)}function $r(t,m){if(t&1){let e=b();r(0,"div")(1,"h1",2),d(2),c(3,"translate"),a(),r(4,"div",3)(5,"p"),d(6),c(7,"translate"),a(),E(8,jr,20,22,"div",4),r(9,"div",5),d(10),c(11,"translate"),a(),r(12,"table",6),Se(13,7),R(14,kr,1,0,"th",8)(15,Wr,5,6,"td",9),Ce(),R(16,Hr,1,0,"tr",10)(17,zr,1,0,"tr",11),a()(),r(18,"div",12)(19,"button",13),S("click",function(){g(e);let i=u();return h(i.onCancel())}),d(20),c(21,"translate"),a(),r(22,"button",14),S("click",function(){g(e);let i=u();return h(i.onSubmit())}),d(23),c(24,"translate"),a()()()}if(t&2){let e=u();n(2),I(p(3,10,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.TITLE")),n(4),f(" ",p(7,12,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DESCRIPTION")," "),n(2),A(e.servicesLastAssignedIds.length>0?8:-1),n(2),f(" ",p(11,14,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.ASK")," "),n(2),_("dataSource",e.dataSource),n(4),_("matHeaderRowDef",e.displayedColumns),n(),_("matRowDefColumns",e.displayedColumns),n(3),f(" ",p(21,16,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.CANCEL")," "),n(2),_("disabled",e.loading),n(),f(" ",p(24,18,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DELETE")," ")}}var $o=(()=>{class t{constructor(e,o,i,s,C){this.dialogRef=e,this.data=o,this.notificator=i,this.translate=s,this.resourcesManager=C,this.displayedColumns=["name"],this.servicesLastAssignedIds=[],this.servicesIds=[]}ngOnInit(){this.loading=!0,this.servicesIds=this.data.services.map(e=>e.id),this.theme=this.data.theme,this.resourcesManager.isResourceLastAssignedServices(this.data.resourceId,this.servicesIds).subscribe({next:e=>{this.servicesLastAssignedIds=e.map(o=>o.id),this.loading=!1},error:()=>{this.loading=!1}}),this.dataSource=new Fe(this.data.services)}onSubmit(){this.loading=!0,this.resourcesManager.removeServices(this.data.resourceId,this.servicesIds,this.removeTask,this.removeTaskResults,this.removeDestinations).subscribe({next:()=>{this.translate.get("DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close(!0)})},error:()=>this.loading=!1})}onCancel(){this.dialogRef.close()}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(k),l(We),l(V))}}static{this.\u0275cmp=M({type:t,selectors:[["app-perun-web-apps-remove-service-from-resource-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"mb-2"],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"matTooltip","matTooltipDisabled",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"click","disabled"],["alert_type","warn"],[1,"small","mt-0"],[1,"flex-column","d-flex"],[3,"ngModelChange","change","ngModel"],[3,"ngModelChange","ngModel","disabled"],[3,"ngModelChange","ngModel"],["mat-header-cell",""],["mat-cell","",3,"matTooltip","matTooltipDisabled"],[1,"d-flex","align-items-center"],[1,"ms-2"],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(o,i){if(o&1&&(R(0,Pr,1,0,"ng-template",null,0,G),r(2,"div"),R(3,$r,25,20,"div",1),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,_t,ut,xt,Dt,Xe,ge,Ke,he,q,z,Y,$,Te,Ae,me,ke,we,Ge,Ne,Le,Oe,Ue,Ve,Be,Pe,je,y,qe,L,x],encapsulation:2})}}return t})();function Yr(t,m){if(t&1){let e=b();r(0,"button",8),S("click",function(){g(e);let i=u();return h(i.addService())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"RESOURCE_DETAIL.ASSIGNED_SERVICES.ADD_SERVICE")," "))}function qr(t,m){if(t&1){let e=b();r(0,"button",9),S("click",function(){g(e);let i=u();return h(i.removeServices())}),d(1),c(2,"translate"),a()}if(t&2){let e=u();_("disabled",e.loading||e.selected.selected.length===0),n(),f(" ",p(2,2,"RESOURCE_DETAIL.ASSIGNED_SERVICES.REMOVE_SERVICE")," ")}}function Qr(t,m){t&1&&v(0,"perun-web-apps-loading-table")}function Kr(t,m){if(t&1&&v(0,"app-services-list",10),t&2){let e=u();_("loading",e.loading)("disableRouting",!e.serviceRoutingAuth)("selection",e.selected)("cachedSubject",e.cachedSubject)("displayColumns",e.displayedColumns)("filterValue",e.filterValue)("services",e.assignedServices)("tableId",e.tableId)}}var Um=(()=>{class t{constructor(e,o,i,s,C){this.route=e,this.resourcesManager=o,this.dialog=i,this.guiAuthResolver=s,this.entityStorageService=C,this.assignedServices=[],this.selected=new U(!0,[],!0,(T,N)=>T.id===N.id),this.cachedSubject=new _e(!0),this.tableId=lo,this.filterValue="",this.displayedColumns=["select","id","name","enabled","script","description"]}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.getDataForAuthorization(),this.loadAllServices()}loadAllServices(){this.loading=!0,this.resourcesManager.getAssignedServicesToResource(this.resource.id).subscribe(e=>{this.assignedServices=e,this.selected.clear(),this.cachedSubject.next(!0),this.loading=!1})}addService(){let e=Q();e.width="800px",e.data={theme:"resource-theme",resourceId:this.resource.id},this.dialog.open(zo,e).afterClosed().subscribe(i=>{i&&this.loadAllServices()})}removeServices(){let e=Q();e.width="600px",e.data={theme:"resource-theme",resourceId:this.resource.id,services:this.selected.selected},this.dialog.open($o,e).afterClosed().subscribe(i=>{i&&this.loadAllServices()})}applyFilter(e){this.filterValue=e,this.loadAllServices()}getDataForAuthorization(){this.assignServiceAuth=this.guiAuthResolver.isAuthorized("assignServices_Resource_List<Service>_policy",[this.resource]),this.removeServiceAuth=this.guiAuthResolver.isAuthorized("removeServices_Resource_List<Service>_policy",[this.resource]),this.displayedColumns=this.removeServiceAuth?["select","id","name","enabled","script","description"]:["id","name","enabled","script","description"],this.serviceRoutingAuth=this.guiAuthResolver.isPerunAdminOrObserver()}static{this.\u0275fac=function(o){return new(o||t)(l(ne),l(V),l(Me),l(P),l(X))}}static{this.\u0275cmp=M({type:t,selectors:[["app-perun-web-apps-resource-assigned-services"]],decls:11,vars:8,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"action-button","me-2"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","disableRouting","selection","cachedSubject","displayColumns","filterValue","services","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"action-button","me-2",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"loading","disableRouting","selection","cachedSubject","displayColumns","filterValue","services","tableId"]],template:function(o,i){if(o&1){let s=b();r(0,"h1",1),d(1),c(2,"translate"),a(),r(3,"perun-web-apps-refresh-button",2),S("refresh",function(){return g(s),h(i.loadAllServices())}),a(),E(4,Yr,3,3,"button",3),E(5,qr,3,4,"button",4),r(6,"perun-web-apps-debounce-filter",5),S("filter",function(T){return g(s),h(i.applyFilter(T))}),a(),R(7,Qr,1,0,"ng-template",null,0,G),r(9,"div",6),R(10,Kr,1,8,"app-services-list",7),a()}if(o&2){let s=w(8);n(),I(p(2,6,"RESOURCE_DETAIL.ASSIGNED_SERVICES.TITLE")),n(3),A(i.assignServiceAuth?4:-1),n(),A(i.removeServiceAuth?5:-1),n(),_("placeholder","RESOURCE_DETAIL.ASSIGNED_SERVICES.FILTER_SERVICES"),n(4),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,ae,De,y,Jt,L,re,x],encapsulation:2})}}return t})();function Zr(t,m){if(t&1&&(r(0,"mat-option",8),d(1),c(2,"translate"),a()),t&2){let e=m.$implicit;_("value",e),n(),f(" ",p(2,2,"CONSENTS.STATUS_"+e)," ")}}function Jr(t,m){if(t&1){let e=b();r(0,"mat-form-field",3)(1,"mat-label"),d(2),c(3,"translate"),a(),r(4,"mat-select",7),S("closed",function(){g(e);let i=u();return h(i.changeConsentStatuses())}),r(5,"mat-select-trigger"),d(6),c(7,"selectedConsentStatuses"),a(),xe(8,Zr,3,4,"mat-option",8,Rt),a()()}if(t&2){let e=u();n(2),I(p(3,3,"RESOURCE_DETAIL.ASSIGNED_MEMBERS.FILTER_CONSENT_STATUS")),n(2),_("formControl",e.consentStatuses),n(2),f(" ",Mi(7,5,e.selectedConsentStatuses,e.consentStatusList,e.consentStatuses.value)," "),n(2),ye(e.consentStatusList)}}function ea(t,m){t&1&&v(0,"perun-web-apps-loading-table")}function ta(t,m){if(t&1){let e=b();r(0,"perun-web-apps-members-list",9),S("refreshTable",function(){g(e);let i=u();return h(i.refreshTable())}),a()}if(t&2){let e=u();_("loading",e.loading)("displayedColumns",e.columns)("disableRouting",!e.routeAuth)("members",e.members)("filter",e.filterValue)("tableId",e.tableId)}}var nu=(()=>{class t{constructor(e,o,i,s,C,T,N){this.route=e,this.resourceService=o,this.authResolver=i,this.entityStorageService=s,this.storeService=C,this.consentService=T,this.consentStatusPipe=N,this.loading=!1,this.filterValue="",this.tableId=co,this.members=[],this.columns=["id","fullName"],this.includeConsents=!1,this.consents=[],this.consentStatuses=new wi,this.consentStatusList=["UNSIGNED","GRANTED","REVOKED"],this.selectedConsentStatuses=[],this.selection=new U(!0,[])}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.resourceService.getAssignedRichMembers(this.resource.id).subscribe(e=>{this.setAuthRights(e),this.consentService.getConsentHubByResource(this.resource.id).subscribe(o=>{this.includeConsents=this.storeService.getProperty("enforce_consents")&&o.enforceConsents,this.includeConsents?(this.columns=["id","fullName","consentStatus"],this.consentService.getConsentsForConsentHubByResource(this.resource.id).subscribe(i=>{this.consents=i,this.members=this.getConsentsForMembers(e).filter(s=>!this.selectedConsentStatuses||this.selectedConsentStatuses.length===0||this.selectedConsentStatuses.includes(s.consent))})):this.members=e,this.loading=!1})})}setAuthRights(e){e.length!==0&&(this.routeAuth=this.authResolver.isAuthorized("getMemberById_int_policy",[e[0]]))}applyFilter(e){this.filterValue=e}getConsentsForMembers(e){let o=[];return e.forEach(i=>{let s=i;s.consent=this.consentStatusPipe.transform(i.userId,this.consents),o.push(s)}),o}changeConsentStatuses(){this.selection.clear(),this.selectedConsentStatuses=this.consentStatuses.value,this.refreshTable()}static{this.\u0275fac=function(o){return new(o||t)(l(ne),l(V),l(P),l(X),l(Ie),l(ki),l($t))}}static{this.\u0275cmp=M({type:t,selectors:[["app-resource-assigned-members"]],features:[Tt([$t,si])],decls:10,vars:7,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],[1,"me-2","fix-select"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","displayedColumns","disableRouting","members","filter","tableId","refreshTable",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["multiple","",3,"closed","formControl"],[1,"resource-theme",3,"value"],[3,"refreshTable","loading","displayedColumns","disableRouting","members","filter","tableId"]],template:function(o,i){if(o&1){let s=b();r(0,"h1",1),d(1),c(2,"translate"),a(),r(3,"perun-web-apps-refresh-button",2),S("refresh",function(){return g(s),h(i.refreshTable())}),a(),E(4,Jr,10,9,"mat-form-field",3),r(5,"perun-web-apps-debounce-filter",4),S("filter",function(T){return g(s),h(i.applyFilter(T))}),a(),R(6,ea,1,0,"ng-template",null,0,G),r(8,"div",5),R(9,ta,1,6,"perun-web-apps-members-list",6),a()}if(o&2){let s=w(7);n(),I(p(2,5,"RESOURCE_DETAIL.ASSIGNED_MEMBERS.TITLE")),n(3),A(i.includeConsents?4:-1),n(),_("placeholder","RESOURCE_DETAIL.ASSIGNED_MEMBERS.FILTER"),n(4),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,Ee,be,He,tt,et,Ni,Je,he,ge,pt,ae,De,Qt,y,L,re,x,si],encapsulation:2})}}return t})();var ia=t=>({all:t}),oa=t=>({name:t});function na(t,m){if(t&1){let e=b();r(0,"th",16)(1,"mat-checkbox",17),c(2,"masterCheckboxLabel"),c(3,"translate"),S("change",function(i){g(e);let s=u(2);return h(i?s.masterToggle():null)}),a()()}if(t&2){let e=u(),o=u();n(),_("aria-label",p(3,5,p(2,3,e.all)))("checked",o.selection.hasValue()&&e.all)("indeterminate",o.selection.hasValue()&&!e.all)}}function ra(t,m){if(t&1){let e=b();r(0,"td",18)(1,"mat-checkbox",19),c(2,"checkboxLabel"),c(3,"translate"),S("change",function(i){let s=g(e).$implicit,C=u(2);return h(i?C.toggleRow(s):null)})("click",function(i){return g(e),h(i.stopPropagation())}),a()()}if(t&2){let e=m.$implicit,o=u(2);n(),_("aria-label",bt(3,4,p(2,2,o.selection.isSelected(e)),ue(7,oa,e.tagName)))("checked",o.selection.isSelected(e))}}function aa(t,m){t&1&&(Se(0,3),R(1,na,4,7,"th",14)(2,ra,4,9,"td",15),Ce())}function sa(t,m){t&1&&(r(0,"th",20),d(1),c(2,"translate"),a()),t&2&&(n(),f(" ",p(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_ID")," "))}function la(t,m){if(t&1&&(r(0,"td",21),d(1),a()),t&2){let e=m.$implicit;n(),I(e.id)}}function ca(t,m){t&1&&(r(0,"th",22),d(1),c(2,"translate"),a()),t&2&&(n(),f(" ",p(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_NAME")," "))}function pa(t,m){if(t&1&&(r(0,"div"),d(1),a()),t&2){let e=u().$implicit;n(),f(" ",e.tagName," ")}}function da(t,m){if(t&1){let e=b();r(0,"div")(1,"mat-form-field",24)(2,"input",25),c(3,"translate"),ie("ngModelChange",function(i){g(e);let s=u().$implicit;return te(s.tagName,i)||(s.tagName=i),h(i)}),a()()()}if(t&2){let e=u().$implicit;n(2),_("placeholder",se(p(3,3,"VO_DETAIL.RESOURCES.TAGS.CHANGE_TAG_NAME"))),ee("ngModel",e.tagName)}}function ma(t,m){if(t&1&&(r(0,"td",23),E(1,pa,2,1,"div"),E(2,da,4,5,"div"),a()),t&2){let e=m.$implicit,o=u();n(),A(o.isChanging.isSelected(e)?-1:1),n(),A(o.isChanging.isSelected(e)?2:-1)}}function ua(t,m){t&1&&v(0,"th",22)}function _a(t,m){if(t&1){let e=b();r(0,"button",28),c(1,"translate"),S("click",function(){g(e);let i=u().$implicit,s=u();return h(s.edit(i))}),r(2,"mat-icon"),d(3,"edit"),a()()}t&2&&_("matTooltip",se(p(1,2,"VO_DETAIL.RESOURCES.TAGS.EDIT_BUTTON")))}function ga(t,m){if(t&1){let e=b();r(0,"button",28),c(1,"translate"),S("click",function(){g(e);let i=u().$implicit,s=u();return h(s.save(i))}),r(2,"mat-icon"),d(3,"save"),a()()}t&2&&_("matTooltip",se(p(1,2,"VO_DETAIL.RESOURCES.TAGS.SAVE_BUTTON")))}function ha(t,m){if(t&1&&(r(0,"td",23)(1,"div",26),E(2,_a,4,4,"button",27),E(3,ga,4,4,"button",27),a()()),t&2){let e=m.$implicit,o=u();n(2),A(o.isChanging.isSelected(e)?-1:2),n(),A(o.isChanging.isSelected(e)?3:-1)}}function fa(t,m){t&1&&v(0,"tr",29)}function Sa(t,m){t&1&&v(0,"tr",30)}function Ca(t,m){if(t&1&&(r(0,"perun-web-apps-alert",13),d(1),c(2,"translate"),c(3,"translate"),a()),t&2){let e=u();n(),f(" ",e.entity==="vo"?p(2,1,"VO_DETAIL.RESOURCES.TAGS.NO_TAGS"):p(3,3,"RESOURCE_DETAIL.TAGS.NO_TAGS")," ")}}function va(t,m){t&1&&(r(0,"perun-web-apps-alert",13),d(1),c(2,"translate"),a()),t&2&&(n(),f(" ",p(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT")," "))}var ii=(()=>{class t{constructor(e,o,i,s,C,T,N){this.resourceManager=e,this.notificator=o,this.translator=i,this.authResolver=s,this.tableCheckbox=C,this.destroyRef=T,this.tableConfigService=N,this.resourceTags=[],this.selection=new U(!0,[]),this.isChanging=new U(!0,[]),this.pageSizeOptions=Yi,this.displayedColumns=["select","id","name","edit"],this.unfilteredColumns=this.displayedColumns}set displayColumns(e){this.unfilteredColumns=e,localStorage.getItem("showIds")!=="true"&&(e=e.filter(o=>o!=="id")),this.displayedColumns=e}set matSort(e){this.sort=e,this.setDataSource()}static getDataForColumn(e,o){switch(o){case"id":return e.id.toString();case"name":return e.tagName;default:return""}}ngOnInit(){this.selection&&(this.cachedSelection=new U(this.selection.isMultipleSelection(),[],!0,this.selection.compareWith),this.cachedSubject?.pipe(li(this.destroyRef)).subscribe(e=>{e&&this.cachedSelection.clear()})),this.watchForIdColumnChanges()}ngOnChanges(){this.dataSource=new Fe(this.resourceTags),this.setDataSource()}ngAfterViewInit(){this.dataSource.paginator=this.child.paginator}exportAllData(e){ri(ni(this.dataSource.filteredData,this.displayedColumns,t.getDataForColumn),e)}exportDisplayedData(e){let o=this.dataSource.paginator.pageIndex*this.dataSource.paginator.pageSize,i=o+this.dataSource.paginator.pageSize;ri(ni(this.dataSource.sortData(this.dataSource.filteredData,this.dataSource.sort).slice(o,i),this.displayedColumns,t.getDataForColumn),e)}setDataSource(){this.dataSource&&(this.dataSource.filterPredicate=(e,o)=>Ki(e,o,this.displayedColumns,t.getDataForColumn),this.dataSource.sortData=(e,o)=>Qi(e,o,t.getDataForColumn),this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue)}isAllSelected(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.dataSource)}masterToggle(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.cachedSelection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}toggleRow(e){this.selection.toggle(e),this.cachedSelection.toggle(e)}pageChanged(){this.cachedSelection&&this.tableCheckbox.selectCachedDataOnPage(this.dataSource,this.selection,this.cachedSelection,this.selection.compareWith)}save(e){this.resourceManager.updateResourceTag({resourceTag:e}).subscribe(()=>{this.translator.get("SHARED.COMPONENTS.RESOURCES_TAGS_LIST.EDIT_SUCCESS").subscribe(o=>{this.notificator.showSuccess(o)}),this.isChanging.deselect(e)})}edit(e){this.isChanging.select(e)}watchForIdColumnChanges(){this.tableConfigService.showIdsChanged.pipe(li(this.destroyRef)).subscribe(e=>{e?this.displayedColumns=this.unfilteredColumns:this.displayedColumns=this.unfilteredColumns.filter(o=>o!=="id")}),localStorage.getItem("showIds")!=="true"&&this.displayedColumns.filter(e=>e!=="id")}static{this.\u0275fac=function(o){return new(o||t)(l(V),l(k),l(We),l(P),l(Xi),l(vi),l(to))}}static{this.\u0275cmp=M({type:t,selectors:[["app-resources-tags-list"]],viewQuery:function(o,i){if(o&1&&(st(ci,7),st(yt,7)),o&2){let s;lt(s=ct())&&(i.child=s.first),lt(s=ct())&&(i.matSort=s.first)}},inputs:{resourceTags:"resourceTags",filterValue:"filterValue",selection:"selection",cachedSubject:"cachedSubject",tableId:"tableId",entity:"entity",loading:"loading",displayColumns:"displayColumns"},features:[Ri],decls:18,vars:15,consts:[[1,"card","mt-2",3,"hidden"],[3,"exportDisplayedData","exportAllData","pageChanged","pageSizeOptions","dataLength","tableId"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"matSortChange","dataSource"],["matColumnDef","select"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","edit"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn"],["class","align-checkbox","mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size align-checkbox","mat-cell","",4,"matCellDef"],["mat-header-cell","",1,"align-checkbox"],["color","primary",3,"change","aria-label","checked","indeterminate"],["mat-cell","",1,"static-column-size","align-checkbox"],["color","primary",3,"change","click","aria-label","checked"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"static-column-size"],["mat-header-cell",""],["mat-cell",""],["subscriptSizing","dynamic"],["matInput","",3,"ngModelChange","ngModel","placeholder"],[1,"d-flex","justify-content-end"],["mat-icon-button","",3,"matTooltip"],["mat-icon-button","",3,"click","matTooltip"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"]],template:function(o,i){if(o&1&&(r(0,"div",0)(1,"perun-web-apps-table-wrapper",1),S("exportDisplayedData",function(C){return i.exportDisplayedData(C)})("exportAllData",function(C){return i.exportAllData(C)})("pageChanged",function(){return i.pageChanged()}),r(2,"table",2),S("matSortChange",function(){return i.pageChanged()}),E(3,aa,3,0,"ng-container",3),c(4,"isAllSelected"),Se(5,4),R(6,sa,3,3,"th",5)(7,la,2,1,"td",6),Ce(),Se(8,7),R(9,ca,3,3,"th",8)(10,ma,3,2,"td",9),Ce(),Se(11,10),R(12,ua,1,0,"th",8)(13,ha,4,2,"td",9),Ce(),R(14,fa,1,0,"tr",11)(15,Sa,1,0,"tr",12),a()()(),E(16,Ca,4,5,"perun-web-apps-alert",13),E(17,va,3,3,"perun-web-apps-alert",13)),o&2){let s;_("hidden",i.resourceTags.length===0||i.dataSource.filteredData.length===0),n(),_("pageSizeOptions",i.pageSizeOptions)("dataLength",i.dataSource.filteredData.length)("tableId",i.tableId),n(),_("dataSource",i.dataSource),n(),A((s=ue(13,ia,bt(4,10,i.dataSource,i.selection.selected.length)))?3:-1,s),n(11),_("matHeaderRowDef",i.displayedColumns),n(),_("matRowDefColumns",i.displayedColumns),n(),A(!i.loading&&i.resourceTags.length===0?16:-1),n(),A(i.dataSource.filteredData.length===0&&i.resourceTags.length!==0?17:-1)}},dependencies:[D,O,Ot,_t,ut,Ee,be,ot,it,xt,Dt,Xe,Qe,ge,Ke,he,Te,Ae,ci,ke,we,Ge,Ne,Le,Oe,Ue,Ve,Be,Pe,je,Bi,yt,Vi,y,qe,Zi,x,Ji,eo],encapsulation:2})}}return t})();function Ra(t,m){t&1&&v(0,"perun-web-apps-loading-table")}function ba(t,m){if(t&1&&v(0,"app-resources-tags-list",8),t&2){let e=u();_("loading",e.loading)("selection",e.selection)("displayColumns",e.displayedColumns)("entity","resource")("filterValue",e.filterValue)("resourceTags",e.resourceTags)("tableId",e.tableId)}}var Yo=(()=>{class t{constructor(e,o,i){this.dialogRef=e,this.data=o,this.resourcesManager=i,this.tableId=mo,this.selection=new U(!0,[]),this.resourceTags=[],this.displayedColumns=["select","id","name"]}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.voId=this.data.voId,this.resourceId=this.data.resourceId,this.assignedTags=this.data.assignedTags,this.resourcesManager.getAllResourcesTagsForVo(this.voId).subscribe(e=>{this.resourceTags=e.filter(o=>!this.assignedTags.map(i=>i.id).includes(o.id)),this.loading=!1})}onCancel(){this.dialogRef.close(!1)}onSubmit(e){this.resourcesManager.assignResourceTagsToResource({resource:this.resourceId,resourceTags:e}).subscribe(()=>{this.dialogRef.close(!0)})}applyFilter(e){this.filterValue=e}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(V))}}static{this.\u0275cmp=M({type:t,selectors:[["app-add-resource-tag-to-resource-dialog"]],decls:16,vars:14,consts:[["spinner",""],["mat-dialog-title",""],["mat-dialog-content",""],[1,"position-relative","table-min-height"],[3,"loading","selection","displayColumns","entity","filterValue","resourceTags","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"],[3,"loading","selection","displayColumns","entity","filterValue","resourceTags","tableId"]],template:function(o,i){if(o&1){let s=b();r(0,"div")(1,"h1",1),d(2),c(3,"translate"),a(),r(4,"div",2),R(5,Ra,1,0,"ng-template",null,0,G),r(7,"div",3),R(8,ba,1,7,"app-resources-tags-list",4),a()(),r(9,"div",5)(10,"button",6),S("click",function(){return g(s),h(i.onCancel())}),d(11),c(12,"translate"),a(),r(13,"button",7),S("click",function(){return g(s),h(i.onSubmit(i.selection.selected))}),d(14),c(15,"translate"),a()()()}if(o&2){let s=w(6);F(i.theme),n(2),I(p(3,8,"RESOURCE_DETAIL.TAGS.ADD_TAGS")),n(6),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s),n(3),f(" ",p(12,10,"RESOURCE_DETAIL.TAGS.CANCEL")," "),n(2),_("disabled",i.loading||i.resourceTags.length===0),n(),f(" ",p(15,12,"RESOURCE_DETAIL.TAGS.ADD_BUTTON")," ")}},dependencies:[D,O,B,q,z,Y,$,y,ii,re,L,x],encapsulation:2})}}return t})();function Ea(t,m){t&1&&v(0,"perun-web-apps-loading-dialog")}function Aa(t,m){if(t&1){let e=b();r(0,"div")(1,"h1",2),d(2),c(3,"translate"),a(),r(4,"div",3)(5,"mat-form-field")(6,"mat-label"),d(7),c(8,"translate"),a(),r(9,"input",4),ie("ngModelChange",function(i){g(e);let s=u();return te(s.name,i)||(s.name=i),h(i)}),a(),r(10,"mat-error"),d(11),c(12,"translate"),a()()(),r(13,"div",5)(14,"button",6),S("click",function(){g(e);let i=u();return h(i.onCancel())}),d(15),c(16,"translate"),a(),r(17,"button",7),S("click",function(){g(e);let i=u();return h(i.onSubmit())}),d(18),c(19,"translate"),a()()()}if(t&2){let e=u();n(2),I(p(3,7,"DIALOGS.CREATE_RESOURCE_TAG.TITLE")),n(5),I(p(8,9,"DIALOGS.CREATE_RESOURCE_TAG.NAME")),n(2),ee("ngModel",e.name),n(2),I(p(12,11,"DIALOGS.CREATE_RESOURCE_TAG.EMPTY_NAME")),n(4),f(" ",p(16,13,"DIALOGS.CREATE_RESOURCE_TAG.CANCEL")," "),n(2),_("disabled",e.loading),n(),f(" ",p(19,15,"DIALOGS.CREATE_RESOURCE_TAG.CREATE")," ")}}var qo=(()=>{class t{constructor(e,o,i){this.dialogRef=e,this.data=o,this.resourceManager=i,this.name="",this.loading=!1}ngOnInit(){this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.name!==""&&(this.loading=!0,this.resourceManager.createResourceTagWithTagName(this.name,this.data.voId).subscribe(()=>{this.dialogRef.close(!0)},()=>this.loading=!1))}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(V))}}static{this.\u0275cmp=M({type:t,selectors:[["app-create-resource-tag-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],["matInput","","required","",3,"ngModelChange","ngModel"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(o,i){if(o&1&&(R(0,Ea,1,0,"ng-template",null,0,G),r(2,"div"),R(3,Aa,20,17,"div",1),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,Ee,be,He,wt,ot,it,Xe,Qe,ge,Oi,Ke,he,q,z,Y,$,me,y,L,x],encapsulation:2})}}return t})();function Ta(t,m){if(t&1){let e=b();r(0,"button",8),S("click",function(){g(e);let i=u();return h(i.create())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"VO_DETAIL.RESOURCES.TAGS.CREATE_BUTTON")," "))}function Ia(t,m){if(t&1){let e=b();r(0,"button",8),S("click",function(){g(e);let i=u();return h(i.addTag())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"RESOURCE_DETAIL.TAGS.ADD_BUTTON")," "))}function Ma(t,m){if(t&1){let e=b();r(0,"button",9),S("click",function(){g(e);let i=u();return h(i.removeTags())}),d(1),c(2,"translate"),a()}if(t&2){let e=u();_("disabled",e.loading||e.selection.selected.length===0),n(),f(" ",p(2,2,"RESOURCE_DETAIL.TAGS.REMOVE_BUTTON")," ")}}function Da(t,m){t&1&&v(0,"perun-web-apps-loading-table")}function xa(t,m){if(t&1&&v(0,"app-resources-tags-list",10),t&2){let e=u();_("loading",e.loading)("displayColumns",e.displayedColumns)("entity","resource")("resourceTags",e.resourceTags)("filterValue",e.filterValue)("selection",e.selection)("cachedSubject",e.cachedSubject)("tableId",e.tableId)}}var D0=(()=>{class t{constructor(e,o,i,s,C,T){this.authResolver=e,this.resourcesManager=o,this.dialog=i,this.notificator=s,this.translate=C,this.entityStorageService=T,this.loading=!1,this.resourceTags=[],this.selection=new U(!0,[],!0,(N,J)=>N.id===J.id),this.tableId=po,this.displayedColumns=[],this.cachedSubject=new _e(!0)}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.setAuthRights(),this.updateData()}removeTags(){let e=Q();e.width="450px",e.data={items:this.selection.selected.map(i=>i.tagName),title:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_TITLE",description:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_DESCRIPTION",theme:"resource-theme",type:"remove",showAsk:!0},this.dialog.open(Yt,e).afterClosed().subscribe(i=>{i&&this.resourcesManager.removeResourceTagsFromResource({resource:this.resource.id,resourceTags:this.selection.selected}).subscribe(()=>(this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.REMOVED_SUCCESSFULLY")),this.updateData()))})}addTag(){let e=Q();e.width="600px",e.data={voId:this.resource.voId,resourceId:this.resource.id,assignedTags:this.resourceTags,theme:"resource-theme"},this.dialog.open(Yo,e).afterClosed().subscribe(i=>{i&&(this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.ADDED_SUCCESSFULLY")),this.updateData())})}create(){let e=Q();e.width="450px",e.data={voId:this.resource.voId,theme:"resource-theme"},this.dialog.open(qo,e).afterClosed().subscribe(i=>{i&&(this.notificator.showSuccess(this.translate.instant("VO_DETAIL.RESOURCES.TAGS.CREATE_SUCCESS")),this.updateData())})}updateData(){this.loading=!0,this.selection.clear(),this.cachedSubject.next(!0),this.resourcesManager.getAllResourcesTagsForResource(this.resource.id).subscribe(e=>{this.resourceTags=e,this.selection.clear(),this.loading=!1})}setAuthRights(){let e={id:this.resource.voId,beanName:"Vo"};this.displayedColumns=[],this.createAuth=this.authResolver.isAuthorized("createResourceTag_ResourceTag_Vo_policy",[e]),this.addAuth=this.authResolver.isAuthorized("assignResourceTagToResource_ResourceTag_Resource_policy",[this.resource]),this.removeAuth=this.authResolver.isAuthorized("removeResourceTagFromResource_ResourceTag_Resource_policy",[this.resource]),this.displayedColumns=this.removeAuth?["select","id","name"]:["id","name"]}applyFilter(e){this.filterValue=e,this.updateData()}static{this.\u0275fac=function(o){return new(o||t)(l(P),l(V),l(Me),l(k),l(ze),l(X))}}static{this.\u0275cmp=M({type:t,selectors:[["app-perun-web-apps-resource-tags"]],decls:12,vars:9,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","displayColumns","entity","resourceTags","filterValue","selection","cachedSubject","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"loading","displayColumns","entity","resourceTags","filterValue","selection","cachedSubject","tableId"]],template:function(o,i){if(o&1){let s=b();r(0,"h1",1),d(1),c(2,"translate"),a(),r(3,"perun-web-apps-refresh-button",2),S("refresh",function(){return g(s),h(i.updateData())}),a(),E(4,Ta,3,3,"button",3),E(5,Ia,3,3,"button",3),E(6,Ma,3,4,"button",4),r(7,"perun-web-apps-debounce-filter",5),S("filter",function(T){return g(s),h(i.applyFilter(T))}),a(),R(8,Da,1,0,"ng-template",null,0,G),r(10,"div",6),R(11,xa,1,8,"app-resources-tags-list",7),a()}if(o&2){let s=w(9);n(),I(p(2,7,"RESOURCE_DETAIL.TAGS.TITLE")),n(3),A(i.createAuth?4:-1),n(),A(i.addAuth?5:-1),n(),A(i.removeAuth?6:-1),n(),_("placeholder","RESOURCE_DETAIL.TAGS.SEARCH"),n(4),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,ae,De,y,ii,L,re,x],encapsulation:2})}}return t})();var ya=["*"];function wa(t,m){t&1&&v(0,"perun-web-apps-loading-dialog")}function Oa(t,m){t&1&&(r(0,"perun-web-apps-alert",8),d(1),c(2,"translate"),a()),t&2&&(_("alert_type","info"),n(),f(" ",p(2,2,"DIALOGS.ADD_BAN.ALREADY_BANNED")," "))}function Ga(t,m){if(t&1){let e=b();r(0,"button",15),S("click",function(){g(e),u();let i=w(6);return h(i.next())}),d(1),c(2,"translate"),a()}if(t&2){let e=u(2);_("disabled",e.disabled),n(),f(" ",p(2,2,"DIALOGS.ADD_BAN.NEXT")," ")}}function La(t,m){if(t&1){let e=b();r(0,"button",16),S("click",function(){g(e),u();let i=w(6);return h(i.previous())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"DIALOGS.ADD_BAN.BACK")," "))}function Va(t,m){if(t&1){let e=b();r(0,"button",17),S("click",function(){g(e);let i=u(2);return h(i.addBan())}),d(1),c(2,"translate"),a()}if(t&2){let e=u(2);n(),f(" ",p(2,1,e.ban?"DIALOGS.ADD_BAN.UPDATE":"DIALOGS.ADD_BAN.ADD")," ")}}function Ba(t,m){if(t&1){let e=b();r(0,"div")(1,"h1",3),d(2),c(3,"translate"),a(),r(4,"div",4)(5,"mat-stepper",5,1)(7,"mat-step",6),c(8,"translate"),Ti(9),a(),r(10,"mat-step",7),c(11,"translate"),E(12,Oa,3,4,"perun-web-apps-alert",8),v(13,"perun-web-apps-ban-specification",9),a()()(),r(14,"div",10)(15,"button",11),S("click",function(){g(e);let i=u();return h(i.cancelled.emit())}),d(16),c(17,"translate"),a(),E(18,Ga,3,4,"button",12),E(19,La,3,3,"button",13),E(20,Va,3,3,"button",14),a()()}if(t&2){let e=w(6),o=u();n(2),I(p(3,12,"DIALOGS.ADD_BAN.TITLE")),n(3),_("linear",!0),n(2),_("completed",!o.disabled)("label",p(8,14,"DIALOGS.ADD_BAN.SELECTION")),n(3),_("label",p(11,16,"DIALOGS.ADD_BAN.SPECIFICATION")),n(2),A(o.ban?12:-1),n(),_("description",o.ban==null?null:o.ban.description)("validity",o.ban==null?null:o.ban.validityTo),n(3),f(" ",p(17,18,"DIALOGS.ADD_BAN.CANCEL")," "),n(2),A(e.selectedIndex!==(e==null||e._steps==null?null:e._steps.length)-1?18:-1),n(),A(e.selectedIndex===(e==null||e._steps==null?null:e._steps.length)-1?19:-1),n(),A(e.selectedIndex===(e==null||e._steps==null?null:e._steps.length)-1?20:-1)}}var Qo=(()=>{class t{constructor(){this.loading=!1,this.disabled=!1,this.add=new Ct,this.cancelled=new Ct}addBan(){this.add.emit({description:this.banForm.getDescription(),validity:this.banForm.getValidity()})}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275cmp=M({type:t,selectors:[["app-add-ban-dialog"]],viewQuery:function(o,i){if(o&1&&st(pi,5),o&2){let s;lt(s=ct())&&(i.banForm=s.first)}},inputs:{loading:"loading",disabled:"disabled",theme:"theme",ban:"ban"},outputs:{add:"add",cancelled:"cancelled"},ngContentSelectors:ya,decls:4,vars:5,consts:[["spinner",""],["stepper",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[3,"linear"],[3,"completed","label"],[3,"label"],[3,"alert_type"],[3,"description","validity"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto","me-2",3,"click"],["mat-flat-button","","color","accent",1,"me-2",3,"disabled"],["mat-stroked-button","",1,"me-2"],["mat-flat-button","","color","accent"],["mat-flat-button","","color","accent",1,"me-2",3,"click","disabled"],["mat-stroked-button","",1,"me-2",3,"click"],["mat-flat-button","","color","accent",3,"click"]],template:function(o,i){if(o&1&&(Ai(),R(0,wa,1,0,"ng-template",null,0,G),r(2,"div"),R(3,Ba,21,20,"div",2),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,q,z,Y,$,Te,Ae,me,y,pi,L,Bt,Nt,x],encapsulation:2})}}return t})();var Na=()=>["checkbox","id","fullName"],Ko=(()=>{class t{constructor(e,o,i,s,C,T){this.data=e,this.dialogRef=o,this.store=i,this.resourceService=s,this.notificator=C,this.cd=T,this.selection=new U(!1,[],!0,(N,J)=>N.id===J.id),this.loading=!1,this.displayedColumns=["checkbox","id","fullName","organization","email","logins"],this.members=[],this.tableId=uo,this.filter=""}ngOnInit(){this.loading=!0,this.resourceService.getAssignedRichMembers(this.data.entityId).subscribe({next:e=>{this.members=e,this.loading=!1},error:()=>this.loading=!1}),this.selection.changed.subscribe(e=>{this.ban=this.data.bans.find(o=>o.memberId===e.source.selected[0]?.id)})}cancel(){this.dialogRef.close(!1)}submitBan(e){this.ban?this.updateBan(e):this.banMember(e)}banMember(e){this.loading=!0,this.resourceService.setResourceBan({banOnResource:{memberId:this.selection.selected[0].id,resourceId:this.data.entityId,description:e.description,validityTo:e.validity,id:0,beanName:"BanOnResource"}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.ADD_BAN.SUCCESS_MEMBER"),this.dialogRef.close(!0)},error:()=>this.loading=!1})}updateBan(e){this.loading=!0,this.resourceService.updateResourceBan({banOnResource:{id:this.ban.id,beanName:"BanOnFacility",resourceId:this.ban.resourceId,memberId:this.ban.memberId,description:e.description,validityTo:e.validity}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.UPDATE_BAN.SUCCESS"),this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}static{this.\u0275fac=function(o){return new(o||t)(l(H),l(W),l(Ie),l(V),l(k),l(It))}}static{this.\u0275cmp=M({type:t,selectors:[["app-add-resource-ban-dialog"]],decls:3,vars:14,consts:[[3,"add","cancelled","loading","disabled","theme","ban"],[3,"filter","placeholder"],[3,"loading","displayedColumns","disableRouting","disableCheckbox","members","selection","filter","tableId"]],template:function(o,i){o&1&&(r(0,"app-add-ban-dialog",0),S("add",function(C){return i.submitBan(C)})("cancelled",function(){return i.cancel()}),r(1,"perun-web-apps-debounce-filter",1),S("filter",function(C){return i.filter=C}),a(),v(2,"perun-web-apps-members-list",2),a()),o&2&&(_("loading",i.loading)("disabled",i.loading||i.selection.selected.length===0)("theme",i.data.theme)("ban",i.ban),n(),_("placeholder","DIALOGS.ADD_BAN.FILTER"),n(),_("loading",i.loading)("displayedColumns",de(13,Na))("disableRouting",!0)("disableCheckbox",!1)("members",i.members)("selection",i.selection)("filter",i.filter)("tableId",i.tableId))},dependencies:[D,ae,Qo,Qt],encapsulation:2})}}return t})();function Ua(t,m){if(t&1){let e=b();r(0,"button",8),S("click",function(){g(e);let i=u();return h(i.add())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"RESOURCE_DETAIL.SETTINGS.BANS.ADD")," "))}function Pa(t,m){if(t&1){let e=b();r(0,"button",9),S("click",function(){g(e);let i=u();return h(i.remove())}),d(1),c(2,"translate"),a()}if(t&2){let e=u();_("disabled",e.loading||e.selection.selected.length===0),n(),f(" ",p(2,2,"RESOURCE_DETAIL.SETTINGS.BANS.REMOVE")," ")}}function ja(t,m){if(t&1){let e=b();r(0,"perun-web-apps-ban-on-entity-list",10),S("updateBan",function(i){g(e);let s=u();return h(s.update(i))}),a()}if(t&2){let e=u();_("loading",e.loading)("bans",e.bans)("selection",e.selection)("cachedSubject",e.cachedSubject)("displayColumns",e.displayedColumns)("filter",e.filter)("updatePolicy","updateBan_BanOnResource_policy")}}function ka(t,m){t&1&&v(0,"perun-web-apps-loading-table")}var T_=(()=>{class t{constructor(e,o,i,s,C,T,N){this.resourceService=e,this.entityService=o,this.authResolver=i,this.dialog=s,this.notificator=C,this.store=T,this.userName=N,this.loading=!1,this.bans=[],this.removeAuth=!1,this.filter="",this.selection=new U(!1,[],!0,(J,fe)=>J.ban.id===fe.ban.id),this.cachedSubject=new _e(!0),this.attrNames=[ve.MEMBER_DEF_MAIL,ve.USER_DEF_PREFERRED_MAIL].concat(this.store.getLoginAttributeNames()),this.displayedColumns=["select","banId","subjectId","subjectName","description","expiration","edit"]}ngOnInit(){this.loading=!0,this.resource=this.entityService.getEntity(),this.addAuth=this.authResolver.isAuthorized("setBan_BanOnResource_policy",[this.resource]),this.removeAuth=this.authResolver.isAuthorized("resource-removeBan_int_policy",[this.resource]),this.refresh()}refresh(){this.loading=!0,this.resourceService.getEnrichedBansForResource(this.resource.id,this.attrNames).subscribe({next:e=>{this.bans=e,this.selection.clear(),this.cachedSubject.next(!0),this.loading=!1},error:()=>this.loading=!1})}add(){let e=Q();e.width="850px",e.data={entityId:this.resource.id,theme:"resource-theme",bans:this.bans.map(i=>i.ban)},this.dialog.open(Ko,e).afterClosed().subscribe(i=>{i&&this.refresh()})}remove(){let e=Q();e.width="550px",e.data={theme:"resource-theme",title:"DIALOGS.REMOVE_BAN.TITLE",description:"DIALOGS.REMOVE_BAN.DESCRIPTION",items:[this.userName.transform(this.selection.selected[0].member.user)],type:"remove",showAsk:!0},this.dialog.open(Yt,e).afterClosed().subscribe(i=>{i&&this.resourceService.removeResourceBanById(this.selection.selected[0].ban.id).subscribe(()=>{this.notificator.showSuccess("DIALOGS.REMOVE_BAN.SUCCESS"),this.refresh()})})}update(e){let o=Q();o.width="600px",o.data={ban:e.ban,theme:"facility-theme"},this.dialog.open(Do,o).afterClosed().subscribe(s=>{s&&this.refresh()})}applyFilter(e){this.filter=e,this.refresh()}static{this.\u0275fac=function(o){return new(o||t)(l(V),l(X),l(P),l(Me),l(k),l(Ie),l(Gt))}}static{this.\u0275cmp=M({type:t,selectors:[["app-resource-settings-bans"]],features:[Tt([Gt])],decls:11,vars:8,consts:[["spinner",""],[1,"page-subtitle"],[3,"click"],["color","accent","mat-flat-button","",1,"me-2","action-button"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[1,"mt-2","search-field",3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","bans","selection","cachedSubject","displayColumns","filter","updatePolicy","updateBan",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"updateBan","loading","bans","selection","cachedSubject","displayColumns","filter","updatePolicy"]],template:function(o,i){if(o&1){let s=b();r(0,"h1",1),d(1),c(2,"translate"),a(),r(3,"perun-web-apps-refresh-button",2),S("click",function(){return g(s),h(i.refresh())}),a(),E(4,Ua,3,3,"button",3),E(5,Pa,3,4,"button",4),r(6,"perun-web-apps-debounce-filter",5),S("filter",function(T){return g(s),h(i.applyFilter(T))}),a(),r(7,"div",6),R(8,ja,1,7,"perun-web-apps-ban-on-entity-list",7),a(),R(9,ka,1,0,"ng-template",null,0,G)}if(o&2){let s=w(10);n(),f(" ",p(2,6,"RESOURCE_DETAIL.SETTINGS.BANS.TITLE"),`
`),n(3),A(i.addAuth?4:-1),n(),A(i.removeAuth?5:-1),n(),_("placeholder","RESOURCE_DETAIL.SETTINGS.BANS.FILTER"),n(2),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,ae,De,y,vo,L,re,x],encapsulation:2})}}return t})();export{ei as a,yo as b,Ho as c,qo as d,ii as e,Os as f,Ws as g,zl as h,Kl as i,sc as j,Cc as k,Ld as l,Um as m,nu as n,D0 as o,Qo as p,T_ as q};
