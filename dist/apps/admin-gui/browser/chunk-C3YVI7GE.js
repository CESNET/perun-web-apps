import{Id as g,Jc as h,Kd as R,Lc as v,Md as M,N as u,Oc as y,Of as A,Pf as I,Q as n,Yf as b,fa as l,fe as C,h as c,k as a,tb as f,v as s,wa as m,xa as d,ya as p,zj as k}from"./chunk-353QRQI4.js";var J=(()=>{class o{constructor(r,i,e,t,N,S,j,z){this.authResolver=r,this.routePolicyService=i,this.router=e,this.notificator=t,this.apiRequest=N,this.memberManager=S,this.groupManager=j,this.resourceManager=z}static getBeanName(r){switch(r){case"organizations":return"Vo";case"groups":return"Group";case"facilities":return"Facility";case"services":return"Facility";case"resources":return"Resource";case"members":return"Member";default:return""}}static parseUrl(r){let i=r.slice(1).split("/").reverse(),e={key:"",entity:{id:-1,beanName:""}};for(let t of i){if(Number(t)){if(e.entity.id===-1){e.entity.id=Number(t);continue}e.key==="services-status-"&&(e.entity.id=Number(t));break}e.key=t.concat("-",e.key)}return e.key=e.key.slice(0,e.key.length-1),e.entity.beanName=o.getBeanName(e.key.split("-")[0]),e}canActivateChild(r,i){if(this.authResolver.isPerunAdminOrObserver())return!0;let e=o.parseUrl(i.url);return e.key.startsWith("members")?(this.apiRequest.dontHandleErrorForNext(),this.memberManager.getMemberById(e.entity.id).pipe(a(t=>(e.entity.userId=t.userId,e.entity.voId=t.voId,this.finalizeCanActivateChild(e))),s(t=>this.errorRedirectUrl(t)))):e.key.startsWith("groups")?(this.apiRequest.dontHandleErrorForNext(),this.groupManager.getGroupById(e.entity.id).pipe(a(t=>(e.entity.voId=t.voId,this.finalizeCanActivateChild(e))),s(t=>this.errorRedirectUrl(t)))):e.key.startsWith("resources")?(this.apiRequest.dontHandleErrorForNext(),this.resourceManager.getResourceById(e.entity.id).pipe(a(t=>(e.entity.facilityId=t.facilityId,e.entity.voId=t.voId,this.finalizeCanActivateChild(e))),s(t=>this.errorRedirectUrl(t)))):this.finalizeCanActivateChild(e)}canActivate(r,i){return this.canActivateChild(r,i)}finalizeCanActivateChild(r){return this.routePolicyService.canNavigate(r.key,r.entity)?!0:(this.notificator.showRouteError(),this.router.parseUrl("/notAuthorized"))}errorRedirectUrl(r){if(r.name==="PrivilegeException")return this.notificator.showRouteError(),c(this.router.parseUrl("/notAuthorized"))}static{this.\u0275fac=function(i){return new(i||o)(n(C),n(b),n(v),n(A),n(I),n(R),n(g),n(M))}}static{this.\u0275prov=u({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var Y=(()=>{class o{prepareRoute(r){return r?.activatedRouteData&&r?.activatedRouteData.animation!==null}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275cmp=l({type:o,selectors:[["app-animated-router-outlet"]],decls:3,vars:0,consts:[["outlet","outlet"]],template:function(i,e){i&1&&(m(0,"div"),p(1,"router-outlet",null,0),d())},dependencies:[f,y,h],encapsulation:2,data:{animation:[k]}})}}return o})();export{Y as a,J as b};
