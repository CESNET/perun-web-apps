import{Aa as A,Af as se,Ba as I,Bd as te,Bf as oe,Bh as ue,Cf as pe,Dj as be,Ej as ge,Hb as Z,Hg as F,Ia as x,Ib as q,K as E,Ma as u,Mb as J,Na as h,O as g,P as S,Pe as ne,Qa as V,Qh as w,Rb as y,Si as fe,Ug as ce,Vb as K,Vg as le,Wa as M,Wb as Q,Y as l,Ya as G,Yg as U,Z as d,_ as $,_d as ie,_e as re,ad as k,bc as X,ca as m,fa as s,g as j,ga as R,hg as B,id as N,ja as o,jh as me,ka as c,la as v,ni as he,oa as C,oh as H,pa as _,qa as p,qc as Y,re as L,rh as _e,se as W,te as O,ue as P,wb as z,xc as ee,xh as de,ya as D,za as b,zf as ae}from"./chunk-WEHWIVFK.js";function Te(e,r){e&1&&v(0,"perun-web-apps-loading-table")}var Re=()=>["user","id","name","email","logins","organization"];function De(e,r){if(e&1){let t=C();o(0,"perun-web-apps-users-dynamic-list",7),_("loading$",function(n){g(t);let a=p();return S(a.loading$=n)}),c()}if(e&2){let t=p();s("disableRouting",!1)("searchString",t.searchString)("attrNames",t.attributes)("displayedColumns",x(7,Re))("tableId",t.tableId)("withoutVo",t.usersWithoutVo)("updateTable",t.update)}}var dt=(()=>{let r=class r{constructor(i,n,a){this.storeService=i,this.cd=n,this.cacheHelperService=a,this.usersWithoutVo=!1,this.tableId=te,this.attributes=[],this.update=!1}ngOnInit(){this.loading$=j(!0),this.attributes=[k.USER_DEF_ORGANIZATION,k.USER_DEF_PREFERRED_MAIL],this.attributes=this.attributes.concat(this.storeService.getLoginAttributeNames()),this.cacheHelperService.refreshComponentCachedData().subscribe(i=>{i&&this.refresh()})}onSearchByString(i){this.searchString=i,this.cd.detectChanges()}findUsersWithoutVO(){this.usersWithoutVo=!this.usersWithoutVo,this.cd.detectChanges()}refresh(){this.update=!this.update,this.cd.detectChanges()}};r.id="AdminUsersComponent",r.\u0275fac=function(n){return new(n||r)(d(Q),d($),d(w))},r.\u0275cmp=E({type:r,selectors:[["app-admin-users"]],hostVars:2,hostBindings:function(n,a){n&2&&R("router-component",a.true)},decls:13,vars:13,consts:[[1,"page-subtitle"],[3,"click"],[1,"mt-2","search-field",3,"autoFocus","placeholder","filter"],["color","primary",3,"checked","change"],["spinner",""],[1,"position-relative","table-min-height"],[3,"disableRouting","searchString","attrNames","displayedColumns","tableId","withoutVo","updateTable","loading$",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"disableRouting","searchString","attrNames","displayedColumns","tableId","withoutVo","updateTable","loading$"]],template:function(n,a){if(n&1&&(o(0,"h1",0),b(1),u(2,"translate"),c(),o(3,"perun-web-apps-refresh-button",1),_("click",function(){return a.refresh()}),c(),o(4,"perun-web-apps-debounce-filter",2),_("filter",function(T){return a.onSearchByString(T)}),c(),o(5,"mat-checkbox",3),_("change",function(){return a.findUsersWithoutVO()}),b(6),u(7,"translate"),c(),m(8,Te,1,0,"ng-template",null,4,V),o(10,"div",5),m(11,De,1,8,"perun-web-apps-users-dynamic-list",6),u(12,"async"),c()),n&2){let f=D(9);l(),A(h(2,7,"ADMIN.USERS.TITLE")),l(3),s("autoFocus",!0)("placeholder","ADMIN.USERS.SEARCH_PLACEHOLDER"),l(),s("checked",a.usersWithoutVo),l(),I(" ",h(7,9,"ADMIN.USERS.USERS_WITHOUT_VO"),`
`),l(5),s("perunWebAppsLoader",h(12,11,a.loading$))("perunWebAppsLoaderIndicator",f)}},dependencies:[ne,F,U,H,de,B,G,y],styles:[".search-field[_ngcontent-%COMP%]{width:325px}"]});let e=r;return e})();function Me(e,r){if(e&1){let t=C();o(0,"button",8),_("click",function(){g(t);let n=p();return S(n.createService())}),b(1),u(2,"translate"),c()}e&2&&(l(),I(" ",h(2,1,"ADMIN.SERVICES.CREATE")," "))}function Le(e,r){if(e&1){let t=C();o(0,"button",9),_("click",function(){g(t);let n=p();return S(n.deleteService())}),b(1),u(2,"translate"),c()}if(e&2){let t=p();s("disabled",t.selection.selected.length===0),l(),I(" ",h(2,2,"ADMIN.SERVICES.DELETE")," ")}}function Be(e,r){e&1&&v(0,"perun-web-apps-loading-table")}function Fe(e,r){if(e&1&&v(0,"app-services-list",10),e&2){let t=p();s("loading",t.loading)("filterValue",t.filterValue)("selection",t.selection)("services",t.services)("tableId",t.tableId)}}var Rt=(()=>{let r=class r{constructor(i,n,a,f){this.serviceManager=i,this.dialog=n,this.authResolver=a,this.cacheHelperService=f,this.selection=new X(!0,[]),this.loading=!1,this.filterValue="",this.tableId=ie}ngOnInit(){this.refreshTable(),this.cacheHelperService.refreshComponentCachedData().subscribe(i=>{i&&this.refreshTable()})}createService(){let i=N();i.width="600px",i.data={theme:"admin-theme"},this.dialog.open(be,i).afterClosed().subscribe(a=>{a&&this.refreshTable()})}deleteService(){let i=N();i.width="600px",i.data={theme:"admin-theme",services:this.selection.selected},this.dialog.open(ge,i).afterClosed().subscribe(a=>{a&&this.refreshTable()})}refreshTable(){this.loading=!0,this.serviceManager.getServices().subscribe(i=>{this.services=i,this.selection.clear(),this.loading=!1})}applyFilter(i){this.filterValue=i}};r.id="AdminServicesComponent",r.\u0275fac=function(n){return new(n||r)(d(q),d(Y),d(K),d(w))},r.\u0275cmp=E({type:r,selectors:[["app-admin-services"]],decls:12,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","class","action-button me-2","data-cy","service-create-button","mat-flat-button","",3,"click",4,"ngIf"],["class","me-2","color","warn","data-cy","service-delete-button","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative","table-min-height"],[3,"loading","filterValue","selection","services","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","data-cy","service-create-button","mat-flat-button","",1,"action-button","me-2",3,"click"],["color","warn","data-cy","service-delete-button","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"loading","filterValue","selection","services","tableId"]],template:function(n,a){if(n&1&&(o(0,"div")(1,"h1",0),b(2),u(3,"translate"),c(),o(4,"perun-web-apps-refresh-button",1),_("refresh",function(){return a.refreshTable()}),c(),m(5,Me,3,3,"button",2)(6,Le,3,4,"button",3),o(7,"perun-web-apps-debounce-filter",4),_("filter",function(T){return a.applyFilter(T)}),c(),m(8,Be,1,0,"ng-template",null,5,V),o(10,"div",6),m(11,Fe,1,5,"app-services-list",7),c()()),n&2){let f=D(9);l(2),A(h(3,6,"ADMIN.SERVICES.TITLE")),l(3),s("ngIf",a.authResolver.isPerunAdmin()),l(),s("ngIf",a.authResolver.isPerunAdmin()),l(),s("placeholder","ADMIN.SERVICES.FILTER"),l(4),s("perunWebAppsLoader",a.loading)("perunWebAppsLoaderIndicator",f)}},dependencies:[M,ee,fe,F,U,H,B,y]});let e=r;return e})();function Ue(e,r){e&1&&(b(0),u(1,"translate")),e&2&&I(" ",h(1,1,"ADMIN.SEARCHER.TAB_USERS")," ")}function He(e,r){if(e&1){let t=C();o(0,"perun-web-apps-attribute-search-select",8),_("search",function(n){g(t);let a=p(2);return S(a.getUsers(n))}),c()}if(e&2){let t=p(2);s("attributes",t.allAttrDefinitions)("attributesForEntity","user")}}var ke=()=>["user","id","name"];function Ne(e,r){if(e&1&&v(0,"app-users-list",9),e&2){let t=p(2);s("loading",t.loading)("tableId",t.tableId)("displayedColumns",x(4,ke))("users",t.entities)}}function We(e,r){if(e&1&&m(0,He,1,2,"perun-web-apps-attribute-search-select",6)(1,Ne,1,5,"app-users-list",7),e&2){let t=p();s("ngIf",!t.loading),l(),s("ngIf",!t.loadingEntityData)}}function Oe(e,r){e&1&&(b(0),u(1,"translate")),e&2&&I(" ",h(1,1,"ADMIN.SEARCHER.TAB_MEMBERS")," ")}function Pe(e,r){if(e&1){let t=C();o(0,"perun-web-apps-vo-search-select",13),_("voSelected",function(n){g(t);let a=p(2);return S(a.voSelected(n))}),c()}if(e&2){let t=p(2);s("vos",t.vos)}}function je(e,r){if(e&1){let t=C();o(0,"perun-web-apps-attribute-search-select",8),_("search",function(n){g(t);let a=p(2);return S(a.getMembers(n))}),c()}if(e&2){let t=p(2);s("attributes",t.allAttrDefinitions)("attributesForEntity","user")}}var $e=()=>["id","voId","userId","status"];function Ge(e,r){if(e&1){let t=C();o(0,"perun-web-apps-members-list",14),_("refreshTable",function(){g(t);let n=p(2);return S(n.getMembers(n.searchInput))}),c()}if(e&2){let t=p(2);s("loading",t.loading)("displayedColumns",x(4,$e))("members",t.entities)("tableId",t.tableId)}}function ze(e,r){if(e&1&&(o(0,"div",10),m(1,Pe,1,1,"perun-web-apps-vo-search-select",11),c(),m(2,je,1,2,"perun-web-apps-attribute-search-select",6)(3,Ge,1,5,"perun-web-apps-members-list",12)),e&2){let t=p();l(),s("ngIf",t.vos.length>0),l(),s("ngIf",!t.loading),l(),s("ngIf",!t.loadingEntityData)}}function Ze(e,r){e&1&&(b(0),u(1,"translate")),e&2&&I(" ",h(1,1,"ADMIN.SEARCHER.TAB_FACILITIES")," ")}function qe(e,r){if(e&1){let t=C();o(0,"perun-web-apps-attribute-search-select",8),_("search",function(n){g(t);let a=p(2);return S(a.getFacilities(n))}),c()}if(e&2){let t=p(2);s("attributes",t.allAttrDefinitions)("attributesForEntity","facility")}}var Je=()=>["id","name","description"];function Ke(e,r){if(e&1&&v(0,"perun-web-apps-facilities-list",16),e&2){let t=p(2);s("loading",t.loading)("tableId",t.tableId)("displayedColumns",x(4,Je))("facilities",t.entities)}}function Qe(e,r){if(e&1&&m(0,qe,1,2,"perun-web-apps-attribute-search-select",6)(1,Ke,1,5,"perun-web-apps-facilities-list",15),e&2){let t=p();s("ngIf",!t.loading),l(),s("ngIf",!t.loadingEntityData)}}function Xe(e,r){e&1&&(b(0),u(1,"translate")),e&2&&I(" ",h(1,1,"ADMIN.SEARCHER.TAB_RESOURCES")," ")}function Ye(e,r){if(e&1){let t=C();o(0,"perun-web-apps-attribute-search-select",8),_("search",function(n){g(t);let a=p(2);return S(a.getResources(n))}),c()}if(e&2){let t=p(2);s("attributes",t.allAttrDefinitions)("attributesForEntity","resource")}}var et=()=>["id","name","description","voId","facilityId"];function tt(e,r){if(e&1&&v(0,"perun-web-apps-resources-list",18),e&2){let t=p(2);s("loading",t.loading)("tableId",t.tableId)("displayedColumns",x(4,et))("resources",t.entities)}}function it(e,r){if(e&1&&m(0,Ye,1,2,"perun-web-apps-attribute-search-select",6)(1,tt,1,5,"perun-web-apps-resources-list",17),e&2){let t=p();s("ngIf",!t.loading),l(),s("ngIf",!t.loadingEntityData)}}function nt(e,r){e&1&&v(0,"mat-spinner",19)}var zt=(()=>{let r=class r{constructor(i,n,a,f){this.attributesManager=i,this.searcher=n,this.voService=a,this.cacheHelperService=f,this.loadingEntityData=!1,this.allAttrDefinitions=[],this.tableId=L,this.entities=[],this.vos=[]}ngOnInit(){this.loading=!0,this.attributesManager.getAllAttributeDefinitions().subscribe(i=>{this.allAttrDefinitions=i,this.loading=!1}),this.cacheHelperService.refreshComponentCachedData().subscribe(i=>{i&&this.refresh()})}tabChanged(i){switch(this.entities=[],i){case 0:this.tableId=L;break;case 1:this.loadingEntityData=!0,this.loadAllVos(),this.tableId=W;break;case 2:this.tableId=O;break;case 3:this.tableId=P;break;default:break}}loadAllVos(){this.loadingEntityData=!0,this.voService.getAllVos().subscribe(i=>{this.vos=i,this.selectedVo=i[0],this.loadingEntityData=!1})}voSelected(i){i!==void 0&&(this.selectedVo=i)}getUsers(i){this.searchInput=i,this.loadingEntityData=!0,this.searcher.getUsersSearcher({attributesWithSearchingValues:this.searchInput}).subscribe(n=>{this.entities=n,this.loadingEntityData=!1})}getMembers(i){this.searchInput=i,this.loadingEntityData=!0,this.searcher.getMembersByUserAttributes({vo:this.selectedVo.id,userAttributesWithSearchingValues:this.searchInput}).subscribe(n=>{this.entities=n,this.loadingEntityData=!1})}getFacilities(i){this.searchInput=i,this.loadingEntityData=!0,this.searcher.getFacilities({attributesWithSearchingValues:this.searchInput}).subscribe(n=>{this.entities=n.map(a=>({facility:a})),this.loadingEntityData=!1})}getResources(i){this.searchInput=i,this.loadingEntityData=!0,this.searcher.getAttributesResources({attributesWithSearchingValues:this.searchInput}).subscribe(n=>{this.entities=n,this.loadingEntityData=!1})}refresh(){if(this.searchInput)switch(this.tableId){case L:this.getUsers(this.searchInput);break;case W:this.getMembers(this.searchInput);break;case O:this.getFacilities(this.searchInput);break;case P:this.getResources(this.searchInput);break;default:break}}};r.id="AdminSearcherComponent",r.\u0275fac=function(n){return new(n||r)(d(z),d(Z),d(J),d(w))},r.\u0275cmp=E({type:r,selectors:[["app-admin-searcher"]],hostVars:2,hostBindings:function(n,a){n&2&&R("router-component",a.true)},decls:17,vars:4,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false",3,"selectedIndexChange"],[1,"mb-2"],["matTabLabel",""],["matTabContent",""],["class","ms-auto me-auto",4,"ngIf"],[3,"attributes","attributesForEntity","search",4,"ngIf"],[3,"loading","tableId","displayedColumns","users",4,"ngIf"],[3,"attributes","attributesForEntity","search"],[3,"loading","tableId","displayedColumns","users"],[1,"mt-3"],[3,"vos","voSelected",4,"ngIf"],[3,"loading","displayedColumns","members","tableId","refreshTable",4,"ngIf"],[3,"vos","voSelected"],[3,"loading","displayedColumns","members","tableId","refreshTable"],[3,"loading","tableId","displayedColumns","facilities",4,"ngIf"],[3,"loading","tableId","displayedColumns","facilities"],[3,"loading","tableId","displayedColumns","resources",4,"ngIf"],[3,"loading","tableId","displayedColumns","resources"],[1,"ms-auto","me-auto"]],template:function(n,a){n&1&&(o(0,"h1",0),b(1),u(2,"translate"),c(),o(3,"mat-tab-group",1),_("selectedIndexChange",function(T){return a.tabChanged(T)}),o(4,"mat-tab",2),m(5,Ue,2,3,"ng-template",3)(6,We,2,2,"ng-template",4),c(),o(7,"mat-tab"),m(8,Oe,2,3,"ng-template",3)(9,ze,4,3,"ng-template",4),c(),o(10,"mat-tab"),m(11,Ze,2,3,"ng-template",3)(12,Qe,2,2,"ng-template",4),c(),o(13,"mat-tab"),m(14,Xe,2,3,"ng-template",3)(15,it,2,2,"ng-template",4),c()(),m(16,nt,1,0,"mat-spinner",5)),n&2&&(l(),A(h(2,2,"ADMIN.SEARCHER.TITLE")),l(15),s("ngIf",a.loading||a.loadingEntityData))},dependencies:[M,ae,se,oe,pe,re,he,ce,me,_e,le,ue,y]});let e=r;return e})();export{dt as a,Rt as b,zt as c};
