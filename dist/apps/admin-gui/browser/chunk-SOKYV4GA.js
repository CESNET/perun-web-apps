import{a as ft}from"./chunk-I4MJNZ23.js";import{$b as G,$c as $t,$d as bi,$f as ji,Aa as g,Ab as Rt,Ad as ii,Ag as zi,Ah as tn,Aj as gn,B as xe,Ba as x,Bd as ni,Be as We,Bg as Hi,Bj as hn,Ca as S,Cc as $,Cd as ri,Da as De,Db as Ee,Dc as Ge,Dd as oi,Ea as Le,Eb as Pe,Ec as lt,Ed as si,Ee as Ce,F as Ae,Fc as ke,Fd as ai,Fe as ct,Gb as Oe,Gc as jt,Gd as pi,Ge as Mi,H as xt,Hb as Fe,Hc as Gt,He as Ri,Hg as $i,Hh as Ze,Ib as Ve,Id as li,If as Ni,Ig as Yi,Ja as z,Jc as kt,Jf as L,Ji as ve,K as v,Ka as st,Kc as mt,Kd as mi,L as Ue,La as at,Ld as ci,Lf as Pi,Mb as B,Md as di,Me as ze,Mf as be,Mh as nn,Na as u,Nc as Wt,Nd as ui,Ne as wi,Nf as Se,Ng as qi,Nh as rn,Nj as bn,O as I,Oa as f,Ob as wt,Oh as on,P as E,Pf as Oi,Ph as sn,Ra as N,Rd as fi,Sc as zt,Sh as an,Ub as Dt,Uh as pn,Vb as y,Vd as _i,Vf as Fi,Wb as Lt,Wf as dt,Wh as ln,Xa as At,Xb as Bt,Xf as Vi,Y as p,Ya as M,Yd as gi,Ye as w,Yj as Je,Z as m,Za as Be,Zb as je,Zd as hi,Zh as Ke,Zj as et,_a as Ut,_b as H,_c as Ht,_h as mn,_j as Sn,ae as he,af as Di,ag as Gi,ai as cn,bd as Yt,be as Si,bh as Qi,cb as Mt,ce as vi,cf as He,ch as Ye,d as K,da as _,dd as qt,de as ee,dh as ut,ee as te,ef as D,ei as dn,ek as vn,fe as ie,fh as qe,ga as a,gc as se,ge as ne,gk as In,ha as j,hc as Nt,he as Ii,hh as O,hi as re,i as Te,ic as Pt,ie as Ei,je as Ci,jk as En,ka as s,kc as Ot,kd as Qt,ke as Ti,kf as Li,kk as Cn,la as l,lc as Ft,ld as Zt,m as Ct,ma as h,mh as Zi,n as Tt,na as rt,ne as yi,nf as Bi,oa as ot,od as Kt,of as $e,oh as Ki,pa as T,pd as Xt,pe,ph as le,qa as b,qb as R,qd as ge,qe as xi,qh as Xi,qj as un,ra as c,rd as Jt,re as Ai,rh as Qe,sj as fn,tb as fe,td as ei,tg as ki,ua as ce,ub as _e,ud as ae,ug as Wi,uh as Ji,uj as _n,vc as k,vd as ti,wa as Me,wb as pt,x as yt,xa as Re,xe as P,xh as en,y as ye,ya as we,yb as Ne,yi as Xe,za as A,zc as Vt,ze as Ui,zh as Y}from"./chunk-L2Q74ABV.js";function Yn(e,i){e&1&&(s(0,"h1",7),g(1),u(2,"translate"),l()),e&2&&(p(),S(" ",f(2,1,"SHARED_LIB.PERUN.ORGANIZATIONS.YOU_ARE_MEMBER"),`
`))}function qn(e,i){e&1&&(s(0,"h1",7),g(1),u(2,"translate"),l()),e&2&&(p(),S(" ",f(2,1,"SHARED_LIB.PERUN.ORGANIZATIONS.USER_IS_MEMBER"),`
`))}function Qn(e,i){if(e&1&&h(0,"perun-web-apps-vos-list",8),e&2){let r=c();a("loading",r.memberRefresh)("displayedColumns",r.displayedColumns)("tableId",r.memberTableId)("filterValue",r.memberFilterValue)("vos",r.vosWhereIsMember)}}function Zn(e,i){if(e&1&&h(0,"perun-web-apps-vos-list",8),e&2){let r=c(2);a("loading",r.adminRefresh)("displayedColumns",r.displayedColumns)("tableId",r.adminTableId)("filterValue",r.adminFilterValue)("vos",r.vosWhereIsAdmin)}}function Kn(e,i){if(e&1){let r=T();s(0,"div",9)(1,"h1",7),g(2),u(3,"translate"),l(),s(4,"perun-web-apps-refresh-button",1),b("refresh",function(){I(r);let n=c();return E(n.refreshAdminTable())}),l(),s(5,"perun-web-apps-debounce-filter",2),b("filter",function(n){I(r);let o=c();return E(o.applyAdminFilter(n))}),l(),s(6,"div",3),_(7,Zn,1,5,"perun-web-apps-vos-list",4),l()()}if(e&2){let r=c(),t=A(8);p(2),x(f(3,4,"SHARED_LIB.PERUN.ORGANIZATIONS.USER_IS_ADMIN")),p(3),a("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),p(2),a("perunWebAppsLoader",r.adminRefresh)("perunWebAppsLoaderIndicator",t)}}function Xn(e,i){e&1&&h(0,"perun-web-apps-loading-table")}var _t=(()=>{let i=class i{constructor(t,n,o,d){this.usersService=t,this.authResolver=n,this.store=o,this.route=d,this.vosWhereIsAdmin=[],this.vosWhereIsMember=[],this.adminFilterValue="",this.memberFilterValue="",this.displayedColumns=["id","name"],this.adminTableId=ji,this.memberTableId=Gi}ngOnInit(){(this.isMyProfile=this.route.snapshot.data.showPrincipal)?this.userId=this.store.getPerunPrincipal().user.id:this.route.parent.params.subscribe(t=>this.userId=Number(t.userId)),this.refreshAdminTable(),this.refreshMemberTable()}refreshMemberTable(){this.memberRefresh=!0,this.usersService.getVosWhereUserIsMember(this.userId).subscribe(t=>{this.vosWhereIsMember=t,this.memberRefresh=!1},()=>this.memberRefresh=!1)}refreshAdminTable(){this.adminRefresh=!0,this.usersService.getVosWhereUserIsAdmin(this.userId).subscribe(t=>{this.vosWhereIsAdmin=t,this.adminRefresh=!1},()=>this.adminRefresh=!1)}applyMemberFilter(t){this.memberFilterValue=t}applyAdminFilter(t){this.adminFilterValue=t}};i.\u0275fac=function(n){return new(n||i)(m(B),m(H),m(G),m(R))},i.\u0275cmp=v({type:i,selectors:[["app-user-organizations"]],hostVars:2,hostBindings:function(n,o){n&2&&j("router-component",o.true)},decls:9,vars:6,consts:[["class","page-subtitle",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],[1,"position-relative","table-min-height"],[3,"loading","displayedColumns","tableId","filterValue","vos",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["class","mt-5",4,"ngIf"],["spinner",""],[1,"page-subtitle"],[3,"loading","displayedColumns","tableId","filterValue","vos"],[1,"mt-5"]],template:function(n,o){if(n&1&&(_(0,Yn,3,3,"h1",0)(1,qn,3,3,"h1",0),s(2,"perun-web-apps-refresh-button",1),b("refresh",function(){return o.refreshMemberTable()}),l(),s(3,"perun-web-apps-debounce-filter",2),b("filter",function(C){return o.applyMemberFilter(C)}),l(),s(4,"div",3),_(5,Qn,1,5,"perun-web-apps-vos-list",4),l(),_(6,Kn,8,6,"div",5)(7,Xn,1,0,"ng-template",null,6,N)),n&2){let d=A(8);a("ngIf",o.isMyProfile),p(),a("ngIf",!o.isMyProfile),p(2),a("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),p(2),a("perunWebAppsLoader",o.memberRefresh)("perunWebAppsLoaderIndicator",d),p(),a("ngIf",!o.isMyProfile)}},dependencies:[M,L,Qi,O,Y,D,y]});let e=i;return e})();function er(e,i){e&1&&(s(0,"h1",7),g(1),u(2,"translate"),l()),e&2&&(p(),S(" ",f(2,1,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.YOU_ARE_MEMBER"),`
`))}function tr(e,i){e&1&&(s(0,"h1",7),g(1),u(2,"translate"),l()),e&2&&(p(),S(" ",f(2,1,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.USER_IS_MEMBER"),`
`))}var Tn=()=>["id","vo","name","description"];function ir(e,i){if(e&1&&h(0,"perun-web-apps-groups-list",8),e&2){let r=c();a("loading",r.memberRefresh)("disableMembers",!1)("groups",r.membersGroups)("displayedColumns",z(6,Tn))("filter",r.memberFilterValue)("tableId",r.tableId)}}function nr(e,i){if(e&1&&h(0,"perun-web-apps-groups-list",8),e&2){let r=c(2);a("loading",r.adminRefresh)("disableMembers",!1)("groups",r.adminsGroups)("displayedColumns",z(6,Tn))("filter",r.adminFilterValue)("tableId",r.adminTableId)}}function rr(e,i){if(e&1){let r=T();s(0,"div",9)(1,"h1",7),g(2),u(3,"translate"),l(),s(4,"perun-web-apps-refresh-button",1),b("refresh",function(){I(r);let n=c();return E(n.refreshAdminTable())}),l(),s(5,"perun-web-apps-debounce-filter",2),b("filter",function(n){I(r);let o=c();return E(o.adminFilter(n))}),l(),s(6,"div",3),_(7,nr,1,7,"perun-web-apps-groups-list",4),l()()}if(e&2){let r=c(),t=A(8);p(2),S(" ",f(3,4,"SHARED.COMPONENTS.USER_DETAIL.GROUPS.USER_IS_ADMIN")," "),p(3),a("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),p(2),a("perunWebAppsLoader",r.adminRefresh)("perunWebAppsLoaderIndicator",t)}}function or(e,i){e&1&&h(0,"perun-web-apps-loading-table")}var gt=(()=>{let i=class i{constructor(t,n,o,d,C){this.usersService=t,this.memberService=n,this.groupService=o,this.store=d,this.route=C,this.memberFilterValue="",this.adminFilterValue="",this.vos=[],this.membersGroups=[],this.adminsGroups=[],this.tableId=ki,this.adminTableId=Wi}ngOnInit(){(this.showPrincipal=this.route.snapshot.data.showPrincipal)?this.userId=this.store.getPerunPrincipal().user.id:this.route.parent.params.subscribe(t=>this.userId=Number(t.userId)),this.refreshAdminTable(),this.refreshMemberTable()}memberFilter(t){this.memberFilterValue=t}adminFilter(t){this.adminFilterValue=t}refreshAdminTable(){this.adminRefresh=!0,this.usersService.getGroupsWhereUserIsAdmin(this.userId).subscribe(t=>{this.adminsGroups=t,this.adminRefresh=!1})}refreshMemberTable(){this.memberRefresh=!0,this.membersGroups=[],this.usersService.getVosWhereUserIsMember(this.userId).subscribe(t=>{this.vos=t;for(let n of this.vos)this.memberService.getMemberByUser(n.id,this.userId).subscribe(o=>{this.groupService.getMemberGroups(o.id).subscribe(d=>{this.membersGroups=this.membersGroups.concat(d),this.vos.indexOf(n)===this.vos.length-1&&(this.memberRefresh=!1)})});t.length===0&&(this.memberRefresh=!1)})}};i.\u0275fac=function(n){return new(n||i)(m(B),m(Oe),m(Pe),m(G),m(R))},i.\u0275cmp=v({type:i,selectors:[["app-user-groups"]],hostVars:2,hostBindings:function(n,o){n&2&&j("router-component",o.true)},decls:9,vars:6,consts:[["class","page-subtitle",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],[1,"position-relative","table-min-height"],[3,"loading","disableMembers","groups","displayedColumns","filter","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["class","mt-5",4,"ngIf"],["spinner",""],[1,"page-subtitle"],[3,"loading","disableMembers","groups","displayedColumns","filter","tableId"],[1,"mt-5"]],template:function(n,o){if(n&1&&(_(0,er,3,3,"h1",0)(1,tr,3,3,"h1",0),s(2,"perun-web-apps-refresh-button",1),b("refresh",function(){return o.refreshMemberTable()}),l(),s(3,"perun-web-apps-debounce-filter",2),b("filter",function(C){return o.memberFilter(C)}),l(),s(4,"div",3),_(5,ir,1,7,"perun-web-apps-groups-list",4),l(),_(6,rr,8,6,"div",5)(7,or,1,0,"ng-template",null,6,N)),n&2){let d=A(8);a("ngIf",o.showPrincipal),p(),a("ngIf",!o.showPrincipal),p(2),a("placeholder","SHARED_LIB.PERUN.ORGANIZATIONS.FILTER"),p(2),a("perunWebAppsLoader",o.memberRefresh)("perunWebAppsLoaderIndicator",d),p(),a("ngIf",!o.showPrincipal)}},dependencies:[M,L,Ye,O,Y,D,y]});let e=i;return e})();var yn=(()=>{let i=class i{};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=v({type:i,selectors:[["app-user-settings"]],hostVars:2,hostBindings:function(n,o){n&2&&j("router-component",o.true)},decls:1,vars:0,template:function(n,o){n&1&&h(0,"app-animated-router-outlet")},dependencies:[re]});let e=i;return e})();function sr(e,i){e&1&&h(0,"mat-spinner",2)}function ar(e,i){if(e&1&&(s(0,"div"),h(1,"perun-web-apps-menu-buttons-field",3),l()),e&2){let r=c();p(),a("items",r.navItems)}}var xn=(()=>{let i=class i{constructor(t,n){this.route=t,this.userManager=n,this.navItems=[],this.loading=!1}ngOnInit(){window.location.pathname.startsWith("/admin")?(this.loading=!0,this.route.parent.parent.params.subscribe(t=>{let n=Number(t.userId);this.userManager.getUserById(n).subscribe(o=>{this.isServiceUser=o.serviceUser,this.initNavItems(),this.loading=!1},()=>this.loading=!1)})):this.initNavItems()}initNavItems(){this.navItems=[],window.location.pathname.startsWith("/admin")||this.navItems.push({cssIcon:"perun-settings2",url:"/myProfile/settings/passwordReset",label:"MENU_ITEMS.USER.PASSWORD_RESET",style:"user-btn"},{cssIcon:"perun-settings1",url:"/myProfile/settings/guiConfig",label:"MENU_ITEMS.USER.GUI_CONFIG",style:"user-btn"})}};i.\u0275fac=function(n){return new(n||i)(m(R),m(B))},i.\u0275cmp=v({type:i,selectors:[["app-user-settings-overview"]],hostVars:2,hostBindings:function(n,o){n&2&&j("router-component",o.true)},decls:2,vars:2,consts:[["class","me-auto ms-auto",4,"ngIf"],[4,"ngIf"],[1,"me-auto","ms-auto"],[3,"items"]],template:function(n,o){n&1&&_(0,sr,1,0,"mat-spinner",0)(1,ar,2,1,"div",1),n&2&&(a("ngIf",o.loading),p(),a("ngIf",!o.loading))},dependencies:[M,ae,le]});let e=i;return e})();function lr(e,i){e&1&&(g(0),u(1,"translate")),e&2&&S(" ",f(1,1,"ADMIN_USER.ENTITY")," ")}function mr(e,i){if(e&1&&h(0,"app-one-entity-attribute-page",6),e&2){let r=c();a("entityId",r.userId)("entity","user")}}function cr(e,i){e&1&&(g(0),u(1,"translate"),u(2,"translate")),e&2&&De(" ",f(1,2,"ADMIN_USER.ENTITY")," - ",f(2,4,"FACILITY_DETAIL.ENTITY")," ")}function dr(e,i){if(e&1&&h(0,"app-two-entity-attribute-page",7),e&2){let r=c(2);a("firstEntity","user")("firstEntityId",r.userId)("secondEntity","facility")}}function ur(e,i){e&1&&(s(0,"mat-tab"),_(1,cr,3,6,"ng-template",3)(2,dr,1,3,"ng-template",4),l())}var St=(()=>{let i=class i{constructor(t,n,o){this.route=t,this.store=n,this.authResolver=o}ngOnInit(){this.route.parent.params.subscribe(t=>{this.userId=Number(t.userId),this.userId||(this.userId=this.store.getPerunPrincipal().userId);let n={id:this.userId,beanName:"User"};this.userFacilityAttAuth=this.authResolver.isAuthorized("getAssignedFacilities_User_policy",[n])})}};i.\u0275fac=function(n){return new(n||i)(m(R),m(G),m(H))},i.\u0275cmp=v({type:i,selectors:[["app-user-settings-attributes"]],hostVars:2,hostBindings:function(n,o){n&2&&j("router-component",o.true)},decls:8,vars:4,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false"],[1,"mb-2"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(n,o){n&1&&(s(0,"h1",0),g(1),u(2,"translate"),l(),s(3,"mat-tab-group",1)(4,"mat-tab",2),_(5,lr,2,3,"ng-template",3)(6,mr,1,2,"ng-template",4),l(),_(7,ur,3,0,"mat-tab",5),l()),n&2&&(p(),x(f(2,2,"USER_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),p(6),a("ngIf",o.userFacilityAttAuth))},dependencies:[M,ee,te,ie,ne,ve,Xe,y]});let e=i;return e})();function fr(e,i){if(e&1&&(s(0,"mat-option",6),g(1),l()),e&2){let r=i.$implicit;a("value",r),p(),S(" ",r," ")}}var Un=(()=>{let i=class i{constructor(t){this.guiConfigService=t,this.tablePageSizeOptions=xi}ngOnInit(){switch(localStorage.getItem("showIds")){case"true":this.showIds=!0;break;case"false":this.showIds=!1;break;default:this.showIds=!1}this.preferredTablePageSize=this.guiConfigService.getNumber(dt)}updatePreferredTablePageSize(){this.guiConfigService.setNumber(dt,this.preferredTablePageSize)}toggleShowIds(){this.showIds=!this.showIds,this.guiConfigService.setString("showIds",this.showIds.toString())}};i.\u0275fac=function(n){return new(n||i)(m(Vi))},i.\u0275cmp=v({type:i,selectors:[["app-user-settings-app-configuration"]],decls:12,vars:10,consts:[[1,"page-subtitle"],[1,"col-12","col-lg-6","p-0"],[1,"w-100"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],["labelPosition","before",1,"mt-2","ms-2","w-75",3,"ngModel","toggleChange"],[3,"value"]],template:function(n,o){n&1&&(s(0,"h1",0),g(1),u(2,"translate"),l(),s(3,"div",1)(4,"mat-form-field",2)(5,"mat-label"),g(6),u(7,"translate"),l(),s(8,"mat-select",3),b("valueChange",function(C){return o.preferredTablePageSize=C})("valueChange",function(){return o.updatePreferredTablePageSize()}),_(9,fr,2,2,"mat-option",4),l()(),s(10,"mat-slide-toggle",5),b("toggleChange",function(){return o.toggleShowIds()}),g(11),l()()),n&2&&(p(),x(f(2,6,"USER_DETAIL.SETTINGS.GUI_CONFIG.TITLE")),p(5),x(f(7,8,"USER_DETAIL.SETTINGS.GUI_CONFIG.PREF_TABLE_PAGE_SIZE")),p(2),a("value",o.preferredTablePageSize),p(),a("ngForOf",o.tablePageSizeOptions),p(),a("ngModel",o.showIds),p(),S(" ","Show IDs in tables"," "))},dependencies:[At,Ft,Kt,Zt,Wt,zt,hi,Ei,y]});let e=i;return e})();function hr(e,i){e&1&&h(0,"th",13)}function br(e,i){if(e&1&&(s(0,"td",14),g(1),l()),e&2){let r=i.$implicit;p(),S("",r.displayName,":")}}function Sr(e,i){e&1&&h(0,"th",13)}function vr(e,i){if(e&1){let r=T();s(0,"td",15)(1,"div",16),g(2),s(3,"button",17),b("click",function(){I(r);let n=c(2);return E(n.changeEmail())}),u(4,"translate"),s(5,"mat-icon"),g(6,"edit"),l()()()()}if(e&2){let r=i.$implicit;p(2),S(" ",r.value," "),p(),ce("matTooltip",f(4,2,"USER_DETAIL.OVERVIEW.CHANGE_EMAIL"))}}function Ir(e,i){e&1&&h(0,"tr",18)}function Er(e,i){if(e&1&&(s(0,"div",3)(1,"mat-card",4)(2,"mat-card-header")(3,"mat-card-title")(4,"h1",5),g(5),u(6,"translate"),l()()(),s(7,"mat-card-content")(8,"table",6),rt(9,7),_(10,hr,1,0,"th",8)(11,br,2,1,"td",9),ot(),rt(12,10),_(13,Sr,1,0,"th",8)(14,vr,7,4,"td",11),ot(),_(15,Ir,1,0,"tr",12),l()()()()),e&2){let r=c();p(5),x(f(6,3,"USER_DETAIL.OVERVIEW.GENERAL_SETTINGS")),p(3),a("dataSource",r.mailDataSource),p(7),a("matRowDefColumns",r.displayedColumns)}}var wn=(()=>{let i=class i{constructor(t,n,o,d,C){this.userService=t,this.attributeService=n,this.storeService=o,this.route=d,this.dialog=C,this.items=[],this.settingsItems=[],this.isServiceUser=!1,this.displayedColumns=["name","value"],this.inMyProfile=!1}ngOnInit(){this.route.params.subscribe(t=>{t.userId?this.userService.getUserById(Number(t.userId)).subscribe(n=>{this.user=n,this.isServiceUser=n.serviceUser,this.setItems(`/admin/users/${this.user.id}`),this.setSettingsItems()}):(this.inMyProfile=!0,this.userID=this.storeService.getPerunPrincipal().user.id,this.attributeService.getUserAttributeByName(this.userID,pe.USER_DEF_PREFERRED_MAIL).subscribe(n=>{this.preferredMail=n,this.handleMailNotDefined(),this.mailDataSource=new di([this.preferredMail]),this.setItems("/myProfile"),this.setSettingsItems()}))})}changeEmail(){let t=P();t.width="450px",this.dialog.open(En,t)}handleMailNotDefined(){(this.preferredMail===null||this.preferredMail===void 0)&&(this.preferredMail={id:-1,beanName:"Attribute",displayName:Ai(pe.USER_DEF_PREFERRED_MAIL.split(":").pop()),value:new Object("-")})}setItems(t){this.items=[],this.inMyProfile?this.items.push({cssIcon:"perun-vo",url:`${t}/organizations`,label:"MENU_ITEMS.ADMIN.ORGANIZATIONS",style:"user-btn"},{cssIcon:"perun-group",url:`${t}/groups`,label:"MENU_ITEMS.ADMIN.GROUPS",style:"user-btn"}):this.items.push({cssIcon:"perun-user",url:`${t}/accounts`,label:"MENU_ITEMS.USER.ACCOUNTS",style:"user-btn"},{cssIcon:"perun-facility-white",url:`${t}/assignments`,label:"MENU_ITEMS.USER.ASSIGNMENTS",style:"user-btn"},{cssIcon:"perun-identity",url:`${t}/identities`,label:"MENU_ITEMS.USER.IDENTITIES",style:"user-btn"},{cssIcon:"perun-applications",url:`${t}/applications`,label:"MENU_ITEMS.USER.APPLICATIONS",style:"user-btn"}),this.items.push({cssIcon:"perun-attributes",url:`${t}/attributes`,label:"MENU_ITEMS.USER.ATTRIBUTES",style:"user-btn"}),this.items.push({cssIcon:"perun-roles",url:`${t}/roles`,label:"MENU_ITEMS.USER.ROLES",style:"user-btn"}),this.isServiceUser?this.items.push({cssIcon:"perun-manager",url:`${t}/associated-users`,label:"MENU_ITEMS.USER.ASSOCIATED_USERS",style:"user-btn"}):this.items.push({cssIcon:"perun-service-identity",url:`${t}/service-identities`,label:"MENU_ITEMS.USER.SERVICE_IDENTITIES",style:"user-btn"}),this.items.push({cssIcon:"perun-ban",url:"bans",label:"MENU_ITEMS.USER.BANS",style:"user-btn"})}setSettingsItems(){this.settingsItems=[],this.inMyProfile&&this.settingsItems.push({cssIcon:"perun-settings2",url:"/myProfile/settings/passwordReset",label:"MENU_ITEMS.USER.PASSWORD_RESET",style:"user-btn"},{cssIcon:"perun-settings1",url:"/myProfile/settings/guiConfig",label:"MENU_ITEMS.USER.GUI_CONFIG",style:"user-btn"})}};i.\u0275fac=function(n){return new(n||i)(m(B),m(Ne),m(G),m(R),m(k))},i.\u0275cmp=v({type:i,selectors:[["app-user-overview"]],hostVars:2,hostBindings:function(n,o){n&2&&j("router-component",o.true)},decls:3,vars:5,consts:[["class","align-cards",4,"ngIf"],[3,"items"],[3,"items","title","sectionId"],[1,"align-cards"],["appearance","outlined",1,"card","mat-elevation-z3"],[1,"page-subtitle"],["mat-table","",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["class","fw-bold","mat-cell","",4,"matCellDef"],["matColumnDef","value"],["mat-cell","",4,"matCellDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"fw-bold"],["mat-cell",""],[1,"d-flex","align-items-center"],["mat-icon-button","",1,"ms-3",3,"matTooltip","click"],["mat-row",""]],template:function(n,o){n&1&&(_(0,Er,16,5,"div",0),h(1,"perun-web-apps-menu-buttons-field",1)(2,"perun-web-apps-expandable-tiles",2)),n&2&&(a("ngIf",o.inMyProfile),p(),a("items",o.items),p(),a("items",o.settingsItems)("title","MENU_ITEMS.USER.SETTINGS")("sectionId","settings"))},dependencies:[M,ge,Ge,ni,oi,si,ri,li,ai,pi,mi,he,ke,Gt,kt,jt,le,Ke,y],styles:[".align-cards[_ngcontent-%COMP%]{margin:1rem 0;display:inline-block;vertical-align:top}"]});let e=i;return e})();var xr=()=>({color:"black"}),Dn=()=>["/myProfile"];function Ar(e,i){if(e&1&&(s(0,"div",1),h(1,"perun-web-apps-back-button"),s(2,"div",2),h(3,"mat-icon",3),u(4,"translate"),s(5,"div",4)(6,"div",5)(7,"a",6),b("auxclick",function(t){return t.preventDefault()}),g(8),u(9,"userFullName"),l(),s(10,"span",7),g(11),l()(),s(12,"span",8),g(13),u(14,"translate"),u(15,"translate"),l()()(),h(16,"app-animated-router-outlet"),l()),e&2){let r=c();p(3),ce("matTooltip",f(4,9,"MENU_ITEMS.USER.ENTITY")),a("ngStyle",z(17,xr)),p(4),a("perunWebAppsMiddleClickRouterLink",z(18,Dn))("routerLink",z(19,Dn)),p(),S(" ",f(9,11,r.user)," "),p(3),S(" \xA0#",r.user.id," "),p(2),Le(" ",f(14,13,"MENU_ITEMS.USER.ENTITY"),", ",f(15,15,"MENU_ITEMS.USER.USER_TYPE"),": ",r.getUserType()," ")}}var Bn=(()=>{let i=class i{constructor(t,n,o,d){this.sideMenuService=t,this.store=n,this.entityStore=o,this.router=d}ngOnInit(){this.path=this.router.url,this.router.events.subscribe(()=>{this.path=this.router.url}),this.principal=this.store.getPerunPrincipal(),this.user=this.principal.user,this.entityStore.setEntityAndPathParam(this.user,je.User),this.sideMenuService.setUserItems([])}getUserType(){return this.user.serviceUser?"Service":"Person"}};i.\u0275fac=function(n){return new(n||i)(m(He),m(G),m(w),m(fe))},i.\u0275cmp=v({type:i,selectors:[["app-user-profile"]],decls:1,vars:1,consts:[["class","container-fluid ps-xl-5 pe-xl-5 user-theme",4,"ngIf"],[1,"container-fluid","ps-xl-5","pe-xl-5","user-theme"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-user-dark",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"user-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],[1,"text-muted"],[1,"mt-1","entity-info"]],template:function(n,o){n&1&&_(0,Ar,17,20,"div",0),n&2&&a("ngIf",o.user!==void 0)},dependencies:[M,Be,_e,ge,he,qe,be,Se,re,y,$e]});let e=i;return e})();function Ur(e,i){e&1&&(g(0),u(1,"translate")),e&2&&S(" ",f(1,1,"USER_DETAIL.DASHBOARD.DIRECT_ROLES")," ")}function Mr(e,i){if(e&1){let r=T();s(0,"app-perun-web-apps-roles-page",4),b("currentlyOpenPanelChange",function(n){I(r);let o=c();return E(o.userBasedOpenPanel=n)})("reload",function(){I(r);let n=c();return E(n.getData())})("startLoading",function(){I(r);let n=c();return E(n.outerLoading=!0)}),l()}if(e&2){let r=c();a("outerLoading",r.outerLoading)("roles",r.roles)("entityId",r.userId)("showDescription",r.showDescription)("entityType",r.entityType)("editable",!0)("currentlyOpenPanel",r.userBasedOpenPanel)}}function Rr(e,i){e&1&&(g(0),u(1,"translate")),e&2&&S(" ",f(1,1,"USER_DETAIL.DASHBOARD.AUTHORIZED_GROUP_BASED_ROLES")," ")}function wr(e,i){if(e&1){let r=T();s(0,"app-perun-web-apps-roles-page",5),b("currentlyOpenPanelChange",function(n){I(r);let o=c();return E(o.groupBasedOpenPanel=n)})("reload",function(){I(r);let n=c();return E(n.getData())})("startLoading",function(){I(r);let n=c();return E(n.outerLoading=!0)}),l()}if(e&2){let r=c();a("outerLoading",r.outerLoading)("roles",r.indirectRoles)("entityId",r.userId)("showDescription",r.showDescription)("entityType",r.entityType)("editable",!1)("complementaryObjectsWithAuthzGroups",r.rolesComplementaryObjectsWithAuthzGroups)("currentlyOpenPanel",r.groupBasedOpenPanel)}}var vt=(()=>{let i=class i{constructor(t,n,o,d){this.authzResolverService=t,this.route=n,this.store=o,this.roleService=d,this.roles=new Map,this.indirectRoles=new Map,this.rolesComplementaryObjectsWithAuthzGroups=new Map,this.showDescription=!0,this.userBasedOpenPanel=null,this.groupBasedOpenPanel=null}ngOnInit(){this.outerLoading=!0,this.route.parent.params.subscribe(t=>{t.userId?(this.entityType="USER",this.userId=Number(t.userId)):(this.userId=this.store.getPerunPrincipal().userId,this.entityType="SELF"),this.getData()})}getData(){this.outerLoading=!0,this.roles.clear(),this.authzResolverService.getUserDirectRoles(this.userId).subscribe({next:t=>{let n=Object.keys(t).map(o=>o.toUpperCase());this.roles=this.roleService.prepareRoles(t,n),this.indirectRoles.clear(),this.authzResolverService.getUserRolesObtainedFromAuthorizedGroupMemberships(this.userId).subscribe({next:o=>{let d=Object.keys(o).map(C=>C.toUpperCase());this.indirectRoles=this.roleService.prepareRoles(o,d),this.rolesComplementaryObjectsWithAuthzGroups.clear(),this.authzResolverService.getRoleComplementaryObjectsWithAuthorizedGroups(this.userId).subscribe({next:C=>{this.rolesComplementaryObjectsWithAuthzGroups=this.roleService.prepareComplementaryObjects(Object.keys(C),C),this.outerLoading=!1},error:()=>this.outerLoading=!1})},error:()=>this.outerLoading=!1})},error:()=>this.outerLoading=!1})}};i.\u0275fac=function(n){return new(n||i)(m(Rt),m(R),m(G),m(Di))},i.\u0275cmp=v({type:i,selectors:[["app-user-roles"]],hostVars:2,hostBindings:function(n,o){n&2&&j("router-component",o.true)},decls:10,vars:3,consts:[[1,"page-subtitle","d-flex"],["mat-stretch-tabs","false"],["matTabLabel",""],["matTabContent",""],[3,"outerLoading","roles","entityId","showDescription","entityType","editable","currentlyOpenPanel","currentlyOpenPanelChange","reload","startLoading"],[3,"outerLoading","roles","entityId","showDescription","entityType","editable","complementaryObjectsWithAuthzGroups","currentlyOpenPanel","currentlyOpenPanelChange","reload","startLoading"]],template:function(n,o){n&1&&(s(0,"h1",0),g(1),u(2,"translate"),l(),s(3,"mat-tab-group",1)(4,"mat-tab"),_(5,Ur,2,3,"ng-template",2)(6,Mr,1,7,"ng-template",3),l(),s(7,"mat-tab"),_(8,Rr,2,3,"ng-template",2)(9,wr,1,8,"ng-template",3),l()()),n&2&&(p(),x(f(2,1,"ROLES.TITLE")))},dependencies:[ee,te,ie,ne,un,y]});let e=i;return e})();function Lr(e,i){if(e&1){let r=T();s(0,"button",7),b("click",function(){I(r);let n=c();return E(n.onAdd())}),g(1),u(2,"translate"),l()}e&2&&(p(),S(" ",f(2,1,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.CREATE"),`
`))}function Br(e,i){if(e&1){let r=T();s(0,"button",8),b("click",function(){I(r);let n=c();return E(n.onRemove())}),g(1),u(2,"translate"),l()}if(e&2){let r=c();a("disabled",r.loading||r.selection.selected.length===0),p(),S(" ",f(2,2,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.DELETE"),`
`)}}function Nr(e,i){e&1&&h(0,"perun-web-apps-loading-table")}function Pr(e,i){if(e&1&&(h(0,"perun-web-apps-users-list",9),u(1,"translate")),e&2){let r=c();a("loading",r.loading)("noUsersFoundLabel",f(1,8,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.NO_IDENTITIES"))("routeToAdmin",r.routeToAdminSection)("displayColumns",r.displayedColumns)("selection",r.selection)("tableId",r.tableId)("users",r.identities)("cacheSubject",r.cacheSubject)}}var It=(()=>{let i=class i{constructor(t,n,o,d,C,Z){this.route=t,this.dialog=n,this.router=o,this.userManager=d,this.authResolver=C,this.store=Z,this.loading=!1,this.selection=new se(!1,[],!1,(me,nt)=>me.id===nt.id),this.identities=[],this.tableId=$i,this.displayedColumns=["select","id","user","name"],this.routeToAdminSection=!0,this.targetTitle="SERVICE",this.targetDescription="SERVICE",this.cacheSubject=new K(!0)}ngOnDestroy(){this.subscription.unsubscribe()}ngOnInit(){this.loading=!0,this.subscription=this.route.parent.params.subscribe(t=>{this.userId=Number(t.userId),this.userId||(this.targetTitle="SERVICE",this.targetDescription="SELF",this.userId=this.store.getPerunPrincipal().userId,this.routeToAdminSection=!1),this.setAuthRights(),this.refreshTable()})}refreshTable(){this.loading=!0,this.userManager.getSpecificUsersByUser(this.userId).subscribe(t=>{this.identities=t,this.cacheSubject.next(!0),this.selection.clear(),this.loading=!1})}setAuthRights(){this.addIdentity=this.authResolver.isPerunAdmin(),this.removeIdentity=this.authResolver.isAuthorized("removeSpecificUserOwner_User_User_policy",[{id:this.userId,beanName:"User"}])}onAdd(){let t=P();t.width="1250px",t.data={userId:this.userId,theme:"user-theme",isService:!1,target:this.targetTitle},this.dialog.open(Je,t).afterClosed().subscribe(o=>{o&&this.refreshTable()})}onRemove(){let t=P();t.width="650px",t.data={identities:this.selection.selected,userId:this.userId,specificUser:this.selection.selected[0],theme:"user-theme",targetTitle:this.targetTitle,targetDescription:this.targetDescription},this.dialog.open(et,t).afterClosed().subscribe(o=>{o&&this.refreshTable()})}};i.\u0275fac=function(n){return new(n||i)(m(R),m(k),m(fe),m(B),m(H),m(G))},i.\u0275cmp=v({type:i,selectors:[["app-user-settings-service-identities"]],decls:10,vars:7,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","class","me-2 action-button","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","class","me-2","mat-flat-button","",3,"disabled","click",4,"ngIf"],["spinner",""],[1,"position-relative","table-min-height"],[3,"loading","noUsersFoundLabel","routeToAdmin","displayColumns","selection","tableId","users","cacheSubject",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"loading","noUsersFoundLabel","routeToAdmin","displayColumns","selection","tableId","users","cacheSubject"]],template:function(n,o){if(n&1&&(s(0,"h1",0),g(1),u(2,"translate"),l(),s(3,"perun-web-apps-refresh-button",1),b("refresh",function(){return o.refreshTable()}),l(),_(4,Lr,3,3,"button",2)(5,Br,3,4,"button",3)(6,Nr,1,0,"ng-template",null,4,N),s(8,"div",5),_(9,Pr,2,10,"perun-web-apps-users-list",6),l()),n&2){let d=A(7);p(),x(f(2,5,"USER_DETAIL.SETTINGS.SERVICE_IDENTITIES.TITLE")),p(3),a("ngIf",o.addIdentity),p(),a("ngIf",o.removeIdentity),p(4),a("perunWebAppsLoader",o.loading)("perunWebAppsLoaderIndicator",d)}},dependencies:[M,$,L,O,Ze,D,y]});let e=i;return e})();function Or(e,i){e&1&&h(0,"mat-spinner",11)}function Fr(e,i){if(e&1){let r=T();s(0,"button",12),b("click",function(){I(r);let n=c(2);return E(n.editUser())}),u(1,"translate"),s(2,"mat-icon"),g(3,"edit"),l()()}e&2&&ce("matTooltip",f(1,1,"MENU_ITEMS.USER.EDIT"))}var Vr=()=>({color:"black"}),Nn=e=>["/myProfile/service-identities",e];function jr(e,i){if(e&1&&(s(0,"div",1),h(1,"perun-web-apps-back-button"),_(2,Or,1,0,"mat-spinner",2),s(3,"div",3),h(4,"mat-icon",4),u(5,"translate"),s(6,"div",5)(7,"div",6)(8,"a",7),b("auxclick",function(t){return t.preventDefault()}),g(9),u(10,"userFullName"),l(),s(11,"span",8),g(12),l(),_(13,Fr,4,3,"button",9),l(),s(14,"div"),g(15),u(16,"translate"),l(),s(17,"span",10),g(18),u(19,"translate"),u(20,"translate"),l()()(),h(21,"app-animated-router-outlet"),l()),e&2){let r=c();p(2),a("ngIf",r.loading),p(2),ce("matTooltip",f(5,13,"MENU_ITEMS.USER.ENTITY")),a("ngStyle",z(23,Vr)),p(4),a("perunWebAppsMiddleClickRouterLink",st(24,Nn,r.user.id.toString()))("routerLink",st(26,Nn,r.user.id)),p(),S(" ",f(10,15,r.user)," "),p(3),S(" \xA0#",r.user.id," "),p(),a("ngIf",r.authResolver.isPerunAdmin()),p(2),De("",f(16,17,"ADMIN_USER.UUID"),": ",r.user.uuid,""),p(3),Le(" ",f(19,19,"MENU_ITEMS.USER.ENTITY"),", ",f(20,21,"MENU_ITEMS.USER.USER_TYPE"),": ",r.getUserType()," ")}}var Pn=(()=>{let i=class i{constructor(t,n,o,d,C,Z,me){this.sideMenuService=t,this.usersService=n,this.sideMenuItemService=o,this.route=d,this.dialog=C,this.authResolver=Z,this.entityStorageService=me,this.loading=!1}ngOnInit(){this.loading=!0,this.route.params.subscribe(t=>{let n=Number(t.userId);this.entityStorageService.setEntityAndPathParam({id:n,beanName:"User"},je.User),this.usersService.getUserById(n).subscribe({next:o=>{this.user=o;let d=this.sideMenuItemService.parseServiceIdentity(o);this.sideMenuService.setUserItems([d]),this.loading=!1},error:()=>this.loading=!1})})}getUserType(){return this.user.serviceUser?"Service":"Person"}editUser(){let t=P();t.width="450px",t.data={theme:"admin-theme",user:this.user},this.dialog.open(Sn,t).afterClosed().subscribe(o=>{o&&this.usersService.getUserById(this.user.id).subscribe(d=>{this.user=d})})}};i.\u0275fac=function(n){return new(n||i)(m(He),m(B),m(dn),m(R),m(k),m(H),m(w))},i.\u0275cmp=v({type:i,selectors:[["app-service-identity-detail-page"]],decls:1,vars:1,consts:[["class","container-fluid ps-xl-5 pe-xl-5 user-theme",4,"ngIf"],[1,"container-fluid","ps-xl-5","pe-xl-5","user-theme"],["class","me-auto ms-auto",4,"ngIf"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-service-identity",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"user-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],[1,"text-muted"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],[1,"mt-1","entity-info"],[1,"me-auto","ms-auto"],["mat-icon-button","",3,"matTooltip","click"]],template:function(n,o){n&1&&_(0,jr,22,28,"div",0),n&2&&a("ngIf",o.user!==void 0)},dependencies:[M,Be,_e,ge,Ge,ae,he,qe,be,Se,re,y,$e]});let e=i;return e})();var On=(()=>{let i=class i{constructor(t){this.entityStorageService=t,this.navItems=[],this.authenticationItems=[]}ngOnInit(){this.serviceAccount=this.entityStorageService.getEntity(),this.initNavItems()}initNavItems(){this.navItems=[{cssIcon:"perun-vo",url:`/myProfile/service-identities/${this.serviceAccount.id}/organizations`,label:"MENU_ITEMS.ADMIN.ORGANIZATIONS",style:"user-btn"},{cssIcon:"perun-group",url:`/myProfile/service-identities/${this.serviceAccount.id}/groups`,label:"MENU_ITEMS.ADMIN.GROUPS",style:"user-btn"},{cssIcon:"perun-attributes",url:`/myProfile/service-identities/${this.serviceAccount.id}/attributes`,label:"MENU_ITEMS.USER.ATTRIBUTES",style:"user-btn"},{cssIcon:"perun-roles",url:`/myProfile/service-identities/${this.serviceAccount.id}/roles`,label:"MENU_ITEMS.USER.ROLES",style:"user-btn"},{cssIcon:"perun-ban",url:`/myProfile/service-identities/${this.serviceAccount.id}/bans`,label:"MENU_ITEMS.USER.BANS",style:"user-btn"},{cssIcon:"perun-manager",url:`/myProfile/service-identities/${this.serviceAccount.id}/associated-users`,label:"MENU_ITEMS.USER.ASSOCIATED_USERS",style:"user-btn"},{cssIcon:"perun-notification",url:`/myProfile/service-identities/${this.serviceAccount.id}/mailing-lists`,label:"MENU_ITEMS.USER.MAILING_LISTS",style:"user-btn"},{cssIcon:"perun-statistics",url:`/myProfile/service-identities/${this.serviceAccount.id}/data-quotas`,label:"MENU_ITEMS.USER.DATA_QUOTAS",style:"user-btn"}],this.authenticationItems=[{cssIcon:"perun-logins",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/logins`,label:"MENU_ITEMS.USER.LOGINS",style:"user-btn"},{cssIcon:"perun-certificates",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/certificates`,label:"MENU_ITEMS.USER.CERTIFICATES",style:"user-btn"},{cssIcon:"perun-key",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/ssh-keys`,label:"MENU_ITEMS.USER.SSH_KEYS",style:"user-btn"}]}};i.\u0275fac=function(n){return new(n||i)(m(w))},i.\u0275cmp=v({type:i,selectors:[["app-service-identity-overview"]],decls:2,vars:4,consts:[[3,"items"],[3,"items","title","sectionId"]],template:function(n,o){n&1&&h(0,"perun-web-apps-menu-buttons-field",0)(1,"perun-web-apps-expandable-tiles",1),n&2&&(a("items",o.navItems),p(),a("items",o.authenticationItems)("title","MENU_ITEMS.USER.AUTHENTICATION")("sectionId","authentication"))},dependencies:[le,Ke]});let e=i;return e})();function Gr(e,i){e&1&&h(0,"perun-web-apps-loading-table")}function kr(e,i){if(e&1&&(h(0,"perun-web-apps-users-list",7),u(1,"translate")),e&2){let r=c();a("loading",r.loading)("noUsersFoundLabel",f(1,9,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.NO_ASSOCIATED_USERS"))("disableRouting",r.disableRouting)("routeToAdmin",!0)("displayColumns",r.displayedColumns)("selection",r.selection)("tableId",r.tableId)("users",r.associatedUsers)("cacheSubject",r.cacheSubject)}}var Fn=(()=>{let i=class i{constructor(t,n,o,d,C){this.dialog=t,this.router=n,this.authResolver=o,this.userManager=d,this.entityStorageService=C,this.loading=!1,this.selection=new se(!1,[],!0,(Z,me)=>Z.id===me.id),this.associatedUsers=[],this.tableId=Yi,this.displayedColumns=["select","id","user","name","email","logins","organization"],this.cacheSubject=new K(!0)}ngOnInit(){this.loading=!0,this.user=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.userManager.getUsersBySpecificUser(this.user.id).pipe(Te(t=>t.map(n=>n.id)),xe(t=>{t.length===0?(this.loading=!1,this.associatedUsers=[],this.hasManagers=!1):this.hasManagers=!0}),Tt(t=>t.length>0),ye(t=>this.userManager.getRichUsersWithAttributesByIds(t))).subscribe({next:t=>{this.associatedUsers=t,this.cacheSubject.next(!0),this.selection.clear(),this.setAuth(),this.loading=!1},error:()=>{this.loading=!1}})}setAuth(){this.addAuth=this.authResolver.isAuthorized("addSpecificUserOwner_User_User_policy",[this.user]),this.removeAuth=this.authResolver.isAuthorized("removeSpecificUserOwner_User_User_policy",[this.user]),this.disableRouting=!this.authResolver.isPerunAdminOrObserver()}onAdd(){let t=P();t.width="1250px",t.data={userId:this.user.id,theme:"user-theme",isService:!0,target:"USER"},this.dialog.open(Je,t).afterClosed().subscribe(o=>{o&&this.refreshTable()})}onRemove(){let t=P();t.width="650px",t.data={identities:this.selection.selected,userId:this.user.id,specificUser:this.selection.selected[0],isService:!0,theme:"user-theme",targetTitle:"USER",targetDescription:"USER"},this.dialog.open(et,t).afterClosed().subscribe(o=>{o&&(this.authResolver.isAuthorized("getUsersBySpecificUser_User_policy",[this.user])?this.refreshTable():this.router.navigate(["/myProfile"],{queryParamsHandling:"preserve"}))})}};i.\u0275fac=function(n){return new(n||i)(m(k),m(fe),m(H),m(B),m(w))},i.\u0275cmp=v({type:i,selectors:[["app-user-settings-associated-users"]],decls:15,vars:12,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],["spinner",""],[1,"position-relative","table-min-height"],[3,"loading","noUsersFoundLabel","disableRouting","routeToAdmin","displayColumns","selection","tableId","users","cacheSubject",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","noUsersFoundLabel","disableRouting","routeToAdmin","displayColumns","selection","tableId","users","cacheSubject"]],template:function(n,o){if(n&1&&(s(0,"div")(1,"h1",0),g(2),u(3,"translate"),l(),s(4,"perun-web-apps-refresh-button",1),b("refresh",function(){return o.refreshTable()}),l(),s(5,"button",2),b("click",function(){return o.onAdd()}),g(6),u(7,"translate"),l(),s(8,"button",3),b("click",function(){return o.onRemove()}),g(9),u(10,"translate"),l(),_(11,Gr,1,0,"ng-template",null,4,N),s(13,"div",5),_(14,kr,2,11,"perun-web-apps-users-list",6),l()()),n&2){let d=A(12);p(2),x(f(3,6,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.TITLE")),p(4),S(" ",f(7,8,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.ADD")," "),p(2),a("disabled",o.loading||o.selection.selected.length===0),p(),S(" ",f(10,10,"USER_DETAIL.SETTINGS.ASSOCIATED_USERS.REMOVE")," "),p(5),a("perunWebAppsLoader",o.loading)("perunWebAppsLoaderIndicator",d)}},dependencies:[$,L,O,Ze,D,y]});let e=i;return e})();var Vn=(()=>{let i=class i{constructor(t){this.entityStorageService=t}ngOnInit(){this.user=this.entityStorageService.getEntity()}};i.\u0275fac=function(n){return new(n||i)(m(w))},i.\u0275cmp=v({type:i,selectors:[["app-perun-web-apps-user-settings-mailing-lists"]],decls:1,vars:2,consts:[[3,"user","isService"]],template:function(n,o){n&1&&h(0,"perun-web-apps-mailing-lists",0),n&2&&a("user",o.user)("isService",!0)},dependencies:[nn]});let e=i;return e})();var jn=(()=>{let i=class i{constructor(t){this.entityStorageService=t}ngOnInit(){this.user=this.entityStorageService.getEntity()}};i.\u0275fac=function(n){return new(n||i)(m(w))},i.\u0275cmp=v({type:i,selectors:[["app-perun-web-apps-user-settings-data-quotas"]],decls:1,vars:1,consts:[[3,"user"]],template:function(n,o){n&1&&h(0,"perun-web-apps-data-quotas",0),n&2&&a("user",o.user)},dependencies:[rn]});let e=i;return e})();var Gn=(()=>{let i=class i{constructor(t){this.entityStorageService=t,this.navItems=[]}ngOnInit(){this.serviceAccount=this.entityStorageService.getEntity(),this.initNavItems()}initNavItems(){this.navItems=[{cssIcon:"perun-logins",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/logins`,label:"MENU_ITEMS.USER.LOGINS",style:"user-btn"},{cssIcon:"perun-certificates",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/certificates`,label:"MENU_ITEMS.USER.CERTIFICATES",style:"user-btn"},{cssIcon:"perun-key",url:`/myProfile/service-identities/${this.serviceAccount.id}/authentication/ssh-keys`,label:"MENU_ITEMS.USER.SSH_KEYS",style:"user-btn"}]}};i.\u0275fac=function(n){return new(n||i)(m(w))},i.\u0275cmp=v({type:i,selectors:[["app-service-identity-authentication-overview"]],decls:1,vars:1,consts:[[3,"items"]],template:function(n,o){n&1&&h(0,"perun-web-apps-menu-buttons-field",0),n&2&&a("items",o.navItems)},dependencies:[le]});let e=i;return e})();var Wr=["logins"],kn=(()=>{let i=class i{constructor(t,n){this.dialog=t,this.entityStorageService=n,this.filteredNamespaces=[]}ngOnInit(){this.userId=this.entityStorageService.getEntity().id}onAdd(){let t=P();t.width="500px",t.data={userId:this.userId,filteredNamespaces:this.filteredNamespaces},this.dialog.open(vn,t).afterClosed().subscribe(o=>{o&&this.logins.refreshTable()})}};i.\u0275fac=function(n){return new(n||i)(m(k),m(w))},i.\u0275cmp=v({type:i,selectors:[["app-perun-web-apps-user-settings-logins"]],viewQuery:function(n,o){if(n&1&&Me(Wr,5),n&2){let d;Re(d=we())&&(o.logins=d.first)}},decls:9,vars:7,consts:[[1,"page-title"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],[3,"authenticationPage","filteredNamespaces"],["logins",""]],template:function(n,o){if(n&1){let d=T();s(0,"h1",0),g(1),u(2,"translate"),l(),s(3,"perun-web-apps-refresh-button",1),b("refresh",function(){I(d);let Z=A(8);return E(Z.refreshTable())}),l(),s(4,"button",2),b("click",function(){return o.onAdd()}),g(5),u(6,"translate"),l(),s(7,"perun-web-apps-password-reset",3,4),b("filteredNamespaces",function(Z){return o.filteredNamespaces=Z}),l()}n&2&&(p(),x(f(2,3,"USER_DETAIL.SETTINGS.LOGINS.TITLE")),p(4),S(" ",f(6,5,"USER_DETAIL.SETTINGS.LOGINS.ADD"),`
`),p(2),a("authenticationPage",!0))},dependencies:[$,O,Qe,y]});let e=i;return e})();var Wn=(()=>{let i=class i{};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=v({type:i,selectors:[["app-service-identity-authentication"]],hostVars:2,hostBindings:function(n,o){n&2&&j("router-component",o.true)},decls:1,vars:0,template:function(n,o){n&1&&h(0,"app-animated-router-outlet")},dependencies:[re]});let e=i;return e})();var zr=["list"];function Hr(e,i){e&1&&h(0,"perun-web-apps-loading-table")}function $r(e,i){if(e&1&&h(0,"perun-web-apps-attributes-list",6,7),e&2){let r=c();a("loading",r.loading)("attributes",r.certificates)("selection",r.selection)("cachedSubject",r.cachedSubject)("emptyListText","USER_DETAIL.SETTINGS.CERTIFICATES.EMPTY")}}var zn=(()=>{let i=class i{constructor(t,n,o){this.entityStorageService=t,this.attributesManagerService=n,this.dialog=o,this.certificates=[],this.selection=new se(!0,[],!0,(d,C)=>d.id===C.id),this.cachedSubject=new K(!0)}ngOnInit(){this.userId=this.entityStorageService.getEntity().id,this.refresh()}refresh(){this.loading=!0,this.attributesManagerService.getUserAttributeByName(this.userId,pe.USER_DEF_CERTIFICATES).subscribe({next:t=>{this.certificates.push(t),this.selection.clear(),this.cachedSubject.next(!0),this.loading=!1},error:()=>{this.loading=!1}})}save(){this.list.updateMapAttributes();let t=P();t.width="450px",t.data={entityId:this.userId,entity:"user",attributes:this.selection.selected},this.dialog.open(Bi,t).afterClosed().subscribe(o=>{o&&this.refresh()})}};i.\u0275fac=function(n){return new(n||i)(m(w),m(Ne),m(k))},i.\u0275cmp=v({type:i,selectors:[["app-service-identity-certificates"]],viewQuery:function(n,o){if(n&1&&Me(zr,5),n&2){let d;Re(d=we())&&(o.list=d.first)}},decls:11,vars:9,consts:[[1,"page-title"],[1,"mt-2",3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","mt-2",3,"disabled","click"],["spinner",""],[1,"position-relative","table-min-height"],[3,"loading","attributes","selection","cachedSubject","emptyListText",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","attributes","selection","cachedSubject","emptyListText"],["list",""]],template:function(n,o){if(n&1&&(s(0,"h1",0),g(1),u(2,"translate"),l(),s(3,"perun-web-apps-refresh-button",1),b("refresh",function(){return o.refresh()}),l(),s(4,"button",2),b("click",function(){return o.save()}),g(5),u(6,"translate"),l(),_(7,Hr,1,0,"ng-template",null,3,N),s(9,"div",4),_(10,$r,2,5,"perun-web-apps-attributes-list",5),l()),n&2){let d=A(8);p(),x(f(2,5,"USER_DETAIL.SETTINGS.CERTIFICATES.TITLE")),p(3),a("disabled",o.loading||o.selection.selected.length===0),p(),S(" ",f(6,7,"USER_DETAIL.SETTINGS.CERTIFICATES.SAVE"),`
`),p(5),a("perunWebAppsLoader",o.loading)("perunWebAppsLoaderIndicator",d)}},dependencies:[$,L,O,Ki,D,y]});let e=i;return e})();function Yr(e,i){e&1&&(g(0),u(1,"translate")),e&2&&S(" ",f(1,1,"USER_DETAIL.BANS.VO")," ")}function qr(e,i){if(e&1){let r=T();s(0,"perun-web-apps-ban-on-entity-list",8),b("updateBan",function(n){I(r);let o=c(2);return E(o.updateVoBan(n))}),l()}if(e&2){let r=c(2);a("loading",r.loading)("bans",r.voBans)("displayedColumns",r.displayedColumns)("filter",r.filter)("updatePolicy","updateBan_BanOnVo_policy")}}function Qr(e,i){if(e&1){let r=T();s(0,"perun-web-apps-debounce-filter",5),b("filter",function(n){I(r);let o=c();return E(o.filter=n)}),l(),s(1,"div",6),_(2,qr,1,5,"perun-web-apps-ban-on-entity-list",7),l()}if(e&2){let r=c(),t=A(14);a("placeholder","USER_DETAIL.BANS.FILTER"),p(2),a("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",t)}}function Zr(e,i){e&1&&(g(0),u(1,"translate")),e&2&&S(" ",f(1,1,"USER_DETAIL.BANS.RESOURCE")," ")}function Kr(e,i){if(e&1){let r=T();s(0,"perun-web-apps-ban-on-entity-list",8),b("updateBan",function(n){I(r);let o=c(2);return E(o.updateResourceBan(n))}),l()}if(e&2){let r=c(2);a("loading",r.loading)("bans",r.resourceBans)("displayedColumns",r.displayedColumns)("filter",r.filter)("updatePolicy","updateBan_BanOnResource_policy")}}function Xr(e,i){if(e&1){let r=T();s(0,"perun-web-apps-debounce-filter",5),b("filter",function(n){I(r);let o=c();return E(o.filter=n)}),l(),s(1,"div",6),_(2,Kr,1,5,"perun-web-apps-ban-on-entity-list",7),l()}if(e&2){let r=c(),t=A(14);a("placeholder","USER_DETAIL.BANS.FILTER"),p(2),a("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",t)}}function Jr(e,i){e&1&&(g(0),u(1,"translate")),e&2&&S(" ",f(1,1,"USER_DETAIL.BANS.FACILITY")," ")}function eo(e,i){if(e&1){let r=T();s(0,"perun-web-apps-ban-on-entity-list",8),b("updateBan",function(n){I(r);let o=c(2);return E(o.updateFacilityBan(n))}),l()}if(e&2){let r=c(2);a("loading",r.loading)("bans",r.facilityBans)("displayedColumns",r.displayedColumns)("filter",r.filter)("updatePolicy","updateBan_BanOnFacility_policy")}}function to(e,i){if(e&1){let r=T();s(0,"perun-web-apps-debounce-filter",5),b("filter",function(n){I(r);let o=c();return E(o.filter=n)}),l(),s(1,"div",6),_(2,eo,1,5,"perun-web-apps-ban-on-entity-list",7),l()}if(e&2){let r=c(),t=A(14);a("placeholder","USER_DETAIL.BANS.FILTER"),p(2),a("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",t)}}function io(e,i){e&1&&h(0,"perun-web-apps-loading-table")}var Et=(()=>{let i=class i{constructor(t,n,o,d,C){this.voService=t,this.resourceService=n,this.facilityService=o,this.entityService=d,this.dialog=C,this.loading=!1,this.voBans=[],this.resourceBans=[],this.facilityBans=[],this.filter="",this.displayedColumns=["banId","targetId","targetName","description","expiration","edit"]}ngOnInit(){this.loading=!0,this.user=this.entityService.getEntity(),this.refreshVoBans()}refreshVoBans(){this.loading=!0,this.voService.getEnrichedVoBansForUser(this.user.id).subscribe({next:t=>{this.voBans=t,this.loading=!1},error:()=>this.loading=!1})}refreshResourceBans(){this.loading=!0,this.resourceService.getEnrichedBansForUser(this.user.id).subscribe({next:t=>{this.resourceBans=t,this.loading=!1},error:()=>this.loading=!1})}refreshFacilityBans(){this.loading=!0,this.facilityService.getEnricheFacilitydBansForUser(this.user.id).subscribe({next:t=>{this.facilityBans=t,this.loading=!1},error:()=>this.loading=!1})}updateVoBan(t){this.dialog.open(fn,this.getConfig(t)).afterClosed().subscribe(o=>{o&&this.refreshVoBans()})}updateResourceBan(t){this.dialog.open(_n,this.getConfig(t)).afterClosed().subscribe(o=>{o&&this.refreshResourceBans()})}updateFacilityBan(t){this.dialog.open(In,this.getConfig(t)).afterClosed().subscribe(o=>{o&&this.refreshFacilityBans()})}getConfig(t){let n=P();return n.width="600px",n.data={ban:t.ban,theme:"user-theme"},n}refresh(t){t.index===0?this.refreshVoBans():t.index===1?this.refreshResourceBans():this.refreshFacilityBans()}};i.\u0275fac=function(n){return new(n||i)(m(wt),m(Ve),m(Ee),m(w),m(k))},i.\u0275cmp=v({type:i,selectors:[["app-user-bans"]],decls:15,vars:3,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false",1,"mt-3",3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["spinner",""],[1,"mt-2","search-field",3,"placeholder","filter"],[1,"position-relative","table-min-height"],[3,"loading","bans","displayedColumns","filter","updatePolicy","updateBan",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","bans","displayedColumns","filter","updatePolicy","updateBan"]],template:function(n,o){n&1&&(s(0,"h1",0),g(1),u(2,"translate"),l(),s(3,"mat-tab-group",1),b("selectedTabChange",function(C){return o.refresh(C)}),s(4,"mat-tab"),_(5,Yr,2,3,"ng-template",2)(6,Qr,3,3,"ng-template",3),l(),s(7,"mat-tab"),_(8,Zr,2,3,"ng-template",2)(9,Xr,3,3,"ng-template",3),l(),s(10,"mat-tab"),_(11,Jr,2,3,"ng-template",2)(12,to,3,3,"ng-template",3),l()(),_(13,io,1,0,"ng-template",null,4,N)),n&2&&(p(),S(" ",f(2,1,"USER_DETAIL.BANS.TITLE"),`
`))},dependencies:[ee,te,ie,ne,L,Y,pn,D,y]});let e=i;return e})();var no=[{path:"",component:Bn,children:[{path:"",component:wn,data:{animation:"UserOverviewPage"}},{path:"attributes",component:St,data:{animation:"UserAttributesPage"}},{path:"organizations",component:_t,data:{animation:"UserOrganizationsPage",showPrincipal:!0}},{path:"groups",component:gt,data:{animation:"UserGroupsPage",showPrincipal:!0}},{path:"roles",component:vt,data:{animation:"UserRolesPage"}},{path:"service-identities",component:It,data:{animation:"UserServiceIdentities"}},{path:"bans",component:Et,data:{animation:"UserBansPage"}},{path:"settings",component:yn,children:[{path:"",component:xn,data:{animation:"UserSettingsOverviewPage"}},{path:"passwordReset",component:Qe,data:{animation:"PasswordResetPage"}},{path:"guiConfig",component:Un,data:{animation:"UserAppConfigurationPage"}}]}]},{path:"service-identities/:userId",component:Pn,canActivate:[ft],canActivateChild:[ft],children:[{path:"",component:On},{path:"attributes",component:St,data:{animation:"UserAttributesPage"}},{path:"organizations",component:_t,data:{animation:"UserOrganizationsPage"}},{path:"groups",component:gt,data:{animation:"UserGroupsPage"}},{path:"roles",component:vt,data:{animation:"UserRolesPage"}},{path:"service-identities",component:It,data:{animation:"UserServiceIdentities"}},{path:"bans",component:Et,data:{animation:"UserBansPage"}},{path:"associated-users",component:Fn},{path:"authentication",component:Wn,children:[{path:"",component:Gn},{path:"logins",component:kn},{path:"certificates",component:zn},{path:"ssh-keys",component:on}]},{path:"mailing-lists",component:Vn},{path:"data-quotas",component:jn}]}],Hn=(()=>{let i=class i{};i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=Ue({type:i}),i.\u0275inj=Ae({imports:[pt.forChild(no),pt]});let e=i;return e})();function ro(e,i){if(e&1){let r=T();s(0,"button",8),b("click",function(){I(r);let n=c();return E(n.addIdentity())}),g(1),u(2,"translate"),l()}e&2&&(p(),S(" ",f(2,1,"USER_DETAIL.IDENTITIES.ADD"),`
`))}function oo(e,i){if(e&1){let r=T();s(0,"button",9),b("click",function(){I(r);let n=c();return E(n.removeIdentity())}),g(1),u(2,"translate"),l()}if(e&2){let r=c();a("disabled",r.loading||r.selection.selected.length===0),p(),S(" ",f(2,2,"USER_DETAIL.IDENTITIES.REMOVE"),`
`)}}function so(e,i){e&1&&h(0,"perun-web-apps-loading-table")}function ao(e,i){if(e&1&&h(0,"perun-web-apps-user-ext-sources-list",10),e&2){let r=c();a("loading",r.loading)("displayedColumns",r.displayedColumns)("filterValue",r.filterValue)("selection",r.selection)("cachedSubject",r.cachedSubject)("tableId",r.tableId)("userExtSources",r.userExtSources)}}var xl=(()=>{let i=class i{constructor(t,n,o,d,C,Z){this.usersManagerService=t,this.storage=n,this.registrarManagerService=o,this.dialog=d,this.route=C,this.authResolver=Z,this.userExtSources=[],this.selection=new se(!1,[],!0,(me,nt)=>me.userExtSource.id===nt.userExtSource.id),this.displayedColumns=["select","id","extSourceName","login","lastAccess"],this.tableId=qi,this.filterValue="",this.cachedSubject=new K(!0)}ngOnInit(){this.route.parent.params.subscribe(t=>{this.userId=Number(t.userId)}),this.refreshTable()}refreshTable(){this.loading=!0,this.selection.clear(),this.cachedSubject.next(!0),this.usersManagerService.getRichUserExtSources(this.userId).subscribe({next:t=>{this.userExtSources=t,this.loading=!1},error:()=>{this.loading=!1}})}addIdentity(){let t=P();t.width="1000px",t.data={userId:this.userId},this.dialog.open(bn,t).afterClosed().subscribe(o=>{o&&this.refreshTable()})}removeIdentity(){let t=P();t.width="450px",t.data={showSuccess:!0,theme:"user-theme",userId:this.userId,extSources:this.selection.selected},this.dialog.open(Li,t).afterClosed().subscribe(o=>{o&&this.refreshTable()})}applyFilter(t){this.filterValue=t,this.refreshTable()}};i.\u0275fac=function(n){return new(n||i)(m(B),m(G),m(Fe),m(k),m(R),m(H))},i.\u0275cmp=v({type:i,selectors:[["app-user-identities"]],decls:11,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["class","me-2 action-button","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","me-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative","table-min-height"],[3,"loading","displayedColumns","filterValue","selection","cachedSubject","tableId","userExtSources",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"loading","displayedColumns","filterValue","selection","cachedSubject","tableId","userExtSources"]],template:function(n,o){if(n&1&&(s(0,"h1",0),g(1),u(2,"translate"),l(),s(3,"perun-web-apps-refresh-button",1),b("refresh",function(){return o.refreshTable()}),l(),_(4,ro,3,3,"button",2)(5,oo,3,4,"button",3),s(6,"perun-web-apps-debounce-filter",4),b("filter",function(C){return o.applyFilter(C)}),l(),_(7,so,1,0,"ng-template",null,5,N),s(9,"div",6),_(10,ao,1,7,"perun-web-apps-user-ext-sources-list",7),l()),n&2){let d=A(8);p(),x(f(2,6,"USER_DETAIL.IDENTITIES.TITLE")),p(3),a("ngIf",o.authResolver.isPerunAdmin()),p(),a("ngIf",o.authResolver.isPerunAdmin()),p(),a("placeholder","USER_DETAIL.IDENTITIES.FILTER_PLACEHOLDER"),p(4),a("perunWebAppsLoader",o.loading)("perunWebAppsLoaderIndicator",d)}},dependencies:[M,$,L,O,Xi,Y,D,y]});let e=i;return e})();function mo(e,i){e&1&&h(0,"perun-web-apps-loading-table")}function co(e,i){if(e&1){let r=T();s(0,"perun-web-apps-vo-search-select",7),b("voSelected",function(n){I(r);let o=c(2);return E(o.loadMember(n))}),l()}if(e&2){let r=c(2);a("vos",r.vos)}}function uo(e,i){e&1&&(g(0),u(1,"translate")),e&2&&S(" ",f(1,1,"USER_DETAIL.ACCOUNTS.STATUS")," ")}function fo(e,i){e&1&&h(0,"mat-spinner",13)}var $n=(e,i)=>["/organizations",e,"members",i],_o=()=>["id","recent","name","description","expiration","groupStatus"];function go(e,i){if(e&1){let r=T();s(0,"div")(1,"div",14)(2,"span",15),g(3),u(4,"translate"),l(),s(5,"a",16),b("auxclick",function(n){return n.preventDefault()}),g(6),l()(),s(7,"mat-card",17),h(8,"perun-web-apps-member-overview-membership",18),l(),s(9,"p",19),g(10),u(11,"translate"),l(),s(12,"perun-web-apps-groups-list",20),b("refreshTable",function(){I(r);let n=c(4);return E(n.loadMember(n.selectedVo))}),l()()}if(e&2){let r=c(4);p(3),S("",f(4,12,"USER_DETAIL.ACCOUNTS.MEMBER"),":"),p(2),a("perunWebAppsMiddleClickRouterLink",at(16,$n,r.selectedVo.id.toString(),r.member.id.toString()))("routerLink",at(19,$n,r.selectedVo.id,r.member.id)),p(),S("",r.member.id," "),p(2),a("member",r.member)("voId",r.selectedVo.id),p(2),x(f(11,14,"USER_DETAIL.ACCOUNTS.GROUPS")),p(2),a("loading",r.loading)("groups",r.groups)("memberId",r.member==null?null:r.member.id)("memberGroupStatus",r.member.groupStatus)("displayedColumns",z(22,_o))}}function ho(e,i){if(e&1&&_(0,fo,1,0,"mat-spinner",11)(1,go,13,23,"div",12),e&2){let r=c(3);a("ngIf",r.loading),p(),a("ngIf",!r.loading)}}function bo(e,i){e&1&&(g(0),u(1,"translate")),e&2&&S(" ",f(1,1,"USER_DETAIL.ACCOUNTS.MEMBER_ATT")," ")}function So(e,i){e&1&&h(0,"mat-spinner",13)}function vo(e,i){if(e&1&&h(0,"app-one-entity-attribute-page",22),e&2){let r=c(5);a("entity","member")("entityId",r.member.id)}}function Io(e,i){if(e&1&&_(0,So,1,0,"mat-spinner",11)(1,vo,1,2,"app-one-entity-attribute-page",21),e&2){let r=c(4);a("ngIf",r.loading),p(),a("ngIf",!r.loading)}}function Eo(e,i){e&1&&(s(0,"mat-tab"),_(1,bo,2,3,"ng-template",9)(2,Io,2,2,"ng-template",10),l())}function Co(e,i){e&1&&(g(0),u(1,"translate")),e&2&&S(" ",f(1,1,"USER_DETAIL.ACCOUNTS.MEMBER_GROUP_ATT")," ")}function To(e,i){e&1&&h(0,"mat-spinner",13)}function yo(e,i){if(e&1&&h(0,"app-two-entity-attribute-page",24),e&2){let r=c(5);a("firstEntity","member")("firstEntityId",r.member.id)("secondEntity","group")}}function xo(e,i){if(e&1&&_(0,To,1,0,"mat-spinner",11)(1,yo,1,3,"app-two-entity-attribute-page",23),e&2){let r=c(4);a("ngIf",r.loading),p(),a("ngIf",!r.loading)}}function Ao(e,i){e&1&&(s(0,"mat-tab"),_(1,Co,2,3,"ng-template",9)(2,xo,2,2,"ng-template",10),l())}function Uo(e,i){e&1&&(g(0),u(1,"translate")),e&2&&S(" ",f(1,1,"USER_DETAIL.ACCOUNTS.MEMBER_RESOURCE_ATT")," ")}function Mo(e,i){e&1&&h(0,"mat-spinner",13)}function Ro(e,i){if(e&1&&h(0,"app-two-entity-attribute-page",24),e&2){let r=c(4);a("firstEntity","member")("firstEntityId",r.member.id)("secondEntity","resource")}}function wo(e,i){if(e&1&&_(0,Mo,1,0,"mat-spinner",11)(1,Ro,1,3,"app-two-entity-attribute-page",23),e&2){let r=c(3);a("ngIf",r.loading),p(),a("ngIf",!r.loading)}}function Do(e,i){if(e&1&&(s(0,"mat-tab-group",8)(1,"mat-tab"),_(2,uo,2,3,"ng-template",9)(3,ho,2,2,"ng-template",10),l(),_(4,Eo,3,0,"mat-tab",2)(5,Ao,3,0,"mat-tab",2),s(6,"mat-tab"),_(7,Uo,2,3,"ng-template",9)(8,wo,2,2,"ng-template",10),l()()),e&2){let r=c(2),t=A(4);p(4),a("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",t),p(),a("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",t)}}function Lo(e,i){e&1&&(s(0,"perun-web-apps-alert",25),g(1),u(2,"translate"),l()),e&2&&(p(),x(f(2,1,"USER_DETAIL.ACCOUNTS.NO_VOS")))}function Bo(e,i){if(e&1&&(s(0,"div")(1,"div",3),_(2,co,1,1,"perun-web-apps-vo-search-select",4),l(),_(3,Do,9,4,"mat-tab-group",5)(4,Lo,3,3,"perun-web-apps-alert",6),l()),e&2){let r=c();p(2),a("ngIf",!(r.initLoading||r.vos.length===0)),p(),a("ngIf",!(r.initLoading||r.vos.length===0)),p(),a("ngIf",!r.initLoading&&r.vos.length===0)}}var ql=(()=>{let i=class i{constructor(t,n,o,d){this.route=t,this.usersService=n,this.membersService=o,this.groupService=d,this.initLoading=!1,this.loading=!1,this.vos=[],this.selectedVo=null,this.member=null,this.groups=[]}ngOnInit(){this.initLoading=!0,this.route.parent.params.subscribe(t=>{this.userId=Number(t.userId),this.usersService.getVosWhereUserIsMember(this.userId).subscribe({next:n=>{this.vos=n,this.vos.length&&this.loadMember(this.vos.sort(We)[0]),this.initLoading=!1},error:()=>this.initLoading=!1})})}loadMember(t){this.loading=!0,this.selectedVo=t,this.membersService.getMemberByUser(this.selectedVo.id,this.userId).subscribe({next:n=>{this.membersService.getRichMemberWithAttributes(n.id).subscribe({next:o=>{this.member=o,this.groupService.getMemberRichGroupsWithAttributesByNames(this.member.id,[pe.MEMBER_DEF_GROUP_EXPIRATION,pe.MEMBER_GROUP_STATUS]).subscribe({next:d=>{this.groups=d,this.loading=!1},error:()=>this.loading=!1})},error:()=>this.loading=!1})},error:()=>this.loading=!1})}};i.\u0275fac=function(n){return new(n||i)(m(R),m(B),m(Oe),m(Pe))},i.\u0275cmp=v({type:i,selectors:[["app-perun-web-apps-user-accounts"]],decls:6,vars:5,consts:[[1,"page-title"],["spinner1",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[1,"d-flex"],["class","w-50",3,"vos","voSelected",4,"ngIf"],["mat-stretch-tabs","false",4,"ngIf"],["alert_type","warn",4,"ngIf"],[1,"w-50",3,"vos","voSelected"],["mat-stretch-tabs","false"],["matTabLabel",""],["matTabContent",""],["class","ms-auto me-auto",4,"ngIf"],[4,"ngIf"],[1,"ms-auto","me-auto"],[1,"mt-4","mb-4"],[1,"subtitle","me-2"],[1,"member-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],["appearance","outlined",1,"mat-elevation-z3","membership-card"],[3,"member","voId"],[1,"mt-4","subtitle"],[3,"loading","groups","memberId","memberGroupStatus","displayedColumns","refreshTable"],[3,"entity","entityId",4,"ngIf"],[3,"entity","entityId"],[3,"firstEntity","firstEntityId","secondEntity",4,"ngIf"],[3,"firstEntity","firstEntityId","secondEntity"],["alert_type","warn"]],template:function(n,o){if(n&1&&(s(0,"h1",0),g(1),u(2,"translate"),l(),_(3,mo,1,0,"ng-template",null,1,N)(5,Bo,5,3,"div",2)),n&2){let d=A(4);p(),x(f(2,3,"USER_DETAIL.ACCOUNTS.TITLE")),p(4),a("perunWebAppsLoader",o.initLoading)("perunWebAppsLoaderIndicator",d)}},dependencies:[M,_e,ee,te,ie,ne,ae,ke,ze,L,Ye,Ji,be,Se,tn,D,ve,Xe,y],styles:[".subtitle[_ngcontent-%COMP%]{font-size:1.2rem}.membership-card[_ngcontent-%COMP%]{max-width:400px}"]});let e=i;return e})();function No(e,i){e&1&&h(0,"perun-web-apps-loading-table")}function Po(e,i){if(e&1){let r=T();s(0,"perun-web-apps-facility-search-select",7),b("facilitySelected",function(n){I(r);let o=c(2);return E(o.loadFacility(n))}),l()}if(e&2){let r=c(2);a("facilities",r.facilities)}}function Oo(e,i){e&1&&(g(0),u(1,"translate")),e&2&&S(" ",f(1,1,"USER_DETAIL.ASSIGNMENTS.OVERVIEW")," ")}var Fo=()=>["id","name","vo","description"];function Vo(e,i){if(e&1&&h(0,"perun-web-apps-resources-list",14),e&2){let r=c(4);a("loading",r.loading)("resources",r.resources)("displayedColumns",z(3,Fo))}}function jo(e,i){if(e&1&&(s(0,"p",11),g(1),u(2,"translate"),l(),s(3,"div",12),_(4,Vo,1,4,"perun-web-apps-resources-list",13),l()),e&2){let r=c(3),t=A(4);p(),x(f(2,3,"USER_DETAIL.ASSIGNMENTS.RESOURCES")),p(3),a("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",t)}}function Go(e,i){e&1&&(g(0),u(1,"translate")),e&2&&S(" ",f(1,1,"USER_DETAIL.ASSIGNMENTS.USER_FACILITY_ATT")," ")}function ko(e,i){e&1&&h(0,"mat-spinner",17)}function Wo(e,i){if(e&1&&h(0,"app-two-entity-attribute-page",18),e&2){let r=c(4);a("firstEntity","user")("firstEntityId",r.userId)("secondEntity","facility")("specificSecondEntity",r.selectedFacility)}}function zo(e,i){if(e&1&&_(0,ko,1,0,"mat-spinner",15)(1,Wo,1,4,"app-two-entity-attribute-page",16),e&2){let r=c(3);a("ngIf",r.loading),p(),a("ngIf",!r.loading)}}function Ho(e,i){e&1&&(g(0),u(1,"translate")),e&2&&S(" ",f(1,1,"USER_DETAIL.ASSIGNMENTS.MEMBER_RESOURCE_ATT")," ")}function $o(e,i){e&1&&h(0,"mat-spinner",17)}function Yo(e,i){if(e&1&&h(0,"app-two-entity-attribute-page",20),e&2){let r=c(4);a("firstEntity","user")("firstEntityId",r.userId)("secondEntity","resource")("facilityId",r.selectedFacility.id)}}function qo(e,i){if(e&1&&_(0,$o,1,0,"mat-spinner",15)(1,Yo,1,4,"app-two-entity-attribute-page",19),e&2){let r=c(3);a("ngIf",r.loading),p(),a("ngIf",!r.loading)}}function Qo(e,i){e&1&&(s(0,"mat-tab-group",8)(1,"mat-tab"),_(2,Oo,2,3,"ng-template",9)(3,jo,5,5,"ng-template",10),l(),s(4,"mat-tab"),_(5,Go,2,3,"ng-template",9)(6,zo,2,2,"ng-template",10),l(),s(7,"mat-tab"),_(8,Ho,2,3,"ng-template",9)(9,qo,2,2,"ng-template",10),l()())}function Zo(e,i){e&1&&(s(0,"perun-web-apps-alert",21),g(1),u(2,"translate"),l()),e&2&&(p(),x(f(2,1,"USER_DETAIL.ASSIGNMENTS.NO_FACILITIES")))}function Ko(e,i){if(e&1&&(s(0,"div")(1,"div",3),_(2,Po,1,1,"perun-web-apps-facility-search-select",4),l(),_(3,Qo,10,0,"mat-tab-group",5)(4,Zo,3,3,"perun-web-apps-alert",6),l()),e&2){let r=c();p(2),a("ngIf",!(r.initLoading||r.facilities.length===0)),p(),a("ngIf",!(r.initLoading||r.facilities.length===0)),p(),a("ngIf",!r.initLoading&&r.facilities.length===0)}}var im=(()=>{let i=class i{constructor(t,n,o,d){this.route=t,this.facilityService=n,this.usersService=o,this.resourcesService=d,this.initLoading=!0,this.loading=!1,this.facilities=[],this.selectedFacility=null,this.member=null,this.resources=[]}ngOnInit(){this.initLoading=!0,this.route.parent.params.subscribe(t=>{this.userId=Number(t.userId),this.facilityService.getAssignedFacilitiesByUser(this.userId).subscribe({next:n=>{this.facilities=n,this.facilities.length&&this.loadFacility(this.facilities.sort(We)[0]),this.initLoading=!1},error:()=>this.initLoading=!1})})}loadFacility(t){this.loading=!0,this.selectedFacility=t,this.usersService.getAssociatedResourcesForUser(this.selectedFacility.id,this.userId).subscribe({next:n=>{this.resourcesService.getRichResourcesByIds(n.map(o=>o.id)).subscribe({next:o=>{this.resources=o,this.loading=!1},error:()=>this.loading=!1})},error:()=>this.loading=!1})}};i.\u0275fac=function(n){return new(n||i)(m(R),m(Ee),m(B),m(Ve))},i.\u0275cmp=v({type:i,selectors:[["app-perun-web-apps-user-assignments"]],decls:6,vars:5,consts:[[1,"page-title"],["spinner1",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[1,"d-flex"],["class","w-50",3,"facilities","facilitySelected",4,"ngIf"],["mat-stretch-tabs","false",4,"ngIf"],["alert_type","warn",4,"ngIf"],[1,"w-50",3,"facilities","facilitySelected"],["mat-stretch-tabs","false"],["matTabLabel",""],["matTabContent",""],[1,"mt-4","subtitle"],[1,"position-relative","table-min-height"],[3,"loading","resources","displayedColumns",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","resources","displayedColumns"],["class","ms-auto me-auto",4,"ngIf"],[3,"firstEntity","firstEntityId","secondEntity","specificSecondEntity",4,"ngIf"],[1,"ms-auto","me-auto"],[3,"firstEntity","firstEntityId","secondEntity","specificSecondEntity"],[3,"firstEntity","firstEntityId","secondEntity","facilityId",4,"ngIf"],[3,"firstEntity","firstEntityId","secondEntity","facilityId"],["alert_type","warn"]],template:function(n,o){if(n&1&&(s(0,"h1",0),g(1),u(2,"translate"),l(),_(3,No,1,0,"ng-template",null,1,N)(5,Ko,5,3,"div",2)),n&2){let d=A(4);p(),x(f(2,3,"USER_DETAIL.ASSIGNMENTS.TITLE")),p(4),a("perunWebAppsLoader",o.initLoading)("perunWebAppsLoaderIndicator",d)}},dependencies:[M,ee,te,ie,ne,ae,ze,L,ut,en,D,ve,y],styles:[".subtitle[_ngcontent-%COMP%]{font-size:1.2rem}"]});let e=i;return e})();function Xo(e,i){if(e&1){let r=T();s(0,"button",8),b("click",function(){I(r);let n=c();return E(n.showDetails())}),g(1),u(2,"translate"),l()}e&2&&(p(),S(" ",f(2,1,"MEMBER_DETAIL.APPLICATIONS.SHOW_ALL_DETAILS")," "))}function Jo(e,i){if(e&1){let r=T();s(0,"button",8),b("click",function(){I(r);let n=c();return E(n.showDetails())}),g(1),u(2,"translate"),l()}e&2&&(p(),S(" ",f(2,1,"MEMBER_DETAIL.APPLICATIONS.SHOW_LESS_DETAILS")," "))}function es(e,i){e&1&&h(0,"perun-web-apps-loading-table")}function ts(e,i){if(e&1){let r=T();s(0,"perun-web-apps-applications-list",9),b("queryChanged",function(n){I(r);let o=c();return E(o.nextPage.next(n))})("downloadAll",function(n){I(r);let o=c();return E(o.downloadAll(n))}),u(1,"async"),u(2,"async"),l()}if(e&2){let r=c();a("loading",f(1,6,r.loading$))("tableId",r.showAllDetails?r.detailTableId:r.tableId)("user",r.user)("displayedColumns",r.showAllDetails?r.detailedDisplayedColumns:r.displayedColumns)("applications",f(2,8,r.applicationsPage$))("filter",r.filterValue)}}var _m=(()=>{let i=class i{constructor(t,n,o){this.entityStorageService=t,this.registrarService=n,this.translate=o,this.displayedColumns=["id","voName","groupName","createdAt","type","state","modifiedBy"],this.detailedDisplayedColumns=["id","createdAt","voId","voName","groupId","groupName","type","state","extSourceName","extSourceType","createdBy","modifiedBy","modifiedAt","fedInfo"],this.filterValue="",this.showAllDetails=!1,this.detailTableId=zi,this.tableId=Hi,this.dateFrom=new Date("1970-01-01"),this.currentStates=["NEW","VERIFIED"],this.applications=[],this.nextPage=new K({}),this.applicationsPage$=this.nextPage.pipe(ye(d=>this.registrarService.getApplicationsPage({query:{pageSize:d.pageSize,offset:d.offset,order:d.order,sortColumn:ct(d.sortColumn),searchString:d.searchString,getDetails:this.showAllDetails,dateFrom:Ce(this.dateFrom),dateTo:Ce(new Date),userId:this.user.id,states:this.currentStates}})),xe(d=>{this.applications=d.data,setTimeout(()=>this.loadingSubject$.next(!1),200)}),yt({data:[],totalCount:0,offset:0,pageSize:0})),this.loadingSubject$=new K(!1),this.loading$=Ct(this.loadingSubject$,this.nextPage.pipe(Te(()=>!0)))}ngOnInit(){this.user=this.entityStorageService.getEntity()}applyFilter(t){this.filterValue=t,this.refreshTable()}showDetails(){this.showAllDetails=!this.showAllDetails}refreshTable(){this.nextPage.next(this.nextPage.value)}statesChanged(t){this.currentStates=t,this.refreshTable()}downloadAll(t){let n=this.nextPage.getValue();this.registrarService.getApplicationsPage({query:{order:n.order,pageSize:t.length,offset:0,searchString:n.searchString,sortColumn:ct(n.sortColumn),getDetails:this.showAllDetails,dateFrom:Ce(this.dateFrom),dateTo:Ce(new Date),userId:this.user.id,states:this.currentStates}}).subscribe({next:o=>{Ri(Ui(o.data,this.showAllDetails?this.detailedDisplayedColumns:this.displayedColumns,Mi),this.translate,t.format)}})}};i.\u0275fac=function(n){return new(n||i)(m(w),m(Fe),m(Bt))},i.\u0275cmp=v({type:i,selectors:[["app-user-applications"]],decls:14,vars:10,consts:[[1,"page-subtitle"],[3,"refresh"],["class","me-2","mat-stroked-button","",3,"click",4,"ngIf"],[3,"placeholder","filter"],[3,"stateChanged"],["spinner",""],[1,"position-relative","table-min-height"],[3,"loading","tableId","user","displayedColumns","applications","filter","queryChanged","downloadAll",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-stroked-button","",1,"me-2",3,"click"],[3,"loading","tableId","user","displayedColumns","applications","filter","queryChanged","downloadAll"]],template:function(n,o){if(n&1&&(s(0,"h1",0),g(1),u(2,"translate"),l(),s(3,"div")(4,"perun-web-apps-refresh-button",1),b("refresh",function(){return o.refreshTable()}),l(),_(5,Xo,3,3,"button",2)(6,Jo,3,3,"button",2),s(7,"perun-web-apps-debounce-filter",3),b("filter",function(C){return o.applyFilter(C)}),l(),s(8,"perun-web-apps-application-state-selector",4),b("stateChanged",function(C){return o.statesChanged(C)}),l()(),_(9,es,1,0,"ng-template",null,5,N),s(11,"div",6),_(12,ts,3,10,"perun-web-apps-applications-list",7),u(13,"async"),l()),n&2){let d=A(10);p(),x(f(2,6,"MEMBER_DETAIL.APPLICATIONS.TITLE")),p(4),a("ngIf",!o.showAllDetails),p(),a("ngIf",o.showAllDetails),p(),a("placeholder","MEMBER_DETAIL.APPLICATIONS.FILTER"),p(5),a("perunWebAppsLoader",f(13,8,o.loading$))("perunWebAppsLoaderIndicator",d)}},dependencies:[M,$,L,O,Y,ln,D,mn,Ut,y]});let e=i;return e})();var cd=(()=>{let i=class i{constructor(t){this.translate=t,t.addLangs(["en","cs"])}};i.\u0275fac=function(n){return new(n||i)(xt(Dt))},i.\u0275mod=Ue({type:i}),i.\u0275inj=Ae({imports:[Mt,Hn,an,ei,Xt,$t,Ht,Jt,fi,Qt,Lt.forChild({}),lt,gi,ci,Ii,Oi,lt,Yt,Vt,bi,hn,ti,gn,Si,Ci,ui,Pt,yi,qt,Ot,vi,mt,ii,Zi,mt,Ti,_i,Nt,wi,Pi,sn,cn,Fi,Ni,Cn]});let e=i;return e})();export{wn as a,St as b,vt as c,It as d,xl as e,Fn as f,ql as g,Et as h,im as i,_m as j,cd as k};
