import{$b as P,$c as ee,A as x,Ca as S,Cc as L,Da as W,Dc as w,Fi as se,Gi as pe,H as B,Kd as I,La as k,Lb as j,Na as s,Oa as u,Pa as N,Pf as ne,Qb as z,Qd as T,Rb as h,Sb as R,Sc as X,Tb as A,Tc as Y,Wa as U,Wc as J,We as ae,Xc as K,Xe as re,Yc as Q,Ye as oe,Zc as Z,aa as r,ac as b,cb as p,db as l,ea as f,ec as $,fa as M,jc as F,k as y,la as v,qa as g,ra as C,sa as V,ta as q,tb as G,td as te,ua as H,ud as ie,va as m,vf as E,wa as o,xa as n,ya as O,z as D}from"./chunk-353QRQI4.js";function fe(a,c){if(a&1&&(o(0,"mat-option",2),s(1),n()),a&2){let t=c.$implicit;m("value",t),r(),N(" ",t," ")}}function ge(a,c){a&1&&(o(0,"mat-error"),s(1),p(2,"translate"),n()),a&2&&(r(),u(l(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.FIELD_EMPTY")))}function Ce(a,c){a&1&&(o(0,"mat-error"),s(1),p(2,"translate"),n()),a&2&&(r(),u(l(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_EXISTS")))}function he(a,c){a&1&&(o(0,"mat-error"),s(1),p(2,"translate"),n()),a&2&&(r(),u(l(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_FORMAT")))}function Ne(a,c){a&1&&(o(0,"mat-error"),s(1),p(2,"translate"),n()),a&2&&(r(),u(l(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_LONG")))}function Ee(a,c){a&1&&(o(0,"mat-error"),s(1),p(2,"translate"),n()),a&2&&(r(),u(l(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_SHORT")))}function _e(a,c){if(a&1&&(o(0,"span",5),s(1),p(2,"translate"),n()),a&2){let t=W();r(),N(" ",l(2,1,t.formGroup.get("namespaceCtrl").value==="Not selected"?"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_DISABLED":"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_DISABLED_FOR_NAMESPACE")," ")}}var le=(()=>{class a{constructor(t,i){this.membersManagerService=t,this.usersManagerService=i,this.filteredNamespaces=null,this.namespaceChanged=new v,this.parsedRulesChanged=new v,this.namespaceOptions=[],this.selectedNamespace=null,this.namespaceRules=[],this.parsedRules=new Map}ngOnInit(){this.namespaceOptions=["Not selected"],this.membersManagerService.getAllNamespacesRules().subscribe(t=>{this.namespaceRules=t,this.parseNamespaceRules()}),this.onNamespaceChanged("Not selected")}existingLoginValidator(){return t=>{let i=this.formGroup.get("namespaceCtrl").value.toLowerCase();return i=i==="not selected"?"mu":i,t.valueChanges.pipe(D(500),x(1),B(()=>this.usersManagerService.isLoginAvailable(i,t.value).pipe(y(e=>e?null:{loginExists:!0}))))}}parseNamespaceRules(){for(let t of this.namespaceRules)if(!this.filteredNamespaces?.includes(t.namespaceName)){this.namespaceOptions.push(t.namespaceName);let i={login:"disabled"};this.parseAttributes(i,t.requiredAttributes,"required"),this.parseAttributes(i,t.optionalAttributes,"optional"),this.parsedRules.set(t.namespaceName,i)}this.parsedRulesChanged.emit(this.parsedRules)}parseAttributes(t,i,e){for(let d of i)switch(d){case"login":{t.login=e;break}default:break}}onNamespaceChanged(t){this.selectedNamespace=t.toLowerCase();let i=this.formGroup.get("loginCtrl");if(t!=="Not selected")if(this.parsedRules.get(this.selectedNamespace).login==="disabled")i.disable(),i.setValue("");else{let e=[h.required,h.pattern("^[a-z][a-z0-9_-]+$"),h.maxLength(15),h.minLength(2)];E(i,e,[this.existingLoginValidator()])}else i.disable(),i.setValue("");this.namespaceChanged.emit(t)}static{this.\u0275fac=function(i){return new(i||a)(f(I),f(T))}}static{this.\u0275cmp=M({type:a,selectors:[["app-login-for-namespace"]],inputs:{formGroup:"formGroup",filteredNamespaces:"filteredNamespaces"},outputs:{namespaceChanged:"namespaceChanged",parsedRulesChanged:"parsedRulesChanged"},decls:19,vars:15,consts:[[1,"display-flex",3,"formGroup"],["formControlName","namespaceCtrl",3,"valueChange"],[3,"value"],[3,"floatLabel"],["formControlName","loginCtrl","matInput","","required","",3,"hidden"],[1,"input-disabled"]],template:function(i,e){i&1&&(o(0,"div",0)(1,"mat-form-field")(2,"mat-label"),s(3),p(4,"translate"),n(),o(5,"mat-select",1),S("valueChange",function(_){return e.onNamespaceChanged(_)}),q(6,fe,2,2,"mat-option",2,V),n()(),o(8,"mat-form-field",3)(9,"mat-label"),s(10),p(11,"translate"),n(),O(12,"input",4),g(13,ge,3,3,"mat-error"),g(14,Ce,3,3,"mat-error"),g(15,he,3,3,"mat-error"),g(16,Ne,3,3,"mat-error"),g(17,Ee,3,3,"mat-error"),g(18,_e,3,3,"span",5),n()()),i&2&&(m("formGroup",e.formGroup),r(3),u(l(4,11,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.NAMESPACE")),r(3),H(e.namespaceOptions),r(2),m("floatLabel",e.formGroup.get("loginCtrl").disabled?"always":null),r(2),u(l(11,13,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN")),r(2),m("hidden",e.formGroup.get("loginCtrl").disabled),r(),C(e.formGroup.get("loginCtrl").hasError("required")?13:-1),r(),C(e.formGroup.get("loginCtrl").hasError("loginExists")?14:-1),r(),C(e.formGroup.get("loginCtrl").hasError("pattern")&&!e.formGroup.get("loginCtrl").hasError("minlength")?15:-1),r(),C(e.formGroup.get("loginCtrl").hasError("maxlength")?16:-1),r(),C(e.formGroup.get("loginCtrl").hasError("minlength")?17:-1),r(),C(e.formGroup.get("loginCtrl").disabled?18:-1))},dependencies:[G,Q,J,X,Y,ie,te,ee,Z,K,F,z,R,A,$,P,b,w,L],styles:[".display-flex[_ngcontent-%COMP%]{display:flex;flex-direction:column}.input-disabled[_ngcontent-%COMP%]{pointer-events:none;color:#888}"]})}}return a})();var st=(()=>{class a{constructor(t,i,e){this.membersManagerService=t,this.usersManagerService=i,this.apiRequestConfiguration=e,this.filteredNamespace=null,this.parsedRulesOutput=new v,this.selectedNamespace=null,this.parsedRules=new Map}parsedRulesFunction(t){this.parsedRules=t,this.parsedRulesOutput.emit(t)}onNamespaceChanged(t){this.selectedNamespace=t.toLowerCase();let i=this.formGroup.get("passwordCtrl"),e=this.formGroup.get("passwordAgainCtrl"),d=this.formGroup.get("generatePasswordCtrl");t!=="Not selected"?(E(d,[]),this.passwordOptionChanged()):(i.disable(),i.setValue(""),e.disable(),e.setValue(""),d.disable(),d.dirty||d.setValue(!0))}passwordOptionChanged(){let t=this.formGroup.get("passwordCtrl"),i=this.formGroup.get("passwordAgainCtrl");this.formGroup.get("generatePasswordCtrl").value?(t.disable(),t.setValue(""),i.disable(),i.setValue("")):(E(t,[h.required],[se(this.selectedNamespace,this.usersManagerService,this.apiRequestConfiguration)]),E(i,[]))}static{this.\u0275fac=function(i){return new(i||a)(f(I),f(T),f(ne))}}static{this.\u0275cmp=M({type:a,selectors:[["app-login-password-form-with-generate-option"]],inputs:{formGroup:"formGroup",filteredNamespace:"filteredNamespace"},outputs:{parsedRulesOutput:"parsedRulesOutput"},decls:12,vars:24,consts:[[1,"display-flex",3,"formGroup"],[3,"namespaceChanged","parsedRulesChanged","formGroup","filteredNamespaces"],["formControlName","generatePasswordCtrl","matTooltipPosition","left",1,"display-flex","mt-3",3,"ngModelChange","matTooltipDisabled","matTooltip"],[3,"checked","value"],[1,"display-flex"],[3,"formGroup","namespace","passwordRequired","tooltipPwdDisabledForNamespace"]],template:function(i,e){i&1&&(o(0,"div",0)(1,"app-login-for-namespace",1),S("namespaceChanged",function(_){return e.onNamespaceChanged(_)})("parsedRulesChanged",function(_){return e.parsedRulesFunction(_)}),n(),o(2,"mat-radio-group",2),p(3,"translate"),S("ngModelChange",function(){return e.passwordOptionChanged()}),o(4,"mat-radio-button",3),s(5),p(6,"translate"),n(),o(7,"mat-radio-button",3),s(8),p(9,"translate"),n()(),o(10,"div",4),O(11,"perun-web-apps-password-form",5),n()()),i&2&&(m("formGroup",e.formGroup),r(),m("formGroup",e.formGroup)("filteredNamespaces",e.filteredNamespace),r(),m("matTooltip",U(l(3,18,"DIALOGS.CREATE_SERVICE_MEMBER.PASSWORD_NOT_SUPPORTED")))("matTooltipDisabled",e.formGroup.get("namespaceCtrl").value!=="Not selected"),r(2),m("checked",e.formGroup.get("generatePasswordCtrl").value&&e.formGroup.get("generatePasswordCtrl").enabled)("value",!0),r(),N(" ",l(6,20,"DIALOGS.CREATE_SERVICE_MEMBER.PASSWORD_RANDOM")," "),r(2),m("checked",!e.formGroup.get("generatePasswordCtrl").value&&e.formGroup.get("generatePasswordCtrl").enabled)("value",!1),r(),N(" ",l(9,22,"DIALOGS.CREATE_SERVICE_MEMBER.ENTER_PASSWORD")," "),r(2),k("input-disabled",e.formGroup.get("generatePasswordCtrl").value),r(),m("formGroup",e.formGroup)("namespace",e.selectedNamespace)("passwordRequired",!e.formGroup.get("generatePasswordCtrl").value)("tooltipPwdDisabledForNamespace",e.formGroup.get("generatePasswordCtrl").enabled))},dependencies:[G,oe,ae,re,F,R,A,P,b,w,j,le,pe,L],styles:[".display-flex[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]})}}return a})();export{st as a};
