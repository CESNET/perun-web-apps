import{a as Ha,b as za,c as $a,d as Ya,e as Xa,f as qa,g as Ka,h as Za,i as Qa,j as Ja,k as er,l as tr,m as ir,n as nr,o as or,p as ar,q as rr,r as sr,s as lr,t as dr,u as mr,v as Er,w as Tr,x as xr}from"./chunk-OJI2BWKU.js";import{a as Fi,b as xn}from"./chunk-D37YZBDY.js";import"./chunk-JD644HWR.js";import{a as Gi,b as Tn,c as bn,d as pr,e as cr,f as ur,g as _r,h as gr,i as fr,j as hr,k as vr,l as Ir,m as Cr,n as Sr,o as br,p as Mr,q as Dr}from"./chunk-NEMBOUU2.js";import"./chunk-D7YP42RJ.js";import{c as Bi,d as An}from"./chunk-HMVCITBB.js";import{a as Wa}from"./chunk-YAOCYKSX.js";import{a as Ar}from"./chunk-HQHC3UUF.js";import{a as Pi}from"./chunk-EIFLC2UB.js";import{a as xt,b as Wi}from"./chunk-C3YVI7GE.js";import{$a as Nt,$b as en,$c as Bt,$d as bo,$e as pn,$f as _n,$h as Ea,$i as In,A as io,Aa as he,Ad as mt,Ae as Do,Ag as na,Ai as Oa,Aj as ka,Ba as T,Bc as X,Bf as ji,Ca as C,Cc as R,Cd as ut,Ce as Ro,Cf as Xn,Ci as Ut,Da as p,Dc as O,De as Di,Df as zo,Ea as ao,Ee as Oo,Ef as $o,Fa as ro,Fe as Ri,Fi as ya,G as Kt,Gd as Jt,Ge as ci,Gf as Yo,H as zt,Ha as Rt,Hc as Io,I as zi,Ia as Ot,Ic as ve,Id as we,Ie as yo,Ih as ha,Ja as yt,Jb as co,Jd as St,Je as No,Jh as va,K as $i,Ka as y,Kd as Ye,Ke as wo,La as $,Lb as Ae,Lc as rt,Ld as Ie,Le as Lo,Lg as oa,Lh as Ia,Li as jt,Ma as ce,Mc as vt,Md as ei,Me as Vo,Mi as xe,N as no,Na as s,Ne as Po,Ni as wi,Oa as b,Oc as It,Oe as Go,Of as j,Oi as Na,Pa as g,Pc as nn,Pe as Oi,Pf as pt,Pg as aa,Q as zn,Qa as be,Qb as nt,Qc as Co,Qd as ti,Qe as oi,Qg as ra,Ra as so,Rb as dt,Rc as So,Re as ai,Rg as di,S as f,Sb as ye,Sc as Vt,Sd as de,Se as ri,Sf as Xo,Sg as sa,Si as wa,T as h,Ta as re,Tb as Ci,Tc as bi,Te as si,Tg as la,Ua as se,Ub as mo,Uc as on,Ue as li,V as Yi,Va as le,Vb as uo,Vc as Eo,Vd as Yn,Ve as yi,Vi as La,W as Xi,Wa as Y,Wb as ct,Wc as We,Wd as $t,We as Bo,Wg as gn,Wi as Tt,Xa as pe,Xb as $n,Xc as Pt,Xd as gt,Xe as Fo,Xf as F,Xg as pa,Ya as fi,Yb as ot,Yc as He,Ye as ko,Yf as Et,Yj as Cn,Za as ge,Zb as Ji,Zc as Gt,Zd as an,Ze as Re,Zh as Ca,_ as Dt,_a as Ee,_b as Qt,_c as To,_e as Uo,_g as ca,_h as Sa,aa as o,ab as hi,ac as tn,ad as Ft,bc as _o,bd as V,bj as Va,cb as d,cc as go,cd as N,cf as jo,ci as Ta,cj as Pa,ck as Sn,d as me,db as m,dc as fo,de as xi,dg as qo,dh as da,dk as Ua,ea as u,eb as it,ec as Si,ed as Me,ee as Xe,eg as Ko,eh as ma,ej as Ga,fa as M,fc as ho,fd as De,fe as k,ff as cn,fg as Zo,fk as ja,gb as lo,gd as Je,ge as J,gf as dn,gg as Qo,gk as Vi,h as ui,hc as vo,hd as et,he as ee,hk as En,i as Hn,ia as oo,ib as L,ic as at,id as ze,ie as q,ik as At,ja as qi,jb as ht,jc as Ne,jd as $e,je as te,k as ft,ka as A,kd as Q,ke as ie,kh as ua,ki as ba,kj as Te,la as _t,lb as Ki,lc as Ei,ld as ue,le as ne,lf as mn,li as Aa,lj as Ba,m as eo,mb as Zi,mc as Ti,me as oe,mf as G,mg as Jo,mi as xa,mj as Fa,nc as K,nh as _a,nj as Li,oa as gi,ob as vi,oc as Le,oh as ga,oi as Ma,p as to,pb as Zt,pc as Ve,pe as rn,pg as ea,pi as qn,qa as v,qb as po,qc as Pe,qe as ii,qi as fn,r as _i,ra as I,rb as Ii,rc as Ge,re as sn,rf as Ni,rh as fa,sa as Oe,sb as Qi,sc as Be,se as Ao,sf as un,ta as Ce,tb as D,tc as Fe,td as st,te as ln,tf as Wo,ti as Da,ua as Se,uc as Ke,ud as lt,ue as ni,ui as hn,va as _,vc as ke,ve as Mi,vi as vn,wa as a,wc as Ze,wd as Ct,wg as ta,wi as Ra,xa as r,xc as Ue,xd as P,xe as xo,xf as Ho,xj as Wt,ya as S,yc as je,yd as Ai,ye as Mo,za as fe,zc as Qe,zd as kt,zg as ia,zj as bt}from"./chunk-353QRQI4.js";import{a as Jn}from"./chunk-TSRGIXR5.js";var Mn=(()=>{class t{constructor(e,i){this.router=e,this.route=i}navigate(e,i=null){this.route.queryParams.pipe(io(1)).subscribe(n=>{let l="merge",E=Object.assign({},n);location.pathname.endsWith("applicationForm/preview")&&(l="",delete E.applicationFormItems),this.router.navigate(e,{relativeTo:i,queryParams:E,queryParamsHandling:l})})}static{this.\u0275fac=function(i){return new(i||t)(zn(rt),zn(ve))}}static{this.\u0275prov=no({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Ks=()=>({color:"black"}),Dn=(t,c)=>["/organizations",t,"groups",c],Or=t=>["/organizations",t];function Zs(t,c){t&1&&S(0,"mat-spinner",1)}function Qs(t,c){if(t&1){let e=T();a(0,"button",13),d(1,"translate"),C("click",function(){f(e);let n=p(2);return h(n.editGroup())}),a(2,"mat-icon"),s(3,"edit"),r()()}t&2&&_("matTooltip",Y(m(1,2,"GROUP_DETAIL.EDIT")))}function Js(t,c){if(t&1){let e=T();a(0,"button",14),d(1,"translate"),C("click",function(){f(e);let n=p(2);return h(n.deleteGroup())}),a(2,"mat-icon"),s(3,"delete_forever"),r()()}t&2&&_("matTooltip",Y(m(1,2,"GROUP_DETAIL.DELETE")))}function el(t,c){if(t&1){let e=T();a(0,"button",16),d(1,"groupSyncIcon"),d(2,"groupSyncToolTip"),d(3,"translate"),C("click",function(){f(e);let n=p(3);return h(n.onSyncDetail())}),a(4,"mat-icon"),d(5,"groupSyncIconColor"),s(6),d(7,"groupSyncIcon"),r()()}if(t&2){let e=p(3);_("disabled",m(1,7,e.group)==="sync_disabled")("matTooltipPosition","above")("matTooltip",m(3,11,m(2,9,e.group))),o(4),ce(pe("",m(5,13,e.group)," align-top")),o(2),g(" ",m(7,15,e.group)," ")}}function tl(t,c){if(t&1&&(a(0,"span"),s(1),d(2,"translate"),v(3,el,8,17,"button",15),r()),t&2){let e=p(2);o(),g(" , ",m(2,2,"GROUP_DETAIL.SYNCHRONIZATION"),": "),o(2),I(e.syncAuth?3:-1)}}function il(t,c){if(t&1){let e=T();a(0,"p"),s(1),d(2,"translate"),a(3,"a",17),C("auxclick",function(n){return f(e),h(n.preventDefault())}),s(4),r()()}if(t&2){let e=p(2);o(),g(" ",m(2,4,"GROUP_DETAIL.SUBGROUP_INFO")," "),o(2),_("perunWebAppsMiddleClickRouterLink",Nt(6,Dn,e.parentGroup.voId.toString(),e.parentGroup.id.toString()))("routerLink",Nt(9,Dn,e.parentGroup.voId,e.parentGroup.id)),o(),g(" ",e.parentGroup.name," ")}}function nl(t,c){if(t&1){let e=T();a(0,"div")(1,"div",2),S(2,"mat-icon",3),d(3,"translate"),a(4,"div",4)(5,"div",5)(6,"a",6),C("auxclick",function(n){return f(e),h(n.preventDefault())}),s(7),r(),a(8,"span",7),s(9),r(),a(10,"button",8),d(11,"translate"),a(12,"mat-icon"),s(13," file_copy "),r()(),v(14,Qs,4,4,"button",9),v(15,Js,4,4,"button",10),r(),a(16,"div"),s(17),d(18,"translate"),r(),a(19,"span",11),s(20),d(21,"translate"),d(22,"translate"),a(23,"a",12),C("auxclick",function(n){return f(e),h(n.preventDefault())}),s(24),r(),s(25),d(26,"translate"),v(27,tl,4,4,"span"),v(28,il,5,12,"p"),r()()(),S(29,"app-animated-router-outlet"),r()}if(t&2){let e=p();o(2),_("matTooltip",Y(m(3,28,"GROUP_DETAIL.ENTITY")))("ngStyle",ge(40,Ks)),o(4),gi("data-cy",pe("",e.group.shortName,"-shortName")),_("perunWebAppsMiddleClickRouterLink",Nt(41,Dn,e.vo.id.toString(),e.group.id.toString()))("routerLink",Nt(44,Dn,e.vo.id,e.group.id))("queryParams",e.route.snapshot.queryParams),o(),g(" ",e.group.shortName," "),o(2),g(" \xA0#",e.group.id," "),o(),_("matTooltip",Y(m(11,30,"SHARED_LIB.PERUN.COMPONENTS.GROUP_MENU.COPY")))("cdkCopyToClipboard",e.group.name)("matTooltipPosition","below"),o(4),I(e.group.name!=="members"&&e.editAuth?14:-1),o(),I(e.group.name!=="members"&&e.deleteAuth?15:-1),o(2),be("",m(18,32,"GROUP_DETAIL.UUID"),": ",e.group.uuid),o(3),be(" ",m(21,34,"GROUP_DETAIL.ENTITY"),", ",m(22,36,"GROUP_DETAIL.VO_NAME"),": "),o(3),_("perunWebAppsMiddleClickRouterLink",Ee(47,Or,e.vo.id.toString()))("routerLink",Ee(49,Or,e.vo.id))("queryParams",e.route.snapshot.queryParams),o(),b(e.vo.name),o(),be(", ",m(26,38,"GROUP_DETAIL.DESCRIPTION"),": ",e.group.description," "),o(2),I(e.syncEnabled?27:-1),o(),I(e.parentGroup?28:-1)}}var Vr=(()=>{class t extends Tn(){constructor(e,i,n,l,E,x,w,U,_e,tt,Ht){super(),this.sideMenuService=e,this.voService=i,this.route=n,this.sideMenuItemService=l,this.groupService=E,this.dialog=x,this.guiAuthResolver=w,this.router=U,this.entityStorageService=_e,this.reloadEntityDetail=tt,this.queryParamsRouter=Ht,this.editAuth=!1,this.deleteAuth=!1,this.loading=!1,this.syncAuth=!1,this.syncEnabled=!1,this.attrNames=[Re.GROUP_SYNC_ENABLED,Re.GROUP_LAST_SYNC_STATE,Re.GROUP_LAST_SYNC_TIMESTAMP,Re.GROUP_STRUCTURE_SYNC_ENABLED,Re.GROUP_LAST_STRUCTURE_SYNC_STATE,Re.GROUP_LAST_STRUCTURE_SYNC_TIMESTAMP]}ngOnInit(){this.reloadEntityDetail.entityDetailChange.pipe(zi(this.destroyed$)).subscribe(()=>{this.reloadData()}),this.reloadData()}onSyncDetail(){let e=G();e.width="450px",e.data={groupId:this.group.id,theme:"group-theme"},this.dialog.open(Ra,e)}editGroup(){let e=G();e.width="450px",e.data={theme:"group-theme",group:this.group,dialogType:hn.GROUP},this.dialog.open(vn,e).afterClosed().subscribe(n=>{n&&this.groupService.getGroupById(this.group.id).subscribe(l=>{this.group=l,this.setMenuItems()})})}reloadData(){this.loading=!0,this.route.params.pipe(ft(e=>Number(e.groupId)),zt(e=>this.groupService.getGroupById(e)),zt(e=>{this.group=e;let i=this.guiAuthResolver.isAuthorized("getRichGroupByIdWithAttributesByNames_int_List<String>_policy",[this.group]);return eo({vo:this.voService.getVoById(e.voId),parentGroup:e.parentGroupId?this.groupService.getGroupById(e.parentGroupId):ui(null),richGroup:i?this.groupService.getRichGroupByIdWithAttributesByNames(e.id,this.attrNames):ui(e)})})).subscribe({next:e=>{this.vo=e.vo,this.parentGroup=e.parentGroup,this.group=e.richGroup,this.entityStorageService.setEntityAndPathParam(this.group,xi.Group),cn("groups",this.group),dn(this.group,this.vo.name),this.syncEnabled=Ho(this.group),this.setAuth(),this.setMenuItems(),this.loading=!1},error:()=>this.loading=!1})}setMenuItems(){let e=this.sideMenuItemService.parseVo(this.vo),i=this.sideMenuItemService.parseGroup(this.group);this.sideMenuService.setAccessMenuItems([e,i])}deleteGroup(){let e=G();e.width="500px",e.data={theme:"group-theme",groups:[this.group]},this.dialog.open($a,e).afterClosed().subscribe(n=>{n&&this.queryParamsRouter.navigate(["../"],this.route)})}setAuth(){this.syncAuth=this.guiAuthResolver.isAuthorized("forceGroupSynchronization_Group_policy",[this.group]),this.editAuth=this.guiAuthResolver.isAuthorized("updateGroup_Group_policy",[this.group]),this.deleteAuth=this.guiAuthResolver.isAuthorized("deleteGroup_Group_boolean_policy",[this.group])}static{this.\u0275fac=function(i){return new(i||t)(u(At),u(de),u(ve),u(Pi),u(we),u(q),u(k),u(rt),u(F),u(Gi),u(Mn))}}static{this.\u0275cmp=M({type:t,selectors:[["app-group-detail-page"]],features:[qi],decls:4,vars:2,consts:[[1,"container-fluid","ps-xl-5","pe-xl-5","group-theme"],[1,"me-auto","ms-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-group-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"group-link",3,"auxclick","perunWebAppsMiddleClickRouterLink","routerLink","queryParams"],[1,"text-muted"],["mat-icon-button","",3,"cdkCopyToClipboard","matTooltipPosition","matTooltip"],["aria-label","Edit group","mat-icon-button","",3,"matTooltip"],["mat-icon-button","",3,"matTooltip"],[1,"mt-1","entity-info"],["data-cy","vo-link",1,"group-link",3,"auxclick","perunWebAppsMiddleClickRouterLink","routerLink","queryParams"],["aria-label","Edit group","mat-icon-button","",3,"click","matTooltip"],["mat-icon-button","",3,"click","matTooltip"],["mat-icon-button","",1,"align-middle",3,"disabled","matTooltipPosition","matTooltip"],["mat-icon-button","",1,"align-middle",3,"click","disabled","matTooltipPosition","matTooltip"],[1,"group-link",3,"auxclick","perunWebAppsMiddleClickRouterLink","routerLink"]],template:function(i,n){i&1&&(a(0,"div",0),S(1,"perun-web-apps-back-button"),v(2,Zs,1,0,"mat-spinner",1),v(3,nl,30,51,"div"),r()),i&2&&(o(2),I(n.loading?2:-1),o(),I(!n.loading&&n.vo!==void 0&&n.group!==void 0?3:-1))},dependencies:[D,vi,N,Ft,et,Je,Oa,Ct,Vi,wi,Ai,xt,It,vt,De,Me,O,Ae,R,Ko,Qo,Zo],encapsulation:2,data:{animation:[bt]}})}}return t})();var ol=()=>({color:"black"}),Pr=(t,c)=>["/organizations",t,"members",c],Gr=t=>["/admin","users",t];function al(t,c){t&1&&S(0,"mat-spinner",1)}function rl(t,c){if(t&1){let e=T();a(0,"a",6),C("auxclick",function(n){return f(e),h(n.preventDefault())}),s(1),r()}if(t&2){let e=p(2);_("perunWebAppsMiddleClickRouterLink",Ee(3,Gr,e.member.userId.toString()))("routerLink",Ee(5,Gr,e.member.userId)),o(),g(" ",e.member.userId," ")}}function sl(t,c){if(t&1&&(a(0,"span"),s(1),r()),t&2){let e=p(2);o(),b(e.member.userId)}}function ll(t,c){if(t&1){let e=T();a(0,"div")(1,"div",2),S(2,"mat-icon",3),d(3,"translate"),a(4,"div",4)(5,"div",5)(6,"a",6),C("auxclick",function(n){return f(e),h(n.preventDefault())}),s(7),r(),a(8,"span",7),s(9),r()(),a(10,"span",8),s(11),d(12,"translate"),d(13,"translate"),v(14,rl,2,7,"a",9),v(15,sl,2,1,"span"),r()()(),S(16,"app-animated-router-outlet"),r()}if(t&2){let e=p();o(2),_("matTooltip",Y(m(3,14,"MEMBER_DETAIL.ENTITY")))("ngStyle",ge(20,ol))("svgIcon",e.svgIcon),o(4),gi("data-cy",pe("",e.member.user.firstName,"-firstName")),_("perunWebAppsMiddleClickRouterLink",Nt(21,Pr,e.vo.id.toString(),e.member.id.toString()))("routerLink",Nt(24,Pr,e.vo.id,e.member.id)),o(),g(" ",e.fullName," "),o(2),g(" \xA0#",e.member.id," "),o(2),be(" ",m(12,16,"MEMBER_DETAIL.ENTITY"),", ",m(13,18,"MEMBER_DETAIL.USER_ID"),": "),o(3),I(e.isAuthorized?14:-1),o(),I(e.isAuthorized?-1:15)}}var Br=(()=>{class t{constructor(e,i,n,l,E,x,w,U){this.sideMenuItemService=e,this.translate=i,this.sideMenuService=n,this.membersService=l,this.voService=E,this.route=x,this.authResolver=w,this.entityService=U,this.fullName="",this.isAuthorized=!1,this.loading=!1,this.svgIcon="perun-user-dark"}ngOnInit(){this.loading=!0,this.route.params.subscribe(e=>{let i=Number(e.voId),n=Number(e.memberId);this.isAuthorized=this.authResolver.isPerunAdminOrObserver(),this.voService.getVoById(i).subscribe({next:l=>{this.vo=l,this.membersService.getRichMemberWithAttributes(n).subscribe({next:E=>{this.member=E,this.svgIcon=this.member.user.serviceUser?"perun-service-identity":"perun-user-dark",this.entityService.setEntityAndPathParam({id:E.id,beanName:E.beanName,voId:E.voId,userId:E.userId},xi.Member);let x=this.sideMenuItemService.parseVo(this.vo),w=this.sideMenuItemService.parseMember(this.member);this.fullName=w.label,this.sideMenuService.setAccessMenuItems([x,w]),this.loading=!1},error:()=>this.loading=!1})},error:()=>this.loading=!1})})}static{this.\u0275fac=function(i){return new(i||t)(u(Pi),u(X),u(At),u(Ye),u(de),u(ve),u(k),u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-member-detail-page"]],decls:4,vars:2,consts:[[1,"container-fluid","ps-xl-5","pe-xl-5","member-theme"],[1,"ms-auto","me-auto"],[1,"d-flex","page-title-headtitle"],[1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle","svgIcon"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"member-link",3,"auxclick","perunWebAppsMiddleClickRouterLink","routerLink"],[1,"text-muted"],[1,"mt-1","entity-info"],[1,"member-link",3,"perunWebAppsMiddleClickRouterLink","routerLink"]],template:function(i,n){i&1&&(a(0,"div",0),S(1,"perun-web-apps-back-button"),v(2,al,1,0,"mat-spinner",1),v(3,ll,17,27,"div"),r()),i&2&&(o(2),I(n.loading?2:-1),o(),I(!n.loading&&n.vo!==void 0&&n.member!==void 0?3:-1))},dependencies:[D,vi,et,Je,Ct,Vi,wi,Ai,xt,It,vt,De,Me,O,Ae,R],encapsulation:2,data:{animation:[bt]}})}}return t})();function pl(t,c){t&1&&S(0,"mat-spinner",0)}function cl(t,c){if(t&1&&(a(0,"div"),S(1,"perun-web-apps-menu-buttons-field",1)(2,"perun-web-apps-expandable-tiles",2)(3,"perun-web-apps-expandable-tiles",2),r()),t&2){let e=p();o(),_("items",e.items),o(),_("items",e.resourcesItems)("title","MENU_ITEMS.VO.RESOURCES")("sectionId","resourcesExpandable"),o(),_("items",e.settingsItems)("title","MENU_ITEMS.VO.SETTINGS")("sectionId","settings")}}var Fr=(()=>{class t{constructor(e,i,n,l,E,x,w){this.sideMenuService=e,this.voService=i,this.router=n,this.authResolver=l,this.entityStorageService=E,this.routePolicyService=x,this.store=w,this.items=[],this.resourcesItems=[],this.settingsItems=[],this.memberOrganization=!1,this.loading=!1}ngDoCheck(){let e=this.vo.id;this.vo=this.entityStorageService.getEntity(!1),e!==this.vo.id&&this.refresh()}ngOnInit(){this.loading=!0,this.vo=this.entityStorageService.getEntity(!1),this.refresh()}refresh(){this.loading=!0,this.voService.getEnrichedVoById(this.vo.id).subscribe(e=>{this.memberOrganization=e.parentVos.length!==0,this.setItems(),this.setResourceItems(),this.setSettingsItems(),this.loading=!1})}setItems(){this.items=[],this.routePolicyService.canNavigate("organizations-members",this.vo)&&this.items.push({cssIcon:"perun-user",url:`/organizations/${this.vo.id}/members`,label:"MENU_ITEMS.VO.MEMBERS",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-groups",this.vo)&&this.items.push({cssIcon:"perun-group",url:`/organizations/${this.vo.id}/groups`,label:"MENU_ITEMS.VO.GROUPS",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-applications",this.vo)&&this.items.push({cssIcon:"perun-applications",url:`/organizations/${this.vo.id}/applications`,label:"MENU_ITEMS.VO.APPLICATIONS",style:"vo-btn"}),this.store.getProperty("enable_sponsorships")&&this.routePolicyService.canNavigate("organizations-sponsoredMembers",this.vo)&&this.items.push({cssIcon:"perun-user",url:`/organizations/${this.vo.id}/sponsoredMembers`,label:"MENU_ITEMS.VO.SPONSORED_MEMBERS",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-serviceAccounts",this.vo)&&this.items.push({cssIcon:"perun-service-identity",url:`/organizations/${this.vo.id}/serviceAccounts`,label:"MENU_ITEMS.VO.SERVICE_MEMBERS",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-attributes",this.vo)&&this.items.push({cssIcon:"perun-attributes",url:`/organizations/${this.vo.id}/attributes`,label:"MENU_ITEMS.VO.ATTRIBUTES",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-statistics",this.vo)&&this.items.push({cssIcon:"perun-statistics",url:`/organizations/${this.vo.id}/statistics`,label:"MENU_ITEMS.VO.STATISTICS",style:"vo-btn"})}setResourceItems(){this.resourcesItems=[],this.routePolicyService.canNavigate("organizations-resources-preview",this.vo)&&this.resourcesItems.push({cssIcon:"perun-resource",url:`/organizations/${this.vo.id}/resources/preview`,label:"MENU_ITEMS.VO.RESOURCE_PREVIEW",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-resources-tags",this.vo)&&this.resourcesItems.push({cssIcon:"perun-resource-tags",url:`/organizations/${this.vo.id}/resources/tags`,label:"MENU_ITEMS.VO.RESOURCE_TAGS",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-resources-states",this.vo)&&this.resourcesItems.push({cssIcon:"perun-resources-state",url:`/organizations/${this.vo.id}/resources/states`,label:"MENU_ITEMS.VO.RESOURCE_STATES",style:"vo-btn"})}setSettingsItems(){this.settingsItems=[],this.routePolicyService.canNavigate("organizations-settings-expiration",this.vo)&&this.settingsItems.push({cssIcon:"perun-group",url:`/organizations/${this.vo.id}/settings/expiration`,label:"MENU_ITEMS.VO.EXPIRATION",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-settings-managers",this.vo)&&this.settingsItems.push({cssIcon:"perun-manager",url:`/organizations/${this.vo.id}/settings/managers`,label:"MENU_ITEMS.VO.MANAGERS",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-settings-applicationForm",this.vo)&&this.settingsItems.push({cssIcon:"perun-application-form",url:`/organizations/${this.vo.id}/settings/applicationForm`,label:"MENU_ITEMS.VO.APPLICATION_FORM",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-settings-notifications",this.vo)&&this.settingsItems.push({cssIcon:"perun-notification",url:`/organizations/${this.vo.id}/settings/notifications`,label:"MENU_ITEMS.VO.NOTIFICATIONS",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-settings-extsources",this.vo)&&this.settingsItems.push({cssIcon:"perun-external-sources",url:`/organizations/${this.vo.id}/settings/extsources`,label:"MENU_ITEMS.VO.EXTSOURCES",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-settings-memberOrganizations",this.vo)&&this.settingsItems.push({cssIcon:"perun-hierarchical-vo",url:`/organizations/${this.vo.id}/settings/memberOrganizations`,label:"MENU_ITEMS.VO.MEMBER_ORGANIZATIONS",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-settings-hierarchicalInclusion",this.vo)&&this.memberOrganization&&this.settingsItems.push({cssIcon:"perun-hierarchical-inclusion",url:`/organizations/${this.vo.id}/settings/hierarchicalInclusion`,label:"MENU_ITEMS.VO.HIERARCHICAL_INCLUSION",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-settings-bans",this.vo)&&this.settingsItems.push({cssIcon:"perun-ban",url:`/organizations/${this.vo.id}/settings/bans`,label:"MENU_ITEMS.VO.BANS",style:"vo-btn"})}static{this.\u0275fac=function(i){return new(i||t)(u(At),u(de),u(rt),u(k),u(F),u(Et),u(Xe))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-overview"]],decls:2,vars:2,consts:[[1,"me-auto","ms-auto"],[3,"items"],[3,"items","title","sectionId"]],template:function(i,n){i&1&&(v(0,pl,1,0,"mat-spinner",0),v(1,cl,4,7,"div")),i&2&&(I(n.loading?0:-1),o(),I(n.loading?-1:1))},dependencies:[D,Tt,Sn,De,Me],encapsulation:2})}}return t})();var kr=t=>["/organizations",t],dl=(t,c)=>c.id;function ml(t,c){t&1&&(a(0,"span"),s(1,", "),r())}function ul(t,c){if(t&1){let e=T();a(0,"span")(1,"a",0),C("auxclick",function(n){return f(e),h(n.preventDefault())}),s(2),r(),v(3,ml,2,0,"span"),r()}if(t&2){let e=c.$implicit,i=c.$index,n=p();o(),_("perunWebAppsMiddleClickRouterLink",Ee(4,kr,e.id.toString()))("routerLink",Ee(6,kr,e.id.toString())),o(),g(" ",e.name," "),o(),I(n.vos.length>i+1?3:-1)}}function _l(t,c){t&1&&(a(0,"span"),s(1,"\u2026"),r())}var Ur=(()=>{class t{constructor(){this.vos=[]}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=M({type:t,selectors:[["app-related-vos"]],inputs:{title:"title",vos:"vos"},decls:5,vars:4,consts:[[1,"vo-link","pointer",3,"auxclick","perunWebAppsMiddleClickRouterLink","routerLink"]],template:function(i,n){i&1&&(s(0),d(1,"translate"),Ce(2,ul,4,8,"span",null,dl),v(4,_l,2,0,"span")),i&2&&(g("",m(1,2,n.title),`:
`),o(2),Se(n.vos.slice(0,3)),o(2),I(n.vos.length>3?4:-1))},dependencies:[D,Ct,It,vt,O,R],styles:[".pointer[_ngcontent-%COMP%]{cursor:pointer}"]})}}return t})();var gl=()=>({color:"black"}),fl=t=>["/organizations",t],hl=t=>["/organizations/",t];function vl(t,c){t&1&&S(0,"mat-spinner",1)}function Il(t,c){if(t&1){let e=T();a(0,"button",12),d(1,"translate"),C("click",function(){f(e);let n=p(2);return h(n.editVo())}),a(2,"mat-icon"),s(3,"edit"),r()()}t&2&&_("matTooltip",Y(m(1,2,"VO_DETAIL.EDIT")))}function Cl(t,c){if(t&1){let e=T();a(0,"button",13),d(1,"translate"),C("click",function(){f(e);let n=p(2);return h(n.removeVo())}),a(2,"mat-icon"),s(3,"delete_forever"),r()()}t&2&&_("matTooltip",Y(m(1,2,"VO_DETAIL.DELETE")))}function Sl(t,c){if(t&1&&S(0,"app-related-vos",11),t&2){let e=p(2);_("title","VO_DETAIL.RELATED_VOS.MEMBER_VOS")("vos",e.enrichedVo.memberVos)}}function El(t,c){if(t&1&&S(0,"app-related-vos",11),t&2){let e=p(2);_("title","VO_DETAIL.RELATED_VOS.PARENT_VOS")("vos",e.enrichedVo.parentVos)}}function Tl(t,c){if(t&1){let e=T();a(0,"div")(1,"div",2),S(2,"mat-icon",3),d(3,"translate"),a(4,"div",4)(5,"div",5)(6,"a",6),C("auxclick",function(n){return f(e),h(n.preventDefault())}),s(7),r(),a(8,"span",7),s(9),r(),v(10,Il,4,4,"button",8),v(11,Cl,4,4,"button",9),r(),a(12,"div"),s(13),d(14,"translate"),r(),a(15,"span",10),s(16),d(17,"translate"),d(18,"translate"),v(19,Sl,1,2,"app-related-vos",11),v(20,El,1,2,"app-related-vos",11),r()()(),S(21,"app-animated-router-outlet"),r()}if(t&2){let e=p();o(2),_("matTooltip",Y(m(3,18,"VO_DETAIL.ENTITY")))("ngStyle",ge(26,gl))("svgIcon",e.enrichedVo.memberVos.length!==0?"perun-hierarchical-vo":"perun-vo-black"),o(4),_("perunWebAppsMiddleClickRouterLink",Ee(27,fl,e.vo.id.toString()))("routerLink",Ee(29,hl,e.vo.id))("queryParams",e.route.snapshot.queryParams),o(),g(" ",e.vo.name," "),o(2),g(" \xA0#",e.vo.id," "),o(),I(e.editAuth?10:-1),o(),I(e.removeAuth?11:-1),o(2),be("",m(14,20,"VO_DETAIL.UUID"),": ",e.vo.uuid),o(3),so(" ",m(17,22,"VO_DETAIL.ENTITY"),", ",m(18,24,"VO_DETAIL.SHORT_NAME"),": ",e.vo.shortName+(e.enrichedVo.memberVos.length+e.enrichedVo.parentVos.length?",":"")," "),o(3),I(e.enrichedVo.memberVos.length!==0?19:-1),o(),I(e.enrichedVo.parentVos.length!==0?20:-1)}}var jr=(()=>{class t extends Tn(){constructor(e,i,n,l,E,x,w,U,_e,tt){super(),this.sideMenuService=e,this.voService=i,this.route=n,this.router=l,this.sideMenuItemService=E,this.dialog=x,this.authResolver=w,this.entityStorageService=U,this.reloadEntityDetail=_e,this.queryParamsRouter=tt,this.loading=!1}ngOnInit(){this.reloadData(),this.reloadEntityDetail.entityDetailChange.pipe(zi(this.destroyed$)).subscribe(()=>{this.reloadData()})}reloadData(){this.loading=!0,this.route.params.subscribe(e=>{let i=Number(e.voId);this.voService.getEnrichedVoById(i).subscribe({next:n=>{this.vo=n.vo,this.enrichedVo=n,this.entityStorageService.setEntityAndPathParam({id:this.vo.id,beanName:this.vo.beanName},xi.Vo),this.editAuth=this.authResolver.isAuthorized("updateVo_Vo_policy",[this.vo]),this.removeAuth=this.authResolver.isAuthorized("deleteVo_Vo_policy",[this.vo]),this.setMenuItems(),cn("vos",this.vo),dn(this.vo),this.loading=!1},error:()=>this.loading=!1})})}editVo(){let e=G();e.width="450px",e.data={theme:"vo-theme",vo:this.vo,dialogType:hn.VO},this.dialog.open(vn,e).afterClosed().subscribe(n=>{n&&this.voService.getVoById(this.vo.id).subscribe(l=>{this.vo=l,this.setMenuItems()})})}setMenuItems(){let e=this.enrichedVo.memberVos.length!==0,i=this.enrichedVo.parentVos.length!==0,n=this.sideMenuItemService.parseVo(this.vo,e,i);this.sideMenuService.setAccessMenuItems([n])}removeVo(){let e=G();e.width="500px",e.data={theme:"vo-theme",vos:[this.vo]},this.dialog.open(Ha,e).afterClosed().subscribe(n=>{n&&this.queryParamsRouter.navigate([""])})}static{this.\u0275fac=function(i){return new(i||t)(u(At),u(de),u(ve),u(rt),u(Pi),u(q),u(k),u(F),u(Gi),u(Mn))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-detail-page"]],features:[qi],decls:4,vars:2,consts:[[1,"container-fluid","ps-xl-5","pe-xl-5","vo-theme"],[1,"ms-auto","me-auto"],[1,"d-flex","page-title-headtitle"],[1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle","svgIcon"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],["data-cy","vo-name-link",1,"vo-link",3,"auxclick","perunWebAppsMiddleClickRouterLink","routerLink","queryParams"],[1,"text-muted"],["mat-icon-button","","aria-label","Edit Vo",3,"matTooltip"],["mat-icon-button","","aria-label","Remove Vo","data-cy","delete-vo",3,"matTooltip"],[1,"mt-1","entity-info"],[3,"title","vos"],["mat-icon-button","","aria-label","Edit Vo",3,"click","matTooltip"],["mat-icon-button","","aria-label","Remove Vo","data-cy","delete-vo",3,"click","matTooltip"]],template:function(i,n){i&1&&(a(0,"div",0),S(1,"perun-web-apps-back-button"),v(2,vl,1,0,"mat-spinner",1),v(3,Tl,22,31,"div"),r()),i&2&&(o(2),I(n.loading?2:-1),o(),I(!n.loading&&n.vo!==void 0?3:-1))},dependencies:[D,vi,N,Ft,et,Je,Ct,Vi,wi,Ai,xt,It,vt,De,Me,O,Ae,Ur,R],styles:[".shortname[_ngcontent-%COMP%]{font-size:medium}"],data:{animation:[bt]}})}}return t})();function bl(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function Al(t,c){if(t&1){let e=T();a(0,"div")(1,"h1",2),s(2),d(3,"translate"),r(),a(4,"div",3)(5,"app-choose-sponsor",4),C("sponsorTypeSelected",function(n){f(e);let l=p();return h(l.sponsorType=n)})("sponsorSelected",function(n){f(e);let l=p();return h(l.selectedSponsor=n)}),r(),a(6,"div"),S(7,"br"),a(8,"h6"),s(9),d(10,"translate"),r(),a(11,"perun-web-apps-expiration-select",5),C("expirationSelected",function(n){f(e);let l=p();return h(l.setExpiration(n))}),r()()(),a(12,"div",6)(13,"button",7),C("click",function(){f(e);let n=p();return h(n.onCancel())}),s(14),d(15,"translate"),r(),a(16,"button",8),C("click",function(){f(e);let n=p();return h(n.onSponsor())}),s(17),d(18,"translate"),r()()()}if(t&2){let e=p();o(2),b(m(3,9,"DIALOGS.SPONSOR_THIS_MEMBER.TITLE")),o(3),_("voId",e.member.voId)("voSponsors",e.sponsors)("customTitle","DIALOGS.SPONSOR_THIS_MEMBER.SELECT_SPONSOR"),o(4),b(m(10,11,"DIALOGS.SPONSOR_EXISTING_MEMBER.EXPIRATION")),o(2),_("minDate",e.minDate),o(3),g(" ",m(15,13,"DIALOGS.SPONSOR_THIS_MEMBER.CANCEL")," "),o(2),_("disabled",e.loading||e.sponsorType==="other"&&!e.selectedSponsor),o(),g(" ",m(18,15,"DIALOGS.SPONSOR_THIS_MEMBER.SPONSOR")," ")}}var Wr=(()=>{class t{constructor(e,i,n,l,E,x){this.dialogRef=e,this.data=i,this.store=n,this.membersService=l,this.notificator=E,this.translate=x,this.loading=!1,this.expiration="never",this.selectedSponsor=null,this.sponsorType="self",this.sponsors=[],this.minDate=new Date}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.member=this.data.member,this.membersService.getAvailableSponsorsForMember(this.member.id).subscribe(e=>{this.sponsors=e,this.loading=!1})}onCancel(){this.dialogRef.close(!1)}onSponsor(){this.loading=!0,this.expiration=this.expiration==="never"?null:this.expiration;let e=this.sponsorType==="self"?this.store.getPerunPrincipal().user:this.selectedSponsor;this.membersService.sponsorMembers([this.member.id],e.id,this.expiration).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.SPONSOR_THIS_MEMBER.SUCCESS")),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}setExpiration(e){this.expiration=e}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(Xe),u(Ye),u(j),u(mt))}}static{this.\u0275cmp=M({type:t,selectors:[["app-sponsor-this-member-dialog"]],decls:4,vars:4,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[3,"sponsorTypeSelected","sponsorSelected","voId","voSponsors","customTitle"],[3,"expirationSelected","minDate"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["data-cy","sponsor-member-button","color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(i,n){if(i&1&&(A(0,bl,1,0,"ng-template",null,0,L),a(2,"div"),A(3,Al,19,17,"div",1),r()),i&2){let l=y(1);o(2),ce(n.theme),o(),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,oe,te,ne,ie,ue,Da,O,P,Qa,R],encapsulation:2})}}return t})();var Hr=(()=>{class t{transform(e){return jo(e)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=oo({name:"attributeFriendlyName",type:t,pure:!0})}}return t})();var zr=()=>["sponsors","expiration"];function xl(t,c){t&1&&S(0,"mat-spinner",0)}function Ml(t,c){t&1&&S(0,"th",17)}function Dl(t,c){if(t&1&&(a(0,"span"),s(1),r()),t&2){let e=p().$implicit,i=p(2);o(),g(" ",i.attributes.get(e)[0],": ")}}function Rl(t,c){if(t&1&&(a(0,"span"),s(1),d(2,"attributeFriendlyName"),r()),t&2){let e=p().$implicit;o(),g(" ",m(2,1,e),": ")}}function Ol(t,c){if(t&1&&(a(0,"td",18),v(1,Dl,2,1,"span"),v(2,Rl,3,3,"span"),r()),t&2){let e=c.$implicit,i=p(2);o(),I(i.attributes.get(e)[0]!==null?1:-1),o(),I(i.attributes.get(e)[0]===null?2:-1)}}function yl(t,c){t&1&&S(0,"th",17)}function Nl(t,c){if(t&1&&(a(0,"td",19),s(1),r()),t&2){let e=c.$implicit,i=p(2);o(),g(" ",i.attributes.get(e)[1]," ")}}function wl(t,c){t&1&&S(0,"tr",20)}function Ll(t,c){if(t&1&&(a(0,"mat-card",14),S(1,"perun-web-apps-member-overview-groups",21),r()),t&2){let e=p(2);o(),_("member",e.member)("voId",e.vo.id)}}function Vl(t,c){if(t&1){let e=T();a(0,"mat-card",3)(1,"mat-card-header")(2,"mat-card-title")(3,"h1",4),s(4),d(5,"translate"),r()()(),a(6,"mat-card-content",22)(7,"div",23),d(8,"translate"),a(9,"button",24),C("click",function(){f(e);let n=p(2);return h(n.requestPwdReset())}),s(10),d(11,"translate"),r()()()()}if(t&2){let e=p(2);o(4),g(" ",m(5,5,"MEMBER_DETAIL.OVERVIEW.RESET_PASSWORD")," "),o(3),_("matTooltipDisabled",e.logins.length>0)("matTooltip",m(8,7,"MEMBER_DETAIL.OVERVIEW.RESET_DISABLED")),o(2),_("disabled",!e.logins.length),o(),g(" ",m(11,9,"MEMBER_DETAIL.OVERVIEW.SEND_REQUEST")," ")}}function Pl(t,c){t&1&&(a(0,"th",17),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"MEMBER_DETAIL.OVERVIEW.SPONSOR_NAME")," "))}function Gl(t,c){if(t&1&&(a(0,"td",36),s(1),d(2,"userFullName"),r()),t&2){let e=c.$implicit;o(),g(" ",m(2,1,e.user)," ")}}function Bl(t,c){t&1&&(a(0,"th",17),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"MEMBER_DETAIL.OVERVIEW.EXPIRATION_TABLE")," "))}function Fl(t,c){if(t&1&&(a(0,"td",36)(1,"span",37),s(2),d(3,"parseDate"),r()()),t&2){let e=c.$implicit;o(2),b(m(3,1,e.validityTo))}}function kl(t,c){t&1&&S(0,"tr",38)}function Ul(t,c){t&1&&S(0,"tr",20)}function jl(t,c){if(t&1){let e=T();a(0,"div",26)(1,"h6",29),s(2),d(3,"translate"),a(4,"button",30),d(5,"translate"),C("click",function(){f(e);let n=p(3);return h(n.changeSponsors())}),a(6,"mat-icon"),s(7,"edit"),r()()(),a(8,"table",31),fe(9,32),A(10,Pl,3,3,"th",7)(11,Gl,3,3,"td",33),he(),fe(12,34),A(13,Bl,3,3,"th",7)(14,Fl,4,3,"td",33),he(),A(15,kl,1,0,"tr",35)(16,Ul,1,0,"tr",11),r()()}if(t&2){let e=p(3);o(2),g(" ",m(3,6,"MEMBER_DETAIL.OVERVIEW.SPONSORS"),": "),o(2),_("matTooltip",Y(m(5,8,"MEMBER_DETAIL.OVERVIEW.EDIT_SPONSORS"))),o(4),_("dataSource",e.sponsorsDataSource),o(7),_("matHeaderRowDef",ge(10,zr)),o(),_("matRowDefColumns",ge(11,zr))}}function Wl(t,c){if(t&1){let e=T();a(0,"mat-card",15)(1,"mat-card-header")(2,"mat-card-title")(3,"h1",4),s(4),d(5,"translate"),r()(),a(6,"mat-card-subtitle",25),s(7),d(8,"translate"),r()(),a(9,"mat-card-content",22),v(10,jl,17,12,"div",26),a(11,"span",27),d(12,"translate"),a(13,"button",28),C("click",function(){f(e);let n=p(2);return h(n.sponsorThisMember())}),s(14),d(15,"translate"),r()()()()}if(t&2){let e=p(2);o(4),b(m(5,8,"MEMBER_DETAIL.OVERVIEW.SPONSORSHIP")),o(3),g(" ",m(8,10,e.member.sponsored?"MEMBER_DETAIL.OVERVIEW.SPONSORED_BY":"MEMBER_DETAIL.OVERVIEW.NOT_SPONSORED")," "),o(3),I(e.member.sponsored&&e.canReadSponsors?10:-1),o(),_("matTooltip",Y(m(12,12,"MEMBER_DETAIL.OVERVIEW.NO_SPONSORS")))("matTooltipDisabled",e.sponsorButtonEnabled),o(2),_("disabled",!e.sponsorButtonEnabled),o(),g(" ",m(15,14,"MEMBER_DETAIL.OVERVIEW.SPONSOR_MEMBER")," ")}}function Hl(t,c){if(t&1&&(a(0,"div")(1,"div",1)(2,"div",2)(3,"mat-card",3)(4,"mat-card-header")(5,"mat-card-title")(6,"h1",4),s(7),d(8,"translate"),r()()(),a(9,"mat-card-content")(10,"table",5),fe(11,6),A(12,Ml,1,0,"th",7)(13,Ol,3,2,"td",8),he(),fe(14,9),A(15,yl,1,0,"th",7)(16,Nl,2,1,"td",10),he(),A(17,wl,1,0,"tr",11),r()()()(),a(18,"div",2)(19,"mat-card",12),S(20,"perun-web-apps-member-overview-membership",13),r(),v(21,Ll,2,2,"mat-card",14),r(),a(22,"div",2),v(23,Vl,12,11,"mat-card",3),v(24,Wl,16,16,"mat-card",15),r()(),a(25,"div"),S(26,"perun-web-apps-menu-buttons-field",16),r()()),t&2){let e=p();o(7),b(m(8,9,"MEMBER_DETAIL.OVERVIEW.PERSONAL")),o(3),_("dataSource",e.dataSource),o(7),_("matRowDefColumns",e.displayedColumns),o(3),_("member",e.member)("voId",e.vo.id),o(),I(e.canReadGroups?21:-1),o(2),I(e.pwdResetAuth?23:-1),o(),I(e.sponsorshipEnabled?24:-1),o(2),_("items",e.navItems)}}var $r=(()=>{class t{constructor(e,i,n,l,E,x,w,U,_e,tt){this.attributesManager=e,this.membersService=i,this.usersManager=n,this.route=l,this.dialog=E,this.authResolver=x,this.storeService=w,this.routePolicyService=U,this.findSponsors=_e,this.store=tt,this.expiration="",this.logins=[],this.member=null,this.navItems=[],this.attributeNames=[],this.attributes=new Map,this.dataSource=new Qe,this.displayedColumns=["attName","attValue"],this.sponsorshipEnabled=!1,this.sponsors=[],this.sponsorsDataSource=new Qe,this.loading=!1,this.isSponsor=!1,this.canReadSponsors=!1,this.canReadGroups=!1,this.isPerunAdmin=!1,this.sponsorButtonEnabled=!1}ngOnInit(){this.loading=!0,this.sponsorshipEnabled=this.store.getProperty("enable_sponsorships"),this.route.parent.params.subscribe(e=>{let i=Number(e.memberId);this.attributeNames=this.storeService.getMemberProfileAttributeNames(),this.membersService.getRichMemberWithAttributes(i).subscribe(n=>{this.attUrns=this.storeService.getProperty("password_namespace_attributes").map(l=>{let E=l.split(":");return E[E.length-1]}),this.attributesManager.getLogins(n.userId).subscribe({next:l=>{this.logins=l.filter(E=>this.attUrns.includes(E.friendlyNameParameter)),this.member=n,this.initAttributes(),this.dataSource=new Qe(Array.from(this.attributes.keys())),this.vo={id:n.voId,beanName:"Vo"},this.pwdResetAuth=this.authResolver.isAuthorized("sendPasswordResetLinkEmail_Member_String_String_String_String_policy",[this.vo,this.member]),this.isPerunAdmin=this.authResolver.isPerunAdmin(),this.isSponsor=this.authResolver.principalHasRole(bo.SPONSOR,"Vo",this.vo.id),this.canReadSponsors=this.authResolver.isAuthorized("getSponsorsForMember_Member_List<String>_policy",[this.member]),this.canReadGroups=this.authResolver.isAuthorized("getGroupRichMembersByIds_int_List<Integer>_List<String>_policy",[this.vo]),this.sponsorshipEnabled&&this.member.sponsored&&this.canReadSponsors?this.usersManager.getSponsorsForMember(this.member.id,null).subscribe(E=>{this.sponsors=E,this.sponsorsDataSource=new Qe(this.sponsors),this.initNavItems(),this.refreshData()}):(this.initNavItems(),this.refreshData())},error:()=>{this.loading=!1}})})})}requestPwdReset(){let e=G();e.width="400px",e.data={userId:this.member.userId,memberId:this.member.id,logins:this.logins},this.dialog.open(Ka,e)}changeSponsors(){let e=G();e.width="650px",e.data={sponsors:this.sponsors,member:this.member,theme:"member-theme"},this.dialog.open(Za,e).afterClosed().subscribe(n=>{n&&this.refreshData()})}sponsorThisMember(){let e=G();e.width="400px",e.data={theme:"member-theme",member:this.member},this.dialog.open(Wr,e).afterClosed().subscribe(n=>{n&&this.refreshData()})}isSponsorButtonEnabled(){if(!this.sponsorshipEnabled){this.sponsorButtonEnabled=!1;return}let e=this.sponsors.map(i=>i.user.id);this.membersService.someAvailableSponsorExistsForMember(this.member.id).subscribe({next:i=>{this.sponsorButtonEnabled=this.isSponsor&&!e.includes(this.storeService.getPerunPrincipal().user.id)||this.isPerunAdmin&&i},error:()=>{this.sponsorButtonEnabled=!1}})}initAttributes(){this.attributeNames.forEach(e=>{this.attributes.set(e,[null,"-"])}),this.filterAttributes()}filterAttributes(){this.member.memberAttributes!==null&&this.member.memberAttributes.forEach(e=>{this.attributeNames.includes(e.friendlyName)&&this.attributes.set(e.friendlyName,[e.displayName,e.value])}),this.member.userAttributes!==null&&this.member.userAttributes.forEach(e=>{this.attributeNames.includes(e.friendlyName)&&this.attributes.set(e.friendlyName,[e.displayName,e.value])})}initNavItems(){this.navItems=[],this.routePolicyService.canNavigate("members-groups",this.member)&&this.navItems.push({cssIcon:"perun-group",url:`/organizations/${this.member.voId}/members/${this.member.id}/groups`,label:"MENU_ITEMS.MEMBER.GROUPS",style:"member-btn"}),this.routePolicyService.canNavigate("members-applications",this.member)&&this.navItems.push({cssIcon:"perun-applications",url:`/organizations/${this.member.voId}/members/${this.member.id}/applications`,label:"MENU_ITEMS.MEMBER.APPLICATIONS",style:"member-btn"}),this.routePolicyService.canNavigate("members-resources",this.member)&&this.navItems.push({cssIcon:"perun-resource",url:`/organizations/${this.member.voId}/members/${this.member.id}/resources`,label:"MENU_ITEMS.MEMBER.RESOURCES",style:"member-btn"}),this.routePolicyService.canNavigate("members-attributes",this.member)&&this.navItems.push({cssIcon:"perun-attributes",url:`/organizations/${this.vo.id}/members/${this.member.id}/attributes`,label:"MENU_ITEMS.MEMBER.ATTRIBUTES",style:"member-btn"}),this.routePolicyService.canNavigate("members-bans",this.member)&&this.navItems.push({cssIcon:"perun-ban",url:`/organizations/${this.vo.id}/members/${this.member.id}/bans`,label:"MENU_ITEMS.MEMBER.BANS",style:"member-btn"})}refreshData(){this.loading=!0,this.membersService.getRichMemberWithAttributes(this.member.id).subscribe({next:e=>{this.member=e,this.sponsorshipEnabled&&e.sponsored&&this.canReadSponsors?this.usersManager.getSponsorsForMember(this.member.id,null).subscribe(i=>{this.sponsors=i,this.sponsorsDataSource.data=this.sponsors,this.isSponsorButtonEnabled()}):(this.sponsors=[],this.sponsorsDataSource.data=this.sponsors,this.isSponsorButtonEnabled()),this.loading=!1},error:()=>{this.loading=!1}})}static{this.\u0275fac=function(i){return new(i||t)(u(ut),u(Ye),u(ti),u(ve),u(q),u(k),u(Xe),u(Et),u(_n),u(Xe))}}static{this.\u0275cmp=M({type:t,selectors:[["app-member-overview"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:2,vars:2,consts:[[1,"me-auto","ms-auto"],[1,"member-cards"],[1,"align-cards"],["appearance","outlined",1,"mat-elevation-z3"],[1,"page-subtitle"],["mat-table","",3,"dataSource"],["matColumnDef","attName"],["mat-header-cell","",4,"matHeaderCellDef"],["class","fw-bold","mat-cell","",4,"matCellDef"],["matColumnDef","attValue"],["class","column-center","mat-cell","",4,"matCellDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["appearance","outlined",1,"mat-elevation-z3","membership-card"],[1,"column-center",3,"member","voId"],["appearance","outlined",1,"mat-elevation-z3","membership-card","mt-4"],["appearance","outlined",1,"mat-elevation-z3","mt-4"],[3,"items"],["mat-header-cell",""],["mat-cell","",1,"fw-bold"],["mat-cell","",1,"column-center"],["mat-row",""],[3,"member","voId"],[1,"column-center"],[3,"matTooltipDisabled","matTooltip"],["color","accent","mat-flat-button","",1,"action-button",3,"click","disabled"],[1,"mt-n3"],[1,"mt-3"],["matTooltipPosition","above",3,"matTooltip","matTooltipDisabled"],["color","accent","mat-flat-button","",1,"action-button","mt-3",3,"click","disabled"],[1,"d-flex","align-items-center"],["mat-icon-button","",1,"ms-auto","mt-n2",3,"click","matTooltip"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","sponsors"],["mat-cell","",4,"matCellDef"],["matColumnDef","expiration"],["mat-header-row","",4,"matHeaderRowDef"],["mat-cell",""],[1,"font-italic"],["mat-header-row",""]],template:function(i,n){i&1&&(v(0,xl,1,0,"mat-spinner",0),v(1,Hl,27,11,"div")),i&2&&(I(n.loading?0:-1),o(),I(n.loading?-1:1))},dependencies:[D,N,V,Ft,et,Je,Tt,ni,rn,sn,ln,Ao,ii,je,Le,Pe,Ke,Ge,Ve,ke,Be,Fe,Ze,Ue,De,Me,O,Ae,Ba,Fa,Jo,R,kt,Hr],styles:[".vert-center[_ngcontent-%COMP%]{vertical-align:inherit!important}.vert-top[_ngcontent-%COMP%]{vertical-align:top}.column-center[_ngcontent-%COMP%]{text-align:center}.align-cards[_ngcontent-%COMP%]{margin:1rem;display:inline-block;vertical-align:top}.member-cards[_ngcontent-%COMP%]{margin:0 -1rem}.membership-card[_ngcontent-%COMP%]{max-width:400px}"]})}}return t})();function zl(t,c){t&1&&S(0,"mat-spinner",0)}function $l(t,c){if(t&1&&(a(0,"div"),S(1,"perun-web-apps-menu-buttons-field",1)(2,"perun-web-apps-expandable-tiles",2),r()),t&2){let e=p();o(),_("items",e.items),o(),_("items",e.settingsItems)("title","MENU_ITEMS.GROUP.SETTINGS")("sectionId","settings")}}var Yr=(()=>{class t{constructor(e,i,n,l,E,x,w,U,_e){this.route=e,this.groupService=i,this.voService=n,this.guiAuthResolver=l,this.apiRequest=E,this.attributesManager=x,this.notificator=w,this.entityStorageService=U,this.routePolicyService=_e,this.items=[],this.settingsItems=[],this.loading=!1}ngDoCheck(){let e=this.group.id;this.group=this.entityStorageService.getEntity(!1),e!==this.group.id&&this.loadData()}ngOnInit(){this.loading=!0,this.group=this.entityStorageService.getEntity(!1),this.loadData()}loadData(){this.loading=!0,this.setItems(),this.setSettingsItems(),this.loading=!1}setItems(){this.items=[],this.routePolicyService.canNavigate("groups-members",this.group)&&this.items.push({cssIcon:"perun-user",url:`/organizations/${this.group.voId}/groups/${this.group.id}/members`,label:"MENU_ITEMS.GROUP.MEMBERS",style:"group-btn"}),this.routePolicyService.canNavigate("groups-subgroups",this.group)&&this.group.name!=="members"&&this.items.push({cssIcon:"perun-group",url:`/organizations/${this.group.voId}/groups/${this.group.id}/subgroups`,label:"MENU_ITEMS.GROUP.SUBGROUPS",style:"group-btn"}),this.routePolicyService.canNavigate("groups-resources",this.group)&&this.items.push({cssIcon:"perun-manage-facility",url:`/organizations/${this.group.voId}/groups/${this.group.id}/resources`,label:"MENU_ITEMS.GROUP.RESOURCES",style:"group-btn"}),this.group.name!=="members"&&this.routePolicyService.canNavigate("groups-applications",this.group)&&this.items.push({cssIcon:"perun-applications",url:`/organizations/${this.group.voId}/groups/${this.group.id}/applications`,label:"MENU_ITEMS.GROUP.APPLICATIONS",style:"group-btn"}),this.group.name!=="members"&&this.routePolicyService.canNavigate("groups-invitations",this.group)&&this.items.push({cssIcon:"perun-invitations",url:`/organizations/${this.group.voId}/groups/${this.group.id}/invitations`,label:"MENU_ITEMS.GROUP.INVITATIONS",style:"group-btn"}),this.routePolicyService.canNavigate("groups-attributes",this.group)&&this.items.push({cssIcon:"perun-attributes",url:`/organizations/${this.group.voId}/groups/${this.group.id}/attributes`,label:"MENU_ITEMS.GROUP.ATTRIBUTES",style:"group-btn"}),this.routePolicyService.canNavigate("groups-statistics",this.group)&&this.items.push({cssIcon:"perun-statistics",url:`/organizations/${this.group.voId}/groups/${this.group.id}/statistics`,label:"MENU_ITEMS.GROUP.STATISTICS",style:"group-btn"}),this.routePolicyService.canNavigate("groups-roles",this.group)&&this.items.push({cssIcon:"perun-roles",url:`/organizations/${this.group.voId}/groups/${this.group.id}/roles`,label:"MENU_ITEMS.GROUP.ROLES",style:"group-btn"})}setSettingsItems(){this.settingsItems=[],this.apiRequest.dontHandleErrorForNext(),this.attributesManager.getGroupAttributeByName(this.group.id,Re.GROUP_DEF_EXPIRATION_RULES).subscribe({next:()=>{this.settingsItems=[{cssIcon:"perun-group",url:`/organizations/${this.group.voId}/groups/${this.group.id}/settings/expiration`,label:"MENU_ITEMS.GROUP.EXPIRATION",style:"group-btn"},...this.settingsItems],this.loading=!1},error:e=>{e.name!=="PrivilegeException"&&this.notificator.showRPCError(e),this.loading=!1}}),this.routePolicyService.canNavigate("groups-settings-managers",this.group)&&this.settingsItems.push({cssIcon:"perun-manager",url:`/organizations/${this.group.voId}/groups/${this.group.id}/settings/managers`,label:"MENU_ITEMS.GROUP.MANAGERS",style:"group-btn"}),this.group.name!=="members"&&this.routePolicyService.canNavigate("groups-settings-applicationForm",this.group)&&this.settingsItems.push({cssIcon:"perun-application-form",url:`/organizations/${this.group.voId}/groups/${this.group.id}/settings/applicationForm`,label:"MENU_ITEMS.GROUP.APPLICATION_FORM",style:"group-btn"}),this.routePolicyService.canNavigate("groups-settings-notifications",this.group)&&this.settingsItems.push({cssIcon:"perun-notification",url:`/organizations/${this.group.voId}/groups/${this.group.id}/settings/notifications`,label:"MENU_ITEMS.GROUP.NOTIFICATIONS",style:"group-btn"}),this.routePolicyService.canNavigate("groups-settings-extsources",this.group)&&this.settingsItems.push({cssIcon:"perun-external-sources",url:`/organizations/${this.group.voId}/groups/${this.group.id}/settings/extsources`,label:"MENU_ITEMS.GROUP.EXTSOURCES",style:"group-btn"}),this.routePolicyService.canNavigate("groups-settings-relations",this.group)&&this.settingsItems.push({cssIcon:"perun-group",url:`/organizations/${this.group.voId}/groups/${this.group.id}/settings/relations`,label:"MENU_ITEMS.GROUP.RELATIONS",style:"group-btn"})}static{this.\u0275fac=function(i){return new(i||t)(u(ve),u(we),u(de),u(k),u(pt),u(ut),u(j),u(F),u(Et))}}static{this.\u0275cmp=M({type:t,selectors:[["app-group-overview"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:2,vars:2,consts:[[1,"me-auto","ms-auto"],[3,"items"],[3,"items","title","sectionId"]],template:function(i,n){i&1&&(v(0,zl,1,0,"mat-spinner",0),v(1,$l,3,4,"div")),i&2&&(I(n.loading?0:-1),o(),I(n.loading?-1:1))},dependencies:[D,Tt,Sn,De,Me],encapsulation:2})}}return t})();var Xr=(()=>{class t{constructor(e){this.route=e}ngOnInit(){this.route.parent.params.subscribe(e=>{this.voId=Number(e.voId)})}static{this.\u0275fac=function(i){return new(i||t)(u(ve))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-resources"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:1,vars:0,template:function(i,n){i&1&&S(0,"app-animated-router-outlet")},dependencies:[D,xt],encapsulation:2,data:{animation:[bt]}})}}return t})();var qr=(()=>{class t{constructor(e,i){this.route=e,this.router=i,this.backButtonRegex=new RegExp("/organizations/\\d+/settings/\\w+$"),this.backButtonDisplayed=!1,this.currentUrl=i.url,this.backButtonDisplayed=this.backButtonRegex.test(this.currentUrl),i.events.subscribe(n=>{n instanceof Io&&(this.currentUrl=n.url,this.backButtonDisplayed=this.backButtonRegex.test(this.currentUrl))})}ngOnInit(){this.route.parent.params.subscribe(e=>{this.voId=Number(e.voId)})}static{this.\u0275fac=function(i){return new(i||t)(u(ve),u(rt))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-settings"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:1,vars:0,template:function(i,n){i&1&&S(0,"app-animated-router-outlet")},dependencies:[D,xt],encapsulation:2,data:{animation:[bt]}})}}return t})();var Kr=(()=>{class t{constructor(e){this.entityStorageService=e}ngOnInit(){this.vo=this.entityStorageService.getEntity()}static{this.\u0275fac=function(i){return new(i||t)(u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-attributes"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:5,vars:5,consts:[[1,"page-subtitle"],[3,"entityId","entity"]],template:function(i,n){i&1&&(a(0,"div")(1,"h1",0),s(2),d(3,"translate"),r(),S(4,"app-one-entity-attribute-page",1),r()),i&2&&(o(2),b(m(3,3,"VO_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),o(2),_("entityId",n.vo.id)("entity","vo"))},dependencies:[D,Bi,O,R],encapsulation:2})}}return t})();function Yl(t,c){t&1&&S(0,"mat-spinner",0)}function Xl(t,c){if(t&1&&(a(0,"div"),S(1,"perun-web-apps-menu-buttons-field",1),r()),t&2){let e=p();o(),_("items",e.items)}}var Zr=(()=>{class t{constructor(e,i,n,l){this.voService=e,this.router=i,this.entityStorageService=n,this.routePolicyService=l,this.items=[],this.loading=!1,this.isMemberOfSomeOrganization=!1}ngOnInit(){this.loading=!0,this.vo=this.entityStorageService.getEntity(),this.voService.getEnrichedVoById(this.vo.id).subscribe(e=>{this.isMemberOfSomeOrganization=e.parentVos.length!==0,this.initItems(),this.loading=!1})}initItems(){this.items=[],this.routePolicyService.canNavigate("organizations-settings-expiration",this.vo)&&this.items.push({cssIcon:"perun-group",url:`/organizations/${this.vo.id}/settings/expiration`,label:"MENU_ITEMS.VO.EXPIRATION",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-settings-managers",this.vo)&&this.items.push({cssIcon:"perun-manager",url:`/organizations/${this.vo.id}/settings/managers`,label:"MENU_ITEMS.VO.MANAGERS",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-settings-applicationForm",this.vo)&&this.items.push({cssIcon:"perun-application-form",url:`/organizations/${this.vo.id}/settings/applicationForm`,label:"MENU_ITEMS.VO.APPLICATION_FORM",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-settings-notifications",this.vo)&&this.items.push({cssIcon:"perun-notification",url:`/organizations/${this.vo.id}/settings/notifications`,label:"MENU_ITEMS.VO.NOTIFICATIONS",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-settings-extsources",this.vo)&&this.items.push({cssIcon:"perun-external-sources",url:`/organizations/${this.vo.id}/settings/extsources`,label:"MENU_ITEMS.VO.EXTSOURCES",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-settings-memberOrganizations",this.vo)&&this.items.push({cssIcon:"perun-hierarchical-vo",url:`/organizations/${this.vo.id}/settings/memberOrganizations`,label:"MENU_ITEMS.VO.MEMBER_ORGANIZATIONS",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-settings-hierarchicalInclusion",this.vo)&&this.isMemberOfSomeOrganization&&this.items.push({cssIcon:"perun-hierarchical-inclusion",url:`/organizations/${this.vo.id}/settings/hierarchicalInclusion`,label:"MENU_ITEMS.VO.HIERARCHICAL_INCLUSION",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-settings-bans",this.vo)&&this.items.push({cssIcon:"perun-ban",url:`/organizations/${this.vo.id}/settings/bans`,label:"MENU_ITEMS.VO.BANS",style:"vo-btn"})}static{this.\u0275fac=function(i){return new(i||t)(u(de),u(rt),u(F),u(Et))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-settings-overview"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:2,vars:2,consts:[[1,"me-auto","ms-auto"],[3,"items"]],template:function(i,n){i&1&&(v(0,Yl,1,0,"mat-spinner",0),v(1,Xl,2,1,"div")),i&2&&(I(n.loading?0:-1),o(),I(n.loading?-1:1))},dependencies:[D,Tt,De,Me],encapsulation:2})}}return t})();var ql=["*"],Jr=(()=>{class t{constructor(){this.modelChange=new _t}ngAfterViewInit(){this.toggle.change.subscribe(()=>this.valueChanged())}valueChanged(){this.modelChange.emit(this.toggle.checked)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=M({type:t,selectors:[["app-settings-toggle-item"]],viewQuery:function(i,n){if(i&1&&Rt(li,7),i&2){let l;Ot(l=yt())&&(n.toggle=l.first)}},inputs:{title:"title",modelValue:"modelValue"},outputs:{modelChange:"modelChange"},ngContentSelectors:ql,decls:8,vars:5,consts:[["toggle",""],[1,"mt-3"],[1,"d-flex","flex-row","align-items-baseline","justify-content-between"],[1,"setting-item","clickable",3,"click"],[1,"ms-4",3,"ngModelChange","ngModel"],[1,"ms-1"]],template:function(i,n){if(i&1){let l=T();ao(),a(0,"div",1)(1,"div",2)(2,"label",3),C("click",function(){f(l);let x=y(5);return h(x.toggle()||n.valueChanged())}),s(3),r(),a(4,"mat-slide-toggle",4,0),le("ngModelChange",function(x){return f(l),se(n.modelValue,x)||(n.modelValue=x),h(x)}),r()(),a(6,"div",5),ro(7),r()()}if(i&2){let l=y(5);o(2),$("unselected-setting",!l.checked),o(),g(" ",n.title," "),o(),re("ngModel",n.modelValue),o(2),_("@openClose",l.checked?"open":"closed")}},dependencies:[D,yi,li,at,ye,ot,Ne],encapsulation:2,data:{animation:[Wt]}})}}return t})();function Kl(t,c){if(t&1){let e=T();a(0,"div",15)(1,"mat-form-field",24)(2,"mat-label"),s(3),d(4,"translate"),r(),a(5,"input",20),le("ngModelChange",function(n){f(e);let l=p(2);return se(l.currentConfiguration.periodStatic,n)||(l.currentConfiguration.periodStatic=n),h(n)}),r(),a(6,"mat-hint"),s(7),d(8,"translate"),r()()()}if(t&2){let e=p(2);o(3),g(" ",m(4,5,"VO_MANAGEMENT.SETTINGS.EXPIRATION.PERIOD_INPUT_STATIC")," "),o(2),_("pattern",Y(e.datePattern)),re("ngModel",e.currentConfiguration.periodStatic),o(2),b(m(8,7,"VO_MANAGEMENT.SETTINGS.EXPIRATION.DP_HINT"))}}function Zl(t,c){if(t&1&&(a(0,"mat-option",18),s(1),r()),t&2){let e=c.$implicit;_("value",e.value),o(),b(e.text)}}function Ql(t,c){if(t&1){let e=T();a(0,"div",16)(1,"mat-form-field",19)(2,"mat-label"),s(3),d(4,"translate"),r(),a(5,"input",25),le("ngModelChange",function(n){f(e);let l=p(2);return se(l.currentConfiguration.periodDynamic,n)||(l.currentConfiguration.periodDynamic=n),h(n)}),r()(),a(6,"mat-form-field")(7,"mat-label"),s(8),d(9,"translate"),r(),a(10,"mat-select",12),le("ngModelChange",function(n){f(e);let l=p(2);return se(l.currentConfiguration.periodDynamicUnit,n)||(l.currentConfiguration.periodDynamicUnit=n),h(n)}),Ce(11,Zl,2,2,"mat-option",18,Oe),r()()()}if(t&2){let e=p(2);o(3),g(" ",m(4,6,"VO_MANAGEMENT.SETTINGS.EXPIRATION.AMOUNT_VALUE")," "),o(2),_("pattern",Y(e.dynamicAmountPattern)),re("ngModel",e.currentConfiguration.periodDynamic),o(3),b(m(9,8,"VO_MANAGEMENT.SETTINGS.EXPIRATION.AMOUNT_TYPE")),o(2),re("ngModel",e.currentConfiguration.periodDynamicUnit),o(),Se(e.amountOptions)}}function Jl(t,c){if(t&1&&(a(0,"mat-option",18),s(1),r()),t&2){let e=c.$implicit;_("value",e),o(),b(e)}}function ep(t,c){if(t&1&&(a(0,"mat-option",18),s(1),r()),t&2){let e=c.$implicit;_("value",e),o(),b(e)}}function tp(t,c){if(t&1&&(a(0,"mat-option",18),s(1),r()),t&2){let e=c.$implicit;_("value",e.value),o(),b(e.text)}}function ip(t,c){if(t&1&&(a(0,"mat-option",18),s(1),r()),t&2){let e=c.$implicit;_("value",e),o(),g(" ",e," ")}}function np(t,c){if(t&1){let e=T();a(0,"div",15)(1,"mat-form-field",24)(2,"mat-label"),s(3),d(4,"translate"),r(),a(5,"input",20),le("ngModelChange",function(n){f(e);let l=p(3);return se(l.currentConfiguration.specialLoaPeriodStatic,n)||(l.currentConfiguration.specialLoaPeriodStatic=n),h(n)}),r(),a(6,"mat-hint"),s(7),d(8,"translate"),r()()()}if(t&2){let e=p(3);o(3),g(" ",m(4,5,"VO_MANAGEMENT.SETTINGS.EXPIRATION.PERIOD_INPUT_STATIC")," "),o(2),_("pattern",Y(e.datePattern)),re("ngModel",e.currentConfiguration.specialLoaPeriodStatic),o(2),b(m(8,7,"VO_MANAGEMENT.SETTINGS.EXPIRATION.DP_HINT"))}}function op(t,c){if(t&1&&(a(0,"mat-option",18),s(1),r()),t&2){let e=c.$implicit;_("value",e.value),o(),b(e.text)}}function ap(t,c){if(t&1){let e=T();a(0,"div",16)(1,"mat-form-field",19)(2,"mat-label"),s(3),d(4,"translate"),r(),a(5,"input",20),le("ngModelChange",function(n){f(e);let l=p(3);return se(l.currentConfiguration.specialLoaPeriodDynamic,n)||(l.currentConfiguration.specialLoaPeriodDynamic=n),h(n)}),r()(),a(6,"mat-form-field")(7,"mat-label"),s(8),d(9,"translate"),r(),a(10,"mat-select",12),le("ngModelChange",function(n){f(e);let l=p(3);return se(l.currentConfiguration.specialLoaPeriodDynamicUnit,n)||(l.currentConfiguration.specialLoaPeriodDynamicUnit=n),h(n)}),Ce(11,op,2,2,"mat-option",18,Oe),r()()()}if(t&2){let e=p(3);o(3),g(" ",m(4,6,"VO_MANAGEMENT.SETTINGS.EXPIRATION.AMOUNT_VALUE")," "),o(2),_("pattern",Y(e.dynamicAmountPattern)),re("ngModel",e.currentConfiguration.specialLoaPeriodDynamic),o(3),b(m(9,8,"VO_MANAGEMENT.SETTINGS.EXPIRATION.AMOUNT_TYPE")),o(2),re("ngModel",e.currentConfiguration.specialLoaPeriodDynamicUnit),o(),Se(e.amountOptions)}}function rp(t,c){if(t&1){let e=T();a(0,"div",21)(1,"mat-radio-group",12),le("ngModelChange",function(n){f(e);let l=p(2);return se(l.currentConfiguration.specialLoaPeriodType,n)||(l.currentConfiguration.specialLoaPeriodType=n),h(n)}),a(2,"mat-radio-button",13,4),s(4),d(5,"translate"),r(),a(6,"mat-radio-button",14,5),s(8),d(9,"translate"),r()(),v(10,np,9,9,"div",15),v(11,ap,13,10,"div",16),a(12,"div")(13,"mat-checkbox",26),le("ngModelChange",function(n){f(e);let l=p(2);return se(l.currentConfiguration.specialLoaPeriodExtendExpiredMembers,n)||(l.currentConfiguration.specialLoaPeriodExtendExpiredMembers=n),h(n)}),s(14),d(15,"translate"),r()()()}if(t&2){let e=y(3),i=y(7),n=p(2);o(),re("ngModel",n.currentConfiguration.specialLoaPeriodType),o(3),g(" ",m(5,7,"VO_MANAGEMENT.SETTINGS.EXPIRATION.PERIOD_TYPE_STATIC")," "),o(4),g(" ",m(9,9,"VO_MANAGEMENT.SETTINGS.EXPIRATION.PERIOD_TYPE_DYNAMIC")," "),o(2),I(e.checked?10:-1),o(),I(i.checked?11:-1),o(2),re("ngModel",n.currentConfiguration.specialLoaPeriodExtendExpiredMembers),o(),g(" ",m(15,11,"VO_MANAGEMENT.SETTINGS.EXPIRATION.EXTEND_EXPIRED_MEMBERS_CHECKBOX")," ")}}function sp(t,c){if(t&1){let e=T();a(0,"div",6)(1,"div",7)(2,"h1",8),C("click",function(){f(e);let n=y(6);return h(n.toggle())}),s(3),d(4,"translate"),r(),a(5,"mat-slide-toggle",9,0),le("ngModelChange",function(n){f(e);let l=p();return se(l.currentConfiguration.enabled,n)||(l.currentConfiguration.enabled=n),h(n)}),r()(),a(7,"div")(8,"app-settings-toggle-item",10),d(9,"translate"),le("ngModelChange",function(n){f(e);let l=p();return se(l.currentConfiguration.periodEnabled,n)||(l.currentConfiguration.periodEnabled=n),h(n)}),C("modelChange",function(n){f(e);let l=p();return h(l.currentConfiguration.periodEnabled=n)}),a(10,"div",11)(11,"mat-radio-group",12),le("ngModelChange",function(n){f(e);let l=p();return se(l.currentConfiguration.periodType,n)||(l.currentConfiguration.periodType=n),h(n)}),a(12,"mat-radio-button",13,1),s(14),d(15,"translate"),r(),a(16,"mat-radio-button",14,2),s(18),d(19,"translate"),r()(),v(20,Kl,9,9,"div",15),v(21,Ql,13,10,"div",16),r()(),a(22,"app-settings-toggle-item",10),d(23,"translate"),le("ngModelChange",function(n){f(e);let l=p();return se(l.currentConfiguration.doNotAllowLoasEnabled,n)||(l.currentConfiguration.doNotAllowLoasEnabled=n),h(n)}),C("modelChange",function(n){f(e);let l=p();return h(l.currentConfiguration.doNotAllowLoasEnabled=n)}),a(24,"mat-form-field")(25,"mat-label"),s(26),d(27,"translate"),r(),a(28,"mat-select",17),le("ngModelChange",function(n){f(e);let l=p();return se(l.currentConfiguration.doNotAllowLoas,n)||(l.currentConfiguration.doNotAllowLoas=n),h(n)}),Ce(29,Jl,2,2,"mat-option",18,Oe),r()()(),a(31,"app-settings-toggle-item",10),d(32,"translate"),le("ngModelChange",function(n){f(e);let l=p();return se(l.currentConfiguration.doNotExtendLoasEnabled,n)||(l.currentConfiguration.doNotExtendLoasEnabled=n),h(n)}),C("modelChange",function(n){f(e);let l=p();return h(l.currentConfiguration.doNotExtendLoasEnabled=n)}),a(33,"mat-form-field")(34,"mat-label"),s(35),d(36,"translate"),r(),a(37,"mat-select",17),le("ngModelChange",function(n){f(e);let l=p();return se(l.currentConfiguration.doNotExtendLoas,n)||(l.currentConfiguration.doNotExtendLoas=n),h(n)}),Ce(38,ep,2,2,"mat-option",18,Oe),r()()(),a(40,"app-settings-toggle-item",10),d(41,"translate"),le("ngModelChange",function(n){f(e);let l=p();return se(l.currentConfiguration.gracePeriodEnabled,n)||(l.currentConfiguration.gracePeriodEnabled=n),h(n)}),C("modelChange",function(n){f(e);let l=p();return h(l.currentConfiguration.gracePeriodEnabled=n)}),a(42,"div",16)(43,"mat-form-field",19)(44,"mat-label"),s(45),d(46,"translate"),r(),a(47,"input",20),le("ngModelChange",function(n){f(e);let l=p();return se(l.currentConfiguration.gracePeriod,n)||(l.currentConfiguration.gracePeriod=n),h(n)}),r()(),a(48,"mat-form-field")(49,"mat-label"),s(50),d(51,"translate"),r(),a(52,"mat-select",12),le("ngModelChange",function(n){f(e);let l=p();return se(l.currentConfiguration.gracePeriodUnit,n)||(l.currentConfiguration.gracePeriodUnit=n),h(n)}),Ce(53,tp,2,2,"mat-option",18,Oe),r()()()(),a(55,"app-settings-toggle-item",10),d(56,"translate"),le("ngModelChange",function(n){f(e);let l=p();return se(l.currentConfiguration.specialLoaPeriodEnabled,n)||(l.currentConfiguration.specialLoaPeriodEnabled=n),h(n)}),C("modelChange",function(n){f(e);let l=p();return h(l.currentConfiguration.specialLoaPeriodEnabled=n)}),a(57,"div",11)(58,"div")(59,"mat-form-field")(60,"mat-label"),s(61),d(62,"translate"),r(),a(63,"mat-select",12,3),le("ngModelChange",function(n){f(e);let l=p();return se(l.currentConfiguration.specialLoa,n)||(l.currentConfiguration.specialLoa=n),h(n)}),Ce(65,ip,2,2,"mat-option",18,Oe),r()(),v(67,rp,16,13,"div",21),r()()()(),a(68,"div",22),d(69,"translate"),a(70,"button",23),C("click",function(){f(e);let n=p();return h(n.saveChanges())}),s(71),d(72,"translate"),r()()()}if(t&2){let e=y(6),i=y(13),n=y(17),l=p();o(2),$("unselected-setting",!e.checked),o(),g(" ",m(4,44,"VO_MANAGEMENT.SETTINGS.EXPIRATION.TITLE")," "),o(2),re("ngModel",l.currentConfiguration.enabled),o(2),_("@openClose",e.checked?"open":"closed"),o(),re("ngModel",l.currentConfiguration.periodEnabled),_("modelValue",l.currentConfiguration.periodEnabled)("title",m(9,46,"VO_MANAGEMENT.SETTINGS.EXPIRATION.PERIOD_LABEL")),o(3),re("ngModel",l.currentConfiguration.periodType),o(3),g(" ",m(15,48,"VO_MANAGEMENT.SETTINGS.EXPIRATION.PERIOD_TYPE_STATIC")," "),o(4),g(" ",m(19,50,"VO_MANAGEMENT.SETTINGS.EXPIRATION.PERIOD_TYPE_DYNAMIC")," "),o(2),I(i.checked?20:-1),o(),I(n.checked?21:-1),o(),re("ngModel",l.currentConfiguration.doNotAllowLoasEnabled),_("modelValue",l.currentConfiguration.doNotAllowLoasEnabled)("title",m(23,52,"VO_MANAGEMENT.SETTINGS.EXPIRATION.DONT_ALLOW_LOA_LABEL")),o(4),g(" ",m(27,54,"VO_MANAGEMENT.SETTINGS.EXPIRATION.DONT_ALLOW_LOA_SELECT")," "),o(2),re("ngModel",l.currentConfiguration.doNotAllowLoas),o(),Se(l.loas),o(2),re("ngModel",l.currentConfiguration.doNotExtendLoasEnabled),_("modelValue",l.currentConfiguration.doNotExtendLoasEnabled)("title",m(32,56,"VO_MANAGEMENT.SETTINGS.EXPIRATION.DONT_EXTEND_LOA_LABEL")),o(4),g(" ",m(36,58,"VO_MANAGEMENT.SETTINGS.EXPIRATION.DONT_EXTEND_LOA_SELECT")," "),o(2),re("ngModel",l.currentConfiguration.doNotExtendLoas),o(),Se(l.loas),o(2),re("ngModel",l.currentConfiguration.gracePeriodEnabled),_("modelValue",l.currentConfiguration.gracePeriodEnabled)("title",m(41,60,"VO_MANAGEMENT.SETTINGS.EXPIRATION.GRACE_PERIOD_LABEL")),o(5),g(" ",m(46,62,"VO_MANAGEMENT.SETTINGS.EXPIRATION.GRACE_AMOUNT_VALUE")," "),o(2),_("pattern",Y(l.dynamicAmountPattern)),re("ngModel",l.currentConfiguration.gracePeriod),o(3),b(m(51,64,"VO_MANAGEMENT.SETTINGS.EXPIRATION.GRACE_AMOUNT_TYPE")),o(2),re("ngModel",l.currentConfiguration.gracePeriodUnit),o(),Se(l.amountOptions),o(2),re("ngModel",l.currentConfiguration.specialLoaPeriodEnabled),_("modelValue",l.currentConfiguration.specialLoaPeriodEnabled)("title",m(56,66,"VO_MANAGEMENT.SETTINGS.EXPIRATION.LOA_PERIOD_LABEL")),o(6),b(m(62,68,"VO_MANAGEMENT.SETTINGS.EXPIRATION.SPECIAL_LOA_SELECT")),o(2),re("ngModel",l.currentConfiguration.specialLoa),o(2),Se(l.loas),o(2),I(l.currentConfiguration.specialLoa!==null?67:-1),o(),_("matTooltip",Y(m(69,70,"VO_MANAGEMENT.SETTINGS.EXPIRATION.PERMISSION_DENIED_HINT")))("matTooltipDisabled",l.expirationAttribute.writable)("matTooltipPosition","above"),o(2),_("disabled",!l.areChangesMade()||!l.expirationAttribute.writable),o(),g(" ",m(72,72,"VO_MANAGEMENT.SETTINGS.EXPIRATION.SAVE")," ")}}var On=(()=>{class t{constructor(){this.saveAttribute=new _t,this.loas=[0,1,2],this.datePattern="^(3[01]|[12][0-9]|0?[1-9])\\.(1[012]|0?[1-9])\\.$",this.dynamicAmountPattern="^[1-9]+$",this.amountOptions=[{value:"d",text:"Days"},{value:"m",text:"Months"},{value:"y",text:"Years"}]}ngOnInit(){let e=new Map;this.loas.forEach(i=>e.set(i,""))}ngOnChanges(e){e.expirationAttribute&&this.expirationAttribute&&(this.initialConfiguration=this.unParseAttrValue(this.expirationAttribute.value),this.currentConfiguration=this.unParseAttrValue(this.expirationAttribute.value))}saveChanges(){this.saveAttribute.emit(this.parseExpirationRulesAttribute())}areChangesMade(){let e=this.parseAttributeValueFromConfig(this.currentConfiguration),i=this.parseAttributeValueFromConfig(this.initialConfiguration);return i===null?e!==null:e===null?!0:e.period!==i.period||e.gracePeriod!==i.gracePeriod||e.doNotExtendLoa!==i.doNotExtendLoa||e.doNotAllowLoa!==i.doNotAllowLoa||e.periodLoa!==i.periodLoa}parseExpirationRulesAttribute(){return this.expirationAttribute.value=this.parseAttributeValueFromConfig(this.currentConfiguration),this.expirationAttribute}parsePeriod(e){if(!e.periodEnabled)return null;switch(e.periodType){case"dynamic":return this.parseDynamicPeriod(e);case"static":return this.parseStaticPeriod(e);default:}}createInitConfiguration(){let e=new Map;return this.loas.forEach(i=>e.set(i,"")),{enabled:!1,periodEnabled:!1,periodType:null,periodStatic:"",periodDynamic:"",periodDynamicUnit:"m",doNotAllowLoas:[],doNotAllowLoasEnabled:!1,doNotExtendLoas:[],doNotExtendLoasEnabled:!1,gracePeriodEnabled:!1,gracePeriod:null,gracePeriodUnit:null,specialLoaPeriodEnabled:!1,specialLoaPeriod:"",specialLoa:null,specialLoaPeriodType:null,specialLoaPeriodDynamic:"",specialLoaPeriodDynamicUnit:"m",specialLoaPeriodStatic:"",specialLoaPeriodExtendExpiredMembers:!1}}unParseAttrValue(e){let i=this.createInitConfiguration();return e==null||(i.enabled=!0,e.period!==void 0&&e.period.length>0&&(i=this.setPeriodValues(e,i)),e.doNotAllowLoa!==void 0&&e.doNotAllowLoa.length>0&&(i=this.setDoNotAllowLoasValues(e,i)),e.doNotExtendLoa!==void 0&&e.doNotExtendLoa.length>0&&(i=this.setDoNotExtendLoasValues(e,i)),e.gracePeriod!==void 0&&e.gracePeriod.length>0&&(i=this.setGracePeriodValues(e,i)),e.periodLoa!==void 0&&e.periodLoa.length>0&&(i=this.setSpecialLoaPeriodValues(e,i))),i}setPeriodValues(e,i){if(i.periodEnabled=!0,e.period.startsWith("+")){i.periodType="dynamic";let n=e.period.charAt(e.period.length-1);i.periodDynamic=e.period.substring(1,e.period.length-1),i.periodDynamicUnit=n}else i.periodType="static",i.periodStatic=e.period;return i}setDoNotAllowLoasValues(e,i){let n=[];return e.doNotAllowLoa.split(",").forEach(l=>n.push(parseInt(l.trim(),10))),i.doNotAllowLoas=n,n.length>0&&(i.doNotAllowLoasEnabled=!0),i}setDoNotExtendLoasValues(e,i){let n=[];return e.doNotExtendLoa.split(",").forEach(l=>n.push(parseInt(l.trim(),10))),i.doNotExtendLoas=n,n.length>0&&(i.doNotExtendLoasEnabled=!0),i}setGracePeriodValues(e,i){i.gracePeriodEnabled=!0;let n=e.gracePeriod.charAt(e.gracePeriod.length-1);return i.gracePeriod=e.gracePeriod.substring(0,e.gracePeriod.length-1),i.gracePeriodUnit=n,i}setSpecialLoaPeriodValues(e,i){i.specialLoa=parseInt(e.periodLoa.substring(0,e.periodLoa.indexOf("|")),10),i.specialLoaPeriodEnabled=!0;let n=e.periodLoa.substring(e.periodLoa.indexOf("|")+1,e.periodLoa.length);if(n.startsWith("+")){n.endsWith(".")&&(i.specialLoaPeriodExtendExpiredMembers=!0,n=n.substring(0,n.length-1)),i.specialLoaPeriodType="dynamic";let l=n.charAt(n.length-1);i.specialLoaPeriodDynamic=n.substring(1,n.length-1),i.specialLoaPeriodDynamicUnit=l}else n.endsWith("..")&&(i.specialLoaPeriodExtendExpiredMembers=!0,n=n.substring(0,n.length-1)),i.specialLoaPeriodType="static",i.specialLoaPeriodStatic=n;return i}parseDynamicPeriod(e){return"+"+e.periodDynamic+e.periodDynamicUnit}parseStaticPeriod(e){return e.periodStatic}parseDontAllowLoas(e){if(!e.doNotAllowLoasEnabled)return null;let i="";return e.doNotAllowLoas.forEach(n=>i+=n.toString()+","),i.length>0&&(i=i.substring(0,i.length-1)),i.length>0?i:null}parseDontExtendLoas(e){if(!e.doNotExtendLoasEnabled)return null;let i="";return e.doNotExtendLoas.forEach(n=>i+=n.toString()+","),i.length>0&&(i=i.substring(0,i.length-1)),i.length>0?i:null}parseGracePeriod(e){return!e.gracePeriodEnabled||e.gracePeriod===null||e.gracePeriod.length===0||e.gracePeriodUnit===null?null:e.gracePeriod+e.gracePeriodUnit}parseSpecialLoaPeriod(e){if(!e.specialLoaPeriodEnabled||!e.specialLoa)return null;let i=e.specialLoa.toString()+"|";switch(e.specialLoaPeriodType){case"static":i+=this.parseSpecialLoaPeriodStatic(e);break;case"dynamic":i+=this.parseSpecialLoaPeriodDynamic(e);break;default:}return i!=null&&e.specialLoaPeriodExtendExpiredMembers&&(i+="."),i}parseSpecialLoaPeriodStatic(e){return e.specialLoaPeriodStatic}parseSpecialLoaPeriodDynamic(e){return"+"+e.specialLoaPeriodDynamic+e.specialLoaPeriodDynamicUnit}parseAttributeValueFromConfig(e){if(!e.enabled)return null;let i=this.parsePeriod(e),n=this.parseDontAllowLoas(e),l=this.parseDontExtendLoas(e),E=this.parseGracePeriod(e),x=this.parseSpecialLoaPeriod(e),w={};return i!==null&&(w.period=i),l!==null&&(w.doNotExtendLoa=l),n!==null&&(w.doNotAllowLoa=n),E!==null&&(w.gracePeriod=E),x!==null&&(w.periodLoa=x),w}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=M({type:t,selectors:[["app-expiration-settings"]],inputs:{expirationAttribute:"expirationAttribute"},outputs:{saveAttribute:"saveAttribute"},features:[Xi],decls:1,vars:1,consts:[["mainToggle",""],["staticPeriod",""],["dynamicPeriod",""],["specialLoaSelect",""],["loaStaticRadioButton",""],["loaDynamicRadioButton",""],[1,"card","settings-card","col-12","col-md-12","col-xl-6"],[1,"d-flex","flex-row","align-items-baseline","justify-content-between"],[1,"settings-header",3,"click"],[1,"ms-4",3,"ngModelChange","ngModel"],["ngDefaultControl","",3,"ngModelChange","modelChange","ngModel","modelValue","title"],[1,"ms-1"],[3,"ngModelChange","ngModel"],["color","primary","value","static",1,"me-3"],["color","primary","value","dynamic"],[1,"form-container"],[1,"d-flex","flex-row"],["multiple","",3,"ngModelChange","ngModel"],[3,"value"],[1,"me-2","amount-field"],["matInput","",3,"ngModelChange","pattern","ngModel"],[1,"mt-2"],[1,"ms-auto","mt-2",3,"matTooltipDisabled","matTooltipPosition","matTooltip"],["color","primary","mat-flat-button","",1,"ms-auto",3,"click","disabled"],[1,"date-field"],["matInput","",3,"ngModelChange","ngModel","pattern"],["color","primary",3,"ngModelChange","ngModel"]],template:function(i,n){i&1&&v(0,sp,73,74,"div",6),i&2&&I(n.currentConfiguration?0:-1)},dependencies:[D,N,V,He,We,Vt,on,lt,st,Bt,Gt,Pt,Ti,Ei,ko,Bo,Fo,yi,li,at,nt,ye,ho,ot,Ne,O,Ae,Jr,R],styles:[".period-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:1.5rem}.amount-field[_ngcontent-%COMP%]{width:100px}.date-field[_ngcontent-%COMP%]{width:100%}.settings-header[_ngcontent-%COMP%]{margin-top:.75rem;margin-bottom:.75rem;font-size:1.25rem;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.settings-card[_ngcontent-%COMP%]{padding:.5rem 1.5rem}"],data:{animation:[Wt]}})}}return t})();function lp(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function pp(t,c){if(t&1){let e=T();a(0,"app-expiration-settings",3),C("saveAttribute",function(n){f(e);let l=p();return h(l.saveExpirationAttribute(n))}),r()}if(t&2){let e=p();_("expirationAttribute",e.expirationAttribute)}}var ts=(()=>{class t{constructor(e,i,n,l,E){this.attributesManager=e,this.translate=i,this.notificator=n,this.apiRequest=l,this.entityStorageService=E,this.loading=!1,this.translate.get("VO_DETAIL.SETTINGS.EXPIRATION.SUCCESS_MESSAGE").subscribe(x=>this.successMessage=x),this.translate.get("VO_DETAIL.SETTINGS.EXPIRATION.ERROR_MESSAGE").subscribe(x=>this.errorMessage=x)}ngOnInit(){this.loading=!0,this.vo=this.entityStorageService.getEntity(),this.loadSettings()}saveExpirationAttribute(e){this.loading=!0,this.apiRequest.dontHandleErrorForNext(),this.attributesManager.setVoAttribute({vo:this.vo.id,attribute:e}).subscribe({next:()=>{this.loadSettings(),this.notificator.showSuccess(this.successMessage),this.loading=!1},error:i=>{this.notificator.showRPCError(i,this.errorMessage),this.loading=!1}})}loadSettings(){this.loading=!0,this.attributesManager.getVoAttributeByName(this.vo.id,Re.VO_DEF_EXPIRATION_RULES).subscribe(e=>{this.expirationAttribute=e,this.loading=!1})}static{this.\u0275fac=function(i){return new(i||t)(u(ut),u(X),u(j),u(pt),u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-settings-expiration"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:4,vars:2,consts:[["spinner",""],[1,"position-relative"],[3,"expirationAttribute","saveAttribute",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"saveAttribute","expirationAttribute"]],template:function(i,n){if(i&1&&(A(0,lp,1,0,"ng-template",null,0,L),a(2,"div",1),A(3,pp,1,1,"app-expiration-settings",2),r()),i&2){let l=y(1);o(3),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,P,On,Q],encapsulation:2,data:{animation:[Wt]}})}}return t})();var is=(()=>{class t{constructor(e,i,n,l){this.dialog=e,this.voService=i,this.guiAuthResolver=n,this.entityStorageService=l,this.availableRoles=[],this.type="Vo",this.theme="vo-theme"}ngOnInit(){this.vo=this.entityStorageService.getEntity(),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Vo")}static{this.\u0275fac=function(i){return new(i||t)(u(q),u(de),u(k),u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-settings-managers"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:1,vars:4,consts:[[3,"complementaryObject","availableRoles","complementaryObjectType","theme"]],template:function(i,n){i&1&&S(0,"app-managers-page",0),i&2&&_("complementaryObject",n.vo)("availableRoles",n.availableRoles)("complementaryObjectType",n.type)("theme",n.theme)},dependencies:[D,bn],encapsulation:2})}}return t})();function cp(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function dp(t,c){t&1&&(a(0,"perun-web-apps-alert",4),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"DIALOGS.RE_SEND_NOTIFICATION.EMPTY_TYPES_ALERT")," "))}function mp(t,c){if(t&1&&(a(0,"mat-option",7),s(1),d(2,"translate"),r()),t&2){let e=c.$implicit;_("value",e),o(),g(" ",m(2,2,"DIALOGS.RE_SEND_NOTIFICATION.NOTIFICATION_TYPE."+e)," ")}}function up(t,c){if(t&1){let e=T();a(0,"div"),s(1),d(2,"translate"),a(3,"mat-form-field",5)(4,"textarea",12),le("ngModelChange",function(n){f(e);let l=p(2);return se(l.reason,n)||(l.reason=n),h(n)}),r()()()}if(t&2){let e=p(2);o(),g(" ",m(2,2,"DIALOGS.RE_SEND_NOTIFICATION.REASON"),": "),o(3),re("ngModel",e.reason)}}function _p(t,c){if(t&1){let e=T();a(0,"div")(1,"h1",2),s(2),d(3,"translate"),r(),a(4,"div",3),v(5,dp,3,3,"perun-web-apps-alert",4),s(6),d(7,"translate"),a(8,"mat-form-field",5)(9,"mat-select",6),le("valueChange",function(n){f(e);let l=p();return se(l.mailType,n)||(l.mailType=n),h(n)}),Ce(10,mp,3,4,"mat-option",7,Oe),r()(),v(12,up,5,4,"div"),r(),a(13,"div",8)(14,"button",9),C("click",function(){f(e);let n=p();return h(n.onCancel())}),s(15),d(16,"translate"),r(),a(17,"span",10),d(18,"translate"),a(19,"button",11),C("click",function(){f(e);let n=p();return h(n.onSubmit())}),s(20),d(21,"translate"),r()()()()}if(t&2){let e=p();o(2),b(m(3,10,"DIALOGS.RE_SEND_NOTIFICATION.TITLE")),o(3),I(!e.loading&&e.displayedMailTypes.length===0?5:-1),o(),g(" ",m(7,12,"DIALOGS.RE_SEND_NOTIFICATION.SELECT"),": "),o(3),re("value",e.mailType),o(),Se(e.displayedMailTypes),o(2),I(e.mailType==="APP_REJECTED_USER"?12:-1),o(3),g(" ",m(16,14,"DIALOGS.RE_SEND_NOTIFICATION.CANCEL")," "),o(2),_("matTooltip",m(18,16,"DIALOGS.RE_SEND_NOTIFICATION.EMPTY_TYPES_TOOLTIP"))("matTooltipDisabled",e.loading||e.displayedMailTypes.length>0),o(2),_("disabled",e.loading||e.displayedMailTypes.length===0),o(),g(" ",m(21,18,"DIALOGS.RE_SEND_NOTIFICATION.SEND")," ")}}var ns=(()=>{class t{constructor(e,i,n,l,E){this.dialogRef=e,this.data=i,this.translate=n,this.notificator=l,this.registrarManager=E,this.reason="",this.loading=!1,this.availableMailTypes=[gt.APP_CREATED_USER,gt.APPROVABLE_GROUP_APP_USER,gt.APP_CREATED_VO_ADMIN,gt.MAIL_VALIDATION,gt.APP_APPROVED_USER,gt.APP_REJECTED_USER,gt.APP_ERROR_VO_ADMIN],this.displayedMailTypes=[]}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.data.groupId?this.registrarManager.getApplicationMailsForGroup(this.data.groupId).subscribe({next:e=>{e.map(i=>{i.send&&i.appType===this.data.appType&&this.availableMailTypes.includes(i.mailType)&&this.displayedMailTypes.push(i.mailType)}),this.displayedMailTypes.length>0&&(this.mailType=this.displayedMailTypes.sort()[0]),this.loading=!1},error:()=>{this.loading=!1}}):this.registrarManager.getApplicationMailsForVo(this.data.voId).subscribe({next:e=>{e.map(i=>{i.send&&i.appType===this.data.appType&&this.availableMailTypes.includes(i.mailType)&&this.displayedMailTypes.push(i.mailType)}),this.displayedMailTypes.length>0&&(this.mailType=this.displayedMailTypes.sort()[0]),this.loading=!1},error:()=>{this.loading=!1}})}onCancel(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.mailType===gt.APP_REJECTED_USER?this.registrarManager.sendMessage({appId:this.data.applicationId,mailType:this.mailType,reason:this.reason}).subscribe({next:()=>{this.translate.get("DIALOGS.RE_SEND_NOTIFICATION.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close()})},error:()=>this.loading=!1}):this.registrarManager.sendMessage({appId:this.data.applicationId,mailType:this.mailType}).subscribe({next:()=>{this.translate.get("DIALOGS.RE_SEND_NOTIFICATION.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close()})},error:()=>this.loading=!1})}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(X),u(j),u(Ie))}}static{this.\u0275cmp=M({type:t,selectors:[["app-application-re-send-notification-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],["alert_type","warn"],[1,"w-100"],["disableOptionCentering","",3,"valueChange","value"],[3,"value"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],[3,"matTooltip","matTooltipDisabled"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"],["matInput","",3,"ngModelChange","ngModel"]],template:function(i,n){if(i&1&&(A(0,cp,1,0,"ng-template",null,0,L),a(2,"div"),A(3,_p,22,20,"div",1),r()),i&2){let l=y(1);o(2),ce(pe("",n.theme," position-relative")),o(),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,He,We,lt,st,Bt,Gt,Pt,at,nt,ye,ot,Ne,oe,te,ne,ie,$e,ze,ue,O,Ae,P,R],encapsulation:2})}}return t})();function gp(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function fp(t,c){if(t&1){let e=T();a(0,"div")(1,"h1",2),s(2),d(3,"translate"),r(),a(4,"div",3),s(5),d(6,"translate"),a(7,"mat-form-field",4)(8,"textarea",5),le("ngModelChange",function(n){f(e);let l=p();return se(l.reason,n)||(l.reason=n),h(n)}),r()()(),a(9,"div",6)(10,"button",7),C("click",function(){f(e);let n=p();return h(n.onCancel())}),s(11),d(12,"translate"),r(),a(13,"button",8),C("click",function(){f(e);let n=p();return h(n.onSubmit())}),s(14),d(15,"translate"),r()()()}if(t&2){let e=p();o(2),b(m(3,6,"DIALOGS.REJECT_APPLICATION.TITLE")),o(3),g(" ",m(6,8,"DIALOGS.REJECT_APPLICATION.TEXT")," "),o(3),re("ngModel",e.reason),o(3),g(" ",m(12,10,"DIALOGS.REJECT_APPLICATION.CANCEL")," "),o(2),_("disabled",e.loading),o(),g(" ",m(15,12,"DIALOGS.REJECT_APPLICATION.SUBMIT")," ")}}var os=(()=>{class t{constructor(e,i,n,l,E){this.dialogRef=e,this.data=i,this.translate=n,this.notificator=l,this.registrarManager=E,this.reason="",this.loading=!1}ngOnInit(){this.theme=this.data.theme}onCancel(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.registrarManager.rejectApplication(this.data.applicationId,this.reason).subscribe(()=>{this.translate.get("DIALOGS.REJECT_APPLICATION.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close()})},()=>this.loading=!1)}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(X),u(j),u(Ie))}}static{this.\u0275cmp=M({type:t,selectors:[["app-application-reject-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"w-100"],["matInput","",3,"ngModelChange","ngModel"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(i,n){if(i&1&&(A(0,gp,1,0,"ng-template",null,0,L),a(2,"div"),A(3,fp,16,14,"div",1),r()),i&2){let l=y(1);o(2),ce(pe("",n.theme," position-relative")),o(),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,He,We,lt,st,at,nt,ye,ot,Ne,oe,te,ne,ie,ue,O,P,R],encapsulation:2})}}return t})();function hp(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function vp(t,c){t&1&&(a(0,"mat-error"),s(1),d(2,"translate"),r()),t&2&&(o(),b(m(2,1,"DIALOGS.EDIT_APPLICATION_FORM_ITEM_DATA.INVALID_EMAIL")))}function Ip(t,c){if(t&1&&(a(0,"mat-form-field")(1,"mat-label"),s(2),r(),S(3,"input",7),v(4,vp,3,3,"mat-error"),r()),t&2){let e=p(2);o(2),b(e.itemName),o(),_("formControl",e.emailControl),o(),I(e.emailControl.invalid?4:-1)}}function Cp(t,c){t&1&&(a(0,"mat-error"),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"DIALOGS.EDIT_APPLICATION_FORM_ITEM_DATA.EMPTY_INPUT")))}function Sp(t,c){if(t&1&&(a(0,"mat-form-field")(1,"mat-label"),s(2),r(),S(3,"input",8),v(4,Cp,3,3,"mat-error"),r()),t&2){let e=p(2);o(2),b(e.itemName),o(),_("formControl",e.inputControl),o(),I(e.inputControl.invalid?4:-1)}}function Ep(t,c){if(t&1){let e=T();a(0,"div")(1,"h1",2),s(2),d(3,"translate"),r(),a(4,"div",3),v(5,Ip,5,3,"mat-form-field"),v(6,Sp,5,3,"mat-form-field"),r(),a(7,"div",4)(8,"button",5),C("click",function(){f(e);let n=p();return h(n.onCancel())}),s(9),d(10,"translate"),r(),a(11,"button",6),C("click",function(){f(e);let n=p();return h(n.onSubmit())}),s(12),d(13,"translate"),r()()()}if(t&2){let e=p();o(2),be(" ",m(3,7,"DIALOGS.EDIT_APPLICATION_FORM_ITEM_DATA.TITLE")," ",e.itemName," "),o(3),I(e.emailControl!==null?5:-1),o(),I(e.inputControl!==null?6:-1),o(3),g(" ",m(10,9,"DIALOGS.EDIT_APPLICATION_FORM_ITEM_DATA.CANCEL")," "),o(2),_("disabled",e.loading||e.inputControl!==null&&e.inputControl.invalid||e.emailControl!==null&&e.emailControl.invalid),o(),g(" ",m(13,11,"DIALOGS.EDIT_APPLICATION_FORM_ITEM_DATA.SUBMIT")," ")}}var as=(()=>{class t{constructor(e,i,n,l,E){this.dialogRef=e,this.data=i,this.notificator=n,this.translateService=l,this.registrarService=E,this.loading=!1,this.inputControl=null,this.emailControl=null}static getLabel(e){return e.i18n.en.label!==null&&e.i18n.en.label.length!==0?e.i18n.en.label:e.shortname}ngOnInit(){this.theme=this.data.theme,this.formItemData=this.data.formItemData,this.itemName=t.getLabel(this.formItemData.formItem),this.itemName.toLowerCase().includes("mail")?this.emailControl=new $n(this.formItemData.value,[dt.required,dt.pattern(pn)]):this.inputControl=new $n(this.formItemData.value,[dt.required])}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.formItemData.value=this.inputControl!==null?this.inputControl.value:this.emailControl.value;let e={id:this.formItemData.id,formItem:this.formItemData.formItem,shortname:this.formItemData.shortname,value:this.formItemData.value,assuranceLevel:this.formItemData.assuranceLevel,prefilledValue:this.formItemData.prefilledValue};this.registrarService.updateFormItemData({appId:this.data.applicationId,data:e}).subscribe(()=>{this.notificator.showSuccess(this.translateService.instant("DIALOGS.EDIT_APPLICATION_FORM_ITEM_DATA.SUCCESS")),this.dialogRef.close(!0)},()=>this.loading=!1)}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(j),u(X),u(Ie))}}static{this.\u0275cmp=M({type:t,selectors:[["app-edit-application-form-item-data-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"],["matInput","","required","",3,"formControl"],["matInput","","required","","type","text",3,"formControl"]],template:function(i,n){if(i&1&&(A(0,hp,1,0,"ng-template",null,0,L),a(2,"div"),A(3,Ep,14,13,"div",1),r()),i&2){let l=y(1);o(2),ce(pe("",n.theme," position-relative")),o(),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,He,We,Vt,bi,lt,st,Ne,nt,ye,Si,Qt,oe,te,ne,ie,ue,O,P,R],encapsulation:2})}}return t})();var rs=(t,c,e)=>["/organizations",t,"groups",c,"invitations",e];function Tp(t,c){if(t&1&&(a(0,"span",1),s(1),r()),t&2){let e=p();o(),g(" #",e.application.id," ")}}function bp(t,c){t&1&&S(0,"mat-spinner",3)}function Ap(t,c){if(t&1){let e=T();a(0,"button",13),C("click",function(){f(e);let n=p(2);return h(n.verifyApplication())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.VERIFY")," "))}function xp(t,c){if(t&1){let e=T();a(0,"button",13),C("click",function(){f(e);let n=p(2);return h(n.approveApplication())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.APPROVE")," "))}function Mp(t,c){if(t&1){let e=T();a(0,"button",14),C("click",function(){f(e);let n=p(2);return h(n.rejectApplication())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.REJECT")," "))}function Dp(t,c){if(t&1){let e=T();a(0,"button",14),C("click",function(){f(e);let n=p(2);return h(n.deleteApplication())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.DELETE")," "))}function Rp(t,c){if(t&1){let e=T();a(0,"button",15),C("click",function(){f(e);let n=p(2);return h(n.resendNotification())}),a(1,"i",16),s(2," mail_outline "),r(),s(3),d(4,"translate"),r()}t&2&&(o(3),g(" ",m(4,1,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.SEND_NOTIFICATION")," "))}function Op(t,c){if(t&1&&(a(0,"div")(1,"span",7),s(2),d(3,"translate"),r(),s(4),r()),t&2){let e=p(2);o(2),b(m(3,2,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.APPLICATION_FOR_VO")),o(2),g(": ",e.application.vo.name," ")}}function yp(t,c){if(t&1&&(a(0,"div")(1,"span",7),s(2),d(3,"translate"),r(),s(4),a(5,"span",7),s(6),d(7,"translate"),r(),s(8),r()),t&2){let e=p(2);o(2),b(m(3,4,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.APPLICATION_FOR_GROUP")),o(2),g(": ",e.application.group.name," "),o(2),b(m(7,6,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.APPLICATION_IN_VO")),o(2),g(": ",e.application.vo.name," ")}}function Np(t,c){t&1&&(a(0,"span")(1,"mat-icon",17),s(2,"arrow_right_alt"),r(),s(3," Initial "),r())}function wp(t,c){t&1&&(a(0,"span")(1,"mat-icon",17),s(2,"restore"),r(),s(3," Extension "),r())}function Lp(t,c){t&1&&(a(0,"span")(1,"mat-icon",17),s(2,"nat"),r(),s(3," Embedded "),r())}function Vp(t,c){if(t&1&&(a(0,"div",9)(1,"mat-card-title")(2,"i",18),s(3,"done"),r(),a(4,"a",19),s(5),d(6,"translate"),r()(),a(7,"div")(8,"span",7),s(9),d(10,"translate"),r(),s(11),r(),a(12,"div")(13,"span",7),s(14),d(15,"translate"),r(),s(16),d(17,"date"),r()()),t&2){let e=p(2);o(4),_("routerLink",hi(16,rs,e.application.vo.id,e.application.group.id,e.invitation.id))("perunWebAppsMiddleClickRouterLink",hi(20,rs,e.application.vo.id.toString(),e.application.group.id.toString(),e.invitation.id.toString())),o(),b(m(6,7,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.PREAPPROVED")),o(4),b(m(10,9,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.SENDER")),o(2),g(": ",e.invitation.senderName," "),o(3),b(m(15,11,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.DATE")),o(2),g(": ",it(17,13,e.application.modifiedAt,"d.M.y H:mm:ss")," ")}}function Pp(t,c){if(t&1&&(a(0,"div",9)(1,"mat-card-title")(2,"i",20),s(3,"clear"),r(),s(4),d(5,"translate"),d(6,"modifiedName"),r(),a(7,"div")(8,"span",7),s(9),d(10,"translate"),r(),s(11),d(12,"date"),r()()),t&2){let e=p(2);o(4),be(" ",m(5,4,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.REJECTED_BY"),": ",m(6,6,e.application.modifiedByDisplayName)),o(5),b(m(10,8,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.DATE")),o(2),g(": ",it(12,10,e.application.modifiedAt,"d.M.y H:mm:ss")," ")}}function Gp(t,c){if(t&1&&(a(0,"div",9)(1,"mat-card-title")(2,"i",18),s(3,"done"),r(),s(4),d(5,"translate"),d(6,"modifiedName"),r(),a(7,"div")(8,"span",7),s(9),d(10,"translate"),r(),s(11),d(12,"date"),r()()),t&2){let e=p(2);o(4),be(" ",m(5,4,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.APPROVED_BY"),": ",m(6,6,e.application.modifiedByDisplayName)),o(5),b(m(10,8,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.DATE")),o(2),g(": ",it(12,10,e.application.modifiedAt,"d.M.y H:mm:ss")," ")}}function Bp(t,c){if(t&1&&(a(0,"div",9)(1,"h5",7)(2,"i",21),s(3,"warning"),r(),s(4),d(5,"translate"),r(),a(6,"div"),s(7),r()()),t&2){let e=p(2);o(4),g(" ",m(5,2,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.AUTO_APPROVE_FAILURE"),": "),o(3),b(e.application.autoApproveError)}}function Fp(t,c){if(t&1&&(a(0,"div")(1,"span",7),s(2),d(3,"translate"),r(),s(4),r()),t&2){let e=p(2);o(2),b(m(3,2,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.MAIL")),o(2),g(": ",e.userMail," ")}}function kp(t,c){t&1&&S(0,"th",29)}function Up(t,c){if(t&1&&(a(0,"td",30),s(1),d(2,"getLabel"),r()),t&2){let e=c.$implicit;o(),g(" ",m(2,1,e.formItem)," ")}}function jp(t,c){t&1&&S(0,"th",29)}function Wp(t,c){if(t&1){let e=T();a(0,"button",34),d(1,"translate"),C("click",function(){f(e);let n=p().$implicit,l=p(3);return h(l.editApplicationData(n))}),a(2,"mat-icon"),s(3,"edit"),r()()}t&2&&_("matTooltip",Y(m(1,2,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.EDIT")))}function Hp(t,c){if(t&1&&(a(0,"td",31)(1,"div",32),s(2),v(3,Wp,4,4,"button",33),r()()),t&2){let e=c.$implicit,i=p(3);o(2),g(" ",e.value," "),o(),I((i.application.state==="NEW"||i.application.state==="VERIFIED")&&e.formItem.type!=="EMBEDDED_GROUP_APPLICATION"?3:-1)}}function zp(t,c){t&1&&S(0,"tr",35)}function $p(t,c){t&1&&S(0,"tr",36)}function Yp(t,c){if(t&1&&(a(0,"table",12),fe(1,22),A(2,kp,1,0,"th",23)(3,Up,3,3,"td",24),he(),fe(4,25),A(5,jp,1,0,"th",23)(6,Hp,4,2,"td",26),he(),A(7,zp,1,0,"tr",27)(8,$p,1,0,"tr",28),r()),t&2){let e=p(2);_("dataSource",e.dataSource),o(7),_("matHeaderRowDef",e.displayedColumns),o(),_("matRowDefColumns",e.displayedColumns)}}function Xp(t,c){if(t&1&&(a(0,"div"),v(1,Ap,3,3,"button",4),v(2,xp,3,3,"button",4),v(3,Mp,3,3,"button",5),v(4,Dp,3,3,"button",5),v(5,Rp,5,3,"button",6),v(6,Op,5,4,"div"),v(7,yp,9,8,"div"),a(8,"div")(9,"span",7),s(10),d(11,"translate"),r(),s(12,": "),S(13,"span",8),d(14,"applicationState"),r(),a(15,"div")(16,"span",7),s(17),d(18,"translate"),r(),s(19,": "),v(20,Np,4,0,"span"),v(21,wp,4,0,"span"),v(22,Lp,4,0,"span"),r(),v(23,Vp,18,24,"div",9),v(24,Pp,13,13,"div",9),v(25,Gp,13,13,"div",9),v(26,Bp,8,4,"div",9),a(27,"div",10)(28,"mat-card-title")(29,"i",11),s(30,"redo"),r(),s(31),d(32,"translate"),d(33,"userFullName"),r(),v(34,Fp,5,4,"div"),a(35,"div")(36,"span",7),d(37,"lowercase"),s(38),d(39,"translate"),r(),s(40),r(),a(41,"div")(42,"span",7),s(43),d(44,"translate"),r(),s(45),r(),a(46,"div")(47,"span",7),s(48),d(49,"translate"),r(),s(50),d(51,"date"),r(),v(52,Yp,9,3,"table",12),r()()),t&2){let e=p();o(),I(e.application.state==="NEW"&&e.verifyAuth?1:-1),o(),I((e.application.state==="VERIFIED"||e.application.state==="NEW")&&e.approveAuth?2:-1),o(),I((e.application.state==="VERIFIED"||e.application.state==="NEW")&&e.rejectAuth?3:-1),o(),I((e.application.state==="REJECTED"||e.application.state==="NEW")&&e.deleteAuth?4:-1),o(),I(e.resendAuth?5:-1),o(),I(e.application.group?-1:6),o(),I(e.application.group?7:-1),o(3),b(m(11,29,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.STATE")),o(3),_("outerHTML",m(14,31,e.application.state),Dt),o(4),b(m(18,33,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.TYPE")),o(3),I(e.application.type==="INITIAL"?20:-1),o(),I(e.application.type==="EXTENSION"?21:-1),o(),I(e.application.type==="EMBEDDED"?22:-1),o(),I(e.invitation&&e.application.state==="APPROVED"?23:-1),o(),I(e.application.state==="REJECTED"?24:-1),o(),I(e.application.state==="APPROVED"&&!e.invitation?25:-1),o(),I(e.application.state!=="APPROVED"&&e.application.state!=="REJECTED"&&e.application.autoApproveError?26:-1),o(5),be(" ",m(32,35,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.SUBMITTED_BY"),": ",e.application.user===null?e.application.createdBy.slice(e.application.createdBy.lastIndexOf("=")+1,e.application.createdBy.length):m(33,37,e.application.user)),o(3),I(e.userMail?34:-1),o(2),gi("data-cy",pe("",m(37,39,e.application.extSourceName),"-application-extsource")),o(2),b(m(39,41,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.EXT_SRC")),o(2),g(": ",e.application.extSourceName," "),o(3),b(m(44,43,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.LOA")),o(2),g(": ",e.application.extSourceLoa," "),o(3),b(m(49,45,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.DATE")),o(2),g(": ",it(51,47,e.application.createdAt,"d.M.y H:mm:ss")," "),o(2),I(e.userData.length!==0?52:-1)}}var yn=(()=>{class t{constructor(e,i,n,l,E,x,w,U,_e,tt,Ht){this.registrarManager=e,this.invitationsManager=i,this.dialog=n,this.translate=l,this.route=E,this.notificator=x,this.router=w,this.authResolver=U,this.usersService=_e,this.membersService=tt,this.apiRequest=Ht,this.userData=[],this.displayedColumns=["label","value"],this.loading=!0,this.invitation=null}ngOnInit(){this.loading=!0,this.route.params.subscribe(e=>{this.route.parent.params.subscribe(i=>{i.groupId?this.dialogTheme="group-theme":i.memberId?this.dialogTheme="member-theme":this.dialogTheme="vo-theme";let n=Number(e.applicationId);this.registrarManager.getApplicationById(n).subscribe(l=>{this.application=l,this.application.type==="EMBEDDED"&&this.application.user?this.usersService.getRichUserWithAttributes(this.application.user.id).subscribe(E=>{let x=E.userAttributes.find(w=>w.friendlyName==="preferredMail");this.userMail=x?.value,this.setAuthRights(),this.loading=!1}):this.registrarManager.getApplicationDataById(this.application.id).subscribe(E=>{this.userData=E,this.dataSource=new Qe(this.userData),this.setAuthRights(),this.application.group&&this.application.state==="APPROVED"?this.invitationsManager.getInvitationWithSenderByApplication(this.application.id).subscribe({next:x=>{this.invitation=x,this.loading=!1},error:()=>{this.loading=!1}}):this.loading=!1})})})})}setAuthRights(){this.dialogTheme==="group-theme"?(this.verifyAuth=this.authResolver.isAuthorized("group-verifyApplication_int_policy",[this.application.group]),this.approveAuth=this.authResolver.isAuthorized("group-approveApplicationInternal_int_policy",[this.application.group]),this.rejectAuth=this.authResolver.isAuthorized("group-rejectApplication_int_String_policy",[this.application.group]),this.deleteAuth=this.authResolver.isAuthorized("group-deleteApplication_Application_policy",[this.application.group]),this.resendAuth=this.authResolver.isAuthorized("group-sendMessage_Application_MailType_String_policy",[this.application.group])):(this.verifyAuth=this.authResolver.isAuthorized("vo-verifyApplication_int_policy",[this.application.vo]),this.approveAuth=this.authResolver.isAuthorized("vo-approveApplicationInternal_int_policy",[this.application.vo]),this.rejectAuth=this.authResolver.isAuthorized("vo-rejectApplication_int_String_policy",[this.application.vo]),this.deleteAuth=this.authResolver.isAuthorized("vo-deleteApplication_Application_policy",[this.application.vo]),this.resendAuth=this.authResolver.isAuthorized("vo-sendMessage_Application_MailType_String_policy",[this.application.vo]))}resendNotification(){let e=G();e.width="500px",e.data={applicationId:this.application.id,theme:this.dialogTheme,appType:this.application.type,voId:this.application.vo.id,groupId:this.application.group?.id},this.dialog.open(ns,e)}deleteApplication(){let e=G();e.width="450px",e.data={items:[this.application.id],title:"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.DELETE_APPLICATION_TITLE",description:"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.DELETE_APPLICATION_DESCRIPTION",theme:"vo-theme",type:"remove",showAsk:!0},this.dialog.open(Ut,e).afterClosed().subscribe(n=>{n&&this.registrarManager.deleteApplication(this.application.id).subscribe(()=>{this.translate.get("VO_DETAIL.APPLICATION.APPLICATION_DETAIL.DELETE_MESSAGE").subscribe(l=>{this.notificator.showSuccess(l),this.router.navigateByUrl(this.router.url.substring(0,this.router.url.lastIndexOf("/")))})})})}rejectApplication(){let e=G();e.width="500px",e.data={applicationId:this.application.id,theme:this.dialogTheme},this.dialog.open(os,e).afterClosed().subscribe(()=>{this.loading=!0,this.registrarManager.getApplicationById(this.application.id).subscribe({next:n=>{this.application=n,this.loading=!1},error:()=>this.loading=!1})})}approveApplication(){this.loading=!0,this.apiRequest.dontHandleErrorForNext(),this.registrarManager.canBeApproved(this.application.id).subscribe({next:()=>{this.approveApplicationCall()},error:e=>{if(this.loading=!1,e.name==="CantBeApprovedException"){let i=G();i.width="600px",i.data={err:e,theme:this.dialogTheme,application:this.application},this.dialog.open(tr,i).afterClosed().subscribe(l=>{l&&(this.loading=!0,this.registrarManager.getApplicationById(this.application.id).subscribe({next:E=>{this.application=E,this.loading=!1},error:()=>this.loading=!1}))})}else this.notificator.showRPCError(e)}})}approveApplicationCall(){this.loading=!0,this.registrarManager.approveApplication(this.application.id).subscribe({next:()=>{this.translate.get("VO_DETAIL.APPLICATION.APPLICATION_DETAIL.APPROVE_MESSAGE").subscribe(e=>{this.notificator.showSuccess(e)}),this.registrarManager.getApplicationById(this.application.id).subscribe({next:e=>{this.application=e,this.loading=!1},error:()=>this.loading=!1})},error:()=>this.loading=!1})}verifyApplication(){this.registrarManager.verifyApplication(this.application.id).subscribe(()=>{this.translate.get("VO_DETAIL.APPLICATION.APPLICATION_DETAIL.VERIFY_MESSAGE").subscribe(e=>{this.notificator.showSuccess(e)}),this.loading=!0,this.registrarManager.getApplicationById(this.application.id).subscribe({next:e=>{this.application=e,this.loading=!1},error:()=>this.loading=!1})})}editApplicationData(e){let i=G();i.width="600px",i.data={theme:this.dialogTheme,applicationId:this.application.id,formItemData:e},this.dialog.open(as,i)}static{this.\u0275fac=function(i){return new(i||t)(u(Ie),u(St),u(q),u(X),u(ve),u(j),u(rt),u(k),u(ti),u(Ye),u(pt))}}static{this.\u0275cmp=M({type:t,selectors:[["app-application-detail"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:7,vars:6,consts:[[1,"page-subtitle"],[1,"text-muted"],[1,"mb-4"],[1,"ms-auto","me-auto"],["color","accent","mat-flat-button","",1,"me-2"],["color","warn","mat-flat-button","",1,"me-2"],["mat-stroked-button","",1,"me-2"],[1,"fw-bold"],[3,"outerHTML"],[1,"card","p-3","mt-2"],[1,"card","p-4","mt-2"],[1,"material-icons","align-text-top"],["mat-table","",1,"w-100",3,"dataSource"],["color","accent","mat-flat-button","",1,"me-2",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click"],["mat-stroked-button","",1,"me-2",3,"click"],[1,"material-icons"],[1,"align-bottom"],[1,"material-icons","green","align-text-top"],[1,"group-link",3,"routerLink","perunWebAppsMiddleClickRouterLink"],[1,"material-icons","red","align-text-top"],[1,"material-icons","orange"],["matColumnDef","label"],["mat-header-cell","",4,"matHeaderCellDef"],["class","fw-bold","mat-cell","",4,"matCellDef"],["matColumnDef","value"],["class","word-break-all","mat-cell","",4,"matCellDef"],["class","h-50","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"fw-bold"],["mat-cell","",1,"word-break-all"],[1,"d-flex","align-items-center"],["aria-label","Edit Application data","mat-icon-button","",3,"matTooltip"],["aria-label","Edit Application data","mat-icon-button","",3,"click","matTooltip"],["mat-header-row","",1,"h-50"],["mat-row",""]],template:function(i,n){i&1&&(a(0,"h2",0),s(1),d(2,"translate"),v(3,Tp,2,1,"span",1),r(),S(4,"mat-divider",2),v(5,bp,1,0,"mat-spinner",3),v(6,Xp,53,50,"div")),i&2&&(o(),g(" ",m(2,4,"VO_DETAIL.APPLICATION.APPLICATION_DETAIL.TITLE")," "),o(2),I(n.application?3:-1),o(2),I(n.loading?5:-1),o(),I(n.loading?-1:6))},dependencies:[D,N,V,Ft,et,Je,Ct,It,vt,Mi,ni,ii,je,Le,Pe,Ke,Ge,Ve,ke,Be,Fe,Ze,Ue,De,Me,O,Ae,po,Qi,R,la,sa,kt,oa],encapsulation:2})}}return t})();var ss=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=M({type:t,selectors:[["app-group-settings"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:1,vars:0,template:function(i,n){i&1&&S(0,"app-animated-router-outlet")},dependencies:[D,xt],encapsulation:2,data:{animation:[bt]}})}}return t})();function qp(t,c){t&1&&(s(0),d(1,"translate")),t&2&&g(" ",m(1,1,"GROUP_DETAIL.ENTITY")," ")}function Kp(t,c){if(t&1&&S(0,"app-one-entity-attribute-page",4),t&2){let e=p();_("entityId",e.group.id)("entity","group")}}function Zp(t,c){t&1&&(s(0),d(1,"translate"),d(2,"translate")),t&2&&be(" ",m(1,2,"GROUP_DETAIL.ENTITY")," - ",m(2,4,"MEMBER_DETAIL.ENTITY")," ")}function Qp(t,c){if(t&1&&S(0,"app-two-entity-attribute-page",5),t&2){let e=p(2);_("firstEntity","group")("firstEntityId",e.group.id)("secondEntity","member")}}function Jp(t,c){t&1&&(a(0,"mat-tab"),A(1,Zp,3,6,"ng-template",2)(2,Qp,1,3,"ng-template",3),r())}function ec(t,c){t&1&&(s(0),d(1,"translate"),d(2,"translate")),t&2&&be(" ",m(1,2,"GROUP_DETAIL.ENTITY")," - ",m(2,4,"RESOURCE_DETAIL.ENTITY")," ")}function tc(t,c){if(t&1&&S(0,"app-two-entity-attribute-page",5),t&2){let e=p(2);_("firstEntity","group")("firstEntityId",e.group.id)("secondEntity","resource")}}function ic(t,c){t&1&&(a(0,"mat-tab"),A(1,ec,3,6,"ng-template",2)(2,tc,1,3,"ng-template",3),r())}var ls=(()=>{class t{constructor(e,i){this.authResolver=e,this.entityStorageService=i}ngOnInit(){this.group=this.entityStorageService.getEntity(),this.groupResourceAttAuth=this.authResolver.isAuthorized("getResourceAssignments_Group_policy",[this.group]),this.groupMemberAttAuth=this.authResolver.isAuthorized("getCompleteRichMembers_Group_List<String>_List<String>_List<String>_boolean_policy",[this.group])}static{this.\u0275fac=function(i){return new(i||t)(u(k),u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-group-attributes"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:10,vars:5,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false"],["matTabLabel",""],["matTabContent",""],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(i,n){i&1&&(a(0,"div")(1,"h1",0),s(2),d(3,"translate"),r(),a(4,"mat-tab-group",1)(5,"mat-tab"),A(6,qp,2,3,"ng-template",2)(7,Kp,1,2,"ng-template",3),r(),v(8,Jp,3,0,"mat-tab"),v(9,ic,3,0,"mat-tab"),r()()),i&2&&(o(2),b(m(3,3,"GROUP_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),o(6),I(n.groupMemberAttAuth?8:-1),o(),I(n.groupResourceAttAuth?9:-1))},dependencies:[D,Bi,An,si,Oi,oi,ai,ri,O,R],encapsulation:2})}}return t})();function nc(t,c){t&1&&S(0,"mat-spinner",0)}function oc(t,c){if(t&1&&(a(0,"div"),S(1,"perun-web-apps-menu-buttons-field",1),r()),t&2){let e=p();o(),_("items",e.items)}}var ps=(()=>{class t{constructor(e,i,n,l,E,x,w,U,_e){this.sideMenuService=e,this.groupService=i,this.router=n,this.guiAuthResolver=l,this.apiRequest=E,this.attributesManager=x,this.notificator=w,this.entityStorageService=U,this.routePolicyService=_e,this.items=[],this.loading=!1}ngOnInit(){this.loading=!0,this.group=this.entityStorageService.getEntity(),this.initItems()}initItems(){this.items=[],this.apiRequest.dontHandleErrorForNext(),this.attributesManager.getGroupAttributeByName(this.group.id,Re.GROUP_DEF_EXPIRATION_RULES).subscribe({next:()=>{this.items.push({cssIcon:"perun-group",url:`/organizations/${this.group.voId}/groups/${this.group.id}/settings/expiration`,label:"MENU_ITEMS.GROUP.EXPIRATION",style:"group-btn"}),this.loading=!1},error:e=>{e.name!=="PrivilegeException"&&this.notificator.showRPCError(e),this.loading=!1}}),this.routePolicyService.canNavigate("groups-settings-managers",this.group)&&this.items.push({cssIcon:"perun-manager",url:`/organizations/${this.group.voId}/groups/${this.group.id}/settings/managers`,label:"MENU_ITEMS.GROUP.MANAGERS",style:"group-btn"}),this.group.name!=="members"&&this.routePolicyService.canNavigate("groups-settings-applicationForm",this.group)&&this.items.push({cssIcon:"perun-application-form",url:`/organizations/${this.group.voId}/groups/${this.group.id}/settings/applicationForm`,label:"MENU_ITEMS.GROUP.APPLICATION_FORM",style:"group-btn"}),this.routePolicyService.canNavigate("groups-settings-notifications",this.group)&&this.items.push({cssIcon:"perun-notification",url:`/organizations/${this.group.voId}/groups/${this.group.id}/settings/notifications`,label:"MENU_ITEMS.GROUP.NOTIFICATIONS",style:"group-btn"}),this.routePolicyService.canNavigate("groups-settings-relations",this.group)&&this.items.push({cssIcon:"perun-group",url:`/organizations/${this.group.voId}/groups/${this.group.id}/settings/relations`,label:"MENU_ITEMS.GROUP.RELATIONS",style:"group-btn"}),this.routePolicyService.canNavigate("groups-settings-extsources",this.group)&&this.items.push({cssIcon:"perun-external-sources",url:`/organizations/${this.group.voId}/groups/${this.group.id}/settings/extsources`,label:"MENU_ITEMS.GROUP.EXTSOURCES",style:"group-btn"})}static{this.\u0275fac=function(i){return new(i||t)(u(At),u(we),u(rt),u(k),u(pt),u(ut),u(j),u(F),u(Et))}}static{this.\u0275cmp=M({type:t,selectors:[["app-group-settings-overview"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:2,vars:2,consts:[[1,"me-auto","ms-auto"],[3,"items"]],template:function(i,n){i&1&&(v(0,nc,1,0,"mat-spinner",0),v(1,oc,2,1,"div")),i&2&&(I(n.loading?0:-1),o(),I(n.loading?-1:1))},dependencies:[D,Tt,De,Me],encapsulation:2})}}return t})();var ac=()=>["Example 1","Example 2"],cs=t=>({id:0,beanName:"Attribute",namespace:"",value:t}),rc=()=>({key1:"value 1",key2:"value 2"}),sc=(t,c)=>c.id;function lc(t,c){t&1&&S(0,"mat-spinner",1)}function pc(t,c){if(t&1){let e=T();a(0,"button",7),C("click",function(){f(e);let n=p(2);return h(n.switchToInitial())}),a(1,"i",8),s(2,"arrow_right_alt"),r(),s(3),d(4,"translate"),r()}t&2&&(o(3),g(" ",m(4,1,"VO_DETAIL.SETTINGS.APPLICATION_FORM.PREVIEW_PAGE.SWITCH_INITIAL")," "))}function cc(t,c){if(t&1){let e=T();a(0,"button",7),C("click",function(){f(e);let n=p(2);return h(n.switchToExtension())}),a(1,"i",8),s(2,"cached"),r(),s(3),d(4,"translate"),r()}t&2&&(o(3),g(" ",m(4,1,"VO_DETAIL.SETTINGS.APPLICATION_FORM.PREVIEW_PAGE.SWITCH_EXTENSION")," "))}function dc(t,c){if(t&1&&(a(0,"mat-option",5),s(1),d(2,"uppercase"),d(3,"translate"),r()),t&2){let e=c.$implicit;_("value",e),o(),g(" ",m(3,4,m(2,2,"SHARED_LIB.LANGUAGES."+e))," ")}}function mc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"lock"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.disabledTooltip(e))}}function uc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"visibility_off"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.hiddenTooltip(e))}}function _c(t,c){if(t&1&&(a(0,"div",10)(1,"div",11)(2,"span",12),s(3),r(),a(4,"div",12),S(5,"input",13),r()(),a(6,"div",14),v(7,mc,2,1,"mat-icon",15),v(8,uc,2,1,"mat-icon",15),a(9,"span",16),s(10),r()()()),t&2){let e=p(2).$implicit,i=p(2);o(3),b(i.getLocalizedLabel(e)),o(2),_("disabled",e.disabled==="ALWAYS"),o(2),I(e.disabled!=="NEVER"?7:-1),o(),I(e.hidden!=="NEVER"?8:-1),o(2),b(i.getLocalizedHint(e))}}function gc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"lock"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.disabledTooltip(e))}}function fc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"visibility_off"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.hiddenTooltip(e))}}function hc(t,c){if(t&1&&(a(0,"div",10)(1,"div",11)(2,"span",12),s(3),r(),a(4,"div",12),S(5,"input",17)(6,"br")(7,"input",13),r()(),a(8,"div",14),v(9,gc,2,1,"mat-icon",15),v(10,fc,2,1,"mat-icon",15),a(11,"span",16),s(12),r()()()),t&2){let e=p(2).$implicit,i=p(2);o(3),b(i.getLocalizedLabel(e)),o(2),_("disabled",e.disabled==="ALWAYS"),o(2),_("disabled",e.disabled==="ALWAYS"),o(2),I(e.disabled!=="NEVER"?9:-1),o(),I(e.hidden!=="NEVER"?10:-1),o(2),b(i.getLocalizedHint(e))}}function vc(t,c){if(t&1&&(a(0,"div"),S(1,"input",19),s(2),S(3,"br"),r()),t&2){let e=c.$implicit,i=p(3).$implicit;o(),_("disabled",i.disabled==="ALWAYS"),o(),g(" ",e)}}function Ic(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"lock"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.disabledTooltip(e))}}function Cc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"visibility_off"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.hiddenTooltip(e))}}function Sc(t,c){if(t&1&&(a(0,"div",10)(1,"div",11)(2,"span",12),s(3),r(),a(4,"form",12),Ce(5,vc,4,2,"div",null,Oe),S(7,"input",18),d(8,"translate"),r()(),a(9,"div",14),v(10,Ic,2,1,"mat-icon",15),v(11,Cc,2,1,"mat-icon",15),a(12,"span",16),s(13),r()()()),t&2){let e=p(2).$implicit,i=p(2);o(3),b(i.getLocalizedLabel(e)),o(2),Se(i.getLocalizedOptions(e)),o(2),_("value",Y(m(8,7,"VO_DETAIL.SETTINGS.APPLICATION_FORM.CLEAR_SELECTION")))("disabled",e.disabled==="ALWAYS"),o(3),I(e.disabled!=="NEVER"?10:-1),o(),I(e.hidden!=="NEVER"?11:-1),o(2),b(i.getLocalizedHint(e))}}function Ec(t,c){if(t&1&&(a(0,"div"),S(1,"span",20),r()),t&2){let e=p(2).$implicit,i=p(2);o(),_("innerHTML",i.getLocalizedLabel(e),Dt)}}function Tc(t,c){if(t&1&&(a(0,"div"),S(1,"span",20),d(2,"sanitizeHtml"),r()),t&2){let e=p(2).$implicit,i=p(2);o(),_("innerHTML",m(2,1,i.getLocalizedLabel(e)),Dt)}}function bc(t,c){if(t&1&&(a(0,"option"),s(1),r()),t&2){let e=c.$implicit;o(),g(" ",e," ")}}function Ac(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"lock"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.disabledTooltip(e))}}function xc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"visibility_off"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.hiddenTooltip(e))}}function Mc(t,c){if(t&1&&(a(0,"div",10)(1,"div",11)(2,"span",12),s(3),r(),a(4,"div",12)(5,"select",21),Ce(6,bc,2,1,"option",null,Oe),r()()(),a(8,"div",14),v(9,Ac,2,1,"mat-icon",15),v(10,xc,2,1,"mat-icon",15),a(11,"span",16),s(12),r()()()),t&2){let e=p(2).$implicit,i=p(2);o(3),b(i.getLocalizedLabel(e)),o(2),_("disabled",e.disabled==="ALWAYS"),o(),Se(i.getLocalizedOptions(e)),o(3),I(e.disabled!=="NEVER"?9:-1),o(),I(e.hidden!=="NEVER"?10:-1),o(2),b(i.getLocalizedHint(e))}}function Dc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"lock"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.disabledTooltip(e))}}function Rc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"visibility_off"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.hiddenTooltip(e))}}function Oc(t,c){if(t&1&&(a(0,"div",10)(1,"div",11)(2,"span",12),s(3),r(),S(4,"textarea",22),r(),a(5,"div",14),v(6,Dc,2,1,"mat-icon",15),v(7,Rc,2,1,"mat-icon",15),a(8,"span",16),s(9),r()()()),t&2){let e=p(2).$implicit,i=p(2);o(3),b(i.getLocalizedLabel(e)),o(),_("disabled",e.disabled==="ALWAYS"),o(2),I(e.disabled!=="NEVER"?6:-1),o(),I(e.hidden!=="NEVER"?7:-1),o(2),b(i.getLocalizedHint(e))}}function yc(t,c){if(t&1&&(a(0,"option",25),s(1),r()),t&2){let e=c.$implicit;o(),g(" ",e," ")}}function Nc(t,c){t&1&&(a(0,"div",26)(1,"form"),S(2,"input",27),r()())}function wc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"lock"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.disabledTooltip(e))}}function Lc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"visibility_off"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.hiddenTooltip(e))}}function Vc(t,c){if(t&1){let e=T();a(0,"div",10)(1,"div",11)(2,"span",12),s(3),r(),a(4,"div",12)(5,"select",23),le("ngModelChange",function(n){f(e);let l=p(2).$implicit,E=p(2);return se(E.mapForCombobox[l.id],n)||(E.mapForCombobox[l.id]=n),h(n)}),a(6,"option",24),s(7),d(8,"translate"),r(),Ce(9,yc,2,1,"option",25,Oe),r(),v(11,Nc,3,0,"div",26),r()(),a(12,"div",14),v(13,wc,2,1,"mat-icon",15),v(14,Lc,2,1,"mat-icon",15),a(15,"span",16),s(16),r()()()}if(t&2){let e=p(2).$implicit,i=p(2);o(3),b(i.getLocalizedLabel(e)),o(2),re("ngModel",i.mapForCombobox[e.id]),_("disabled",e.disabled==="ALWAYS"),o(2),g(" ",m(8,8,"VO_DETAIL.SETTINGS.APPLICATION_FORM.OTHER_VALUE")," "),o(2),Se(i.getLocalizedOptions(e)),o(2),I(i.mapForCombobox[e.id]==="true"?11:-1),o(2),I(e.disabled!=="NEVER"?13:-1),o(),I(e.hidden!=="NEVER"?14:-1),o(2),b(i.getLocalizedHint(e))}}function Pc(t,c){if(t&1&&(a(0,"div"),S(1,"input",29)(2,"span",20),r()),t&2){let e=c.$implicit,i=p(3).$implicit;o(),_("disabled",i.disabled==="ALWAYS"),o(),_("innerHTML",e,Dt)}}function Gc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"lock"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.disabledTooltip(e))}}function Bc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"visibility_off"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.hiddenTooltip(e))}}function Fc(t,c){if(t&1&&(a(0,"div",10)(1,"div",11),S(2,"span",28),a(3,"div",12)(4,"form",26),Ce(5,Pc,3,2,"div",null,Oe),r()()(),a(7,"div",14),v(8,Gc,2,1,"mat-icon",15),v(9,Bc,2,1,"mat-icon",15),a(10,"span",16),s(11),r()()()),t&2){let e=p(2).$implicit,i=p(2);o(2),_("innerHTML",i.getLocalizedLabel(e),Dt),o(3),Se(i.getLocalizedOptions(e)),o(3),I(e.disabled!=="NEVER"?8:-1),o(),I(e.hidden!=="NEVER"?9:-1),o(2),b(i.getLocalizedHint(e))}}function kc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"lock"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.disabledTooltip(e))}}function Uc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"visibility_off"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.hiddenTooltip(e))}}function jc(t,c){if(t&1&&(a(0,"div",10)(1,"div",11)(2,"span",12),s(3),r(),a(4,"div",12)(5,"form",26),S(6,"input",29),s(7," example group1 "),S(8,"br")(9,"input",29),s(10," example group2 "),S(11,"br")(12,"input",29),s(13," example group3 "),r()()(),a(14,"div",14),v(15,kc,2,1,"mat-icon",15),v(16,Uc,2,1,"mat-icon",15),a(17,"span",16),s(18),r()()()),t&2){let e=p(2).$implicit,i=p(2);o(3),b(i.getLocalizedLabel(e)),o(3),_("disabled",e.disabled==="ALWAYS"),o(3),_("disabled",e.disabled==="ALWAYS"),o(3),_("disabled",e.disabled==="ALWAYS"),o(3),I(e.disabled!=="NEVER"?15:-1),o(),I(e.hidden!=="NEVER"?16:-1),o(2),b(i.getLocalizedHint(e))}}function Wc(t,c){if(t&1&&(a(0,"mat-icon",31),s(1,"lock"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.disabledTooltip(e))}}function Hc(t,c){if(t&1&&(a(0,"mat-icon",31),s(1,"visibility_off"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.hiddenTooltip(e))}}function zc(t,c){if(t&1&&(a(0,"div",10)(1,"button",30),s(2),r(),v(3,Wc,2,1,"mat-icon",31),v(4,Hc,2,1,"mat-icon",31),r()),t&2){let e=p(2).$implicit,i=p(2);o(),_("disabled",e.disabled==="ALWAYS"),o(),g(" ",i.getLocalizedLabel(e)," "),o(),I(e.disabled!=="NEVER"?3:-1),o(),I(e.hidden!=="NEVER"?4:-1)}}function $c(t,c){if(t&1&&(a(0,"mat-icon",31),s(1,"lock"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.disabledTooltip(e))}}function Yc(t,c){if(t&1&&(a(0,"mat-icon",31),s(1,"visibility_off"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.hiddenTooltip(e))}}function Xc(t,c){if(t&1&&(a(0,"div")(1,"button",30),s(2),r(),v(3,$c,2,1,"mat-icon",31),v(4,Yc,2,1,"mat-icon",31),r()),t&2){let e=p(2).$implicit,i=p(2);o(),_("disabled",e.disabled==="ALWAYS"),o(),g(" ",i.getLocalizedLabel(e)," "),o(),I(e.disabled!=="NEVER"?3:-1),o(),I(e.hidden!=="NEVER"?4:-1)}}function qc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"lock"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.disabledTooltip(e))}}function Kc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"visibility_off"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.hiddenTooltip(e))}}function Zc(t,c){if(t&1&&(a(0,"div",10)(1,"div",11)(2,"span",12),s(3),r(),a(4,"div",12)(5,"select",32)(6,"option",33),s(7),d(8,"translate"),r(),a(9,"option",34),s(10,"(GMT -12:00) Eniwetok, Kwajalein"),r(),a(11,"option",35),s(12,"(GMT -11:00) Midway Island, Samoa"),r(),a(13,"option",36),s(14,"(GMT -10:00) Hawaii"),r(),a(15,"option",37),s(16,"(GMT -9:30) Taiohae"),r(),a(17,"option",38),s(18,"(GMT -9:00) Alaska"),r(),a(19,"option",39),s(20,"(GMT -8:00) Pacific Time (US & Canada)"),r(),a(21,"option",40),s(22,"(GMT -7:00) Mountain Time (US & Canada)"),r(),a(23,"option",41),s(24," (GMT -6:00) Central Time (US & Canada), Mexico City "),r(),a(25,"option",42),s(26," (GMT -5:00) Eastern Time (US & Canada), Bogota, Lima "),r(),a(27,"option",43),s(28,"(GMT -4:30) Caracas"),r(),a(29,"option",44),s(30," (GMT -4:00) Atlantic Time (Canada), Caracas, La Paz "),r(),a(31,"option",45),s(32,"(GMT -3:30) Newfoundland"),r(),a(33,"option",46),s(34,"(GMT -3:00) Brazil, Buenos Aires, Georgetown"),r(),a(35,"option",47),s(36,"(GMT -2:00) Mid-Atlantic"),r(),a(37,"option",48),s(38,"(GMT -1:00) Azores, Cape Verde Islands"),r(),a(39,"option",49),s(40," (GMT) Western Europe Time, London, Lisbon, Casablanca "),r(),a(41,"option",50),s(42," (GMT +1:00) Brussels, Copenhagen, Madrid, Paris "),r(),a(43,"option",51),s(44,"(GMT +2:00) Kaliningrad, South Africa"),r(),a(45,"option",52),s(46," (GMT +3:00) Baghdad, Riyadh, Moscow, St. Petersburg "),r(),a(47,"option",53),s(48,"(GMT +3:30) Tehran"),r(),a(49,"option",54),s(50,"(GMT +4:00) Abu Dhabi, Muscat, Baku, Tbilisi"),r(),a(51,"option",55),s(52,"(GMT +4:30) Kabul"),r(),a(53,"option",56),s(54," (GMT +5:00) Ekaterinburg, Islamabad, Karachi, Tashkent "),r(),a(55,"option",57),s(56," (GMT +5:30) Bombay, Calcutta, Madras, New Delhi "),r(),a(57,"option",58),s(58,"(GMT +5:45) Kathmandu, Pokhara"),r(),a(59,"option",59),s(60,"(GMT +6:00) Almaty, Dhaka, Colombo"),r(),a(61,"option",60),s(62,"(GMT +6:30) Yangon, Mandalay"),r(),a(63,"option",61),s(64,"(GMT +7:00) Bangkok, Hanoi, Jakarta"),r(),a(65,"option",62),s(66," (GMT +8:00) Beijing, Perth, Singapore, Hong Kong "),r(),a(67,"option",63),s(68,"(GMT +8:45) Eucla"),r(),a(69,"option",64),s(70," (GMT +9:00) Tokyo, Seoul, Osaka, Sapporo, Yakutsk "),r(),a(71,"option",65),s(72,"(GMT +9:30) Adelaide, Darwin"),r(),a(73,"option",66),s(74," (GMT +10:00) Eastern Australia, Guam, Vladivostok "),r(),a(75,"option",67),s(76,"(GMT +10:30) Lord Howe Island"),r(),a(77,"option",68),s(78," (GMT +11:00) Magadan, Solomon Islands, New Caledonia "),r(),a(79,"option",69),s(80,"(GMT +11:30) Norfolk Island"),r(),a(81,"option",70),s(82," (GMT +12:00) Auckland, Wellington, Fiji, Kamchatka "),r(),a(83,"option",71),s(84,"(GMT +12:45) Chatham Islands"),r(),a(85,"option",72),s(86,"(GMT +13:00) Apia, Nukualofa"),r(),a(87,"option",73),s(88,"(GMT +14:00) Line Islands, Tokelau"),r()()()(),a(89,"div",14),v(90,qc,2,1,"mat-icon",15),v(91,Kc,2,1,"mat-icon",15),a(92,"span",16),s(93),r()()()),t&2){let e=p(2).$implicit,i=p(2);o(3),b(i.getLocalizedLabel(e)),o(2),_("disabled",e.disabled==="ALWAYS"),o(2),g(" ",m(8,6,"VO_DETAIL.SETTINGS.APPLICATION_FORM.NOT_SELECTED")," "),o(83),I(e.disabled!=="NEVER"?90:-1),o(),I(e.hidden!=="NEVER"?91:-1),o(2),b(i.getLocalizedHint(e))}}function Qc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"lock"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.disabledTooltip(e))}}function Jc(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"visibility_off"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.hiddenTooltip(e))}}function ed(t,c){if(t&1&&(a(0,"div")(1,"div",11)(2,"span",12),s(3),r(),a(4,"div",12),S(5,"perun-web-apps-attribute-value-list",74),r()(),a(6,"div",14),v(7,Qc,2,1,"mat-icon",15),v(8,Jc,2,1,"mat-icon",15),a(9,"span",16),s(10),r()()()),t&2){let e=p(2).$implicit,i=p(2);o(3),b(i.getLocalizedLabel(e)),o(2),_("attribute",Ee(6,cs,ge(5,ac))),o(2),I(e.disabled!=="NEVER"?7:-1),o(),I(e.hidden!=="NEVER"?8:-1),o(2),b(i.getLocalizedHint(e))}}function td(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"lock"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.disabledTooltip(e))}}function id(t,c){if(t&1&&(a(0,"mat-icon",15),s(1,"visibility_off"),r()),t&2){let e=p(3).$implicit,i=p(2);_("matTooltip",i.hiddenTooltip(e))}}function nd(t,c){if(t&1&&(a(0,"div")(1,"div",11)(2,"span",12),s(3),r(),a(4,"div",12),S(5,"perun-web-apps-attribute-value-map",74),r()(),a(6,"div",14),v(7,td,2,1,"mat-icon",15),v(8,id,2,1,"mat-icon",15),a(9,"span",16),s(10),r()()()),t&2){let e=p(2).$implicit,i=p(2);o(3),b(i.getLocalizedLabel(e)),o(2),_("attribute",Ee(6,cs,ge(5,rc))),o(2),I(e.disabled!=="NEVER"?7:-1),o(),I(e.hidden!=="NEVER"?8:-1),o(2),b(i.getLocalizedHint(e))}}function od(t,c){if(t&1&&(a(0,"div",9),v(1,_c,11,5,"div",10),v(2,hc,13,6,"div",10),v(3,Sc,14,9,"div",10),v(4,Ec,2,1,"div"),v(5,Tc,3,3,"div"),v(6,Mc,13,5,"div",10),v(7,Oc,10,5,"div",10),v(8,Vc,17,10,"div",10),v(9,Fc,12,4,"div",10),v(10,jc,19,7,"div",10),v(11,zc,5,4,"div",10),v(12,Xc,5,4,"div"),v(13,Zc,94,8,"div",10),v(14,ed,11,8,"div"),v(15,nd,11,8,"div"),r()),t&2){let e=p().$implicit;o(),I((e.type==="TEXTFIELD"||e.type==="VALIDATED_EMAIL"||e.type==="USERNAME")&&e.hidden!=="ALWAYS"?1:-1),o(),I(e.type==="PASSWORD"&&e.hidden!=="ALWAYS"?2:-1),o(),I(e.type==="RADIO"&&e.hidden!=="ALWAYS"?3:-1),o(),I(e.type==="HEADING"&&e.hidden!=="ALWAYS"?4:-1),o(),I(e.type==="HTML_COMMENT"&&e.hidden!=="ALWAYS"?5:-1),o(),I(e.type==="SELECTIONBOX"&&e.hidden!=="ALWAYS"?6:-1),o(),I(e.type==="TEXTAREA"&&e.hidden!=="ALWAYS"?7:-1),o(),I(e.type==="COMBOBOX"&&e.hidden!=="ALWAYS"?8:-1),o(),I(e.type==="CHECKBOX"&&e.hidden!=="ALWAYS"?9:-1),o(),I(e.type==="EMBEDDED_GROUP_APPLICATION"&&e.hidden!=="ALWAYS"?10:-1),o(),I(e.type==="SUBMIT_BUTTON"&&e.hidden!=="ALWAYS"?11:-1),o(),I(e.type==="AUTO_SUBMIT_BUTTON"&&e.hidden!=="ALWAYS"?12:-1),o(),I(e.type==="TIMEZONE"&&e.hidden!=="ALWAYS"?13:-1),o(),I(e.type==="LIST_INPUT_BOX"&&e.hidden!=="ALWAYS"?14:-1),o(),I(e.type==="MAP_INPUT_BOX"&&e.hidden!=="ALWAYS"?15:-1)}}function ad(t,c){if(t&1&&(a(0,"div"),v(1,od,16,15,"div",9),r()),t&2){let e=c.$implicit,i=p(2);o(),I(i.isValid(e)?1:-1)}}function rd(t,c){if(t&1){let e=T();a(0,"div")(1,"div",2),v(2,pc,5,3,"button",3),v(3,cc,5,3,"button",3),a(4,"mat-form-field")(5,"mat-label"),s(6),d(7,"translate"),r(),a(8,"mat-select",4),le("valueChange",function(n){f(e);let l=p();return se(l.currentLanguage,n)||(l.currentLanguage=n),h(n)}),Ce(9,dc,4,6,"mat-option",5,Oe),r()()(),a(11,"div",6),Ce(12,ad,2,1,"div",null,sc),r()()}if(t&2){let e=p();o(2),I(e.initialPage?-1:2),o(),I(e.initialPage?3:-1),o(3),b(m(7,4,"DIALOGS.PASSWORD_RESET_REQUEST.LANGUAGE")),o(2),re("value",e.currentLanguage),o(),Se(e.languages),o(3),Se(e.applicationFormItems)}}var Qn=(()=>{class t{constructor(e,i,n){this.route=e,this.translate=i,this.store=n,this.loading=!0,this.applicationFormItems=[],this.currentLanguage="en",this.languages=["en"],this.initialPage=!0,this.mapForCombobox=new Map}ngOnInit(){this.languages=this.store.getProperty("supported_languages"),this.route.queryParamMap.subscribe(e=>{this.applicationFormItems=JSON.parse(e.get("applicationFormItems")),this.loading=!1})}switchToInitial(){this.initialPage=!0}switchToExtension(){this.initialPage=!1}getLocalizedOptions(e){if(e.i18n[this.currentLanguage]){let i=e.i18n[this.currentLanguage].options;if(i!==null&&i!==""){let n=[];for(let l of i.split("|"))n.push(l.split("#")[1]);return n}}return[]}isValid(e){if(e.forDelete)return!1;for(let i of e.applicationTypes)if(i==="INITIAL"&&this.initialPage||i==="EXTENSION"&&!this.initialPage)return!0;return!1}disabledTooltip(e){let i,n,l;switch(e.disabled){case"ALWAYS":return this.translate.instant("VO_DETAIL.SETTINGS.APPLICATION_FORM.PREVIEW_PAGE.DISABLED_HIDDEN_ICON.ALWAYS_DISABLED");case"IF_PREFILLED":return i=this.translate.instant("VO_DETAIL.SETTINGS.APPLICATION_FORM.PREVIEW_PAGE.DISABLED_HIDDEN_ICON.DISABLED_WHEN"),n=e.hiddenDependencyItemId===null?"":this.applicationFormItems.find(E=>E.id===e.disabledDependencyItemId).shortname,l=this.translate.instant("VO_DETAIL.SETTINGS.APPLICATION_FORM.PREVIEW_PAGE.DISABLED_HIDDEN_ICON.IS_PREFILLED"),`${i} ${n} ${l}`;case"IF_EMPTY":return i=this.translate.instant("VO_DETAIL.SETTINGS.APPLICATION_FORM.PREVIEW_PAGE.DISABLED_HIDDEN_ICON.DISABLED_WHEN"),n=e.hiddenDependencyItemId===null?"":this.applicationFormItems.find(E=>E.id===e.disabledDependencyItemId).shortname,l=this.translate.instant("VO_DETAIL.SETTINGS.APPLICATION_FORM.PREVIEW_PAGE.DISABLED_HIDDEN_ICON.IS_EMPTY"),`${i} ${n} ${l}`;default:return""}}hiddenTooltip(e){let i,n,l;switch(e.hidden){case"ALWAYS":return this.translate.instant("VO_DETAIL.SETTINGS.APPLICATION_FORM.PREVIEW_PAGE.DISABLED_HIDDEN_ICON.ALWAYS_HIDDEN");case"IF_PREFILLED":return i=this.translate.instant("VO_DETAIL.SETTINGS.APPLICATION_FORM.PREVIEW_PAGE.DISABLED_HIDDEN_ICON.HIDDEN_WHEN"),n=e.hiddenDependencyItemId===null?"":this.applicationFormItems.find(E=>E.id===e.hiddenDependencyItemId).shortname,l=this.translate.instant("VO_DETAIL.SETTINGS.APPLICATION_FORM.PREVIEW_PAGE.DISABLED_HIDDEN_ICON.IS_PREFILLED"),`${i} ${n} ${l}`;case"IF_EMPTY":return i=this.translate.instant("VO_DETAIL.SETTINGS.APPLICATION_FORM.PREVIEW_PAGE.DISABLED_HIDDEN_ICON.HIDDEN_WHEN"),n=e.hiddenDependencyItemId===null?"":this.applicationFormItems.find(E=>E.id===e.hiddenDependencyItemId).shortname,l=this.translate.instant("VO_DETAIL.SETTINGS.APPLICATION_FORM.PREVIEW_PAGE.DISABLED_HIDDEN_ICON.IS_EMPTY"),`${i} ${n} ${l}`;default:return""}}getLocalizedLabel(e){return e.i18n[this.currentLanguage]?.label?e.i18n[this.currentLanguage].label+(e.required?"*":""):e.shortname+(e.required?"*":"")}getLocalizedHint(e){return e.i18n[this.currentLanguage]?e.i18n[this.currentLanguage].help:""}static{this.\u0275fac=function(i){return new(i||t)(u(ve),u(X),u(Xe))}}static{this.\u0275cmp=M({type:t,selectors:[["app-application-form-preview"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:5,vars:5,consts:[[1,"page-subtitle"],[1,"ms-auto","me-auto"],[1,"w-100","mb-2"],["mat-stroked-button","",1,"me-2"],[3,"valueChange","value"],[3,"value"],[1,"card","mb-4","p-5"],["mat-stroked-button","",1,"me-2",3,"click"],[1,"material-icons"],[1,"mb-2"],[1,"d-flex"],[1,"w-50","d-flex"],[1,"w-50"],["type","text",1,"w-100",3,"disabled"],[1,"w-50","d-flex","left"],[1,"pointer",3,"matTooltip"],[1,"ms-2"],["type","text",1,"mb-1","w-100",3,"disabled"],["type","reset",3,"disabled","value"],["name","temp","type","radio",3,"disabled"],[3,"innerHTML"],[1,"w-100",3,"disabled"],[1,"w-50",3,"disabled"],[1,"w-100",3,"ngModelChange","ngModel","disabled"],["selected","","value","true"],["value","false"],[1,"w-100"],["type","text"],[1,"w-50",3,"innerHTML"],["type","checkbox",3,"disabled"],["color","accent","mat-flat-button","",3,"disabled"],[1,"pointer","left",3,"matTooltip"],["id","timezone-offset","name","timezone_offset",1,"w-100",3,"disabled"],["selected","selected","value","-12:00"],["value","-12:00"],["value","-11:00"],["value","-10:00"],["value","-09:50"],["value","-09:00"],["value","-08:00"],["value","-07:00"],["value","-06:00"],["value","-05:00"],["value","-04:50"],["value","-04:00"],["value","-03:50"],["value","-03:00"],["value","-02:00"],["value","-01:00"],["value","+00:00"],["value","+01:00"],["value","+02:00"],["value","+03:00"],["value","+03:50"],["value","+04:00"],["value","+04:50"],["value","+05:00"],["value","+05:50"],["value","+05:75"],["value","+06:00"],["value","+06:50"],["value","+07:00"],["value","+08:00"],["value","+08:75"],["value","+09:00"],["value","+09:50"],["value","+10:00"],["value","+10:50"],["value","+11:00"],["value","+11:50"],["value","+12:00"],["value","+12:75"],["value","+13:00"],["value","+14:00"],[3,"attribute"]],template:function(i,n){i&1&&(a(0,"h1",0),s(1),d(2,"translate"),r(),v(3,lc,1,0,"mat-spinner",1),v(4,rd,14,6,"div")),i&2&&(o(),g(" ",m(2,3,"VO_DETAIL.SETTINGS.APPLICATION_FORM.PREVIEW_PAGE.TITLE"),`
`),o(2),I(n.loading?3:-1),o(),I(n.loading?-1:4))},dependencies:[D,N,V,et,Je,He,We,Vt,Bt,Gt,Pt,at,Ji,go,fo,_o,ye,Ci,ot,uo,Ne,De,Me,O,Ae,wa,Na,Ii,R,ea],styles:[".left[_ngcontent-%COMP%]{margin-left:10px}.pointer[_ngcontent-%COMP%]{cursor:pointer}"]})}}return t})();function sd(t,c){t&1&&(s(0),d(1,"translate")),t&2&&g(" ",m(1,1,"MEMBER_DETAIL.ENTITY")," ")}function ld(t,c){if(t&1&&S(0,"app-one-entity-attribute-page",5),t&2){let e=p();_("entityId",e.member.id)("entity","member")}}function pd(t,c){t&1&&(s(0),d(1,"translate"),d(2,"translate")),t&2&&be(" ",m(1,2,"MEMBER_DETAIL.ENTITY")," - ",m(2,4,"GROUP_DETAIL.ENTITY")," ")}function cd(t,c){if(t&1&&S(0,"app-two-entity-attribute-page",6),t&2){let e=p(2);_("firstEntity","member")("firstEntityId",e.member.id)("secondEntity","group")}}function dd(t,c){t&1&&(a(0,"mat-tab"),A(1,pd,3,6,"ng-template",2)(2,cd,1,3,"ng-template",3),r())}function md(t,c){t&1&&(s(0),d(1,"translate"),d(2,"translate")),t&2&&be(" ",m(1,2,"MEMBER_DETAIL.ENTITY")," - ",m(2,4,"RESOURCE_DETAIL.ENTITY")," ")}function ud(t,c){if(t&1&&S(0,"app-two-entity-attribute-page",6),t&2){let e=p(2);_("firstEntity","member")("firstEntityId",e.member.id)("secondEntity","resource")}}function _d(t,c){t&1&&(a(0,"mat-tab"),A(1,md,3,6,"ng-template",2)(2,ud,1,3,"ng-template",3),r())}function gd(t,c){t&1&&(s(0),d(1,"translate")),t&2&&g(" ",m(1,1,"ADMIN_USER.ENTITY")," ")}function fd(t,c){if(t&1&&S(0,"app-one-entity-attribute-page",5),t&2){let e=p();_("entityId",e.member.userId)("entity","user")}}function hd(t,c){t&1&&(s(0),d(1,"translate"),d(2,"translate")),t&2&&be(" ",m(1,2,"ADMIN_USER.ENTITY")," - ",m(2,4,"FACILITY_DETAIL.ENTITY")," ")}function vd(t,c){if(t&1&&S(0,"app-two-entity-attribute-page",6),t&2){let e=p(2);_("firstEntity","user")("firstEntityId",e.member.userId)("secondEntity","facility")}}function Id(t,c){t&1&&(a(0,"mat-tab"),A(1,hd,3,6,"ng-template",2)(2,vd,1,3,"ng-template",3),r())}var ds=(()=>{class t{constructor(e,i,n,l){this.route=e,this.authResolver=i,this.memberManager=n,this.entityService=l}ngOnInit(){this.member=this.entityService.getEntity(),this.memberGroupAttAuth=this.authResolver.isAuthorized("getMemberGroups_Member_policy",[this.member]),this.memberResourceAttAuth=this.authResolver.isAuthorized("getAssignedResourcesWithStatus_Member_policy",[this.member]),this.userFacilityAttAuth=this.authResolver.isAuthorized("getAssignedFacilities_User_policy",[{beanName:"User",id:this.member.userId}])}static{this.\u0275fac=function(i){return new(i||t)(u(ve),u(k),u(Ye),u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-member-attributes"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:14,vars:6,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false"],["matTabLabel",""],["matTabContent",""],[1,"mb-2"],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(i,n){i&1&&(a(0,"div")(1,"h1",0),s(2),d(3,"translate"),r(),a(4,"mat-tab-group",1)(5,"mat-tab"),A(6,sd,2,3,"ng-template",2)(7,ld,1,2,"ng-template",3),r(),v(8,dd,3,0,"mat-tab"),v(9,_d,3,0,"mat-tab"),a(10,"mat-tab",4),A(11,gd,2,3,"ng-template",2)(12,fd,1,2,"ng-template",3),r(),v(13,Id,3,0,"mat-tab"),r()()),i&2&&(o(2),b(m(3,4,"MEMBER_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),o(6),I(n.memberGroupAttAuth?8:-1),o(),I(n.memberResourceAttAuth?9:-1),o(4),I(n.userFacilityAttAuth?13:-1))},dependencies:[D,Bi,An,si,Oi,oi,ai,ri,O,R],encapsulation:2})}}return t})();var ms=(()=>{class t{constructor(e,i,n,l,E){this.sideMenuService=e,this.voService=i,this.authResolver=n,this.entityStorageService=l,this.routePolicyService=E,this.items=[]}ngOnInit(){this.vo=this.entityStorageService.getEntity(),this.initItems()}initItems(){this.routePolicyService.canNavigate("organizations-resources-preview",this.vo)&&this.items.push({cssIcon:"perun-resource",url:`/organizations/${this.vo.id}/resources/preview`,label:"MENU_ITEMS.VO.RESOURCE_PREVIEW",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-resources-tags",this.vo)&&this.items.push({cssIcon:"perun-resource-tags",url:`/organizations/${this.vo.id}/resources/tags`,label:"MENU_ITEMS.VO.RESOURCE_TAGS",style:"vo-btn"}),this.routePolicyService.canNavigate("organizations-resources-states",this.vo)&&this.items.push({cssIcon:"perun-resources-state",url:`/organizations/${this.vo.id}/resources/states`,label:"MENU_ITEMS.VO.RESOURCE_STATES",style:"vo-btn"})}static{this.\u0275fac=function(i){return new(i||t)(u(At),u(de),u(k),u(F),u(Et))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-resources-overview"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:2,vars:1,consts:[[3,"items"]],template:function(i,n){i&1&&(a(0,"div"),S(1,"perun-web-apps-menu-buttons-field",0),r()),i&2&&(o(),_("items",n.items))},dependencies:[D,Tt],encapsulation:2})}}return t})();function Cd(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function Sd(t,c){t&1&&S(0,"th",14)}function Ed(t,c){if(t&1&&(a(0,"td",15),s(1),r()),t&2){let e=c.$implicit;o(),b(e.tagName)}}function Td(t,c){t&1&&S(0,"tr",16)}function bd(t,c){t&1&&S(0,"tr",17)}function Ad(t,c){if(t&1){let e=T();a(0,"div")(1,"h1",2),s(2),d(3,"translate"),r(),a(4,"div",3)(5,"p"),s(6),d(7,"translate"),r(),a(8,"div",4),s(9),d(10,"translate"),r(),a(11,"table",5),fe(12,6),A(13,Sd,1,0,"th",7)(14,Ed,2,1,"td",8),he(),A(15,Td,1,0,"tr",9)(16,bd,1,0,"tr",10),r()(),a(17,"div",11)(18,"button",12),C("click",function(){f(e);let n=p();return h(n.onCancel())}),s(19),d(20,"translate"),r(),a(21,"button",13),C("click",function(){f(e);let n=p();return h(n.onSubmit())}),s(22),d(23,"translate"),r()()()}if(t&2){let e=p();o(2),b(m(3,9,"DIALOGS.DELETE_RESOURCE_TAG.TITLE")),o(4),g(" ",m(7,11,"DIALOGS.DELETE_RESOURCE_TAG.DESCRIPTION")," "),o(3),g(" ",m(10,13,"DIALOGS.DELETE_RESOURCE_TAG.ASK")," "),o(2),_("dataSource",e.dataSource),o(4),_("matHeaderRowDef",e.displayedColumns),o(),_("matRowDefColumns",e.displayedColumns),o(3),g(" ",m(20,15,"DIALOGS.DELETE_RESOURCE_TAG.CANCEL")," "),o(2),_("disabled",e.loading),o(),g(" ",m(23,17,"DIALOGS.DELETE_RESOURCE_TAG.SUBMIT")," ")}}var us=(()=>{class t{constructor(e,i,n){this.dialogRef=e,this.data=i,this.resourceManager=n,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.dataSource=new Qe(this.data.tagsForDelete)}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0;for(let e of this.data.tagsForDelete)this.resourceManager.deleteResourceTag({resourceTag:e}).subscribe(()=>{this.dialogRef.close(!0)},()=>this.dialogRef.close(!0))}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(ei))}}static{this.\u0275cmp=M({type:t,selectors:[["app-delete-resource-tag-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(i,n){if(i&1&&(A(0,Cd,1,0,"ng-template",null,0,L),a(2,"div"),A(3,Ad,24,19,"div",1),r()),i&2){let l=y(1);o(2),ce(pe("",n.theme," position-relative")),o(),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,oe,te,ne,ie,ue,je,Le,Pe,Ke,Ge,Ve,ke,Be,Fe,Ze,Ue,O,P,R],encapsulation:2})}}return t})();function xd(t,c){if(t&1){let e=T();a(0,"button",8),C("click",function(){f(e);let n=p();return h(n.create())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.RESOURCES.TAGS.CREATE_BUTTON")," "))}function Md(t,c){if(t&1){let e=T();a(0,"button",9),C("click",function(){f(e);let n=p();return h(n.deleteTag())}),s(1),d(2,"translate"),r()}if(t&2){let e=p();_("disabled",e.loading||e.selection.selected.length===0),o(),g(" ",m(2,2,"VO_DETAIL.RESOURCES.TAGS.DELETE_BUTTON")," ")}}function Dd(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function Rd(t,c){if(t&1&&S(0,"app-resources-tags-list",10),t&2){let e=p();_("loading",e.loading)("displayedColumns",e.displayedColumns)("entity","vo")("resourceTags",e.resourceTag)("filterValue",e.filterValue)("selection",e.selection)("cachedSubject",e.cachedSubject)("tableId",e.tableId)}}var _s=(()=>{class t{constructor(e,i,n,l,E,x){this.resourceManager=e,this.dialog=i,this.notificator=n,this.translator=l,this.authResolver=E,this.entityStorageService=x,this.loading=!1,this.resourceTag=[],this.selection=new K(!0,[],!0,(w,U)=>w.id===U.id),this.tableId=fa,this.displayedColumns=[],this.cachedSubject=new me(!0)}ngOnInit(){this.loading=!0,this.vo=this.entityStorageService.getEntity(),this.setAuthRights(),this.updateData()}deleteTag(){let e=G();e.width="450px",e.data={tagsForDelete:this.selection.selected,theme:"vo-theme"},this.dialog.open(us,e).afterClosed().subscribe(n=>{n&&(this.translator.get("VO_DETAIL.RESOURCES.TAGS.DELETE_SUCCESS").subscribe(l=>{this.notificator.showSuccess(l)}),this.updateData())})}create(){let e=G();e.width="450px",e.data={voId:this.vo.id,theme:"vo-theme"},this.dialog.open(pr,e).afterClosed().subscribe(n=>{n&&(this.translator.get("VO_DETAIL.RESOURCES.TAGS.CREATE_SUCCESS").subscribe(l=>{this.notificator.showSuccess(l)}),this.updateData())})}updateData(){this.loading=!0,this.selection.clear(),this.cachedSubject.next(!0),this.resourceManager.getAllResourcesTagsForVo(this.vo.id).subscribe(e=>{this.resourceTag=e,this.selection.clear(),this.setAuthRights(),this.loading=!1})}applyFilter(e){this.filterValue=e,this.updateData()}setAuthRights(){this.displayedColumns=[],this.createAuth=this.authResolver.isAuthorized("createResourceTag_ResourceTag_Vo_policy",[this.vo]),this.deleteAuth=this.authResolver.isAuthorized("deleteResourceTag_ResourceTag_policy",[this.vo]),this.editAuth=this.authResolver.isAuthorized("updateResourceTag_ResourceTag_policy",[this.vo]),this.displayedColumns=this.deleteAuth?["select","id","name"]:["id","name"],this.editAuth&&this.displayedColumns.push("edit")}static{this.\u0275fac=function(i){return new(i||t)(u(ei),u(q),u(j),u(X),u(k),u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-resources-tags"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:11,vars:8,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","displayedColumns","entity","resourceTags","filterValue","selection","cachedSubject","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"loading","displayedColumns","entity","resourceTags","filterValue","selection","cachedSubject","tableId"]],template:function(i,n){if(i&1){let l=T();a(0,"h1",1),s(1),d(2,"translate"),r(),a(3,"perun-web-apps-refresh-button",2),C("refresh",function(){return f(l),h(n.updateData())}),r(),v(4,xd,3,3,"button",3),v(5,Md,3,4,"button",4),a(6,"perun-web-apps-debounce-filter",5),C("filter",function(x){return f(l),h(n.applyFilter(x))}),r(),A(7,Dd,1,0,"ng-template",null,0,L),a(9,"div",6),A(10,Rd,1,8,"app-resources-tags-list",7),r()}if(i&2){let l=y(8);o(),b(m(2,6,"VO_DETAIL.RESOURCES.TAGS.TITLE")),o(3),I(n.createAuth?4:-1),o(),I(n.deleteAuth?5:-1),o(),_("placeholder","VO_DETAIL.RESOURCES.TAGS.SEARCH"),o(4),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,Te,xe,O,cr,P,Q,R],encapsulation:2})}}return t})();function Od(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function yd(t,c){if(t&1){let e=T();a(0,"app-expiration-settings",3),C("saveAttribute",function(n){f(e);let l=p();return h(l.saveExpirationAttribute(n))}),r()}if(t&2){let e=p();_("expirationAttribute",e.expirationAttribute)}}var gs=(()=>{class t{constructor(e,i,n,l,E){this.attributesManager=e,this.translate=i,this.notificator=n,this.apiRequest=l,this.entityStorageService=E,this.loading=!1,this.translate.get("GROUP_DETAIL.SETTINGS.EXPIRATION.SUCCESS_MESSAGE").subscribe(x=>this.successMessage=x),this.translate.get("GROUP_DETAIL.SETTINGS.EXPIRATION.ERROR_MESSAGE").subscribe(x=>this.errorMessage=x)}ngOnInit(){this.loading=!0,this.group=this.entityStorageService.getEntity(),this.loadSettings()}saveExpirationAttribute(e){this.loading=!0,this.apiRequest.dontHandleErrorForNext(),this.attributesManager.setGroupAttribute({group:this.group.id,attribute:e}).subscribe({next:()=>{this.loadSettings(),this.notificator.showSuccess(this.successMessage),this.loading=!1},error:i=>{this.notificator.showRPCError(i,this.errorMessage),this.loading=!1}})}loadSettings(){this.loading=!0,this.attributesManager.getGroupAttributeByName(this.group.id,Re.GROUP_DEF_EXPIRATION_RULES).subscribe(e=>{this.expirationAttribute=e,this.loading=!1})}static{this.\u0275fac=function(i){return new(i||t)(u(ut),u(X),u(j),u(pt),u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-group-settings-expiration"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:4,vars:2,consts:[["spinner",""],[1,"position-relative"],[3,"expirationAttribute","saveAttribute",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"saveAttribute","expirationAttribute"]],template:function(i,n){if(i&1&&(A(0,Od,1,0,"ng-template",null,0,L),a(2,"div",1),A(3,yd,1,1,"app-expiration-settings",2),r()),i&2){let l=y(1);o(3),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,P,Q,On],encapsulation:2})}}return t})();var fs=(()=>{class t{constructor(e,i){this.guiAuthResolver=e,this.entityStorageService=i,this.availableRoles=[],this.selected="user",this.type="Group",this.theme="group-theme"}ngOnInit(){this.group=this.entityStorageService.getEntity(),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Group")}static{this.\u0275fac=function(i){return new(i||t)(u(k),u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-group-settings-managers"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:1,vars:4,consts:[[3,"complementaryObject","availableRoles","complementaryObjectType","theme"]],template:function(i,n){i&1&&S(0,"app-managers-page",0),i&2&&_("complementaryObject",n.group)("availableRoles",n.availableRoles)("complementaryObjectType",n.type)("theme",n.theme)},dependencies:[D,bn],encapsulation:2})}}return t})();function Nd(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function wd(t,c){t&1&&S(0,"th",14)}function Ld(t,c){if(t&1&&(a(0,"td",15),s(1),r()),t&2){let e=c.$implicit,i=p(2);o(),b(i.getMailType(e))}}function Vd(t,c){t&1&&S(0,"tr",16)}function Pd(t,c){t&1&&S(0,"tr",17)}function Gd(t,c){if(t&1){let e=T();a(0,"div")(1,"h1",2),s(2),d(3,"translate"),r(),a(4,"div",3)(5,"p"),s(6),d(7,"translate"),r(),a(8,"div",4),s(9),d(10,"translate"),r(),a(11,"table",5),fe(12,6),A(13,wd,1,0,"th",7)(14,Ld,2,1,"td",8),he(),A(15,Vd,1,0,"tr",9)(16,Pd,1,0,"tr",10),r()(),a(17,"div",11)(18,"button",12),C("click",function(){f(e);let n=p();return h(n.onCancel())}),s(19),d(20,"translate"),r(),a(21,"button",13),C("click",function(){f(e);let n=p();return h(n.onSubmit())}),s(22),d(23,"translate"),r()()()}if(t&2){let e=p();o(2),b(m(3,9,"DIALOGS.APPLICATION_FORM_DELETE_MAIL.TITLE")),o(4),g(" ",m(7,11,"DIALOGS.APPLICATION_FORM_DELETE_MAIL.DESCRIPTION")," "),o(3),g(" ",m(10,13,"DIALOGS.APPLICATION_FORM_DELETE_MAIL.CONFIRMATION")," "),o(2),_("dataSource",e.dataSource),o(4),_("matHeaderRowDef",e.displayedColumns),o(),_("matRowDefColumns",e.displayedColumns),o(3),g(" ",m(20,15,"DIALOGS.APPLICATION_FORM_DELETE_MAIL.CANCEL")," "),o(2),_("disabled",e.loading),o(),g(" ",m(23,17,"DIALOGS.APPLICATION_FORM_DELETE_MAIL.SUBMIT")," ")}}var Nn=(()=>{class t{constructor(e,i,n,l,E){this.dialogRef=e,this.data=i,this.notificator=n,this.translate=l,this.registrarService=E,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.dataSource=new Qe(this.data.mails)}onCancel(){this.dialogRef.close(!1)}onSubmit(){if(this.loading=!0,this.data.groupId)for(let e of this.data.mails)this.registrarService.deleteApplicationMailForGroup(this.data.groupId,e.id).subscribe(()=>{this.dialogRef.close(!0)},()=>this.loading=!1);else for(let e of this.data.mails)this.registrarService.deleteApplicationMailForVo(this.data.voId,e.id).subscribe(()=>{this.dialogRef.close(!0)},()=>this.loading=!1)}getMailType(e){let i="";return e.mailType===void 0||e.mailType===null||e.mailType.length===0?i="":this.translate.get("VO_DETAIL.SETTINGS.NOTIFICATIONS.MAIL_TYPE_"+e.mailType).subscribe(n=>{i=n}),i}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(j),u(X),u(Ie))}}static{this.\u0275cmp=M({type:t,selectors:[["app-delete-notification-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(i,n){if(i&1&&(A(0,Nd,1,0,"ng-template",null,0,L),a(2,"div"),A(3,Gd,24,19,"div",1),r()),i&2){let l=y(1);o(2),ce(pe("",n.theme," position-relative")),o(),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,oe,te,ne,ie,ue,je,Le,Pe,Ke,Ge,Ve,ke,Be,Fe,Ze,Ue,O,P,R],encapsulation:2})}}return t})();var Bd=t=>({"disabled-label":t});function Fd(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function kd(t,c){t&1&&(a(0,"perun-web-apps-alert",4),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"DIALOGS.NOTIFICATIONS_EDIT_FOOTER.FORMAT_HTML_NOT_AUTHORIZED")," "))}function Ud(t,c){if(t&1&&(a(0,"span",14),s(1),d(2,"uppercase"),d(3,"translate"),r()),t&2){let e=p().$implicit,i=p(2);_("ngClass",Ee(6,Bd,e==="html"&&!i.htmlEditAuth)),o(),g(" ",m(3,4,m(2,2,"DIALOGS.NOTIFICATIONS_EDIT_FOOTER.FORMAT_"+e))," ")}}function jd(t,c){if(t&1){let e=T();a(0,"mat-form-field",12)(1,"textarea",15),le("ngModelChange",function(n){f(e);let l=p(3);return se(l.mailFooter,n)||(l.mailFooter=n),h(n)}),s(2," "),r(),a(3,"mat-hint"),s(4),d(5,"translate"),r()()}if(t&2){let e=p(3);o(),re("ngModel",e.mailFooter),o(3),g(" ",m(5,2,"DIALOGS.NOTIFICATIONS_EDIT_FOOTER.DESCRIPTION")," ")}}function Wd(t,c){if(t&1&&S(0,"perun-web-apps-html-content-form-field",13),t&2){let e=p(3);_("inputFormControl",e.htmlInput)("tagType","textarea")("hint","DIALOGS.NOTIFICATIONS_EDIT_FOOTER.DESCRIPTION")("minRows",5)}}function Hd(t,c){if(t&1&&(a(0,"mat-tab",6),A(1,Ud,4,8,"ng-template",11),v(2,jd,6,4,"mat-form-field",12),v(3,Wd,1,4,"perun-web-apps-html-content-form-field",13),r()),t&2){let e=c.$implicit,i=p(2);_("disabled",e==="html"&&!i.htmlEditAuth),o(2),I(e==="plain"?2:-1),o(),I(e==="html"?3:-1)}}function zd(t,c){if(t&1){let e=T();a(0,"div")(1,"h1",2),s(2),d(3,"translate"),r(),a(4,"div",3),v(5,kd,3,3,"perun-web-apps-alert",4),a(6,"mat-tab-group",5),Ce(7,Hd,4,3,"mat-tab",6,Oe),r()(),a(9,"div",7)(10,"button",8),C("click",function(){f(e);let n=p();return h(n.cancel())}),s(11),d(12,"translate"),r(),a(13,"div",9),d(14,"translate"),a(15,"div",9),d(16,"translate"),a(17,"button",10),C("click",function(){f(e);let n=p();return h(n.submit())}),s(18),d(19,"translate"),r()()()()()}if(t&2){let e=p();o(2),b(m(3,13,"DIALOGS.NOTIFICATIONS_EDIT_FOOTER.TITLE")),o(3),I(e.plainEdithAuth&&!e.htmlEditAuth?5:-1),o(2),Se(e.formats),o(4),g(" ",m(12,15,"DIALOGS.NOTIFICATIONS_EDIT_FOOTER.CANCEL_BUTTON")," "),o(2),_("matTooltip",Y(m(14,17,"DIALOGS.NOTIFICATIONS_EDIT_FOOTER.HINT")))("matTooltipDisabled",e.plainEdithAuth)("matTooltipPosition","above"),o(2),_("matTooltip",Y(m(16,19,"DIALOGS.NOTIFICATIONS_EDIT_FOOTER.INVALID_TAGS")))("matTooltipDisabled",!e.htmlInput.invalid)("matTooltipPosition","above"),o(2),_("disabled",e.loading||!e.plainEdithAuth||e.htmlInput.invalid||e.htmlInput.pending),o(),g(" ",m(19,21,"DIALOGS.NOTIFICATIONS_EDIT_FOOTER.SUBMIT_BUTTON")," ")}}var wn=(()=>{class t{constructor(e,i,n,l,E){this.dialogRef=e,this.attributesManager=i,this.translateService=n,this.notificator=l,this.data=E,this.mailFooter="",this.loading=!1,this.htmlInput=new ct(""),this.formats=["plain","html"]}ngOnInit(){this.theme=this.data.theme,this.loading=!0,this.data.groupId?this.getFooterForGroup():this.getFooterForVo(),this.loading=!1,this.htmlInput.markAsTouched()}submit(){this.loading=!0,this.mailAttribute.value=this.mailFooter,this.htmlMailAttribute.value=this.htmlInput.value,this.data.groupId?this.attributesManager.setGroupAttribute({group:this.data.groupId,attribute:this.mailAttribute}).subscribe({next:()=>{this.htmlEditAuth&&this.attributesManager.setGroupAttribute({group:this.data.groupId,attribute:this.htmlMailAttribute}).subscribe({next:()=>{this.notificationSuccess(),this.dialogRef.close()},error:()=>this.loading=!1})},error:()=>this.loading=!1}):this.attributesManager.setVoAttribute({vo:this.data.voId,attribute:this.mailAttribute}).subscribe({next:()=>{this.htmlEditAuth&&this.attributesManager.setVoAttribute({vo:this.data.voId,attribute:this.htmlMailAttribute}).subscribe({next:()=>{this.notificationSuccess(),this.dialogRef.close()},error:()=>this.loading=!1})},error:()=>this.loading=!1})}cancel(){this.dialogRef.close()}getFooterForVo(){this.attributesManager.getVoAttributeByName(this.data.voId,Re.VO_DEF_MAIL_FOOTER).subscribe({next:e=>{this.mailAttribute=e,this.plainEdithAuth=this.mailAttribute.writable,e.value?this.mailFooter=String(e.value):this.mailFooter="",this.loading=!1},error:()=>this.loading=!1}),this.attributesManager.getVoAttributeByName(this.data.voId,Re.VO_DEF_MAIL_HTML_FOOTER).subscribe({next:e=>{this.htmlMailAttribute=e,this.htmlEditAuth=this.htmlMailAttribute.writable,e.value?this.htmlInput.setValue(String(e.value)):this.htmlInput.setValue(""),this.loading=!1},error:()=>this.loading=!1})}getFooterForGroup(){this.attributesManager.getGroupAttributeByName(this.data.groupId,Re.GROUP_DEF_MAIL_FOOTER).subscribe({next:e=>{this.mailAttribute=e,this.plainEdithAuth=this.mailAttribute.writable,e.value?this.mailFooter=String(e.value):this.mailFooter="",this.loading=!1},error:()=>this.loading=!1}),this.attributesManager.getGroupAttributeByName(this.data.groupId,Re.GROUP_DEF_MAIL_HTML_FOOTER).subscribe({next:e=>{this.htmlMailAttribute=e,this.htmlEditAuth=this.htmlMailAttribute.writable,e.value?this.htmlInput.setValue(String(e.value)):this.htmlInput.setValue(""),this.loading=!1},error:()=>this.loading=!1})}notificationSuccess(){this.translateService.get("DIALOGS.NOTIFICATIONS_EDIT_FOOTER.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close()})}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ut),u(X),u(j),u(ee))}}static{this.\u0275cmp=M({type:t,selectors:[["app-edit-email-footer-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],["alert_type","info"],["color","primary","mat-stretch-tabs","false"],[3,"disabled"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],[3,"matTooltipDisabled","matTooltipPosition","matTooltip"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"],["mat-tab-label",""],["subscriptSizing","dynamic",1,"w-100"],[3,"inputFormControl","tagType","hint","minRows"],[3,"ngClass"],["matInput","","rows","5",3,"ngModelChange","ngModel"]],template:function(i,n){if(i&1&&(A(0,Fd,1,0,"ng-template",null,0,L),a(2,"div"),A(3,zd,20,23,"div",1),r()),i&2){let l=y(1);o(2),ce(pe("",n.theme," position-relative")),o(),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,Zi,N,V,He,We,on,lt,st,at,nt,ye,ot,Ne,oe,te,ne,ie,$e,ze,ue,si,oi,ai,ri,O,Ae,En,P,Ii,R],styles:[".disabled-label[_ngcontent-%COMP%]{color:#00000061!important}  .mat-mdc-form-field-error-wrapper{position:relative!important;word-break:break-word}"]})}}return t})();function $d(t,c){if(t&1){let e=T();a(0,"div")(1,"mat-expansion-panel")(2,"mat-expansion-panel-header")(3,"mat-panel-title",1),C("dragstart",function(n){let l=f(e).$implicit,E=p();return h(E.setDraggedText(n,l[0]))}),a(4,"mat-icon",2),s(5,"drag_indicator"),r(),a(6,"span",3),s(7),r()()(),a(8,"span",4),s(9),d(10,"translate"),r()(),S(11,"mat-divider",5),r()}if(t&2){let e=c.$implicit;o(7),b("{"+e[0]+"}"),o(2),b(m(10,2,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL."+e[1]))}}var hs=(()=>{class t{constructor(){this.tags=[]}setDraggedText(e,i){e.dataTransfer.setData("text/plain","{"+i+"}")}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=M({type:t,selectors:[["app-tag-section"]],inputs:{tags:"tags"},decls:5,vars:4,consts:[[1,"mb-2",3,"innerHTML"],["draggable","true",3,"dragstart"],[1,"handle-icon","me-3"],[1,"tag-text-header"],[1,"tag-text"],[1,"mt-1","mb-1"]],template:function(i,n){i&1&&(a(0,"div"),S(1,"div",0),d(2,"translate"),Ce(3,$d,12,4,"div",null,Oe),r()),i&2&&(o(),_("innerHTML",Y(m(2,2,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.TAG_ADDING_DESC")),Dt),o(2),Se(n.tags))},dependencies:[D,et,Je,Ro,xo,Mo,Do,Mi,O,R],styles:[".tag-text-header[_ngcontent-%COMP%]{font-size:1rem;font-weight:550}.tag-text[_ngcontent-%COMP%]{margin-top:-.2rem;font-size:1rem;opacity:.7}.handle-icon[_ngcontent-%COMP%]{font-size:22px;margin-left:-4px}"]})}}return t})();var vs=(()=>{class t{constructor(e){this.store=e,this.tagsDescriptionsMappings=new Map}ngOnInit(){this.notificationTypeAllowedTags=this.store.getProperty("notification_tags"),this.getTagsDescriptionsMappings(),this.notificationType.subscribe(e=>{this.availableTagsWithDescriptions=this.notificationTypeAllowedTags[e].map(i=>[i,this.tagsDescriptionsMappings.get(i)])})}getTagsDescriptionsMappings(){this.tagsDescriptionsMappings.set("appId","APPID_DESCRIPTION"),this.tagsDescriptionsMappings.set("actor","ACTOR_DESCRIPTION"),this.tagsDescriptionsMappings.set("extSource","EXTSOURCE_DESCRIPTION"),this.tagsDescriptionsMappings.set("voName","VONAME_DESCRIPTION"),this.tagsDescriptionsMappings.set("groupName","GROUPNAME_DESCRIPTION"),this.tagsDescriptionsMappings.set("mailFooter","MAILFOOTER_DESCRIPTION"),this.tagsDescriptionsMappings.set("htmlMailFooter","HTMLMAILFOOTER_DESCRIPTION"),this.tagsDescriptionsMappings.set("errors","ERRORS_DESCRIPTION"),this.tagsDescriptionsMappings.set("customMessage","CUSTOMMESSAGE_DESCRIPTION"),this.tagsDescriptionsMappings.set("autoApproveError","AUTOAPPROVEERROR_DESCRIPTION"),this.tagsDescriptionsMappings.set("fromApp-itemName","FROMAPPITEMNAME_DESCRIPTION"),this.tagsDescriptionsMappings.set("firstName","FIRSTNAME_DESCRIPTION"),this.tagsDescriptionsMappings.set("lastName","LASTNAME_DESCRIPTION"),this.tagsDescriptionsMappings.set("displayName","DISPLAYNAME_DESCRIPTION"),this.tagsDescriptionsMappings.set("mail","MAIL_DESCRIPTION"),this.tagsDescriptionsMappings.set("phone","PHONE_DESCRIPTION"),this.tagsDescriptionsMappings.set("login-namespace","LOGINNAMESPACE_DESCRIPTION"),this.tagsDescriptionsMappings.set("membershipExpiration","MEMBERSHIPEXPIRATION_DESCRIPTION"),this.tagsDescriptionsMappings.set("validationLink","VALIDATIONLINK_DESCRIPTION"),this.tagsDescriptionsMappings.set("validationLink-krb","VALIDATIONKRB_DESCRIPTION"),this.tagsDescriptionsMappings.set("validationLink-fed","VALIDATIONFED_DESCRIPTION"),this.tagsDescriptionsMappings.set("validationLink-cert","VALIDATIONCERT_DESCRIPTION"),this.tagsDescriptionsMappings.set("validationLink-non","VALIDATIONNON_DESCRIPTION"),this.tagsDescriptionsMappings.set("redirectUrl","REDIRECTURL_DESCRIPTION"),this.tagsDescriptionsMappings.set("appGuiUrl","APPGUIURL_DESCRIPTION"),this.tagsDescriptionsMappings.set("appGuiUrl-krb","APPGUIURLKRB_DESCRIPTION"),this.tagsDescriptionsMappings.set("appGuiUrl-fed","APPGUIURLFED_DESCRIPTION"),this.tagsDescriptionsMappings.set("appGuiUrl-cert","APPGUIURLCERT_DESCRIPTION"),this.tagsDescriptionsMappings.set("appGuiUrl-non","APPGUIURLNON_DESCRIPTION"),this.tagsDescriptionsMappings.set("appDetailUrl","APPDETAILURL_DESCRIPTION"),this.tagsDescriptionsMappings.set("appDetailUrl-krb","APPDETAILURLKRB_DESCRIPTION"),this.tagsDescriptionsMappings.set("appDetailUrl-fed","APPDETAILURLFED_DESCRIPTION"),this.tagsDescriptionsMappings.set("appDetailUrl-cert","APPDETAILURLCERT_DESCRIPTION"),this.tagsDescriptionsMappings.set("appDetailUrl-newGUI","APPDETAILURLNEWGUI_DESCRIPTION"),this.tagsDescriptionsMappings.set("perunGuiUrl","PERUNGUIURL_DESCRIPTION"),this.tagsDescriptionsMappings.set("perunGuiUrl-krb","PERUNGUIURLKRB_DESCRIPTION"),this.tagsDescriptionsMappings.set("perunGuiUrl-fed","PERUNGUIURLFED_DESCRIPTION"),this.tagsDescriptionsMappings.set("perunGuiUrl-cert","PERUNGUIURLCERT_DESCRIPTION"),this.tagsDescriptionsMappings.set("perunGuiUrl-newGUI","PERUNGUINEWGUI_DESCRIPTION"),this.tagsDescriptionsMappings.set("displayName","USER_INVITATIONS_DISPLAYNAME_DESCRIPTION"),this.tagsDescriptionsMappings.set("mailFooter","USER_INVITATIONS_MAILFOOTER_DESCRIPTION"),this.tagsDescriptionsMappings.set("htmlMailFooter","USER_INVITATIONS_HTMLMAILFOOTER_DESCRIPTION"),this.tagsDescriptionsMappings.set("invitationLink","INVITATIONLINK_DESCRIPTION"),this.tagsDescriptionsMappings.set("invitationLink-krb","INVITATIONLINKKRB_DESCRIPTION"),this.tagsDescriptionsMappings.set("invitationLink-fed","INVITATIONLINKFED_DESCRIPTION"),this.tagsDescriptionsMappings.set("invitationLink-cert","INVITATIONLINKCERT_DESCRIPTION"),this.tagsDescriptionsMappings.set("invitationLink-non","INVITATIONLINKNON_DESCRIPTION"),this.tagsDescriptionsMappings.set("displayName","USER_INVITATIONS_DISPLAYNAME_DESCRIPTION"),this.tagsDescriptionsMappings.set("preapprovedInvitationLink","USER_PREAPPROVED_INVITATIONS_LINK_DESCRIPTION"),this.tagsDescriptionsMappings.set("expirationDate","USER_PREAPPROVED_INVITATIONS_EXPIRATION_DESCRIPTION"),this.tagsDescriptionsMappings.set("senderName","USER_PREAPPROVED_INVITATIONS_SENDER_NAME_DESCRIPTION")}static{this.\u0275fac=function(i){return new(i||t)(u(Xe))}}static{this.\u0275cmp=M({type:t,selectors:[["app-tag-bar"]],inputs:{notificationType:"notificationType"},decls:2,vars:1,consts:[["cdkScrollable","",1,"scrollable","pt-4","pb-2","pe-2"],[3,"tags"]],template:function(i,n){i&1&&(a(0,"div",0),S(1,"app-tag-section",1),r()),i&2&&(o(),_("tags",n.availableTagsWithDescriptions))},dependencies:[D,co,hs],styles:[".scrollable[_ngcontent-%COMP%]{max-height:100%;overflow:auto}"]})}}return t})();var Yd=t=>({"disabled-label":t});function Xd(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function qd(t,c){t&1&&(a(0,"div")(1,"h1",4),s(2),d(3,"translate"),r()()),t&2&&(o(2),g(" ",m(3,1,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.TITLE_CREATE")," "))}function Kd(t,c){t&1&&(a(0,"h1",4),s(1),d(2,"translate"),r()),t&2&&(o(),b(m(2,1,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.TITLE_EDIT")))}function Zd(t,c){t&1&&(a(0,"mat-option",17),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.SETTINGS.NOTIFICATIONS.MAIL_TYPE_APPROVABLE_GROUP_APP_USER")," "))}function Qd(t,c){t&1&&(a(0,"mat-option",24),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.SETTINGS.NOTIFICATIONS.MAIL_TYPE_USER_PRE_APPROVED_INVITE")," "))}function Jd(t,c){t&1&&(a(0,"div",27),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.EMAIL_TYPE_DESCRIPTION_EDIT")," "))}function em(t,c){t&1&&(a(0,"div",27),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.EMAIL_TYPE_DESCRIPTION_CREATE")," "))}function tm(t,c){t&1&&(a(0,"mat-option",32),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.EXTENSION")," "))}function im(t,c){t&1&&(a(0,"div",27),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.APPLICATION_TYPE_DESCRIPTION_EDIT")," "))}function nm(t,c){t&1&&(a(0,"div",27),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.APPLICATION_TYPE_DESCRIPTION_CREATE")," "))}function om(t,c){t&1&&(a(0,"perun-web-apps-alert",42),S(1,"i",45),d(2,"translate"),r()),t&2&&(o(),_("innerHTML",m(2,1,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.FORMAT_INFO"),Dt))}function am(t,c){t&1&&(a(0,"perun-web-apps-alert",42),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.FORMAT_INFO_NOT_AUTHORIZED")," "))}function rm(t,c){if(t&1&&(a(0,"span",56),s(1),d(2,"uppercase"),d(3,"translate"),r()),t&2){let e=p().$implicit,i=p(4);_("ngClass",Ee(6,Yd,e==="html"&&!i.htmlAuth)),o(),g(" ",m(3,4,m(2,2,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.FORMAT_"+e))," ")}}function sm(t,c){if(t&1&&(a(0,"mat-form-field",52),S(1,"input",57),r()),t&2){let e=p(3).$implicit,i=p(2);o(),_("id",Y(i.subjectId))("formControlName",pe("",e,"-plain-subject"))}}function lm(t,c){if(t&1&&S(0,"perun-web-apps-html-content-form-field",53),t&2){let e=p(3).$implicit,i=p(2);_("inputFormControl",i.inputFormGroup.controls[e+"-html-subject"])("tagType","input")("tabId",i.subjectId)("cd",i.cd)}}function pm(t,c){if(t&1&&(a(0,"mat-error"),s(1),d(2,"translate"),r()),t&2){let e=p(4).$implicit,i=p(2);o(),g(" ",m(2,1,i.inputFormGroup.controls[e+"-plain-text"].errors==null?null:i.inputFormGroup.controls[e+"-plain-text"].errors.missingTags)," ")}}function cm(t,c){if(t&1&&(a(0,"mat-form-field",52)(1,"textarea",58),s(2,"                                  "),r(),v(3,pm,3,3,"mat-error"),r()),t&2){let e=p(3).$implicit,i=p(2);o(),_("id",Y(i.textareaId))("formControlName",pe("",e,"-plain-text")),o(2),I(i.inputFormGroup.controls[e+"-plain-text"]!=null&&i.inputFormGroup.controls[e+"-plain-text"].hasError("missingTags")?3:-1)}}function dm(t,c){if(t&1&&S(0,"perun-web-apps-html-content-form-field",55),t&2){let e=p(3).$implicit,i=p(2);_("inputFormControl",i.inputFormGroup.controls[e+"-html-text"])("tagType","textarea")("tabId",i.textareaId)("cd",i.cd)("minRows",17)}}function mm(t,c){if(t&1){let e=T();a(0,"mat-tab",44),A(1,rm,4,8,"ng-template",46),a(2,"div",47)(3,"div",48)(4,"div",49)(5,"button",50),C("click",function(){f(e);let n=p(4);return h(n.showTags=!n.showTags)}),s(6),d(7,"translate"),d(8,"translate"),r(),a(9,"span",51),s(10),d(11,"translate"),r(),v(12,sm,2,4,"mat-form-field",52),v(13,lm,1,4,"perun-web-apps-html-content-form-field",53),r(),a(14,"div",54),s(15),d(16,"translate"),r(),v(17,cm,4,5,"mat-form-field",52),v(18,dm,1,5,"perun-web-apps-html-content-form-field",55),r()()()}if(t&2){let e=c.$implicit,i=p(4);_("disabled",e==="html"&&!i.htmlAuth),o(6),g(" ",i.showTags?m(7,8,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.HIDE_TAGS"):m(8,10,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.SHOW_TAGS")," "),o(4),g(" ",m(11,12,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.SUBJECT"),": "),o(2),I(e==="plain"?12:-1),o(),I(e==="html"?13:-1),o(2),g(" ",m(16,14,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.TEXT"),": "),o(2),I(e==="plain"?17:-1),o(),I(e==="html"?18:-1)}}function um(t,c){if(t&1&&(v(0,om,3,3,"perun-web-apps-alert",42),v(1,am,3,3,"perun-web-apps-alert",42),a(2,"mat-tab-group",43),Ce(3,mm,19,16,"mat-tab",44,Oe),r()),t&2){let e=p(3);I(e.htmlAuth?0:-1),o(),I(e.htmlAuth?-1:1),o(2),Se(e.formats)}}function _m(t,c){if(t&1&&(a(0,"mat-tab",34),d(1,"uppercase"),d(2,"translate"),A(3,um,5,2,"ng-template",41),r()),t&2){let e=c.$implicit,i=p(2);_("label",Y(m(2,5,m(1,3,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.LANG_"+e))))("formGroup",i.inputFormGroup)}}function gm(t,c){if(t&1){let e=T();a(0,"button",59),C("click",function(){f(e);let n=p(2);return h(n.create())}),s(1),d(2,"translate"),r()}if(t&2){let e=p(2);_("disabled",e.invalidNotification||e.inputFormGroup.invalid||e.inputFormGroup.pending||e.applicationMail.send&&e.noneFilled),o(),g(" ",m(2,2,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.CREATE_BUTTON")," ")}}function fm(t,c){if(t&1){let e=T();a(0,"button",59),C("click",function(){f(e);let n=p(2);return h(n.save())}),s(1),d(2,"translate"),r()}if(t&2){let e=p(2);_("disabled",!e.editAuth||e.inputFormGroup.invalid||e.inputFormGroup.pending||e.applicationMail.send&&e.noneFilled),o(),g(" ",m(2,2,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.SAVE_BUTTON")," ")}}function hm(t,c){if(t&1){let e=T();a(0,"div",2)(1,"div",3),v(2,qd,4,3,"div")(3,Kd,3,3,"h1",4),a(4,"div",5)(5,"div",6)(6,"div",7)(7,"div")(8,"perun-web-apps-alert",8),s(9),d(10,"translate"),r()(),a(11,"mat-tab-group",9),C("selectedTabChange",function(n){f(e);let l=p();return h(l.tabChanged(n))}),a(12,"mat-tab",10),d(13,"translate"),a(14,"div",11)(15,"span",12),s(16),d(17,"translate"),r(),a(18,"div",13)(19,"mat-form-field",14)(20,"mat-select",15),C("valueChange",function(n){f(e);let l=p();return h(l.toggleMailType(n))})("selectionChange",function(){f(e);let n=p();return h(n.notificationExist())}),le("valueChange",function(n){f(e);let l=p();return se(l.applicationMail.mailType,n)||(l.applicationMail.mailType=n),h(n)}),a(21,"mat-option",16),s(22),d(23,"translate"),r(),v(24,Zd,3,3,"mat-option",17),a(25,"mat-option",18),s(26),d(27,"translate"),r(),a(28,"mat-option",19),s(29),d(30,"translate"),r(),a(31,"mat-option",20),s(32),d(33,"translate"),r(),a(34,"mat-option",21),s(35),d(36,"translate"),r(),a(37,"mat-option",22),s(38),d(39,"translate"),r(),a(40,"mat-option",23),s(41),d(42,"translate"),r(),v(43,Qd,3,3,"mat-option",24),r()()()(),a(44,"div",25),S(45,"span",26),v(46,Jd,3,3,"div",27),v(47,em,3,3,"div",27),r(),a(48,"div",28)(49,"span",29),s(50),d(51,"translate"),r(),a(52,"div",13)(53,"mat-form-field",14)(54,"mat-select",30),le("ngModelChange",function(n){f(e);let l=p();return se(l.applicationMail.appType,n)||(l.applicationMail.appType=n),h(n)}),C("selectionChange",function(){f(e);let n=p();return h(n.notificationExist())}),a(55,"mat-option",31),s(56),d(57,"translate"),r(),v(58,tm,3,3,"mat-option",32),r()()()(),a(59,"div",25),S(60,"span",26),v(61,im,3,3,"div",27),v(62,nm,3,3,"div",27),r(),a(63,"div",28)(64,"span",29),s(65),d(66,"translate"),r(),a(67,"div",13)(68,"mat-checkbox",33),le("ngModelChange",function(n){f(e);let l=p();return se(l.applicationMail.send,n)||(l.applicationMail.send=n),h(n)}),r()()(),a(69,"div",25),S(70,"span",26),a(71,"div",27),s(72),d(73,"translate"),r()()(),Ce(74,_m,4,7,"mat-tab",34,Oe),r()()()(),a(76,"div",35)(77,"button",36),C("click",function(){f(e);let n=p();return h(n.cancel())}),s(78),d(79,"translate"),r(),a(80,"div",37),d(81,"mailNotificationTooltip"),v(82,gm,3,4,"button",38),v(83,fm,3,4,"button",38),r()()(),a(84,"div",39),S(85,"app-tag-bar",40),r()()}if(t&2){let e=p();o(2),I(e.data.createMailNotification?2:3),o(5),_("@openClose",e.invalidNotification?"open":"closed"),o(2),b(m(10,37,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.INVALID_NOTIFICATION")),o(3),_("label",Y(m(13,39,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.BASIC_SETTINGS"))),o(4),g("",m(17,41,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.EMAIL_TYPE")," :"),o(4),_("disabled",!e.data.createMailNotification),re("value",e.applicationMail.mailType),o(2),g(" ",m(23,43,"VO_DETAIL.SETTINGS.NOTIFICATIONS.MAIL_TYPE_APP_CREATED_USER")," "),o(2),I(e.data.groupId?24:-1),o(2),g(" ",m(27,45,"VO_DETAIL.SETTINGS.NOTIFICATIONS.MAIL_TYPE_APP_CREATED_VO_ADMIN")," "),o(3),g(" ",m(30,47,"VO_DETAIL.SETTINGS.NOTIFICATIONS.MAIL_TYPE_MAIL_VALIDATION")," "),o(3),g(" ",m(33,49,"VO_DETAIL.SETTINGS.NOTIFICATIONS.MAIL_TYPE_APP_APPROVED_USER")," "),o(3),g(" ",m(36,51,"VO_DETAIL.SETTINGS.NOTIFICATIONS.MAIL_TYPE_APP_REJECTED_USER")," "),o(3),g(" ",m(39,53,"VO_DETAIL.SETTINGS.NOTIFICATIONS.MAIL_TYPE_APP_ERROR_VO_ADMIN")," "),o(3),g(" ",m(42,55,"VO_DETAIL.SETTINGS.NOTIFICATIONS.MAIL_TYPE_USER_INVITE")," "),o(2),I(e.data.groupId?43:-1),o(3),I(e.data.createMailNotification?-1:46),o(),I(e.data.createMailNotification?47:-1),o(3),g("",m(51,57,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.APPLICATION_TYPE")," :"),o(4),re("ngModel",e.applicationMail.appType),_("disabled",!e.data.createMailNotification),o(2),g(" ",m(57,59,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.INITIAL")," "),o(2),I(e.applicationMail.mailType!=="USER_INVITE"&&e.applicationMail.mailType!=="USER_PRE_APPROVED_INVITE"?58:-1),o(3),I(e.data.createMailNotification?-1:61),o(),I(e.data.createMailNotification?62:-1),o(3),g("",m(66,61,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.SENDING_ENABLED")," :"),o(3),re("ngModel",e.applicationMail.send),o(4),g(" ",m(73,63,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.SENDING_ENABLED_DESCRIPTION")," "),o(2),Se(e.languages),o(4),g(" ",m(79,65,"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.CANCEL_BUTTON")," "),o(2),_("matTooltipDisabled",e.editAuth&&!e.inputFormGroup.invalid&&(!e.noneFilled||!e.applicationMail.send))("matTooltipPosition","above")("matTooltip",lo(81,67,e.editAuth,e.inputFormGroup.invalid,e.applicationMail.send&&e.noneFilled,e.missingTagsErrorExists())),o(2),I(e.data.createMailNotification?82:-1),o(),I(e.data.createMailNotification?-1:83),o(),_("@tagsOpenClose",e.showTags?"open":"closed"),o(),_("notificationType",e.mailType)}}var ki=(()=>{class t{constructor(e,i,n,l,E,x,w,U){this.dialogRef=e,this.registrarService=i,this.data=n,this.authResolver=l,this.groupsService=E,this.store=x,this.translate=w,this.cd=U,this.mailType=new me(this.data.applicationMail.mailType),this.showTags=!1,this.invalidNotification=!1,this.loading=!1,this.languages=["en"],this.formats=["plain","html"],this.inputFormGroup=null,this.subjectId="perun-subject-input-id",this.textareaId="perun-text-textarea-id",this.noneFilled=!0}ngOnInit(){if(this.languages=this.store.getProperty("supported_languages"),this.htmlAuth=this.authResolver.isPerunAdmin(),this.applicationMail=this.data.applicationMail,this.theme=this.data.theme,this.data.groupId)this.groupsService.getGroupById(this.data.groupId).subscribe(i=>{this.editAuth=this.authResolver.isAuthorized("group-addMail_ApplicationForm_ApplicationMail_policy",[i])});else if(this.data.voId){let i={id:this.data.voId,beanName:"Vo"};this.editAuth=this.authResolver.isAuthorized("vo-addMail_ApplicationForm_ApplicationMail_policy",[i])}let e={};for(let i of this.languages)e[`${i}-plain-subject`]=new ct(this.applicationMail.message[i].subject,[]),e[`${i}-plain-text`]=new ct(this.applicationMail.message[i].text,[],[this.requestedTagsValidator.bind(this)]),e[`${i}-html-subject`]=new ct(this.applicationMail.htmlMessage[i].subject,[]),e[`${i}-html-text`]=new ct(this.applicationMail.htmlMessage[i].text,[],[this.requestedTagsValidator.bind(this)]),e[`${i}-html-subject`].markAsTouched(),e[`${i}-html-text`].markAsTouched();this.inputFormGroup=new mo(e),this.checkEmptyContent(),this.inputFormGroup.valueChanges.subscribe(()=>{this.checkEmptyContent()})}requestedTagsValidator(e){return to(500).pipe(zt(()=>{let i=String(e.value);return this.applicationMail.mailType===gt.USER_PRE_APPROVED_INVITE&&i?.length>0&&(!i.includes("{preapprovedInvitationLink}")||!String(e.value).includes("{expirationDate}"))?ui({missingTags:"DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.MISSING_TAGS_ERROR"}):ui(null)}))}missingTagsErrorExists(){return Object.keys(this.inputFormGroup.controls).some(e=>this.inputFormGroup.get(e)?.hasError("missingTags"))}cancel(){this.dialogRef.close()}create(){this.notificationExist(),!this.invalidNotification&&(this.loading=!0,this.prepareNotification(),this.data.groupId?this.registrarService.addApplicationMailForGroup({group:this.data.groupId,mail:this.applicationMail}).subscribe({next:()=>{this.dialogRef.close(!0)},error:()=>this.loading=!1}):this.registrarService.addApplicationMailForVo({vo:this.data.voId,mail:this.applicationMail}).subscribe({next:()=>{this.dialogRef.close(!0)},error:()=>this.loading=!1}))}save(){this.loading=!0,this.prepareNotification(),this.registrarService.updateApplicationMail({mail:this.applicationMail}).subscribe({next:()=>{this.dialogRef.close(!0)},error:()=>this.loading=!1})}notificationExist(){for(let e of this.data.applicationMails)if(e.mailType===this.applicationMail.mailType&&e.appType===this.applicationMail.appType){this.invalidNotification=!0;return}this.invalidNotification=!1}tabChanged(e){e.index===0&&(this.showTags=!1)}toggleMailType(e){if(this.previousMailType===gt.USER_PRE_APPROVED_INVITE&&e!==this.previousMailType){let i=this.languages.map(n=>Hn(this.translate.getTranslation(n)));Promise.all(i).then(n=>{n.forEach((l,E)=>{let x=this.languages[E],w=String(l.DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.DEFAULT_PRE_APPROVED_MAIL_TEXT),U=String(l.DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.DEFAULT_PRE_APPROVED_MAIL_SUBJECT);this.inputFormGroup.get([`${x}-plain-text`]).value===w&&this.inputFormGroup.get([`${x}-plain-text`]).setValue(""),this.inputFormGroup.get([`${x}-plain-subject`]).value===U&&this.inputFormGroup.get([`${x}-plain-subject`]).setValue("")})})}else if(e===gt.USER_PRE_APPROVED_INVITE){let i=this.languages.map(n=>Hn(this.translate.getTranslation(n)));Promise.all(i).then(n=>{n.forEach((l,E)=>{let x=this.languages[E],w=String(l.DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.DEFAULT_PRE_APPROVED_MAIL_TEXT),U=String(l.DIALOGS.NOTIFICATIONS_ADD_EDIT_MAIL.DEFAULT_PRE_APPROVED_MAIL_SUBJECT);this.inputFormGroup.patchValue({[`${x}-plain-text`]:w}),this.inputFormGroup.patchValue({[`${x}-plain-subject`]:U})})})}this.previousMailType=e,this.applicationMail.mailType=e,this.mailType.next(this.applicationMail.mailType)}prepareNotification(){for(let e of this.languages)this.applicationMail.htmlMessage[e].subject=this.inputFormGroup.get(`${e}-html-subject`).value,this.applicationMail.htmlMessage[e].text=this.inputFormGroup.get(`${e}-html-text`).value,this.applicationMail.message[e].subject=this.inputFormGroup.get(`${e}-plain-subject`).value,this.applicationMail.message[e].text=this.inputFormGroup.get(`${e}-plain-text`).value}checkEmptyContent(){for(let e of this.languages)if(this.inputFormGroup.get(`${e}-html-text`).value?.length>0&&this.inputFormGroup.get(`${e}-html-subject`).value?.length>0||this.inputFormGroup.get(`${e}-plain-text`).value?.length>0&&this.inputFormGroup.get(`${e}-plain-subject`).value?.length>0){this.noneFilled=!1;return}this.noneFilled=!0}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(Ie),u(ee),u(k),u(we),u(Xe),u(mt),u(ht))}}static{this.\u0275cmp=M({type:t,selectors:[["app-add-edit-notification-dialog"]],decls:4,vars:5,consts:[["spinner",""],["class","h-100 d-flex flex-row",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[1,"h-100","d-flex","flex-row"],[1,"h-100","w-100","d-flex","flex-column"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],[1,"d-flex","flex-row"],[1,"d-flex","flex-column","w-100"],["alert_type","error"],["color","primary","mat-stretch-tabs","false",3,"selectedTabChange"],[3,"label"],[1,"mt-3","d-flex"],[1,"w-25","m-auto","fw-bold"],[1,"w-75"],[1,"w-100"],["disableOptionCentering","",3,"valueChange","selectionChange","disabled","value"],["value","APP_CREATED_USER"],["value","APPROVABLE_GROUP_APP_USER"],["value","APP_CREATED_VO_ADMIN"],["value","MAIL_VALIDATION"],["value","APP_APPROVED_USER"],["value","APP_REJECTED_USER"],["value","APP_ERROR_VO_ADMIN"],["value","USER_INVITE"],["value","USER_PRE_APPROVED_INVITE"],[1,"d-flex","mb-3"],[1,"w-25"],[1,"w-75","font-italic","text-muted"],[1,"d-flex"],[1,"w-25","fw-bold"],["disableOptionCentering","",3,"ngModelChange","selectionChange","ngModel","disabled"],["value","INITIAL"],["value","EXTENSION"],[3,"ngModelChange","ngModel"],[3,"label","formGroup"],["mat-dialog-actions","",1,"d-flex","mt-auto"],["mat-stroked-button","",1,"ms-auto",3,"click"],[3,"matTooltipDisabled","matTooltipPosition","matTooltip"],["color","accent","mat-flat-button","",1,"ms-2",3,"disabled"],[1,"ms-4"],[3,"notificationType"],["matTabContent",""],["alert_type","info"],["color","primary","mat-stretch-tabs","false"],[3,"disabled"],[3,"innerHTML"],["mat-tab-label",""],[1,"d-flex","w-100"],[1,"pe-2","w-100"],[1,"pt-2"],["mat-stroked-button","",1,"right-button",3,"click"],[1,"fw-bold","pe-2"],["subscriptSizing","dynamic",1,"w-100"],[3,"inputFormControl","tagType","tabId","cd"],[1,"fw-bold"],[3,"inputFormControl","tagType","tabId","cd","minRows"],[3,"ngClass"],["matInput","",3,"id","formControlName"],["matInput","","rows","17",3,"id","formControlName"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(i,n){if(i&1&&(A(0,Xd,1,0,"ng-template",null,0,L),a(2,"div"),A(3,hm,86,72,"div",1),r()),i&2){let l=y(1);o(2),ce(pe("",n.theme," position-relative h-100")),o(),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,Zi,N,V,He,We,bi,lt,st,Bt,Gt,Pt,Ti,Ei,Ne,nt,ye,Ci,en,tn,at,ot,oe,te,ne,ie,$e,ze,ue,si,Oi,oi,ai,ri,O,Ae,En,P,vs,Ii,R,aa],styles:[".right-button[_ngcontent-%COMP%]{display:block;margin-left:auto}.disabled-label[_ngcontent-%COMP%]{color:#00000061!important}  .mat-mdc-form-field-error-wrapper{position:relative!important;word-break:break-word}"],data:{animation:[ka,Wt]}})}}return t})();function vm(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function Im(t,c){if(t&1){let e=T();a(0,"div")(1,"h1",2),s(2),d(3,"translate"),r(),a(4,"div",3)(5,"div",4),s(6),d(7,"translate"),r(),s(8),d(9,"translate"),a(10,"perun-web-apps-vo-search-select",5),C("voSelected",function(n){f(e);let l=p();return h(l.voSelected(n))}),r(),s(11),d(12,"translate"),a(13,"perun-web-apps-group-search-select",6),C("groupSelected",function(n){f(e);let l=p();return h(l.selectedGroup=n)}),r()(),a(14,"div",7)(15,"button",8),C("click",function(){f(e);let n=p();return h(n.cancel())}),s(16),d(17,"translate"),r(),a(18,"button",9),C("click",function(){f(e);let n=p();return h(n.submit())}),s(19),d(20,"translate"),r()()()}if(t&2){let e=p();o(2),b(m(3,11,"DIALOGS.NOTIFICATIONS_COPY_MAILS.TITLE")),o(4),g(" ",m(7,13,"DIALOGS.NOTIFICATIONS_COPY_MAILS.DESCRIPTION")," "),o(2),g(" ",m(9,15,"DIALOGS.NOTIFICATIONS_COPY_MAILS.SOURCE_VO"),": "),o(2),_("vos",e.vos),o(),g(" ",m(12,17,"DIALOGS.NOTIFICATIONS_COPY_MAILS.SOURCE_GROUP"),": "),o(2),_("groups",e.groups)("firstSelectedGroup",e.selectedGroup)("disableAutoSelect",!0),o(3),g(" ",m(17,19,"DIALOGS.NOTIFICATIONS_COPY_MAILS.CANCEL_BUTTON")," "),o(2),_("disabled",!e.selectedVo&&!e.selectedGroup||e.loading),o(),g(" ",m(20,21,"DIALOGS.NOTIFICATIONS_COPY_MAILS.SUBMIT_BUTTON")," ")}}var Ln=(()=>{class t{constructor(e,i,n,l,E,x,w){this.dialogRef=e,this.voService=i,this.groupService=n,this.translateService=l,this.registrarService=E,this.cd=x,this.data=w,this.vos=[],this.groups=[],this.selectedVo=null,this.selectedGroup=null,this.loading=!1,this.nameFunction=U=>U.name}ngOnInit(){this.theme=this.data.theme,this.loading=!0,this.translateService.get("DIALOGS.NOTIFICATIONS_COPY_MAILS.NO_GROUP_SELECTED").subscribe({next:e=>{this.fakeGroup={id:-1,name:e,voId:0,parentGroupId:0,shortName:"",description:"",beanName:"group"},this.selectedGroup=this.fakeGroup,this.voService.getAllVos().subscribe(i=>{this.vos=i,this.loading=!1,this.vos.length>0&&this.voSelected(this.vos.sort(Wo)[0])})},error:()=>{this.loading=!1}})}cancel(){this.dialogRef.close(!1)}submit(){this.loading=!0,this.data.groupId?this.selectedGroup===this.fakeGroup?this.registrarService.copyMailsFromVoToGroup(this.selectedVo.id,this.data.groupId).subscribe({next:()=>{this.dialogRef.close(!0)},error:()=>{this.loading=!1}}):this.registrarService.copyMailsFromGroupToGroup(this.selectedGroup.id,this.data.groupId).subscribe({next:()=>{this.dialogRef.close(!0)},error:()=>{this.loading=!1}}):this.selectedGroup===this.fakeGroup?this.registrarService.copyMailsFromVoToVo(this.selectedVo.id,this.data.voId).subscribe({next:()=>{this.dialogRef.close(!0)},error:()=>{this.loading=!1}}):this.registrarService.copyMailsFromGroupToVo(this.selectedGroup.id,this.data.voId).subscribe({next:()=>{this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}voSelected(e){this.selectedVo=e,this.getGroups(),this.cd.detectChanges()}getGroups(){this.selectedVo?this.groupService.getAllGroups(this.selectedVo.id).subscribe(e=>{this.groups=[this.fakeGroup].concat(e)}):this.groups=[this.fakeGroup],this.selectedGroup=this.fakeGroup}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(de),u(we),u(mt),u(Ie),u(ht),u(ee))}}static{this.\u0275cmp=M({type:t,selectors:[["app-notifications-copy-mails-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],[1,"mb-2","font-italic"],[1,"long-input",3,"voSelected","vos"],[1,"long-input",3,"groupSelected","groups","firstSelectedGroup","disableAutoSelect"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(i,n){if(i&1&&(A(0,vm,1,0,"ng-template",null,0,L),a(2,"div"),A(3,Im,21,23,"div",1),r()),i&2){let l=y(1);o(2),ce(pe("",n.theme," position-relative")),o(),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,oe,te,ne,ie,ue,O,P,In,Va,R],encapsulation:2,data:{animation:[Wt]}})}}return t})();var Cm=t=>({all:t}),Sm=t=>({name:t});function Em(t,c){if(t&1){let e=T();a(0,"th",16)(1,"mat-checkbox",17),d(2,"masterCheckboxLabel"),d(3,"translate"),C("change",function(n){f(e);let l=p(2);return h(n?l.masterToggle():null)}),r()()}if(t&2){let e=p(),i=p();o(),_("aria-label",m(3,5,m(2,3,e.all)))("checked",i.selection.hasValue()&&e.all)("indeterminate",i.selection.hasValue()&&!e.all)}}function Tm(t,c){if(t&1){let e=T();a(0,"td",18)(1,"mat-checkbox",19),d(2,"checkboxLabel"),d(3,"translate"),C("change",function(n){let l=f(e).$implicit,E=p(2);return h(n?E.toggle(l):null)})("click",function(n){return f(e),h(n.stopPropagation())}),r()()}if(t&2){let e=c.$implicit,i=p(2);o(),_("aria-label",it(3,4,m(2,2,i.selection.isSelected(e)),Ee(7,Sm,i.getMailType(e))))("checked",i.selection.isSelected(e))}}function bm(t,c){t&1&&(fe(0,3),A(1,Em,4,7,"th",14)(2,Tm,4,9,"td",15),he())}function Am(t,c){t&1&&(a(0,"th",20),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.SETTINGS.NOTIFICATIONS.TABLE_EMAIL_ID")," "))}function xm(t,c){if(t&1&&(a(0,"td",21),s(1),r()),t&2){let e=c.$implicit;o(),g(" ",e.id," ")}}function Mm(t,c){t&1&&(a(0,"th",20),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.SETTINGS.NOTIFICATIONS.TABLE_EMAIL_TYPE")," "))}function Dm(t,c){if(t&1&&(a(0,"td",22),s(1),r()),t&2){let e=c.$implicit,i=p();o(),b(i.getMailType(e))}}function Rm(t,c){t&1&&(a(0,"th",20),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.SETTINGS.NOTIFICATIONS.TABLE_APPLICATION_TYPE")," "))}function Om(t,c){t&1&&(a(0,"div",23)(1,"mat-icon",24),s(2,"arrow_right_alt"),r(),s(3),d(4,"translate"),r()),t&2&&(o(3),g(" ",m(4,1,"VO_DETAIL.SETTINGS.NOTIFICATIONS.TABLE_APPLICATION_TYPE_INITIAL")," "))}function ym(t,c){t&1&&(a(0,"div",23)(1,"mat-icon",25),s(2,"cached"),r(),s(3),d(4,"translate"),r()),t&2&&(o(3),g(" ",m(4,1,"VO_DETAIL.SETTINGS.NOTIFICATIONS.TABLE_APPLICATION_TYPE_EXTENSION")," "))}function Nm(t,c){if(t&1&&(a(0,"td",22),v(1,Om,5,3,"div",23)(2,ym,5,3,"div",23),r()),t&2){let e=c.$implicit;o(),I(e.appType==="INITIAL"?1:2)}}function wm(t,c){t&1&&(a(0,"th",20),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.SETTINGS.NOTIFICATIONS.TABLE_SENDING_ENABLED")," "))}function Lm(t,c){if(t&1){let e=T();a(0,"td",22)(1,"section")(2,"mat-slide-toggle",26),d(3,"translate"),d(4,"appMailSendingDisabled"),C("change",function(){let n=f(e).$implicit,l=p();return h(l.changeSending(n))})("click",function(n){return f(e),h(n.stopPropagation())}),r()()()}if(t&2){let e=c.$implicit,i=p();o(2),_("matTooltip",Y(m(3,5,"VO_DETAIL.SETTINGS.NOTIFICATIONS.DISABLED_HINT")))("disabled",i.disableSend||m(4,7,e))("matTooltipDisabled",!i.disableSend)("ngModel",e.send)}}function Vm(t,c){t&1&&S(0,"tr",27)}function Pm(t,c){if(t&1){let e=T();a(0,"tr",28),C("click",function(){let n=f(e).$implicit,l=p();return h(l.openApplicationMailDetail(n))}),r()}t&2&&$("cursor-pointer",!0)}function Gm(t,c){t&1&&(a(0,"perun-web-apps-alert",13),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.SETTINGS.NOTIFICATIONS.NO_EMAILS")," "))}var Vn=(()=>{class t{constructor(e,i,n,l,E,x,w){this.registrarService=e,this.translate=i,this.notificator=n,this.dialog=l,this.authResolver=E,this.tableCheckbox=x,this.destroyRef=w,this.displayedColumns=["select","id","mailType","appType","send"],this.disableSend=!1,this.selection=new K(!0,[]),this.selectionChange=new _t,this.refreshTable=new _t,this.pageSizeOptions=Uo}set matSort(e){this.sort=e,this.setDataSource()}ngOnInit(){this.selection&&(this.cachedSelection=new K(this.selection.isMultipleSelection(),[],!0,this.selection.compareWith),this.cachedSubject?.pipe(gn(this.destroyRef)).subscribe(e=>{e&&this.cachedSelection.clear()}))}ngOnChanges(){localStorage.getItem("showIds")!=="true"&&(this.displayedColumns=this.displayedColumns.filter(e=>e!=="id")),this.dataSource=new Qe(this.applicationMails),this.setDataSource()}ngAfterViewInit(){this.dataSource.paginator=this.child.paginator}isAllSelected(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.dataSource)}masterToggle(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.cachedSelection,"",this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}changeSending(e){e.send?this.registrarService.setSendingEnabled({mails:[e],enabled:!1}).subscribe(()=>{e.send=!1,this.notificator.showInstantSuccess("VO_DETAIL.SETTINGS.NOTIFICATIONS.SENDING_DISABLE")}):this.registrarService.setSendingEnabled({mails:[e],enabled:!0}).subscribe(()=>{e.send=!0,this.notificator.showInstantSuccess("VO_DETAIL.SETTINGS.NOTIFICATIONS.SENDING_ENABLE")})}pageChanged(){this.cachedSelection&&this.tableCheckbox.selectCachedDataOnPage(this.dataSource,this.selection,this.cachedSelection,this.selection.compareWith)}openApplicationMailDetail(e){let i=G();i.width="1400px",i.height="700px",i.data={theme:this.theme,voId:this.voId,groupId:this.groupId,createMailNotification:!1,applicationMail:Jn({},e)},this.dialog.open(ki,i).afterClosed().subscribe(l=>{l&&(this.translate.get("VO_DETAIL.SETTINGS.NOTIFICATIONS.EDIT_SUCCESS").subscribe(E=>{this.notificator.showSuccess(E)}),this.selection.clear(),this.selectionChange.emit(this.selection),this.refreshTable.emit())})}getMailType(e){let i="";return e.mailType===void 0||e.mailType===null||e.mailType.length===0?i="":this.translate.get("VO_DETAIL.SETTINGS.NOTIFICATIONS.MAIL_TYPE_"+e.mailType).subscribe(n=>{i=n}),i}toggle(e){this.selection.toggle(e),this.cachedSelection.toggle(e),this.selectionChange.emit(this.selection)}setDataSource(){this.dataSource&&(this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator)}static{this.\u0275fac=function(i){return new(i||t)(u(Ie),u(X),u(j),u(q),u(k),u(Xo),u(Yi))}}static{this.\u0275cmp=M({type:t,selectors:[["app-notification-list"]],viewQuery:function(i,n){if(i&1&&(Rt(qn,7),Rt(nn,7)),i&2){let l;Ot(l=yt())&&(n.child=l.first),Ot(l=yt())&&(n.matSort=l.first)}},inputs:{applicationMails:"applicationMails",voId:"voId",groupId:"groupId",displayedColumns:"displayedColumns",disableSend:"disableSend",selection:"selection",cachedSubject:"cachedSubject",tableId:"tableId",theme:"theme",loading:"loading"},outputs:{selectionChange:"selectionChange",refreshTable:"refreshTable"},features:[Xi],decls:20,vars:15,consts:[[1,"card","mt-2",3,"hidden"],[3,"pageChanged","pageSizeOptions","dataLength","hideExport","tableId"],["mat-table","","matSort","","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"matSortChange","dataSource"],["matColumnDef","select"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","mailType"],["mat-cell","",4,"matCellDef"],["matColumnDef","appType"],["matColumnDef","send"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",3,"cursor-pointer","click",4,"matRowDef","matRowDefColumns"],["alert_type","warn"],["class","align-checkbox","mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size align-checkbox","mat-cell","",4,"matCellDef"],["mat-header-cell","",1,"align-checkbox"],["color","primary",3,"change","aria-label","checked","indeterminate"],["mat-cell","",1,"static-column-size","align-checkbox"],["color","primary",3,"change","click","aria-label","checked"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"static-column-size"],["mat-cell",""],[1,"d-flex","align-items-center"],["matTooltip","Initial","matTooltipPosition","above"],["matTooltip","Extension","matTooltipPosition","above"],[3,"change","click","disabled","matTooltipDisabled","ngModel","matTooltip"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item",3,"click"]],template:function(i,n){if(i&1&&(a(0,"div",0)(1,"perun-web-apps-table-wrapper",1),C("pageChanged",function(){return n.pageChanged()}),a(2,"table",2),C("matSortChange",function(){return n.pageChanged()}),v(3,bm,3,0,"ng-container",3),d(4,"isAllSelected"),fe(5,4),A(6,Am,3,3,"th",5)(7,xm,2,1,"td",6),he(),fe(8,7),A(9,Mm,3,3,"th",5)(10,Dm,2,1,"td",8),he(),fe(11,9),A(12,Rm,3,3,"th",5)(13,Nm,3,1,"td",8),he(),fe(14,10),A(15,wm,3,3,"th",5)(16,Lm,5,9,"td",8),he(),A(17,Vm,1,0,"tr",11)(18,Pm,1,2,"tr",12),r()()(),v(19,Gm,3,3,"perun-web-apps-alert",13)),i&2){let l;_("hidden",n.applicationMails.length===0),o(),_("pageSizeOptions",n.pageSizeOptions)("dataLength",n.dataSource.filteredData.length)("hideExport",!0)("tableId",n.tableId),o(),_("dataSource",n.dataSource),o(),I((l=Ee(13,Cm,it(4,10,n.dataSource,n.selection.selected.length)))?3:-1,l),o(14),_("matHeaderRowDef",n.displayedColumns),o(),_("matRowDefColumns",n.displayedColumns),o(),I(!n.loading&&n.applicationMails.length===0?19:-1)}},dependencies:[D,et,Je,Ti,Ei,yi,li,at,ye,ot,Ne,$e,ze,qn,je,Le,Pe,Ke,Ge,Ve,ke,Be,Fe,Ze,Ue,So,nn,Co,O,Ae,ta,R,ia,na,ra],styles:[".cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}"]})}}return t})();function Bm(t,c){if(t&1){let e=T();a(0,"button",12),C("click",function(){f(e);let n=p();return h(n.add())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.SETTINGS.NOTIFICATIONS.ADD")," "))}function Fm(t,c){if(t&1){let e=T();a(0,"button",13),C("click",function(){f(e);let n=p();return h(n.remove())}),s(1),d(2,"translate"),r()}if(t&2){let e=p();_("disabled",e.selection.selected.length===0||e.loading),o(),g(" ",m(2,2,"VO_DETAIL.SETTINGS.NOTIFICATIONS.REMOVE")," ")}}function km(t,c){if(t&1){let e=T();a(0,"button",14),C("click",function(){f(e);let n=p();return h(n.copy())}),a(1,"i",7),s(2,"file_copy"),r(),a(3,"span",8),s(4),d(5,"translate"),r()()}t&2&&(o(4),g(" ",m(5,1,"VO_DETAIL.SETTINGS.NOTIFICATIONS.COPY_FROM_VO")," "))}function Um(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function jm(t,c){if(t&1){let e=T();a(0,"app-notification-list",15),C("selectionChange",function(n){f(e);let l=p();return h(l.changeSelection(n))})("refreshTable",function(){f(e);let n=p();return h(n.refresh())}),r()}if(t&2){let e=p();_("loading",e.loading)("applicationMails",e.applicationMails)("disableSend",!e.addAuth)("displayedColumns",e.displayedColumns)("tableId",e.tableId)("selection",e.selection)("cachedSubject",e.cachedSubject)("theme","vo-theme")("voId",e.vo.id)}}var Is=(()=>{class t{constructor(e,i,n,l,E,x,w,U,_e){this.route=e,this.registrarService=i,this.translate=n,this.dialog=l,this.notificator=E,this.authResolver=x,this.voService=w,this.store=U,this.entityStorageService=_e,this.loading=!1,this.applicationMails=[],this.selection=new K(!0,[],!0,(tt,Ht)=>tt.id===Ht.id),this.cachedSubject=new me(!0),this.tableId=ma,this.displayedColumns=[]}ngOnInit(){this.vo=this.entityStorageService.getEntity(),this.setAuthRights(),this.refresh()}refresh(){this.loading=!0,this.registrarService.getVoApplicationForm(this.vo.id).subscribe(e=>{this.applicationForm=e,this.registrarService.getApplicationMailsForVo(this.vo.id).subscribe(i=>{this.applicationMails=i,this.loading=!1})})}setAuthRights(){this.addAuth=this.authResolver.isAuthorized("vo-addMail_ApplicationForm_ApplicationMail_policy",[this.vo]),this.removeAuth=this.authResolver.isAuthorized("vo-deleteMailById_ApplicationForm_Integer_policy",[this.vo]),this.copyAuth=this.authResolver.isAuthorized("destination-copyMailsFromVoToVo_Vo_Vo_policy",[this.vo]),this.displayedColumns=this.removeAuth?["select","id","mailType","appType","send"]:["id","mailType","appType","send"]}add(){let e=this.store.getProperty("supported_languages"),i=mn(e);i.formId=this.applicationForm.id;let n=G();n.width="1400px",n.height="700px",n.data={theme:"vo-theme",voId:this.vo.id,createMailNotification:!0,applicationMail:i,applicationMails:this.applicationMails},this.dialog.open(ki,n).afterClosed().subscribe(E=>{E&&(this.translate.get("VO_DETAIL.SETTINGS.NOTIFICATIONS.ADD_SUCCESS").subscribe(x=>{this.notificator.showSuccess(x)}),this.selection.clear(),this.cachedSubject.next(!0),this.updateTable())})}remove(){let e=G();e.width="500px",e.data={voId:this.vo.id,mails:this.selection.selected,theme:"vo-theme"},this.dialog.open(Nn,e).afterClosed().subscribe(n=>{n&&(this.translate.get("VO_DETAIL.SETTINGS.NOTIFICATIONS.DELETE_SUCCESS").subscribe(l=>{this.notificator.showSuccess(l)}),this.selection.clear(),this.cachedSubject.next(!0),this.updateTable())})}copy(){let e=G();e.width="500px",e.data={voId:this.vo.id,theme:"vo-theme"},this.dialog.open(Ln,e).afterClosed().subscribe(n=>{n&&(this.selection.clear(),this.cachedSubject.next(!0),this.updateTable())})}changeEmailFooter(){let e=G();e.width="500px",e.data={voId:this.vo.id,theme:"vo-theme"},this.dialog.open(wn,e)}changeSelection(e){this.selection=e}updateTable(){this.loading=!0,this.registrarService.getApplicationMailsForVo(this.vo.id).subscribe(e=>{this.applicationMails=e,this.loading=!1})}static{this.\u0275fac=function(i){return new(i||t)(u(ve),u(Ie),u(X),u(q),u(j),u(k),u(de),u(Xe),u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-settings-notifications"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:18,vars:11,consts:[["spinner",""],[1,"page-subtitle"],[1,"w-100","d-flex"],[3,"click"],["color","accent","mat-flat-button","",1,"me-2","action-button"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],["mat-stroked-button","",1,"me-2","action-button",3,"click"],[1,"material-icons","align-middle"],[1,"align-middle"],["mat-stroked-button","",1,"action-button"],[1,"position-relative","table-min-height"],[3,"loading","applicationMails","disableSend","displayedColumns","tableId","selection","cachedSubject","theme","voId","selectionChange","refreshTable",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],["mat-stroked-button","",1,"action-button",3,"click"],[3,"selectionChange","refreshTable","loading","applicationMails","disableSend","displayedColumns","tableId","selection","cachedSubject","theme","voId"]],template:function(i,n){if(i&1){let l=T();a(0,"h1",1),s(1),d(2,"translate"),r(),a(3,"div",2)(4,"perun-web-apps-refresh-button",3),C("click",function(){return f(l),h(n.refresh())}),r(),v(5,Bm,3,3,"button",4),v(6,Fm,3,4,"button",5),a(7,"button",6),C("click",function(){return f(l),h(n.changeEmailFooter())}),a(8,"i",7),s(9,"email"),r(),a(10,"span",8),s(11),d(12,"translate"),r()(),v(13,km,6,3,"button",9),r(),A(14,Um,1,0,"ng-template",null,0,L),a(16,"div",10),A(17,jm,1,9,"app-notification-list",11),r()}if(i&2){let l=y(15);o(),g(" ",m(2,7,"VO_DETAIL.SETTINGS.NOTIFICATIONS.TITLE"),`
`),o(4),I(n.addAuth?5:-1),o(),I(n.removeAuth?6:-1),o(5),g(" ",m(12,9,"VO_DETAIL.SETTINGS.NOTIFICATIONS.EMAIL_FOOTER")," "),o(2),I(n.copyAuth?13:-1),o(4),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,xe,O,Vn,P,Q,R],encapsulation:2})}}return t})();function Wm(t,c){if(t&1){let e=T();a(0,"button",12),C("click",function(){f(e);let n=p(2);return h(n.add())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"GROUP_DETAIL.SETTINGS.NOTIFICATIONS.ADD")," "))}function Hm(t,c){if(t&1){let e=T();a(0,"button",13),C("click",function(){f(e);let n=p(2);return h(n.remove())}),s(1),d(2,"translate"),r()}if(t&2){let e=p(2);_("disabled",e.selection.selected.length===0||e.loading),o(),g(" ",m(2,2,"GROUP_DETAIL.SETTINGS.NOTIFICATIONS.REMOVE")," ")}}function zm(t,c){if(t&1){let e=T();a(0,"button",14),C("click",function(){f(e);let n=p(2);return h(n.copy())}),a(1,"i",7),s(2,"file_copy"),r(),a(3,"span",8),s(4),d(5,"translate"),r()()}t&2&&(o(4),g(" ",m(5,1,"GROUP_DETAIL.SETTINGS.NOTIFICATIONS.COPY_FROM_VO")," "))}function $m(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function Ym(t,c){if(t&1){let e=T();a(0,"app-notification-list",15),C("selectionChange",function(n){f(e);let l=p(2);return h(l.changeSelection(n))})("refreshTable",function(){f(e);let n=p(2);return h(n.refresh())}),r()}if(t&2){let e=p(2);_("loading",e.loading)("disableSend",!e.addAuth)("displayedColumns",e.displayedColumns)("applicationMails",e.applicationMails)("groupId",e.group.id)("selection",e.selection)("cachedSubject",e.cachedSubject)("tableId",e.tableId)("theme","group-theme")}}function Xm(t,c){if(t&1){let e=T();a(0,"div")(1,"div",2)(2,"perun-web-apps-refresh-button",3),C("click",function(){f(e);let n=p();return h(n.refresh())}),r(),v(3,Wm,3,3,"button",4),v(4,Hm,3,4,"button",5),a(5,"button",6),C("click",function(){f(e);let n=p();return h(n.changeEmailFooter())}),a(6,"i",7),s(7,"email"),r(),a(8,"span",8),s(9),d(10,"translate"),r()(),v(11,zm,6,3,"button",9),r(),A(12,$m,1,0,"ng-template",null,0,L),a(14,"div",10),A(15,Ym,1,9,"app-notification-list",11),r()()}if(t&2){let e=y(13),i=p();o(3),I(i.addAuth?3:-1),o(),I(i.removeAuth?4:-1),o(5),g(" ",m(10,6,"GROUP_DETAIL.SETTINGS.NOTIFICATIONS.EMAIL_FOOTER")," "),o(2),I(i.copyAuth?11:-1),o(4),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",e)}}function qm(t,c){if(t&1){let e=T();a(0,"button",18),C("click",function(){f(e);let n=p(2);return h(n.createEmptyApplicationForm())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"GROUP_DETAIL.SETTINGS.NOTIFICATIONS.CREATE_APPLICATION_FORM")," "))}function Km(t,c){if(t&1&&(a(0,"div")(1,"perun-web-apps-alert",16),s(2),d(3,"translate"),r(),v(4,qm,3,3,"button",17),r()),t&2){let e=p();o(2),b(m(3,2,"GROUP_DETAIL.SETTINGS.NOTIFICATIONS.NO_APPLICATION_FORM")),o(2),I(e.createFormAuth?4:-1)}}var Cs=(()=>{class t{constructor(e,i,n,l,E,x,w,U){this.registrarService=e,this.translate=i,this.dialog=n,this.apiRequest=l,this.notificator=E,this.guiAuthResolver=x,this.attributesService=w,this.entityStorageService=U,this.loading=!1,this.applicationMails=[],this.selection=new K(!0,[],!0,(_e,tt)=>_e.id===tt.id),this.cachedSubject=new me(!0),this.noApplicationForm=!1,this.editEmailFooterAuth=!1,this.addAuth=!1,this.removeAuth=!1,this.copyAuth=!1,this.createFormAuth=!1,this.displayedColumns=[],this.tableId=da}ngOnInit(){this.group=this.entityStorageService.getEntity(),this.setAuthRights(),this.refresh()}refresh(){this.loading=!0,this.apiRequest.dontHandleErrorForNext(),this.registrarService.getGroupApplicationForm(this.group.id).subscribe({next:e=>{this.applicationForm=e,this.registrarService.getApplicationMailsForGroup(this.group.id).subscribe(i=>{this.applicationMails=i,this.apiRequest.dontHandleErrorForNext(),this.attributesService.getGroupAttributeByName(this.group.id,Re.GROUP_DEF_EXPIRATION_RULES).subscribe({next:()=>{this.setAuthRights(),this.loading=!1},error:n=>{n.name!=="PrivilegeException"&&this.notificator.showRPCError(n),this.setAuthRights(),this.loading=!1}})})},error:e=>{e.name==="FormNotExistsException"?(this.noApplicationForm=!0,this.setAuthRights(),this.loading=!1):this.notificator.showRPCError(e)}})}setAuthRights(){this.createFormAuth=this.guiAuthResolver.isAuthorized("createApplicationFormInGroup_Group_policy",[this.group]),this.addAuth=this.guiAuthResolver.isAuthorized("group-addMail_ApplicationForm_ApplicationMail_policy",[this.group]),this.removeAuth=this.guiAuthResolver.isAuthorized("group-deleteMailById_ApplicationForm_Integer_policy",[this.group]),this.copyAuth=this.guiAuthResolver.isAuthorized("destination-copyMailsFromVoToGroup_Vo_Group_boolean_policy",[this.group]),this.displayedColumns=this.removeAuth?["select","id","mailType","appType","send"]:["id","mailType","appType","send"]}add(){let e=mn();e.formId=this.applicationForm.id;let i=G();i.width="1400px",i.height="700px",i.data={theme:"group-theme",voId:this.group.voId,groupId:this.group.id,createMailNotification:!0,applicationMail:e,applicationMails:this.applicationMails},this.dialog.open(ki,i).afterClosed().subscribe(l=>{l&&(this.translate.get("GROUP_DETAIL.SETTINGS.NOTIFICATIONS.ADD_SUCCESS").subscribe(E=>{this.notificator.showSuccess(E)}),this.selection.clear(),this.cachedSubject.next(!0),this.updateTable())})}remove(){let e=G();e.width="500px",e.data={voId:this.group.voId,groupId:this.group.id,mails:this.selection.selected,theme:"group-theme"},this.dialog.open(Nn,e).afterClosed().subscribe(n=>{n&&(this.translate.get("GROUP_DETAIL.SETTINGS.NOTIFICATIONS.DELETE_SUCCESS").subscribe(l=>{this.notificator.showSuccess(l)}),this.selection.clear(),this.cachedSubject.next(!0),this.updateTable())})}copy(){let e=G();e.width="500px",e.data={voId:this.group.voId,groupId:this.group.id,theme:"group-theme"},this.dialog.open(Ln,e).afterClosed().subscribe(n=>{n&&(this.selection.clear(),this.cachedSubject.next(!0),this.updateTable())})}updateTable(){this.loading=!0,this.registrarService.getApplicationMailsForGroup(this.group.id).subscribe(e=>{this.applicationMails=e,this.loading=!1})}changeEmailFooter(){let e=G();e.width="500px",e.data={voId:this.group.voId,groupId:this.group.id,theme:"group-theme"},this.dialog.open(wn,e)}changeSelection(e){this.selection=e}createEmptyApplicationForm(){this.registrarService.createApplicationFormInGroup(this.group.id).subscribe(()=>{this.noApplicationForm=!1,this.ngOnInit()})}static{this.\u0275fac=function(i){return new(i||t)(u(Ie),u(X),u(q),u(pt),u(j),u(k),u(ut),u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-group-settings-notifications"]],hostVars:2,hostBindings:function(i,n){i&2&&$("router-component",n.true)},decls:5,vars:5,consts:[["spinner",""],[1,"page-subtitle"],[1,"w-100","d-flex"],[3,"click"],["color","accent","mat-flat-button","",1,"me-2","action-button"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],["mat-stroked-button","",1,"me-2","action-button",3,"click"],[1,"material-icons","align-middle"],[1,"align-middle"],["mat-stroked-button","",1,"action-button"],[1,"position-relative","table-min-height"],[3,"loading","disableSend","displayedColumns","applicationMails","groupId","selection","cachedSubject","tableId","theme","selectionChange","refreshTable",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],["mat-stroked-button","",1,"action-button",3,"click"],[3,"selectionChange","refreshTable","loading","disableSend","displayedColumns","applicationMails","groupId","selection","cachedSubject","tableId","theme"],["alert_type","warn"],["mat-stroked-button",""],["mat-stroked-button","",3,"click"]],template:function(i,n){i&1&&(a(0,"h1",1),s(1),d(2,"translate"),r(),v(3,Xm,16,8,"div"),v(4,Km,5,4,"div")),i&2&&(o(),g(" ",m(2,3,"GROUP_DETAIL.SETTINGS.NOTIFICATIONS.TITLE"),`
`),o(2),I(n.noApplicationForm?-1:3),o(),I(n.noApplicationForm&&!n.loading?4:-1))},dependencies:[D,N,V,$e,ze,xe,O,P,Vn,Q,R],encapsulation:2})}}return t})();function Zm(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function Qm(t,c){if(t&1&&S(0,"app-ext-sources-list",10),t&2){let e=p();_("loading",e.loading)("selection",e.selection)("cachedSubject",e.cachedSubject)("extSources",e.extSources)("filterValue",e.filterValue)("tableId",e.tableId)}}var Pn=(()=>{class t{constructor(e,i,n,l,E){this.dialogRef=e,this.data=i,this.extSourceService=n,this.notificator=l,this.translate=E,this.extSources=[],this.selection=new K(!0,[]),this.cachedSubject=new me(!0),this.loading=!1,this.filterValue="",this.tableId=_a}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.data.groupId?this.extSourceService.getVoExtSources(this.data.voId).subscribe(e=>{this.extSources=e.filter(i=>!this.data.extSources.some(({id:n})=>n===i.id)),this.loading=!1},()=>this.loading=!1):this.extSourceService.getExtSources().subscribe(e=>{this.extSources=e.filter(i=>!this.data.extSources.some(({id:n})=>n===i.id)),this.loading=!1},()=>this.loading=!1)}applyFilter(e){this.filterValue=e,this.selection.clear(),this.cachedSubject.next(!0)}addVoExtSources(e){let i=e.map(n=>n.id);this.extSourceService.addExtSourcesWithVoSource(this.data.voId,i).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.ADD_EXT_SOURCES.SUCCESS_ADDED")),this.dialogRef.close(!0)},error:()=>this.loading=!1})}addGroupExtSources(e){let i=e.map(n=>n.id);this.extSourceService.addExtSourcesWithGroupSource(this.data.groupId,i).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.ADD_EXT_SOURCES.SUCCESS_ADDED")),this.dialogRef.close(!0)},error:()=>this.loading=!1})}onAdd(){this.loading=!0,this.data.groupId?this.addGroupExtSources(this.selection.selected):this.addVoExtSources(this.selection.selected)}onCancel(){this.dialogRef.close(!1)}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(Jt),u(j),u(mt))}}static{this.\u0275cmp=M({type:t,selectors:[["app-add-ext-source-dialog"]],decls:18,vars:15,consts:[["spinner",""],["mat-dialog-title",""],[1,"page-subtitle"],[1,"font-size-1rem",3,"filter","placeholder"],["mat-dialog-content",""],[1,"position-relative","table-min-height"],[3,"loading","selection","cachedSubject","extSources","filterValue","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"],[3,"loading","selection","cachedSubject","extSources","filterValue","tableId"]],template:function(i,n){if(i&1){let l=T();a(0,"div")(1,"div",1)(2,"h1",2),s(3),d(4,"translate"),r(),a(5,"perun-web-apps-debounce-filter",3),C("filter",function(x){return f(l),h(n.applyFilter(x))}),r()(),a(6,"div",4),A(7,Zm,1,0,"ng-template",null,0,L),a(9,"div",5),A(10,Qm,1,6,"app-ext-sources-list",6),r()(),a(11,"div",7)(12,"button",8),C("click",function(){return f(l),h(n.onCancel())}),s(13),d(14,"translate"),r(),a(15,"button",9),C("click",function(){return f(l),h(n.onAdd())}),s(16),d(17,"translate"),r()()()}if(i&2){let l=y(8);ce(n.theme),o(3),b(m(4,9,"DIALOGS.ADD_EXT_SOURCES.TITLE")),o(2),_("placeholder","DIALOGS.ADD_EXT_SOURCES.FILTER"),o(5),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l),o(3),g(" ",m(14,11,"DIALOGS.ADD_EXT_SOURCES.CANCEL")," "),o(2),_("disabled",n.selection.selected.length===0||n.loading),o(),g(" ",m(17,13,"DIALOGS.ADD_EXT_SOURCES.ADD")," ")}},dependencies:[D,N,V,oe,te,ne,ie,Te,O,Fi,P,Q,R],styles:[".font-size-1rem[_ngcontent-%COMP%]{font-size:1rem!important}"]})}}return t})();function Jm(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function e0(t,c){t&1&&(a(0,"th",16),s(1,"id"),r())}function t0(t,c){if(t&1&&(a(0,"td",17),s(1),r()),t&2){let e=c.$implicit;o(),b(e.id)}}function i0(t,c){t&1&&(a(0,"th",16),s(1,"name"),r())}function n0(t,c){if(t&1&&(a(0,"td",17),s(1),r()),t&2){let e=c.$implicit;o(),b(e.name)}}function o0(t,c){t&1&&S(0,"tr",18)}function a0(t,c){t&1&&S(0,"tr",19)}function r0(t,c){if(t&1){let e=T();a(0,"div")(1,"div",2)(2,"h1",3),s(3),d(4,"translate"),r()(),a(5,"div",4)(6,"p"),s(7),d(8,"translate"),r(),a(9,"div",5),s(10),d(11,"translate"),r(),a(12,"table",6),fe(13,7),A(14,e0,2,0,"th",8)(15,t0,2,1,"td",9),he(),fe(16,10),A(17,i0,2,0,"th",8)(18,n0,2,1,"td",9),he(),A(19,o0,1,0,"tr",11)(20,a0,1,0,"tr",12),r()(),a(21,"div",13)(22,"button",14),C("click",function(){f(e);let n=p();return h(n.onCancel())}),s(23),d(24,"translate"),r(),a(25,"button",15),C("click",function(){f(e);let n=p();return h(n.onRemove())}),s(26),d(27,"translate"),r()()()}if(t&2){let e=p();o(3),b(m(4,8,"DIALOGS.REMOVE_EXT_SOURCES.TITLE")),o(4),g(" ",m(8,10,"DIALOGS.REMOVE_EXT_SOURCES.DESCRIPTION")," "),o(3),g(" ",m(11,12,"DIALOGS.REMOVE_EXT_SOURCES.ASK")," "),o(2),_("dataSource",e.extSources),o(7),_("matHeaderRowDef",e.displayedColumns),o(),_("matRowDefColumns",e.displayedColumns),o(3),g(" ",m(24,14,"DIALOGS.REMOVE_EXT_SOURCES.CANCEL")," "),o(3),g(" ",m(27,16,"DIALOGS.REMOVE_EXT_SOURCES.REMOVE")," ")}}var Gn=(()=>{class t{constructor(e,i,n,l,E,x){this.dialogRef=e,this.data=i,this.extSourceService=n,this.notificator=l,this.tableConfigService=E,this.translate=x,this.extSources=[],this.displayedColumns=["id","name"],this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.extSources=this.data.extSources}removeVoExtSources(){let e=this.extSources.map(i=>i.id);this.extSourceService.removeExtSourcesWithVoSource(this.data.voId,e).subscribe({next:()=>{this.translate.get("DIALOGS.REMOVE_EXT_SOURCES.SUCCESS_REMOVED").subscribe(i=>{this.notificator.showSuccess(i),this.dialogRef.close(!0)})},error:()=>this.loading=!1})}removeGroupExtSources(){let e=this.extSources.map(i=>i.id);this.extSourceService.removeExtSourcesWithGroupSource(this.data.groupId,e).subscribe({next:()=>{this.translate.get("DIALOGS.REMOVE_EXT_SOURCES.SUCCESS_REMOVED").subscribe(i=>{this.notificator.showSuccess(i),this.dialogRef.close(!0)})},error:()=>this.loading=!1})}onRemove(){this.loading=!0,this.data.groupId?this.removeGroupExtSources():this.removeVoExtSources()}onCancel(){this.dialogRef.close(!1)}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(Jt),u(j),u(ca),u(X))}}static{this.\u0275cmp=M({type:t,selectors:[["app-remove-ext-source-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],[1,"page-subtitle"],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(i,n){if(i&1&&(A(0,Jm,1,0,"ng-template",null,0,L),a(2,"div"),A(3,r0,28,18,"div",1),r()),i&2){let l=y(1);o(2),ce(pe("",n.theme," position-relative")),o(),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,oe,te,ne,ie,ue,je,Le,Pe,Ke,Ge,Ve,ke,Be,Fe,Ze,Ue,O,P,R],encapsulation:2})}}return t})();function s0(t,c){if(t&1){let e=T();a(0,"button",8),C("click",function(){f(e);let n=p();return h(n.onAdd())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.SETTINGS.EXT_SOURCES.ADD")," "))}function l0(t,c){if(t&1){let e=T();a(0,"button",9),C("click",function(){f(e);let n=p();return h(n.onRemove())}),s(1),d(2,"translate"),r()}if(t&2){let e=p();_("disabled",e.loading||e.selection.selected.length===0),o(),g(" ",m(2,2,"VO_DETAIL.SETTINGS.EXT_SOURCES.REMOVE")," ")}}function p0(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function c0(t,c){if(t&1&&S(0,"app-ext-sources-list",10),t&2){let e=p();_("loading",e.loading)("extSources",e.extSources)("selection",e.selection)("cachedSubject",e.cachedSubject)("displayedColumns",e.displayedColumns)("filterValue",e.filterValue)("tableId",e.tableId)}}var Ss=(()=>{class t{constructor(e,i,n,l,E,x){this.extSourceService=e,this.dialog=i,this.notificator=n,this.translate=l,this.authResolver=E,this.entityStorageService=x,this.extSources=[],this.selection=new K(!0,[]),this.cachedSubject=new me(!0),this.filterValue="",this.tableId=ga,this.displayedColumns=[],this.translate.get("VO_DETAIL.SETTINGS.EXT_SOURCES.SUCCESS_REMOVED").subscribe(w=>this.successMessage=w)}ngOnInit(){this.loading=!0,this.vo=this.entityStorageService.getEntity(),this.setAuthRights(),this.refreshTable()}refreshTable(){this.loading=!0,this.extSourceService.getVoExtSources(this.vo.id).subscribe(e=>{this.extSources=e,this.selection.clear(),this.cachedSubject.next(!0),this.setAuthRights(),this.loading=!1})}applyFilter(e){this.filterValue=e,this.refreshTable()}onAdd(){let e=G();e.width="1000px",e.data={voId:this.vo.id,extSources:this.extSources,theme:"vo-theme"},this.dialog.open(Pn,e).afterClosed().subscribe(n=>{n&&this.refreshTable()})}onRemove(){let e=G();e.width="600px",e.data={voId:this.vo.id,extSources:this.selection.selected,theme:"vo-theme"},this.dialog.open(Gn,e).afterClosed().subscribe(n=>{n&&this.refreshTable()})}setAuthRights(){this.addAuth=this.authResolver.isAuthorized("addExtSource_Vo_ExtSource_policy",[this.vo]),this.removeAuth=this.authResolver.isAuthorized("removeExtSource_Vo_ExtSource_policy",[this.vo]),this.displayedColumns=this.removeAuth?["select","id","name","type"]:["id","name","type"]}static{this.\u0275fac=function(i){return new(i||t)(u(Jt),u(q),u(j),u(X),u(k),u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-settings-extsources"]],decls:12,vars:8,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","extSources","selection","cachedSubject","displayedColumns","filterValue","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"loading","extSources","selection","cachedSubject","displayedColumns","filterValue","tableId"]],template:function(i,n){if(i&1){let l=T();a(0,"div")(1,"h1",1),s(2),d(3,"translate"),r(),a(4,"perun-web-apps-refresh-button",2),C("refresh",function(){return f(l),h(n.refreshTable())}),r(),v(5,s0,3,3,"button",3),v(6,l0,3,4,"button",4),a(7,"perun-web-apps-debounce-filter",5),C("filter",function(x){return f(l),h(n.applyFilter(x))}),r(),A(8,p0,1,0,"ng-template",null,0,L),a(10,"div",6),A(11,c0,1,7,"app-ext-sources-list",7),r()()}if(i&2){let l=y(9);o(2),b(m(3,6,"VO_DETAIL.SETTINGS.EXT_SOURCES.TITLE")),o(3),I(n.addAuth?5:-1),o(),I(n.removeAuth?6:-1),o(),_("placeholder","VO_DETAIL.SETTINGS.EXT_SOURCES.FILTER"),o(4),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,Te,xe,O,Fi,P,Q,R],encapsulation:2})}}return t})();function d0(t,c){if(t&1){let e=T();a(0,"button",7),C("click",function(){f(e);let n=p();return h(n.showDetails())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"MEMBER_DETAIL.APPLICATIONS.SHOW_ALL_DETAILS")," "))}function m0(t,c){if(t&1){let e=T();a(0,"button",7),C("click",function(){f(e);let n=p();return h(n.showDetails())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"MEMBER_DETAIL.APPLICATIONS.SHOW_LESS_DETAILS")," "))}function u0(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function _0(t,c){if(t&1){let e=T();a(0,"perun-web-apps-applications-list",8),d(1,"async"),d(2,"async"),C("queryChanged",function(n){f(e);let l=p();return h(l.nextPage.next(n))})("downloadAll",function(n){f(e);let l=p();return h(l.downloadAll(n))}),r()}if(t&2){let e=p();_("loading",m(1,6,e.loading$))("tableId",e.showAllDetails?e.detailTableId:e.tableId)("member",e.member)("displayedColumns",e.showAllDetails?e.detailedDisplayedColumns:e.displayedColumns)("applications",m(2,8,e.applicationsPage$))("filter",e.filterValue)}}var Es=(()=>{class t{constructor(e,i,n){this.entityStorageService=e,this.registrarService=i,this.translate=n,this.displayedColumns=["id","createdAt","type","state","user","groupName","modifiedBy"],this.detailedDisplayedColumns=["id","createdAt","voId","voName","groupId","groupName","type","state","extSourceName","extSourceType","user","createdBy","modifiedBy","modifiedAt","fedInfo"],this.filterValue="",this.showAllDetails=!1,this.detailTableId=ha,this.tableId=va,this.dateFrom=new Date("1970-01-01"),this.applications=[],this.nextPage=new me({}),this.applicationsPage$=this.nextPage.pipe(zt(l=>this.registrarService.getApplicationsPage({vo:this.member.voId,query:{pageSize:l.pageSize,offset:l.offset,order:l.order,sortColumn:Xn(l.sortColumn),searchString:l.searchString,getDetails:this.showAllDetails,dateFrom:ji(this.dateFrom),dateTo:ji(new Date),userId:this.member.userId}})),$i(l=>{this.applications=l.data,setTimeout(()=>this.loadingSubject$.next(!1),200)}),Kt({data:[],totalCount:0,offset:0,pageSize:0})),this.loadingSubject$=new me(!1),this.loading$=_i(this.loadingSubject$,this.nextPage.pipe(ft(()=>!0)))}ngOnInit(){this.member=this.entityStorageService.getEntity()}applyFilter(e){this.filterValue=e,this.refreshTable()}showDetails(){this.showAllDetails=!this.showAllDetails}refreshTable(){this.nextPage.next(this.nextPage.value)}downloadAll(e){let i=this.nextPage.getValue();this.registrarService.getApplicationsPage({vo:this.member.voId,query:{order:i.order,pageSize:e.length,offset:0,searchString:i.searchString,sortColumn:Xn(i.sortColumn),getDetails:this.showAllDetails,dateFrom:ji(this.dateFrom),dateTo:ji(new Date),userId:this.member.userId}}).subscribe({next:n=>{$o(Ni(n.data,this.showAllDetails?this.detailedDisplayedColumns:this.displayedColumns,zo),this.translate,e.format)}})}static{this.\u0275fac=function(i){return new(i||t)(u(F),u(Ie),u(mt))}}static{this.\u0275cmp=M({type:t,selectors:[["app-member-applications"]],decls:13,vars:10,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["mat-stroked-button","",1,"me-2"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","tableId","member","displayedColumns","applications","filter","queryChanged","downloadAll",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-stroked-button","",1,"me-2",3,"click"],[3,"queryChanged","downloadAll","loading","tableId","member","displayedColumns","applications","filter"]],template:function(i,n){if(i&1){let l=T();a(0,"h1",1),s(1),d(2,"translate"),r(),a(3,"div")(4,"perun-web-apps-refresh-button",2),C("refresh",function(){return f(l),h(n.refreshTable())}),r(),v(5,d0,3,3,"button",3),v(6,m0,3,3,"button",3),a(7,"perun-web-apps-debounce-filter",4),C("filter",function(x){return f(l),h(n.applyFilter(x))}),r()(),A(8,u0,1,0,"ng-template",null,0,L),a(10,"div",5),A(11,_0,3,10,"perun-web-apps-applications-list",6),d(12,"async"),r()}if(i&2){let l=y(9);o(),b(m(2,6,"MEMBER_DETAIL.APPLICATIONS.TITLE")),o(4),I(n.showAllDetails?-1:5),o(),I(n.showAllDetails?6:-1),o(),_("placeholder","MEMBER_DETAIL.APPLICATIONS.FILTER"),o(4),_("perunWebAppsLoader",m(12,8,n.loading$))("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,Te,xe,O,Ua,Q,P,Zt,R],encapsulation:2})}}return t})();var g0=()=>[],f0=()=>["select","id","name","description"],h0=(t,c)=>c.id;function v0(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function I0(t,c){t&1&&(s(0),d(1,"translate")),t&2&&g(" ",m(1,1,"DIALOGS.ADD_MEMBER_TO_RESOURCE.SELECT_RESOURCE")," ")}function C0(t,c){if(t&1){let e=T();a(0,"perun-web-apps-resource-search-select",22),C("resourceSelected",function(n){f(e);let l=p(2);return l.setResource(n),h(l.stepper.selected.completed=!0)}),r()}if(t&2){let e=p(2);_("disableAutoSelect",!0)("required",!0)("resource",e.selectedResource)("resources",e.filteredResources)}}function S0(t,c){t&1&&S(0,"perun-web-apps-resource-search-select",11),t&2&&_("resources",ge(1,g0))}function E0(t,c){if(t&1&&(a(0,"div",13),s(1),r()),t&2){let e=c.$implicit;o(),b(e.name)}}function T0(t,c){t&1&&(s(0),d(1,"translate")),t&2&&b(m(1,1,"DIALOGS.ADD_MEMBER_TO_RESOURCE.ADD_GROUP"))}function b0(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function A0(t,c){if(t&1&&S(0,"perun-web-apps-groups-list",23),t&2){let e=p(2);_("loading",e.loading)("disableGroups",!0)("disableHeadCheckbox",!0)("disableRouting",!0)("groupsToDisableCheckbox",e.membersGroupsId)("groups",e.groups)("displayedColumns",ge(8,f0))("selection",e.selectedGroups)}}function x0(t,c){t&1&&(a(0,"perun-web-apps-alert",16),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"DIALOGS.ADD_MEMBER_TO_RESOURCE.NO_GROUPS")," "))}function M0(t,c){if(t&1){let e=T();a(0,"button",24),C("click",function(){f(e);let n=p(2);return h(n.stepperPrevious())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"DIALOGS.ADD_MEMBER_TO_RESOURCE.BACK")," "))}function D0(t,c){if(t&1){let e=T();a(0,"button",25),C("click",function(){f(e);let n=p(2);return n.stepperNext(),h(n.loadGroups())}),s(1),d(2,"translate"),r()}if(t&2){let e=p(2);$("ms-2",e.stepper!==void 0&&e.stepper.selectedIndex!==0)("ms-auto",!(e.stepper!==void 0&&e.stepper.selectedIndex!==0)),_("disabled",e.selectedResource===null||e.processing||e.loading),o(),g(" ",m(2,6,"DIALOGS.ADD_MEMBER_TO_RESOURCE.CONTINUE")," ")}}function R0(t,c){if(t&1){let e=T();a(0,"button",26),C("click",function(){f(e);let n=p(2);return h(n.onFinish())}),s(1),d(2,"translate"),r()}if(t&2){let e=p(2);_("disabled",e.selectedGroups.selected.length===0||e.processing),o(),g(" ",m(2,2,"DIALOGS.ADD_MEMBER_TO_RESOURCE.SUBMIT")," ")}}function O0(t,c){if(t&1){let e=T();a(0,"div")(1,"h1",3),s(2),d(3,"translate"),r(),a(4,"div",4)(5,"mat-stepper",5)(6,"mat-step",6),A(7,I0,2,3,"ng-template",7),a(8,"div",8)(9,"perun-web-apps-facility-search-select",9),C("facilitySelected",function(n){f(e);let l=p();return l.filterResources(n.name),h(l.stepper.selected.completed=!0)}),r()(),a(10,"div",8),v(11,C0,1,4,"perun-web-apps-resource-search-select",10),v(12,S0,1,2,"perun-web-apps-resource-search-select",11),r(),a(13,"div")(14,"span",12),s(15),d(16,"translate"),r(),a(17,"div",13),s(18),r()(),a(19,"div")(20,"span",12),s(21),d(22,"translate"),r(),Ce(23,E0,2,1,"div",13,h0),r()(),a(25,"mat-step"),A(26,T0,2,3,"ng-template",7)(27,b0,1,0,"ng-template",null,1,L),a(29,"div",14),A(30,A0,1,9,"perun-web-apps-groups-list",15),r(),v(31,x0,3,3,"perun-web-apps-alert",16),r()()(),a(32,"div",17)(33,"div")(34,"button",18),C("click",function(){f(e);let n=p();return h(n.onCancel())}),s(35),d(36,"translate"),r(),v(37,M0,3,3,"button",19),v(38,D0,3,8,"button",20),v(39,R0,3,4,"button",21),r()()()}if(t&2){let e=y(28),i=p();o(2),b(m(3,17,"DIALOGS.ADD_MEMBER_TO_RESOURCE.TITLE")),o(3),_("linear",!0),o(4),_("disableAutoSelect",!0)("facilities",i.facilities)("selectPlaceholder","DIALOGS.ADD_MEMBER_TO_RESOURCE.FILTER"),o(2),I(i.processing?-1:11),o(),I(i.processing?12:-1),o(3),b(m(16,19,"DIALOGS.ADD_MEMBER_TO_RESOURCE.DESCRIPTION")),o(3),b(i.description),o(3),b(m(22,21,"DIALOGS.ADD_MEMBER_TO_RESOURCE.SERVICES")),o(2),Se(i.services),o(7),_("perunWebAppsLoader",i.processing)("perunWebAppsLoaderIndicator",e),o(),I(i.groups.length===0&&!i.processing?31:-1),o(4),g(" ",m(36,23,"DIALOGS.ADD_MEMBER_TO_RESOURCE.CANCEL")," "),o(2),I(i.stepper!==void 0&&i.stepper.selectedIndex!==0?37:-1),o(),I(i.stepper!==void 0&&i.stepper.selectedIndex!==i.stepper._steps.length-1?38:-1),o(),I(i.stepper!==void 0&&i.stepper.selectedIndex===i.stepper._steps.length-1?39:-1)}}var Ts=(()=>{class t{constructor(e,i,n,l,E,x,w,U){this.dialogRef=e,this.data=i,this.resourceManager=n,this.groupManager=l,this.notificator=E,this.translate=x,this.authResolver=w,this.cd=U,this.loading=!1,this.processing=!1,this.membersGroupsId=new Set,this.facilities=[],this.filteredResources=[],this.resources=[],this.selectedResource=null,this.services=[],this.description="",this.groups=[],this.selectedGroups=new K(!1,[],!0,(_e,tt)=>_e.id===tt.id)}ngAfterViewInit(){this.stepper.selectionChange.subscribe(()=>{this.selectedGroups.clear()}),this.cd.detectChanges()}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resourceManager.getRichResources(this.data.voId).subscribe(e=>{this.resources=e,this.filteredResources=e,this.getResourceFacilities(),this.loading=!1},()=>this.loading=!1)}setResource(e){this.processing=!0,this.selectedResource=e,this.resourceManager.getAssignedServicesToResource(this.selectedResource.id).subscribe(i=>{this.services=i,this.processing=!1},()=>this.processing=!1),this.description=this.selectedResource.description}loadGroups(){this.processing=!0,this.resourceManager.getAssignedGroups(this.selectedResource.id).subscribe(e=>{this.groups=e,this.groupManager.getAllMemberGroups(this.data.memberId).subscribe(i=>{this.membersGroupsId=new Set(i.map(n=>n.id)),this.groups.forEach(n=>{this.authResolver.isAuthorized("addMember_Group_Member_policy",[n])||this.membersGroupsId.add(n.id)}),this.processing=!1},()=>this.processing=!1)})}onFinish(){this.loading=!0;let e=this.selectedGroups.selected[0].id;this.groupManager.addMembers(e,[this.data.memberId]).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.ADD_MEMBER_TO_RESOURCE.SUCCESS")),this.dialogRef.close(!0)},error:()=>this.loading=!1})}onCancel(){this.dialogRef.close(!1)}stepperPrevious(){this.stepper.previous()}stepperNext(){this.stepper.next()}filterResources(e){if(e==null)return;let i=e.toLowerCase(),n=this.resources.filter(l=>l.facility.name.toLowerCase().startsWith(i));this.filteredResources=n.sort((l,E)=>l.name.toLowerCase().localeCompare(E.name.toLowerCase())),this.setResource(this.filteredResources[0])}getResourceFacilities(){let e=new Set,i=[];for(let n of this.resources)e.add(n.facility.name),i.length!==e.size&&i.push(n.facility);this.facilities=i}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(ei),u(we),u(j),u(X),u(k),u(ht))}}static{this.\u0275cmp=M({type:t,selectors:[["app-add-member-to-resource-dialog"]],viewQuery:function(i,n){if(i&1&&Rt(ci,5),i&2){let l;Ot(l=yt())&&(n.stepper=l.first)}},decls:4,vars:5,consts:[["spinner",""],["tableSpinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],[3,"linear"],["completed","false"],["matStepLabel",""],[1,"input-style"],[3,"facilitySelected","disableAutoSelect","facilities","selectPlaceholder"],[3,"disableAutoSelect","required","resource","resources"],[3,"resources"],[1,"fw-bold"],[1,"ms-5"],[1,"position-relative","table-min-height"],[3,"loading","disableGroups","disableHeadCheckbox","disableRouting","groupsToDisableCheckbox","groups","displayedColumns","selection",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["alert_type","warn"],["mat-dialog-actions","",1,"justify-content-end"],["mat-stroked-button","",1,"me-2",3,"click"],["mat-stroked-button","",1,"ms-auto"],["color","accent","mat-flat-button","",3,"ms-2","ms-auto","disabled"],["color","accent","mat-flat-button","",1,"ms-2",3,"disabled"],[3,"resourceSelected","disableAutoSelect","required","resource","resources"],[3,"loading","disableGroups","disableHeadCheckbox","disableRouting","groupsToDisableCheckbox","groups","displayedColumns","selection"],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",3,"click","disabled"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(i,n){if(i&1&&(A(0,v0,1,0,"ng-template",null,0,L),a(2,"div"),A(3,O0,40,25,"div",2),r()),i&2){let l=y(1);o(2),ce(pe("",n.theme," position-relative")),o(),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,oe,te,ne,ie,$e,ze,ue,O,jt,Di,Ga,ci,Pa,P,Ri,Q,R],styles:[".input-style[_ngcontent-%COMP%]{margin-left:50px;width:75%}"]})}}return t})();function y0(t,c){if(t&1){let e=T();a(0,"button",7),C("click",function(){f(e);let n=p();return h(n.addResource())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"MEMBER_DETAIL.RESOURCES.ADD")," "))}function N0(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function w0(t,c){if(t&1&&S(0,"perun-web-apps-resources-list",8),t&2){let e=p();_("loading",e.loading)("disableRouting",!e.routeAuth)("filterValue",e.filterValue)("displayedColumns",e.displayedColumns)("routingVo",!0)("resources",e.resources)("tableId",e.tableId)}}var bs=(()=>{class t{constructor(e,i,n,l,E,x){this.dialog=e,this.memberManager=i,this.resourceManager=n,this.route=l,this.authResolver=E,this.entityService=x,this.resources=[],this.filterValue="",this.loading=!1,this.displayedColumns=["id","name","vo","facility","tags","description"],this.tableId=Ia}ngOnInit(){this.loading=!0,this.member=this.entityService.getEntity(),this.voBean={id:this.member.voId,beanName:"Vo"},this.addAuth=this.authResolver.isAuthorized("getRichResources_Vo_policy",[this.voBean])&&this.authResolver.isAuthorized("addMembers_Group_List<Member>_policy",[this.voBean]),this.refreshTable()}addResource(){let e=G();e.width="1200px",e.data={memberId:this.member.id,voId:this.member.voId,theme:"member-theme"},this.dialog.open(Ts,e).afterClosed().subscribe(n=>{n&&this.refreshTable()})}refreshTable(){this.loading=!0,this.resourceManager.getAssignedRichResourcesWithMember(this.member.id).subscribe(e=>{this.resources=e,this.resources.length!==0&&(this.routeAuth=this.authResolver.isAuthorized("getResourceById_int_policy",[this.voBean,this.resources[0]])),this.loading=!1})}applyFilter(e){this.filterValue=e}static{this.\u0275fac=function(i){return new(i||t)(u(q),u(Ye),u(ei),u(ve),u(k),u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-member-resources"]],decls:11,vars:7,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"action-button","me-2"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","disableRouting","filterValue","displayedColumns","routingVo","resources","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"action-button","me-2",3,"click"],[3,"loading","disableRouting","filterValue","displayedColumns","routingVo","resources","tableId"]],template:function(i,n){if(i&1){let l=T();a(0,"div")(1,"h1",1),s(2),d(3,"translate"),r(),a(4,"perun-web-apps-refresh-button",2),C("refresh",function(){return f(l),h(n.refreshTable())}),r(),v(5,y0,3,3,"button",3),a(6,"perun-web-apps-debounce-filter",4),C("filter",function(x){return f(l),h(n.applyFilter(x))}),r(),A(7,N0,1,0,"ng-template",null,0,L),a(9,"div",5),A(10,w0,1,7,"perun-web-apps-resources-list",6),r()()}if(i&2){let l=y(8);o(2),b(m(3,5,"MEMBER_DETAIL.RESOURCES.TITLE")),o(3),I(n.addAuth?5:-1),o(),_("placeholder","MEMBER_DETAIL.RESOURCES.FILTER"),o(4),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,Te,xe,O,P,La,Q,R],encapsulation:2})}}return t})();function L0(t,c){if(t&1){let e=T();a(0,"button",8),C("click",function(){f(e);let n=p();return h(n.onAdd())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"GROUP_DETAIL.SETTINGS.EXT_SOURCES.ADD")," "))}function V0(t,c){if(t&1){let e=T();a(0,"button",9),C("click",function(){f(e);let n=p();return h(n.onRemove())}),s(1),d(2,"translate"),r()}if(t&2){let e=p();_("disabled",e.selection.selected.length===0||e.loading),o(),g(" ",m(2,2,"GROUP_DETAIL.SETTINGS.EXT_SOURCES.REMOVE")," ")}}function P0(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function G0(t,c){if(t&1&&S(0,"app-ext-sources-list",10),t&2){let e=p();_("loading",e.loading)("extSources",e.extSources)("selection",e.selection)("cachedSubject",e.cachedSubject)("displayedColumns",e.displayedColumns)("filterValue",e.filterValue)("tableId",e.tableId)}}var As=(()=>{class t{constructor(e,i,n,l,E,x){this.extSourceService=e,this.dialog=i,this.notificator=n,this.translate=l,this.authResolver=E,this.entityStorageService=x,this.extSources=[],this.selection=new K(!0,[]),this.cachedSubject=new me(!0),this.filterValue="",this.tableId=Ca,this.displayedColumns=[],this.translate.get("GROUP_DETAIL.SETTINGS.EXT_SOURCES.SUCCESS_REMOVED").subscribe(w=>this.successMessage=w)}ngOnInit(){this.group=this.entityStorageService.getEntity(),this.setAuthRights(),this.refreshTable()}setAuthRights(){this.addAuth=this.authResolver.isAuthorized("addExtSource_Group_ExtSource_policy",[this.group]),this.removeAuth=this.authResolver.isAuthorized("removeExtSource_Group_ExtSource_policy",[this.group]),this.displayedColumns=this.removeAuth?["select","id","name","type"]:["id","name","type"]}refreshTable(){this.loading=!0,this.extSourceService.getGroupExtSources(this.group.id).subscribe(e=>{this.extSources=e,this.selection.clear(),this.cachedSubject.next(!0),this.loading=!1})}applyFilter(e){this.filterValue=e,this.refreshTable()}onAdd(){let e=G();e.width="1000px",e.data={voId:this.group.voId,groupId:this.group.id,extSources:this.extSources,theme:"group-theme"},this.dialog.open(Pn,e).afterClosed().subscribe(n=>{n&&this.refreshTable()})}onRemove(){let e=G();e.width="600px",e.data={voId:this.group.voId,groupId:this.group.id,extSources:this.selection.selected,theme:"group-theme"},this.dialog.open(Gn,e).afterClosed().subscribe(n=>{n&&this.refreshTable()})}static{this.\u0275fac=function(i){return new(i||t)(u(Jt),u(q),u(j),u(X),u(k),u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-group-settings-extsources"]],decls:12,vars:8,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","extSources","selection","cachedSubject","displayedColumns","filterValue","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"loading","extSources","selection","cachedSubject","displayedColumns","filterValue","tableId"]],template:function(i,n){if(i&1){let l=T();a(0,"div")(1,"h1",1),s(2),d(3,"translate"),r(),a(4,"perun-web-apps-refresh-button",2),C("refresh",function(){return f(l),h(n.refreshTable())}),r(),v(5,L0,3,3,"button",3),v(6,V0,3,4,"button",4),a(7,"perun-web-apps-debounce-filter",5),C("filter",function(x){return f(l),h(n.applyFilter(x))}),r(),A(8,P0,1,0,"ng-template",null,0,L),a(10,"div",6),A(11,G0,1,7,"app-ext-sources-list",7),r()()}if(i&2){let l=y(9);o(2),b(m(3,6,"GROUP_DETAIL.SETTINGS.EXT_SOURCES.TITLE")),o(3),I(n.addAuth?5:-1),o(),I(n.removeAuth?6:-1),o(),_("placeholder","GROUP_DETAIL.SETTINGS.EXT_SOURCES.FILTER"),o(4),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,Te,xe,O,P,Fi,Q,R],encapsulation:2})}}return t})();function B0(t,c){t&1&&S(0,"th",9)}function F0(t,c){if(t&1&&(a(0,"td",10),s(1),r()),t&2){let e=c.$implicit;o(),g("",e,":")}}function k0(t,c){t&1&&S(0,"th",9)}function U0(t,c){if(t&1&&(a(0,"td",11),s(1),r()),t&2){let e=c.$implicit,i=p();o(),g(" ",i.statistics.get(e.toLowerCase())," ")}}function j0(t,c){t&1&&S(0,"tr",12)}var Bn=(()=>{class t{constructor(){this.rowNames=[],this.title="",this.statistics=new Map,this.dataSource=null,this.displayedColumns=["name","value"]}ngOnInit(){this.dataSource=new Qe(this.rowNames)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=M({type:t,selectors:[["app-statistics-card"]],inputs:{rowNames:"rowNames",title:"title",statistics:"statistics"},decls:15,vars:5,consts:[["appearance","outlined",1,"mat-elevation-z3","align-card"],[1,"page-subtitle"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["class","fw-bold","mat-cell","",4,"matCellDef"],["matColumnDef","value"],["mat-cell","",4,"matCellDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"fw-bold"],["mat-cell",""],["mat-row",""]],template:function(i,n){i&1&&(a(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title")(3,"h1",1),s(4),d(5,"translate"),r()()(),a(6,"mat-card-content")(7,"table",2),fe(8,3),A(9,B0,1,0,"th",4)(10,F0,2,1,"td",5),he(),fe(11,6),A(12,k0,1,0,"th",4)(13,U0,2,1,"td",7),he(),A(14,j0,1,0,"tr",8),r()()()),i&2&&(o(4),b(m(5,3,n.title)),o(3),_("dataSource",n.dataSource),o(7),_("matRowDefColumns",n.displayedColumns))},dependencies:[D,ni,rn,sn,ln,ii,je,Le,Pe,Ge,Ve,ke,Be,Fe,Ue,O,R],styles:[".align-card[_ngcontent-%COMP%]{margin:1rem 1rem 1rem 0rem;display:inline-block;vertical-align:top}"]})}}return t})();function W0(t,c){t&1&&S(0,"mat-spinner",1)}function H0(t,c){if(t&1&&(a(0,"div"),S(1,"app-statistics-card",2),r()),t&2){let e=p();o(),_("rowNames",e.rowNames)("statistics",e.membersCount)("title","VO_DETAIL.STATISTICS.MEMBERS_COUNT")}}var xs=(()=>{class t{constructor(e,i){this.voService=e,this.entityStorageService=i,this.loading=!1,this.rowNames=["Members","Valid","Invalid","Expired","Disabled"],this.membersCount=new Map([["members",0],["valid",0],["invalid",0],["expired",0],["disabled",0]]),this.dataSource=new Qe}ngOnInit(){this.loading=!0,this.vo=this.entityStorageService.getEntity(),this.dataSource=new Qe(this.rowNames),this.voService.getVoMembersCountsByStatus(this.vo.id).subscribe({next:e=>{this.allMembersCount=0;for(let i of Object.keys(e))this.membersCount.set(i.toLowerCase(),e[i]),this.allMembersCount+=e[i];this.membersCount.set("members",this.allMembersCount),this.loading=!1},error:()=>this.loading=!1})}static{this.\u0275fac=function(i){return new(i||t)(u(de),u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-statistics"]],decls:5,vars:5,consts:[[1,"page-subtitle"],[1,"ms-auto","me-auto"],[3,"rowNames","statistics","title"]],template:function(i,n){i&1&&(a(0,"h1",0),s(1),d(2,"translate"),r(),v(3,W0,1,0,"mat-spinner",1),v(4,H0,2,3,"div")),i&2&&(o(),b(m(2,3,"VO_DETAIL.STATISTICS.TITLE")),o(2),I(n.loading?3:-1),o(),I(n.loading?-1:4))},dependencies:[D,De,Me,O,Bn,R],encapsulation:2})}}return t})();function z0(t,c){t&1&&S(0,"mat-spinner",1)}function $0(t,c){if(t&1&&(a(0,"div"),S(1,"app-statistics-card",2)(2,"app-statistics-card",2),r()),t&2){let e=p();o(),_("rowNames",e.voStatusCountsRowNames)("statistics",e.membersCountsByVoStatus)("title","GROUP_DETAIL.STATISTICS.VO_STATUS_COUNT"),o(),_("rowNames",e.groupStatusCountsRowNames)("statistics",e.membersCountsByGroupStatus)("title","GROUP_DETAIL.STATISTICS.GROUP_STATUS_COUNT")}}var Ms=(()=>{class t{constructor(e,i){this.groupService=e,this.entityStorageService=i,this.loading=!1,this.voStatusCountsRowNames=["Members","Valid","Invalid","Expired","Disabled"],this.membersCountsByVoStatus=new Map,this.groupStatusCountsRowNames=["Members","Valid","Expired"],this.membersCountsByGroupStatus=new Map}ngOnInit(){this.loading=!0,this.group=this.entityStorageService.getEntity(),this.groupService.getGroupMembersCount(this.group.id).subscribe(e=>{this.membersCountsByVoStatus.set("members",e),this.membersCountsByGroupStatus.set("members",e),this.groupService.getGroupMembersCountsByVoStatus(this.group.id).subscribe(i=>{Object.entries(i).forEach(([n,l])=>this.membersCountsByVoStatus.set(n.toLowerCase(),l)),this.groupService.getGroupMembersCountsByGroupStatus(this.group.id).subscribe(n=>{Object.entries(n).forEach(([l,E])=>this.membersCountsByGroupStatus.set(l.toLowerCase(),E)),this.loading=!1},()=>this.loading=!1)},()=>this.loading=!1)},()=>this.loading=!1)}static{this.\u0275fac=function(i){return new(i||t)(u(we),u(F))}}static{this.\u0275cmp=M({type:t,selectors:[["app-group-statistics"]],decls:5,vars:5,consts:[[1,"page-subtitle"],[1,"ms-auto","me-auto"],[3,"rowNames","statistics","title"]],template:function(i,n){i&1&&(a(0,"h1",0),s(1),d(2,"translate"),r(),v(3,z0,1,0,"mat-spinner",1),v(4,$0,3,6,"div")),i&2&&(o(),b(m(2,3,"GROUP_DETAIL.STATISTICS.TITLE")),o(2),I(n.loading?3:-1),o(),I(n.loading?-1:4))},dependencies:[D,De,Me,O,Bn,R],encapsulation:2})}}return t})();var Y0=["stepper"],X0=()=>["checkbox","id","fullName"],q0=(t,c)=>c.id;function K0(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function Z0(t,c){t&1&&(s(0),d(1,"translate")),t&2&&b(m(1,1,"DIALOGS.CREATE_SERVICE_MEMBER.CREATE_IDENTITY"))}function Q0(t,c){t&1&&(a(0,"mat-error"),s(1),d(2,"translate"),r()),t&2&&(o(),b(m(2,1,"DIALOGS.CREATE_SERVICE_MEMBER.FIELD_EMPTY")))}function J0(t,c){t&1&&(a(0,"mat-error"),s(1),d(2,"translate"),r()),t&2&&(o(),b(m(2,1,"DIALOGS.CREATE_SERVICE_MEMBER.FIELD_EMPTY")))}function eu(t,c){t&1&&(a(0,"mat-error"),s(1),d(2,"translate"),r()),t&2&&(o(),b(m(2,1,"DIALOGS.CREATE_SERVICE_MEMBER.EMAIL_INVALID")))}function tu(t,c){t&1&&(a(0,"mat-error"),s(1),d(2,"translate"),r()),t&2&&(o(),b(m(2,1,"DIALOGS.CREATE_SERVICE_MEMBER.FIELD_EMPTY")))}function iu(t,c){t&1&&(a(0,"mat-error"),s(1),d(2,"translate"),r()),t&2&&(o(),b(m(2,1,"DIALOGS.CREATE_SERVICE_MEMBER.FIELD_EMPTY")))}function nu(t,c){t&1&&(s(0),d(1,"translate")),t&2&&b(m(1,1,"DIALOGS.CREATE_SERVICE_MEMBER.SET_CREDENTIALS"))}function ou(t,c){t&1&&(s(0),d(1,"translate")),t&2&&b(m(1,1,"DIALOGS.CREATE_SERVICE_MEMBER.ASSOCIATE_USERS"))}function au(t,c){if(t&1&&(a(0,"span",30),s(1),r()),t&2){let e=p().$implicit;o(),g("#",e.id)}}function ru(t,c){if(t&1){let e=T();a(0,"mat-list-item")(1,"p",29),s(2),d(3,"userFullName"),v(4,au,2,1,"span",30),a(5,"span",9),d(6,"translate"),a(7,"button",31),d(8,"translate"),C("click",function(){let n=f(e).$implicit,l=p(3);return h(l.removeUser(n))}),a(9,"mat-icon",32),s(10,"close"),r()()()()()}if(t&2){let e=c.$implicit,i=p(3);o(2),g(" ",m(3,7,e.user)," "),o(2),I(e.id?4:-1),o(),_("matTooltipDisabled",i.assignedMembers.length>1)("matTooltip",m(6,9,"DIALOGS.CREATE_SERVICE_MEMBER.MINIMAL_USERS")),o(2),_("matTooltip",Y(m(8,11,"DIALOGS.CREATE_SERVICE_MEMBER.REMOVE")))("disabled",i.assignedMembers.length===1)}}function su(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function lu(t,c){if(t&1&&S(0,"perun-web-apps-members-list",34),t&2){let e=p(4);_("loading",e.loading)("displayedColumns",ge(6,X0))("disableRouting",!0)("selection",e.selection)("members",e.members)("tableId",e.tableId)}}function pu(t,c){if(t&1&&(a(0,"div",27),A(1,lu,1,7,"perun-web-apps-members-list",33),r()),t&2){p();let e=y(59),i=p(2);o(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",e)}}function cu(t,c){t&1&&(a(0,"perun-web-apps-alert",28),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"DIALOGS.CREATE_SERVICE_MEMBER.SEARCH_INFO")," "))}function du(t,c){t&1&&(s(0),d(1,"translate")),t&2&&g(" ",m(1,1,"DIALOGS.CREATE_SERVICE_MEMBER.SPONSOR")," ")}function mu(t,c){t&1&&(a(0,"mat-step"),A(1,du,2,3,"ng-template",15),a(2,"perun-web-apps-alert",28),s(3),d(4,"translate"),r()()),t&2&&(o(3),g(" ",m(4,1,"DIALOGS.CREATE_SERVICE_MEMBER.MANAGE_LIFECYCLE_INFO")," "))}function uu(t,c){if(t&1){let e=T();a(0,"div",5)(1,"mat-stepper",12,1)(3,"mat-step",13)(4,"form",14),A(5,Z0,2,3,"ng-template",15),a(6,"div",16)(7,"mat-form-field")(8,"mat-label"),s(9),d(10,"translate"),r(),S(11,"input",17),v(12,Q0,3,3,"mat-error"),r(),a(13,"mat-form-field")(14,"mat-label"),s(15),d(16,"translate"),r(),S(17,"input",18),v(18,J0,3,3,"mat-error"),v(19,eu,3,3,"mat-error"),r(),a(20,"mat-form-field")(21,"mat-label"),s(22),d(23,"translate"),r(),S(24,"input",19),v(25,tu,3,3,"mat-error"),r(),a(26,"mat-form-field")(27,"mat-label"),s(28),d(29,"translate"),r(),S(30,"input",20),v(31,iu,3,3,"mat-error"),r()()()(),a(32,"mat-step",13)(33,"form",14),A(34,nu,2,3,"ng-template",15),a(35,"app-login-password-form-with-generate-option",21),C("parsedRulesOutput",function(n){f(e);let l=p(2);return h(l.parsedRules=n)}),r()()(),a(36,"mat-step"),A(37,ou,2,3,"ng-template",15),a(38,"h6"),s(39),d(40,"translate"),r(),a(41,"mat-list"),Ce(42,ru,11,13,"mat-list-item",null,q0),r(),a(44,"h6",22),s(45),d(46,"translate"),r(),a(47,"mat-form-field",23)(48,"mat-label"),s(49),d(50,"translate"),r(),a(51,"input",24),C("keyup.enter",function(){f(e);let n=p(2);return h(n.searchCtrl.value.length!==0&&n.onSearchByString())}),r()(),a(52,"button",25),C("click",function(){f(e);let n=p(2);return h(n.onSearchByString())}),a(53,"mat-icon"),s(54,"search"),r()(),a(55,"button",26),C("click",function(){f(e);let n=p(2);return h(n.addUsers())}),s(56),d(57,"translate"),r(),A(58,su,1,0,"ng-template",null,2,L),v(60,pu,2,2,"div",27),v(61,cu,3,3,"perun-web-apps-alert",28),r(),v(62,mu,5,3,"mat-step"),r()()}if(t&2){let e=p(2);o(),_("linear",!0),o(2),_("stepControl",e.firstFormGroup),o(),_("formGroup",e.firstFormGroup),o(5),b(m(10,27,"DIALOGS.CREATE_SERVICE_MEMBER.NAME")),o(3),I(e.firstFormGroup.get("nameCtrl").hasError("required")?12:-1),o(3),b(m(16,29,"DIALOGS.CREATE_SERVICE_MEMBER.EMAIL")),o(3),I(e.firstFormGroup.get("emailCtrl").hasError("required")?18:-1),o(),I(e.firstFormGroup.get("emailCtrl").hasError("pattern")?19:-1),o(3),b(m(23,31,"DIALOGS.CREATE_SERVICE_MEMBER.SUBJECT_DN")),o(2),_("required",!!e.firstFormGroup.get("issuerCtrl").value&&e.firstFormGroup.get("issuerCtrl").value.trim().length!==0),o(),I(e.firstFormGroup.get("subjectCtrl").hasError("required")?25:-1),o(3),b(m(29,33,"DIALOGS.CREATE_SERVICE_MEMBER.ISSUER_DN")),o(2),_("required",!!e.firstFormGroup.get("subjectCtrl").value&&e.firstFormGroup.get("subjectCtrl").value.trim().length!==0),o(),I(e.firstFormGroup.get("issuerCtrl").hasError("required")?31:-1),o(),_("stepControl",e.secondFormGroup),o(),_("formGroup",e.secondFormGroup),o(2),_("formGroup",e.secondFormGroup),o(4),b(m(40,35,"DIALOGS.CREATE_SERVICE_MEMBER.ASSOCIATED_USERS")),o(3),Se(e.assignedMembers),o(3),b(m(46,37,"DIALOGS.CREATE_SERVICE_MEMBER.SEARCH_INFO")),o(4),b(m(50,39,"DIALOGS.CREATE_SERVICE_MEMBER.SEARCH_PLACEHOLDER")),o(2),_("formControl",e.searchCtrl),o(),_("disabled",e.loading||e.searchCtrl.value.length===0),o(3),_("disabled",e.loading||e.selection.selected.length===0),o(),g(" ",m(57,41,"DIALOGS.CREATE_SERVICE_MEMBER.ADD_USER")," "),o(4),I(e.firstSearchDone?60:-1),o(),I(e.firstSearchDone?-1:61),o(),I(e.findSponsorsAuth&&e.voSponsors.length!==0&&e.setSponsorshipAuth?62:-1)}}function _u(t,c){if(t&1){let e=T();a(0,"button",35),C("click",function(){f(e);let n=p(2);return h(n.stepperPrevious())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"DIALOGS.CREATE_SERVICE_MEMBER.BACK")," "))}function gu(t,c){if(t&1){let e=T();a(0,"button",26),C("click",function(){f(e);let n=p(2);return h(n.stepperNext())}),s(1),d(2,"translate"),r()}if(t&2){let e=p(2);$("ms-2",e.stepper!==void 0&&e.stepper.selectedIndex!==0)("ms-auto",!(e.stepper!==void 0&&e.stepper.selectedIndex!==0)),_("disabled",e.getStepperNextConditions()),o(),g(" ",m(2,6,"DIALOGS.CREATE_SERVICE_MEMBER.NEXT")," ")}}function fu(t,c){if(t&1){let e=T();a(0,"button",36),C("click",function(){f(e);let n=p(2);return h(n.onCreate(!0))}),s(1),d(2,"translate"),r()}if(t&2){let e=p(2);_("disabled",e.firstFormGroup.invalid||e.secondFormGroup.get("namespaceCtrl").value!=="Not selected"&&e.secondFormGroup.invalid),o(),g(" ",m(2,2,"DIALOGS.CREATE_SERVICE_MEMBER.CREATE_AND_SPONSOR")," ")}}function hu(t,c){if(t&1){let e=T();a(0,"button",36),C("click",function(){f(e);let n=p(2);return h(n.onCreate(!1))}),s(1),d(2,"translate"),r()}if(t&2){let e=p(2);_("disabled",e.firstFormGroup.invalid||e.secondFormGroup.get("namespaceCtrl").value!=="Not selected"&&e.secondFormGroup.invalid),o(),g(" ",m(2,2,"DIALOGS.CREATE_SERVICE_MEMBER.CREATE")," ")}}function vu(t,c){if(t&1){let e=T();a(0,"div")(1,"h1",4),s(2),d(3,"translate"),r(),v(4,uu,63,43,"div",5),a(5,"div",6)(6,"div")(7,"button",7),C("click",function(){f(e);let n=p();return h(n.onCancel())}),s(8),d(9,"translate"),r(),v(10,_u,3,3,"button",8),a(11,"span",9),d(12,"translate"),v(13,gu,3,8,"button",10),r(),v(14,fu,3,4,"button",11),v(15,hu,3,4,"button",11),r()()()}if(t&2){let e=p();o(2),b(m(3,9,"DIALOGS.CREATE_SERVICE_MEMBER.TITLE")),o(2),I(e.firstFormGroup!==void 0?4:-1),o(4),g(" ",m(9,11,"DIALOGS.CREATE_SERVICE_MEMBER.CANCEL")," "),o(2),I(e.stepper!==void 0&&e.stepper.selectedIndex!==0?10:-1),o(),_("matTooltipDisabled",e.loading||e.selection.selected.length===0)("matTooltip",m(12,13,"DIALOGS.CREATE_SERVICE_MEMBER.NEXT_BUTTON_DISABLED_TOOLTIP")),o(2),I(e.stepper!==void 0&&e.stepper.selectedIndex!==e.stepper._steps.length-1?13:-1),o(),I(e.findSponsorsAuth&&e.voSponsors.length!==0&&e.setSponsorshipAuth&&e.stepper!==void 0&&e.stepper.selectedIndex===e.stepper._steps.length-1?14:-1),o(),I(e.stepper!==void 0&&e.stepper.selectedIndex===e.stepper._steps.length-1?15:-1)}}var Ds=(()=>{class t{constructor(e,i,n,l,E,x,w,U,_e,tt,Ht,Xs){this.dialogRef=e,this.data=i,this.membersManagerService=n,this.usersManagerService=l,this.notificator=E,this.translate=x,this.store=w,this.apiRequestConfiguration=U,this._formBuilder=_e,this.cd=tt,this.authResolver=Ht,this.findSponsors=Xs,this.firstFormGroup=this._formBuilder.group({nameCtrl:["",dt.required],emailCtrl:["",[dt.required,dt.pattern(pn)]],subjectCtrl:[""],issuerCtrl:[""]}),this.secondFormGroup=this._formBuilder.group({namespaceCtrl:["Not selected"],loginCtrl:["",[dt.pattern("^[a-z][a-z0-9_-]+$"),dt.maxLength(15),dt.minLength(2)]],passwordCtrl:["",dt.required,[ya(null,this.usersManagerService,this.apiRequestConfiguration)]],passwordAgainCtrl:[""],generatePasswordCtrl:[!0]},{validators:Yo.passwordMatchValidator}),this.parsedRules=new Map,this.firstSearchDone=!1,this.searchCtrl=new ct(""),this.members=[],this.selection=new K(!0,[],!0,(Ui,qs)=>Ui.id===qs.id),this.tableId=ua,this.assignedMembers=[],this.candidate={beanName:"",id:0},this.successMessageMember="",this.successMessagePwd="",this.processing=!1,this.sponsorshipEnabled=!1,this.voSponsors=[],x.get("DIALOGS.CREATE_SERVICE_MEMBER.SUCCESS_MEMBER").subscribe(Ui=>this.successMessageMember=Ui),x.get("DIALOGS.CREATE_SERVICE_MEMBER.SUCCESS_PWD").subscribe(Ui=>this.successMessagePwd=Ui)}ngAfterViewInit(){this.cd.detectChanges()}ngOnInit(){this.theme=this.data.theme,this.sponsorshipEnabled=this.store.getProperty("enable_sponsorships");let e=this.store.getPerunPrincipal().user;this.membersManagerService.getMembersByUser(e.id).subscribe(i=>{let n={};for(let l of i)l.voId===this.data.vo.id&&(n=l);n.user=e,this.assignedMembers.push(n)}),this.sponsorshipEnabled&&(this.setSponsorshipAuth=this.authResolver.isAuthorized("setSponsorshipForMember_Member_User_LocalDate_policy",[this.data.vo,this.store.getPerunPrincipal().user]),this.findSponsorsAuth=this.findSponsors.findSponsorsAuth(this.data.vo),this.findSponsorsAuth&&this.findSponsors.getRichSponsors(this.data.vo.id).subscribe(i=>{this.voSponsors=i}))}onCreate(e){this.processing=!0,this.candidate.firstName="",this.candidate.lastName=this.firstFormGroup.value.nameCtrl,this.candidate.attributes={},this.candidate.attributes["urn:perun:member:attribute-def:def:mail"]=this.firstFormGroup.value.emailCtrl;let i=this.firstFormGroup.value.subjectCtrl;i&&(this.candidate.userExtSource={},this.candidate.userExtSource.login=i,this.candidate.userExtSource.loa=0,this.candidate.userExtSource.extSource={},this.candidate.userExtSource.extSource.name=this.firstFormGroup.value.issuerCtrl,this.candidate.userExtSource.extSource.type="cz.metacentrum.perun.core.impl.ExtSourceX509");let n=this.secondFormGroup.value.namespaceCtrl.toLowerCase(),l=this.parsedRules.get(n),E=`urn:perun:user:attribute-def:def:login-namespace:${n}`;this.secondFormGroup.value.namespaceCtrl!=="Not selected"&&l.login==="disabled"?this.usersManagerService.generateAccountForName(n,this.firstFormGroup.value.nameCtrl).subscribe({next:x=>{this.candidate.attributes[E]=x[E],this.createSpecificMember(e)},error:()=>this.processing=!1}):(this.secondFormGroup.value.namespaceCtrl!=="Not selected"&&(this.candidate.attributes[E]=this.secondFormGroup.value.loginCtrl),this.createSpecificMember(e))}createSpecificMember(e){this.membersManagerService.createSpecificMember({vo:this.data.vo.id,specificUserType:"SERVICE",specificUserOwners:this.assignedMembers.map(i=>i.user),candidate:this.candidate}).subscribe({next:i=>{this.membersManagerService.validateMemberAsync(i.id).subscribe({next:n=>{this.notificator.showSuccess(this.successMessageMember),this.secondFormGroup.value.namespaceCtrl!=="Not selected"?this.setPassword(n,this.secondFormGroup.value.generatePasswordCtrl,e):this.dialogRef.close({result:!0,sponsor:e,voSponsors:this.voSponsors,findSponsorsAuth:this.findSponsorsAuth,serviceMemberId:i.id})},error:()=>this.processing=!1})},error:()=>this.processing=!1})}setPassword(e,i,n){let l=this.secondFormGroup.value.namespaceCtrl.toLowerCase(),E=this.secondFormGroup.value.passwordCtrl;if(i){if(this.parsedRules.get(l).login==="disabled"){this.validateMember(e.id,n);return}this.usersManagerService.reserveRandomPassword(e.userId,l).subscribe({next:()=>{this.usersManagerService.validatePasswordForUser(e.userId,l).subscribe({next:()=>{this.validateMember(e.id,n,!1)},error:()=>{this.processing=!1}})},error:()=>{this.processing=!1}})}else this.usersManagerService.reservePasswordForUser({user:e.userId,namespace:l,password:E}).subscribe({next:()=>{this.usersManagerService.validatePasswordForUser(e.userId,l).subscribe({next:()=>{this.validateMember(e.id,n)},error:()=>{this.processing=!1,this.dialogRef.close({result:!0,sponsor:n,voSponsors:this.voSponsors,findSponsorsAuth:this.findSponsorsAuth,serviceMemberId:e.id})}})},error:()=>{this.processing=!1,this.dialogRef.close({result:!0,sponsor:n,voSponsors:this.voSponsors,findSponsorsAuth:this.findSponsorsAuth,serviceMemberId:e.id})}})}validateMember(e,i,n=!0){this.membersManagerService.validateMemberAsync(e).subscribe({next:()=>{n&&this.notificator.showSuccess(this.successMessagePwd),this.dialogRef.close({result:!0,sponsor:i,voSponsors:this.voSponsors,findSponsorsAuth:this.findSponsorsAuth,serviceMemberId:e})},error:()=>{this.processing=!1}})}onCancel(){this.dialogRef.close({result:!1,sponsor:!1})}onSearchByString(){this.loading=!0,this.firstSearchDone=!0,this.membersManagerService.findCompleteRichMembersForVo(this.data.vo.id,[""],this.searchCtrl.value.trim()).subscribe(e=>{this.members=e.filter(i=>!i.user.specificUser),this.loading=!1})}addUsers(){let e=this.assignedMembers.map(i=>i.id);this.selection.selected.forEach(i=>{e.includes(i.id)||this.assignedMembers.push(i)}),this.selection.clear()}removeUser(e){this.assignedMembers=this.assignedMembers.filter(i=>i.id!==e.id)}getStepperNextConditions(){switch(this.stepper.selectedIndex){case 0:return this.firstFormGroup.invalid||this.firstFormGroup.pending;case 1:return this.secondFormGroup.invalid||this.secondFormGroup.pending;case 2:return this.selection.selected.length>0;default:return!1}}stepperPrevious(){this.stepper.previous()}stepperNext(){this.stepper.next()}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(Ye),u(ti),u(j),u(X),u(Xe),u(pt),u(vo),u(ht),u(k),u(_n))}}static{this.\u0275cmp=M({type:t,selectors:[["app-create-service-member-dialog"]],viewQuery:function(i,n){if(i&1&&Rt(Y0,5),i&2){let l;Ot(l=yt())&&(n.stepper=l.first)}},decls:4,vars:5,consts:[["spinner",""],["stepper",""],["tableSpinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],["mat-dialog-actions","",1,"justify-content-end"],["mat-stroked-button","",1,"me-2",3,"click"],["mat-stroked-button","",1,"ms-auto"],[3,"matTooltipDisabled","matTooltip"],["color","accent","mat-flat-button","",3,"ms-2","ms-auto","disabled"],["color","accent","mat-flat-button","",1,"ms-2",3,"disabled"],[3,"linear"],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],[1,"display-flex"],["formControlName","nameCtrl","matInput","","required",""],["formControlName","emailCtrl","matInput","","required","","type","email"],["formControlName","subjectCtrl","matInput","",3,"required"],["formControlName","issuerCtrl","matInput","",3,"required"],[3,"parsedRulesOutput","formGroup"],[1,"mt-3"],[1,"me-2","w-50"],["autocomplete","false","matInput","",3,"keyup.enter","formControl"],["color","primary","mat-flat-button","",1,"me-2",3,"click","disabled"],["color","accent","mat-flat-button","",3,"click","disabled"],[1,"position-relative","table-min-height"],["alert_type","info"],[1,"truncate","center-content","d-flex","align-items-center"],[1,"text-muted"],["color","warn","mat-icon-button","",1,"ms-1",3,"click","disabled","matTooltip"],[1,"margin-bottom"],[3,"loading","displayedColumns","disableRouting","selection","members","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","displayedColumns","disableRouting","selection","members","tableId"],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(i,n){if(i&1&&(A(0,K0,1,0,"ng-template",null,0,L),a(2,"div"),A(3,vu,16,15,"div",3),r()),i&2){let l=y(1);o(2),ce(pe("",n.theme," position-relative")),o(),_("perunWebAppsLoader",n.processing)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,Ft,et,Je,He,We,Vt,bi,lt,st,Ne,Ji,nt,ye,Ci,Si,Qt,en,tn,oe,te,ne,ie,$e,ze,ue,Li,Go,Vo,Po,O,Ae,Di,P,Ar,Ri,ci,Q,R,kt],styles:[".display-flex[_ngcontent-%COMP%]{display:flex;flex-direction:column}.input-disabled[_ngcontent-%COMP%]{pointer-events:none;color:#888}.truncate[_ngcontent-%COMP%]{overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap}.center-content[_ngcontent-%COMP%]{margin-bottom:auto;margin-top:auto}.white-space-pre[_ngcontent-%COMP%]{white-space:pre}.margin-bottom[_ngcontent-%COMP%]{margin-bottom:6px}"]})}}return t})();var Iu=()=>["checkbox","id","type","fullName","status"];function Cu(t,c){if(t&1){let e=T();a(0,"button",8),C("click",function(){f(e);let n=p();return h(n.onRemoveMembers())}),s(1),d(2,"translate"),r()}if(t&2){let e=p();_("disabled",e.loading||e.selection.isEmpty()),o(),g(" ",m(2,2,"VO_DETAIL.SETTINGS.SERVICE_MEMBERS.DELETE")," ")}}function Su(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function Eu(t,c){if(t&1&&S(0,"perun-web-apps-members-list",9),t&2){let e=p();_("loading",e.loading)("displayedColumns",ge(8,Iu))("disableStatusChange",!0)("selection",e.selection)("members",e.members)("filter",e.searchString)("tableId",e.tableId)("cacheSubject",e.cacheSubject)}}var Rs=(()=>{class t{constructor(e,i,n,l,E,x){this.membersManager=e,this.dialog=i,this.authResolver=n,this.authzService=l,this.entityStorageService=E,this.cd=x,this.members=[],this.selection=new K(!0,[],!0,(w,U)=>w.id===U.id),this.searchString="",this.loading=!1,this.tableId=Ta,this.cacheSubject=new me(!0)}ngOnInit(){this.loading=!0,this.vo=this.entityStorageService.getEntity(),this.removeAuth=this.authzService.isAuthorized("deleteMembers_List<Member>_policy",[this.vo]),this.refresh()}createServiceMember(){let e=G();e.width="900px",e.data={vo:this.vo,theme:"vo-theme"},this.dialog.open(Ds,e).afterClosed().subscribe(n=>{n.result&&(n.sponsor?(e.data={voId:this.vo.id,theme:"vo-theme",voSponsors:n.voSponsors,findSponsorsAuth:n.findSponsorsAuth,serviceMemberId:n.serviceMemberId},this.dialog.open(Er,e).afterClosed().subscribe(()=>{this.refresh()})):this.refresh())})}onRemoveMembers(){let e=G();e.width="450px",e.data={members:this.selection.selected,theme:"vo-theme"},this.dialog.open(Xa,e).afterClosed().subscribe(n=>{n&&(this.selection.clear(),this.refresh())})}applyFilter(e){this.searchString=e}refresh(){this.cacheSubject.next(!0),this.loading=!0,this.membersManager.getServiceUserRichMembers(this.vo.id).subscribe(e=>{this.members=e.filter(i=>this.authResolver.isAuthorized("getRichMemberWithAttributes_Member_policy",[i])),this.loading=!1,this.cd.detectChanges()})}static{this.\u0275fac=function(i){return new(i||t)(u(Ye),u(q),u(k),u(k),u(F),u(ht))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-settings-service-members"]],decls:13,vars:10,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","displayedColumns","disableStatusChange","selection","members","filter","tableId","cacheSubject",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"loading","displayedColumns","disableStatusChange","selection","members","filter","tableId","cacheSubject"]],template:function(i,n){if(i&1){let l=T();a(0,"h1",1),s(1),d(2,"translate"),r(),a(3,"perun-web-apps-refresh-button",2),C("refresh",function(){return f(l),h(n.refresh())}),r(),a(4,"button",3),C("click",function(){return f(l),h(n.createServiceMember())}),s(5),d(6,"translate"),r(),v(7,Cu,3,4,"button",4),a(8,"perun-web-apps-debounce-filter",5),C("filter",function(x){return f(l),h(n.applyFilter(x))}),r(),A(9,Su,1,0,"ng-template",null,0,L),a(11,"div",6),A(12,Eu,1,9,"perun-web-apps-members-list",7),r()}if(i&2){let l=y(10);o(),b(m(2,6,"VO_DETAIL.SETTINGS.SERVICE_MEMBERS.TITLE")),o(4),g(" ",m(6,8,"VO_DETAIL.SETTINGS.SERVICE_MEMBERS.CREATE"),`
`),o(2),I(n.removeAuth?7:-1),o(),_("placeholder","VO_DETAIL.SETTINGS.SERVICE_MEMBERS.FILTER"),o(4),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,Te,xe,Li,O,P,Q,R],encapsulation:2})}}return t})();var Tu=["stepper"];function bu(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function Au(t,c){t&1&&(s(0),d(1,"translate")),t&2&&b(m(1,1,"VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.ADD_MEMBER_ORGANIZATION.SELECTION_STEP"))}function xu(t,c){t&1&&(s(0),d(1,"translate")),t&2&&b(m(1,1,"VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.ADD_MEMBER_ORGANIZATION.CONFIRMATION_STEP"))}function Mu(t,c){t&1&&S(0,"th",24)}function Du(t,c){if(t&1&&(a(0,"td",25),s(1),r()),t&2){let e=c.$implicit;o(),b(e.name)}}function Ru(t,c){t&1&&S(0,"tr",26)}function Ou(t,c){t&1&&S(0,"tr",27)}function yu(t,c){if(t&1&&(a(0,"span"),s(1),d(2,"translate"),r(),a(3,"table",17),fe(4,18),A(5,Mu,1,0,"th",19)(6,Du,2,1,"td",20),he(),A(7,Ru,1,0,"tr",21)(8,Ou,1,0,"tr",22),r(),a(9,"perun-web-apps-alert",23),s(10),d(11,"translate"),r()),t&2){let e=p(2);o(),b(m(2,6,"VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.ADD_MEMBER_ORGANIZATION.CONFIRM")),o(2),_("dataSource",e.voSelection.selected),o(4),_("matHeaderRowDef",e.columns),o(),_("matRowDefColumns",e.columns),o(),_("alert_type","warn"),o(),b(m(11,8,"VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.ADD_MEMBER_ORGANIZATION.WARNING"))}}function Nu(t,c){if(t&1){let e=T();a(0,"button",28),C("click",function(){f(e);let n=p(2);return h(n.stepperPrevious())}),s(1),d(2,"translate"),r()}if(t&2){let e=p(2);_("disabled",e.loading),o(),g(" ",m(2,2,"VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.ADD_MEMBER_ORGANIZATION.BACK")," ")}}function wu(t,c){if(t&1){let e=T();a(0,"button",29),C("click",function(){f(e);let n=p(2);return h(n.stepperNext())}),s(1),d(2,"translate"),r()}if(t&2){let e=p(2);_("disabled",e.voSelection.selected.length===0||e.loading),o(),g(" ",m(2,2,"VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.ADD_MEMBER_ORGANIZATION.NEXT")," ")}}function Lu(t,c){if(t&1){let e=T();a(0,"button",29),C("click",function(){f(e);let n=p(2);return h(n.addMemberOrganization())}),s(1),d(2,"translate"),r()}if(t&2){let e=p(2);_("disabled",e.loading),o(),g(" ",m(2,2,"VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.ADD_MEMBER_ORGANIZATION.ADD")," ")}}function Vu(t,c){if(t&1){let e=T();a(0,"div")(1,"h1",3),s(2),d(3,"translate"),r(),a(4,"div",4)(5,"mat-stepper",5,1)(7,"mat-step",6),A(8,Au,2,3,"ng-template",7),a(9,"perun-web-apps-debounce-filter",8),C("filter",function(n){f(e);let l=p();return h(l.applyFilter(n))}),r(),S(10,"perun-web-apps-vos-list",9),r(),a(11,"mat-step"),A(12,xu,2,3,"ng-template",7)(13,yu,12,10,"ng-template",10),r()()(),a(14,"div",11)(15,"div",12)(16,"button",13),C("click",function(){f(e);let n=p();return h(n.close())}),s(17),d(18,"translate"),r(),a(19,"div",14),v(20,Nu,3,4,"button",15),v(21,wu,3,4,"button",16),v(22,Lu,3,4,"button",16),r()()()()}if(t&2){let e=y(6),i=p();o(2),g(" ",m(3,15,"VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.ADD_MEMBER_ORGANIZATION.TITLE")," "),o(3),_("linear",!0),o(2),_("completed",i.voSelection.selected.length!==0),o(2),_("placeholder","VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.ADD_MEMBER_ORGANIZATION.FILTER_VOS"),o(),_("loading",i.loading)("vos",i.vos)("selection",i.voSelection)("cachedSubject",i.cachedSubject)("displayedColumns",i.displayedColumns)("filterValue",i.voFilter)("disableRouting",!0),o(7),g(" ",m(18,17,"VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.ADD_MEMBER_ORGANIZATION.CANCEL")," "),o(3),I(e!==void 0&&e.selectedIndex!==0?20:-1),o(),I((e==null?null:e.selectedIndex)!==1?21:-1),o(),I((e==null?null:e.selectedIndex)===1?22:-1)}}var Os=(()=>{class t{constructor(e,i,n,l,E,x){this.dialogRef=e,this.vosService=i,this.entityStorage=n,this.authResolver=l,this.notificator=E,this.translator=x,this.loading=!1,this.theme="vo-theme",this.displayedColumns=["checkbox","id","name","shortName"],this.columns=["name"],this.vos=[],this.voSelection=new K(!1,[],!0,(w,U)=>w.id===U.id),this.cachedSubject=new me(!0),this.voFilter=""}ngOnInit(){this.loading=!0,this.voId=this.entityStorage.getEntity().id,this.vosService.getEnrichedVoById(this.voId).subscribe(e=>{this.vosService.getAllVos().subscribe(i=>{let n=e.memberVos.map(l=>l.id);this.vos=i.filter(l=>!n.includes(l.id)&&l.id!==this.voId&&this.authResolver.isAuthorized("operand-addMemberVo_Vo_Vo_policy",[l])),this.loading=!1},()=>this.loading=!1)},()=>this.loading=!1)}close(){this.dialogRef.close(!1)}stepperNext(){this.stepper.next()}stepperPrevious(){this.stepper.previous()}applyFilter(e){this.voFilter=e,this.voSelection.clear(),this.cachedSubject.next(!0)}addMemberOrganization(){this.loading=!0,this.vosService.addMemberVo(this.voId,this.voSelection.selected[0].id).subscribe(()=>{this.notificator.showSuccess(this.translator.instant("VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.ADD_MEMBER_ORGANIZATION.SUCCESS")),this.dialogRef.close(!0)},()=>this.loading=!1)}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(de),u(F),u(k),u(j),u(X))}}static{this.\u0275cmp=M({type:t,selectors:[["app-add-member-organization-dialog"]],viewQuery:function(i,n){if(i&1&&Rt(Tu,5),i&2){let l;Ot(l=yt())&&(n.stepper=l.first)}},decls:4,vars:5,consts:[["spinner",""],["stepper",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],[3,"linear"],[3,"completed"],["matStepLabel",""],[3,"filter","placeholder"],[3,"loading","vos","selection","cachedSubject","displayedColumns","filterValue","disableRouting"],["matStepContent",""],["mat-dialog-actions","",1,"justify-content-end"],[1,"d-flex"],["mat-stroked-button","",1,"me-2",3,"click"],[1,"ms-auto"],["mat-stroked-button","",3,"disabled"],["color","accent","mat-flat-button","",3,"disabled"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"alert_type"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],["mat-stroked-button","",3,"click","disabled"],["color","accent","mat-flat-button","",3,"click","disabled"]],template:function(i,n){if(i&1&&(A(0,bu,1,0,"ng-template",null,0,L),a(2,"div"),A(3,Vu,23,19,"div",2),r()),i&2){let l=y(1);o(2),ce(pe("",n.theme," position-relative")),o(),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,oe,te,ne,ie,$e,ze,ue,Te,je,Le,Pe,Ke,Ge,Ve,ke,Be,Fe,Ze,Ue,O,fn,Di,P,ci,Oo,Ri,R],encapsulation:2})}}return t})();function Pu(t,c){if(t&1){let e=T();a(0,"button",8),C("click",function(){f(e);let n=p();return h(n.addMemberOrganization())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.ADD")," "))}function Gu(t,c){if(t&1){let e=T();a(0,"button",9),C("click",function(){f(e);let n=p();return h(n.removeMemberOrganization())}),s(1),d(2,"translate"),r()}if(t&2){let e=p();_("disabled",e.loading||e.voSelection.selected.length===0),o(),g(" ",m(2,2,"VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.REMOVE")," ")}}function Bu(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function Fu(t,c){if(t&1&&S(0,"perun-web-apps-vos-list",10),t&2){let e=p();_("loading",e.loading)("vos",e.memberVos)("selection",e.voSelection)("cachedSubject",e.cachedSubject)("filterValue",e.filterValue)("disableRouting",!e.routeAuth)("disableCheckbox",!e.removeAuth)("displayedColumns",e.displayedColumns)}}var ys=(()=>{class t{constructor(e,i,n,l,E,x,w){this.dialog=e,this.vosService=i,this.entityStorage=n,this.authResolver=l,this.reloadDetailService=E,this.notificator=x,this.translator=w,this.loading=!1,this.voSelection=new K(!1,[],!0,(U,_e)=>U.id===_e.id),this.cachedSubject=new me(!0),this.displayedColumns=["checkbox","id","shortName","name"],this.filterValue="",this.routeAuth=!1,this.addAuth=!1,this.removeAuth=!1,this.memberVos=[]}ngOnInit(){let e=this.entityStorage.getEntity();this.addAuth=this.authResolver.isAuthorized("result-addMemberVo_Vo_Vo_policy",[e]),this.removeAuth=this.authResolver.isAuthorized("removeMemberVo_Vo_Vo_policy",[e]),this.routeAuth=this.authResolver.isPerunAdminOrObserver(),this.voId=this.entityStorage.getEntity().id,this.refresh()}refresh(){this.loading=!0,this.vosService.getEnrichedVoById(this.voId).subscribe({next:e=>{this.voId=e.vo.id,this.memberVos=e.memberVos,this.voSelection.clear(),this.cachedSubject.next(!0),this.loading=!1},error:()=>{this.loading=!1}})}addMemberOrganization(){let e=G();e.width="750px",this.dialog.open(Os,e).afterClosed().subscribe(i=>{i&&(this.reloadDetailService.reloadEntityDetail(),this.refresh())})}removeMemberVos(){this.vosService.removeMemberVo(this.voId,this.voSelection.selected[0].id).subscribe(()=>{this.notificator.showSuccess(this.translator.instant("VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.REMOVE_MEMBER_ORGANIZATION.TITLE")),this.reloadDetailService.reloadEntityDetail(),this.refresh()})}removeMemberOrganization(){let e=G();e.width="550px",e.data={items:this.voSelection.selected.map(i=>i.name),title:"VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.REMOVE_MEMBER_ORGANIZATION.TITLE",alert:"VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.REMOVE_MEMBER_ORGANIZATION.WARNING",theme:"vo-theme",type:"remove",showAsk:!0},this.dialog.open(Ut,e).afterClosed().subscribe(i=>{i&&this.removeMemberVos()})}applyFilter(e){this.filterValue=e,this.refresh()}static{this.\u0275fac=function(i){return new(i||t)(u(q),u(de),u(F),u(k),u(Gi),u(j),u(X))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-settings-member-organizations"]],decls:11,vars:8,consts:[["spinner",""],[1,"page-subtitle"],[3,"click"],["mat-flat-button","","color","accent",1,"me-2","action-button"],["mat-flat-button","","color","warn",1,"me-2",3,"disabled"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","vos","selection","cachedSubject","filterValue","disableRouting","disableCheckbox","displayedColumns",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-flat-button","","color","accent",1,"me-2","action-button",3,"click"],["mat-flat-button","","color","warn",1,"me-2",3,"click","disabled"],[3,"loading","vos","selection","cachedSubject","filterValue","disableRouting","disableCheckbox","displayedColumns"]],template:function(i,n){if(i&1){let l=T();a(0,"h1",1),s(1),d(2,"translate"),r(),a(3,"perun-web-apps-refresh-button",2),C("click",function(){return f(l),h(n.refresh())}),r(),v(4,Pu,3,3,"button",3),v(5,Gu,3,4,"button",4),a(6,"perun-web-apps-debounce-filter",5),C("filter",function(x){return f(l),h(n.applyFilter(x))}),r(),A(7,Bu,1,0,"ng-template",null,0,L),a(9,"div",6),A(10,Fu,1,8,"perun-web-apps-vos-list",7),r()}if(i&2){let l=y(8);o(),b(m(2,6,"VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.TITLE")),o(3),I(n.addAuth?4:-1),o(),I(n.removeAuth?5:-1),o(),_("placeholder","VO_DETAIL.SETTINGS.MEMBER_ORGANIZATIONS.FILTER"),o(4),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,Te,xe,O,fn,P,Q,R],encapsulation:2})}}return t})();var ku=t=>({parentVo:t}),Uu=()=>["select","id","name","description"];function ju(t,c){if(t&1&&S(0,"perun-web-apps-groups-list",10),t&2){let e=p();_("loading",e.loading)("tableId",e.tableId)("groups",e.groups)("selection",e.selected)("filter",e.filterValue)("displayedColumns",ge(8,Uu))("disableRouting",!0)("noGroupsAlert","DIALOGS.ADD_GROUPS_HIERARCHICAL_INCLUSION.NO_GROUPS_FOUND_ALERT")}}function Wu(t,c){t&1&&S(0,"perun-web-apps-loading-table")}var Ns=(()=>{class t{constructor(e,i,n,l,E){this.dialogRef=e,this.data=i,this.groupService=n,this.notificator=l,this.translate=E,this.loading=!1,this.selected=new K(!0,[],!0,(x,w)=>x.id===w.id),this.tableId=Aa,this.filterValue=""}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.voId=this.data.voId,this.parentVo=this.data.parentVo,this.groupService.getAllGroups(this.voId).subscribe(e=>{this.groups=e.filter(i=>!this.data.allowedGroupsIds.includes(i.id)),this.loading=!1})}applyFilter(e){this.filterValue=e}close(){this.dialogRef.close(!1)}confirm(){this.loading=!0;let e=this.selected.selected.map(i=>i.id);this.groupService.allowGroupsToHierarchicalVo(e,this.parentVo.id).subscribe({next:()=>{this.dialogRef.close(!0),this.notificator.showSuccess(this.translate.instant("DIALOGS.ADD_GROUPS_HIERARCHICAL_INCLUSION.SUCCESS")),this.loading=!1},error:()=>this.loading=!1})}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(we),u(j),u(mt))}}static{this.\u0275cmp=M({type:t,selectors:[["app-add-group-hierarchical-include-dialog"]],decls:20,vars:22,consts:[["spinner",""],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],["alert_type","info"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],["theme","vo-theme",3,"loading","tableId","groups","selection","filter","displayedColumns","disableRouting","noGroupsAlert",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click","disabled"],["color","accent","mat-flat-button","",3,"click","disabled"],["theme","vo-theme",3,"loading","tableId","groups","selection","filter","displayedColumns","disableRouting","noGroupsAlert"]],template:function(i,n){if(i&1){let l=T();a(0,"div")(1,"h1",1),s(2),d(3,"translate"),r(),a(4,"div",2)(5,"perun-web-apps-alert",3),s(6),d(7,"translate"),r(),a(8,"perun-web-apps-debounce-filter",4),C("filter",function(x){return f(l),h(n.applyFilter(x))}),r(),a(9,"div",5),A(10,ju,1,9,"perun-web-apps-groups-list",6),r(),A(11,Wu,1,0,"ng-template",null,0,L),r(),a(13,"div",7)(14,"button",8),C("click",function(){return f(l),h(n.close())}),s(15),d(16,"translate"),r(),a(17,"button",9),C("click",function(){return f(l),h(n.confirm())}),s(18),d(19,"translate"),r()()()}if(i&2){let l=y(12);ce(n.theme),o(2),g(" ",m(3,11,"DIALOGS.ADD_GROUPS_HIERARCHICAL_INCLUSION.TITLE")," "),o(4),g(" ",it(7,13,"DIALOGS.ADD_GROUPS_HIERARCHICAL_INCLUSION.INFO",Ee(20,ku,n.parentVo.name))," "),o(2),_("placeholder","DIALOGS.ADD_GROUPS_HIERARCHICAL_INCLUSION.SEARCH"),o(2),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l),o(4),_("disabled",n.loading),o(),g(" ",m(16,16,"DIALOGS.ADD_GROUPS_HIERARCHICAL_INCLUSION.CANCEL")," "),o(2),_("disabled",n.selected.selected.length===0||n.loading),o(),g(" ",m(19,18,"DIALOGS.ADD_GROUPS_HIERARCHICAL_INCLUSION.ALLOW")," ")}},dependencies:[D,N,V,oe,te,ne,ie,$e,ze,Te,O,jt,P,Q,R],encapsulation:2})}}return t})();var Hu=()=>["select","id","name","description"];function zu(t,c){if(t&1){let e=T();a(0,"perun-web-apps-vo-search-select",10),C("voSelected",function(n){f(e);let l=p();return h(l.voSelected(n))}),r()}if(t&2){let e=p();_("vos",e.parentVos)("disableAutoSelect",!0)}}function $u(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function Yu(t,c){if(t&1&&S(0,"perun-web-apps-groups-list",11),t&2){let e=p();_("loading",e.loading)("tableId",e.tableId)("groups",e.allowedGroups)("selection",e.selected)("displayedColumns",ge(7,Hu))("noGroupsAlert","VO_DETAIL.SETTINGS.HIERARCHICAL_INCLUSION.NO_GROUPS_ALLOWED_ALERT")("cacheSubject",e.cacheSubject)}}var ws=(()=>{class t{constructor(e,i,n,l,E,x,w){this.dialog=e,this.entityStorage=i,this.voService=n,this.groupService=l,this.notificator=E,this.translate=x,this.authResolver=w,this.loading=!1,this.parentVos=[],this.addAuth=!1,this.deleteAuth=!1,this.allowedGroups=[],this.selected=new K(!0,[],!0,(U,_e)=>U.id===_e.id),this.tableId=ba,this.cacheSubject=new me(!0)}ngOnInit(){this.loading=!0,this.vo=this.entityStorage.getEntity(),this.voService.getEnrichedVoById(this.vo.id).subscribe(e=>{this.parentVos=e.parentVos,this.loading=!1},()=>this.loading=!1),this.selected.changed.subscribe(()=>{this.deleteAuth=this.deleteAuth&&this.selected.selected.filter(e=>this.authResolver.isAuthorized("group-disallowGroupToHierarchicalVo_Group_Vo_policy",[e])).length===this.selected.selected.length})}voSelected(e){this.selectedParentVo=e,this.addAuth=this.authResolver.isAuthorized("vo-allowGroupToHierarchicalVo_Group_Vo_policy",[e]),this.deleteAuth=this.authResolver.isAuthorized("vo-disallowGroupToHierarchicalVo_Group_Vo_policy",[e]),this.loadAllowedGroups()}loadAllowedGroups(){this.loading=!0,this.cacheSubject.next(!0),this.selected.clear(),this.groupService.getVoAllAllowedGroupsToHierarchicalVo(this.selectedParentVo.id,this.vo.id).subscribe(e=>{this.allowedGroups=e,this.loading=!1})}addGroupsInclusion(){let e=G();e.width="750px",e.data={theme:"vo-theme",voId:this.vo.id,parentVo:this.selectedParentVo,allowedGroupsIds:this.allowedGroups.map(i=>i.id)},this.dialog.open(Ns,e).afterClosed().subscribe(i=>{i&&this.loadAllowedGroups()})}removeGroupsInclusion(){let e=G();e.width="750px",e.data={theme:"vo-theme",title:"DIALOGS.REMOVE_GROUPS_HIERARCHICAL_INCLUSION.TITLE",description:"DIALOGS.REMOVE_GROUPS_HIERARCHICAL_INCLUSION.DESCRIPTION",items:this.selected.selected.map(i=>i.name),alert:this.translate.instant("DIALOGS.REMOVE_GROUPS_HIERARCHICAL_INCLUSION.ALERT",{parentVo:this.selectedParentVo.name}),type:"remove",showAsk:!0},this.dialog.open(Ut,e).afterClosed().subscribe(i=>{i&&this.disallowGroups()})}disallowGroups(){this.loading=!0;let e=this.selected.selected.map(i=>i.id);this.groupService.disallowGroupsToHierarchicalVo(e,this.selectedParentVo.id).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.REMOVE_GROUPS_HIERARCHICAL_INCLUSION.SUCCESS")),this.loadAllowedGroups()},error:()=>this.loading=!1})}static{this.\u0275fac=function(i){return new(i||t)(u(q),u(F),u(de),u(we),u(j),u(mt),u(k))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-settings-hierarchical-inclusion"]],decls:17,vars:14,consts:[["spinner",""],[1,"page-subtitle"],[1,"display-flex"],[3,"click"],["mat-flat-button","","color","accent",1,"me-2","action-button",3,"click","disabled"],["mat-flat-button","","color","warn",1,"me-2",3,"click","disabled"],[1,"vo-search-select"],[3,"vos","disableAutoSelect"],[1,"position-relative","table-min-height"],["theme","vo-theme",3,"loading","tableId","groups","selection","displayedColumns","noGroupsAlert","cacheSubject",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"voSelected","vos","disableAutoSelect"],["theme","vo-theme",3,"loading","tableId","groups","selection","displayedColumns","noGroupsAlert","cacheSubject"]],template:function(i,n){if(i&1){let l=T();a(0,"h1",1),s(1),d(2,"translate"),r(),a(3,"div",2)(4,"perun-web-apps-refresh-button",3),C("click",function(){return f(l),h(n.loadAllowedGroups())}),r(),a(5,"button",4),C("click",function(){return f(l),h(n.addGroupsInclusion())}),s(6),d(7,"translate"),r(),a(8,"button",5),C("click",function(){return f(l),h(n.removeGroupsInclusion())}),s(9),d(10,"translate"),r(),a(11,"div",6),v(12,zu,1,2,"perun-web-apps-vo-search-select",7),r()(),A(13,$u,1,0,"ng-template",null,0,L),a(15,"div",8),A(16,Yu,1,8,"perun-web-apps-groups-list",9),r()}if(i&2){let l=y(14);o(),b(m(2,8,"VO_DETAIL.SETTINGS.HIERARCHICAL_INCLUSION.TITLE")),o(4),_("disabled",n.loading||!n.selectedParentVo||!n.addAuth),o(),g(" ",m(7,10,"VO_DETAIL.SETTINGS.HIERARCHICAL_INCLUSION.ADD")," "),o(2),_("disabled",n.loading||n.selected.selected.length===0||!n.deleteAuth),o(),g(" ",m(10,12,"VO_DETAIL.SETTINGS.HIERARCHICAL_INCLUSION.REMOVE")," "),o(3),I(n.parentVos.length>0?12:-1),o(4),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,xe,O,jt,In,P,Q,R],styles:[".display-flex[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap}.vo-search-select[_ngcontent-%COMP%]{width:400px;padding-top:10px;margin-left:5px}"]})}}return t})();function Xu(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function qu(t,c){if(t&1){let e=T();a(0,"perun-web-apps-members-list",5),d(1,"async"),d(2,"async"),C("queryChanged",function(n){f(e);let l=p();return h(l.nextPage.next(n))})("downloadAll",function(n){f(e);let l=p();return h(l.downloadAll(n))}),r()}if(t&2){let e=p();_("loading",m(1,7,e.loading$))("displayedColumns",e.displayedColumns)("disableRouting",!0)("members",m(2,9,e.membersPage$))("selection",e.selection)("filter",e.filter)("tableId",e.tableId)}}var Ls=(()=>{class t{constructor(e,i,n,l,E,x,w,U,_e){this.data=e,this.dialogRef=i,this.store=n,this.voService=l,this.notificator=E,this.membersService=x,this.membersListService=w,this.dialog=U,this.cd=_e,this.selection=new K(!1,[],!0,(tt,Ht)=>tt.id===Ht.id),this.loading=!1,this.attrNames=[Re.MEMBER_DEF_MAIL,Re.USER_DEF_PREFERRED_MAIL].concat(this.store.getLoginAttributeNames()),this.displayedColumns=["checkbox","id","fullName","email","logins"],this.tableId=xa,this.filter="",this.nextPage=new me({}),this.loadingSubject$=new me(!1),this.loading$=_i(this.loadingSubject$,this.nextPage.pipe(ft(()=>!0)))}ngOnInit(){this.voId=this.data.entityId,this.membersPage$=this.membersListService.nextPageHandler(this.nextPage,this.membersService,this.voId,this.attrNames,null,null,null,this.selection,this.loadingSubject$),this.selection.changed.subscribe(e=>{this.ban=this.data.bans.find(i=>i.memberId===e.source.selected[0]?.id)})}cancel(){this.dialogRef.close(!1)}submitBan(e){this.ban?this.updateBan(e):this.banMember(e)}setFilter(e){this.filter=e,this.nextPage.next(this.nextPage.value)}downloadAll(e){let i=this.nextPage.getValue(),n=G();n.width="500px";let l=this.dialog.open(pa,n),E=this.membersService.getMembersPage({vo:this.voId,attrNames:this.attrNames,query:{order:i.order,pageSize:e.length,offset:0,sortColumn:this.membersListService.getSortColumn(i.sortColumn),searchString:i.searchString}}).subscribe({next:x=>{l.close(),un(Ni(x.data,this.displayedColumns,e.getDataForColumnFun),e.format)},error:x=>{this.notificator.showRPCError(x),l.close()}});l.afterClosed().subscribe(()=>{E&&E.unsubscribe()})}banMember(e){this.loading=!0,this.voService.setVoBan({banOnVo:{memberId:this.selection.selected[0].id,description:e.description,validityTo:e.validity,id:0,beanName:"BanOnVo"}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.ADD_BAN.SUCCESS_MEMBER"),this.dialogRef.close(!0)},error:()=>this.loading=!1})}updateBan(e){this.loading=!0,this.voService.updateVoBan({banOnVo:{id:this.ban.id,beanName:"BanOnVo",voId:this.ban.voId,memberId:this.ban.memberId,description:e.description,validityTo:e.validity}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.UPDATE_BAN.SUCCESS"),this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}static{this.\u0275fac=function(i){return new(i||t)(u(ee),u(J),u(Xe),u(de),u(j),u(Ye),u(qo),u(q),u(ht))}}static{this.\u0275cmp=M({type:t,selectors:[["app-add-vo-ban-dialog"]],decls:8,vars:11,consts:[["spinner",""],[3,"add","cancelled","loading","disabled","theme","ban"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","displayedColumns","disableRouting","members","selection","filter","tableId","queryChanged","downloadAll",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"queryChanged","downloadAll","loading","displayedColumns","disableRouting","members","selection","filter","tableId"]],template:function(i,n){if(i&1){let l=T();a(0,"app-add-ban-dialog",1),d(1,"async"),C("add",function(x){return f(l),h(n.submitBan(x))})("cancelled",function(){return f(l),h(n.cancel())}),a(2,"perun-web-apps-debounce-filter",2),C("filter",function(x){return f(l),h(n.setFilter(x))}),r(),A(3,Xu,1,0,"ng-template",null,0,L),a(5,"div",3),A(6,qu,3,11,"perun-web-apps-members-list",4),d(7,"async"),r()()}if(i&2){let l=y(4);_("loading",n.loading)("disabled",m(1,7,n.loading$)||n.selection.selected.length===0)("theme",n.data.theme)("ban",n.ban),o(2),_("placeholder","DIALOGS.ADD_BAN.FILTER"),o(4),_("perunWebAppsLoader",m(7,9,n.loading$))("perunWebAppsLoaderIndicator",l)}},dependencies:[D,Te,Mr,Li,Q,P,Zt],encapsulation:2})}}return t})();function Zu(t,c){if(t&1){let e=T();a(0,"button",8),C("click",function(){f(e);let n=p();return h(n.add())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.SETTINGS.BANS.ADD")," "))}function Qu(t,c){if(t&1){let e=T();a(0,"button",9),C("click",function(){f(e);let n=p();return h(n.remove())}),s(1),d(2,"translate"),r()}if(t&2){let e=p();_("disabled",e.loading||e.selection.selected.length===0),o(),g(" ",m(2,2,"VO_DETAIL.SETTINGS.BANS.REMOVE")," ")}}function Ju(t,c){if(t&1){let e=T();a(0,"perun-web-apps-ban-on-entity-list",10),C("updateBan",function(n){f(e);let l=p();return h(l.update(n))}),r()}if(t&2){let e=p();_("loading",e.loading)("bans",e.bans)("selection",e.selection)("cachedSubject",e.cachedSubject)("updatePolicy","updateBan_BanOnVo_policy")("displayedColumns",e.displayedColumns)("filter",e.filter)}}function e_(t,c){t&1&&S(0,"perun-web-apps-loading-table")}var Vs=(()=>{class t{constructor(e,i,n,l,E,x){this.voService=e,this.entityService=i,this.authResolver=n,this.dialog=l,this.notificator=E,this.userName=x,this.loading=!1,this.bans=[],this.removeAuth=!1,this.filter="",this.selection=new K(!1,[],!0,(w,U)=>w.ban.id===U.ban.id),this.cachedSubject=new me(!0),this.displayedColumns=["select","banId","subjectId","subjectName","description","expiration","edit"]}ngOnInit(){this.loading=!0,this.vo=this.entityService.getEntity(),this.addAuth=this.authResolver.isAuthorized("setBan_BanOnVo_policy",[this.vo]),this.removeAuth=this.authResolver.isAuthorized("vo-removeBan_int_policy",[this.vo]),this.refresh()}refresh(){this.loading=!0,this.voService.getEnrichedBansForVo(this.vo.id).subscribe({next:e=>{this.bans=e,this.selection.clear(),this.cachedSubject.next(!0),this.loading=!1},error:()=>this.loading=!1})}add(){let e=G();e.width="850px",e.data={entityId:this.vo.id,theme:"vo-theme",bans:this.bans.map(n=>n.ban)},this.dialog.open(Ls,e).afterClosed().subscribe(n=>{n&&this.refresh()})}remove(){let e=G();e.width="550px",e.data={theme:"vo-theme",title:"DIALOGS.REMOVE_BAN.TITLE",description:"DIALOGS.REMOVE_BAN.DESCRIPTION",items:[this.userName.transform(this.selection.selected[0].member.user)],type:"remove",showAsk:!0},this.dialog.open(Ut,e).afterClosed().subscribe(n=>{n&&this.voService.removeVoBan(this.selection.selected[0].ban.id).subscribe(()=>{this.notificator.showSuccess("DIALOGS.REMOVE_BAN.SUCCESS"),this.refresh()})})}update(e){let i=G();i.width="600px",i.data={ban:e.ban,theme:"vo-theme"},this.dialog.open(xn,i).afterClosed().subscribe(l=>{l&&this.refresh()})}applyFilter(e){this.filter=e,this.refresh()}static{this.\u0275fac=function(i){return new(i||t)(u(de),u(F),u(k),u(q),u(j),u(kt))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-settings-bans"]],features:[fi([kt])],decls:11,vars:8,consts:[["spinner",""],[1,"page-subtitle"],[3,"click"],["color","accent","mat-flat-button","",1,"me-2","action-button"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[1,"mt-2","search-field",3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","bans","selection","cachedSubject","updatePolicy","displayedColumns","filter","updateBan",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"updateBan","loading","bans","selection","cachedSubject","updatePolicy","displayedColumns","filter"]],template:function(i,n){if(i&1){let l=T();a(0,"h1",1),s(1),d(2,"translate"),r(),a(3,"perun-web-apps-refresh-button",2),C("click",function(){return f(l),h(n.refresh())}),r(),v(4,Zu,3,3,"button",3),v(5,Qu,3,4,"button",4),a(6,"perun-web-apps-debounce-filter",5),C("filter",function(x){return f(l),h(n.applyFilter(x))}),r(),a(7,"div",6),A(8,Ju,1,7,"perun-web-apps-ban-on-entity-list",7),r(),A(9,e_,1,0,"ng-template",null,0,L)}if(i&2){let l=y(10);o(),g(" ",m(2,6,"VO_DETAIL.SETTINGS.BANS.TITLE"),`
`),o(3),I(n.addAuth?4:-1),o(),I(n.removeAuth?5:-1),o(),_("placeholder","VO_DETAIL.SETTINGS.BANS.FILTER"),o(2),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,Te,xe,O,Cn,P,Q,R],encapsulation:2})}}return t})();function t_(t,c){if(t&1){let e=T();a(0,"perun-web-apps-ban-on-entity-list",5),C("updateBan",function(n){f(e);let l=p();return h(l.update(n))}),r()}if(t&2){let e=p();_("loading",e.loading)("bans",e.bans)("updatePolicy","updateBan_BanOnVo_policy")("displayedColumns",e.displayedColumns)}}function i_(t,c){t&1&&S(0,"perun-web-apps-loading-table")}var Ps=(()=>{class t{constructor(e,i,n){this.voService=e,this.entityService=i,this.dialog=n,this.loading=!1,this.bans=[],this.filter="",this.displayedColumns=["banId","description","expiration","edit"]}ngOnInit(){this.loading=!0,this.member=this.entityService.getEntity(),this.refresh()}refresh(){this.loading=!0,this.voService.getVoBanForMember(this.member.id).subscribe({next:e=>{e&&(this.bans=[{ban:e,member:this.member,vo:{id:this.member.voId,beanName:"Vo"}}]),this.loading=!1},error:()=>this.loading=!1})}update(e){let i=G();i.width="600px",i.data={ban:e.ban,theme:"vo-theme"},this.dialog.open(xn,i).afterClosed().subscribe(l=>{l&&this.refresh()})}static{this.\u0275fac=function(i){return new(i||t)(u(de),u(F),u(q))}}static{this.\u0275cmp=M({type:t,selectors:[["app-member-bans"]],decls:8,vars:5,consts:[["spinner",""],[1,"page-subtitle"],[3,"click"],[1,"position-relative","table-min-height"],[3,"loading","bans","updatePolicy","displayedColumns","updateBan",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"updateBan","loading","bans","updatePolicy","displayedColumns"]],template:function(i,n){if(i&1){let l=T();a(0,"h1",1),s(1),d(2,"translate"),r(),a(3,"perun-web-apps-refresh-button",2),C("click",function(){return f(l),h(n.refresh())}),r(),a(4,"div",3),A(5,t_,1,4,"perun-web-apps-ban-on-entity-list",4),r(),A(6,i_,1,0,"ng-template",null,0,L)}if(i&2){let l=y(7);o(),g(" ",m(2,3,"MEMBER_DETAIL.BANS.TITLE"),`
`),o(4),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,xe,O,Cn,P,Q,R],encapsulation:2})}}return t})();var n_=()=>["select","id","name","description"];function o_(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function a_(t,c){if(t&1){let e=T();a(0,"div")(1,"h1",2),s(2),d(3,"translate"),r(),a(4,"div",3)(5,"perun-web-apps-debounce-filter",4),d(6,"translate"),C("filter",function(n){f(e);let l=p();return h(l.applyFilter(n))}),r(),S(7,"perun-web-apps-groups-list",5),r(),a(8,"div",6)(9,"button",7),C("click",function(){f(e);let n=p();return h(n.onCancel())}),s(10),d(11,"translate"),r(),a(12,"button",8),C("click",function(){f(e);let n=p();return h(n.addEvent.emit())}),s(13),d(14,"translate"),r()()()}if(t&2){let e=p();o(2),b(m(3,14,"DIALOGS.ADD_GROUP_TO_REGISTRATION.TITLE")),o(3),_("placeholder",Y(m(6,16,"DIALOGS.ADD_GROUP_TO_REGISTRATION.FILTER_DESCRIPTION"))),o(2),_("loading",e.loading)("disableMembers",!0)("groups",e.unAssignedGroups)("selection",e.selection)("disableRouting",!0)("displayedColumns",ge(22,n_))("filter",e.filterValue)("tableId",e.tableId),o(3),g(" ",m(11,18,"DIALOGS.ADD_GROUP_TO_REGISTRATION.CANCEL_BUTTON")," "),o(2),_("disabled",e.selection.selected.length===0||e.loading),o(),g(" ",m(14,20,"DIALOGS.ADD_GROUP_TO_REGISTRATION.ADD_BUTTON")," ")}}var Fn=(()=>{class t{constructor(){this.loading=!1,this.addEvent=new _t,this.filterValue="",this.tableId=Ea}applyFilter(e){this.filterValue=e}onCancel(){this.dialogRef.close(!1)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=M({type:t,selectors:[["app-add-group-to-registration"]],inputs:{loading:"loading",theme:"theme",dialogRef:"dialogRef",unAssignedGroups:"unAssignedGroups",selection:"selection"},outputs:{addEvent:"addEvent"},decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],[3,"filter","placeholder"],[3,"loading","disableMembers","groups","selection","disableRouting","displayedColumns","filter","tableId"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(i,n){if(i&1&&(A(0,o_,1,0,"ng-template",null,0,L),a(2,"div"),A(3,a_,15,23,"div",1),r()),i&2){let l=y(1);o(2),ce(pe("",n.theme," position-relative")),o(),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,oe,te,ne,ie,ue,Te,O,P,jt,R],encapsulation:2})}}return t})();var Gs=(()=>{class t{constructor(e,i,n,l){this.dialogRef=e,this.data=i,this.groupService=n,this.registrarService=l,this.loading=!1,this.unAssignedGroups=[],this.selection=new K(!0,[],!0,(E,x)=>E.id===x.id)}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.groupService.getAllGroups(this.data.voId).subscribe({next:e=>{this.unAssignedGroups=e.filter(i=>!this.data.assignedGroups.includes(i.id)),this.loading=!1},error:()=>this.loading=!1})}onAdd(){this.loading=!0,this.registrarService.addVoGroupsToAutoRegistration(this.selection.selected.map(e=>e.id),this.data.embeddedFormItemId).subscribe({next:()=>{this.dialogRef.close(!0)},error:()=>this.loading=!1})}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(we),u(Ie))}}static{this.\u0275cmp=M({type:t,selectors:[["app-add-group-to-vo-registration"]],decls:1,vars:5,consts:[[3,"addEvent","loading","theme","dialogRef","unAssignedGroups","selection"]],template:function(i,n){i&1&&(a(0,"app-add-group-to-registration",0),C("addEvent",function(){return n.onAdd()}),r()),i&2&&_("loading",n.loading)("theme",n.theme)("dialogRef",n.dialogRef)("unAssignedGroups",n.unAssignedGroups)("selection",n.selection)},dependencies:[D,Fn],encapsulation:2})}}return t})();var r_=t=>({removeAuth:t}),s_=()=>["select","id","name","description"];function l_(t,c){if(t&1){let e=T();a(0,"span",4),d(1,"translate"),a(2,"button",8),C("click",function(){f(e);let n=p();return h(n.removeGroups())}),s(3),d(4,"translate"),r()()}if(t&2){let e=c,i=p();_("matTooltip",Y(m(1,5,"VO_DETAIL.SETTINGS.APPLICATION_FORM.MANAGE_GROUPS_PAGE.REMOVE_PERMISSION_HINT")))("matTooltipDisabled",i.loading||i.selected.selected.length===0||e.removeAuth),o(2),_("disabled",i.loading||i.selected.selected.length===0||!e.removeAuth||!i.manageEmbeddedGroupsItemSaved),o(),g(" ",m(4,7,"VO_DETAIL.SETTINGS.APPLICATION_FORM.MANAGE_GROUPS_PAGE.REMOVE")," ")}}function p_(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function c_(t,c){if(t&1&&S(0,"perun-web-apps-groups-list",11),t&2){let e=p(2);_("loading",e.loading)("displayedColumns",ge(7,s_))("disableRouting",!0)("groups",e.groups)("filter",e.filterValue)("selection",e.selected)("tableId",e.tableId)}}function d_(t,c){if(t&1&&(a(0,"div"),A(1,p_,1,0,"ng-template",null,0,L),a(3,"div",9),A(4,c_,1,8,"perun-web-apps-groups-list",10),r()()),t&2){let e=y(2),i=p();o(4),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",e)}}function m_(t,c){t&1&&(a(0,"perun-web-apps-alert",7),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"VO_DETAIL.SETTINGS.APPLICATION_FORM.MANAGE_GROUPS_PAGE.NO_EMBEDDED_GROUPS")," "))}var kn=(()=>{class t{constructor(e){this.dialog=e,this.groups=[],this.selected=new K(!0,[]),this.manageEmbeddedGroupsItemSaved=!0,this.refreshEvent=new _t,this.addEvent=new _t,this.removeEvent=new _t,this.tableId=Sa,this.filterValue=""}removeGroups(){let e=G();e.width="450px",e.data={items:this.selected.selected.map(n=>n.name),title:"VO_DETAIL.SETTINGS.APPLICATION_FORM.MANAGE_GROUPS_PAGE.REMOVE_GROUP_DIALOG_TITLE",description:"VO_DETAIL.SETTINGS.APPLICATION_FORM.MANAGE_GROUPS_PAGE.REMOVE_GROUP_DIALOG_DESCRIPTION",theme:"vo-theme",type:"remove",showAsk:!0},this.dialog.open(Ut,e).afterClosed().subscribe(n=>{n&&this.removeEvent.emit()})}static{this.\u0275fac=function(i){return new(i||t)(u(q))}}static{this.\u0275cmp=M({type:t,selectors:[["app-application-form-manage-groups"]],inputs:{loading:"loading",groups:"groups",selected:"selected",addAuth:"addAuth",removeAuth$:"removeAuth$",manageEmbeddedGroupsItemSaved:"manageEmbeddedGroupsItemSaved"},outputs:{refreshEvent:"refreshEvent",addEvent:"addEvent",removeEvent:"removeEvent"},decls:18,vars:27,consts:[["spinner",""],[1,"page-subtitle"],["alert_type","info"],[3,"refresh","disabled"],[3,"matTooltipDisabled","matTooltip"],["color","accent","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"filter","placeholder"],["alert_type","error"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[1,"position-relative","table-min-height"],["theme","vo-theme",3,"loading","displayedColumns","disableRouting","groups","filter","selection","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["theme","vo-theme",3,"loading","displayedColumns","disableRouting","groups","filter","selection","tableId"]],template:function(i,n){if(i&1&&(a(0,"h1",1),s(1),d(2,"translate"),d(3,"translate"),r(),a(4,"perun-web-apps-alert",2),s(5),d(6,"translate"),r(),a(7,"perun-web-apps-refresh-button",3),C("refresh",function(){return n.refreshEvent.emit()}),r(),a(8,"span",4),d(9,"translate"),a(10,"button",5),C("click",function(){return n.addEvent.emit()}),s(11),d(12,"translate"),r()(),v(13,l_,5,9,"span",4),d(14,"async"),a(15,"perun-web-apps-debounce-filter",6),C("filter",function(E){return n.filterValue=E}),r(),v(16,d_,5,2,"div"),v(17,m_,3,3,"perun-web-apps-alert",7)),i&2){let l;o(),be(" ",m(2,13,"VO_DETAIL.SETTINGS.APPLICATION_FORM.TITLE")," - ",m(3,15,"VO_DETAIL.SETTINGS.APPLICATION_FORM.MANAGE_GROUPS_PAGE.TITLE"),`
`),o(4),g(" ",m(6,17,"VO_DETAIL.SETTINGS.APPLICATION_FORM.MANAGE_GROUPS_PAGE.HELP"),`
`),o(2),_("disabled",!n.manageEmbeddedGroupsItemSaved),o(),_("matTooltip",Y(m(9,19,"VO_DETAIL.SETTINGS.APPLICATION_FORM.MANAGE_GROUPS_PAGE.ADD_PERMISSION_HINT")))("matTooltipDisabled",n.addAuth||!n.manageEmbeddedGroupsItemSaved),o(2),_("disabled",!n.addAuth||!n.manageEmbeddedGroupsItemSaved),o(),g(" ",m(12,21,"VO_DETAIL.SETTINGS.APPLICATION_FORM.MANAGE_GROUPS_PAGE.ADD")," "),o(2),I((l=Ee(25,r_,m(14,23,n.removeAuth$)))?13:-1,l),o(2),_("placeholder","VO_DETAIL.SETTINGS.APPLICATION_FORM.MANAGE_GROUPS_PAGE.FILTER"),o(),I(n.manageEmbeddedGroupsItemSaved?16:-1),o(),I(!n.manageEmbeddedGroupsItemSaved&&!n.loading?17:-1)}},dependencies:[D,N,V,$e,ze,Te,xe,O,Ae,jt,P,Q,Zt,R],encapsulation:2})}}return t})();var Bs=(()=>{class t{constructor(e,i,n,l,E,x){this.registrarService=e,this.authResolver=i,this.dialog=n,this.route=l,this.entityStorageService=E,this.registrarManager=x,this.groups=[],this.selected=new K(!0,[],!0,(w,U)=>w.id===U.id),this.manageEmbeddedGroupsItemSaved=!1,this.removeAuth$=this.selected.changed.pipe(ft(w=>w.source.selected.reduce((U,_e)=>U&&this.authResolver.isAuthorized("deleteGroupsFromAutoRegistration_List<Group>_ApplicationFormItem_policy",[_e]),!0)),Kt(!0))}ngOnInit(){this.loading=!0,this.vo=this.entityStorageService.getEntity(),this.registrarManager.getFormItemsForVo(this.vo.id).subscribe({next:e=>{let i=e.filter(n=>n.type===an.EMBEDDED_GROUP_APPLICATION);i.length>0&&(this.embeddedFormItemId=i[0].id,this.manageEmbeddedGroupsItemSaved=!0,this.loadGroups()),this.loading=!1},error:()=>this.loading=!1})}loadGroups(){this.loading=!0,this.registrarService.getVoGroupsToAutoRegistration(this.vo.id,this.embeddedFormItemId).subscribe({next:e=>{this.groups=e,this.addAuth=this.authResolver.isAuthorized("addGroupsToAutoRegistration_List<Group>_ApplicationFormItem_policy",[this.vo]),this.selected.clear(),this.loading=!1},error:()=>this.loading=!1})}onAddGroup(){let e=G();e.width="900px",e.data={voId:this.vo.id,assignedGroups:this.groups.map(n=>n.id),embeddedFormItemId:this.embeddedFormItemId,theme:"vo-theme"},this.dialog.open(Gs,e).afterClosed().subscribe(n=>{n&&this.loadGroups()})}removeGroup(){this.loading=!0,this.registrarService.deleteVoGroupsFromAutoRegistration(this.selected.selected.map(e=>e.id),this.embeddedFormItemId).subscribe({next:()=>{this.loadGroups()},error:()=>this.loading=!1})}static{this.\u0275fac=function(i){return new(i||t)(u(Ie),u(k),u(q),u(ve),u(F),u(Ie))}}static{this.\u0275cmp=M({type:t,selectors:[["app-vo-settings-manage-embedded-groups"]],decls:1,vars:6,consts:[[3,"refreshEvent","addEvent","removeEvent","loading","groups","selected","addAuth","manageEmbeddedGroupsItemSaved","removeAuth$"]],template:function(i,n){i&1&&(a(0,"app-application-form-manage-groups",0),C("refreshEvent",function(){return n.loadGroups()})("addEvent",function(){return n.onAddGroup()})("removeEvent",function(){return n.removeGroup()}),r()),i&2&&_("loading",n.loading)("groups",n.groups)("selected",n.selected)("addAuth",n.addAuth)("manageEmbeddedGroupsItemSaved",n.manageEmbeddedGroupsItemSaved)("removeAuth$",n.removeAuth$)},dependencies:[D,kn],encapsulation:2})}}return t})();var Fs=(()=>{class t{constructor(e,i,n,l){this.dialogRef=e,this.data=i,this.groupService=n,this.registrarService=l,this.loading=!1,this.unAssignedGroups=[],this.selection=new K(!0,[],!0,(E,x)=>E.id===x.id)}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.groupService.getAllSubGroups(this.data.groupId).subscribe({next:e=>{this.unAssignedGroups=e.filter(i=>!this.data.assignedGroups.includes(i.id)),this.loading=!1},error:()=>this.loading=!1})}onAdd(){this.loading=!0,this.registrarService.addSubgroupsToAutoRegistration(this.selection.selected.map(e=>e.id),this.data.groupId,this.data.embeddedFormItemId).subscribe({next:()=>{this.dialogRef.close(!0)},error:()=>this.loading=!1})}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(we),u(Ie))}}static{this.\u0275cmp=M({type:t,selectors:[["app-add-group-to-group-registration"]],decls:1,vars:5,consts:[[3,"addEvent","loading","theme","dialogRef","unAssignedGroups","selection"]],template:function(i,n){i&1&&(a(0,"app-add-group-to-registration",0),C("addEvent",function(){return n.onAdd()}),r()),i&2&&_("loading",n.loading)("theme",n.theme)("dialogRef",n.dialogRef)("unAssignedGroups",n.unAssignedGroups)("selection",n.selection)},dependencies:[D,Fn],encapsulation:2})}}return t})();var ks=(()=>{class t{constructor(e,i,n,l,E,x){this.registrarService=e,this.authResolver=i,this.dialog=n,this.route=l,this.entityStorageService=E,this.registrarManager=x,this.groups=[],this.selected=new K(!0,[],!0,(w,U)=>w.id===U.id),this.manageEmbeddedGroupsItemSaved=!1,this.removeAuth$=this.selected.changed.pipe(ft(w=>w.source.selected.reduce((U,_e)=>U&&this.authResolver.isAuthorized("deleteGroupsFromAutoRegistration_List<Group>_Group_ApplicationFormItem_policy",[this.registrationGroup,_e]),!0)),Kt(!0))}ngOnInit(){this.loading=!0,this.registrationGroup=this.entityStorageService.getEntity(),this.registrarManager.getFormItemsForGroup(this.registrationGroup.id).subscribe({next:e=>{let i=e.filter(n=>n.type===an.EMBEDDED_GROUP_APPLICATION);i.length>0&&(this.embeddedFormItemId=i[0].id,this.manageEmbeddedGroupsItemSaved=!0,this.loadGroups()),this.loading=!1},error:()=>this.loading=!1})}loadGroups(){this.loading=!0,this.registrarService.getSubgroupsToAutoRegistration(this.registrationGroup.id,this.embeddedFormItemId).subscribe({next:e=>{this.groups=e,this.addAuth=this.authResolver.isAuthorized("addGroupsToAutoRegistration_List<Group>_Group_ApplicationFormItem_policy",[this.registrationGroup]),this.selected.clear(),this.loading=!1},error:()=>this.loading=!1})}onAddGroup(){let e=G();e.width="900px",e.data={groupId:this.registrationGroup.id,assignedGroups:this.groups.map(n=>n.id),embeddedFormItemId:this.embeddedFormItemId,theme:"group-theme"},this.dialog.open(Fs,e).afterClosed().subscribe(n=>{n&&this.loadGroups()})}removeGroup(){this.loading=!0,this.registrarService.deleteSubgroupsFromAutoRegistration(this.selected.selected.map(e=>e.id),this.registrationGroup.id,this.embeddedFormItemId).subscribe({next:()=>{this.loadGroups()},error:()=>this.loading=!1})}static{this.\u0275fac=function(i){return new(i||t)(u(Ie),u(k),u(q),u(ve),u(F),u(Ie))}}static{this.\u0275cmp=M({type:t,selectors:[["app-group-settings-manage-embedded-groups"]],decls:1,vars:6,consts:[[3,"refreshEvent","addEvent","removeEvent","loading","groups","selected","addAuth","removeAuth$","manageEmbeddedGroupsItemSaved"]],template:function(i,n){i&1&&(a(0,"app-application-form-manage-groups",0),C("refreshEvent",function(){return n.loadGroups()})("addEvent",function(){return n.onAddGroup()})("removeEvent",function(){return n.removeGroup()}),r()),i&2&&_("loading",n.loading)("groups",n.groups)("selected",n.selected)("addAuth",n.addAuth)("removeAuth$",n.removeAuth$)("manageEmbeddedGroupsItemSaved",n.manageEmbeddedGroupsItemSaved)},dependencies:[D,kn],encapsulation:2})}}return t})();var u_=["class","component"],__=t=>({receiverEmail:t});function g_(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function f_(t,c){if(t&1){let e=T();a(0,"div")(1,"h1",3),s(2),d(3,"translate"),r(),a(4,"div",4),s(5),d(6,"translate"),r(),a(7,"mat-form-field",5),C("click",function(){f(e);let n=y(11);return h(n.open())}),S(8,"input",6)(9,"mat-datepicker-toggle",7)(10,"mat-datepicker",8,1),r(),a(12,"div",9)(13,"button",10),C("click",function(){f(e);let n=p();return h(n.onCancel())}),s(14),d(15,"translate"),r(),a(16,"button",11),C("click",function(){f(e);let n=p();return h(n.onSubmit())}),s(17),d(18,"translate"),r()()()}if(t&2){let e=y(11),i=p();o(2),b(m(3,12,"DIALOGS.EXTEND_INVITATION_EXPIRATION_DATE.TITLE")),o(3),g(" ",it(6,14,"DIALOGS.EXTEND_INVITATION_EXPIRATION_DATE.TEXT",Ee(21,__,i.data.invitation.receiverEmail))," "),o(3),_("formControl",i.dateForm)("min",i.minDate)("max",i.maxDate)("matDatepicker",e),o(),_("disabled",!1)("for",e),o(),_("disabled",!1),o(4),g(" ",m(15,17,"DIALOGS.EXTEND_INVITATION_EXPIRATION_DATE.CANCEL")," "),o(2),_("disabled",i.loading),o(),g(" ",m(18,19,"DIALOGS.EXTEND_INVITATION_EXPIRATION_DATE.SUBMIT")," ")}}var Un=(()=>{class t{constructor(e,i,n,l,E){this.dialogRef=e,this.data=i,this.translate=n,this.notificator=l,this.invitationManager=E,this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.minDate=new Date(this.data.invitation.expiration),this.maxDate=new Date,this.maxDate.setFullYear(this.maxDate.getFullYear()+1),this.defaultDate=new Date(this.minDate),this.defaultDate.setMonth(this.defaultDate.getMonth()+1),this.minDate.setDate(this.minDate.getDate()+1),this.dateForm=new ct(this.defaultDate.toISOString().substring(0,10),[dt.required])}onCancel(){this.dialogRef.close()}onSubmit(){if(this.dateForm.invalid)return;let e=new Date(this.dateForm.value);this.loading=!0,this.invitationManager.extendInvitationExpiration(this.data.invitation.id,this.expirationDateToString(e)).subscribe({next:()=>{this.translate.get("DIALOGS.EXTEND_INVITATION_EXPIRATION_DATE.SUCCESS").subscribe(i=>{this.notificator.showSuccess(i),this.dialogRef.close(!0)})},error:()=>this.loading=!1})}expirationDateToString(e){return e?Ki(e,"yyyy-MM-dd","en-GB"):null}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(X),u(j),u(St))}}static{this.\u0275cmp=M({type:t,selectors:[["app-invitation-extend-date-dialog",8,"component"]],attrs:u_,decls:4,vars:5,consts:[["spinner",""],["picker",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],["color","primary",1,"cursor-pointer","w-100","px-4",3,"click"],["matInput","","readonly","","required","",1,"disable","cursor-pointer",3,"formControl","min","max","matDatepicker"],["matSuffix","",3,"disabled","for"],[3,"disabled"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(i,n){if(i&1&&(A(0,g_,1,0,"ng-template",null,0,L),a(2,"div"),A(3,f_,19,23,"div",2),r()),i&2){let l=y(1);o(2),ce(pe("",n.theme," position-relative")),o(),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,He,We,Eo,lt,st,Ne,nt,ye,Si,Qt,Lo,yo,No,wo,oe,te,ne,ie,ue,O,P,R],styles:[".cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}"]})}}return t})();var h_=["class","component"],Us=()=>["email","expiration"];function v_(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function I_(t,c){t&1&&(a(0,"th",15),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"INVITATIONS_LIST.RECEIVER_EMAIL")," "))}function C_(t,c){if(t&1&&(a(0,"td",16),s(1),r()),t&2){let e=c.$implicit;o(),g(" ",e.receiverEmail," ")}}function S_(t,c){t&1&&(a(0,"th",15),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"INVITATIONS_LIST.EXPIRATION")," "))}function E_(t,c){if(t&1&&(a(0,"td",16),s(1),r()),t&2){let e=c.$implicit;o(),g(" ",e.expiration," ")}}function T_(t,c){t&1&&S(0,"tr",17)}function b_(t,c){t&1&&S(0,"tr",18)}function A_(t,c){if(t&1){let e=T();a(0,"div")(1,"h1",3),s(2),d(3,"translate"),r(),a(4,"div",4),s(5),d(6,"translate"),a(7,"table",5),fe(8,6),A(9,I_,3,3,"th",7)(10,C_,2,1,"td",8),he(),fe(11,9),A(12,S_,3,3,"th",7)(13,E_,2,1,"td",8),he(),A(14,T_,1,0,"tr",10)(15,b_,1,0,"tr",11),r()(),a(16,"div",12)(17,"button",13),C("click",function(){f(e);let n=p();return h(n.onCancel())}),s(18),d(19,"translate"),r(),a(20,"button",14),C("click",function(){f(e);let n=p();return h(n.onSubmit())}),s(21),d(22,"translate"),r()()()}if(t&2){let e=p();o(2),b(m(3,8,"DIALOGS.REVOKE_INVITATION.TITLE")),o(3),g(" ",m(6,10,"DIALOGS.REVOKE_INVITATION.TEXT")," "),o(2),_("dataSource",e.data.invitations),o(7),_("matHeaderRowDef",ge(16,Us)),o(),_("matRowDefColumns",ge(17,Us)),o(3),g(" ",m(19,12,"DIALOGS.REVOKE_INVITATION.CANCEL")," "),o(2),_("disabled",e.loading),o(),g(" ",m(22,14,"DIALOGS.REVOKE_INVITATION.SUBMIT")," ")}}var jn=(()=>{class t{constructor(e,i,n,l,E){this.dialogRef=e,this.data=i,this.translate=n,this.notificator=l,this.invitationManager=E,this.loading=!1}onCancel(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.invitationManager.revokeInvitationById(this.data.invitations[0]?.id).subscribe({next:()=>{this.translate.get("DIALOGS.REVOKE_INVITATION.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close(!0)})},error:()=>this.loading=!1})}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(X),u(j),u(St))}}static{this.\u0275cmp=M({type:t,selectors:[["app-invitation-revoke-dialog",8,"component"]],attrs:h_,decls:4,vars:2,consts:[["spinner",""],[1,"group-theme","position-relative"],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],["mat-table","",1,"w-100","mt-3","table-margin",3,"dataSource"],["matColumnDef","email"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","expiration"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(i,n){if(i&1&&(A(0,v_,1,0,"ng-template",null,0,L),a(2,"div",1),A(3,A_,23,18,"div",2),r()),i&2){let l=y(1);o(3),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,oe,te,ne,ie,ue,je,Le,Pe,Ke,Ge,Ve,ke,Be,Fe,Ze,Ue,O,P,R],encapsulation:2})}}return t})();var x_=["class","component"],js=()=>["email","expiration"];function M_(t,c){t&1&&S(0,"perun-web-apps-loading-dialog")}function D_(t,c){t&1&&(a(0,"th",15),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"INVITATIONS_LIST.RECEIVER_EMAIL")," "))}function R_(t,c){if(t&1&&(a(0,"td",16),s(1),r()),t&2){let e=c.$implicit;o(),g(" ",e.receiverEmail," ")}}function O_(t,c){t&1&&(a(0,"th",15),s(1),d(2,"translate"),r()),t&2&&(o(),g(" ",m(2,1,"INVITATIONS_LIST.EXPIRATION")," "))}function y_(t,c){if(t&1&&(a(0,"td",16),s(1),r()),t&2){let e=c.$implicit;o(),g(" ",e.expiration," ")}}function N_(t,c){t&1&&S(0,"tr",17)}function w_(t,c){t&1&&S(0,"tr",18)}function L_(t,c){if(t&1){let e=T();a(0,"div")(1,"h1",3),s(2),d(3,"translate"),r(),a(4,"div",4),s(5),d(6,"translate"),a(7,"table",5),fe(8,6),A(9,D_,3,3,"th",7)(10,R_,2,1,"td",8),he(),fe(11,9),A(12,O_,3,3,"th",7)(13,y_,2,1,"td",8),he(),A(14,N_,1,0,"tr",10)(15,w_,1,0,"tr",11),r()(),a(16,"div",12)(17,"button",13),C("click",function(){f(e);let n=p();return h(n.onCancel())}),s(18),d(19,"translate"),r(),a(20,"button",14),C("click",function(){f(e);let n=p();return h(n.onSubmit())}),s(21),d(22,"translate"),r()()()}if(t&2){let e=p();o(2),b(m(3,8,"DIALOGS.RESEND_INVITATION.TITLE")),o(3),g(" ",m(6,10,"DIALOGS.RESEND_INVITATION.TEXT")," "),o(2),_("dataSource",e.data.invitations),o(7),_("matHeaderRowDef",ge(16,js)),o(),_("matRowDefColumns",ge(17,js)),o(3),g(" ",m(19,12,"DIALOGS.RESEND_INVITATION.CANCEL")," "),o(2),_("disabled",e.loading),o(),g(" ",m(22,14,"DIALOGS.RESEND_INVITATION.SUBMIT")," ")}}var Wn=(()=>{class t{constructor(e,i,n,l,E){this.dialogRef=e,this.data=i,this.translate=n,this.notificator=l,this.invitationManager=E,this.loading=!1}onCancel(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.invitationManager.resendInvitation(this.data.invitations[0]?.id).subscribe({next:()=>{this.translate.get("DIALOGS.RESEND_INVITATION.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close()})},error:()=>this.loading=!1})}static{this.\u0275fac=function(i){return new(i||t)(u(J),u(ee),u(X),u(j),u(St))}}static{this.\u0275cmp=M({type:t,selectors:[["app-invitation-resend-dialog",8,"component"]],attrs:x_,decls:4,vars:2,consts:[["spinner",""],[1,"group-theme","position-relative"],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],["mat-table","",1,"w-100","mt-3","table-margin",3,"dataSource"],["matColumnDef","email"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","expiration"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(i,n){if(i&1&&(A(0,M_,1,0,"ng-template",null,0,L),a(2,"div",1),A(3,L_,23,18,"div",2),r()),i&2){let l=y(1);o(3),_("perunWebAppsLoader",n.loading)("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,oe,te,ne,ie,ue,je,Le,Pe,Ke,Ge,Ve,ke,Be,Fe,Ze,Ue,O,P,R],encapsulation:2})}}return t})();function V_(t,c){if(t&1){let e=T();a(0,"button",13),d(1,"async"),d(2,"selectedPendingInvitation"),C("click",function(){f(e);let n=p();return h(n.onInvitationResend())}),s(3),d(4,"translate"),r()}if(t&2){let e=p();_("disabled",m(1,2,e.loading$)||!m(2,4,e.selection)),o(3),g(" ",m(4,6,"GROUP_DETAIL.INVITATIONS.RESEND")," ")}}function P_(t,c){if(t&1){let e=T();a(0,"button",13),d(1,"async"),d(2,"selectedPendingInvitation"),C("click",function(){f(e);let n=p();return h(n.onInvitationExtendDate())}),s(3),d(4,"translate"),r()}if(t&2){let e=p();_("disabled",m(1,2,e.loading$)||!m(2,4,e.selection)),o(3),g(" ",m(4,6,"GROUP_DETAIL.INVITATIONS.EXTEND_EXPIRATION_DATE")," ")}}function G_(t,c){if(t&1){let e=T();a(0,"button",14),d(1,"async"),d(2,"selectedPendingInvitation"),C("click",function(){f(e);let n=p();return h(n.onInvitationRevoke())}),s(3),d(4,"translate"),r()}if(t&2){let e=p();_("disabled",m(1,2,e.loading$)||!m(2,4,e.selection)),o(3),g(" ",m(4,6,"GROUP_DETAIL.INVITATIONS.REVOKE")," ")}}function B_(t,c){if(t&1&&(a(0,"mat-option",9),s(1),r()),t&2){let e=c.$implicit;_("value",e),o(),b(e)}}function F_(t,c){t&1&&S(0,"perun-web-apps-loading-table")}function k_(t,c){if(t&1){let e=T();a(0,"perun-web-apps-invitations-list",15),d(1,"async"),d(2,"async"),C("queryChanged",function(n){f(e);let l=p();return h(l.nextPage.next(n))})("refreshTable",function(){f(e);let n=p();return h(n.refreshTable())})("downloadAll",function(n){f(e);let l=p();return h(l.downloadAll(n))}),r()}if(t&2){let e=p();_("loading",m(1,9,e.loading$))("displayedColumns",e.displayedColumns)("groupId",e.group.id)("invitations",m(2,11,e.invitationsPage$))("selection",e.selection)("cacheSubject",e.cacheSubject)("filter",e.searchString)("tableId",e.tableId)("resetPagination",e.resetPagination)}}var Ws=(()=>{class t{static{this.id="GroupInvitationsComponent"}constructor(e,i,n,l,E,x,w){this.entityStorageService=e,this.destroyRef=i,this.cacheHelperService=n,this.invitationsManager=l,this.authResolver=E,this.dialog=x,this.selectedPendingInvitation=w,this.selection=new K(!1,[],!0,(U,_e)=>U.id===_e.id),this.cacheSubject=new me(!0),this.resetPagination=new me(!1),this.displayedColumns=["checkbox","id","status","expiration","receiverName","receiverEmail","senderName"],this.invitations=[],this.nextPage=new me({}),this.invitationsPage$=this.nextPage.pipe(zt(U=>this.invitationsManager.getInvitationsPage({group:this.group.id,query:{order:U.order,pageSize:U.pageSize,offset:U.offset,sortColumn:this.getSortDataColumnQuery(U.sortColumn),searchString:U.searchString,statuses:this.selectedStatuses,expirationFrom:this.expirationDateToString(this.startDate.value),expirationTo:this.expirationDateToString(this.endDate.value)}})),$i(U=>{this.invitations=U.data,this.selection.clear(),setTimeout(()=>this.loadingSubject$.next(!1),200)}),Kt({data:[],totalCount:0,offset:0,pageSize:0})),this.loadingSubject$=new me(!1),this.loading$=_i(this.loadingSubject$,this.nextPage.pipe(ft(()=>!0))),this.tableId=Ma,this.statuses=new ct([""]),this.statusList=["PENDING","ACCEPTED","EXPIRED","REVOKED","UNSENT"],this.selectedStatuses=["PENDING"],this.searchString="",this.startDate=new ct(null),this.endDate=new ct(null),this.authRights={revoke:!1,extend:!1,resend:!1}}ngOnInit(){this.statuses.setValue(this.selectedStatuses),this.group=this.entityStorageService.getEntity(),this.setAuthRights(),this.startDate.valueChanges.subscribe(()=>this.refreshTable()),this.endDate.valueChanges.subscribe(()=>this.refreshTable()),this.cacheHelperService.refreshComponentCachedData().pipe(gn(this.destroyRef)).subscribe(e=>{e===t.id&&this.refreshTable()})}refreshTable(){this.resetPagination.next(!0),this.cacheSubject.next(!0),this.nextPage.next(this.nextPage.value)}changeInvitationStatus(){this.selectedStatuses=this.statuses.value,this.refreshTable()}displaySelectedStatuses(){if(this.selectedStatuses.length===this.statusList.length)return"ALL";let e=this.statuses.value;return e?`${e[0]}  ${e.length>1?"(+"+(e.length-1).toString()+" "+(e.length===2?"other)":"others)"):""}`:""}onSearchByString(e){this.searchString=e,this.refreshTable()}downloadAll(e){let i=this.nextPage.getValue();this.invitationsManager.getInvitationsPage({group:this.group.id,query:{order:i.order,pageSize:e.length,offset:0,sortColumn:this.getSortDataColumnQuery(i.sortColumn),searchString:i.searchString,statuses:this.selectedStatuses,expirationFrom:this.expirationDateToString(this.startDate.value),expirationTo:this.expirationDateToString(this.endDate.value)}}).subscribe({next:n=>{un(Ni(n.data,this.displayedColumns,e.getDataForColumnFun),e.format)}})}onInvitationRevoke(){let e=G();e.width="500px",e.data={invitations:this.selection.selected},this.dialog.open(jn,e).afterClosed().subscribe(n=>{n&&this.refreshTable()})}onInvitationExtendDate(){let e=G();e.width="500px",e.data={invitation:this.selection.selected[0],theme:"group-theme"},this.dialog.open(Un,e).afterClosed().subscribe(n=>{n&&this.refreshTable()})}onInvitationResend(){let e=G();e.width="500px",e.data={invitations:this.selection.selected},this.dialog.open(Wn,e)}expirationDateToString(e){return e?Ki(e,"yyyy-MM-dd","en-GB"):null}getSortDataColumnQuery(e){if(!e)return $t.ID;switch(e.toUpperCase()){case"ID":return $t.ID;case"STATUS":return $t.STATUS;case"EXPIRATION":return $t.EXPIRATION;case"RECEIVERNAME":return $t.RECEIVER_NAME;case"RECEIVEREMAIL":return $t.RECEIVER_EMAIL;case"SENDERNAME":return $t.SENDER_NAME;default:return $t.ID}}setAuthRights(){this.authRights.revoke=this.authResolver.isAuthorized("revokeInvitationById_int_policy",[this.group]),this.authRights.extend=this.authResolver.isAuthorized("extendInvitationExpiration_Invitation_LocalDate_policy",[this.group]),this.authRights.resend=this.authResolver.isAuthorized("resendInvitation_Invitation_policy",[this.group])}static{this.\u0275fac=function(i){return new(i||t)(u(F),u(Yi),u(Wa),u(St),u(k),u(q),u(di))}}static{this.\u0275cmp=M({type:t,selectors:[["app-group-invitations"]],features:[fi([di])],decls:35,vars:43,consts:[["spinner",""],[1,"page-subtitle"],[1,"align-elements"],[1,"me-2",3,"click"],[3,"matTooltipDisabled","matTooltip"],["color","accent","mat-flat-button","",1,"me-2",3,"disabled"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[1,"me-2","fix-select"],["multiple","",3,"closed","formControl"],[1,"group-theme",3,"value"],[1,"mt-2","me-2","search-field",3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","displayedColumns","groupId","invitations","selection","cacheSubject","filter","tableId","resetPagination","queryChanged","refreshTable","downloadAll",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2",3,"click","disabled"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"queryChanged","refreshTable","downloadAll","loading","displayedColumns","groupId","invitations","selection","cacheSubject","filter","tableId","resetPagination"]],template:function(i,n){if(i&1){let l=T();a(0,"h1",1),s(1),d(2,"translate"),r(),a(3,"div",2)(4,"perun-web-apps-refresh-button",3),C("click",function(){return f(l),h(n.refreshTable())}),r(),a(5,"span",4),d(6,"translate"),d(7,"async"),d(8,"selectedPendingInvitation"),v(9,V_,5,8,"button",5),r(),a(10,"span",4),d(11,"translate"),d(12,"async"),d(13,"selectedPendingInvitation"),v(14,P_,5,8,"button",5),r(),a(15,"span",4),d(16,"translate"),d(17,"async"),d(18,"selectedPendingInvitation"),v(19,G_,5,8,"button",6),r(),a(20,"mat-form-field",7)(21,"mat-label"),s(22),d(23,"translate"),r(),a(24,"mat-select",8),C("closed",function(){return f(l),h(n.changeInvitationStatus())}),a(25,"mat-select-trigger"),s(26),r(),Ce(27,B_,2,2,"mat-option",9,Oe),r()(),a(29,"perun-web-apps-debounce-filter",10),C("filter",function(x){return f(l),h(n.onSearchByString(x))}),r()(),A(30,F_,1,0,"ng-template",null,0,L),a(32,"div",11),A(33,k_,3,13,"perun-web-apps-invitations-list",12),d(34,"async"),r()}if(i&2){let l=y(31);o(),b(m(2,19,"GROUP_DETAIL.INVITATIONS.TITLE")),o(4),_("matTooltip",Y(m(6,21,"GROUP_DETAIL.INVITATIONS.RESEND_DISABLED")))("matTooltipDisabled",!(m(7,23,n.loading$)||!m(8,25,n.selection))||n.selection.selected.length===0),o(4),I(n.authRights.resend?9:-1),o(),_("matTooltip",Y(m(11,27,"GROUP_DETAIL.INVITATIONS.EXTEND_DISABLED")))("matTooltipDisabled",!(m(12,29,n.loading$)||!m(13,31,n.selection))||n.selection.selected.length===0),o(4),I(n.authRights.extend?14:-1),o(),_("matTooltip",Y(m(16,33,"GROUP_DETAIL.INVITATIONS.REVOKE_DISABLED")))("matTooltipDisabled",!(m(17,35,n.loading$)||!m(18,37,n.selection))||n.selection.selected.length===0),o(4),I(n.authRights.revoke?19:-1),o(3),b(m(23,39,"GROUP_DETAIL.INVITATIONS.FILTER_STATUS")),o(2),_("formControl",n.statuses),o(2),g(" ",n.displaySelectedStatuses()," "),o(),Se(n.statusList),o(2),_("placeholder","GROUP_DETAIL.INVITATIONS.SEARCH_DESCRIPTION"),o(4),_("perunWebAppsLoader",m(34,41,n.loading$))("perunWebAppsLoaderIndicator",l)}},dependencies:[D,N,V,He,We,Vt,Bt,Gt,To,Pt,Ne,ye,Qt,Te,xe,O,Ae,Q,ja,P,Zt,R,di],styles:[".search-field[_ngcontent-%COMP%]{width:325px}.fix-select[_ngcontent-%COMP%]{margin-top:8px}"]})}}return t})();var Hs=(t,c)=>["/organizations",t,"members",c],zs=t=>["/admin/users",t],$s=(t,c,e)=>["/organizations",t,"groups",c,"applications",e];function U_(t,c){if(t&1&&(a(0,"span",1),s(1),r()),t&2){let e=p();o(),g(" #",e.invitation.id)}}function j_(t,c){t&1&&S(0,"mat-spinner",3)}function W_(t,c){if(t&1){let e=T();a(0,"button",11),C("click",function(){f(e);let n=p(3);return h(n.onInvitationResend())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.RESEND")," "))}function H_(t,c){if(t&1){let e=T();a(0,"button",11),C("click",function(){f(e);let n=p(3);return h(n.onInvitationExtendDate())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.EXTEND_EXPIRATION_DATE")," "))}function z_(t,c){if(t&1){let e=T();a(0,"button",12),C("click",function(){f(e);let n=p(3);return h(n.onInvitationRevoke())}),s(1),d(2,"translate"),r()}t&2&&(o(),g(" ",m(2,1,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.REVOKE")," "))}function $_(t,c){if(t&1&&(a(0,"div"),v(1,W_,3,3,"button",9),v(2,H_,3,3,"button",9),v(3,z_,3,3,"button",10),r()),t&2){let e=p(2);o(),I(e.authRights.resend?1:-1),o(),I(e.authRights.extend?2:-1),o(),I(e.authRights.revoke?3:-1)}}function Y_(t,c){if(t&1){let e=T();a(0,"a",13),C("auxclick",function(n){return f(e),h(n.preventDefault())}),s(1),r()}if(t&2){let e=p(2);_("perunWebAppsMiddleClickRouterLink",Nt(4,Hs,e.invitation.voId.toString(),e.senderIdInVo.toString()))("routerLink",Nt(7,Hs,e.invitation.voId.toString(),e.senderIdInVo.toString())),o(),be("",e.senderName," (",e.invitation==null?null:e.invitation.createdByUid,")")}}function X_(t,c){if(t&1){let e=T();a(0,"a",13),C("auxclick",function(n){return f(e),h(n.preventDefault())}),s(1),r()}if(t&2){let e=p(2);_("perunWebAppsMiddleClickRouterLink",Ee(4,zs,e.invitation.senderId.toString()))("routerLink",Ee(6,zs,e.invitation.senderId.toString())),o(),be("",e.senderName," (",e.invitation==null?null:e.invitation.createdByUid,")")}}function q_(t,c){if(t&1&&(a(0,"span"),s(1),r()),t&2){let e=p(2);o(),be("",e.senderName," (",e.invitation==null?null:e.invitation.createdByUid,")")}}function K_(t,c){if(t&1){let e=T();a(0,"div")(1,"span",4),s(2),d(3,"translate"),r(),s(4,": "),a(5,"a",13),C("auxclick",function(n){return f(e),h(n.preventDefault())}),s(6),r()()}if(t&2){let e=p(2);o(2),b(m(3,4,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.APPLICATION")),o(3),_("perunWebAppsMiddleClickRouterLink",hi(6,$s,e.invitation.voId.toString(),e.invitation.groupId.toString(),e.invitation.applicationId.toString()))("routerLink",hi(10,$s,e.invitation.voId.toString(),e.invitation.groupId.toString(),e.invitation.applicationId.toString())),o(),b(e.invitation==null?null:e.invitation.applicationId)}}function Z_(t,c){if(t&1&&(a(0,"div",8)(1,"mat-card-title")(2,"i",14),s(3,"clear"),r(),a(4,"span",4),s(5),d(6,"translate"),r(),s(7),r(),a(8,"div")(9,"span",4),s(10),d(11,"translate"),r(),s(12),d(13,"date"),r()()),t&2){let e=p(2);o(5),g(" ",m(6,4,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.REVOKED_BY")," "),o(2),g(": ",e.modifierName),o(3),b(m(11,6,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.DATE")),o(2),g(": ",it(13,8,e.invitation==null?null:e.invitation.modifiedAt,"d.M.y H:mm:ss")," ")}}function Q_(t,c){if(t&1&&(a(0,"div",8)(1,"mat-card-title")(2,"i",15),s(3,"info"),r(),a(4,"span",4),s(5),d(6,"translate"),r(),s(7),r(),a(8,"div")(9,"span",4),s(10),d(11,"translate"),r(),s(12),d(13,"date"),r()()),t&2){let e=p(2);o(5),g(" ",m(6,4,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.LAST_MODIFIED_BY")," "),o(2),g(": ",e.modifierName),o(3),b(m(11,6,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.DATE")),o(2),g(": ",it(13,8,e.invitation==null?null:e.invitation.modifiedAt,"d.M.y H:mm:ss")," ")}}function J_(t,c){if(t&1&&(a(0,"div"),v(1,$_,4,3,"div"),a(2,"span",4),s(3),d(4,"translate"),r(),s(5),a(6,"span",4),s(7),d(8,"translate"),r(),s(9),a(10,"div")(11,"span",4),s(12),d(13,"translate"),r(),s(14,": "),a(15,"span"),s(16),r()(),a(17,"div")(18,"span",4),s(19),d(20,"translate"),r(),s(21,": "),a(22,"span"),s(23),r()(),a(24,"div")(25,"span",4),s(26),d(27,"translate"),r(),s(28,": "),a(29,"span"),s(30),d(31,"date"),r()(),a(32,"div")(33,"span",4),s(34),d(35,"translate"),r(),s(36,": "),a(37,"span"),s(38),r()(),a(39,"div",5)(40,"mat-card-title",4),s(41),d(42,"translate"),r(),a(43,"div")(44,"span"),s(45),d(46,"translate"),r()(),a(47,"div",2)(48,"span"),s(49),d(50,"translate"),r()(),S(51,"mat-divider",2),a(52,"div")(53,"i",6),s(54,"redo"),r(),a(55,"span",4),s(56),d(57,"translate"),r(),s(58,": "),v(59,Y_,2,10,"a",7),v(60,X_,2,8,"a",7),v(61,q_,2,2,"span"),r(),a(62,"div")(63,"mat-card-title",4),s(64," Created by "),r(),s(65),a(66,"div")(67,"span",4),s(68),d(69,"translate"),r(),s(70),d(71,"date"),r()(),a(72,"div")(73,"span",4),s(74),d(75,"translate"),r(),s(76),r(),v(77,K_,7,14,"div"),v(78,Z_,14,11,"div",8),v(79,Q_,14,11,"div",8),r()()),t&2){let e=p();o(),I((e.invitation==null?null:e.invitation.status)===e.InvitationStatus.PENDING?1:-1),o(2),g(" ",m(4,30,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.INVITATION_FOR_GROUP")," "),o(2),g(": ",e.group==null?null:e.group.name," "),o(2),g(" ",m(8,32,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.INVITATION_IN_VO")," "),o(2),g(": ",e.vo==null?null:e.vo.name," "),o(3),g(" ",m(13,34,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.STATUS")," "),o(4),g(" ",e.invitation==null?null:e.invitation.status," "),o(3),g(" ",m(20,36,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.LANGUAGE")," "),o(4),g(" ",e.invitation==null?null:e.invitation.language," "),o(3),g(" ",m(27,38,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.EXPIRATION_DATE")," "),o(4),g(" ",it(31,40,e.invitation==null?null:e.invitation.expiration,"d.M.y")," "),o(4),g(" ",m(35,43,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.REDIRECT_URL")," "),o(4),g(" ",e.invitation!=null&&e.invitation.redirectUrl?e.invitation==null?null:e.invitation.redirectUrl:""," "),o(3),g(" ",m(42,45,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.RECEIVER.TITLE")," "),o(4),be(" ",m(46,47,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.RECEIVER.NAME"),": ",e.invitation==null?null:e.invitation.receiverName," "),o(4),be(" ",m(50,49,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.RECEIVER.EMAIL"),": ",e.invitation==null?null:e.invitation.receiverEmail," "),o(7),b(m(57,51,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.SENT_BY")),o(3),I(e.senderIdInVo?59:-1),o(),I(!e.senderIdInVo&&e.isPerunAdmin?60:-1),o(),I(!e.senderIdInVo&&!e.isPerunAdmin?61:-1),o(4),g(": ",e.creatorName," "),o(3),b(m(69,53,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.DATE")),o(2),g(": ",it(71,55,e.invitation==null?null:e.invitation.createdAt,"d.M.y H:mm:ss")," "),o(4),b(m(75,58,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.TOKEN")),o(2),g(": ",e.invitation==null?null:e.invitation.token," "),o(),I((e.invitation==null?null:e.invitation.applicationId)!==null?77:-1),o(),I((e.invitation==null?null:e.invitation.status)===e.InvitationStatus.REVOKED?78:-1),o(),I((e.invitation==null?null:e.invitation.status)===e.InvitationStatus.PENDING||(e.invitation==null?null:e.invitation.status)===e.InvitationStatus.ACCEPTED||(e.invitation==null?null:e.invitation.status)===e.InvitationStatus.UNSENT?79:-1)}}var Ys=(()=>{class t{constructor(e,i,n,l,E,x,w,U,_e){this.apiService=e,this.authResolver=i,this.route=n,this.invitationManager=l,this.voManager=E,this.entityStorageService=x,this.userManager=w,this.dialog=U,this.membersService=_e,this.InvitationStatus=Yn,this.application=null,this.senderName="",this.modifierName="",this.creatorName="",this.loading=!0,this.isPerunAdmin=!1,this.authRights={revoke:!1,extend:!1,resend:!1}}ngOnInit(){this.loading=!0,this.group=this.entityStorageService.getEntity(),this.setAuthRights(),this.isPerunAdmin=this.authResolver.isPerunAdmin(),this.route.params.subscribe(e=>{this.invitationId=Number(e.invitationId),this.invitationManager.getInvitationById(this.invitationId).subscribe({next:i=>{this.invitation=i,this.voManager.getVoById(this.invitation.voId).subscribe({next:n=>{this.vo=n,this.userManager.getRichUserWithAttributes(this.invitation.senderId).subscribe({next:l=>{this.senderName=this.nameFromRichUser(l),this.userManager.getRichUserWithAttributes(this.invitation.createdByUid).subscribe({next:E=>{this.creatorName=this.nameFromRichUser(E),this.invitation.modifiedByUid<0||this.invitation.status===Yn.EXPIRED?(this.modifierName="Expiration",this.loading=!1):this.userManager.getRichUserWithAttributes(this.invitation.modifiedByUid).subscribe({next:x=>{this.modifierName=this.nameFromRichUser(x),this.loading=!1},error:()=>this.loading=!1}),this.apiService.dontHandleErrorForNext(),this.membersService.getMemberByUser(n.id,l.id).subscribe({next:x=>{this.senderIdInVo=x.id,this.loading=!1},error:()=>this.loading=!1})},error:()=>this.loading=!1})},error:()=>this.loading=!1})},error:()=>this.loading=!1})},error:()=>this.loading=!1})})}nameFromRichUser(e){return e.firstName.toString()+" "+(e.middleName==null?"":e.middleName.toString())+e.lastName.toString()}onInvitationRevoke(){let e=G();e.width="500px",e.data={invitations:[this.invitation]},this.dialog.open(jn,e).afterClosed().subscribe(n=>{n&&this.invitationManager.getInvitationById(this.invitationId).subscribe({next:l=>{this.invitation=l},error:()=>this.loading=!1})})}onInvitationExtendDate(){let e=G();e.width="500px",e.data={invitation:this.invitation,theme:"group-theme"},this.dialog.open(Un,e).afterClosed().subscribe(n=>{n&&this.invitationManager.getInvitationById(this.invitationId).subscribe({next:l=>{this.invitation=l},error:()=>this.loading=!1})})}onInvitationResend(){let e=G();e.width="500px",e.data={invitations:[this.invitation]},this.dialog.open(Wn,e)}setAuthRights(){this.authRights.revoke=this.authResolver.isAuthorized("revokeInvitationById_int_policy",[this.group]),this.authRights.extend=this.authResolver.isAuthorized("extendInvitationExpiration_Invitation_LocalDate_policy",[this.group]),this.authRights.resend=this.authResolver.isAuthorized("resendInvitation_Invitation_policy",[this.group])}static{this.\u0275fac=function(i){return new(i||t)(u(pt),u(k),u(ve),u(St),u(de),u(F),u(ti),u(q),u(Ye))}}static{this.\u0275cmp=M({type:t,selectors:[["app-group-invitation-detail"]],features:[fi([di])],decls:7,vars:6,consts:[[1,"page-subtitle"],[1,"text-muted"],[1,"mb-2"],[1,"ms-auto","me-auto"],[1,"fw-bold"],[1,"card","p-4","mt-2","mb-4"],[1,"material-icons","align-text-top"],[1,"group-link",3,"perunWebAppsMiddleClickRouterLink","routerLink"],[1,"card","p-3","mt-2"],["color","accent","mat-flat-button","",1,"me-2"],["color","warn","mat-flat-button","",1,"me-2"],["color","accent","mat-flat-button","",1,"me-2",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click"],[1,"group-link",3,"auxclick","perunWebAppsMiddleClickRouterLink","routerLink"],[1,"material-icons","red","align-text-top"],[1,"material-icons","orange","align-text-top"]],template:function(i,n){i&1&&(a(0,"h2",0),s(1),d(2,"translate"),v(3,U_,2,1,"span",1),r(),S(4,"mat-divider",2),v(5,j_,1,0,"mat-spinner",3),v(6,J_,80,60,"div")),i&2&&(o(),g(" ",m(2,4,"GROUP_DETAIL.INVITATIONS.INVITATION_DETAIL.TITLE")," "),o(2),I(n.loading?-1:3),o(2),I(n.loading?5:-1),o(),I(n.loading?-1:6))},dependencies:[D,N,V,Ct,It,vt,Mi,ni,ii,De,Me,O,Qi,R],encapsulation:2})}}return t})();var yL=[{path:"",component:za},{path:":voId",component:jr,canActivateChild:[Wi],children:[{path:"",component:Fr,data:{animation:"VoOverviewPage"}},{path:"attributes",component:Kr,data:{animation:"VoAttributesPage"}},{path:"groups",component:Ya,data:{animation:"VoGroupsPage"}},{path:"members",component:qa,data:{animation:"VoMembersPage"}},{path:"resources",component:Xr,children:[{path:"",component:ms,data:{animation:"VoResourcesOverviewPage"}},{path:"preview",component:sr,data:{animation:"VoResourcesPreviewPage"}},{path:"states",component:lr,data:{animation:"VoResourcesStatesPage"}},{path:"tags",component:_s,data:{animation:"VoResourcesTagsPage"}}]},{path:"applications",component:ir,data:{animation:"VoApplicationsPage"}},{path:"applications/:applicationId",component:yn,data:{animation:"VoApplicationDetailPage"}},{path:"sponsoredMembers",component:Tr,data:{animation:"VoSettingsSponsoredMembersPage"}},{path:"serviceAccounts",component:Rs,data:{animation:"VoSettingsServiceMembersPage"}},{path:"statistics",component:xs,data:{animation:"VoStatisticsPage"}},{path:"settings",component:qr,children:[{path:"",component:Zr,data:{animation:"VoSettingsOverviewPage"}},{path:"expiration",component:ts,data:{animation:"VoSettingsExpirationPage"}},{path:"managers",component:is,data:{animation:"VoSettingsManagersPage"}},{path:"applicationForm",component:rr,data:{animation:"SettingsApplicationFormPage"}},{path:"applicationForm/preview",component:Qn,data:{animation:"SettingsApplicationFormPreviewPage"}},{path:"applicationForm/manageGroups",component:Bs},{path:"notifications",component:Is,data:{animation:"SettingsApplicationFormNotificationsPage"}},{path:"extsources",component:Ss,data:{animation:"VoSettingsExtSourcesPage"}},{path:"memberOrganizations",component:ys,data:{animation:"VoSettingsMemberOrganizationsPage"}},{path:"hierarchicalInclusion",component:ws,data:{animation:"VoSettingsHierarchicalInclusionComponent"}},{path:"bans",component:Vs,data:{animation:"VoSettingsBansComponent"}}]}]},{path:":voId/members/:memberId",component:Br,canActivateChild:[Wi],children:[{path:"",component:$r,data:{animation:"MemberOverviewPage"}},{path:"attributes",component:ds,data:{animation:"MemberAttributesPage"}},{path:"groups",component:Ja,data:{animation:"MemberGroupsPage"}},{path:"applications",component:Es,data:{animation:"MemberApplicationsPage"}},{path:"applications/:applicationId",component:yn,data:{animation:"MemberApplicationDetailPage"}},{path:"resources",component:bs,data:{animation:"MemberResourcesPage"}},{path:"bans",component:Ps,data:{animation:"MemberBansPage"}}]},{path:":voId/groups/:groupId",component:Vr,canActivateChild:[Wi],children:[{path:"",component:Yr,data:{animation:"GroupOverviewPage"}},{path:"members",component:or,data:{animation:"GroupMembersPage"}},{path:"subgroups",component:er,data:{animation:"GroupSubgroupsPage"}},{path:"applications",component:nr,data:{animation:"GroupApplicationsPage"}},{path:"invitations",component:Ws,data:{animation:"GroupInvitationsPage"}},{path:"invitations/:invitationId",component:Ys,data:{animation:"GroupInvitationDetailPage"}},{path:"resources",component:ar,data:{animation:"GroupResourcesPage"}},{path:"attributes",component:ls,data:{animation:"GroupAttributesPage"}},{path:"statistics",component:Ms,data:{animation:"GroupStatisticsPage"}},{path:"roles",component:xr,data:{animation:"GroupRolesPage"}},{path:"settings",component:ss,children:[{path:"",component:ps,data:{animation:"GroupSettingsOverviewPage"}},{path:"expiration",component:gs,data:{animation:"GroupSettingsExpirationPage"}},{path:"managers",component:fs,data:{animation:"GroupSettingsManagersPage"}},{path:"applicationForm",component:dr,data:{animation:"GroupSettingsApplicationFormPage"}},{path:"applicationForm/preview",component:Qn},{path:"applicationForm/manageGroups",component:ks},{path:"notifications",component:Cs,data:{animation:"GroupSettingsNotificationsPage"}},{path:"relations",component:mr,data:{animation:"GroupSettingsRelationsPage"}},{path:"extsources",component:As,data:{animation:"GroupSettingsExtsourcesPage"}}]},{path:"applications/:applicationId",component:yn,data:{animation:"GroupApplicationDetailPage"}}]},{path:":voId/resources/:resourceId",component:ur,canActivateChild:[Wi],children:[{path:"",component:_r,data:{animation:"ResourceOverviewPage"}},{path:"groups",component:gr,data:{animation:"ResourceGroupsComponent"}},{path:"services",component:Cr,data:{animation:"ResourceAssignedServicesComponent"}},{path:"attributes",component:vr,data:{animation:"ResourceAttributesPage"}},{path:"members",component:Sr,data:{animation:"ResourceAssignedMembersComponent"}},{path:"tags",component:br,data:{animation:"ResourceTagsComponent"}},{path:"settings",component:fr,children:[{path:"",component:hr,data:{animation:"ResourceSettingsOverviewPage"}},{path:"managers",component:Ir,data:{animation:"ResourceSettingsManagersPage"}},{path:"bans",component:Dr,data:{animation:"ResourceSettingsBansPage"}}]}]}];export{yL as vosRoutes};
