import{e as ve}from"./chunk-BJSMM6KA.js";import{Aa as b,Ag as Te,Ba as M,Ca as S,Cc as le,Da as C,Dc as se,Ha as R,Ia as L,Ja as O,Na as u,Oa as k,Of as be,Pa as f,Pc as w,Qc as ce,Rc as pe,S as x,Sd as ue,Sf as xe,T as D,V as H,W as j,Xa as X,Xg as U,Zg as ye,_a as A,_e,aa as n,cb as c,db as p,ea as d,eb as V,fa as E,fe as he,ge as Se,he as fe,ia as z,id as de,jd as me,ka as _,lc as G,mc as W,nc as B,oa as Q,oc as q,oi as F,pc as Y,pf as Ce,qa as T,qb as $,qc as J,qf as ge,ra as y,rc as K,rf as P,sc as Z,sf as N,tb as v,tc as ee,uc as te,va as m,vc as ie,wa as l,wc as ae,wg as De,xa as s,xc as oe,ya as I,yc as ne,za as g,zc as re,zg as Ee}from"./chunk-FCYS6PEK.js";var Ie=(()=>{class t{transform(e){return e.substring(40)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=z({name:"extSourceType",type:t,pure:!0})}}return t})();var Re=t=>({all:t}),Le=t=>({name:t});function Oe(t,r){if(t&1){let e=M();l(0,"th",15)(1,"mat-checkbox",16),c(2,"masterCheckboxLabel"),c(3,"translate"),S("change",function(a){x(e);let o=C(2);return D(a?o.masterToggle():null)}),s()()}if(t&2){let e=C(),i=C();n(),m("aria-label",p(3,5,p(2,3,e.all)))("checked",i.selection.hasValue()&&e.all)("indeterminate",i.selection.hasValue()&&!e.all)}}function ke(t,r){if(t&1){let e=M();l(0,"td",17)(1,"mat-checkbox",18),c(2,"checkboxLabel"),c(3,"translate"),S("change",function(a){let o=x(e).$implicit,h=C(2);return D(a?h.toggleRow(o):null)})("click",function(a){return x(e),D(a.stopPropagation())}),s()()}if(t&2){let e=r.$implicit,i=C(2);n(),m("aria-label",V(3,4,p(2,2,i.selection.isSelected(e)),A(7,Le,e.name)))("checked",i.selection.isSelected(e))}}function Ae(t,r){t&1&&(g(0,3),_(1,Oe,4,7,"th",13)(2,ke,4,9,"td",14),b())}function Ve(t,r){t&1&&(l(0,"th",19),u(1),c(2,"translate"),s()),t&2&&(n(),f(" ",p(2,1,"SHARED.COMPONENTS.EXT_SOURCES_LIST.ID")," "))}function Be(t,r){if(t&1&&(l(0,"td",20),u(1),s()),t&2){let e=r.$implicit;n(),k(e.id)}}function Pe(t,r){t&1&&(l(0,"th",19),u(1),c(2,"translate"),s()),t&2&&(n(),f(" ",p(2,1,"SHARED.COMPONENTS.EXT_SOURCES_LIST.NAME")," "))}function Ne(t,r){if(t&1&&(l(0,"td",21),c(1,"lowercase"),u(2),s()),t&2){let e=r.$implicit;Q("data-cy",X("",p(1,3,e.name),"-name-td")),n(2),f(" ",e.name," ")}}function Ue(t,r){t&1&&(l(0,"th",19),u(1),c(2,"translate"),s()),t&2&&(n(),f(" ",p(2,1,"SHARED.COMPONENTS.EXT_SOURCES_LIST.TYPE")," "))}function Fe(t,r){if(t&1&&(l(0,"td",21),u(1),c(2,"extSourceType"),s()),t&2){let e=r.$implicit;n(),k(p(2,1,e.type))}}function He(t,r){t&1&&I(0,"tr",22)}function je(t,r){t&1&&I(0,"tr",23)}function ze(t,r){t&1&&(l(0,"perun-web-apps-alert",12),u(1),c(2,"translate"),s()),t&2&&(n(),f(" ",p(2,1,"SHARED.COMPONENTS.EXT_SOURCES_LIST.NO_EXT_SOURCES")," "))}function Qe(t,r){t&1&&(l(0,"perun-web-apps-alert",12),u(1),c(2,"translate"),s()),t&2&&(n(),f(" ",p(2,1,"SHARED.COMPONENTS.EXT_SOURCES_LIST.NO_FILTER_RESULTS")," "))}var ft=(()=>{class t{constructor(e,i,a,o){this.authResolver=e,this.tableCheckbox=i,this.tableConfigService=a,this.destroyRef=o,this.selection=new B,this.filterValue="",this.exporting=!1,this.pageSizeOptions=_e,this.displayedColumns=["select","id","name","type"],this.unfilteredColumns=this.displayedColumns}set displayColumns(e){this.unfilteredColumns=e,localStorage.getItem("showIds")!=="true"&&(e=e.filter(i=>i!=="id")),this.displayedColumns=e}set matSort(e){this.sort=e,this.setDataSource()}static getDataForColumn(e,i){switch(i){case"id":return e.id.toString();case"type":return e.type.substring(40);case"name":return e.name;default:return""}}ngOnInit(){this.selection&&(this.cachedSelection=new B(this.selection.isMultipleSelection(),[],!0,this.selection.compareWith),this.cachedSubject?.pipe(U(this.destroyRef)).subscribe(e=>{e&&this.cachedSelection.clear()})),this.watchForIdColumnChanges()}ngAfterViewInit(){this.setDataSource()}ngOnChanges(){this.dataSource=new re(this.extSources),this.setDataSource()}exportAllData(e){N(P(this.dataSource.filteredData,this.displayedColumns,t.getDataForColumn),e)}exportDisplayedData(e){let i=this.dataSource.paginator.pageIndex*this.dataSource.paginator.pageSize,a=i+this.dataSource.paginator.pageSize;N(P(this.dataSource.sortData(this.dataSource.filteredData,this.dataSource.sort).slice(i,a),this.displayedColumns,t.getDataForColumn),e)}setDataSource(){this.dataSource&&(this.dataSource.filterPredicate=(e,i)=>ge(e,i,this.displayedColumns,t.getDataForColumn),this.dataSource.sortData=(e,i)=>Ce(e,i,t.getDataForColumn),this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue)}isAllSelected(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.dataSource)}masterToggle(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.cachedSelection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}toggleRow(e){this.selection.toggle(e),this.cachedSelection.toggle(e)}pageChanged(){this.cachedSelection&&this.tableCheckbox.selectCachedDataOnPage(this.dataSource,this.selection,this.cachedSelection,this.selection.compareWith)}watchForIdColumnChanges(){this.tableConfigService.showIdsChanged.pipe(U(this.destroyRef)).subscribe(e=>{e?this.displayedColumns=this.unfilteredColumns:this.displayedColumns=this.unfilteredColumns.filter(i=>i!=="id")}),localStorage.getItem("showIds")!=="true"&&(this.displayedColumns=this.displayedColumns.filter(e=>e!=="id"))}static{this.\u0275fac=function(i){return new(i||t)(d(he),d(xe),d(ye),d(H))}}static{this.\u0275cmp=E({type:t,selectors:[["app-ext-sources-list"]],viewQuery:function(i,a){if(i&1&&(R(F,7),R(w,7)),i&2){let o;L(o=O())&&(a.child=o.first),L(o=O())&&(a.matSort=o.first)}},inputs:{extSources:"extSources",selection:"selection",cachedSubject:"cachedSubject",filterValue:"filterValue",tableId:"tableId",loading:"loading",displayColumns:"displayColumns"},features:[j],decls:18,vars:15,consts:[[1,"card","mt-2",3,"hidden"],[3,"exportDisplayedData","exportAllData","pageChanged","pageSizeOptions","dataLength","tableId"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"matSortChange","dataSource"],["matColumnDef","select"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-cell","",4,"matCellDef"],["matColumnDef","type"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn"],["class","align-checkbox","mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size align-checkbox","mat-cell","",4,"matCellDef"],["mat-header-cell","",1,"align-checkbox"],["color","primary",3,"change","aria-label","checked","indeterminate"],["mat-cell","",1,"static-column-size","align-checkbox"],["color","primary",3,"change","click","aria-label","checked"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"static-column-size"],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"]],template:function(i,a){if(i&1&&(l(0,"div",0)(1,"perun-web-apps-table-wrapper",1),S("exportDisplayedData",function(h){return a.exportDisplayedData(h)})("exportAllData",function(h){return a.exportAllData(h)})("pageChanged",function(){return a.pageChanged()}),l(2,"table",2),S("matSortChange",function(){return a.pageChanged()}),T(3,Ae,3,0,"ng-container",3),c(4,"isAllSelected"),g(5,4),_(6,Ve,3,3,"th",5)(7,Be,2,1,"td",6),b(),g(8,7),_(9,Pe,3,3,"th",5)(10,Ne,3,5,"td",8),b(),g(11,9),_(12,Ue,3,3,"th",5)(13,Fe,3,3,"td",8),b(),_(14,He,1,0,"tr",10)(15,je,1,0,"tr",11),s()()(),T(16,ze,3,3,"perun-web-apps-alert",12),T(17,Qe,3,3,"perun-web-apps-alert",12)),i&2){let o;m("hidden",a.extSources.length===0||a.dataSource.filteredData.length===0),n(),m("pageSizeOptions",a.pageSizeOptions)("dataLength",a.dataSource.filteredData.length)("tableId",a.tableId),n(),m("dataSource",a.dataSource),n(),y((o=A(13,Re,V(4,10,a.dataSource,a.selection.selected.length)))?3:-1,o),n(11),m("matHeaderRowDef",a.displayedColumns),n(),m("matRowDefColumns",a.displayedColumns),n(),y(!a.loading&&a.extSources.length===0?16:-1),n(),y(a.dataSource.filteredData.length===0&&a.extSources.length!==0?17:-1)}},dependencies:[v,W,G,me,de,F,ne,q,J,te,K,Y,ie,Z,ee,ae,oe,pe,w,ce,se,$,De,le,Ee,Te,Ie],encapsulation:2})}}return t})();var It=(()=>{class t{constructor(e,i,a,o){this.data=e,this.dialogRef=i,this.voService=a,this.notificator=o,this.loading=!1}update(e){this.loading=!0,this.voService.updateVoBan({banOnVo:{id:this.data.ban.id,beanName:"BanOnVo",voId:this.data.ban.voId,memberId:this.data.ban.memberId,description:e.description,validityTo:e.validity}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.UPDATE_BAN.SUCCESS"),this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}cancel(){this.dialogRef.close(!1)}static{this.\u0275fac=function(i){return new(i||t)(d(fe),d(Se),d(ue),d(be))}}static{this.\u0275cmp=E({type:t,selectors:[["app-update-vo-ban-dialog"]],decls:1,vars:3,consts:[[3,"cancelled","update","ban","theme","loading"]],template:function(i,a){i&1&&(l(0,"app-update-ban-dialog",0),S("cancelled",function(){return a.cancel()})("update",function(h){return a.update(h)}),s()),i&2&&m("ban",a.data.ban)("theme","vo-theme")("loading",a.loading)},dependencies:[v,ve],encapsulation:2})}}return t})();export{ft as a,It as b};
