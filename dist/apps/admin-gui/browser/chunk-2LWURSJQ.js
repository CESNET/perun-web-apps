import{$f as G,Aa as I,Ac as K,Ba as C,Bb as w,Cd as Re,Ce as Me,Ci as ke,Dc as Z,Ef as De,Eg as Oe,Fj as ze,Gb as ve,Gj as $e,Hc as ye,Hg as M,Ia as P,Ib as j,Ja as ee,K as F,Kc as Ce,Ma as h,Mc as Ie,Na as _,Nd as Le,O as S,Oa as te,Oc as Ae,P as b,Qa as E,Qh as O,Rb as R,Tb as Se,Tg as Pe,Ug as Be,Va as H,Vb as L,Vg as Ue,Wa as U,Wb as be,Wc as q,Wg as Ne,Xa as fe,Xc as Fe,Y as o,Ya as _e,Yg as D,Z as p,Zc as Te,_ as W,ad as ie,bc as k,ca as v,dd as Ee,fa as c,fe as xe,fg as Ve,g as me,ga as B,gc as Y,hg as x,id as N,ja as a,jh as Ge,ka as l,la as y,lh as We,oa as A,oh as V,pa as u,qa as m,qc as z,qj as Ye,sd as we,ta as he,xc as $,xh as He,ya as T,yh as J,za as f,zb as ge,zh as je}from"./chunk-WEHWIVFK.js";function et(s,n){if(s&1){let t=A();a(0,"button",11),u("click",function(){S(t);let i=m();return b(i.onCreate())}),f(1),h(2,"translate"),l()}s&2&&(o(),C(" ",_(2,1,"FACILITY_MANAGEMENT.CREATE")," "))}var Ke=s=>[s];function tt(s,n){if(s&1){let t=A();a(0,"button",12),u("click",function(){S(t);let i=m();return b(i.onDelete())}),h(1,"isAuthorized"),f(2),h(3,"translate"),l()}if(s&2){let t=m();c("disabled",t.selection.selected.length===0||!te(1,2,ee(7,Ke,t.selection.selected[0]==null?null:t.selection.selected[0].facility),"deleteFacility_Facility_Boolean_policy")),o(2),C(" ",_(3,5,"FACILITY_MANAGEMENT.DELETE")," ")}}function it(s,n){s&1&&y(0,"perun-web-apps-loading-table")}function rt(s,n){if(s&1&&y(0,"perun-web-apps-facilities-list",13),s&2){let t=m();c("tableId",t.tableId)("selection",t.selection)("loading",t.loading)("filterValue",t.filterValue)("facilities",t.facilities)("recentIds",t.recentIds)}}var st=()=>({color:"black"}),jt=(()=>{let n=class n{constructor(e,i,r,d,g){this.facilityManager=e,this.sideMenuService=i,this.guiAuthResolver=r,this.dialog=d,this.cacheHelperService=g,this.facilities=[],this.recentIds=[],this.filterValue="",this.tableId=Re,this.selection=new k(!1,[])}ngOnInit(){this.createAuth=this.guiAuthResolver.isAuthorized("createFacility_Facility_policy",[]),this.deleteAuth=this.guiAuthResolver.isFacilityAdmin(),this.refreshTable(),this.cacheHelperService.refreshComponentCachedData().subscribe(e=>{e&&this.refreshTable()})}ngAfterViewChecked(){this.sideMenuService.setFacilityMenuItems([])}refreshTable(){this.loading=!0,this.facilityManager.getEnrichedFacilities().subscribe(e=>{this.selection.clear(),this.facilities=e,this.recentIds=Ee("facilities"),this.loading=!1})}onCreate(){let e=N();e.width="800px",e.data={theme:"facility-theme"},this.dialog.open(ze,e).afterClosed().subscribe(r=>{r&&(this.loading=!0,this.refreshTable())})}onDelete(){let e=N();e.width="500px",e.data={theme:"facility-theme",facility:this.selection.selected[0].facility},this.dialog.open($e,e).afterClosed().subscribe(r=>{r&&this.refreshTable()})}applyFilter(e){this.filterValue=e}};n.id="FacilitySelectPageComponent",n.\u0275fac=function(i){return new(i||n)(p(w),p(Ve),p(L),p(z),p(O))},n.\u0275cmp=F({type:n,selectors:[["app-facility-select-page"]],hostVars:2,hostBindings:function(i,r){i&2&&B("router-component",r.true)},decls:17,vars:21,consts:[[1,"container-fluid","ps-xl-5","pe-xl-5","facility-theme"],[1,"page-title","d-flex"],["svgIcon","perun-facility-black",1,"perun-icon","icon-scale",3,"ngStyle"],[3,"refresh"],["mat-flat-button","","class","action-button me-2","data-cy","new-facility-button","color","accent",3,"click",4,"ngIf"],[3,"matTooltipDisabled","matTooltipPosition","matTooltip"],["mat-flat-button","","class","me-2","data-cy","delete-facility-button","color","warn",3,"disabled","click",4,"ngIf"],[3,"autoFocus","placeholder","filter"],["spinner",""],[1,"position-relative","table-min-height"],[3,"tableId","selection","loading","filterValue","facilities","recentIds",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-flat-button","","data-cy","new-facility-button","color","accent",1,"action-button","me-2",3,"click"],["mat-flat-button","","data-cy","delete-facility-button","color","warn",1,"me-2",3,"disabled","click"],[3,"tableId","selection","loading","filterValue","facilities","recentIds"]],template:function(i,r){if(i&1&&(a(0,"div",0),y(1,"perun-web-apps-back-button"),a(2,"h1",1),y(3,"mat-icon",2),f(4),h(5,"translate"),l(),a(6,"perun-web-apps-refresh-button",3),u("refresh",function(){return r.refreshTable()}),l(),v(7,et,3,3,"button",4),a(8,"span",5),h(9,"isAuthorized"),h(10,"translate"),v(11,tt,4,9,"button",6),l(),a(12,"perun-web-apps-debounce-filter",7),u("filter",function(g){return r.applyFilter(g)}),l(),v(13,it,1,0,"ng-template",null,8,E),a(15,"div",9),v(16,rt,1,6,"perun-web-apps-facilities-list",10),l()()),i&2){let d=T(14);o(3),c("ngStyle",P(18,st)),o(),C(" ",_(5,11,"FACILITY_MANAGEMENT.TITLE")," "),o(3),c("ngIf",r.createAuth),o(),he("matTooltip",_(10,16,"FACILITY_MANAGEMENT.DELETE_PERMISSION_HINT")),c("matTooltipDisabled",r.selection.selected.length===0||te(9,13,ee(19,Ke,r.selection.selected[0]==null?null:r.selection.selected[0].facility),"deleteFacility_Facility_Boolean_policy"))("matTooltipPosition","below"),o(3),c("ngIf",r.deleteAuth),o(),c("autoFocus",!0)("placeholder","FACILITY_MANAGEMENT.FILTER_PLACEHOLDER"),o(4),c("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",d)}},dependencies:[U,fe,Me,$,Te,M,D,Ne,Ue,V,x,R,Oe],styles:[".icon-scale[_ngcontent-%COMP%]{transform:scale(1.7);margin-left:.5rem;margin-top:-.4rem;margin-right:.9rem}"]});let s=n;return s})();function ot(s,n){if(s&1){let t=A();a(0,"button",10),u("click",function(){S(t);let i=m();return b(i.createResource())}),f(1),h(2,"translate"),l()}s&2&&(o(),C(" ",_(2,1,"FACILITY_DETAIL.RESOURCES.CREATE")," "))}function at(s,n){if(s&1){let t=A();a(0,"button",11),u("click",function(){S(t);let i=m();return b(i.removeResource())}),f(1),h(2,"translate"),l()}if(s&2){let t=m();c("disabled",t.selected.selected.length===0),o(),C(" ",_(2,2,"FACILITY_DETAIL.RESOURCES.DELETE")," ")}}function lt(s,n){s&1&&y(0,"perun-web-apps-loading-table")}function ct(s,n){if(s&1&&y(0,"perun-web-apps-resources-list",12),s&2){let t=m();c("tableId",t.tableId)("loading",t.loading)("filterValue",t.filterValue)("resources",t.resources)("selection",t.selected)("disableRouting",!t.routeAuth)("displayedColumns",t.displayedColumns)}}var ni=(()=>{let n=class n{constructor(e,i,r,d,g,Q,X){this.dialog=e,this.facilitiesManager=i,this.servicesManager=r,this.authResolver=d,this.entityStorageService=g,this.cd=Q,this.cacheHelperService=X,this.resources=[],this.selected=new k(!0,[]),this.emptyService={id:-1,beanName:"Service",name:"All"},this.services=[this.emptyService],this.selectedService=this.emptyService,this.filterValue="",this.tableId=we,this.displayedColumns=["id","vo","facility","description"]}ngOnInit(){this.loading=!0,this.facility=this.entityStorageService.getEntity(),this.setAuthRights(),this.servicesManager.getAssignedServices(this.facility.id).subscribe(e=>{this.services=[this.emptyService].concat(e),this.refreshTable()}),this.loadResourcesForFacility(),this.cacheHelperService.refreshComponentCachedData().subscribe(e=>{e&&this.refreshTable()})}ngAfterViewInit(){this.cd.detectChanges()}removeResource(){let e=N();e.width="450px",e.data={theme:"facility-theme",resources:this.selected.selected},this.dialog.open(ke,e).afterClosed().subscribe(r=>{r&&this.refreshTable()})}refreshTable(){this.loading=!0,this.selectedService.id===-1?this.loadResourcesForFacility():this.facilitiesManager.getAssignedRichResourcesForFacilityAndService(this.facility.id,this.selectedService.id).subscribe(e=>{this.resources=e,this.selected.clear(),this.setAuthRights(),this.loading=!1})}setAuthRights(){this.addAuth=this.authResolver.isAuthorized("createResource_Resource_Vo_Facility_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("deleteResource_Resource_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","id","name","vo","description"]:["id","name","vo","description"],this.resources.length!==0&&(this.routeAuth=this.authResolver.isAuthorized("getRichResourceById_int_policy",[this.facility,this.resources[0]]))}applyFilter(e){this.filterValue=e}createResource(){let e=N();e.width="1350px",e.data={facilityId:this.facility.id,theme:"facility-theme"},this.dialog.open(Ye,e).afterClosed().subscribe(r=>{r&&this.refreshTable()})}serviceSelected(e){this.selectedService=e,this.refreshTable()}loadResourcesForFacility(){this.facilitiesManager.getAssignedRichResourcesForFacility(this.facility.id).subscribe(e=>{this.resources=e,this.selected.clear(),this.setAuthRights(),this.loading=!1})}};n.id="FacilityResourcesComponent",n.\u0275fac=function(i){return new(i||n)(p(z),p(w),p(j),p(L),p(G),p(W),p(O))},n.\u0275cmp=F({type:n,selectors:[["app-facility-resources"]],hostVars:2,hostBindings:function(i,r){i&2&&B("router-component",r.true)},decls:14,vars:10,consts:[[1,"page-subtitle"],[1,"align-elements"],[3,"refresh"],["mat-flat-button","","color","accent","data-cy","create-resource-button","class","me-2 action-button",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","me-2","data-cy","delete-resource-button",3,"disabled","click",4,"ngIf"],[1,"search-select","me-2",3,"services","service","serviceSelected"],[1,"filter-field",3,"placeholder","filter"],["spinner",""],[1,"position-relative","table-min-height"],[3,"tableId","loading","filterValue","resources","selection","disableRouting","displayedColumns",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-flat-button","","color","accent","data-cy","create-resource-button",1,"me-2","action-button",3,"click"],["mat-flat-button","","color","warn","data-cy","delete-resource-button",1,"me-2",3,"disabled","click"],[3,"tableId","loading","filterValue","resources","selection","disableRouting","displayedColumns"]],template:function(i,r){if(i&1&&(a(0,"div")(1,"h1",0),f(2),h(3,"translate"),l(),a(4,"div",1)(5,"perun-web-apps-refresh-button",2),u("refresh",function(){return r.refreshTable()}),l(),v(6,ot,3,3,"button",3)(7,at,3,4,"button",4),a(8,"perun-web-apps-service-search-select",5),u("serviceSelected",function(g){return r.serviceSelected(g)}),l(),a(9,"perun-web-apps-debounce-filter",6),u("filter",function(g){return r.applyFilter(g)}),l()(),v(10,lt,1,0,"ng-template",null,7,E),a(12,"div",8),v(13,ct,1,7,"perun-web-apps-resources-list",9),l()()),i&2){let d=T(11);o(2),I(_(3,8,"FACILITY_DETAIL.RESOURCES.TITLE")),o(4),c("ngIf",r.addAuth),o(),c("ngIf",r.removeAuth),o(),c("services",r.services)("service",r.selectedService),o(),c("placeholder","SHARED_LIB.PERUN.COMPONENTS.RESOURCES_LIST.TABLE_SEARCH"),o(4),c("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",d)}},dependencies:[U,$,M,D,Be,V,J,x,R],styles:[".search-select[_ngcontent-%COMP%]{min-width:325px}.filter-field[_ngcontent-%COMP%]{min-width:250px}.align-elements[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:baseline}"]});let s=n;return s})();function mt(s,n){if(s&1&&(a(0,"mat-option",10),f(1),l()),s&2){let t=n.$implicit;c("value",t.id),o(),C(" ",t.name," ")}}function ht(s,n){s&1&&y(0,"perun-web-apps-loading-table")}var ft=()=>["id","vo","name","description"];function _t(s,n){if(s&1&&y(0,"perun-web-apps-groups-list",11),s&2){let t=m();c("loading",t.loading)("displayedColumns",P(7,ft))("groups",t.groupsToShow)("disableMembers",!1)("filter",t.filterValue)("groupsToDisableRouting",t.groupsWithoutRouteAuth)("tableId",t.tableId)}}var _i=(()=>{let n=class n{constructor(e,i,r,d){this.facilityManager=e,this.authResolver=i,this.entityStorageService=r,this.cacheHelperService=d,this.groups=[],this.filterValue="",this.selected="all",this.groupsToShow=this.groups,this.tableId=Le,this.groupsWithoutRouteAuth=new Set}ngOnInit(){this.loading=!0,this.facility=this.entityStorageService.getEntity(),this.facilityManager.getAllowedVos(this.facility.id).subscribe(e=>{this.vos=e,this.refreshTable()}),this.cacheHelperService.refreshComponentCachedData().subscribe(e=>{e&&this.refreshTable()})}showGroup(){this.selected!=="all"?this.groupsToShow=this.groups.filter(e=>e.voId===parseInt(this.selected,10)):this.groupsToShow=this.groups}refreshTable(){this.loading=!0,this.groups=[],this.facilityManager.getAllowedGroups(this.facility.id).subscribe(e=>{this.groups=e,this.groupsToShow=this.groups,this.setAuthRights(e),this.loading=!1}),this.vos&&this.vos.length===0&&(this.loading=!1)}setAuthRights(e){e.forEach(i=>{this.authResolver.isAuthorized("getGroupById_int_policy",[i])||this.groupsWithoutRouteAuth.add(i.id)})}applyFilter(e){this.filterValue=e}};n.id="FacilityAllowedGroupsComponent",n.\u0275fac=function(i){return new(i||n)(p(w),p(L),p(G),p(O))},n.\u0275cmp=F({type:n,selectors:[["app-facility-allowed-groups"]],hostVars:2,hostBindings:function(i,r){i&2&&B("router-component",r.true)},inputs:{groups:"groups"},decls:19,vars:14,consts:[[1,"page-subtitle"],[3,"refresh"],[1,"me-2"],[3,"value","selectionChange","valueChange"],["value","all"],[3,"value",4,"ngFor","ngForOf"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative","table-min-height"],[3,"loading","displayedColumns","groups","disableMembers","filter","groupsToDisableRouting","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"value"],[3,"loading","displayedColumns","groups","disableMembers","filter","groupsToDisableRouting","tableId"]],template:function(i,r){if(i&1&&(a(0,"div")(1,"h1",0),f(2),h(3,"translate"),l(),a(4,"perun-web-apps-refresh-button",1),u("refresh",function(){return r.refreshTable()}),l(),a(5,"mat-form-field",2)(6,"mat-label"),f(7),h(8,"translate"),l(),a(9,"mat-select",3),u("selectionChange",function(){return r.showGroup()})("valueChange",function(g){return r.selected=g}),a(10,"mat-option",4),f(11),h(12,"translate"),l(),v(13,mt,2,2,"mat-option",5),l()(),a(14,"perun-web-apps-debounce-filter",6),u("filter",function(g){return r.applyFilter(g)}),l(),v(15,ht,1,0,"ng-template",null,7,E),a(17,"div",8),v(18,_t,1,8,"perun-web-apps-groups-list",9),l()()),i&2){let d=T(16);o(2),I(_(3,8,"MENU_ITEMS.FACILITY.ALLOWED_GROUPS")),o(5),I(_(8,10,"FACILITY_DETAIL.ALLOWED_GROUPS.SHOW_VOS_GROUPS")),o(2),c("value",r.selected),o(2),I(_(12,12,"FACILITY_DETAIL.ALLOWED_GROUPS.ALL")),o(2),c("ngForOf",r.vos),o(),c("placeholder","FACILITY_DETAIL.ALLOWED_GROUPS.FILTER"),o(4),c("perunWebAppsLoader",r.loading)("perunWebAppsLoaderIndicator",d)}},dependencies:[H,Y,Z,K,q,M,Pe,D,V,x,R]});let s=n;return s})();function gt(s,n){if(s&1&&(a(0,"mat-option",20),f(1),h(2,"translate"),l()),s&2){let t=n.$implicit;c("value",t),o(),I(_(2,2,"CONSENTS.STATUS_"+t))}}function vt(s,n){if(s&1){let t=A();a(0,"mat-form-field",17)(1,"mat-label"),f(2),h(3,"translate"),l(),a(4,"mat-select",18),u("closed",function(){S(t);let i=m(2);return b(i.consentStatusSelected())}),a(5,"mat-select-trigger"),f(6),l(),v(7,gt,3,4,"mat-option",19),l()()}if(s&2){let t=m(2);o(2),I(_(3,4,"CONSENTS.STATUS")),o(2),c("formControl",t.statuses),o(2),C(" ",t.displaySelectedStatuses()," "),o(),c("ngForOf",t.consentStatusesList)}}function St(s,n){if(s&1){let t=A();a(0,"div",9)(1,"div",10)(2,"mat-slide-toggle",11),u("ngModelChange",function(i){S(t);let r=m();return b(r.allowed=i)})("change",function(){S(t);let i=m();return b(i.changeFilter())}),f(3),h(4,"translate"),l(),a(5,"span",12),f(6),h(7,"translate"),l()(),a(8,"div",1)(9,"perun-web-apps-vo-search-select",13),u("voSelected",function(i){S(t);let r=m();return b(r.voSelected(i))}),l(),a(10,"perun-web-apps-resource-search-select",14),u("resourceSelected",function(i){S(t);let r=m();return b(r.resourceSelected(i))}),l(),a(11,"perun-web-apps-service-search-select",15),u("serviceSelected",function(i){S(t);let r=m();return b(r.serviceSelected(i))}),l(),v(12,vt,8,6,"mat-form-field",16),l()()}if(s&2){let t=m();o(2),c("ngModel",t.allowed),o(),C(" ",_(4,14,"FACILITY_DETAIL.ALLOWED_USERS.FILTER_ALLOWED")," "),o(3),I(_(7,16,t.toggle_messages[t.allowed?1:0])),o(3),c("vos",t.vos)("vo",t.selectedVo)("disableAutoSelect",!0),o(),c("resources",t.filteredResources)("displayStatus",!1)("resource",t.selectedResource)("disableAutoSelect",!0),o(),c("services",t.filteredServices)("service",t.selectedService)("disableAutoSelect",!0),o(),c("ngIf",t.globalForceConsents&&t.facilityForceConsents)}}function bt(s,n){s&1&&y(0,"perun-web-apps-loading-table")}var yt=()=>["id","name","email","logins","organization","consentStatus"],Ct=()=>["id","name","email","logins","organization"];function It(s,n){if(s&1){let t=A();a(0,"perun-web-apps-users-dynamic-list",21),u("loading$",function(i){S(t);let r=m();return b(r.loading$=i)}),l()}if(s&2){let t=m();c("attrNames",t.attributes)("disableRouting",!t.routeAuth)("displayedColumns",t.globalForceConsents&&t.facilityForceConsents?P(12,yt):P(13,Ct))("onlyAllowed",t.allowed)("facilityId",t.facility.id)("searchString",t.filterValue)("resourceId",t.selectedResource==null?null:t.selectedResource.id)("serviceId",t.selectedService==null?null:t.selectedService.id)("tableId",t.tableId)("voId",t.selectedVo==null?null:t.selectedVo.id)("consentStatuses",t.selectedConsentStatuses)("updateTable",t.update)}}var Gi=(()=>{let n=class n{constructor(e,i,r,d,g,Q,X,Ze,qe,Je){this.facilityService=e,this.serviceService=i,this.resourceService=r,this.authResolver=d,this.storeService=g,this.entityStorageService=Q,this.consentService=X,this.translate=Ze,this.cd=qe,this.cacheHelperService=Je,this.update=!1,this.filterValue="",this.attributes=[],this.allowed=!0,this.resources=[],this.filteredResources=[],this.vos=[],this.services=[],this.filteredServices=[],this.consentStatusesList=["UNSIGNED","GRANTED","REVOKED"],this.selectedConsentStatuses=[],this.resourceAssignedServices=new Map,this.tableId=xe,this.toggle_messages=["FACILITY_DETAIL.ALLOWED_USERS.FILTER_ASSIGNED_MSG","FACILITY_DETAIL.ALLOWED_USERS.FILTER_ALLOWED_MSG"],this.advancedFilter=!1}ngOnInit(){this.loading$=me(!0),this.statuses=new Ce(this.selectedConsentStatuses),this.attributes=[ie.USER_DEF_ORGANIZATION,ie.USER_DEF_PREFERRED_MAIL],this.attributes=this.attributes.concat(this.storeService.getLoginAttributeNames()),this.facility=this.entityStorageService.getEntity(),this.globalForceConsents=this.storeService.getProperty("enforce_consents"),this.consentService.getConsentHubByFacility(this.facility.id).subscribe(e=>{this.facilityForceConsents=e.enforceConsents}),this.routeAuth=this.authResolver.isPerunAdminOrObserver(),this.changeFilter(),this.refreshPage(),this.cacheHelperService.refreshComponentCachedData().subscribe(e=>{e&&this.refreshPage()})}changeFilter(){this.filtersCount=this.allowed?1:0,this.selectedVo&&(this.filtersCount+=1),this.selectedResource&&(this.filtersCount+=1),this.selectedService&&(this.filtersCount+=1),this.selectedConsentStatuses.length>0&&(this.filtersCount+=1),this.cd.detectChanges()}clearFilters(){this.allowed=!1,this.selectedVo=void 0,this.selectedResource=void 0,this.selectedService=void 0,this.selectedConsentStatuses=[],this.statuses.setValue(this.selectedConsentStatuses),this.filtersCount=0,this.voSelected(this.selectedVo),this.resourceSelected(this.selectedResource),this.serviceSelected(this.selectedService),this.cd.detectChanges()}refreshPage(){this.facilityService.getAssignedResourcesForFacility(this.facility.id).subscribe(e=>{this.resources=e,this.filteredResources=this.resources,this.facilityService.getAllowedVos(this.facility.id).subscribe(i=>{this.vos=i,this.serviceService.getAssignedServices(this.facility.id).subscribe(r=>{this.services=r,this.filteredServices=this.services,this.update=!this.update,this.cd.detectChanges()})})})}applyFilter(e){this.filterValue=e,this.cd.detectChanges()}voSelected(e){this.selectedVo=e,this.selectedResource=void 0,this.selectedService=void 0,e?(this.filteredResources=this.resources.filter(i=>i.voId===e.id),this.serviceService.getAssignedServicesVo(this.facility.id,e.id).subscribe(i=>{this.filteredServices=i})):(this.filteredResources=this.resources,this.filteredServices=this.services),this.changeFilter()}resourceSelected(e){this.selectedResource=e,this.selectedService=void 0,e===void 0?this.filteredServices=this.services:this.resourceService.getAssignedServicesToResource(e.id).subscribe(i=>{this.filteredServices=i}),this.changeFilter()}serviceSelected(e){this.selectedService=e,this.changeFilter()}consentStatusSelected(){this.selectedConsentStatuses=this.statuses.value,this.changeFilter()}displaySelectedStatuses(){if(this.selectedConsentStatuses.length===this.consentStatusesList.length)return"ALL";let e=this.statuses.value;return e?`${this.translate.instant("CONSENTS.STATUS_"+e[0])}  ${e.length>1?"(+"+(e.length-1).toString()+" "+(e.length===2?"other)":"others)"):""}`:""}};n.id="FacilityAllowedUsersComponent",n.\u0275fac=function(i){return new(i||n)(p(w),p(j),p(ve),p(L),p(be),p(G),p(ge),p(Se),p(W),p(O))},n.\u0275cmp=F({type:n,selectors:[["app-facility-allowed-users"]],decls:14,vars:11,consts:[[1,"page-subtitle"],[1,"filters"],[1,"me-2",3,"refresh"],[1,"me-2","filter",3,"placeholder","filter"],[3,"advancedFilter","filtersCount","changeAdvancedFilter","clearFilters"],["class","advanced-filter",4,"ngIf"],["spinner",""],[1,"position-relative","table-min-height"],[3,"attrNames","disableRouting","displayedColumns","onlyAllowed","facilityId","searchString","resourceId","serviceId","tableId","voId","consentStatuses","updateTable","loading$",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[1,"advanced-filter"],[1,"toggle","filters"],["labelPosition","before",1,"me-2",3,"ngModel","ngModelChange","change"],[1,"text-muted"],[1,"search-select",3,"vos","vo","disableAutoSelect","voSelected"],[1,"search-select",3,"resources","displayStatus","resource","disableAutoSelect","resourceSelected"],[1,"search-select",3,"services","service","disableAutoSelect","serviceSelected"],["class","search-select",4,"ngIf"],[1,"search-select"],["multiple","",3,"formControl","closed"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"attrNames","disableRouting","displayedColumns","onlyAllowed","facilityId","searchString","resourceId","serviceId","tableId","voId","consentStatuses","updateTable","loading$"]],template:function(i,r){if(i&1&&(a(0,"div")(1,"h1",0),f(2),h(3,"translate"),l(),a(4,"div",1)(5,"perun-web-apps-refresh-button",2),u("refresh",function(){return r.refreshPage()}),l(),a(6,"perun-web-apps-debounce-filter",3),u("filter",function(g){return r.applyFilter(g)}),l(),a(7,"perun-web-apps-advanced-filter",4),u("changeAdvancedFilter",function(g){return r.advancedFilter=g})("clearFilters",function(){return r.clearFilters()}),l()(),v(8,St,13,18,"div",5)(9,bt,1,0,"ng-template",null,6,E),a(11,"div",7),v(12,It,1,14,"perun-web-apps-users-dynamic-list",8),h(13,"async"),l()()),i&2){let d=T(10);o(2),I(_(3,7,"FACILITY_DETAIL.ALLOWED_USERS.TITLE")),o(4),c("placeholder","FACILITY_DETAIL.ALLOWED_USERS.FILTER"),o(),c("advancedFilter",r.advancedFilter)("filtersCount",r.filtersCount),o(),c("ngIf",r.advancedFilter),o(4),c("perunWebAppsLoader",_(13,9,r.loading$))("perunWebAppsLoaderIndicator",d)}},dependencies:[H,U,Y,Z,K,ye,Ae,Ie,q,Fe,De,M,D,Ge,We,V,He,J,je,x,_e,R],styles:[".filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:baseline}.filter[_ngcontent-%COMP%]{min-width:350px}.search-select[_ngcontent-%COMP%]{width:32%;margin-right:20px;margin-top:30px}.toggle[_ngcontent-%COMP%]{display:flex;flex-direction:column}.advanced-filter[_ngcontent-%COMP%]{border:1px solid lightgray;padding:15px}"]});let s=n;return s})();export{jt as a,ni as b,_i as c,Gi as d};
