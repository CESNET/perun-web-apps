import{a as fo}from"./chunk-MY7QEWAH.js";import{c as go,d as ho,f as So}from"./chunk-LOQGZPHC.js";import{b as Jt}from"./chunk-NMYZ7ZF4.js";import{a as Zt}from"./chunk-XJDSBCII.js";import{$a as ue,$b as pt,$c as Pi,$e as qi,$g as io,Aa as Se,Ac as Fe,Ad as Gt,Ag as li,Ba as ve,Bd as ze,Bg as eo,Ca as b,Cc as We,Cg as to,Da as S,Dc as x,Ea as u,Ec as y,Ee as Yi,Ei as ao,Fa as Ti,Fd as $e,Fi as so,G as fi,Ga as Mi,Gd as Fi,Ge as Bt,Gi as lo,He as Nt,Hh as qt,I as Si,Ia as st,Id as Wi,Ii as di,Ja as lt,Jc as ne,Jd as Lt,Ji as co,K as vi,Ka as ct,La as w,Ma as Re,Mb as qe,Mc as Ze,N as Ci,Na as F,Nc as Li,Nd as V,Oa as d,Pa as M,Pc as Vi,Pd as Hi,Pi as po,Qa as f,Qc as yt,Qe as Pt,Qf as k,Ra as Ye,Rb as Qe,Rc as Bi,Rd as zi,Re as Ut,S as g,Sa as Ii,Sb as ni,Sc as Ni,Se as jt,T as h,Tb as ge,Tc as He,Td as Vt,Te as kt,Ti as mo,Ua as ee,Uc as wt,Ue as Ft,Uf as Zi,V as Ri,Va as te,Ve as Wt,Vi as uo,W as bi,Wa as ie,We as Ht,Wi as _o,Xa as se,Xb as Oi,Xc as be,Xh as ae,Ya as pe,Yb as It,Yc as Je,Za as Tt,Zb as Ke,Zc as Ae,Zf as X,Zg as ci,_ as Ai,_a as de,_c as et,_e as Ce,_f as zt,_h as Qt,aa as n,ad as tt,ae as gt,ah as pi,bd as Ot,c as _i,ca as vt,cd as B,d as _e,db as c,dd as O,eb as p,ee as $i,fb as bt,fc as Gi,fd as dt,fe as Me,fh as oo,ga as l,gb as Di,gd as mt,ge as U,gf as Qi,gh as no,ha as I,hd as ut,he as W,id as _t,ie as H,jb as G,jc as Xe,jd as Ee,je as Ie,jg as si,k as gi,kb as Mt,kc as he,kd as Te,ke as z,ki as Kt,l as hi,la as Ei,ld as re,le as $,ma as R,mc as Dt,md as me,me as Y,nc as xt,ne as q,nf as Q,nh as Yt,oa as oi,oc as P,pa as Ct,pb as xi,pc as we,qb as yi,qc as Oe,qf as Ki,qi as Xt,ra as A,rb as wi,rc as Ge,rf as Xi,sa as E,sc as Le,sf as ri,ta as Rt,tc as Ve,tf as ai,ua as xe,ub as D,uc as Be,ud as it,va as ye,vc as Ne,vd as ot,wa as _,wc as Pe,wd as Ui,wg as ht,wh as nt,xa as r,xc as Ue,xd as ji,xh as De,ya as a,yc as je,yd as L,yg as Ji,yh as ro,za as C,zc as ke,zd as ki,zg as $t}from"./chunk-Q6VFHOR5.js";var ei=(()=>{class t{constructor(){this.entityDetailChange=new vt}reloadEntityDetail(){this.entityDetailChange.emit()}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275prov=Ci({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Co=(t=class{})=>class extends t{constructor(){super(...arguments),this.destroyed$=new _i}ngOnDestroy(){this.destroyed$.next()}};var ko=()=>({color:"black"}),Ro=t=>[t],bo=t=>["/organizations",t],Ao=t=>["/facilities",t];function Fo(t,m){t&1&&C(0,"mat-spinner",1)}function Wo(t,m){if(t&1){let e=b();r(0,"button",12),c(1,"translate"),S("click",function(){g(e);let i=u(2);return h(i.editResource())}),r(2,"mat-icon"),d(3,"edit"),a()()}t&2&&_("matTooltip",se(p(1,2,"RESOURCE_DETAIL.EDIT")))}function Ho(t,m){if(t&1){let e=b();r(0,"button",13),c(1,"translate"),S("click",function(){g(e);let i=u(2);return h(i.deleteResource())}),r(2,"mat-icon"),d(3,"delete_forever"),a()()}t&2&&_("matTooltip",se(p(1,2,"RESOURCE_DETAIL.DELETE")))}function zo(t,m){if(t&1){let e=b();r(0,"a",6),S("auxclick",function(i){return g(e),h(i.preventDefault())}),d(1),a()}if(t&2){let e=u(2);_("perunWebAppsMiddleClickRouterLink",ue(4,bo,e.resource.vo.id.toString()))("routerLink",ue(6,bo,e.resource.vo.id)),Ct("data-cy",e.resource.vo.name),n(),M(e.resource.vo.name)}}function $o(t,m){if(t&1&&(r(0,"span"),d(1),a()),t&2){let e=u(2);n(),f(" ",e.resource.vo.name," ")}}function Yo(t,m){if(t&1){let e=b();r(0,"a",6),S("auxclick",function(i){return g(e),h(i.preventDefault())}),d(1),a()}if(t&2){let e=u(2);_("perunWebAppsMiddleClickRouterLink",ue(4,Ao,e.resource.facilityId.toString()))("routerLink",ue(6,Ao,e.resource.facilityId)),Ct("data-cy",e.resource.facility.name),n(),M(e.resource.facility.name)}}function qo(t,m){if(t&1&&(r(0,"span"),d(1),a()),t&2){let e=u(2);n(),f(" ",e.resource.facility.name," ")}}function Qo(t,m){if(t&1){let e=b();r(0,"div")(1,"div",2),C(2,"mat-icon",3),c(3,"translate"),r(4,"div",4)(5,"div",5)(6,"a",6),S("auxclick",function(i){return g(e),h(i.preventDefault())}),d(7),a(),r(8,"span",7),d(9),a(),A(10,Wo,4,4,"button",8),A(11,Ho,4,4,"button",9),a(),r(12,"div"),d(13),c(14,"translate"),a(),r(15,"span",10),d(16),c(17,"translate"),c(18,"translate"),A(19,zo,2,8,"a",11),A(20,$o,2,1,"span"),d(21),c(22,"translate"),A(23,Yo,2,8,"a",11),A(24,qo,2,1,"span"),d(25),c(26,"translate"),a()()(),C(27,"app-animated-router-outlet"),a()}if(t&2){let e=u();n(2),_("matTooltip",se(p(3,22,"RESOURCE_DETAIL.ENTITY")))("ngStyle",de(34,ko)),n(4),_("perunWebAppsMiddleClickRouterLink",ue(35,Ro,e.baseUrl))("routerLink",ue(37,Ro,e.baseUrl)),n(),f(" ",e.resource.name," "),n(2),f(" \xA0#",e.resource.id," "),n(),E(e.editResourceAuth?10:-1),n(),E(e.deleteAuth?11:-1),n(2),Ye("",p(14,24,"RESOURCE_DETAIL.UUID"),": ",e.resource.uuid),n(3),Ye(" ",p(17,26,"RESOURCE_DETAIL.ENTITY"),", ",p(18,28,"RESOURCE_DETAIL.VO"),": "),n(3),E(e.voLinkAuth?19:-1),n(),E(e.voLinkAuth?-1:20),n(),Ye(" #",e.resource.voId,", ",p(22,30,"RESOURCE_DETAIL.FACILITY"),": "),n(2),E(e.facilityLinkAuth?23:-1),n(),E(e.facilityLinkAuth?-1:24),n(),Ii(" #",e.resource.facilityId,", ",p(26,32,"RESOURCE_DETAIL.DESCRIPTION"),": ",e.resource.description," ")}}var bs=(()=>{class t extends Co(){constructor(e,o,i,s,v,T,N,J,fe,at,St){super(),this.route=e,this.facilityManager=o,this.vosManagerService=i,this.resourcesManager=s,this.sideMenuService=v,this.sideMenuItemService=T,this.dialog=N,this.guiAuthResolver=J,this.router=fe,this.entityStorageService=at,this.reloadEntityDetail=St,this.underVoUrl=!1,this.deleteAuth=!1,this.baseUrl="",this.loading=!1}ngOnInit(){this.reloadData(),this.reloadEntityDetail.entityDetailChange.pipe(Si(this.destroyed$)).subscribe(()=>{this.reloadData()})}reloadData(){this.loading=!0,this.route.params.subscribe(e=>{let o=Number(e.resourceId);this.resourcesManager.getRichResourceById(o).subscribe(i=>{this.resource=i,this.entityStorageService.setEntityAndPathParam({id:i.id,voId:i.voId,facilityId:i.facilityId,beanName:"Resource"},$i.Resource),this.setAuth(),this.route.parent.snapshot.url[0].path==="facilities"?(this.baseUrl=new si().transform(i,!1),this.facilityManager.getFacilityById(i.facilityId).subscribe(s=>{this.facility=s,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)):(this.baseUrl=new si().transform(i,!0),this.vosManagerService.getVoById(i.voId).subscribe(s=>{this.vo=s,this.underVoUrl=!0,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)),Qi("resources",this.resource)})})}setMenuItems(){let e,o=this.sideMenuItemService.parseResource(this.resource,this.underVoUrl);this.underVoUrl?(e=this.sideMenuItemService.parseVo(this.vo),this.sideMenuService.setAccessMenuItems([e,o])):(e=this.sideMenuItemService.parseFacility(this.facility),this.sideMenuService.setFacilityMenuItems([e,o]))}editResource(){let e;this.resourcesManager.getResourceById(this.resource.id).subscribe(o=>{e=o;let i=Q();i.width="450px",i.data={theme:"resource-theme",resource:e,dialogType:oo.RESOURCE},this.dialog.open(no,i).afterClosed().subscribe(v=>{v&&this.resourcesManager.getRichResourceById(this.resource.id).subscribe(T=>{this.resource=T,this.setMenuItems()})})})}deleteResource(){let e=Q();e.width="500px",e.data={theme:"resource-theme",resources:[this.resource]},this.dialog.open(fo,e).afterClosed().subscribe(i=>{i&&this.router.navigate(["../"],{relativeTo:this.route,queryParamsHandling:"preserve"})})}setAuth(){this.facilityLinkAuth=this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.resource]),this.editResourceAuth=this.guiAuthResolver.isAuthorized("updateResource_Resource_policy",[this.resource]),this.voLinkAuth=this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.resource]),this.deleteAuth=this.guiAuthResolver.isAuthorized("deleteResource_Resource_policy",[this.resource])}static{this.\u0275fac=function(o){return new(o||t)(l(ne),l(Wi),l(Vt),l(V),l(uo),l(_o),l(Ie),l(U),l(Ze),l(X),l(ei))}}static{this.\u0275cmp=I({type:t,selectors:[["app-resource-detail-page"]],features:[Ei],decls:4,vars:2,consts:[[1,"container-fluid","ps-xl-5","pe-xl-5","resource-theme"],[1,"me-auto","ms-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-resource-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"resource-link",3,"auxclick","perunWebAppsMiddleClickRouterLink","routerLink"],[1,"text-muted"],["aria-label","Edit resource","mat-icon-button","",3,"matTooltip"],["mat-icon-button","",3,"matTooltip"],[1,"mt-1","entity-info"],[1,"resource-link",3,"perunWebAppsMiddleClickRouterLink","routerLink"],["aria-label","Edit resource","mat-icon-button","",3,"click","matTooltip"],["mat-icon-button","",3,"click","matTooltip"]],template:function(o,i){o&1&&(r(0,"div",0),C(1,"perun-web-apps-back-button"),A(2,Fo,1,0,"mat-spinner",1),A(3,Qo,28,39,"div"),a()),o&2&&(n(2),E(i.loading?2:-1),n(),E(!i.loading&&i.resource!==void 0?3:-1))},dependencies:[D,xi,O,Ot,_t,ut,ji,mo,ro,ki,Zt,Vi,Li,mt,dt,y,qe,x],styles:[".break-line[_ngcontent-%COMP%]{display:inline-block}"],data:{animation:[Kt]}})}}return t})();function Ko(t,m){t&1&&C(0,"mat-spinner",0)}function Xo(t,m){if(t&1&&(r(0,"div"),C(1,"perun-web-apps-menu-buttons-field",1)(2,"perun-web-apps-expandable-tiles",2),a()),t&2){let e=u();n(),_("items",e.items),n(),_("items",e.settingsItems)("title","MENU_ITEMS.RESOURCE.SETTINGS")("sectionId","settings")}}var Gs=(()=>{class t{constructor(e,o,i,s,v){this.resourcesManager=e,this.route=o,this.guiAuthResolver=i,this.entityStorageService=s,this.routePolicyService=v,this.items=[],this.settingsItems=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity();let e=this.route.parent.parent.snapshot.url[0].path==="facilities";this.setItems(e),this.setSettingsItems(e),this.loading=!1}setItems(e){let o=e?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`;this.items=[],this.routePolicyService.canNavigate("resources-groups",this.resource)&&this.items.push({cssIcon:"perun-group",url:`${o}/resources/${this.resource.id}/groups`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_GROUPS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-services",this.resource)&&this.items.push({cssIcon:"perun-service",url:`${o}/resources/${this.resource.id}/services`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_SERVICES",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-members",this.resource)&&this.items.push({cssIcon:"perun-user",url:`${o}/resources/${this.resource.id}/members`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_MEMBERS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-tags",this.resource)&&this.items.push({cssIcon:"perun-resource-tags",url:`${o}/resources/${this.resource.id}/tags`,label:"MENU_ITEMS.RESOURCE.RESOURCE_TAGS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-attributes",this.resource)&&this.items.push({cssIcon:"perun-attributes",url:`${o}/resources/${this.resource.id}/attributes`,label:"MENU_ITEMS.RESOURCE.ATTRIBUTES",style:"resource-btn"})}setSettingsItems(e){this.settingsItems=[],this.routePolicyService.canNavigate("resources-settings-managers",this.resource)&&this.settingsItems.push({cssIcon:"perun-manager",url:`${e?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/managers`,label:"MENU_ITEMS.RESOURCE.MANAGERS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-settings-bans",this.resource)&&this.settingsItems.push({cssIcon:"perun-ban",url:`${e?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/bans`,label:"MENU_ITEMS.RESOURCE.BANS",style:"resource-btn"})}static{this.\u0275fac=function(o){return new(o||t)(l(V),l(ne),l(U),l(X),l(zt))}}static{this.\u0275cmp=I({type:t,selectors:[["app-resource-overview"]],hostVars:2,hostBindings:function(o,i){o&2&&Re("router-component",i.true)},decls:2,vars:2,consts:[[1,"me-auto","ms-auto"],[3,"items"],[3,"items","title","sectionId"]],template:function(o,i){o&1&&(A(0,Ko,1,0,"mat-spinner",0),A(1,Xo,3,4,"div")),o&2&&(E(i.loading?0:-1),n(),E(i.loading?-1:1))},dependencies:[D,qt,po,mt,dt],encapsulation:2})}}return t})();function Zo(t,m){t&1&&C(0,"perun-web-apps-loading-dialog")}function Jo(t,m){t&1&&C(0,"th",14)}function en(t,m){if(t&1&&(r(0,"td",15),d(1),a()),t&2){let e=m.$implicit;n(),M(e.name)}}function tn(t,m){t&1&&C(0,"tr",16)}function on(t,m){t&1&&C(0,"tr",17)}function nn(t,m){if(t&1){let e=b();r(0,"div")(1,"h1",2),d(2),c(3,"translate"),a(),r(4,"div",3)(5,"p"),d(6),c(7,"translate"),a(),r(8,"div",4),d(9),c(10,"translate"),a(),r(11,"table",5),Se(12,6),R(13,Jo,1,0,"th",7)(14,en,2,1,"td",8),ve(),R(15,tn,1,0,"tr",9)(16,on,1,0,"tr",10),a()(),r(17,"div",11)(18,"button",12),S("click",function(){g(e);let i=u();return h(i.onCancel())}),d(19),c(20,"translate"),a(),r(21,"button",13),S("click",function(){g(e);let i=u();return h(i.onSubmit())}),d(22),c(23,"translate"),a()()()}if(t&2){let e=u();n(2),M(p(3,9,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.TITLE")),n(4),f(" ",p(7,11,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DESCRIPTION")," "),n(3),f(" ",p(10,13,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.ASK")," "),n(2),_("dataSource",e.dataSource),n(4),_("matHeaderRowDef",e.displayedColumns),n(),_("matRowDefColumns",e.displayedColumns),n(3),f(" ",p(20,15,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.CANCEL")," "),n(2),_("disabled",e.loading),n(),f(" ",p(23,17,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DELETE")," ")}}var Io=(()=>{class t{constructor(e,o,i,s,v){this.dialogRef=e,this.data=o,this.notificator=i,this.translate=s,this.resourceManager=v,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.dataSource=new Fe(this.data.groups)}onCancel(){this.dialogRef.close()}onSubmit(){let e=[];for(let o of this.data.groups)e.push(o.id);this.loading=!0,this.resourceManager.removeGroupsFromResource(e,this.data.resourceId).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUP_FROM_RESOURCE.SUCCESS").subscribe(o=>{this.notificator.showSuccess(o),this.dialogRef.close(!0)})},()=>this.loading=!1)}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(k),l(We),l(V))}}static{this.\u0275cmp=I({type:t,selectors:[["app-perun-web-apps-remove-group-from-resource-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","","data-cy","delete-button",1,"ms-2",3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(o,i){if(o&1&&(R(0,Zo,1,0,"ng-template",null,0,G),r(2,"div"),R(3,nn,24,19,"div",1),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,q,z,Y,$,me,ke,we,Ge,Ne,Le,Oe,Pe,Ve,Be,Ue,je,y,L,x],encapsulation:2})}}return t})();var an=["stepper"],sn=()=>["select","id","name","description"];function ln(t,m){t&1&&C(0,"perun-web-apps-loading-dialog")}function cn(t,m){t&1&&(d(0),c(1,"translate")),t&2&&M(p(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.GROUPS"))}function pn(t,m){t&1&&(d(0),c(1,"translate")),t&2&&M(p(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.OPTIONS"))}function dn(t,m){if(t&1){let e=b();r(0,"div",4)(1,"mat-stepper",6,1)(3,"mat-step",7),R(4,cn,2,3,"ng-template",8),r(5,"perun-web-apps-debounce-filter",9),c(6,"translate"),S("filter",function(i){g(e);let s=u(2);return h(s.applyFilter(i))}),a(),C(7,"perun-web-apps-groups-list",10),a(),r(8,"mat-step"),R(9,pn,2,3,"ng-template",8),r(10,"mat-slide-toggle",11),S("toggleChange",function(){g(e);let i=u(2);return h(i.changeSubgroupsMessage())}),ie("ngModelChange",function(i){g(e);let s=u(2);return te(s.autoAssignSubgroups,i)||(s.autoAssignSubgroups=i),h(i)}),d(11),c(12,"translate"),a(),r(13,"div",12),C(14,"i",13),a(),r(15,"mat-slide-toggle",11),S("toggleChange",function(){g(e);let i=u(2);return h(i.changeInactiveMessage())}),ie("ngModelChange",function(i){g(e);let s=u(2);return te(s.asActive,i)||(s.asActive=i),h(i)}),d(16),c(17,"translate"),a(),r(18,"div",12),d(19),a(),r(20,"mat-slide-toggle",11),S("toggleChange",function(){g(e);let i=u(2);return h(i.changeAsyncMessage())}),ie("ngModelChange",function(i){g(e);let s=u(2);return te(s.async,i)||(s.async=i),h(i)}),d(21),c(22,"translate"),a(),r(23,"div",12),d(24),a()()()()}if(t&2){let e=u(2);n(),_("linear",!0),n(2),_("completed",e.selection.selected.length!==0&&e.canAddGroups()),n(2),_("placeholder",se(p(6,20,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.FILTER_DESCRIPTION"))),n(2),_("loading",e.loading)("disableMembers",!1)("groups",e.unAssignedGroups)("selection",e.selection)("disableRouting",!0)("displayColumns",de(28,sn))("filter",e.filterValue),n(3),ee("ngModel",e.autoAssignSubgroups),n(),f(" ",p(12,22,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS")," "),n(3),_("innerHTML",e.autoAssignHint,Ai),n(),ee("ngModel",e.asActive),n(),f(" ",p(17,24,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AS_ACTIVE")," "),n(3),f(" ",e.asActiveHint," "),n(),ee("ngModel",e.async),n(),f(" ",p(22,26,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OPT")," "),n(3),f(" ",e.asyncHint," ")}}function mn(t,m){if(t&1){let e=b();r(0,"button",18),S("click",function(){g(e);let i=u(3);return h(i.stepperPrevious())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.BACK")," "))}function un(t,m){if(t&1){let e=b();r(0,"button",19),S("click",function(){g(e);let i=u(3);return h(i.stepperNext())}),d(1),c(2,"translate"),a()}if(t&2){let e=u(3);Re("ms-2",e.stepper!==void 0&&e.stepper.selectedIndex!==0)("ms-auto",!(e.stepper!==void 0&&e.stepper.selectedIndex!==0)),_("disabled",e.loading||e.selection.selected.length===0||!e.canAddGroups()),n(),f(" ",p(2,6,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.NEXT")," ")}}function _n(t,m){if(t&1){let e=b();r(0,"button",20),S("click",function(){g(e);let i=u(3);return h(i.onAdd())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ADD_BUTTON")," "))}function gn(t,m){if(t&1){let e=b();r(0,"div",5)(1,"div")(2,"button",14),S("click",function(){g(e);let i=u(2);return h(i.onCancel())}),d(3),c(4,"translate"),a(),A(5,mn,3,3,"button",15),A(6,un,3,8,"button",16),A(7,_n,3,3,"button",17),a()()}if(t&2){let e=u(2);n(3),f(" ",p(4,4,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.CANCEL_BUTTON")," "),n(2),E(e.stepper!==void 0&&e.stepper.selectedIndex!==0?5:-1),n(),E(e.stepper!==void 0&&e.stepper.selectedIndex!==e.stepper._steps.length-1?6:-1),n(),E(e.stepper!==void 0&&e.stepper.selectedIndex===e.stepper._steps.length-1?7:-1)}}function hn(t,m){if(t&1&&(r(0,"div")(1,"h1",3),d(2),c(3,"translate"),a(),A(4,dn,25,29,"div",4),A(5,gn,8,6,"div",5),a()),t&2){let e=u();n(2),M(p(3,3,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.TITLE")),n(2),E(e.unAssignedGroups?4:-1),n(),E(e.stepper?5:-1)}}var Do=(()=>{class t{constructor(e,o,i,s,v,T,N,J){this.dialogRef=e,this.data=o,this.notificator=i,this.translate=s,this.resourceManager=v,this.groupService=T,this.guiAuthResolver=N,this.cd=J,this.loading=!1,this.unAssignedGroups=null,this.async=!0,this.autoAssignSubgroups=!1,this.asActive=!0,this.selection=new P(!0,[],!0,(fe,at)=>fe.id===at.id),this.filterValue=""}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resource=this.data.resource,this.autoAssignHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT"),this.asActiveHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT"),this.asyncHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT"),this.resourceManager.getAssignedGroups(this.resource.id).subscribe({next:e=>{this.groupService.getAllGroups(this.resource.voId).subscribe({next:o=>{this.unAssignedGroups=this.data.onlyAutoAssignedGroups;for(let i of o)e.findIndex(s=>s.id===i.id)===-1&&this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,i])&&this.unAssignedGroups.push(i);this.loading=!1,this.cd.detectChanges()},error:()=>this.loading=!1})},error:()=>this.loading=!1})}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0;let e=[];for(let o of this.selection.selected)e.push(o.id);this.resourceManager.assignGroupsToResource(e,this.resource.id,this.async,!this.asActive,this.autoAssignSubgroups).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.SUCCESS_MESSAGE").subscribe(o=>{this.notificator.showSuccess(o),this.dialogRef.close(!0)})},()=>this.loading=!1)}applyFilter(e){this.filterValue=e,this.selection.clear()}canAddGroups(){let e=!0;return this.selection.selected.forEach(o=>{this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,o])||(e=!1)}),e}changeSubgroupsMessage(){this.autoAssignHint=this.autoAssignSubgroups?this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT"):this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_ON_HINT")}changeInactiveMessage(){this.asActiveHint=this.asActive?this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_OFF_HINT"):this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT")}changeAsyncMessage(){this.asyncHint=this.async?this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OFF_HINT"):this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT")}stepperPrevious(){this.stepper.previous()}stepperNext(){this.stepper.next()}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(k),l(We),l(V),l(Lt),l(U),l(Mt))}}static{this.\u0275cmp=I({type:t,selectors:[["app-perun-web-apps-assign-group-to-resource-dialog"]],viewQuery:function(o,i){if(o&1&&st(an,5),o&2){let s;lt(s=ct())&&(i.stepper=s.first)}},decls:4,vars:5,consts:[["spinner",""],["stepper",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],["mat-dialog-actions","",1,"justify-content-end"],[3,"linear"],[3,"completed"],["matStepLabel",""],[3,"filter","placeholder"],[3,"loading","disableMembers","groups","selection","disableRouting","displayColumns","filter"],["labelPosition","before",1,"mt-3","slide-text",3,"toggleChange","ngModelChange","ngModel"],[1,"text-muted","new-line","mt-2"],[3,"innerHTML"],["mat-stroked-button","",1,"me-2",3,"click"],["mat-stroked-button","",1,"ms-auto"],["color","accent","mat-flat-button","","type","button","data-cy","next-button",3,"ms-2","ms-auto","disabled"],["color","accent","mat-flat-button","","type","button","data-cy","assign-button",1,"ms-2"],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","","type","button","data-cy","next-button",3,"click","disabled"],["color","accent","mat-flat-button","","type","button","data-cy","assign-button",1,"ms-2",3,"click"]],template:function(o,i){if(o&1&&(R(0,ln,1,0,"ng-template",null,0,G),r(2,"div"),R(3,hn,6,5,"div",2),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,Ht,Wt,Xe,ge,Ke,he,q,z,Y,$,me,ae,y,nt,Yi,L,Bt,Nt,x],styles:[".slide-text[_ngcontent-%COMP%]{font-size:1.1rem}"]})}}return t})();var xo=t=>[t],fn=()=>["select","id","indirectGroupAssigment","name","status","description"];function Sn(t,m){if(t&1){let e=b();r(0,"button",9),S("click",function(){g(e);let i=u();return h(i.addGroup())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"RESOURCE_DETAIL.ASSIGNED_GROUPS.ADD_GROUP")," "))}function vn(t,m){t&1&&C(0,"perun-web-apps-loading-table")}function Cn(t,m){if(t&1){let e=b();r(0,"perun-web-apps-groups-list",10),S("refreshTable",function(){g(e);let i=u();return h(i.loadAllGroups())}),a()}if(t&2){let e=u();_("loading",e.loading)("disableGroups",!0)("groupsToDisableCheckbox",e.groupsToDisable)("disableMembers",!1)("groups",e.assignedGroups)("disableRouting",e.assignedGroups[0]?!e.guiAuthResolver.isAuthorized("getGroupById_int_policy",ue(11,xo,e.assignedGroups[0])):!1)("displayColumns",de(13,fn))("filter",e.filteredValue)("resourceId",e.resource.id)("selection",e.selected)("cacheSubject",e.cacheSubject)}}var Gl=(()=>{class t{constructor(e,o,i,s,v){this.route=e,this.resourcesManager=o,this.dialog=i,this.guiAuthResolver=s,this.entityStorageService=v,this.assignedGroups=[],this.selected=new P(!0,[],!0,(T,N)=>T.id===N.id),this.filteredValue="",this.cacheSubject=new _e(!0)}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.loadAllGroups()}loadAllGroups(){this.loading=!0,this.resourcesManager.getGroupAssignments(this.resource.id,[Ce.GROUP_SYNC_ENABLED]).subscribe(e=>{this.assignedGroups=e.map(v=>{let T=v.enrichedGroup.group;return T.status=v.status,T.failureCause=v.failureCause,T.sourceGroupId=v.sourceGroupId,T});let o=this.assignedGroups.map(v=>v.id),i=this.assignedGroups.filter((v,T)=>o.indexOf(v.id)===T),s=this.assignedGroups.filter((v,T)=>{let N=o.indexOf(v.id);return N!==T&&(v.sourceGroupId===null||this.assignedGroups[N].sourceGroupId===null)}).map(v=>v.id);i.forEach(v=>{s.includes(v.id)&&(v.moreTypesOfAssignment=!0)}),this.assignedGroups=i,this.groupsToDisable=new Set(this.assignedGroups.filter(v=>!!v.sourceGroupId&&!v.moreTypesOfAssignment).map(v=>v.id)),this.cacheSubject.next(!0),this.selected.clear(),this.loading=!1})}addGroup(){let e=Q();e.width="1000px",e.data={theme:"resource-theme",resource:this.resource,onlyAutoAssignedGroups:this.assignedGroups.filter(i=>this.groupsToDisable.has(i.id))},this.dialog.open(Do,e).afterClosed().subscribe(i=>{i&&this.loadAllGroups()})}removeGroups(){let e=Q();e.width="500px",e.data={resourceId:this.resource.id,groups:this.selected.selected,theme:"resource-theme"},this.dialog.open(Io,e).afterClosed().subscribe(i=>{i&&this.loadAllGroups()})}canRemoveGroups(){let e=!0;return this.selected.selected.forEach(o=>{this.guiAuthResolver.isAuthorized("removeGroupsFromResource_List<Group>_Resource_policy",[this.resource,o])||(e=!1)}),e}applyFilter(e){this.filteredValue=e}static{this.\u0275fac=function(o){return new(o||t)(l(ne),l(V),l(Ie),l(U),l(X))}}static{this.\u0275cmp=I({type:t,selectors:[["app-perun-web-apps-resource-groups"]],decls:15,vars:18,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","","data-cy","add-group-button",1,"action-button"],["color","warn","mat-flat-button","","data-cy","remove-group-button",1,"ms-2","me-2",3,"click","disabled"],[3,"matTooltipDisabled","matTooltip"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","disableGroups","groupsToDisableCheckbox","disableMembers","groups","disableRouting","displayColumns","filter","resourceId","selection","cacheSubject","refreshTable",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","","data-cy","add-group-button",1,"action-button",3,"click"],[3,"refreshTable","loading","disableGroups","groupsToDisableCheckbox","disableMembers","groups","disableRouting","displayColumns","filter","resourceId","selection","cacheSubject"]],template:function(o,i){if(o&1){let s=b();r(0,"h1",1),d(1),c(2,"translate"),a(),r(3,"perun-web-apps-refresh-button",2),S("refresh",function(){return g(s),h(i.loadAllGroups())}),a(),A(4,Sn,3,3,"button",3),r(5,"button",4),S("click",function(){return g(s),h(i.removeGroups())}),r(6,"span",5),c(7,"translate"),d(8),c(9,"translate"),a()(),r(10,"perun-web-apps-debounce-filter",6),S("filter",function(T){return g(s),h(i.applyFilter(T))}),a(),R(11,vn,1,0,"ng-template",null,0,G),r(13,"div",7),R(14,Cn,1,14,"perun-web-apps-groups-list",8),a()}if(o&2){let s=w(12);n(),M(p(2,10,"RESOURCE_DETAIL.ASSIGNED_GROUPS.TITLE")),n(3),E(i.guiAuthResolver.isAuthorized("getAllGroups_Vo_policy",ue(16,xo,i.resource))?4:-1),n(),_("disabled",i.loading||i.selected.selected.length===0||!i.canRemoveGroups()),n(),_("matTooltip",se(p(7,12,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_TOOLTIP")))("matTooltipDisabled",i.canRemoveGroups()),n(2),f(" ",p(9,14,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_GROUP")," "),n(2),_("placeholder","RESOURCE_DETAIL.ASSIGNED_GROUPS.FILTER_GROUPS"),n(4),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,ae,De,y,qe,nt,L,re,x],encapsulation:2})}}return t})();var Pl=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275cmp=I({type:t,selectors:[["app-resource-settings"]],hostVars:2,hostBindings:function(o,i){o&2&&Re("router-component",i.true)},decls:1,vars:0,template:function(o,i){o&1&&C(0,"app-animated-router-outlet")},dependencies:[D,Zt],encapsulation:2,data:{animation:[Kt]}})}}return t})();function Rn(t,m){t&1&&C(0,"mat-spinner",0)}function bn(t,m){if(t&1&&(r(0,"div"),C(1,"perun-web-apps-menu-buttons-field",1),a()),t&2){let e=u();n(),_("items",e.items)}}var Ql=(()=>{class t{constructor(e,o,i,s,v){this.route=e,this.resourceManager=o,this.authResolver=i,this.entityStorageService=s,this.routePolicyService=v,this.items=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.route.parent.parent.parent.snapshot.url[0].path==="facilities"?this.initItems(!1):this.initItems(!0),this.loading=!1}initItems(e){this.items=[],this.routePolicyService.canNavigate("resources-settings-managers",this.resource)&&this.items.push({cssIcon:"perun-manager",url:`${e?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/managers`,label:"MENU_ITEMS.RESOURCE.MANAGERS",style:"resource-btn"}),this.routePolicyService.canNavigate("resources-settings-bans",this.resource)&&this.items.push({cssIcon:"perun-ban",url:`${e?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/bans`,label:"MENU_ITEMS.RESOURCE.BANS",style:"resource-btn"})}static{this.\u0275fac=function(o){return new(o||t)(l(ne),l(V),l(U),l(X),l(zt))}}static{this.\u0275cmp=I({type:t,selectors:[["app-resource-settings-overview"]],hostVars:2,hostBindings:function(o,i){o&2&&Re("router-component",i.true)},decls:2,vars:2,consts:[[1,"me-auto","ms-auto"],[3,"items"]],template:function(o,i){o&1&&(A(0,Rn,1,0,"mat-spinner",0),A(1,bn,2,1,"div")),o&2&&(E(i.loading?0:-1),n(),E(i.loading?-1:1))},dependencies:[D,qt,mt,dt],encapsulation:2})}}return t})();function En(t,m){t&1&&(d(0),c(1,"translate")),t&2&&f(" ",p(1,1,"RESOURCE_DETAIL.ENTITY")," ")}function Tn(t,m){if(t&1&&C(0,"app-one-entity-attribute-page",4),t&2){let e=u();_("entityId",e.resource.id)("entity","resource")}}function Mn(t,m){t&1&&(d(0),c(1,"translate"),c(2,"translate")),t&2&&Ye(" ",p(1,2,"RESOURCE_DETAIL.ENTITY")," - ",p(2,4,"MEMBER_DETAIL.ENTITY")," ")}function In(t,m){if(t&1&&C(0,"app-two-entity-attribute-page",5),t&2){let e=u(2);_("firstEntity","resource")("firstEntityId",e.resource.id)("secondEntity","member")}}function Dn(t,m){t&1&&(r(0,"mat-tab"),R(1,Mn,3,6,"ng-template",2)(2,In,1,3,"ng-template",3),a())}function xn(t,m){t&1&&(d(0),c(1,"translate"),c(2,"translate")),t&2&&Ye(" ",p(1,2,"RESOURCE_DETAIL.ENTITY")," - ",p(2,4,"GROUP_DETAIL.ENTITY")," ")}function yn(t,m){if(t&1&&C(0,"app-two-entity-attribute-page",5),t&2){let e=u(2);_("firstEntity","resource")("firstEntityId",e.resource.id)("secondEntity","group")}}function wn(t,m){t&1&&(r(0,"mat-tab"),R(1,xn,3,6,"ng-template",2)(2,yn,1,3,"ng-template",3),a())}var sc=(()=>{class t{constructor(e,o,i){this.authResolver=e,this.resourceManager=o,this.entityStorageService=i}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.resourceGroupAttAuth=this.authResolver.isAuthorized("getGroupAssignments_Resource_policy",[this.resource]),this.resourceMemberAttAuth=this.authResolver.isAuthorized("getAssignedMembersWithStatus_Resource_policy",[this.resource])}static{this.\u0275fac=function(o){return new(o||t)(l(U),l(V),l(X))}}static{this.\u0275cmp=I({type:t,selectors:[["app-resource-attributes"]],hostVars:2,hostBindings:function(o,i){o&2&&Re("router-component",i.true)},decls:10,vars:5,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false"],["matTabLabel",""],["matTabContent",""],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(o,i){o&1&&(r(0,"div")(1,"h1",0),d(2),c(3,"translate"),a(),r(4,"mat-tab-group",1)(5,"mat-tab"),R(6,En,2,3,"ng-template",2)(7,Tn,1,2,"ng-template",3),a(),A(8,Dn,3,0,"mat-tab"),A(9,wn,3,0,"mat-tab"),a()()),o&2&&(n(2),M(p(3,3,"RESOURCE_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),n(6),E(i.resourceMemberAttAuth?8:-1),n(),E(i.resourceGroupAttAuth?9:-1))},dependencies:[D,go,ho,Ft,Pt,Ut,jt,kt,y,x],encapsulation:2})}}return t})();var On=()=>["select","id","name","email","logins","organization"],Gn=(t,m)=>m.roleName;function Ln(t,m){if(t&1&&(r(0,"mat-option",6),d(1),c(2,"displayedRole"),a()),t&2){let e=m.$implicit;_("value",e.roleName),n(),f(" ",p(2,2,e)," ")}}function Vn(t,m){t&1&&C(0,"perun-web-apps-loading-table")}function Bn(t,m){if(t&1&&C(0,"perun-web-apps-users-list",15),t&2){let e=u(2);_("loading",e.loading)("disableRouting",!0)("selection",e.selection)("displayColumns",de(6,On))("users",e.users)("cacheSubject",e.cacheSubject)}}function Nn(t,m){if(t&1&&(r(0,"div",10),R(1,Bn,1,7,"perun-web-apps-users-list",14),a()),t&2){let e=u(),o=w(25);n(),_("perunWebAppsLoader",e.loading)("perunWebAppsLoaderIndicator",o)}}var yo=(()=>{class t{constructor(e,o,i,s,v,T,N,J,fe){this.dialogRef=e,this.data=o,this.authzService=i,this.usersService=s,this.translate=v,this.notificator=T,this.storeService=N,this.route=J,this.router=fe,this.selection=new P(!0,[],!0,(at,St)=>at.id===St.id),this.users=[],this.firstSearchDone=!1,this.cacheSubject=new _e(!0),this.title=this.translate.instant("DIALOGS.ADD_MANAGERS.TITLE"),this.successMessage=this.translate.instant("DIALOGS.ADD_MANAGERS.SUCCESS")}ngOnInit(){this.theme=this.data.theme,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.searchCtrl=new It("",[ni.required,ni.pattern(".*[\\S]+.*")])}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.setRoleWithUserComplementaryObject({role:this.selectedRole,users:this.selection.selected.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}onSearchByString(){if(this.searchCtrl.invalid){this.searchCtrl.markAllAsTouched();return}this.loading=!0,this.firstSearchDone=!0,this.cacheSubject.next(!0),this.selection.clear();let e=[Ce.USER_DEF_ORGANIZATION,Ce.USER_DEF_PREFERRED_MAIL];e=e.concat(this.storeService.getLoginAttributeNames()),this.usersService.findRichUsersWithAttributes(this.searchCtrl.value,e).subscribe({next:o=>{this.users=o,this.loading=!1},error:()=>this.loading=!1})}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l($e),l(zi),l(ze),l(k),l(Me),l(ne),l(Ze))}}static{this.\u0275cmp=I({type:t,selectors:[["app-add-manager-dialog"]],decls:34,vars:28,consts:[["spinner",""],["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"me-2"],[3,"valueChange","value"],[3,"value"],[1,"me-2","w-100"],["matInput","","autocomplete","false","data-cy","search-manager-input","perunWebAppsAutoFocus","",3,"keyup.enter","formControl"],["color","accent","data-cy","search-manager-button","mat-flat-button","",1,"ms-auto",3,"click","disabled"],[1,"position-relative","mt-3","table-min-height"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","data-cy","add-manager-button-dialog","mat-flat-button","",1,"ms-2",3,"click","disabled"],[3,"loading","disableRouting","selection","displayColumns","users","cacheSubject",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","disableRouting","selection","displayColumns","users","cacheSubject"]],template:function(o,i){if(o&1){let s=b();r(0,"div")(1,"h1",1),d(2),c(3,"translate"),a(),r(4,"div",2)(5,"div",3)(6,"mat-form-field",4)(7,"mat-label"),d(8),c(9,"translate"),a(),r(10,"mat-select",5),ie("valueChange",function(T){return g(s),te(i.selectedRole,T)||(i.selectedRole=T),h(T)}),xe(11,Ln,3,4,"mat-option",6,Gn),a()(),r(13,"mat-form-field",7)(14,"mat-label"),d(15),c(16,"translate"),a(),r(17,"input",8),S("keyup.enter",function(){return g(s),h(i.onSearchByString())}),a(),r(18,"mat-error"),d(19),c(20,"translate"),a()()(),r(21,"button",9),S("click",function(){return g(s),h(i.onSearchByString())}),d(22),c(23,"translate"),a(),R(24,Vn,1,0,"ng-template",null,0,G),A(26,Nn,2,2,"div",10),a(),r(27,"div",11)(28,"button",12),S("click",function(){return g(s),h(i.onCancel())}),d(29),c(30,"translate"),a(),r(31,"button",13),S("click",function(){return g(s),h(i.onSubmit())}),d(32),c(33,"translate"),a()()()}o&2&&(F(i.theme),n(2),M(p(3,14,"DIALOGS.ADD_MANAGERS.TITLE")),n(6),M(p(9,16,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),n(2),ee("value",i.selectedRole),n(),ye(i.availableRoles),n(4),M(p(16,18,"DIALOGS.ADD_MANAGERS.DESCRIPTION")),n(2),_("formControl",i.searchCtrl),n(2),f(" ",p(20,20,"DIALOGS.ADD_MANAGERS.EMPTY_SEARCH_MESSAGE")," "),n(2),_("disabled",i.loading),n(),f(" ",p(23,22,"DIALOGS.ADD_MANAGERS.SEARCH")," "),n(4),E(i.firstSearchDone?26:-1),n(3),f(" ",p(30,24,"DIALOGS.ADD_MANAGERS.CANCEL")," "),n(2),_("disabled",i.selection.selected.length===0||i.selectedRole===void 0||i.loading),n(),f(" ",p(33,26,"DIALOGS.ADD_MANAGERS.CREATE")," "))},dependencies:[D,O,B,Ae,be,He,wt,ot,it,tt,et,Je,he,Qe,ge,pt,q,z,Y,$,y,L,Xt,Ui,re,x,ht],styles:[".inline-dialog-items[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]})}}return t})();var Pn=t=>({role:t});function Un(t,m){t&1&&C(0,"perun-web-apps-loading-dialog")}function jn(t,m){if(t&1&&(r(0,"perun-web-apps-alert",4),d(1),c(2,"translate"),a()),t&2){let e=u(2);n(),f(" ",p(2,1,e.warningMessage)," ")}}function kn(t,m){if(t&1&&(r(0,"perun-web-apps-alert",4),d(1),c(2,"translate"),c(3,"translate"),a()),t&2){let e=u(2);n(),f(" ",bt(3,3,"DIALOGS.REMOVE_MANAGERS.WARNING_REMOVE_YOURSELF",ue(6,Pn,p(2,1,"ROLES."+e.data.role)))," ")}}function Fn(t,m){t&1&&C(0,"th",15)}function Wn(t,m){if(t&1&&(r(0,"td",16),d(1),a()),t&2){let e=m.$implicit;n(),Ye("",e.firstName," ",e.lastName)}}function Hn(t,m){t&1&&C(0,"tr",17)}function zn(t,m){t&1&&C(0,"tr",18)}function $n(t,m){if(t&1){let e=b();r(0,"div")(1,"h1",2),d(2),c(3,"translate"),a(),r(4,"div",3),A(5,jn,3,3,"perun-web-apps-alert",4),A(6,kn,4,8,"perun-web-apps-alert",4),r(7,"p"),d(8),c(9,"translate"),a(),r(10,"div",5),d(11),c(12,"translate"),a(),r(13,"table",6),Se(14,7),R(15,Fn,1,0,"th",8)(16,Wn,2,2,"td",9),ve(),R(17,Hn,1,0,"tr",10)(18,zn,1,0,"tr",11),a()(),r(19,"div",12)(20,"button",13),S("click",function(){g(e);let i=u();return h(i.onCancel())}),d(21),c(22,"translate"),a(),r(23,"button",14),S("click",function(){g(e);let i=u();return h(i.onSubmit())}),d(24),c(25,"translate"),a()()()}if(t&2){let e=u();n(2),M(p(3,11,"DIALOGS.REMOVE_MANAGERS.TITLE")),n(3),E(e.doLastWarning?5:-1),n(),E(e.removeSelf?6:-1),n(2),f(" ",p(9,13,"DIALOGS.REMOVE_MANAGERS.DESCRIPTION")," "),n(3),f(" ",p(12,15,"DIALOGS.REMOVE_MANAGERS.ASK")," "),n(2),_("dataSource",e.dataSource),n(4),_("matHeaderRowDef",e.displayedColumns),n(),_("matRowDefColumns",e.displayedColumns),n(3),f(" ",p(22,17,"DIALOGS.REMOVE_MANAGERS.CANCEL")," "),n(2),_("disabled",e.loading),n(),f(" ",p(25,19,"DIALOGS.REMOVE_MANAGERS.DELETE")," ")}}var wo=(()=>{class t{constructor(e,o,i,s,v,T,N){this.dialogRef=e,this.data=o,this.notificator=i,this.translate=s,this.authzService=v,this.store=T,this.authService=N,this.displayedColumns=["name"],this.doLastWarning=!1}ngOnInit(){this.loading=!0,this.dataSource=new Fe(this.data.managers),this.theme=this.data.theme,this.removeSelf=this.data.managers.map(e=>e.id).includes(this.store.getPerunPrincipal().userId)&&!this.authService.isPerunAdmin(),this.theme==="vo-theme"?this.warningMessage="DIALOGS.REMOVE_MANAGERS.WARNING_REMOVE_LAST_VO":this.theme==="facility-theme"&&(this.warningMessage="DIALOGS.REMOVE_MANAGERS.WARNING_REMOVE_LAST_FACILITY"),this.data.checkLastWarning&&(this.data.role===gt.VOADMIN||this.data.role===gt.FACILITYADMIN)?this.authzService.getAuthzAdminGroups(this.data.role.toString(),this.data.complementaryObject.id,this.data.complementaryObject.beanName).subscribe({next:e=>{this.doLastWarning=e.length===0,this.loading=!1},error:()=>{this.loading=!1}}):this.loading=!1}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithUserComplementaryObject({role:this.data.role,users:this.data.managers.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.REMOVE_MANAGERS.SUCCESS")),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(k),l(ze),l($e),l(Me),l(U))}}static{this.\u0275cmp=I({type:t,selectors:[["app-remove-manager-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],["alert_type","warn"],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","data-cy","remove-manager-button-dialog","mat-flat-button","",1,"ms-2",3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(o,i){if(o&1&&(R(0,Un,1,0,"ng-template",null,0,G),r(2,"div"),R(3,$n,26,21,"div",1),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,q,z,Y,$,Te,Ee,me,ke,we,Ge,Ne,Le,Oe,Pe,Ve,Be,Ue,je,y,L,x],encapsulation:2})}}return t})();function Yn(t,m){t&1&&C(0,"perun-web-apps-loading-dialog")}function qn(t,m){if(t&1&&(r(0,"perun-web-apps-alert",4),d(1),c(2,"translate"),a()),t&2){let e=u(2);n(),f(" ",p(2,1,e.warningMessage)," ")}}function Qn(t,m){t&1&&C(0,"th",15)}function Kn(t,m){if(t&1&&(r(0,"td",16),d(1),a()),t&2){let e=m.$implicit;n(),M(e.name)}}function Xn(t,m){t&1&&C(0,"tr",17)}function Zn(t,m){t&1&&C(0,"tr",18)}function Jn(t,m){if(t&1){let e=b();r(0,"div")(1,"h1",2),d(2),c(3,"translate"),a(),r(4,"div",3),A(5,qn,3,3,"perun-web-apps-alert",4),r(6,"p"),d(7),c(8,"translate"),a(),r(9,"div",5),d(10),c(11,"translate"),a(),r(12,"table",6),Se(13,7),R(14,Qn,1,0,"th",8)(15,Kn,2,1,"td",9),ve(),R(16,Xn,1,0,"tr",10)(17,Zn,1,0,"tr",11),a()(),r(18,"div",12)(19,"button",13),S("click",function(){g(e);let i=u();return h(i.onCancel())}),d(20),c(21,"translate"),a(),r(22,"button",14),S("click",function(){g(e);let i=u();return h(i.onSubmit())}),d(23),c(24,"translate"),a()()()}if(t&2){let e=u();n(2),M(p(3,10,"DIALOGS.REMOVE_GROUPS.TITLE")),n(3),E(e.doLastWarning?5:-1),n(2),f(" ",p(8,12,"DIALOGS.REMOVE_GROUPS.DESCRIPTION")," "),n(3),f(" ",p(11,14,"DIALOGS.REMOVE_GROUPS.ASK")," "),n(2),_("dataSource",e.dataSource),n(4),_("matHeaderRowDef",e.displayedColumns),n(),_("matRowDefColumns",e.displayedColumns),n(3),f(" ",p(21,16,"DIALOGS.REMOVE_GROUPS.CANCEL")," "),n(2),_("disabled",e.loading),n(),f(" ",p(24,18,"DIALOGS.REMOVE_GROUPS.DELETE")," ")}}var Oo=(()=>{class t{constructor(e,o,i,s,v){this.dialogRef=e,this.data=o,this.notificator=i,this.translate=s,this.authzService=v,this.displayedColumns=["name"],this.doLastWarning=!1}ngOnInit(){this.loading=!0,this.dataSource=new Fe(this.data.groups),this.theme=this.data.theme,this.theme==="vo-theme"?this.warningMessage="DIALOGS.REMOVE_GROUPS.WARNING_REMOVE_LAST_VO":this.theme==="facility-theme"&&(this.warningMessage="DIALOGS.REMOVE_GROUPS.WARNING_REMOVE_LAST_FACILITY"),this.data.doCheckLastWarning&&(this.data.role===gt.VOADMIN||this.data.role===gt.FACILITYADMIN)?this.authzService.getAuthzRichAdmins(this.data.role.toString(),this.data.complementaryObject.id,this.data.complementaryObject.beanName,[Ce.USER_DEF_ORGANIZATION],!1,!0).subscribe({next:e=>{this.doLastWarning=e.length===0,this.loading=!1},error:()=>{this.loading=!1}}):this.loading=!1}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithGroupComplementaryObject({role:this.data.role,authorizedGroups:this.data.groups.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.REMOVE_GROUPS.SUCCESS")),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(k),l(ze),l($e))}}static{this.\u0275cmp=I({type:t,selectors:[["app-remove-group-manager-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],["alert_type","warn"],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(o,i){if(o&1&&(R(0,Yn,1,0,"ng-template",null,0,G),r(2,"div"),R(3,Jn,25,20,"div",1),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,q,z,Y,$,Te,Ee,me,ke,we,Ge,Ne,Le,Oe,Pe,Ve,Be,Ue,je,y,L,x],encapsulation:2})}}return t})();var er=()=>["select","id","name","description"],tr=(t,m)=>m.roleName,ir=(t,m)=>m.id;function or(t,m){if(t&1&&(r(0,"mat-option",7),d(1),c(2,"displayedRole"),a()),t&2){let e=m.$implicit;_("value",e.roleName),n(),f(" ",p(2,2,e)," ")}}function nr(t,m){if(t&1&&(r(0,"mat-option",7),d(1),r(2,"span",16),d(3),a()()),t&2){let e=m.$implicit;_("value",e),n(),f(" ",e.name," "),n(2),M(e.shortName)}}function rr(t,m){if(t&1){let e=b();r(0,"perun-web-apps-debounce-filter",17),c(1,"translate"),S("filter",function(i){g(e);let s=u();return h(s.applyFilter(i))}),a()}t&2&&_("placeholder",se(p(1,2,"DIALOGS.ADD_GROUPS.FILTER_GROUPS")))}function ar(t,m){t&1&&C(0,"perun-web-apps-loading-table")}function sr(t,m){if(t&1&&C(0,"perun-web-apps-groups-list",19),t&2){let e=u(2);_("loading",e.loading)("disableMembers",!1)("disableRouting",!0)("displayColumns",de(7,er))("selection",e.selection)("groups",e.groups)("filter",e.filterValue)}}function lr(t,m){if(t&1&&(r(0,"div",12),R(1,sr,1,8,"perun-web-apps-groups-list",18),a()),t&2){let e=u(),o=w(26);n(),_("perunWebAppsLoader",e.loading)("perunWebAppsLoaderIndicator",o)}}var Go=(()=>{class t{constructor(e,o,i,s,v,T,N,J,fe){this.dialogRef=e,this.data=o,this.authzService=i,this.voService=s,this.groupService=v,this.translate=T,this.notificator=N,this.route=J,this.router=fe,this.searchString="",this.selection=new P(!0,[],!0,(at,St)=>at.id===St.id),this.groups=[],this.vos=[],this.filterValue="",this.myControl=new It,this.firstSearchDone=!1,this.title=this.translate.instant("DIALOGS.ADD_GROUPS.TITLE"),this.successMessage=this.translate.instant("DIALOGS.ADD_GROUPS.SUCCESS")}displayFn(e){return e?e.name:null}onCancel(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.authzService.setRoleWithGroupComplementaryObject({role:this.selectedRole,authorizedGroups:this.selection.selected.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe({next:()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},error:()=>this.loading=!1})}ngOnInit(){this.loading=!0,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.theme=this.data.theme,this.voService.getMyVos().subscribe({next:e=>{this.filteredOptions=this.myControl.valueChanges.pipe(fi(""),gi(o=>this._filter(o))),this.vos=e,this.loading=!1},error:()=>this.loading=!1})}showVoGroups(e){this.loading=!0,this.firstSearchDone=!0,this.groupService.getAllGroups(e.option.value.id).subscribe({next:o=>{this.groups=o,this.loading=!1},error:()=>this.loading=!1})}applyFilter(e){this.filterValue=e}_filter(e){let o=typeof e=="string"?e.toLowerCase():e.name.toLowerCase();return this.vos.filter(i=>i.name.toLowerCase().includes(o)||i.shortName.toLowerCase().includes(o))}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l($e),l(Vt),l(Lt),l(ze),l(k),l(ne),l(Ze))}}static{this.\u0275cmp=I({type:t,selectors:[["app-add-group-manager-dialog"]],decls:35,vars:30,consts:[["auto","matAutocomplete"],["spinner",""],["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"me-2"],[3,"valueChange","value"],[3,"value"],[1,"me-2","w-75"],["aria-label","Assignee","matInput","","type","text",3,"formControl","matAutocomplete","placeholder"],[3,"optionSelected","displayWith"],[3,"placeholder"],[1,"position-relative","mt-3","table-min-height"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"],[1,"text-muted"],[3,"filter","placeholder"],[3,"loading","disableMembers","disableRouting","displayColumns","selection","groups","filter",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","disableMembers","disableRouting","displayColumns","selection","groups","filter"]],template:function(o,i){if(o&1){let s=b();r(0,"div")(1,"h1",2),d(2),c(3,"translate"),a(),r(4,"div",3)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),d(8),c(9,"translate"),a(),r(10,"mat-select",6),ie("valueChange",function(T){return g(s),te(i.selectedRole,T)||(i.selectedRole=T),h(T)}),xe(11,or,3,4,"mat-option",7,tr),a()(),r(13,"mat-form-field",8)(14,"mat-label"),d(15),c(16,"translate"),a(),C(17,"input",9),c(18,"translate"),r(19,"mat-autocomplete",10,0),S("optionSelected",function(T){return g(s),h(i.showVoGroups(T))}),xe(21,nr,4,3,"mat-option",7,ir),c(23,"async"),a()()(),A(24,rr,2,4,"perun-web-apps-debounce-filter",11),R(25,ar,1,0,"ng-template",null,1,G),A(27,lr,2,2,"div",12),a(),r(28,"div",13)(29,"button",14),S("click",function(){return g(s),h(i.onCancel())}),d(30),c(31,"translate"),a(),r(32,"button",15),S("click",function(){return g(s),h(i.onSubmit())}),d(33),c(34,"translate"),a()()()}if(o&2){let s=w(20);F(i.theme),n(2),M(p(3,16,"DIALOGS.ADD_GROUPS.TITLE")),n(6),M(p(9,18,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),n(2),ee("value",i.selectedRole),n(),ye(i.availableRoles),n(4),M(p(16,20,"DIALOGS.ADD_GROUPS.SELECT_VO")),n(2),_("placeholder",se(p(18,22,"DIALOGS.ADD_GROUPS.SELECT_VO")))("formControl",i.myControl)("matAutocomplete",s),n(2),_("displayWith",i.displayFn),n(2),ye(p(23,24,i.filteredOptions)),n(3),E(i.groups!==null&&i.groups.length>0&&!i.loading?24:-1),n(3),E(i.firstSearchDone?27:-1),n(3),f(" ",p(31,26,"DIALOGS.ADD_MANAGERS.CANCEL")," "),n(2),_("disabled",i.selection.selected.length===0||i.loading),n(),f(" ",p(34,28,"DIALOGS.ADD_MANAGERS.CREATE")," ")}},dependencies:[D,O,B,Ae,be,He,ot,it,tt,et,Je,he,Qe,ge,pt,lo,ao,so,q,z,Y,$,ae,y,nt,L,re,yi,x,ht],encapsulation:2})}}return t})();var cr=()=>["id","name","email","logins","organization"];function pr(t,m){t&1&&C(0,"perun-web-apps-loading-table")}function dr(t,m){t&1&&(d(0),c(1,"translate")),t&2&&f(" ",p(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.USER")," ")}function mr(t,m){if(t&1){let e=b();r(0,"button",15),S("click",function(){g(e);let i=u(2);return h(i.addManager())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function ur(t,m){if(t&1){let e=b();r(0,"button",16),S("click",function(){g(e);let i=u(2);return h(i.removeManager())}),d(1),c(2,"translate"),a()}if(t&2){let e=u(2);_("disabled",e.loading||e.selectionUsers.selected.length===0),n(),f(" ",p(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function _r(t,m){if(t&1&&(r(0,"mat-option",11),c(1,"lowercase"),d(2),c(3,"displayedRole"),a()),t&2){let e=m.$implicit;_("value",e.roleName),Ct("data-cy",p(1,3,e.roleName)),n(2),f(" ",p(3,5,e)," ")}}function gr(t,m){if(t&1){let e=b();r(0,"mat-slide-toggle",17),S("change",function(){g(e);let i=u(2);return i.showIndirectAdmins=!i.showIndirectAdmins,h(i.refreshUsers())}),d(1),c(2,"translate"),a()}if(t&2){let e=u(2);_("checked",e.showIndirectAdmins),n(),f(" ",p(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.SHOW_DERIVED_ADMINS")," ")}}function hr(t,m){if(t&1&&C(0,"perun-web-apps-users-list",18),t&2){let e=u(2);_("routeToAdmin",e.routeAuth)("loading",e.loading)("disableRouting",!e.routeAuth||e.disableRouting)("sortableColumns",de(10,cr))("displayColumns",e.displayedUserColumns)("selection",e.selectionUsers)("users",e.managers)("disableCheckbox",!0)("directManagerIds",e.directAdminsIds)("cacheSubject",e.cacheSubject)}}function fr(t,m){if(t&1){let e=b();r(0,"perun-web-apps-refresh-button",6),S("refresh",function(){g(e);let i=u();return h(i.refreshUsers())}),a(),A(1,mr,3,3,"button",7),A(2,ur,3,4,"button",8),r(3,"mat-form-field",9)(4,"mat-label"),d(5),c(6,"translate"),a(),r(7,"mat-select",10),S("selectionChange",function(){g(e);let i=u();return h(i.refreshUsers(!0))}),ie("valueChange",function(i){g(e);let s=u();return te(s.selectedRole,i)||(s.selectedRole=i),h(i)}),xe(8,_r,4,7,"mat-option",11,Rt),a()(),A(10,gr,3,4,"mat-slide-toggle",12),r(11,"div",13),R(12,hr,1,11,"perun-web-apps-users-list",14),a()}if(t&2){let e=u(),o=w(5);n(),E(e.manageAuth&&!e.configMode?1:-1),n(),E(e.manageAuth&&!e.configMode?2:-1),n(3),M(p(6,7,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),n(2),ee("value",e.selectedRole),n(),ye(e.availableRoles),n(2),E(e.complementaryObject.beanName.includes("Group")?10:-1),n(2),_("perunWebAppsLoader",e.loading)("perunWebAppsLoaderIndicator",o)}}function Sr(t,m){t&1&&(d(0),c(1,"translate")),t&2&&f(" ",p(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.GROUP")," ")}function vr(t,m){if(t&1){let e=b();r(0,"button",23),S("click",function(){g(e);let i=u(2);return h(i.addGroup())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function Cr(t,m){if(t&1){let e=b();r(0,"button",24),S("click",function(){g(e);let i=u(2);return h(i.removeGroup())}),d(1),c(2,"translate"),a()}if(t&2){let e=u(2);_("disabled",e.loading||e.selectionGroups.selected.length===0),n(),f(" ",p(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function Rr(t,m){if(t&1&&(r(0,"mat-option",11),d(1),c(2,"displayedRole"),a()),t&2){let e=m.$implicit;_("value",e.roleName),n(),M(p(2,2,e))}}function br(t,m){if(t&1&&C(0,"perun-web-apps-groups-list",25),t&2){let e=u(2);_("loading",e.loading)("disableMembers",!1)("disableRouting",e.disableRouting)("displayColumns",e.displayedGroupColumns)("groups",e.groups)("selection",e.selectionGroups)("cacheSubject",e.cacheSubject)}}function Ar(t,m){if(t&1){let e=b();r(0,"perun-web-apps-refresh-button",6),S("refresh",function(){g(e);let i=u();return h(i.refreshGroups())}),a(),A(1,vr,3,3,"button",19),A(2,Cr,3,4,"button",20),r(3,"mat-form-field",21)(4,"mat-label"),d(5),c(6,"translate"),a(),r(7,"mat-select",10),S("selectionChange",function(){g(e);let i=u();return h(i.refreshGroups())}),ie("valueChange",function(i){g(e);let s=u();return te(s.selectedRole,i)||(s.selectedRole=i),h(i)}),xe(8,Rr,3,4,"mat-option",11,Rt),a()(),r(10,"div",13),R(11,br,1,7,"perun-web-apps-groups-list",22),a()}if(t&2){let e=u(),o=w(5);n(),E(e.manageAuth&&!e.configMode?1:-1),n(),E(e.manageAuth&&!e.configMode?2:-1),n(3),M(p(6,6,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),n(2),ee("value",e.selectedRole),n(),ye(e.availableRoles),n(3),_("perunWebAppsLoader",e.loading)("perunWebAppsLoaderIndicator",o)}}function Er(t,m){t&1&&(r(0,"perun-web-apps-alert",5),d(1),c(2,"translate"),a()),t&2&&(n(),f(" ",p(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.NO_AVAILABLE_ROLES")," "))}var Lo=(()=>{class t{constructor(e,o,i,s,v,T,N){this.dialog=e,this.authzService=o,this.storeService=i,this.guiAuthResolver=s,this.router=v,this.reloadEntityDetail=T,this.route=N,this.configMode=!1,this.disableRouting=!1,this.disableSelf=!1,this.displayedUserColumns=["select","id","name","email","logins","organization"],this.displayedGroupColumns=["select","id","vo","name","description"],this.groups=[],this.managers=[],this.managers$=null,this.selectionUsers=new P(!0,[],!0,(J,fe)=>J.id===fe.id),this.selectionGroups=new P(!0,[],!0,(J,fe)=>J.id===fe.id),this.selectedMode="",this.showIndirectAdmins=!1,this.directAdminsIds=null,this.loading=!1,this.availableRolesPrivileges=new Map,this.cacheSubject=new _e(!0)}ngOnInit(){this.loading=!0,this.routeAuth=this.guiAuthResolver.isPerunAdminOrObserver(),this.guiAuthResolver.setRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(e=>this.availableRolesPrivileges.get(e.roleName).readAuth),this.availableRoles.length!==0&&(this.selectedRole=this.availableRoles[0].roleName),this.refreshUsers()}changeRolePrivileges(){this.guiAuthResolver.setRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(o=>this.availableRolesPrivileges.get(o.roleName).readAuth),this.manageAuth=this.availableRolesPrivileges.get(this.selectedRole).manageAuth,this.displayedUserColumns=this.manageAuth?this.displayedUserColumns:this.displayedUserColumns.filter(o=>o!=="select"),this.displayedGroupColumns=this.manageAuth?this.displayedGroupColumns:this.displayedGroupColumns.filter(o=>o!=="select"),this.roleModes=this.availableRolesPrivileges.get(this.selectedRole).modes;let e=!1;for(let o of this.roleModes)if(this.selectedMode===o.toLowerCase()){e=!0;break}e||(this.selectedMode=this.roleModes[0].toLowerCase())}tabChanged(e){this.loading=!0,e.index===0?(this.selectedMode="user",this.refreshUsers()):(this.selectedMode="group",this.refreshGroups())}refreshUsers(e=!1){this.loading=!0,this.changeRolePrivileges();let o=[Ce.USER_DEF_ORGANIZATION,Ce.USER_DEF_PREFERRED_MAIL];o=o.concat(this.storeService.getLoginAttributeNames()),this.showIndirectAdmins?e?this.managers$=this.getDirectAdmins(o).pipe(hi(()=>this.getIndirectAdmins(o))):this.managers$=this.getIndirectAdmins(o):this.managers$=this.getDirectAdmins(o),this.managers$.subscribe({next:i=>{this.managers=i,this.selectionUsers.clear(),this.loading=!1},error:()=>{this.loading=!1}}),this.cacheSubject.next(!0),this.selectionUsers.clear()}getDirectAdmins(e){return this.authzService.getAuthzRichAdmins(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType,e,!1,!0).pipe(vi(o=>this.directAdminsIds=o.map(i=>i.id)))}getIndirectAdmins(e){return this.loading=!0,this.authzService.getAuthzRichAdmins(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType,e,!1,!1)}refreshGroups(){this.loading=!0,this.changeRolePrivileges(),this.authzService.getAuthzAdminGroups(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType).subscribe({next:e=>{this.groups=e,this.selectionGroups.clear(),this.loading=!1},error:()=>{this.loading=!1}}),this.cacheSubject.next(!0),this.selectionGroups.clear()}addManager(){let e=Q();e.width="1000px",e.data={complementaryObject:this.complementaryObject,theme:this.theme,availableRoles:this.availableRoles,selectedRole:this.selectedRole},this.dialog.open(yo,e).afterClosed().subscribe(i=>{i&&this.refreshUsers(!0)})}removeManager(){let e=Q();e.width="450px",e.data={managers:this.selectionUsers.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme,checkLastWarning:this.selectionUsers.selected.length===this.directAdminsIds.length},this.dialog.open(wo,e).afterClosed().subscribe(i=>{i&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?this.reloadEntityDetail.reloadEntityDetail():this.redirectToAuthRoute())})}removeGroup(){let e=Q();e.width="450px",e.data={groups:this.selectionGroups.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme,doCheckLastWarning:this.selectionGroups.selected.length===this.groups.length},this.dialog.open(Oo,e).afterClosed().subscribe(i=>{i&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?this.refreshGroups():this.redirectToAuthRoute())})}addGroup(){let e=Q();e.width="1000px",e.data={complementaryObject:this.complementaryObject,availableRoles:this.availableRoles,theme:this.theme,selectedRole:this.selectedRole},this.dialog.open(Go,e).afterClosed().subscribe(i=>{i&&this.refreshGroups()})}redirectToAuthRoute(){if(this.complementaryObjectType==="Group"&&(this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])||this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])))if(this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])){let e=this.complementaryObject;this.router.navigate(["/organizations",e.voId,"groups",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"})}else this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])&&this.router.navigate(["/organizations",this.complementaryObject.voId],{queryParamsHandling:"merge"});else if(this.complementaryObjectType==="Facility"&&this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.complementaryObject]))this.router.navigate(["/facilities",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else if(this.complementaryObjectType==="Vo"&&this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject]))this.router.navigate(["/organizations",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else if(this.complementaryObjectType==="Resource"&&this.guiAuthResolver.isAuthorized("getRichResourceById_int_policy",[this.complementaryObject]))this.router.navigate(["../../"],{relativeTo:this.route,queryParamsHandling:"merge"});else{this.router.navigate(["/home"],{queryParamsHandling:"merge"});return}this.reloadEntityDetail.reloadEntityDetail()}static{this.\u0275fac=function(o){return new(o||t)(l(Ie),l($e),l(Me),l(U),l(Ze),l(ei),l(ne))}}static{this.\u0275cmp=I({type:t,selectors:[["app-managers-page"]],hostVars:2,hostBindings:function(o,i){o&2&&Re("router-component",i.true)},inputs:{complementaryObject:"complementaryObject",availableRoles:"availableRoles",complementaryObjectType:"complementaryObjectType",theme:"theme",configMode:"configMode",disableRouting:"disableRouting",disableSelf:"disableSelf",displayedUserColumns:"displayedUserColumns",displayedGroupColumns:"displayedGroupColumns"},decls:13,vars:4,consts:[["spinner",""],[1,"page-subtitle"],["mat-stretch-tabs","false","preserveContent","true",3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["alert_type","warn"],[1,"mt-2",3,"refresh"],["color","accent","data-cy","add-manager-button","mat-flat-button","",1,"me-2","action-button"],["color","warn","data-cy","remove-manager-button","mat-flat-button","",1,"me-2",3,"disabled"],["data-cy","role-filter",1,"me-2","mt-2"],[3,"selectionChange","valueChange","value"],[3,"value"],[3,"checked"],[1,"position-relative","table-min-height"],[3,"routeToAdmin","loading","disableRouting","sortableColumns","displayColumns","selection","users","disableCheckbox","directManagerIds","cacheSubject",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","data-cy","add-manager-button","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","data-cy","remove-manager-button","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"change","checked"],[3,"routeToAdmin","loading","disableRouting","sortableColumns","displayColumns","selection","users","disableCheckbox","directManagerIds","cacheSubject"],["color","accent","mat-flat-button","",1,"me-2","action-button"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[1,"me-2","mt-2"],[3,"loading","disableMembers","disableRouting","displayColumns","groups","selection","cacheSubject",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"loading","disableMembers","disableRouting","displayColumns","groups","selection","cacheSubject"]],template:function(o,i){if(o&1){let s=b();r(0,"h1",1),d(1),c(2,"translate"),a(),r(3,"mat-tab-group",2),S("selectedTabChange",function(T){return g(s),h(i.tabChanged(T))}),R(4,pr,1,0,"ng-template",null,0,G),r(6,"mat-tab"),R(7,dr,2,3,"ng-template",3)(8,fr,13,9,"ng-template",4),a(),r(9,"mat-tab"),R(10,Sr,2,3,"ng-template",3)(11,Ar,12,8,"ng-template",4),a()(),A(12,Er,3,3,"perun-web-apps-alert",5)}o&2&&(n(),f(" ",p(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.TITLE"),`
`),n(11),E(i.availableRoles.length===0?12:-1))},dependencies:[D,O,B,Ae,be,He,tt,et,Je,Ht,Wt,Te,Ee,De,Ft,Pt,Ut,jt,kt,y,Xt,nt,L,re,wi,x,ht],encapsulation:2})}}return t})();var vd=(()=>{class t{constructor(e,o){this.guiAuthResolver=e,this.entityStorageService=o,this.availableRoles=[],this.type="Resource",this.theme="resource-theme"}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Resource")}static{this.\u0275fac=function(o){return new(o||t)(l(U),l(X))}}static{this.\u0275cmp=I({type:t,selectors:[["app-resource-settings-managers"]],decls:1,vars:4,consts:[[3,"complementaryObject","availableRoles","complementaryObjectType","theme"]],template:function(o,i){o&1&&C(0,"app-managers-page",0),o&2&&_("complementaryObject",i.resource)("availableRoles",i.availableRoles)("complementaryObjectType",i.type)("theme",i.theme)},dependencies:[D,Lo],encapsulation:2})}}return t})();var Tr=()=>["select","id","name","enabled","description"];function Mr(t,m){t&1&&C(0,"perun-web-apps-loading-dialog")}function Ir(t,m){if(t&1){let e=b();r(0,"div")(1,"h1",2),d(2),c(3,"translate"),a(),r(4,"div",3)(5,"div",4)(6,"perun-web-apps-debounce-filter",5),c(7,"translate"),S("filter",function(i){g(e);let s=u();return h(s.applyFilter(i))}),a()(),C(8,"app-services-list",6),a(),r(9,"div",7)(10,"button",8),S("click",function(){g(e);let i=u();return h(i.onCancel())}),d(11),c(12,"translate"),a(),r(13,"button",9),S("click",function(){g(e);let i=u();return h(i.onAdd())}),d(14),c(15,"translate"),a()()()}if(t&2){let e=u();n(2),M(p(3,13,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.TITLE")),n(4),_("placeholder",se(p(7,15,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.FILTER_DESCRIPTION"))),n(2),_("loading",e.loading)("services",e.unAssignedServices)("disableRouting",!0)("displayColumns",de(21,Tr))("filterValue",e.filterValue)("selection",e.selection)("cachedSubject",e.cachedSubject),n(3),f(" ",p(12,17,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.CANCEL_BUTTON")," "),n(2),_("disabled",e.selection.selected.length===0||e.loading),n(),f(" ",p(15,19,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.ADD_SERVICES")," ")}}var Vo=(()=>{class t{constructor(e,o,i,s,v,T){this.dialogRef=e,this.data=o,this.notificator=i,this.translate=s,this.resourceManager=v,this.servicesManager=T,this.loading=!1,this.unAssignedServices=[],this.filteredServices=[],this.selection=new P(!0,[],!0,(N,J)=>N.id===J.id),this.cachedSubject=new _e(!0),this.filterValue=""}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resourceManager.getAssignedServicesToResource(this.data.resourceId).subscribe(e=>{this.servicesManager.getServices().subscribe(o=>{this.unAssignedServices=o;for(let i of e)for(let s of o)i.id===s.id&&this.unAssignedServices.splice(this.unAssignedServices.indexOf(s),1);this.loading=!1})})}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0,this.addServices()}applyFilter(e){this.filterValue=e,this.selection.clear(),this.cachedSubject.next(!0)}addServices(){let e=[];for(let o of this.selection.selected)e.push(o.id);this.resourceManager.assignServices(this.data.resourceId,e).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SERVICE_SUCCESS_MESSAGE").subscribe(o=>{this.notificator.showSuccess(o),this.dialogRef.close(!0)})},()=>this.loading=!1)}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(k),l(We),l(V),l(Hi))}}static{this.\u0275cmp=I({type:t,selectors:[["app-perun-web-apps-assign-service-to-resource-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"mt-2"],[3,"filter","placeholder"],[3,"loading","services","disableRouting","displayColumns","filterValue","selection","cachedSubject"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(o,i){if(o&1&&(R(0,Mr,1,0,"ng-template",null,0,G),r(2,"div"),R(3,Ir,16,22,"div",1),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,q,z,Y,$,me,ae,y,Jt,L,x],encapsulation:2})}}return t})();function xr(t,m){t&1&&C(0,"perun-web-apps-loading-dialog")}function yr(t,m){if(t&1){let e=b();r(0,"div",4)(1,"perun-web-apps-alert",15),d(2),c(3,"translate"),a(),r(4,"p"),d(5),c(6,"translate"),a(),r(7,"p",16),d(8),c(9,"translate"),a(),r(10,"div",17)(11,"mat-checkbox",18),ie("ngModelChange",function(i){g(e);let s=u(2);return te(s.removeTask,i)||(s.removeTask=i),h(i)}),S("change",function(){g(e);let i=u(2);return h(i.removeTaskResults=!1)}),d(12),c(13,"translate"),a(),r(14,"mat-checkbox",19),ie("ngModelChange",function(i){g(e);let s=u(2);return te(s.removeTaskResults,i)||(s.removeTaskResults=i),h(i)}),d(15),c(16,"translate"),a(),r(17,"mat-checkbox",20),ie("ngModelChange",function(i){g(e);let s=u(2);return te(s.removeDestinations,i)||(s.removeDestinations=i),h(i)}),d(18),c(19,"translate"),a()()()}if(t&2){let e=u(2);n(2),f(" ",p(3,10,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.WARN_LAST_ASSIGNED")," "),n(3),f(" ",p(6,12,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.OPTIONAL_REMOVAL")," "),n(3),f(" ",p(9,14,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.OPTIONAL_REMOVAL_EXTRA")," "),n(3),ee("ngModel",e.removeTask),n(),f(" ",p(13,16,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.REMOVE_TASK")," "),n(2),ee("ngModel",e.removeTaskResults),_("disabled",e.removeTask),n(),f(" ",p(16,18,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.REMOVE_TASK_RESULTS")," "),n(2),ee("ngModel",e.removeDestinations),n(),f(" ",p(19,20,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.REMOVE_DESTINATIONS")," ")}}function wr(t,m){t&1&&C(0,"th",21)}function Or(t,m){t&1&&(r(0,"mat-icon",24),d(1,"warning"),a())}function Gr(t,m){if(t&1&&(r(0,"td",22),c(1,"translate"),r(2,"div",23),d(3),A(4,Or,2,0,"mat-icon",24),a()()),t&2){let e=m.$implicit,o=u(2);_("matTooltip",p(1,4,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.TOOLTIP"))("matTooltipDisabled",!o.servicesLastAssignedIds.includes(e.id)),n(3),f(" ",e.name," "),n(),E(o.servicesLastAssignedIds.includes(e.id)?4:-1)}}function Lr(t,m){t&1&&C(0,"tr",25)}function Vr(t,m){t&1&&C(0,"tr",26)}function Br(t,m){if(t&1){let e=b();r(0,"div")(1,"h1",2),d(2),c(3,"translate"),a(),r(4,"div",3)(5,"p"),d(6),c(7,"translate"),a(),A(8,yr,20,22,"div",4),r(9,"div",5),d(10),c(11,"translate"),a(),r(12,"table",6),Se(13,7),R(14,wr,1,0,"th",8)(15,Gr,5,6,"td",9),ve(),R(16,Lr,1,0,"tr",10)(17,Vr,1,0,"tr",11),a()(),r(18,"div",12)(19,"button",13),S("click",function(){g(e);let i=u();return h(i.onCancel())}),d(20),c(21,"translate"),a(),r(22,"button",14),S("click",function(){g(e);let i=u();return h(i.onSubmit())}),d(23),c(24,"translate"),a()()()}if(t&2){let e=u();n(2),M(p(3,10,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.TITLE")),n(4),f(" ",p(7,12,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DESCRIPTION")," "),n(2),E(e.servicesLastAssignedIds.length>0?8:-1),n(2),f(" ",p(11,14,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.ASK")," "),n(2),_("dataSource",e.dataSource),n(4),_("matHeaderRowDef",e.displayedColumns),n(),_("matRowDefColumns",e.displayedColumns),n(3),f(" ",p(21,16,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.CANCEL")," "),n(2),_("disabled",e.loading),n(),f(" ",p(24,18,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DELETE")," ")}}var Bo=(()=>{class t{constructor(e,o,i,s,v){this.dialogRef=e,this.data=o,this.notificator=i,this.translate=s,this.resourcesManager=v,this.displayedColumns=["name"],this.servicesLastAssignedIds=[],this.servicesIds=[]}ngOnInit(){this.loading=!0,this.servicesIds=this.data.services.map(e=>e.id),this.theme=this.data.theme,this.resourcesManager.isResourceLastAssignedServices(this.data.resourceId,this.servicesIds).subscribe({next:e=>{this.servicesLastAssignedIds=e.map(o=>o.id),this.loading=!1},error:()=>{this.loading=!1}}),this.dataSource=new Fe(this.data.services)}onSubmit(){this.loading=!0,this.resourcesManager.removeServices(this.data.resourceId,this.servicesIds,this.removeTask,this.removeTaskResults,this.removeDestinations).subscribe({next:()=>{this.translate.get("DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close(!0)})},error:()=>this.loading=!1})}onCancel(){this.dialogRef.close()}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(k),l(We),l(V))}}static{this.\u0275cmp=I({type:t,selectors:[["app-perun-web-apps-remove-service-from-resource-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"mb-2"],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"matTooltip","matTooltipDisabled",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"click","disabled"],["alert_type","warn"],[1,"small","mt-0"],[1,"flex-column","d-flex"],[3,"ngModelChange","change","ngModel"],[3,"ngModelChange","ngModel","disabled"],[3,"ngModelChange","ngModel"],["mat-header-cell",""],["mat-cell","",3,"matTooltip","matTooltipDisabled"],[1,"d-flex","align-items-center"],[1,"ms-2"],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(o,i){if(o&1&&(R(0,xr,1,0,"ng-template",null,0,G),r(2,"div"),R(3,Br,25,20,"div",1),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,_t,ut,xt,Dt,Xe,ge,Ke,he,q,z,Y,$,Te,Ee,me,ke,we,Ge,Ne,Le,Oe,Pe,Ve,Be,Ue,je,y,qe,L,x],encapsulation:2})}}return t})();function Nr(t,m){if(t&1){let e=b();r(0,"button",8),S("click",function(){g(e);let i=u();return h(i.addService())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"RESOURCE_DETAIL.ASSIGNED_SERVICES.ADD_SERVICE")," "))}function Pr(t,m){if(t&1){let e=b();r(0,"button",9),S("click",function(){g(e);let i=u();return h(i.removeServices())}),d(1),c(2,"translate"),a()}if(t&2){let e=u();_("disabled",e.loading||e.selected.selected.length===0),n(),f(" ",p(2,2,"RESOURCE_DETAIL.ASSIGNED_SERVICES.REMOVE_SERVICE")," ")}}function Ur(t,m){t&1&&C(0,"perun-web-apps-loading-table")}function jr(t,m){if(t&1&&C(0,"app-services-list",10),t&2){let e=u();_("loading",e.loading)("disableRouting",!e.serviceRoutingAuth)("selection",e.selected)("cachedSubject",e.cachedSubject)("displayColumns",e.displayedColumns)("filterValue",e.filterValue)("services",e.assignedServices)}}var Rm=(()=>{class t{constructor(e,o,i,s,v){this.route=e,this.resourcesManager=o,this.dialog=i,this.guiAuthResolver=s,this.entityStorageService=v,this.assignedServices=[],this.selected=new P(!0,[],!0,(T,N)=>T.id===N.id),this.cachedSubject=new _e(!0),this.filterValue="",this.displayedColumns=["select","id","name","enabled","script","description"]}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.getDataForAuthorization(),this.loadAllServices()}loadAllServices(){this.loading=!0,this.resourcesManager.getAssignedServicesToResource(this.resource.id).subscribe(e=>{this.assignedServices=e,this.selected.clear(),this.cachedSubject.next(!0),this.loading=!1})}addService(){let e=Q();e.width="800px",e.data={theme:"resource-theme",resourceId:this.resource.id},this.dialog.open(Vo,e).afterClosed().subscribe(i=>{i&&this.loadAllServices()})}removeServices(){let e=Q();e.width="600px",e.data={theme:"resource-theme",resourceId:this.resource.id,services:this.selected.selected},this.dialog.open(Bo,e).afterClosed().subscribe(i=>{i&&this.loadAllServices()})}applyFilter(e){this.filterValue=e,this.loadAllServices()}getDataForAuthorization(){this.assignServiceAuth=this.guiAuthResolver.isAuthorized("assignServices_Resource_List<Service>_policy",[this.resource]),this.removeServiceAuth=this.guiAuthResolver.isAuthorized("removeServices_Resource_List<Service>_policy",[this.resource]),this.displayedColumns=this.removeServiceAuth?["select","id","name","enabled","script","description"]:["id","name","enabled","script","description"],this.serviceRoutingAuth=this.guiAuthResolver.isPerunAdminOrObserver()}static{this.\u0275fac=function(o){return new(o||t)(l(ne),l(V),l(Ie),l(U),l(X))}}static{this.\u0275cmp=I({type:t,selectors:[["app-perun-web-apps-resource-assigned-services"]],decls:11,vars:8,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"action-button","me-2"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","disableRouting","selection","cachedSubject","displayColumns","filterValue","services",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"action-button","me-2",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"loading","disableRouting","selection","cachedSubject","displayColumns","filterValue","services"]],template:function(o,i){if(o&1){let s=b();r(0,"h1",1),d(1),c(2,"translate"),a(),r(3,"perun-web-apps-refresh-button",2),S("refresh",function(){return g(s),h(i.loadAllServices())}),a(),A(4,Nr,3,3,"button",3),A(5,Pr,3,4,"button",4),r(6,"perun-web-apps-debounce-filter",5),S("filter",function(T){return g(s),h(i.applyFilter(T))}),a(),R(7,Ur,1,0,"ng-template",null,0,G),r(9,"div",6),R(10,jr,1,7,"app-services-list",7),a()}if(o&2){let s=w(8);n(),M(p(2,6,"RESOURCE_DETAIL.ASSIGNED_SERVICES.TITLE")),n(3),E(i.assignServiceAuth?4:-1),n(),E(i.removeServiceAuth?5:-1),n(),_("placeholder","RESOURCE_DETAIL.ASSIGNED_SERVICES.FILTER_SERVICES"),n(4),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,ae,De,y,Jt,L,re,x],encapsulation:2})}}return t})();function Fr(t,m){if(t&1&&(r(0,"mat-option",8),d(1),c(2,"translate"),a()),t&2){let e=m.$implicit;_("value",e),n(),f(" ",p(2,2,"CONSENTS.STATUS_"+e)," ")}}function Wr(t,m){if(t&1){let e=b();r(0,"mat-form-field",3)(1,"mat-label"),d(2),c(3,"translate"),a(),r(4,"mat-select",7),S("closed",function(){g(e);let i=u();return h(i.changeConsentStatuses())}),r(5,"mat-select-trigger"),d(6),c(7,"selectedConsentStatuses"),a(),xe(8,Fr,3,4,"mat-option",8,Rt),a()()}if(t&2){let e=u();n(2),M(p(3,3,"RESOURCE_DETAIL.ASSIGNED_MEMBERS.FILTER_CONSENT_STATUS")),n(2),_("formControl",e.consentStatuses),n(2),f(" ",Di(7,5,e.selectedConsentStatuses,e.consentStatusList,e.consentStatuses.value)," "),n(2),ye(e.consentStatusList)}}function Hr(t,m){t&1&&C(0,"perun-web-apps-loading-table")}function zr(t,m){if(t&1){let e=b();r(0,"perun-web-apps-members-list",9),S("refreshTable",function(){g(e);let i=u();return h(i.refreshTable())}),a()}if(t&2){let e=u();_("loading",e.loading)("displayedColumns",e.columns)("disableRouting",!e.routeAuth)("members",e.members)("filter",e.filterValue)}}var jm=(()=>{class t{constructor(e,o,i,s,v,T,N){this.route=e,this.resourceService=o,this.authResolver=i,this.entityStorageService=s,this.storeService=v,this.consentService=T,this.consentStatusPipe=N,this.loading=!1,this.filterValue="",this.members=[],this.columns=["id","fullName"],this.includeConsents=!1,this.consents=[],this.consentStatuses=new Oi,this.consentStatusList=["UNSIGNED","GRANTED","REVOKED"],this.selectedConsentStatuses=[],this.selection=new P(!0,[])}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.resourceService.getAssignedRichMembers(this.resource.id).subscribe(e=>{this.setAuthRights(e),this.consentService.getConsentHubByResource(this.resource.id).subscribe(o=>{this.includeConsents=this.storeService.getProperty("enforce_consents")&&o.enforceConsents,this.includeConsents?(this.columns=["id","fullName","consentStatus"],this.consentService.getConsentsForConsentHubByResource(this.resource.id).subscribe(i=>{this.consents=i,this.members=this.getConsentsForMembers(e).filter(s=>!this.selectedConsentStatuses||this.selectedConsentStatuses.length===0||this.selectedConsentStatuses.includes(s.consent))})):this.members=e,this.loading=!1})})}setAuthRights(e){e.length!==0&&(this.routeAuth=this.authResolver.isAuthorized("getMemberById_int_policy",[e[0]]))}applyFilter(e){this.filterValue=e}getConsentsForMembers(e){let o=[];return e.forEach(i=>{let s=i;s.consent=this.consentStatusPipe.transform(i.userId,this.consents),o.push(s)}),o}changeConsentStatuses(){this.selection.clear(),this.selectedConsentStatuses=this.consentStatuses.value,this.refreshTable()}static{this.\u0275fac=function(o){return new(o||t)(l(ne),l(V),l(U),l(X),l(Me),l(Fi),l($t))}}static{this.\u0275cmp=I({type:t,selectors:[["app-resource-assigned-members"]],features:[Tt([$t,li])],decls:10,vars:7,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],[1,"me-2","fix-select"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","displayedColumns","disableRouting","members","filter","refreshTable",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["multiple","",3,"closed","formControl"],[1,"resource-theme",3,"value"],[3,"refreshTable","loading","displayedColumns","disableRouting","members","filter"]],template:function(o,i){if(o&1){let s=b();r(0,"h1",1),d(1),c(2,"translate"),a(),r(3,"perun-web-apps-refresh-button",2),S("refresh",function(){return g(s),h(i.refreshTable())}),a(),A(4,Wr,10,9,"mat-form-field",3),r(5,"perun-web-apps-debounce-filter",4),S("filter",function(T){return g(s),h(i.applyFilter(T))}),a(),R(6,Hr,1,0,"ng-template",null,0,G),r(8,"div",5),R(9,zr,1,5,"perun-web-apps-members-list",6),a()}if(o&2){let s=w(7);n(),M(p(2,5,"RESOURCE_DETAIL.ASSIGNED_MEMBERS.TITLE")),n(3),E(i.includeConsents?4:-1),n(),_("placeholder","RESOURCE_DETAIL.ASSIGNED_MEMBERS.FILTER"),n(4),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,Ae,be,He,tt,et,Pi,Je,he,ge,pt,ae,De,Qt,y,L,re,x,li],encapsulation:2})}}return t})();var $r=t=>({all:t}),Yr=t=>({name:t});function qr(t,m){if(t&1){let e=b();r(0,"th",16)(1,"mat-checkbox",17),c(2,"masterCheckboxLabel"),c(3,"translate"),S("change",function(i){g(e);let s=u(2);return h(i?s.masterToggle():null)}),a()()}if(t&2){let e=u(),o=u();n(),oi("aria-label",p(3,5,p(2,3,e.all))),_("checked",o.selection.hasValue()&&e.all)("indeterminate",o.selection.hasValue()&&!e.all)}}function Qr(t,m){if(t&1){let e=b();r(0,"td",18)(1,"mat-checkbox",19),c(2,"checkboxLabel"),c(3,"translate"),S("change",function(i){let s=g(e).$implicit,v=u(2);return h(i?v.toggleRow(s):null)})("click",function(i){return g(e),h(i.stopPropagation())}),a()()}if(t&2){let e=m.$implicit,o=u(2);n(),oi("aria-label",bt(3,4,p(2,2,o.selection.isSelected(e)),ue(7,Yr,e.tagName))),_("checked",o.selection.isSelected(e))}}function Kr(t,m){t&1&&(Se(0,3),R(1,qr,4,7,"th",14)(2,Qr,4,9,"td",15),ve())}function Xr(t,m){t&1&&(r(0,"th",20),d(1),c(2,"translate"),a()),t&2&&(n(),f(" ",p(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_ID")," "))}function Zr(t,m){if(t&1&&(r(0,"td",21),d(1),a()),t&2){let e=m.$implicit;n(),M(e.id)}}function Jr(t,m){t&1&&(r(0,"th",22),d(1),c(2,"translate"),a()),t&2&&(n(),f(" ",p(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_NAME")," "))}function ea(t,m){if(t&1&&(r(0,"div"),d(1),a()),t&2){let e=u().$implicit;n(),f(" ",e.tagName," ")}}function ta(t,m){if(t&1){let e=b();r(0,"div")(1,"mat-form-field",24)(2,"input",25),c(3,"translate"),ie("ngModelChange",function(i){g(e);let s=u().$implicit;return te(s.tagName,i)||(s.tagName=i),h(i)}),a()()()}if(t&2){let e=u().$implicit;n(2),_("placeholder",se(p(3,3,"VO_DETAIL.RESOURCES.TAGS.CHANGE_TAG_NAME"))),ee("ngModel",e.tagName)}}function ia(t,m){if(t&1&&(r(0,"td",23),A(1,ea,2,1,"div"),A(2,ta,4,5,"div"),a()),t&2){let e=m.$implicit,o=u();n(),E(o.isChanging.isSelected(e)?-1:1),n(),E(o.isChanging.isSelected(e)?2:-1)}}function oa(t,m){t&1&&C(0,"th",22)}function na(t,m){if(t&1){let e=b();r(0,"button",28),c(1,"translate"),S("click",function(){g(e);let i=u().$implicit,s=u();return h(s.edit(i))}),r(2,"mat-icon"),d(3,"edit"),a()()}t&2&&_("matTooltip",se(p(1,2,"VO_DETAIL.RESOURCES.TAGS.EDIT_BUTTON")))}function ra(t,m){if(t&1){let e=b();r(0,"button",28),c(1,"translate"),S("click",function(){g(e);let i=u().$implicit,s=u();return h(s.save(i))}),r(2,"mat-icon"),d(3,"save"),a()()}t&2&&_("matTooltip",se(p(1,2,"VO_DETAIL.RESOURCES.TAGS.SAVE_BUTTON")))}function aa(t,m){if(t&1&&(r(0,"td",23)(1,"div",26),A(2,na,4,4,"button",27),A(3,ra,4,4,"button",27),a()()),t&2){let e=m.$implicit,o=u();n(2),E(o.isChanging.isSelected(e)?-1:2),n(),E(o.isChanging.isSelected(e)?3:-1)}}function sa(t,m){t&1&&C(0,"tr",29)}function la(t,m){t&1&&C(0,"tr",30)}function ca(t,m){if(t&1&&(r(0,"perun-web-apps-alert",13),d(1),c(2,"translate"),c(3,"translate"),a()),t&2){let e=u();n(),f(" ",e.entity==="vo"?p(2,1,"VO_DETAIL.RESOURCES.TAGS.NO_TAGS"):p(3,3,"RESOURCE_DETAIL.TAGS.NO_TAGS")," ")}}function pa(t,m){t&1&&(r(0,"perun-web-apps-alert",13),d(1),c(2,"translate"),a()),t&2&&(n(),f(" ",p(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT")," "))}var ii=(()=>{class t{constructor(e,o,i,s,v,T,N){this.resourceManager=e,this.notificator=o,this.translator=i,this.authResolver=s,this.tableCheckbox=v,this.destroyRef=T,this.tableConfigService=N,this.resourceTags=[],this.selection=new P(!0,[]),this.isChanging=new P(!0,[]),this.pageSizeOptions=qi,this.displayedColumns=["select","id","name","edit"],this.unfilteredColumns=this.displayedColumns,this.tableId="app-resources-tags-list"}set displayColumns(e){this.unfilteredColumns=e,localStorage.getItem("showIds")!=="true"&&(e=e.filter(o=>o!=="id")),this.displayedColumns=e}set matSort(e){this.sort=e,this.setDataSource()}static getDataForColumn(e,o){switch(o){case"id":return e.id.toString();case"name":return e.tagName;default:return""}}ngOnInit(){this.selection&&(this.cachedSelection=new P(this.selection.isMultipleSelection(),[],!0,this.selection.compareWith),this.cachedSubject?.pipe(ci(this.destroyRef)).subscribe(e=>{e&&this.cachedSelection.clear()})),this.watchForIdColumnChanges()}ngOnChanges(){this.dataSource=new Fe(this.resourceTags),this.setDataSource()}ngAfterViewInit(){this.dataSource.paginator=this.child.paginator}exportAllData(e){ai(ri(this.dataSource.filteredData,this.displayedColumns,t.getDataForColumn),e)}exportDisplayedData(e){let o=this.dataSource.paginator.pageIndex*this.dataSource.paginator.pageSize,i=o+this.dataSource.paginator.pageSize;ai(ri(this.dataSource.sortData(this.dataSource.filteredData,this.dataSource.sort).slice(o,i),this.displayedColumns,t.getDataForColumn),e)}setDataSource(){this.dataSource&&(this.dataSource.filterPredicate=(e,o)=>Xi(e,o,this.displayedColumns,t.getDataForColumn),this.dataSource.sortData=(e,o)=>Ki(e,o,t.getDataForColumn),this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue)}isAllSelected(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.dataSource)}masterToggle(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.cachedSelection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}toggleRow(e){this.selection.toggle(e),this.cachedSelection.toggle(e)}pageChanged(){this.cachedSelection&&this.tableCheckbox.selectCachedDataOnPage(this.dataSource,this.selection,this.cachedSelection,this.selection.compareWith)}save(e){this.resourceManager.updateResourceTag({resourceTag:e}).subscribe(()=>{this.translator.get("SHARED.COMPONENTS.RESOURCES_TAGS_LIST.EDIT_SUCCESS").subscribe(o=>{this.notificator.showSuccess(o)}),this.isChanging.deselect(e)})}edit(e){this.isChanging.select(e)}watchForIdColumnChanges(){this.tableConfigService.showIdsChanged.pipe(ci(this.destroyRef)).subscribe(e=>{e?this.displayedColumns=this.unfilteredColumns:this.displayedColumns=this.unfilteredColumns.filter(o=>o!=="id")}),localStorage.getItem("showIds")!=="true"&&this.displayedColumns.filter(e=>e!=="id")}static{this.\u0275fac=function(o){return new(o||t)(l(V),l(k),l(We),l(U),l(Zi),l(Ri),l(io))}}static{this.\u0275cmp=I({type:t,selectors:[["app-resources-tags-list"]],viewQuery:function(o,i){if(o&1&&(st(pi,7),st(yt,7)),o&2){let s;lt(s=ct())&&(i.child=s.first),lt(s=ct())&&(i.matSort=s.first)}},inputs:{resourceTags:"resourceTags",filterValue:"filterValue",selection:"selection",cachedSubject:"cachedSubject",entity:"entity",loading:"loading",displayColumns:"displayColumns"},features:[bi],decls:18,vars:15,consts:[[1,"card","mt-2",3,"hidden"],[3,"exportDisplayedData","exportAllData","pageChanged","pageSizeOptions","dataLength","tableId"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"matSortChange","dataSource"],["matColumnDef","select"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","edit"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn"],["class","align-checkbox","mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size align-checkbox","mat-cell","",4,"matCellDef"],["mat-header-cell","",1,"align-checkbox"],["color","primary",3,"change","aria-label","checked","indeterminate"],["mat-cell","",1,"static-column-size","align-checkbox"],["color","primary",3,"change","click","aria-label","checked"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"static-column-size"],["mat-header-cell",""],["mat-cell",""],["subscriptSizing","dynamic"],["matInput","",3,"ngModelChange","ngModel","placeholder"],[1,"d-flex","justify-content-end"],["mat-icon-button","",3,"matTooltip"],["mat-icon-button","",3,"click","matTooltip"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"]],template:function(o,i){if(o&1&&(r(0,"div",0)(1,"perun-web-apps-table-wrapper",1),S("exportDisplayedData",function(v){return i.exportDisplayedData(v)})("exportAllData",function(v){return i.exportAllData(v)})("pageChanged",function(){return i.pageChanged()}),r(2,"table",2),S("matSortChange",function(){return i.pageChanged()}),A(3,Kr,3,0,"ng-container",3),c(4,"isAllSelected"),Se(5,4),R(6,Xr,3,3,"th",5)(7,Zr,2,1,"td",6),ve(),Se(8,7),R(9,Jr,3,3,"th",8)(10,ia,3,2,"td",9),ve(),Se(11,10),R(12,oa,1,0,"th",8)(13,aa,4,2,"td",9),ve(),R(14,sa,1,0,"tr",11)(15,la,1,0,"tr",12),a()()(),A(16,ca,4,5,"perun-web-apps-alert",13),A(17,pa,3,3,"perun-web-apps-alert",13)),o&2){let s;_("hidden",i.resourceTags.length===0||i.dataSource.filteredData.length===0),n(),_("pageSizeOptions",i.pageSizeOptions)("dataLength",i.dataSource.filteredData.length)("tableId",i.tableId),n(),_("dataSource",i.dataSource),n(),E((s=ue(13,$r,bt(4,10,i.dataSource,i.selection.selected.length)))?3:-1,s),n(11),_("matHeaderRowDef",i.displayedColumns),n(),_("matRowDefColumns",i.displayedColumns),n(),E(!i.loading&&i.resourceTags.length===0?16:-1),n(),E(i.dataSource.filteredData.length===0&&i.resourceTags.length!==0?17:-1)}},dependencies:[D,O,Ot,_t,ut,Ae,be,ot,it,xt,Dt,Xe,Qe,ge,Ke,he,Te,Ee,pi,ke,we,Ge,Ne,Le,Oe,Pe,Ve,Be,Ue,je,Ni,yt,Bi,y,qe,Ji,x,eo,to],encapsulation:2})}}return t})();function da(t,m){t&1&&C(0,"perun-web-apps-loading-table")}function ma(t,m){if(t&1&&C(0,"app-resources-tags-list",8),t&2){let e=u();_("loading",e.loading)("selection",e.selection)("displayColumns",e.displayedColumns)("entity","resource")("filterValue",e.filterValue)("resourceTags",e.resourceTags)}}var No=(()=>{class t{constructor(e,o,i){this.dialogRef=e,this.data=o,this.resourcesManager=i,this.selection=new P(!0,[]),this.resourceTags=[],this.displayedColumns=["select","id","name"]}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.voId=this.data.voId,this.resourceId=this.data.resourceId,this.assignedTags=this.data.assignedTags,this.resourcesManager.getAllResourcesTagsForVo(this.voId).subscribe(e=>{this.resourceTags=e.filter(o=>!this.assignedTags.map(i=>i.id).includes(o.id)),this.loading=!1})}onCancel(){this.dialogRef.close(!1)}onSubmit(e){this.resourcesManager.assignResourceTagsToResource({resource:this.resourceId,resourceTags:e}).subscribe(()=>{this.dialogRef.close(!0)})}applyFilter(e){this.filterValue=e}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(V))}}static{this.\u0275cmp=I({type:t,selectors:[["app-add-resource-tag-to-resource-dialog"]],decls:16,vars:14,consts:[["spinner",""],["mat-dialog-title",""],["mat-dialog-content",""],[1,"position-relative","table-min-height"],[3,"loading","selection","displayColumns","entity","filterValue","resourceTags",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"],[3,"loading","selection","displayColumns","entity","filterValue","resourceTags"]],template:function(o,i){if(o&1){let s=b();r(0,"div")(1,"h1",1),d(2),c(3,"translate"),a(),r(4,"div",2),R(5,da,1,0,"ng-template",null,0,G),r(7,"div",3),R(8,ma,1,6,"app-resources-tags-list",4),a()(),r(9,"div",5)(10,"button",6),S("click",function(){return g(s),h(i.onCancel())}),d(11),c(12,"translate"),a(),r(13,"button",7),S("click",function(){return g(s),h(i.onSubmit(i.selection.selected))}),d(14),c(15,"translate"),a()()()}if(o&2){let s=w(6);F(i.theme),n(2),M(p(3,8,"RESOURCE_DETAIL.TAGS.ADD_TAGS")),n(6),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s),n(3),f(" ",p(12,10,"RESOURCE_DETAIL.TAGS.CANCEL")," "),n(2),_("disabled",i.loading||i.resourceTags.length===0),n(),f(" ",p(15,12,"RESOURCE_DETAIL.TAGS.ADD_BUTTON")," ")}},dependencies:[D,O,B,q,z,Y,$,y,ii,re,L,x],encapsulation:2})}}return t})();function ua(t,m){t&1&&C(0,"perun-web-apps-loading-dialog")}function _a(t,m){if(t&1){let e=b();r(0,"div")(1,"h1",2),d(2),c(3,"translate"),a(),r(4,"div",3)(5,"mat-form-field")(6,"mat-label"),d(7),c(8,"translate"),a(),r(9,"input",4),ie("ngModelChange",function(i){g(e);let s=u();return te(s.name,i)||(s.name=i),h(i)}),a(),r(10,"mat-error"),d(11),c(12,"translate"),a()()(),r(13,"div",5)(14,"button",6),S("click",function(){g(e);let i=u();return h(i.onCancel())}),d(15),c(16,"translate"),a(),r(17,"button",7),S("click",function(){g(e);let i=u();return h(i.onSubmit())}),d(18),c(19,"translate"),a()()()}if(t&2){let e=u();n(2),M(p(3,7,"DIALOGS.CREATE_RESOURCE_TAG.TITLE")),n(5),M(p(8,9,"DIALOGS.CREATE_RESOURCE_TAG.NAME")),n(2),ee("ngModel",e.name),n(2),M(p(12,11,"DIALOGS.CREATE_RESOURCE_TAG.EMPTY_NAME")),n(4),f(" ",p(16,13,"DIALOGS.CREATE_RESOURCE_TAG.CANCEL")," "),n(2),_("disabled",e.loading),n(),f(" ",p(19,15,"DIALOGS.CREATE_RESOURCE_TAG.CREATE")," ")}}var Po=(()=>{class t{constructor(e,o,i){this.dialogRef=e,this.data=o,this.resourceManager=i,this.name="",this.loading=!1}ngOnInit(){this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.name!==""&&(this.loading=!0,this.resourceManager.createResourceTagWithTagName(this.name,this.data.voId).subscribe(()=>{this.dialogRef.close(!0)},()=>this.loading=!1))}static{this.\u0275fac=function(o){return new(o||t)(l(W),l(H),l(V))}}static{this.\u0275cmp=I({type:t,selectors:[["app-create-resource-tag-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],["matInput","","required","",3,"ngModelChange","ngModel"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(o,i){if(o&1&&(R(0,ua,1,0,"ng-template",null,0,G),r(2,"div"),R(3,_a,20,17,"div",1),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,Ae,be,He,wt,ot,it,Xe,Qe,ge,Gi,Ke,he,q,z,Y,$,me,y,L,x],encapsulation:2})}}return t})();function ga(t,m){if(t&1){let e=b();r(0,"button",8),S("click",function(){g(e);let i=u();return h(i.create())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"VO_DETAIL.RESOURCES.TAGS.CREATE_BUTTON")," "))}function ha(t,m){if(t&1){let e=b();r(0,"button",8),S("click",function(){g(e);let i=u();return h(i.addTag())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"RESOURCE_DETAIL.TAGS.ADD_BUTTON")," "))}function fa(t,m){if(t&1){let e=b();r(0,"button",9),S("click",function(){g(e);let i=u();return h(i.removeTags())}),d(1),c(2,"translate"),a()}if(t&2){let e=u();_("disabled",e.loading||e.selection.selected.length===0),n(),f(" ",p(2,2,"RESOURCE_DETAIL.TAGS.REMOVE_BUTTON")," ")}}function Sa(t,m){t&1&&C(0,"perun-web-apps-loading-table")}function va(t,m){if(t&1&&C(0,"app-resources-tags-list",10),t&2){let e=u();_("loading",e.loading)("displayColumns",e.displayedColumns)("entity","resource")("resourceTags",e.resourceTags)("filterValue",e.filterValue)("selection",e.selection)("cachedSubject",e.cachedSubject)}}var l0=(()=>{class t{constructor(e,o,i,s,v,T){this.authResolver=e,this.resourcesManager=o,this.dialog=i,this.notificator=s,this.translate=v,this.entityStorageService=T,this.loading=!1,this.resourceTags=[],this.selection=new P(!0,[],!0,(N,J)=>N.id===J.id),this.displayedColumns=[],this.cachedSubject=new _e(!0)}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.setAuthRights(),this.updateData()}removeTags(){let e=Q();e.width="450px",e.data={items:this.selection.selected.map(i=>i.tagName),title:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_TITLE",description:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_DESCRIPTION",theme:"resource-theme",type:"remove",showAsk:!0},this.dialog.open(Yt,e).afterClosed().subscribe(i=>{i&&this.resourcesManager.removeResourceTagsFromResource({resource:this.resource.id,resourceTags:this.selection.selected}).subscribe(()=>(this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.REMOVED_SUCCESSFULLY")),this.updateData()))})}addTag(){let e=Q();e.width="600px",e.data={voId:this.resource.voId,resourceId:this.resource.id,assignedTags:this.resourceTags,theme:"resource-theme"},this.dialog.open(No,e).afterClosed().subscribe(i=>{i&&(this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.ADDED_SUCCESSFULLY")),this.updateData())})}create(){let e=Q();e.width="450px",e.data={voId:this.resource.voId,theme:"resource-theme"},this.dialog.open(Po,e).afterClosed().subscribe(i=>{i&&(this.notificator.showSuccess(this.translate.instant("VO_DETAIL.RESOURCES.TAGS.CREATE_SUCCESS")),this.updateData())})}updateData(){this.loading=!0,this.selection.clear(),this.cachedSubject.next(!0),this.resourcesManager.getAllResourcesTagsForResource(this.resource.id).subscribe(e=>{this.resourceTags=e,this.selection.clear(),this.loading=!1})}setAuthRights(){let e={id:this.resource.voId,beanName:"Vo"};this.displayedColumns=[],this.createAuth=this.authResolver.isAuthorized("createResourceTag_ResourceTag_Vo_policy",[e]),this.addAuth=this.authResolver.isAuthorized("assignResourceTagToResource_ResourceTag_Resource_policy",[this.resource]),this.removeAuth=this.authResolver.isAuthorized("removeResourceTagFromResource_ResourceTag_Resource_policy",[this.resource]),this.displayedColumns=this.removeAuth?["select","id","name"]:["id","name"]}applyFilter(e){this.filterValue=e,this.updateData()}static{this.\u0275fac=function(o){return new(o||t)(l(U),l(V),l(Ie),l(k),l(ze),l(X))}}static{this.\u0275cmp=I({type:t,selectors:[["app-perun-web-apps-resource-tags"]],decls:12,vars:9,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","displayColumns","entity","resourceTags","filterValue","selection","cachedSubject",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"loading","displayColumns","entity","resourceTags","filterValue","selection","cachedSubject"]],template:function(o,i){if(o&1){let s=b();r(0,"h1",1),d(1),c(2,"translate"),a(),r(3,"perun-web-apps-refresh-button",2),S("refresh",function(){return g(s),h(i.updateData())}),a(),A(4,ga,3,3,"button",3),A(5,ha,3,3,"button",3),A(6,fa,3,4,"button",4),r(7,"perun-web-apps-debounce-filter",5),S("filter",function(T){return g(s),h(i.applyFilter(T))}),a(),R(8,Sa,1,0,"ng-template",null,0,G),r(10,"div",6),R(11,va,1,7,"app-resources-tags-list",7),a()}if(o&2){let s=w(9);n(),M(p(2,7,"RESOURCE_DETAIL.TAGS.TITLE")),n(3),E(i.createAuth?4:-1),n(),E(i.addAuth?5:-1),n(),E(i.removeAuth?6:-1),n(),_("placeholder","RESOURCE_DETAIL.TAGS.SEARCH"),n(4),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,ae,De,y,ii,L,re,x],encapsulation:2})}}return t})();var Ca=["*"];function Ra(t,m){t&1&&C(0,"perun-web-apps-loading-dialog")}function ba(t,m){t&1&&(r(0,"perun-web-apps-alert",8),d(1),c(2,"translate"),a()),t&2&&(_("alert_type","info"),n(),f(" ",p(2,2,"DIALOGS.ADD_BAN.ALREADY_BANNED")," "))}function Aa(t,m){if(t&1){let e=b();r(0,"button",15),S("click",function(){g(e),u();let i=w(6);return h(i.next())}),d(1),c(2,"translate"),a()}if(t&2){let e=u(2);_("disabled",e.disabled),n(),f(" ",p(2,2,"DIALOGS.ADD_BAN.NEXT")," ")}}function Ea(t,m){if(t&1){let e=b();r(0,"button",16),S("click",function(){g(e),u();let i=w(6);return h(i.previous())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"DIALOGS.ADD_BAN.BACK")," "))}function Ta(t,m){if(t&1){let e=b();r(0,"button",17),S("click",function(){g(e);let i=u(2);return h(i.addBan())}),d(1),c(2,"translate"),a()}if(t&2){let e=u(2);n(),f(" ",p(2,1,e.ban?"DIALOGS.ADD_BAN.UPDATE":"DIALOGS.ADD_BAN.ADD")," ")}}function Ma(t,m){if(t&1){let e=b();r(0,"div")(1,"h1",3),d(2),c(3,"translate"),a(),r(4,"div",4)(5,"mat-stepper",5,1)(7,"mat-step",6),c(8,"translate"),Mi(9),a(),r(10,"mat-step",7),c(11,"translate"),A(12,ba,3,4,"perun-web-apps-alert",8),C(13,"perun-web-apps-ban-specification",9),a()()(),r(14,"div",10)(15,"button",11),S("click",function(){g(e);let i=u();return h(i.cancelled.emit())}),d(16),c(17,"translate"),a(),A(18,Aa,3,4,"button",12),A(19,Ea,3,3,"button",13),A(20,Ta,3,3,"button",14),a()()}if(t&2){let e=w(6),o=u();n(2),M(p(3,12,"DIALOGS.ADD_BAN.TITLE")),n(3),_("linear",!0),n(2),_("completed",!o.disabled)("label",p(8,14,"DIALOGS.ADD_BAN.SELECTION")),n(3),_("label",p(11,16,"DIALOGS.ADD_BAN.SPECIFICATION")),n(2),E(o.ban?12:-1),n(),_("description",o.ban==null?null:o.ban.description)("validity",o.ban==null?null:o.ban.validityTo),n(3),f(" ",p(17,18,"DIALOGS.ADD_BAN.CANCEL")," "),n(2),E(e.selectedIndex!==(e==null||e._steps==null?null:e._steps.length)-1?18:-1),n(),E(e.selectedIndex===(e==null||e._steps==null?null:e._steps.length)-1?19:-1),n(),E(e.selectedIndex===(e==null||e._steps==null?null:e._steps.length)-1?20:-1)}}var Uo=(()=>{class t{constructor(){this.loading=!1,this.disabled=!1,this.add=new vt,this.cancelled=new vt}addBan(){this.add.emit({description:this.banForm.getDescription(),validity:this.banForm.getValidity()})}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275cmp=I({type:t,selectors:[["app-add-ban-dialog"]],viewQuery:function(o,i){if(o&1&&st(di,5),o&2){let s;lt(s=ct())&&(i.banForm=s.first)}},inputs:{loading:"loading",disabled:"disabled",theme:"theme",ban:"ban"},outputs:{add:"add",cancelled:"cancelled"},ngContentSelectors:Ca,decls:4,vars:5,consts:[["spinner",""],["stepper",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[3,"linear"],[3,"completed","label"],[3,"label"],[3,"alert_type"],[3,"description","validity"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto","me-2",3,"click"],["mat-flat-button","","color","accent",1,"me-2",3,"disabled"],["mat-stroked-button","",1,"me-2"],["mat-flat-button","","color","accent"],["mat-flat-button","","color","accent",1,"me-2",3,"click","disabled"],["mat-stroked-button","",1,"me-2",3,"click"],["mat-flat-button","","color","accent",3,"click"]],template:function(o,i){if(o&1&&(Ti(),R(0,Ra,1,0,"ng-template",null,0,G),r(2,"div"),R(3,Ma,21,20,"div",2),a()),o&2){let s=w(1);n(2),F(pe("",i.theme," position-relative")),n(),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,q,z,Y,$,Te,Ee,me,y,di,L,Bt,Nt,x],encapsulation:2})}}return t})();var Ia=()=>["checkbox","id","fullName"],jo=(()=>{class t{constructor(e,o,i,s,v,T){this.data=e,this.dialogRef=o,this.store=i,this.resourceService=s,this.notificator=v,this.cd=T,this.selection=new P(!1,[],!0,(N,J)=>N.id===J.id),this.loading=!1,this.displayedColumns=["checkbox","id","fullName","organization","email","logins"],this.members=[],this.filter=""}ngOnInit(){this.loading=!0,this.resourceService.getAssignedRichMembers(this.data.entityId).subscribe({next:e=>{this.members=e,this.loading=!1},error:()=>this.loading=!1}),this.selection.changed.subscribe(e=>{this.ban=this.data.bans.find(o=>o.memberId===e.source.selected[0]?.id)})}cancel(){this.dialogRef.close(!1)}submitBan(e){this.ban?this.updateBan(e):this.banMember(e)}banMember(e){this.loading=!0,this.resourceService.setResourceBan({banOnResource:{memberId:this.selection.selected[0].id,resourceId:this.data.entityId,description:e.description,validityTo:e.validity,id:0,beanName:"BanOnResource"}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.ADD_BAN.SUCCESS_MEMBER"),this.dialogRef.close(!0)},error:()=>this.loading=!1})}updateBan(e){this.loading=!0,this.resourceService.updateResourceBan({banOnResource:{id:this.ban.id,beanName:"BanOnFacility",resourceId:this.ban.resourceId,memberId:this.ban.memberId,description:e.description,validityTo:e.validity}}).subscribe({next:()=>{this.notificator.showSuccess("DIALOGS.UPDATE_BAN.SUCCESS"),this.dialogRef.close(!0)},error:()=>{this.loading=!1}})}static{this.\u0275fac=function(o){return new(o||t)(l(H),l(W),l(Me),l(V),l(k),l(Mt))}}static{this.\u0275cmp=I({type:t,selectors:[["app-add-resource-ban-dialog"]],decls:3,vars:13,consts:[[3,"add","cancelled","loading","disabled","theme","ban"],[3,"filter","placeholder"],[3,"loading","displayedColumns","disableRouting","disableCheckbox","members","selection","filter"]],template:function(o,i){o&1&&(r(0,"app-add-ban-dialog",0),S("add",function(v){return i.submitBan(v)})("cancelled",function(){return i.cancel()}),r(1,"perun-web-apps-debounce-filter",1),S("filter",function(v){return i.filter=v}),a(),C(2,"perun-web-apps-members-list",2),a()),o&2&&(_("loading",i.loading)("disabled",i.loading||i.selection.selected.length===0)("theme",i.data.theme)("ban",i.ban),n(),_("placeholder","DIALOGS.ADD_BAN.FILTER"),n(),_("loading",i.loading)("displayedColumns",de(12,Ia))("disableRouting",!0)("disableCheckbox",!1)("members",i.members)("selection",i.selection)("filter",i.filter))},dependencies:[D,ae,Uo,Qt],encapsulation:2})}}return t})();function Da(t,m){if(t&1){let e=b();r(0,"button",8),S("click",function(){g(e);let i=u();return h(i.add())}),d(1),c(2,"translate"),a()}t&2&&(n(),f(" ",p(2,1,"RESOURCE_DETAIL.SETTINGS.BANS.ADD")," "))}function xa(t,m){if(t&1){let e=b();r(0,"button",9),S("click",function(){g(e);let i=u();return h(i.remove())}),d(1),c(2,"translate"),a()}if(t&2){let e=u();_("disabled",e.loading||e.selection.selected.length===0),n(),f(" ",p(2,2,"RESOURCE_DETAIL.SETTINGS.BANS.REMOVE")," ")}}function ya(t,m){if(t&1){let e=b();r(0,"perun-web-apps-ban-on-entity-list",10),S("updateBan",function(i){g(e);let s=u();return h(s.update(i))}),a()}if(t&2){let e=u();_("loading",e.loading)("bans",e.bans)("selection",e.selection)("cachedSubject",e.cachedSubject)("displayColumns",e.displayedColumns)("filter",e.filter)("updatePolicy","updateBan_BanOnResource_policy")}}function wa(t,m){t&1&&C(0,"perun-web-apps-loading-table")}var n_=(()=>{class t{constructor(e,o,i,s,v,T,N){this.resourceService=e,this.entityService=o,this.authResolver=i,this.dialog=s,this.notificator=v,this.store=T,this.userName=N,this.loading=!1,this.bans=[],this.removeAuth=!1,this.filter="",this.selection=new P(!1,[],!0,(J,fe)=>J.ban.id===fe.ban.id),this.cachedSubject=new _e(!0),this.attrNames=[Ce.MEMBER_DEF_MAIL,Ce.USER_DEF_PREFERRED_MAIL].concat(this.store.getLoginAttributeNames()),this.displayedColumns=["select","banId","subjectId","subjectName","description","expiration","edit"]}ngOnInit(){this.loading=!0,this.resource=this.entityService.getEntity(),this.addAuth=this.authResolver.isAuthorized("setBan_BanOnResource_policy",[this.resource]),this.removeAuth=this.authResolver.isAuthorized("resource-removeBan_int_policy",[this.resource]),this.refresh()}refresh(){this.loading=!0,this.resourceService.getEnrichedBansForResource(this.resource.id,this.attrNames).subscribe({next:e=>{this.bans=e,this.selection.clear(),this.cachedSubject.next(!0),this.loading=!1},error:()=>this.loading=!1})}add(){let e=Q();e.width="850px",e.data={entityId:this.resource.id,theme:"resource-theme",bans:this.bans.map(i=>i.ban)},this.dialog.open(jo,e).afterClosed().subscribe(i=>{i&&this.refresh()})}remove(){let e=Q();e.width="550px",e.data={theme:"resource-theme",title:"DIALOGS.REMOVE_BAN.TITLE",description:"DIALOGS.REMOVE_BAN.DESCRIPTION",items:[this.userName.transform(this.selection.selected[0].member.user)],type:"remove",showAsk:!0},this.dialog.open(Yt,e).afterClosed().subscribe(i=>{i&&this.resourceService.removeResourceBanById(this.selection.selected[0].ban.id).subscribe(()=>{this.notificator.showSuccess("DIALOGS.REMOVE_BAN.SUCCESS"),this.refresh()})})}update(e){let o=Q();o.width="600px",o.data={ban:e.ban,theme:"facility-theme"},this.dialog.open(So,o).afterClosed().subscribe(s=>{s&&this.refresh()})}applyFilter(e){this.filter=e,this.refresh()}static{this.\u0275fac=function(o){return new(o||t)(l(V),l(X),l(U),l(Ie),l(k),l(Me),l(Gt))}}static{this.\u0275cmp=I({type:t,selectors:[["app-resource-settings-bans"]],features:[Tt([Gt])],decls:11,vars:8,consts:[["spinner",""],[1,"page-subtitle"],[3,"click"],["color","accent","mat-flat-button","",1,"me-2","action-button"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[1,"mt-2","search-field",3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","bans","selection","cachedSubject","displayColumns","filter","updatePolicy","updateBan",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"updateBan","loading","bans","selection","cachedSubject","displayColumns","filter","updatePolicy"]],template:function(o,i){if(o&1){let s=b();r(0,"h1",1),d(1),c(2,"translate"),a(),r(3,"perun-web-apps-refresh-button",2),S("click",function(){return g(s),h(i.refresh())}),a(),A(4,Da,3,3,"button",3),A(5,xa,3,4,"button",4),r(6,"perun-web-apps-debounce-filter",5),S("filter",function(T){return g(s),h(i.applyFilter(T))}),a(),r(7,"div",6),R(8,ya,1,7,"perun-web-apps-ban-on-entity-list",7),a(),R(9,wa,1,0,"ng-template",null,0,G)}if(o&2){let s=w(10);n(),f(" ",p(2,6,"RESOURCE_DETAIL.SETTINGS.BANS.TITLE"),`
`),n(3),E(i.addAuth?4:-1),n(),E(i.removeAuth?5:-1),n(),_("placeholder","RESOURCE_DETAIL.SETTINGS.BANS.FILTER"),n(2),_("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[D,O,B,ae,De,y,co,L,re,x],encapsulation:2})}}return t})();export{ei as a,Co as b,Lo as c,Po as d,ii as e,bs as f,Gs as g,Gl as h,Pl as i,Ql as j,sc as k,vd as l,Rm as m,jm as n,l0 as o,Uo as p,n_ as q};
