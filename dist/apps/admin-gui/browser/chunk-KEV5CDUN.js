import{a as $i,b as Xi,c as qi,d as Ki}from"./chunk-2TUPQKFU.js";import{a as Ci,b as yi,c as Ti,d as Ei,e as Ai,f as Fi,g as xi,h as Ri,i as wi,j as Li,k as Mi,l as Oi}from"./chunk-SK5ZAUF4.js";import{a as zi}from"./chunk-H6XI2M43.js";import"./chunk-J2VXAWWK.js";import{k as Wi}from"./chunk-ZNW2DWTB.js";import"./chunk-DHUIQDBZ.js";import{a as Pe}from"./chunk-TT5XS7ML.js";import{$b as L,$j as Ge,Aa as u,Ai as Ve,Ba as T,Ca as _,Cc as k,Da as oe,Db as w,Dc as yt,E as it,Ea as ct,Eh as Oe,F as Te,Ga as pt,Gb as vt,Gg as ri,Gh as di,H as nt,Ib as xe,If as Zt,Ih as ui,Ij as Be,Ja as K,Jf as H,Ji as bi,Jj as Ni,K as E,Ka as qe,Kb as ie,Kj as ki,L as Ee,Lb as Re,Lc as Tt,Lf as ei,Lg as si,Mc as Qe,Me as we,Mf as ti,Mj as je,Na as p,Nc as Et,Ne as qt,Nf as ii,O as I,Oa as m,Of as ni,Oj as Vi,P as C,Pj as Pi,Qh as fi,Ra as U,Rc as se,Re as J,Rh as hi,Sd as Bt,T as Ae,Td as jt,Tj as Bi,Ub as re,Uc as At,Ud as Gt,Uh as gi,Vb as A,Wa as mt,Xa as dt,Xb as St,Y as r,Ya as x,Ye as R,Z as d,Za as ut,Zb as It,Ze as Le,Zh as _i,_ as at,_a as ft,_b as Ct,aa as Fe,ad as Ft,ae as De,ai as vi,ak as ji,bk as Gi,ca as ot,cb as ht,cf as Kt,d as G,da as v,de as Ut,ee as Yt,ef as Y,ei as Si,ej as Di,fd as xt,fe as Ht,fh as li,fk as Ui,ga as c,gc as j,gd as Rt,ge as Wt,gi as Ii,gk as Yi,ha as N,hf as Qt,hh as ee,hi as Ne,i as Se,ia as ce,id as Dt,if as Jt,jd as wt,ka as l,kk as Hi,la as s,lc as bt,ld as Lt,ma as S,od as Mt,of as Z,oh as ci,pa as y,pe as Je,ph as Me,qa as g,qb as me,qd as le,ra as h,sd as Ot,tb as de,tc as ue,th as pi,ua as pe,ub as gt,uc as fe,ud as ve,ue as zt,vc as P,ve as $t,vh as mi,wa as rt,wb as Ke,wc as he,wd as Nt,x as Ie,xa as st,xc as ge,xd as kt,xe as M,ya as lt,yb as _t,yc as _e,yd as Vt,ye as Xt,yg as ai,yi as ke,z as tt,za as D,zd as Pt,zg as oi,zh as W}from"./chunk-SXQFEYKP.js";import"./chunk-2YRG3NBG.js";function _n(i,o){i&1&&S(0,"mat-spinner",3)}function vn(i,o){if(i&1){let n=y();l(0,"button",12),g("click",function(){I(n);let t=h(2);return C(t.editFacility())}),p(1,"translate"),l(2,"mat-icon"),u(3,"edit"),s()()}i&2&&pe("matTooltip",m(1,1,"FACILITY_DETAIL.EDIT"))}function Sn(i,o){if(i&1){let n=y();l(0,"button",12),g("click",function(){I(n);let t=h(2);return C(t.deleteFacility())}),p(1,"translate"),l(2,"mat-icon"),u(3,"delete_forever"),s()()}i&2&&pe("matTooltip",m(1,1,"FACILITY_DETAIL.DELETE"))}var In=()=>({color:"black"}),Qi=i=>["/facilities",i];function Cn(i,o){if(i&1&&(l(0,"div")(1,"div",4),S(2,"mat-icon",5),p(3,"translate"),l(4,"div",6)(5,"div",7)(6,"a",8),g("auxclick",function(e){return e.preventDefault()}),u(7),s(),l(8,"span",9),u(9),s(),v(10,vn,4,3,"button",10)(11,Sn,4,3,"button",10),s(),l(12,"div"),u(13),p(14,"translate"),s(),l(15,"span",11),u(16),p(17,"translate"),p(18,"translate"),s()()(),S(19,"app-animated-router-outlet"),s()),i&2){let n=h();r(2),pe("matTooltip",m(3,13,"FACILITY_DETAIL.ENTITY")),c("ngStyle",K(21,In)),r(4),c("perunWebAppsMiddleClickRouterLink",qe(22,Qi,n.facility.id.toString()))("routerLink",qe(24,Qi,n.facility.id)),r(),T(n.facility.name),r(2),_(" \xA0#",n.facility.id," "),r(),c("ngIf",n.editFacilityAuth),r(),c("ngIf",n.deleteAuth),r(2),oe("",m(14,15,"FACILITY_DETAIL.UUID"),": ",n.facility.uuid,""),r(3),ct(" ",m(17,17,"FACILITY_DETAIL.ENTITY"),", ",m(18,19,"FACILITY_DETAIL.DESCRIPTION"),": ",n.facility.description," ")}}var Zi=(()=>{let o=class o extends Ci(){constructor(e,t,a,f,b,F,B,V,q){super(),this.dialog=e,this.facilityManager=t,this.route=a,this.sideMenuService=f,this.sideMenuItemService=b,this.guiAuthResolver=F,this.router=B,this.entityStorageService=V,this.reloadEntityDetail=q,this.editFacilityAuth=!1,this.deleteAuth=!1,this.loading=!1}ngOnInit(){this.reloadData(),this.reloadEntityDetail.entityDetailChange.pipe(tt(this.destroyed$)).subscribe(()=>{this.reloadData()})}reloadData(){this.loading=!0,this.route.params.subscribe(e=>{let t=Number(e.facilityId);this.facilityManager.getFacilityById(t).subscribe({next:a=>{this.facility=a,this.entityStorageService.setEntityAndPathParam({id:a.id,beanName:a.beanName},It.Facility),this.setMenuItems(),this.editFacilityAuth=this.guiAuthResolver.isAuthorized("updateFacility_Facility_policy",[this.facility]),this.deleteAuth=this.guiAuthResolver.isAuthorized("deleteFacility_Facility_Boolean_policy",[this.facility]),zt("facilities",this.facility),$t(this.facility),this.loading=!1},error:()=>this.loading=!1})})}setMenuItems(){let e=this.sideMenuItemService.parseFacility(this.facility);this.sideMenuService.setFacilityMenuItems([e])}editFacility(){let e=M();e.width="450px",e.data={theme:"facility-theme",facility:this.facility,dialogType:Qt.FACILITY},this.dialog.open(Jt,e).afterClosed().subscribe(a=>{a&&this.facilityManager.getFacilityById(this.facility.id).subscribe(f=>{this.facility=f,this.setMenuItems()})})}deleteFacility(){let e=M();e.width="500px",e.data={theme:"facility-theme",facility:this.facility},this.dialog.open(Bi,e).afterClosed().subscribe(a=>{a&&this.router.navigate([""],{queryParamsHandling:"preserve"})})}};o.\u0275fac=function(t){return new(t||o)(d(P),d(w),d(me),d(Kt),d(Si),d(L),d(de),d(R),d(Ii))},o.\u0275cmp=E({type:o,selectors:[["app-facility-detail-page"]],features:[ot],decls:4,vars:2,consts:[[1,"container-fluid","ps-xl-5","pe-xl-5","facility-theme"],["class","me-auto ms-auto",4,"ngIf"],[4,"ngIf"],[1,"me-auto","ms-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-facility-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],[1,"facility-link",3,"perunWebAppsMiddleClickRouterLink","routerLink","auxclick"],[1,"text-muted"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],[1,"mt-1","entity-info"],["mat-icon-button","",3,"matTooltip","click"]],template:function(t,a){t&1&&(l(0,"div",0),S(1,"perun-web-apps-back-button"),v(2,_n,1,0,"mat-spinner",1)(3,Cn,20,26,"div",2),s()),t&2&&(r(2),c("ngIf",a.loading),r(),c("ngIf",!a.loading&&a.facility!==void 0))},dependencies:[x,ut,gt,le,yt,ve,De,Ne,li,ti,ii,A],data:{animation:[Oe]}});let i=o;return i})();function yn(i,o){i&1&&S(0,"mat-spinner",2)}function Tn(i,o){if(i&1&&(l(0,"div"),S(1,"perun-web-apps-menu-buttons-field",3)(2,"perun-web-apps-expandable-tiles",4),s()),i&2){let n=h();r(),c("items",n.items),r(),c("items",n.settingItems)("title","MENU_ITEMS.FACILITY.SETTINGS")("sectionId","settings")}}var en=(()=>{let o=class o{constructor(e,t,a,f){this.facilityManager=e,this.authResolver=t,this.entityStorageService=a,this.routePolicyService=f,this.items=[],this.settingItems=[],this.loading=!1}ngOnInit(){this.loading=!0,this.facility=this.entityStorageService.getEntity(),this.setItems(),this.setSettingsItems(),this.loading=!1}setItems(){this.items=[],this.routePolicyService.canNavigate("facilities-resources",this.facility)&&this.items.push({cssIcon:"perun-manage-facility",url:`/facilities/${this.facility.id}/resources`,label:"MENU_ITEMS.FACILITY.RESOURCES",style:"facility-btn"}),this.routePolicyService.canNavigate("facilities-allowed-users",this.facility)&&this.items.push({cssIcon:"perun-user",url:`/facilities/${this.facility.id}/allowed-users`,label:"MENU_ITEMS.FACILITY.ALLOWED_USERS",style:"facility-btn"}),this.routePolicyService.canNavigate("facilities-allowed-groups",this.facility)&&this.items.push({cssIcon:"perun-group",url:`/facilities/${this.facility.id}/allowed-groups`,label:"MENU_ITEMS.FACILITY.ALLOWED_GROUPS",style:"facility-btn"}),this.routePolicyService.canNavigate("facilities-services-status",this.facility)&&this.items.push({cssIcon:"perun-service-status",url:`/facilities/${this.facility.id}/services-status`,label:"MENU_ITEMS.FACILITY.SERVICES_STATUS",style:"facility-btn"}),this.routePolicyService.canNavigate("facilities-services-destinations",this.facility)&&this.items.push({cssIcon:"perun-service_destination",url:`/facilities/${this.facility.id}/services-destinations`,label:"MENU_ITEMS.FACILITY.SERVICES_DESTINATIONS",style:"facility-btn"}),this.routePolicyService.canNavigate("facilities-hosts",this.facility)&&this.items.push({cssIcon:"perun-hosts",url:`/facilities/${this.facility.id}/hosts`,label:"MENU_ITEMS.FACILITY.HOSTS",style:"facility-btn"}),this.routePolicyService.canNavigate("facilities-attributes",this.facility)&&this.items.push({cssIcon:"perun-attributes",url:`/facilities/${this.facility.id}/attributes`,label:"MENU_ITEMS.FACILITY.ATTRIBUTES",style:"facility-btn"})}setSettingsItems(){this.settingItems=[],this.routePolicyService.canNavigate("facilities-settings-managers",this.facility)&&this.settingItems.push({cssIcon:"perun-manager",url:`/facilities/${this.facility.id}/settings/managers`,label:"MENU_ITEMS.FACILITY.MANAGERS",style:"facility-btn"}),this.routePolicyService.canNavigate("facilities-settings-bans",this.facility)&&this.settingItems.push({cssIcon:"perun-ban",url:`/facilities/${this.facility.id}/settings/bans`,label:"MENU_ITEMS.FACILITY.BANS",style:"facility-btn"})}};o.\u0275fac=function(t){return new(t||o)(d(w),d(L),d(R),d(Le))},o.\u0275cmp=E({type:o,selectors:[["app-facility-overview"]],hostVars:2,hostBindings:function(t,a){t&2&&N("router-component",a.true)},decls:2,vars:2,consts:[["class","me-auto ms-auto",4,"ngIf"],[4,"ngIf"],[1,"me-auto","ms-auto"],[3,"items"],[3,"items","title","sectionId"]],template:function(t,a){t&1&&v(0,yn,1,0,"mat-spinner",0)(1,Tn,3,4,"div",1),t&2&&(c("ngIf",a.loading),r(),c("ngIf",!a.loading))},dependencies:[x,ve,Me,_i]});let i=o;return i})();var tn=(()=>{let o=class o{};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=E({type:o,selectors:[["app-facility-settings"]],hostVars:2,hostBindings:function(t,a){t&2&&N("router-component",a.true)},decls:1,vars:0,template:function(t,a){t&1&&S(0,"app-animated-router-outlet")},dependencies:[Ne],data:{animation:[Oe]}});let i=o;return i})();function En(i,o){i&1&&S(0,"mat-spinner",2)}function An(i,o){if(i&1&&(l(0,"div"),S(1,"perun-web-apps-menu-buttons-field",3),s()),i&2){let n=h();r(),c("items",n.items)}}var nn=(()=>{let o=class o{constructor(e,t,a,f){this.facilityManager=e,this.authResolver=t,this.entityStorageService=a,this.routePolicyService=f,this.items=[],this.loading=!1}ngOnInit(){this.loading=!0,this.facility=this.entityStorageService.getEntity(),this.initItems(),this.loading=!1}initItems(){this.items=[],this.routePolicyService.canNavigate("facilities-settings-managers",this.facility)&&this.items.push({cssIcon:"perun-manager",url:`/facilities/${this.facility.id}/settings/managers`,label:"MENU_ITEMS.FACILITY.MANAGERS",style:"facility-btn"}),this.routePolicyService.canNavigate("facilities-settings-bans",this.facility)&&this.items.push({cssIcon:"perun-ban",url:`/facilities/${this.facility.id}/settings/bans`,label:"MENU_ITEMS.FACILITY.BANS",style:"facility-btn"})}};o.\u0275fac=function(t){return new(t||o)(d(w),d(L),d(R),d(Le))},o.\u0275cmp=E({type:o,selectors:[["app-facility-settings-overview"]],hostVars:2,hostBindings:function(t,a){t&2&&N("router-component",a.true)},decls:2,vars:2,consts:[["class","me-auto ms-auto",4,"ngIf"],[4,"ngIf"],[1,"me-auto","ms-auto"],[3,"items"]],template:function(t,a){t&1&&v(0,En,1,0,"mat-spinner",0)(1,An,2,1,"div",1),t&2&&(c("ngIf",a.loading),r(),c("ngIf",!a.loading))},dependencies:[x,ve,Me]});let i=o;return i})();function xn(i,o){i&1&&(u(0),p(1,"translate")),i&2&&_(" ",m(1,1,"FACILITY_DETAIL.ENTITY")," ")}function Rn(i,o){if(i&1&&S(0,"app-one-entity-attribute-page",5),i&2){let n=h();c("entityId",n.facility.id)("entity","facility")}}function Dn(i,o){i&1&&(u(0),p(1,"translate"),p(2,"translate")),i&2&&oe(" ",m(1,2,"FACILITY_DETAIL.ENTITY")," - ",m(2,4,"ADMIN_USER.ENTITY")," ")}function wn(i,o){if(i&1&&S(0,"app-two-entity-attribute-page",6),i&2){let n=h(2);c("firstEntity","facility")("firstEntityId",n.facility.id)("secondEntity","user")}}function Ln(i,o){i&1&&(l(0,"mat-tab"),v(1,Dn,3,6,"ng-template",2)(2,wn,1,3,"ng-template",3),s())}var an=(()=>{let o=class o{constructor(e,t){this.authResolver=e,this.entityStorageService=t}ngOnInit(){this.facility=this.entityStorageService.getEntity(),this.facilityUserAttAuth=this.authResolver.isAuthorized("getAssignedUsers_Facility_policy",[this.facility])}};o.\u0275fac=function(t){return new(t||o)(d(L),d(R))},o.\u0275cmp=E({type:o,selectors:[["app-facility-attributes"]],hostVars:2,hostBindings:function(t,a){t&2&&N("router-component",a.true)},decls:9,vars:4,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(t,a){t&1&&(l(0,"div")(1,"h1",0),u(2),p(3,"translate"),s(),l(4,"mat-tab-group",1)(5,"mat-tab"),v(6,xn,2,3,"ng-template",2)(7,Rn,1,2,"ng-template",3),s(),v(8,Ln,3,0,"mat-tab",4),s()()),t&2&&(r(2),T(m(3,2,"FACILITY_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),r(6),c("ngIf",a.facilityUserAttAuth))},dependencies:[x,Ut,Yt,Ht,Wt,bi,ke,A]});let i=o;return i})();function On(i,o){if(i&1){let n=y();l(0,"mat-option",10),g("onSelectionChange",function(){let a=I(n).$implicit,f=h(3);return C(f.onSelectedService(a))}),u(1),s()}if(i&2){let n=o.$implicit;c("value",n),r(),_(" ",n.name," ")}}function Nn(i,o){if(i&1){let n=y();l(0,"mat-form-field",6)(1,"mat-label"),u(2),p(3,"translate"),s(),l(4,"input",7),g("keyup",function(t){I(n);let a=h(2);return C(a.updatedSerVal(t))}),s(),l(5,"mat-autocomplete",8,9)(7,"mat-option",10),g("onSelectionChange",function(){I(n);let t=h(2);return C(t.onSelectedService("NOT_SELECTED"))}),u(8),p(9,"translate"),s(),l(10,"mat-option",10),g("onSelectionChange",function(){I(n);let t=h(2);return C(t.onSelectedService("ALL"))}),u(11),p(12,"translate"),s(),v(13,On,2,2,"mat-option",11),p(14,"async"),s()()}if(i&2){let n=D(6),e=h(2);r(2),T(m(3,9,"FACILITY_DETAIL.SERVICE_CONFIG.SERVICE_SELECT")),r(2),c("formControl",e.serviceField)("matAutocomplete",n),r(),c("displayWith",e.serviceDisplayFn.bind(e)),r(2),c("value","NOT_SELECTED"),r(),_(" ",m(9,11,"FACILITY_DETAIL.SERVICE_CONFIG.NOT_SELECTED")," "),r(2),c("value","ALL"),r(),_(" ",m(12,13,"FACILITY_DETAIL.SERVICE_CONFIG.ALL")," "),r(2),c("ngForOf",m(14,15,e.filteredServices))}}function kn(i,o){if(i&1){let n=y();l(0,"mat-option",10),g("onSelectionChange",function(){let a=I(n).$implicit,f=h(3);return C(f.onSelectedResource(a))}),u(1),s()}if(i&2){let n=o.$implicit;c("value",n),r(),_(" ",n.name," ")}}function Vn(i,o){if(i&1){let n=y();l(0,"mat-form-field",6)(1,"mat-label"),u(2),p(3,"translate"),s(),l(4,"input",7),g("keyup",function(t){I(n);let a=h(2);return C(a.updatedResVal(t))}),s(),l(5,"mat-autocomplete",8,9),v(7,kn,2,2,"mat-option",11),p(8,"async"),s()()}if(i&2){let n=D(6),e=h(2);r(2),T(m(3,5,"FACILITY_DETAIL.SERVICE_CONFIG.RES_SELECT")),r(2),c("formControl",e.resourceField)("matAutocomplete",n),r(),c("displayWith",e.resourceDisplayFn.bind(e)),r(2),c("ngForOf",m(8,7,e.filteredResources))}}function Pn(i,o){if(i&1){let n=y();l(0,"mat-option",10),g("onSelectionChange",function(){let a=I(n).$implicit,f=h(3);return C(f.onSelectedGroup(a))}),u(1),s()}if(i&2){let n=o.$implicit;c("value",n),r(),_(" ",n.name," ")}}function Bn(i,o){if(i&1){let n=y();l(0,"mat-form-field",6)(1,"mat-label"),u(2),p(3,"translate"),s(),l(4,"input",7),g("keyup",function(t){I(n);let a=h(2);return C(a.updatedGroupVal(t))}),s(),l(5,"mat-autocomplete",12,9),v(7,Pn,2,2,"mat-option",11),p(8,"async"),s()()}if(i&2){let n=D(6),e=h(2);r(2),T(m(3,5,"FACILITY_DETAIL.SERVICE_CONFIG.GROUP_SELECT")),r(2),c("formControl",e.groupField)("matAutocomplete",n),r(),c("displayWith",e.groupDisplayFn.bind(e)),r(2),c("ngForOf",m(8,7,e.filteredGroups))}}function jn(i,o){if(i&1){let n=y();l(0,"mat-option",10),g("onSelectionChange",function(){let a=I(n).$implicit,f=h(3);return C(f.onSelectedMember(a))}),u(1),p(2,"userFullName"),s()}if(i&2){let n=o.$implicit;c("value",n),r(),_(" ",m(2,2,n.user)," ")}}function Gn(i,o){if(i&1&&(l(0,"mat-form-field",6)(1,"mat-label"),u(2),p(3,"translate"),s(),S(4,"input",13),l(5,"mat-autocomplete",8,9),v(7,jn,3,4,"mat-option",11),p(8,"async"),s()()),i&2){let n=D(6),e=h(2);r(2),T(m(3,5,"FACILITY_DETAIL.SERVICE_CONFIG.MEMBER_SELECT")),r(2),c("matAutocomplete",n)("formControl",e.memberField),r(),c("displayWith",e.memberDisplayFn.bind(e)),r(2),c("ngForOf",m(8,7,e.filteredMembers))}}function Un(i,o){if(i&1){let n=y();l(0,"div",3),v(1,Nn,15,17,"mat-form-field",4),l(2,"mat-checkbox",5),g("change",function(t){I(n);let a=h();return C(a.onOfferAllServices(t))}),u(3),p(4,"translate"),s(),v(5,Vn,9,9,"mat-form-field",4)(6,Bn,9,9,"mat-form-field",4)(7,Gn,9,9,"mat-form-field",4),s()}if(i&2){let n=h();r(),c("ngIf",n.services!==void 0),r(2),_(" ",m(4,5,"FACILITY_DETAIL.SERVICE_CONFIG.ALL_SERVICES")," "),r(2),c("ngIf",n.resources!==void 0&&n.resources.length!==0),r(),c("ngIf",n.selectedResource!==void 0&&n.groups!==void 0&&n.groups.length!==0),r(),c("ngIf",n.selectedGroup!==void 0&&n.members!==void 0&&n.members.length!==0)}}function Yn(i,o){if(i&1&&S(0,"perun-web-apps-service-configurator",14),i&2){let n=h();c("facility",n.facility)("resource",n.selectedResource)("group",n.selectedGroup)("member",n.selectedMember)("service",n.selectedService)}}var on=(()=>{let o=class o{constructor(e,t,a,f,b,F,B){this.facilityManager=e,this.resourceManager=t,this.serviceManager=a,this.membersManager=f,this.namePipe=b,this.translate=F,this.entityStorageService=B,this.serviceField=new se,this.resourceField=new se,this.groupField=new se,this.memberField=new se,this.allowedStatuses=["INVALID","VALID"],this.selectedService="NOT_SELECTED",this.attrNames=[],this.translate.get("FACILITY_DETAIL.SERVICE_CONFIG.ALL").subscribe(V=>this.serviceAllTranslation=V),this.translate.get("FACILITY_DETAIL.SERVICE_CONFIG.NOT_SELECTED").subscribe(V=>this.serviceNotSelectedTranslation=V)}ngOnInit(){this.facility=this.entityStorageService.getEntity(),this.facilityManager.getFacilityById(this.facility.id).subscribe(e=>{this.facility=e,this.facilityManager.getAssignedResourcesForFacility(e.id).subscribe(t=>this.resources=t),this.serviceManager.getAssignedServices(e.id).subscribe(t=>this.services=t)}),this.filteredServices=this.serviceField.valueChanges.pipe(Ie(""),Se(e=>this._filterServices(e))),this.filteredResources=this.resourceField.valueChanges.pipe(Ie(""),Se(e=>this._filterResources(e))),this.filteredGroups=this.groupField.valueChanges.pipe(Ie(""),Se(e=>this._filterGroups(e))),this.filteredMembers=this.memberField.valueChanges.pipe(Ie(""),Se(e=>this._filterMembers(e)))}onSelectedService(e){this.selectedService=e}onSelectedResource(e){this.selectedResource=e,this.selectedResource!==void 0?(this.resourceManager.getAssignedGroups(this.selectedResource.id).subscribe(t=>this.groups=t),this.selectedGroup=void 0,this.selectedMember=void 0):this.groups=void 0}onOfferAllServices(e){e.checked||this.serviceManager.getAssignedServices(this.facility.id).subscribe(t=>this.services=t)}onSelectedGroup(e){this.selectedGroup=e,this.selectedGroup!==void 0?(this.membersManager.getCompleteRichMembersForGroup(this.selectedGroup.id,!1,this.allowedStatuses,[],this.attrNames).subscribe(t=>this.members=t),this.selectedMember=void 0):this.members=void 0}onSelectedMember(e){this.selectedMember=e}serviceDisplayFn(e){if(e!==null)return e==="ALL"?this.serviceAllTranslation:e==="NOT_SELECTED"?this.serviceNotSelectedTranslation:typeof e!="string"?e.name:e}resourceDisplayFn(e){if(e!==null)return e.name}groupDisplayFn(e){if(e!==null)return e.name}memberDisplayFn(e){if(e!==null)return this.namePipe.transform(e.user)}updatedSerVal(e){e.target.value===""&&(this.selectedService="NOT_SELECTED")}updatedResVal(e){e.target.value===""&&(this.groups=void 0,this.members=void 0)}updatedGroupVal(e){e.target.value===""&&(this.members=void 0)}_filterServices(e){let t=e.toString().toLowerCase();return this.services.filter(a=>a.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t))}_filterResources(e){let t=e.toString().toLowerCase();return this.resources.filter(a=>a.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t))}_filterGroups(e){let t=e.toString().toLowerCase();return this.groups.filter(a=>a.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t))}_filterMembers(e){let t=e.toString().toLowerCase();return this.members.filter(a=>this.namePipe.transform(a.user).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t))}};o.\u0275fac=function(t){return new(t||o)(d(w),d(xe),d(ie),d(vt),d(Z),d(re),d(R))},o.\u0275cmp=E({type:o,selectors:[["app-facility-service-config"]],decls:6,vars:5,consts:[[1,"page-subtitle"],["class","col-12 col-lg-6 mb-2",4,"ngIf"],[3,"facility","resource","group","member","service",4,"ngIf"],[1,"col-12","col-lg-6","mb-2"],["class","w-100",4,"ngIf"],[3,"change"],[1,"w-100"],["matInput","","type","text",3,"formControl","matAutocomplete","keyup"],["autoActiveFirstOption","",3,"displayWith"],["auto","matAutocomplete"],[3,"value","onSelectionChange"],[3,"value","onSelectionChange",4,"ngFor","ngForOf"],["autoActiveFirstOption","",3,"displayWith","ngClass"],["matInput","","type","text",3,"matAutocomplete","formControl"],[3,"facility","resource","group","member","service"]],template:function(t,a){t&1&&(l(0,"div")(1,"h1",0),u(2),p(3,"translate"),s(),v(4,Un,8,7,"div",1)(5,Yn,1,5,"perun-web-apps-service-configurator",2),s()),t&2&&(r(2),T(m(3,3,"FACILITY_DETAIL.SERVICE_CONFIG.TITLE")),r(2),c("ngIf",!!a.facility),r(),c("ngIf",!!a.facility))},dependencies:[mt,dt,x,fi,bt,hi,Ot,Mt,Lt,Tt,Et,At,Ft,ft,A,Z]});let i=o;return i})();var Ye=(()=>{let o=class o{constructor(e,t,a){this.facilityService=e,this.guiAuthResolver=t,this.entityStorageService=a,this.disableRouting=!1,this.disableSelf=!1,this.availableRoles=[],this.selected="user",this.type="Facility",this.theme="facility-theme"}ngOnInit(){this.facility=this.entityStorageService.getEntity(),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Facility")}};o.\u0275fac=function(t){return new(t||o)(d(w),d(L),d(R))},o.\u0275cmp=E({type:o,selectors:[["app-perun-web-apps-facility-settings-managers"]],hostVars:2,hostBindings:function(t,a){t&2&&N("router-component",a.true)},inputs:{disableRouting:"disableRouting",disableSelf:"disableSelf"},decls:1,vars:6,consts:[[3,"complementaryObject","availableRoles","complementaryObjectType","disableSelf","disableRouting","theme"]],template:function(t,a){t&1&&S(0,"app-managers-page",0),t&2&&c("complementaryObject",a.facility)("availableRoles",a.availableRoles)("complementaryObjectType",a.type)("disableSelf",a.disableSelf)("disableRouting",a.disableRouting)("theme",a.theme)},dependencies:[Ve]});let i=o;return i})();function Xn(i,o){i&1&&(l(0,"perun-web-apps-alert",10),u(1),p(2,"translate"),s()),i&2&&(r(),_(" ",m(2,1,"FACILITY_DETAIL.SERVICES_DESTINATIONS.DESTINATIONS_INFO")," "))}function qn(i,o){if(i&1){let n=y();l(0,"button",11),g("click",function(){I(n);let t=h();return C(t.addDestination())}),u(1),p(2,"translate"),s()}i&2&&(r(),_(" ",m(2,1,"FACILITY_DETAIL.SERVICES_DESTINATIONS.ADD")," "))}function Kn(i,o){if(i&1){let n=y();l(0,"button",12),g("click",function(){I(n);let t=h();return C(t.removeDestination())}),u(1),p(2,"translate"),s()}if(i&2){let n=h();c("disabled",n.loading||n.selected.selected.length===0),r(),_(" ",m(2,2,"FACILITY_DETAIL.SERVICES_DESTINATIONS.REMOVE")," ")}}function Qn(i,o){if(i&1){let n=y();l(0,"button",13),g("click",function(){I(n);let t=h();return C(t.onAllow())}),l(1,"mat-icon"),u(2," check_circle_outline "),s(),u(3),p(4,"translate"),s()}if(i&2){let n=h();c("disabled",n.loading||n.selected.selected.length===0||n.allSelectedAllowed()),r(3),_(" ",m(4,2,"FACILITY_DETAIL.SERVICES_DESTINATIONS.ALLOW")," ")}}function Jn(i,o){if(i&1){let n=y();l(0,"button",13),g("click",function(){I(n);let t=h();return C(t.onBlock())}),l(1,"mat-icon"),u(2," block "),s(),u(3),p(4,"translate"),s()}if(i&2){let n=h();c("disabled",n.loading||n.selected.selected.length===0||n.allSelectedBlocked()),r(3),_(" ",m(4,2,"FACILITY_DETAIL.SERVICES_DESTINATIONS.BLOCK")," ")}}function Zn(i,o){i&1&&S(0,"perun-web-apps-loading-table")}function ea(i,o){if(i&1&&S(0,"app-perun-web-apps-destination-list",14),i&2){let n=h();c("filterValue",n.filterValue)("loading",n.loading)("selection",n.selected)("cachedSubject",n.cachedSubject)("destinations",n.destinations)("services",n.configServicesIds)("displayedColumns",n.displayedColumns)("tableId",n.tableId)}}var We=(()=>{let o=class o{constructor(e,t,a,f,b,F,B){this.dialog=e,this.servicesManager=t,this.translate=a,this.notificator=f,this.authResolver=b,this.serviceManager=F,this.entityStorageService=B,this.displayedColumns=["select","destinationId","service","destination","type","status","propagationType","lastSuccessfulPropagation","lastAttemptedPropagation"],this.configServices=[],this.configServicesIds=new Set,this.title="FACILITY_DETAIL.SERVICES_DESTINATIONS.TITLE",this.destinationEmitter=new Fe,this.destinations=[],this.selected=new j(!0,[],!0,(V,q)=>V.id===q.id&&V.facility?.id===q.facility?.id&&V.service?.id===q.service?.id),this.cachedSubject=new G(!0),this.filterValue="",this.tableId=ai}ngOnInit(){this.loading=!0,this.facility=this.entityStorageService.getEntity(),this.setAuthRights(),this.refreshTable()}refreshTable(){this.loading=!0,this.servicesManager.getAllRichDestinationsForFacility(this.facility.id).subscribe(e=>{this.destinations=e,this.destinationEmitter.emit(this.destinations),this.selected.clear(),this.cachedSubject.next(!0),this.setAuthRights(),this.loading=!1})}setAuthRights(){this.addAuth=this.authResolver.isAuthorized("addDestination_Service_Facility_Destination_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeDestination_Service_Facility_Destination_policy",[this.facility]),this.allowAuth=this.authResolver.isAuthorized("unblockServiceOnDestination_Service_int_policy",[this.facility]),this.blockAuth=this.authResolver.isAuthorized("blockServiceOnDestination_Service_int_policy",[this.facility]),this.displayedColumns=this.removeAuth?this.displayedColumns:this.displayedColumns.filter(e=>e!=="select")}addDestination(){let e=M();e.width="600px",e.data={facility:this.facility,theme:"facility-theme",configServices:this.configServices},this.dialog.open(ki,e).afterClosed().subscribe(a=>{a&&(this.refreshTable(),this.notificator.showSuccess(this.translate.instant("FACILITY_DETAIL.SERVICES_DESTINATIONS.ADD_SUCCESS")))})}removeDestination(){let e=M();e.width="600px",e.data={destinations:this.selected.selected,theme:"facility-theme"},this.dialog.open(Ni,e).afterClosed().subscribe(a=>{a&&this.refreshTable()})}blockServicesOnDestinations(e){this.serviceManager.blockServicesOnDestinations({richDestinations:e}).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("FACILITY_DETAIL.SERVICES_DESTINATIONS.BLOCK_SUCCESS")),this.refreshTable()},error:()=>this.loading=!1})}onBlock(){this.loading=!0,this.blockServicesOnDestinations(this.selected.selected)}allowServicesOnDestinations(e){this.serviceManager.unblockServicesOnDestinations({richDestinations:e}).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("FACILITY_DETAIL.SERVICES_DESTINATIONS.ALLOW_SUCCESS")),this.refreshTable()},error:()=>this.loading=!1})}onAllow(){this.loading=!0,this.allowServicesOnDestinations(this.selected.selected)}applyFilter(e){this.filterValue=e,this.refreshTable()}allSelectedAllowed(){return this.selected.selected.reduce((e,t)=>e&&!t.blocked,!0)}allSelectedBlocked(){return this.selected.selected.reduce((e,t)=>e&&t.blocked,!0)}};o.id="FacilityServicesDestinationsComponent",o.\u0275fac=function(t){return new(t||o)(d(P),d(ie),d(St),d(J),d(L),d(ie),d(R))},o.\u0275cmp=E({type:o,selectors:[["app-perun-web-apps-facility-services-destinations"]],hostVars:2,hostBindings:function(t,a){t&2&&N("router-component",a.true)},inputs:{displayedColumns:"displayedColumns",configServices:"configServices",configServicesIds:"configServicesIds",title:"title",loading:"loading"},outputs:{destinationEmitter:"destinationEmitter"},decls:15,vars:11,consts:[[1,"page-subtitle"],["alert_type","info",4,"ngIf"],[3,"refresh"],["color","accent","class","me-2 action-button","mat-flat-button","",3,"click",4,"ngIf"],["class","me-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],["class","me-2","mat-stroked-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative","table-min-height"],[3,"filterValue","loading","selection","cachedSubject","destinations","services","displayedColumns","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["alert_type","info"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],["mat-stroked-button","",1,"me-2",3,"disabled","click"],[3,"filterValue","loading","selection","cachedSubject","destinations","services","displayedColumns","tableId"]],template:function(t,a){if(t&1&&(l(0,"div")(1,"h1",0),u(2),p(3,"translate"),s(),v(4,Xn,3,3,"perun-web-apps-alert",1),l(5,"perun-web-apps-refresh-button",2),g("refresh",function(){return a.refreshTable()}),s(),v(6,qn,3,3,"button",3)(7,Kn,3,4,"button",4)(8,Qn,5,4,"button",5)(9,Jn,5,4,"button",5),l(10,"perun-web-apps-debounce-filter",6),g("filter",function(b){return a.applyFilter(b)}),s(),v(11,Zn,1,0,"ng-template",null,7,U),l(13,"div",8),v(14,ea,1,8,"app-perun-web-apps-destination-list",9),s()()),t&2){let f=D(12);r(2),T(m(3,9,a.title)),r(2),c("ngIf",a.title.includes("CONFIG")),r(2),c("ngIf",a.addAuth),r(),c("ngIf",a.removeAuth),r(),c("ngIf",a.allowAuth),r(),c("ngIf",a.blockAuth),r(),c("placeholder","FACILITY_DETAIL.SERVICES_DESTINATIONS.FILTER"),r(4),c("perunWebAppsLoader",a.loading)("perunWebAppsLoaderIndicator",f)}},dependencies:[x,le,k,Be,we,H,ee,W,Y,A]});let i=o;return i})();function na(i,o){if(i&1){let n=y();l(0,"button",8),g("click",function(){I(n);let t=h();return C(t.addHost())}),u(1),p(2,"translate"),s()}i&2&&(r(),_(" ",m(2,1,"FACILITY_DETAIL.HOSTS.ADD")," "))}function aa(i,o){if(i&1){let n=y();l(0,"button",9),g("click",function(){I(n);let t=h();return C(t.removeHost())}),u(1),p(2,"translate"),s()}if(i&2){let n=h();c("disabled",n.loading||n.selected.selected.length===0),r(),_(" ",m(2,2,"FACILITY_DETAIL.HOSTS.REMOVE")," ")}}function oa(i,o){i&1&&S(0,"perun-web-apps-loading-table")}function ra(i,o){if(i&1&&S(0,"app-hosts-list",10),i&2){let n=h();c("disableRouting",!n.routeAuth||n.disableRouting)("loading",n.loading)("filterValue",n.filterValue)("hosts",n.hosts)("selection",n.selected)("cachedSubject",n.cachedSubject)("displayedColumns",n.displayedColumns)("facilityId",n.facility.id)("tableId",n.tableId)}}var ze=(()=>{let o=class o{constructor(e,t,a,f){this.dialog=e,this.facilitiesManager=t,this.authResolver=a,this.entityStorageService=f,this.disableRouting=!1,this.hostEmitter=new Fe,this.hosts=[],this.selected=new j(!0,[],!0,(b,F)=>b.id===F.id),this.cachedSubject=new G(!0),this.filterValue="",this.tableId=oi,this.displayedColumns=["id","name"]}ngOnInit(){this.loading=!0,this.facility=this.entityStorageService.getEntity(),this.setAuthRights(),this.refreshTable()}refreshTable(){this.loading=!0,this.facilitiesManager.getHosts(this.facility.id).subscribe(e=>{this.hosts=e,this.hostEmitter.emit(this.hosts),this.selected.clear(),this.cachedSubject.next(!0),this.setAuthRights(),this.loading=!1})}setAuthRights(){this.addAuth=this.authResolver.isAuthorized("addHosts_Facility_List<String>_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeHosts_List<Host>_Facility_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","id","name"]:["id","name"],this.hosts.length!==0&&(this.routeAuth=this.authResolver.isAuthorized("getHostById_int_policy",[this.facility,this.hosts[0]]))}addHost(){let e=M();e.width="600px",e.data={facilityId:this.facility.id,theme:"facility-theme"},this.dialog.open(Vi,e).afterClosed().subscribe(a=>{a&&this.refreshTable()})}removeHost(){let e=M();e.width="600px",e.data={facilityId:this.facility.id,theme:"facility-theme",hosts:this.selected.selected},this.dialog.open(Pi,e).afterClosed().subscribe(a=>{a&&this.refreshTable()})}applyFilter(e){this.filterValue=e,this.refreshTable()}};o.\u0275fac=function(t){return new(t||o)(d(P),d(w),d(L),d(R))},o.\u0275cmp=E({type:o,selectors:[["app-facility-hosts"]],inputs:{disableRouting:"disableRouting"},outputs:{hostEmitter:"hostEmitter"},decls:12,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","class","me-2 action-button","mat-flat-button","",3,"click",4,"ngIf"],["class","me-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative","table-min-height"],[3,"disableRouting","loading","filterValue","hosts","selection","cachedSubject","displayedColumns","facilityId","tableId",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"disableRouting","loading","filterValue","hosts","selection","cachedSubject","displayedColumns","facilityId","tableId"]],template:function(t,a){if(t&1&&(l(0,"div")(1,"h1",0),u(2),p(3,"translate"),s(),l(4,"perun-web-apps-refresh-button",1),g("refresh",function(){return a.refreshTable()}),s(),v(5,na,3,3,"button",2)(6,aa,3,4,"button",3),l(7,"perun-web-apps-debounce-filter",4),g("filter",function(b){return a.applyFilter(b)}),s(),v(8,oa,1,0,"ng-template",null,5,U),l(10,"div",6),v(11,ra,1,9,"app-hosts-list",7),s()()),t&2){let f=D(9);r(2),T(m(3,6,"FACILITY_DETAIL.HOSTS.TITLE")),r(3),c("ngIf",a.addAuth),r(),c("ngIf",a.removeAuth),r(),c("placeholder","FACILITY_DETAIL.HOSTS.FILTER"),r(4),c("perunWebAppsLoader",a.loading)("perunWebAppsLoaderIndicator",f)}},dependencies:[x,k,je,H,ee,W,Y,A]});let i=o;return i})();var rn=(()=>{let o=class o{constructor(e,t){this.facilityManager=e,this.route=t,this.host={beanName:"",id:0}}ngOnInit(){this.route.params.subscribe(e=>{this.hostId=Number(e.hostId),this.facilityManager.getHostById(this.hostId).subscribe(t=>{this.host=t})})}};o.\u0275fac=function(t){return new(t||o)(d(w),d(me))},o.\u0275cmp=E({type:o,selectors:[["app-facility-hosts-detail"]],decls:5,vars:6,consts:[[1,"page-subtitle"],[3,"entityId","entity"]],template:function(t,a){t&1&&(l(0,"div")(1,"h1",0),u(2),p(3,"translate"),s(),S(4,"app-one-entity-attribute-page",1),s()),t&2&&(r(2),oe(" ",m(3,4,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.TITLE")," ",a.host.hostname," "),r(2),c("entityId",a.hostId)("entity","host"))},dependencies:[ke,A]});let i=o;return i})();function la(i,o){if(i&1){let n=y();l(0,"button",12),g("click",function(){I(n);let t=h();return C(t.forcePropagation())}),u(1),p(2,"translate"),s()}if(i&2){let n=h();c("disabled",n.selected.selected.length===0||n.disableForcePropagationButton||n.loading),r(),_(" ",m(2,2,"FACILITY_DETAIL.SERVICES_STATUS.FORCE_PROPAGATION")," ")}}function ca(i,o){if(i&1){let n=y();l(0,"button",12),g("click",function(){I(n);let t=h();return C(t.allow())}),u(1),p(2,"translate"),s()}if(i&2){let n=h();c("disabled",n.selected.selected.length===0||n.disableAllowButton||n.loading),r(),_(" ",m(2,2,"FACILITY_DETAIL.SERVICES_STATUS.ALLOW")," ")}}function pa(i,o){if(i&1){let n=y();l(0,"button",13),g("click",function(){I(n);let t=h();return C(t.block())}),u(1),p(2,"translate"),s()}if(i&2){let n=h();c("disabled",n.selected.selected.length===0||n.disableBlockButton||n.loading),r(),_(" ",m(2,2,"FACILITY_DETAIL.SERVICES_STATUS.BLOCK")," ")}}function ma(i,o){if(i&1&&(l(0,"button",14),p(1,"translate"),u(2),p(3,"translate"),s()),i&2){let n=h(),e=D(10);pe("matTooltip",m(1,5,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOXES_DISABLED")),c("disabled",n.selected.selected.length===0||n.disableRemoveButton||n.loading)("matMenuTriggerFor",e)("matTooltipDisabled",!n.disableRemoveButton),r(2),_(" ",m(3,7,"FACILITY_DETAIL.SERVICES_STATUS.REMOVE")," ")}}function da(i,o){if(i&1){let n=y();l(0,"button",7),g("click",function(){I(n);let t=h();return C(t.removeTaskResults())}),u(1),p(2,"translate"),s()}i&2&&(r(),_(" ",m(2,1,"FACILITY_DETAIL.SERVICES_STATUS.REMOVE_TASK_RESULTS")," "))}function ua(i,o){i&1&&S(0,"perun-web-apps-loading-table")}function fa(i,o){if(i&1){let n=y();l(0,"perun-web-apps-services-status-list",15),g("selectionChange",function(){I(n);let t=h();return C(t.selectionChanged())}),s()}if(i&2){let n=h();c("disableRouting",!n.routeAuth)("loading",n.loading)("filterValue",n.filterValue)("servicesStatus",n.servicesStates)("selection",n.selected)("cachedSubject",n.cachedSubject)("tableId",n.tableId)}}var sn=(()=>{let o=class o{constructor(e,t,a,f,b,F,B,V,q){this.tasksManager=e,this.servicesManager=t,this.notificator=a,this.translate=f,this.authResolver=b,this.facilityManager=F,this.resourcesManager=B,this.dialog=V,this.entityStorageService=q,this.servicesStates=[],this.selected=new j(!0,[],!0,($e,te)=>$e.service.id===te.service.id),this.cachedSubject=new G(!0),this.filterValue="",this.tableId=ri,this.disableAllowButton=!0,this.disableBlockButton=!0,this.disableRemoveButton=!0,this.disableForcePropagationButton=!1}ngOnInit(){this.loading=!0,this.facility=this.entityStorageService.getEntity(),this.setAuthRights(),this.refreshTable()}forcePropagation(){let e=this.selected.selected.map(t=>t.service.id);this.servicesManager.forceServicePropagationBulk(e,this.facility.id).subscribe({next:()=>{this.notificator.showInstantSuccess("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_FORCE_PROPAGATION"),this.loading=!1,this.refreshTable()},error:()=>{this.loading=!1}})}allow(){let e=this.selected.selected.map(t=>t.service.id);this.servicesManager.unblockServicesOnFacility(e,this.facility.id).subscribe({next:()=>{this.notificator.showInstantSuccess("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_ALLOW"),this.refreshTable()},error:()=>{this.loading=!1}})}block(){let e=this.selected.selected.map(t=>t.service.id);this.servicesManager.blockServicesOnFacility(e,this.facility.id).subscribe({next:()=>{this.notificator.showInstantSuccess("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_BLOCK"),this.refreshTable()},error:()=>{this.loading=!1}})}removeTaskResults(){this.loading=!0,this.tasksManager.getTaskResultsForGUIByTask(this.selected.selected[0].task.id).subscribe(e=>{let t=M();t.width="600px",t.data={theme:"facility-theme",taskResults:e},this.loading=!1,this.dialog.open(Ge,t)})}removeServiceFromFacility(){this.loading=!0,this.facilityManager.getAssignedResourcesByAssignedServiceForFacility(this.selected.selected[0].facility.id,this.selected.selected[0].service.id).subscribe({next:e=>{let t=M();t.width="600px",this.taskId=this.taskIsNull?null:this.selected.selected[0].task.id,e.length===0?(t.data={theme:"facility-theme",taskId:this.taskId},this.loading=!1,this.dialog.open(Gi,t).afterClosed().subscribe(f=>{f&&(this.disableRemoveButton=!0,this.refreshTable())})):this.resourcesManager.getRichResourcesByIds(e.map(a=>a.id)).subscribe(a=>{t.data={theme:"facility-theme",taskId:this.taskId,serviceId:this.selected.selected[0].service.id,facilityId:this.selected.selected[0].facility.id,resource:a},this.loading=!1,this.dialog.open(ji,t).afterClosed().subscribe(b=>{b&&(this.disableRemoveButton=!0,this.refreshTable())})})},error:()=>this.loading=!1})}refreshTable(){this.loading=!0,this.tasksManager.getFacilityServicesState(this.facility.id).subscribe(e=>{this.servicesStates=e,this.selected.clear(),this.cachedSubject.next(!0),this.setAuthRights(),this.loading=!1})}setAuthRights(){this.propagationAuth=this.authResolver.isAuthorized("forceServicePropagation_Facility_Service_policy",[this.facility]),this.blockAuth=this.authResolver.isAuthorized("blockServiceOnFacility_Service_Facility_policy",[this.facility]),this.allowAuth=this.authResolver.isAuthorized("unblockServiceOnFacility_Service_Facility_policy",[this.facility]),this.deleteAuth=this.authResolver.isAuthorized("deleteTask_Task_policy",[this.facility]),this.routeAuth=this.authResolver.isAuthorized("getTaskResultsByTask_int_policy",[this.facility])}applyFilter(e){this.filterValue=e,this.refreshTable()}selectionChanged(){this.disableBlockButton=!1,this.disableAllowButton=!1,this.disableRemoveButton=this.selected.selected.length!==1,this.disableForcePropagationButton=!1,this.disableRemoveButton||(this.taskIsNull=this.selected.selected[0].task===null);for(let e of this.selected.selected)e.blockedOnFacility?(this.disableBlockButton=!0,this.disableForcePropagationButton=!0):this.disableAllowButton=!0}};o.\u0275fac=function(t){return new(t||o)(d(Re),d(ie),d(J),d(re),d(L),d(w),d(xe),d(P),d(R))},o.\u0275cmp=E({type:o,selectors:[["app-facility-service-status"]],decls:20,vars:14,consts:[[1,"page-subtitle"],[3,"refresh"],["class","me-2","color","accent","mat-flat-button","",3,"disabled","click",4,"ngIf"],["class","me-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],["mat-flat-button","","class","me-2 dropdown-toggle","color","warn",3,"disabled","matMenuTriggerFor","matTooltipDisabled","matTooltip",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative","table-min-height"],[3,"disableRouting","loading","filterValue","servicesStatus","selection","cachedSubject","tableId","selectionChange",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2",3,"disabled","click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],["mat-flat-button","","color","warn",1,"me-2","dropdown-toggle",3,"disabled","matMenuTriggerFor","matTooltipDisabled","matTooltip"],[3,"disableRouting","loading","filterValue","servicesStatus","selection","cachedSubject","tableId","selectionChange"]],template:function(t,a){if(t&1&&(l(0,"div")(1,"h1",0),u(2),p(3,"translate"),s(),l(4,"perun-web-apps-refresh-button",1),g("refresh",function(){return a.refreshTable()}),s(),v(5,la,3,4,"button",2)(6,ca,3,4,"button",2)(7,pa,3,4,"button",3)(8,ma,4,9,"button",4),l(9,"mat-menu",null,5),v(11,da,3,3,"button",6),l(12,"button",7),g("click",function(){return a.removeServiceFromFacility()}),u(13),p(14,"translate"),s()(),l(15,"perun-web-apps-debounce-filter",8),g("filter",function(b){return a.applyFilter(b)}),s(),v(16,ua,1,0,"ng-template",null,9,U),l(18,"div",10),v(19,fa,1,7,"perun-web-apps-services-status-list",11),s()()),t&2){let f=D(17);r(2),T(m(3,10,"FACILITY_DETAIL.SERVICES_STATUS.TITLE")),r(3),c("ngIf",a.propagationAuth),r(),c("ngIf",a.allowAuth),r(),c("ngIf",a.blockAuth),r(),c("ngIf",a.deleteAuth),r(3),c("ngIf",!a.taskIsNull),r(2),_(" ",m(14,12,"FACILITY_DETAIL.SERVICES_STATUS.REMOVE_SERVICE_FROM_FACILITY")," "),r(2),c("placeholder","SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.TABLE_SEARCH"),r(4),c("perunWebAppsLoader",a.loading)("perunWebAppsLoaderIndicator",f)}},dependencies:[x,k,De,jt,Bt,Gt,H,ee,pi,W,Y,A]});let i=o;return i})();function ha(i,o){if(i&1){let n=y();l(0,"button",8),g("click",function(){I(n);let t=h();return C(t.removeTaskResult())}),u(1),p(2,"translate"),s()}if(i&2){let n=h();c("disabled",n.loading||n.selection.selected.length===0),r(),_(" ",m(2,2,"FACILITY_DETAIL.TASK_RESULTS.REMOVE"),`
`)}}function ga(i,o){i&1&&S(0,"perun-web-apps-loading-table")}function _a(i,o){if(i&1&&S(0,"perun-web-apps-task-results-list",9),i&2){let n=h();c("tableId",n.tableId)("loading",n.loading)("displayedColumns",n.displayedColumns)("filterValue",n.filterValue)("selection",n.selection)("cachedSubject",n.cachedSubject)("taskResults",n.taskResults)}}var ln=(()=>{let o=class o{constructor(e,t,a,f,b){this.route=e,this.taskManager=t,this.authResolver=a,this.dialog=f,this.entityStorageService=b,this.loading=!1,this.filterValue="",this.selection=new j(!0,[],!0,(F,B)=>F.id===B.id),this.task={id:0},this.taskResults=[],this.cachedSubject=new G(!0),this.tableId=si,this.displayedColumns=["select","id","destination","type","service","status","time","returnCode","standardMessage","errorMessage"],this.removeAuth=!1}ngOnInit(){this.loading=!0,this.facility=this.entityStorageService.getEntity(),this.removeAuth=this.authResolver.isAuthorized("deleteTask_Task_policy",[this.facility]),this.removeAuth||(this.displayedColumns=["id","destination","type","service","status","time","returnCode","standardMessage","errorMessage"]),this.route.params.subscribe(e=>{this.taskId=Number(e.taskId),this.taskManager.getTaskById(this.taskId).subscribe(t=>{this.task=t,this.refreshTable()})})}refreshTable(){this.loading=!0,this.taskManager.getTaskResultsForGUIByTask(this.taskId).subscribe(e=>{this.selection.clear(),this.cachedSubject.next(!0),this.taskResults=e,this.loading=!1})}removeTaskResult(){let e=M();e.width="600px",e.data={theme:"facility-theme",taskResults:this.selection.selected},this.dialog.open(Ge,e).afterClosed().subscribe(a=>{a&&this.refreshTable()})}applyFilter(e){this.filterValue=e,this.refreshTable()}};o.\u0275fac=function(t){return new(t||o)(d(me),d(Re),d(L),d(P),d(R))},o.\u0275cmp=E({type:o,selectors:[["app-facility-task-results"]],decls:12,vars:9,consts:[[1,"page-subtitle"],[1,"text-muted"],[3,"refresh"],["class","me-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["spinner",""],[1,"position-relative","table-min-height"],[3,"tableId","loading","displayedColumns","filterValue","selection","cachedSubject","taskResults",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"tableId","loading","displayedColumns","filterValue","selection","cachedSubject","taskResults"]],template:function(t,a){if(t&1&&(l(0,"h1",0),u(1),p(2,"translate"),l(3,"span",1),u(4),s()(),l(5,"perun-web-apps-refresh-button",2),g("refresh",function(){return a.refreshTable()}),s(),v(6,ha,3,4,"button",3),l(7,"perun-web-apps-debounce-filter",4),g("filter",function(b){return a.applyFilter(b)}),s(),v(8,ga,1,0,"ng-template",null,5,U),l(10,"div",6),v(11,_a,1,7,"perun-web-apps-task-results-list",7),s()),t&2){let f=D(9);r(),oe(" ",m(2,7,"FACILITY_DETAIL.TASK_RESULTS.TITLE")," - ",a.task.service?a.task.service.name:""," "),r(3),_(" \xA0#",a.task.id," "),r(2),c("ngIf",a.removeAuth),r(),c("placeholder","FACILITY_DETAIL.TASK_RESULTS.FILTER"),r(4),c("perunWebAppsLoader",a.loading)("perunWebAppsLoaderIndicator",f)}},dependencies:[x,k,H,ee,mi,W,Y,A]});let i=o;return i})();var cn=(()=>{let o=class o{constructor(e,t){this.dialogRef=e,this.data=t,this.theme=""}ngOnInit(){this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSkip(){this.dialogRef.close(!0)}};o.\u0275fac=function(t){return new(t||o)(d(ue),d(fe))},o.\u0275cmp=E({type:o,selectors:[["app-no-service-dialog"]],decls:14,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["matDialogActions",""],["mat-stroked-button","",1,"ms-auto","me-2",3,"click"],["color","accent","mat-flat-button","",3,"click"]],template:function(t,a){t&1&&(l(0,"div")(1,"h1",0),u(2),p(3,"translate"),s(),l(4,"div",1),u(5),p(6,"translate"),s(),l(7,"div",2)(8,"button",3),g("click",function(){return a.onCancel()}),u(9),p(10,"translate"),s(),l(11,"button",4),g("click",function(){return a.onSkip()}),u(12),p(13,"translate"),s()()()),t&2&&(ce(a.theme),r(2),T(m(3,7,"DIALOGS.NO_SERVICE.TITLE")),r(3),_(" ",m(6,9,"DIALOGS.NO_SERVICE.INFO")," "),r(4),_(" ",m(10,11,"DIALOGS.NO_SERVICE.CANCEL")," "),r(3),_(" ",m(13,13,"DIALOGS.NO_SERVICE.SKIP")," "))},dependencies:[k,he,_e,ge,A]});let i=o;return i})();var pn=(()=>{let o=class o{constructor(e,t){this.dialogRef=e,this.data=t,this.theme=""}ngOnInit(){this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSkip(){this.dialogRef.close(!0)}};o.\u0275fac=function(t){return new(t||o)(d(ue),d(fe))},o.\u0275cmp=E({type:o,selectors:[["app-config-unsaved-dialog"]],decls:14,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["matDialogActions",""],["mat-stroked-button","",1,"ms-auto","me-2",3,"click"],["color","accent","mat-flat-button","",3,"click"]],template:function(t,a){t&1&&(l(0,"div")(1,"h1",0),u(2),p(3,"translate"),s(),l(4,"div",1),u(5),p(6,"translate"),s(),l(7,"div",2)(8,"button",3),g("click",function(){return a.onCancel()}),u(9),p(10,"translate"),s(),l(11,"button",4),g("click",function(){return a.onSkip()}),u(12),p(13,"translate"),s()()()),t&2&&(ce(a.theme),r(2),T(m(3,7,"DIALOGS.CONFIG_UNSAVED.TITLE")),r(3),_(" ",m(6,9,"DIALOGS.CONFIG_UNSAVED.INFO")," "),r(4),_(" ",m(10,11,"DIALOGS.CONFIG_UNSAVED.CANCEL")," "),r(3),_(" ",m(13,13,"DIALOGS.CONFIG_UNSAVED.SKIP")," "))},dependencies:[k,he,_e,ge,A]});let i=o;return i})();function va(i,o){if(i&1&&(l(0,"div",3),S(1,"i",4),p(2,"translate"),s()),i&2){let n=h();r(),c("innerHTML",m(2,1,n.info),Ae)}}function Sa(i,o){if(i&1){let n=y();l(0,"button",10),g("click",function(){I(n);let t=h(2);return C(t.onKeep())}),u(1),p(2,"translate"),s()}i&2&&(r(),_(" ",m(2,1,"DIALOGS.CANCEL_CONFIG.KEEP")," "))}function Ia(i,o){if(i&1){let n=y();l(0,"div",5)(1,"button",6),g("click",function(){I(n);let t=h();return C(t.onCancel())}),u(2),p(3,"translate"),s(),l(4,"button",7),g("click",function(){I(n);let t=h();return C(t.onDelete())}),l(5,"mat-icon",8),u(6," warning "),s(),u(7),p(8,"translate"),s(),v(9,Sa,3,3,"button",9),s()}if(i&2){let n=h();r(2),_(" ",m(3,3,"DIALOGS.CANCEL_CONFIG.CANCEL")," "),r(5),_(" ",m(8,5,"DIALOGS.CANCEL_CONFIG.DELETE")," "),r(2),c("ngIf",!n.lastStep)}}var mn=(()=>{let o=class o{constructor(e,t,a,f,b){this.dialogRef=e,this.data=t,this.facilityService=a,this.notificator=f,this.translate=b,this.theme="",this.title="",this.info="",this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.lastStep=this.data.lastStep,this.lastStep?(this.title="DIALOGS.CANCEL_CONFIG.TITLE_COMPLETE",this.info="DIALOGS.CANCEL_CONFIG.INFO_COMPLETE"):(this.title="DIALOGS.CANCEL_CONFIG.TITLE_INCOMPLETE",this.info="DIALOGS.CANCEL_CONFIG.INFO_INCOMPLETE")}onCancel(){this.dialogRef.close(!1)}onDelete(){this.loading=!0,this.facilityService.deleteFacility(this.data.facilityId,!0).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.CANCEL_CONFIG.SUCCESS")),this.dialogRef.close(!0),this.loading=!1},()=>this.loading=!1)}onKeep(){this.dialogRef.close(!0)}};o.\u0275fac=function(t){return new(t||o)(d(ue),d(fe),d(w),d(J),d(re))},o.\u0275cmp=E({type:o,selectors:[["app-cancel-configuration-dialog"]],decls:6,vars:8,consts:[["mat-dialog-title",""],["mat-dialog-content","",4,"ngIf"],["matDialogActions","",4,"ngIf"],["mat-dialog-content",""],[3,"innerHTML"],["matDialogActions",""],["mat-stroked-button","",1,"me-2",3,"click"],["color","warn","mat-flat-button","",1,"ms-auto","me-2",3,"click"],["iconPositionEnd",""],["color","accent","mat-flat-button","",3,"click",4,"ngIf"],["color","accent","mat-flat-button","",3,"click"]],template:function(t,a){t&1&&(l(0,"div")(1,"h1",0),u(2),p(3,"translate"),s(),v(4,va,3,3,"div",1)(5,Ia,10,7,"div",2),s()),t&2&&(ce(a.theme),r(2),T(m(3,6,a.title)),r(2),c("ngIf",!a.loading),r(),c("ngIf",!a.loading))},dependencies:[x,le,k,he,_e,ge,A]});let i=o;return i})();var Ca=["stepper"];function ba(i,o){i&1&&S(0,"perun-web-apps-loading-table")}function ya(i,o){i&1&&(u(0),p(1,"translate")),i&2&&T(m(1,1,"FACILITY_CONFIGURATION.HOSTS"))}function Ta(i,o){if(i&1){let n=y();l(0,"app-facility-hosts",15),g("hostEmitter",function(t){I(n);let a=h();return C(a.hosts=t)}),s()}i&2&&c("disableRouting",!0)}function Ea(i,o){i&1&&(u(0),p(1,"translate")),i&2&&T(m(1,1,"FACILITY_CONFIGURATION.SERVICES"))}var Aa=()=>["select","id","name","enabled","description"];function Fa(i,o){if(i&1){let n=y();l(0,"h1",16),u(1),p(2,"translate"),s(),l(3,"perun-web-apps-alert",17),u(4),p(5,"translate"),s(),l(6,"div",18)(7,"perun-web-apps-debounce-filter",19),g("filter",function(t){I(n);let a=h();return C(a.applyFilter(t))}),s(),l(8,"perun-web-apps-service-package-search-select",20),g("packageSelected",function(t){I(n);let a=h();return C(a.packagesSelected(t))}),s()(),l(9,"app-services-list",21),g("selectionChanged",function(){I(n);let t=h();return C(t.singleServiceSelected())}),s()}if(i&2){let n=h();r(),T(m(2,15,"FACILITY_CONFIGURATION.SERVICES")),r(3),_(" ",m(5,17,"FACILITY_CONFIGURATION.SERVICES_INFO")," "),r(3),c("placeholder","FACILITY_CONFIGURATION.SERVICES_FILTER"),r(),c("disableAutoSelect",!0)("selectedPackage",n.selectedPackages)("multiple",!0)("servicePackages",n.servicePackages)("theme","facility-theme"),r(),c("loading",n.processing)("disableRouting",!0)("displayedColumns",K(19,Aa))("selection",n.selection)("cachedSubject",n.cachedSubject)("filterValue",n.filterValue)("services",n.services)}}function xa(i,o){i&1&&(u(0),p(1,"translate")),i&2&&T(m(1,1,"FACILITY_CONFIGURATION.SERVICE_CONFIG"))}function Ra(i,o){if(i&1){let n=y();l(0,"perun-web-apps-service-search-select",27),g("serviceSelected",function(t){I(n);let a=h(2);return C(a.filterAttributes(t))}),s()}if(i&2){let n=h(2);c("disableAutoSelect",!0)("services",n.selection.selected)("multiple",!0)("theme","facility-theme")}}function Da(i,o){if(i&1&&S(0,"perun-web-apps-attributes-list",28),i&2){let n=h(2);c("loading",n.processing)("emptyListText","FACILITY_CONFIGURATION.EMPTY_REQ_ATT")("attributes",n.filteredAttributes)("selection",n.attSelection)("cachedSubject",n.cachedSubject)}}function wa(i,o){if(i&1){let n=y();l(0,"h1",16),u(1),p(2,"translate"),s(),l(3,"perun-web-apps-alert",17),u(4),p(5,"translate"),s(),l(6,"div",18)(7,"button",22),g("click",function(){I(n);let t=h();return C(t.onRemoveAttributes())}),u(8),p(9,"translate"),s(),l(10,"button",23),g("click",function(){I(n);let t=h();return C(t.onSaveAttributes())}),u(11),p(12,"translate"),s(),v(13,Ra,1,4,"perun-web-apps-service-search-select",24),s(),l(14,"div",25),v(15,Da,1,5,"perun-web-apps-attributes-list",26),s()}if(i&2){let n=h(),e=D(5),t=D(7);r(),T(m(2,9,"FACILITY_CONFIGURATION.SERVICE_CONFIG")),r(3),_(" ",m(5,11,"FACILITY_CONFIGURATION.ATT_INFO")," "),r(3),c("disabled",n.processing||n.attSelection.selected.length===0),r(),_(" ",m(9,13,"FACILITY_CONFIGURATION.REMOVE")," "),r(2),c("disabled",n.processing||n.attSelection.selected.length===0),r(),_(" ",m(12,15,"FACILITY_CONFIGURATION.SAVE")," "),r(2),c("ngIf",e.selectedIndex===n.ATTRIBUTES_IDX),r(2),c("perunWebAppsLoader",n.processing)("perunWebAppsLoaderIndicator",t)}}function La(i,o){i&1&&(u(0),p(1,"translate")),i&2&&T(m(1,1,"FACILITY_CONFIGURATION.DESTINATION_CONFIG"))}var Ma=()=>["select","destinationId","service","warn","destination","type","propagationType"];function Oa(i,o){if(i&1){let n=y();l(0,"app-perun-web-apps-facility-services-destinations",29),g("destinationEmitter",function(t){I(n);let a=h();return C(a.destinations=t)}),s()}if(i&2){let n=h();c("configServicesIds",n.serviceIds)("displayedColumns",K(5,Ma))("configServices",n.selection.selected)("loading",n.processing)("title","FACILITY_CONFIGURATION.DESTINATION_CONFIG")}}function Na(i,o){i&1&&(u(0),p(1,"translate")),i&2&&T(m(1,1,"FACILITY_CONFIGURATION.MANAGERS"))}function ka(i,o){i&1&&S(0,"app-perun-web-apps-facility-settings-managers",30),i&2&&c("disableRouting",!0)("disableSelf",!0)}function Va(i,o){i&1&&(u(0),p(1,"translate")),i&2&&T(m(1,1,"FACILITY_CONFIGURATION.SUMMARY"))}var Pa=()=>["id","name"];function Ba(i,o){if(i&1&&S(0,"app-hosts-list",45),i&2){let n=h(3);c("loading",n.processing)("disableRouting",!0)("displayedColumns",K(4,Pa))("hosts",n.hosts)}}var ja=()=>["destinationId","service","warn","destination","type","propagationType"];function Ga(i,o){if(i&1&&S(0,"app-perun-web-apps-destination-list",46),i&2){let n=h(3);c("loading",n.processing)("destinations",n.destinations)("displayedColumns",K(4,ja))("services",n.serviceIds)}}var Ua=()=>["id","name","enabled","script","description"],Ya=()=>["id","displayName","value","description"],Ha=()=>["id","vo","name","description"],Wa=()=>["id","name","email","logins","organization"];function za(i,o){if(i&1){let n=y();l(0,"mat-accordion")(1,"mat-expansion-panel",33)(2,"mat-expansion-panel-header")(3,"mat-panel-title"),S(4,"mat-icon",34),u(5),p(6,"translate"),s()(),l(7,"h1",16),u(8),p(9,"translate"),s(),l(10,"div",25),v(11,Ba,1,5,"app-hosts-list",35),s()(),l(12,"mat-expansion-panel",33)(13,"mat-expansion-panel-header")(14,"mat-panel-title"),S(15,"mat-icon",36),u(16),p(17,"translate"),s()(),l(18,"h1",16),u(19),p(20,"translate"),s(),S(21,"app-services-list",37),s(),l(22,"mat-expansion-panel",38),g("opened",function(){I(n);let t=h(2);return C(t.getNonEmptyAttributes())}),l(23,"mat-expansion-panel-header")(24,"mat-panel-title"),S(25,"mat-icon",34),u(26),p(27,"translate"),s()(),l(28,"h1",16),u(29),p(30,"translate"),s(),S(31,"perun-web-apps-attributes-list",39),s(),l(32,"mat-expansion-panel",40),g("expandedChange",function(t){I(n);let a=h(2);return C(a.destinationServiceMissing=t)}),l(33,"mat-expansion-panel-header")(34,"mat-panel-title"),S(35,"mat-icon",41),u(36),p(37,"translate"),s()(),l(38,"h1",16),u(39),p(40,"translate"),s(),l(41,"div",25),v(42,Ga,1,5,"app-perun-web-apps-destination-list",42),s()(),l(43,"mat-expansion-panel")(44,"mat-expansion-panel-header")(45,"mat-panel-title"),S(46,"mat-icon",43),u(47),p(48,"translate"),s()(),S(49,"app-managers-page",44),s()()}if(i&2){let n=h(2),e=D(7);c("@.disabled",!0),r(),c("disabled",n.hosts.length===0),r(),N("cursor-default",n.hosts.length===0),r(3),_(" ",m(6,42,"FACILITY_CONFIGURATION.HOSTS")," "),r(3),T(m(9,44,"FACILITY_CONFIGURATION.HOSTS")),r(3),c("perunWebAppsLoader",n.processing)("perunWebAppsLoaderIndicator",e),r(),c("disabled",n.selection.selected.length===0),r(),N("cursor-default",n.selection.selected.length===0),r(3),_(" ",m(17,46,"FACILITY_CONFIGURATION.SERVICES")," "),r(3),T(m(20,48,"FACILITY_CONFIGURATION.SERVICES")),r(2),c("loading",n.processing)("disableRouting",!0)("displayedColumns",K(60,Ua))("services",n.selection.selected),r(),c("disabled",n.selection.selected.length===0),r(),N("cursor-default",n.selection.selected.length===0),r(3),_(" ",m(27,50,"FACILITY_CONFIGURATION.SERVICE_CONFIG")," "),r(3),T(m(30,52,"FACILITY_CONFIGURATION.ATTS")),r(2),c("loading",n.processing)("displayedColumns",K(61,Ya))("attributes",n.filteredAttributes)("emptyListText","FACILITY_CONFIGURATION.EMPTY_REQ_ATT"),r(),c("expanded",n.destinationServiceMissing)("disabled",n.selection.selected.length===0&&n.destinations.length===0),r(),N("cursor-default",n.selection.selected.length===0&&n.destinations.length===0),r(3),_(" ",m(37,54,"FACILITY_CONFIGURATION.DESTINATION_CONFIG")," "),r(3),T(m(40,56,"FACILITY_CONFIGURATION.DESTINATION")),r(3),c("perunWebAppsLoader",n.processing)("perunWebAppsLoaderIndicator",e),r(5),_(" ",m(48,58,"FACILITY_CONFIGURATION.MANAGERS")," "),r(2),c("complementaryObject",n.facility)("configMode",!0)("disableRouting",!0)("availableRoles",n.availableRoles)("complementaryObjectType","Facility")("displayedGroupColumns",K(62,Ha))("displayedUserColumns",K(63,Wa))}}function $a(i,o){if(i&1&&(l(0,"perun-web-apps-alert",17),S(1,"i",31),p(2,"translate"),s(),v(3,za,50,64,"mat-accordion",32)),i&2){h();let n=D(5);r(),c("innerHTML",m(2,2,"FACILITY_CONFIGURATION.SUMMARY_INFO"),Ae),r(2),c("ngIf",n.selectedIndex===n.steps.length-1)}}function Xa(i,o){if(i&1){let n=y();l(0,"button",47),g("click",function(){I(n);let t=h();return C(t.back())}),u(1),p(2,"translate"),s()}i&2&&(r(),_(" ",m(2,1,"FACILITY_CONFIGURATION.BACK")," "))}function qa(i,o){if(i&1){let n=y();l(0,"button",48),g("click",function(){I(n);let t=h();return C(t.next())}),u(1),p(2,"translate"),s()}if(i&2){h();let n=D(5);N("me-2",n!==void 0&&n.selectedIndex!==0)("ms-auto",!(n!==void 0&&n.selectedIndex!==0)),r(),_(" ",m(2,5,"FACILITY_CONFIGURATION.NEXT")," ")}}function Ka(i,o){if(i&1){let n=y();l(0,"button",49),g("click",function(){I(n);let t=h();return C(t.onFinish())}),u(1),p(2,"translate"),s()}i&2&&(r(),_(" ",m(2,1,"FACILITY_CONFIGURATION.FINISH")," "))}var dn=(()=>{let o=class o{constructor(e,t,a,f,b,F,B,V,q,$e){this.attributesManager=e,this.serviceManager=t,this.facilityService=a,this.cd=f,this.dialog=b,this.notificator=F,this.translate=B,this.router=V,this.guiAuthResolver=q,this.entityStorageService=$e,this.processing=!1,this.filteredAttributes=[],this.attSelection=new j(!0,[],!0,(te,Xe)=>te.id===Xe.id),this.cachedSubject=new G(!0),this.services=[],this.serviceIds=new Set,this.servicePackages=[],this.selectedPackages=[],this.selection=new j(!0,[],!0,(te,Xe)=>te.id===Xe.id),this.hosts=[],this.destinations=[],this.destinationServiceMissing=!1,this.availableRoles=[],this.filterValue="",this.ATTRIBUTES_IDX=3,this.serviceControl=new se(!1,Qe.requiredTrue),this.attributesControl=new se(!0,Qe.requiredTrue),this.allowNavigate=!1,this.attributes=[],this.attributeIds=new Set,this.attributesPerService=new Map,this.servicesPerPackage=new Map,this.saveMsg="",this.removeMsg="",this.BEFORE_OPTIONAL_IDX=2,this.DESTINATIONS_IDX=4,this.AFTER_OPTIONAL_IDX=5,this.translate.get("FACILITY_CONFIGURATION.ATT_SAVED").subscribe(te=>this.saveMsg=te),this.translate.get("FACILITY_CONFIGURATION.ATT_REMOVED").subscribe(te=>this.removeMsg=te)}ngOnInit(){this.facility=this.entityStorageService.getEntity(),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Facility"),this.serviceManager.getServicesPackages().subscribe(e=>{this.servicePackages=e,this.getServicePackageServices(e,0)})}ngAfterViewInit(){this.cd.detectChanges(),this.attSelection.changed.subscribe(()=>{this.attributesControl.setValue(this.attSelection.selected.length===0)})}onCancel(){let e=M();e.width="550px",e.data={facilityId:this.facility.id,lastStep:this.stepper.selectedIndex===this.stepper.steps.length-1,theme:"facility-theme"},this.dialog.open(mn,e).afterClosed().subscribe(a=>{a&&(this.allowNavigate=!0,sessionStorage.removeItem("newFacilityId"),this.router.navigate(["facilities"],{queryParamsHandling:"merge"}))})}packagesSelected(e){if(this.packageSelectionEqual(e))return;this.processing=!0;let t=new Set;if(!e||e.length===0?this.selectedPackages.forEach(b=>{this.servicesPerPackage.get(b.id).forEach(F=>t.add(F))}):t=this.setSymDif(this.selectedPackages,e),t.size===0)return;let a=this.filterService(t,e.filter(b=>this.selectedPackages.findIndex(F=>F.id===b.id)<0)),f=this.filterService(t,this.selectedPackages.filter(b=>e.findIndex(F=>F.id===b.id)<0));for(let b of this.services)a.has(b.id)?this.selection.select(b):f.has(b.id)&&this.selection.deselect(b);this.selectedPackages=e,this.setServiceControl(),this.processing=!1}singleServiceSelected(){this.setServiceControl(),!this.processing&&this.checkPackageComplete()}back(){this.stepper.selectedIndex<=this.BEFORE_OPTIONAL_IDX&&this.setServiceControl(),this.stepper.selectedIndex===this.AFTER_OPTIONAL_IDX&&this.selection.selected.length===0?this.stepper.selectedIndex=this.BEFORE_OPTIONAL_IDX:this.stepper.previous()}onSaveAttributes(){return new Promise((e,t)=>{this.processing=!0,this.attributesManager.setFacilityAttributes({facility:this.facility.id,attributes:this.attSelection.selected}).subscribe({next:()=>{this.notificator.showSuccess(this.saveMsg),this.attSelection.clear(),this.cachedSubject.next(!0),this.processing=!1,e()},error:()=>{this.processing=!1,t()}})})}next(){this.checkDestinationDependency(this.stepper.selectedIndex),this.stepper.selectedIndex===this.BEFORE_OPTIONAL_IDX?this.selection.selected.length===0?this.openSkipDialog():(this.getRequiredAttributes(),this.stepper.next()):this.stepper.selectedIndex===this.ATTRIBUTES_IDX?this.attSelection.selected.length!==0?this.openUnsavedAttsDialog():this.stepper.next():this.stepper.next()}onFinish(){this.allowNavigate=!0,sessionStorage.removeItem("newFacilityId"),this.router.navigate(["facilities",this.facility.id],{queryParamsHandling:"merge"})}onRemoveAttributes(){this.processing=!0;let e=this.attSelection.selected.map(t=>t.id);this.attributesManager.removeFacilityAttributes(this.facility.id,e).subscribe({next:()=>{this.notificator.showSuccess(this.removeMsg),this.attSelection.clear(),this.cachedSubject.next(!0),this.getRequiredAttributes(),this.processing=!1},error:()=>this.processing=!1})}filterAttributes(e){if(e===void 0||e.length===0){this.filteredAttributes=this.attributes;return}let t=new Set;for(let a of e)this.attributesPerService.get(a.id).forEach(f=>t.add(f));this.filteredAttributes=[];for(let a of this.attributes)t.has(a.id)&&this.filteredAttributes.push(a);this.attSelection.clear(),this.cachedSubject.next(!0)}getNonEmptyAttributes(){this.filteredAttributes=this.attributes.filter(e=>{if(e.value&&(!Array.isArray(e.value)||e.value.length!==0))return e})}navigationStep(e){this.checkDestinationDependency(e.previouslySelectedIndex),e.selectedIndex===this.ATTRIBUTES_IDX?this.getRequiredAttributes():e.selectedIndex===this.DESTINATIONS_IDX?this.processing=!1:e.selectedIndex<=this.BEFORE_OPTIONAL_IDX&&this.setServiceControl()}applyFilter(e){this.filterValue=e,this.selection.clear(),this.cachedSubject.next(!0)}canDeactivate(){return this.allowNavigate||this.onCancel(),this.allowNavigate}getServicePackageServices(e,t){t===e.length?this.serviceManager.getServices().subscribe(a=>{this.services=a}):this.serviceManager.getServicesFromServicesPackage(e[t].id).subscribe(a=>{this.servicesPerPackage.set(e[t].id,new Set([...a.map(f=>f.id)])),this.getServicePackageServices(e,t+1)})}getServiceRequiredAttributes(e,t){t!==e.length&&this.attributesManager.getRequiredAttributesDefinition(e[t].id).subscribe(a=>{a=a.filter(f=>this.attributeIds.has(f.id)),this.attributesPerService.set(e[t].id,a.map(f=>f.id)),this.getServiceRequiredAttributes(e,t+1)})}setServiceControl(){this.serviceControl.setValue(this.selection.selected.length!==0)}buildServiceSet(e){let t=new Set;return e.forEach(a=>{this.servicesPerPackage.get(a.id).forEach(f=>t.add(f))}),t}setDiff(e,t){return new Set([...e].filter(a=>!t.has(a)))}setIntersect(e,t){return new Set([...e].filter(a=>t.has(a)))}setSymDif(e,t){let a=this.buildServiceSet(e),f=this.buildServiceSet(t),b=this.setDiff(a,f),F=this.setDiff(f,a);return new Set([...b,...F])}filterService(e,t){let a=new Set;for(let f of t){let b=this.setIntersect(e,this.servicesPerPackage.get(f.id));b.size!==0&&b.forEach(F=>a.add(F))}return a}packageSelectionEqual(e){return e.length!==this.selectedPackages.length?!1:(e.forEach(t=>{if(this.selectedPackages.findIndex(a=>a.id===t.id)===-1)return!1}),!0)}checkPackageComplete(){let e=[];for(let t of this.selectedPackages){let a=!0;for(let f of this.servicesPerPackage.get(t.id))if(this.selection.selected.findIndex(b=>b.id===f)===-1){a=!1;break}a&&e.push(t)}this.selectedPackages=e}openSkipDialog(){let e=M();e.width="400px",e.data={theme:"facility-theme"},this.dialog.open(cn,e).afterClosed().subscribe(a=>{a&&(this.serviceControl.setValue(!0),this.stepper.selectedIndex=this.AFTER_OPTIONAL_IDX)})}getRequiredAttributes(){this.processing=!0,this.attributesManager.getRequiredAttributesFacilityServices(this.selection.selected.map(e=>e.id),this.facility.id).subscribe(e=>{this.attSelection.clear(),this.attributes=e.filter(t=>!Xt(t)),this.filteredAttributes=this.attributes,this.attributes.forEach(t=>this.attributeIds.add(t.id)),this.getServiceRequiredAttributes(this.selection.selected,0),this.processing=!1})}openUnsavedAttsDialog(){let e=M();e.width="400px",e.data={theme:"facility-theme"},this.dialog.open(pn,e).afterClosed().subscribe(a=>{a&&this.onSaveAttributes().then(()=>{this.stepper.next()},()=>this.getRequiredAttributes())})}checkDestinationDependency(e){(e===this.BEFORE_OPTIONAL_IDX||e===this.DESTINATIONS_IDX)&&(this.serviceIds=new Set([...this.selection.selected.map(t=>t.id)]),this.destinationServicePresent())}destinationServicePresent(){for(let e of this.destinations)if(!this.serviceIds.has(e.service.id)){this.destinationServiceMissing=!0;return}this.destinationServiceMissing=!1}};o.\u0275fac=function(t){return new(t||o)(d(_t),d(ie),d(w),d(at),d(P),d(J),d(re),d(de),d(L),d(R))},o.\u0275cmp=E({type:o,selectors:[["app-facility-configuration-page"]],viewQuery:function(t,a){if(t&1&&rt(Ca,5),t&2){let f;st(f=lt())&&(a.stepper=f.first)}},decls:33,vars:15,consts:[[1,"facility-theme"],[1,"page-title"],[3,"linear","selectionChange"],["stepper",""],["spinner",""],["matStepLabel",""],["matStepContent",""],[3,"stepControl"],["optional","true",3,"editable","stepControl"],[3,"editable","optional"],[1,"actions"],["mat-stroked-button","",3,"click"],["class","ms-auto me-2","mat-stroked-button","",3,"click",4,"ngIf"],["color","accent","mat-flat-button","",3,"me-2","ms-auto","click",4,"ngIf"],["class","me-2","color","accent","mat-flat-button","",3,"click",4,"ngIf"],[3,"disableRouting","hostEmitter"],[1,"page-subtitle"],["alert_type","info"],[1,"filters"],[1,"filter",3,"placeholder","filter"],[1,"package-search-select",3,"disableAutoSelect","selectedPackage","multiple","servicePackages","theme","packageSelected"],[3,"loading","disableRouting","displayedColumns","selection","cachedSubject","filterValue","services","selectionChanged"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],["color","accent","mat-flat-button","",1,"me-2",3,"disabled","click"],["class","service-search-select",3,"disableAutoSelect","services","multiple","theme","serviceSelected",4,"ngIf"],[1,"position-relative","table-min-height"],[3,"loading","emptyListText","attributes","selection","cachedSubject",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[1,"service-search-select",3,"disableAutoSelect","services","multiple","theme","serviceSelected"],[3,"loading","emptyListText","attributes","selection","cachedSubject"],[3,"configServicesIds","displayedColumns","configServices","loading","title","destinationEmitter"],[3,"disableRouting","disableSelf"],[3,"innerHTML"],[4,"ngIf"],[3,"disabled"],["svgIcon","perun-hosts",1,"me-2"],[3,"loading","disableRouting","displayedColumns","hosts",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["svgIcon","perun-service",1,"me-2"],[3,"loading","disableRouting","displayedColumns","services"],[3,"disabled","opened"],[3,"loading","displayedColumns","attributes","emptyListText"],[3,"expanded","disabled","expandedChange"],["svgIcon","perun-service_destination",1,"me-2"],[3,"loading","destinations","displayedColumns","services",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["svgIcon","perun-manager",1,"me-2"],[3,"complementaryObject","configMode","disableRouting","availableRoles","complementaryObjectType","displayedGroupColumns","displayedUserColumns"],[3,"loading","disableRouting","displayedColumns","hosts"],[3,"loading","destinations","displayedColumns","services"],["mat-stroked-button","",1,"ms-auto","me-2",3,"click"],["color","accent","mat-flat-button","",3,"click"],["color","accent","mat-flat-button","",1,"me-2",3,"click"]],template:function(t,a){if(t&1&&(l(0,"div",0)(1,"div",1),u(2),p(3,"translate"),s(),l(4,"mat-stepper",2,3),g("selectionChange",function(b){return a.navigationStep(b)}),v(6,ba,1,0,"ng-template",null,4,U),l(8,"mat-step"),v(9,ya,2,3,"ng-template",5)(10,Ta,1,1,"ng-template",6),s(),l(11,"mat-step",7),v(12,Ea,2,3,"ng-template",5)(13,Fa,10,20,"ng-template",6),s(),l(14,"mat-step",8),v(15,xa,2,3,"ng-template",5)(16,wa,16,17,"ng-template",6),s(),l(17,"mat-step",9),v(18,La,2,3,"ng-template",5)(19,Oa,1,6,"ng-template",6),s(),l(20,"mat-step"),v(21,Na,2,3,"ng-template",5)(22,ka,1,2,"ng-template",6),s(),l(23,"mat-step"),v(24,Va,2,3,"ng-template",5)(25,$a,4,4,"ng-template",6),s()(),l(26,"div",10)(27,"button",11),g("click",function(){return a.onCancel()}),u(28),p(29,"translate"),s(),v(30,Xa,3,3,"button",12)(31,qa,3,7,"button",13)(32,Ka,3,3,"button",14),s()()),t&2){let f=D(5);r(2),_(" ",m(3,11,"FACILITY_CONFIGURATION.TITLE")," "),r(2),c("linear",!0),r(7),c("stepControl",a.serviceControl),r(3),c("editable",a.selection.selected.length!==0)("stepControl",a.attributesControl),r(3),c("editable",a.selection.selected.length!==0||a.destinations.length!==0)("optional",a.destinations.length===0),r(11),_(" ",m(29,13,"FACILITY_CONFIGURATION.CANCEL")," "),r(2),c("ngIf",f!==void 0&&f.selectedIndex!==0),r(),c("ngIf",f!==void 0&&f.selectedIndex!==f.steps.length-1),r(),c("ngIf",f!==void 0&&f.selectedIndex===f.steps.length-1)}},dependencies:[x,le,k,Vt,Nt,Pt,kt,wt,xt,Rt,Dt,Ve,Be,je,Di,we,H,ci,W,di,ui,Y,Ye,We,ze,A],styles:[".icon-scale[_ngcontent-%COMP%]{transform:scale(1.7);margin-left:.5rem;margin-top:-.6rem;margin-right:.9rem}.filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:baseline}.package-search-select[_ngcontent-%COMP%]{width:650px}.service-search-select[_ngcontent-%COMP%]{width:400px}.filter[_ngcontent-%COMP%]{width:350px;margin-right:20px}.actions[_ngcontent-%COMP%]{background-color:#fff;display:flex;padding:20px}.cursor-default[_ngcontent-%COMP%]{cursor:default}"]});let i=o;return i})();var et=(()=>{let o=class o{constructor(e){this.router=e}canActivate(e){return e.parent.params.facilityId===sessionStorage.getItem("newFacilityId")?!0:(this.router.navigate(["/home"],{queryParamsHandling:"merge"}),!1)}canDeactivate(e){return e.canDeactivate()}};o.\u0275fac=function(t){return new(t||o)(nt(de))},o.\u0275prov=it({token:o,factory:o.\u0275fac,providedIn:"root"});let i=o;return i})();function Qa(i,o){if(i&1){let n=y();l(0,"button",8),g("click",function(){I(n);let t=h();return C(t.add())}),u(1),p(2,"translate"),s()}i&2&&(r(),_(" ",m(2,1,"FACILITY_DETAIL.SETTINGS.BANS.ADD"),`
`))}function Ja(i,o){if(i&1){let n=y();l(0,"button",9),g("click",function(){I(n);let t=h();return C(t.remove())}),u(1),p(2,"translate"),s()}if(i&2){let n=h();c("disabled",n.loading||n.selection.selected.length===0),r(),_(" ",m(2,2,"FACILITY_DETAIL.SETTINGS.BANS.REMOVE"),`
`)}}function Za(i,o){if(i&1){let n=y();l(0,"perun-web-apps-ban-on-entity-list",10),g("updateBan",function(t){I(n);let a=h();return C(a.update(t))}),s()}if(i&2){let n=h();c("loading",n.loading)("bans",n.bans)("selection",n.selection)("cachedSubject",n.cachedSubject)("displayedColumns",n.displayedColumns)("filter",n.filter)("updatePolicy","updateBan_BanOnFacility_policy")}}function eo(i,o){i&1&&S(0,"perun-web-apps-loading-table")}var un=(()=>{let o=class o{constructor(e,t,a,f,b,F,B){this.facilityService=e,this.entityService=t,this.authResolver=a,this.dialog=f,this.notificator=b,this.store=F,this.userName=B,this.loading=!1,this.bans=[],this.removeAuth=!1,this.filter="",this.selection=new j(!1,[],!0,(V,q)=>V.ban.id===q.ban.id),this.cachedSubject=new G(!0),this.attrNames=[Je.MEMBER_DEF_MAIL,Je.USER_DEF_PREFERRED_MAIL].concat(this.store.getLoginAttributeNames()),this.displayedColumns=["select","banId","subjectId","subjectName","description","expiration","edit"]}ngOnInit(){this.loading=!0,this.facility=this.entityService.getEntity(),this.addAuth=this.authResolver.isAuthorized("setBan_BanOnFacility_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeBan_int_policy",[this.facility]),this.refresh()}refresh(){this.loading=!0,this.facilityService.getEnrichedBansForFacility(this.facility.id,this.attrNames).subscribe({next:e=>{this.bans=e,this.selection.clear(),this.cachedSubject.next(!0),this.loading=!1},error:()=>this.loading=!1})}add(){let e=M();e.width="850px",e.data={entityId:this.facility.id,theme:"facility-theme",bans:this.bans.map(a=>a.ban)},this.dialog.open(Ui,e).afterClosed().subscribe(a=>{a&&this.refresh()})}remove(){let e=M();e.width="550px",e.data={theme:"facility-theme",title:"DIALOGS.REMOVE_BAN.TITLE",description:"DIALOGS.REMOVE_BAN.DESCRIPTION",items:[this.userName.transform(this.selection.selected[0].user)],type:"remove",showAsk:!0},this.dialog.open(ni,e).afterClosed().subscribe(a=>{a&&(this.loading=!0,this.facilityService.removeFacilityBanById(this.selection.selected[0].ban.id).subscribe(()=>{this.notificator.showSuccess("DIALOGS.REMOVE_BAN.SUCCESS"),this.refresh()}))})}update(e){let t=M();t.width="600px",t.data={ban:e.ban,theme:"facility-theme"},this.dialog.open(Yi,t).afterClosed().subscribe(f=>{f&&this.refresh()})}applyFilter(e){this.filter=e,this.refresh()}};o.\u0275fac=function(t){return new(t||o)(d(w),d(R),d(L),d(P),d(J),d(Ct),d(Z))},o.\u0275cmp=E({type:o,selectors:[["app-facility-settings-bans"]],features:[pt([Z])],decls:11,vars:8,consts:[[1,"page-subtitle"],[3,"click"],["class","me-2 action-button","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","class","me-2","mat-flat-button","",3,"disabled","click",4,"ngIf"],[1,"mt-2","search-field",3,"placeholder","filter"],[1,"position-relative","table-min-height"],[3,"loading","bans","selection","cachedSubject","displayedColumns","filter","updatePolicy","updateBan",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["spinner",""],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled","click"],[3,"loading","bans","selection","cachedSubject","displayedColumns","filter","updatePolicy","updateBan"]],template:function(t,a){if(t&1&&(l(0,"h1",0),u(1),p(2,"translate"),s(),l(3,"perun-web-apps-refresh-button",1),g("click",function(){return a.refresh()}),s(),v(4,Qa,3,3,"button",2)(5,Ja,3,4,"button",3),l(6,"perun-web-apps-debounce-filter",4),g("filter",function(b){return a.applyFilter(b)}),s(),l(7,"div",5),v(8,Za,1,7,"perun-web-apps-ban-on-entity-list",6),s(),v(9,eo,1,0,"ng-template",null,7,U)),t&2){let f=D(10);r(),_(" ",m(2,6,"FACILITY_DETAIL.SETTINGS.BANS.TITLE"),`
`),r(3),c("ngIf",a.addAuth),r(),c("ngIf",a.removeAuth),r(),c("placeholder","FACILITY_DETAIL.SETTINGS.BANS.FILTER"),r(2),c("perunWebAppsLoader",a.loading)("perunWebAppsLoaderIndicator",f)}},dependencies:[x,k,H,ee,W,gi,Y,A]});let i=o;return i})();var to=[{path:"",component:$i,canActivate:[Pe]},{path:":facilityId",component:Zi,canActivateChild:[Pe],children:[{path:"",component:en,data:{animation:"FacilityOverviewPage"}},{path:"attributes",component:an,data:{animation:"FacilityAttributesPage"}},{path:"resources",component:Xi,data:{animation:"FacilityResourcesPage"}},{path:"allowed-users",component:Ki,data:{animation:"FacilityAllowedUsersPage"}},{path:"allowed-groups",component:qi,data:{animation:"FacilityAllowedGroupsPage"}},{path:"services-status",component:sn,data:{animation:"FacilityServiceStatusPage"}},{path:"services-status/:taskId",component:ln,data:{animation:"FacilityTaskResultsPage"}},{path:"service-config",component:on,data:{animation:"FacilityServiceConfigPage"}},{path:"services-destinations",component:We,data:{animation:"FacilityServicesDestinationsPage"}},{path:"hosts",component:ze,data:{animation:"FacilityHostsPage"}},{path:"hosts/:hostId",component:rn,data:{animation:"FacilityHostsDetailPage"}},{path:"settings",component:tn,children:[{path:"",component:nn,data:{animation:"FacilitySettingsOverviewPage"}},{path:"managers",component:Ye,data:{animation:"FacilitySettingsManagersPage"}},{path:"bans",component:un,data:{animation:"FacilitySettingsBansPage"}}]},{path:"configuration",component:dn,canActivate:[et],canDeactivate:[et]}]},{path:":facilityId/resources/:resourceId",component:yi,canActivateChild:[Pe],children:[{path:"",component:Ti,data:{animation:"ResourceOverviewPage"}},{path:"attributes",component:xi,data:{animation:"ResourceAttributesPage"}},{path:"groups",component:Ei,data:{animation:"ResourceGroupsComponent"}},{path:"services",component:wi,data:{animation:"ResourceAssignedServicesComponent"}},{path:"members",component:Li,data:{animation:"ResourceAssignedMembersComponent"}},{path:"tags",component:Mi,data:{animation:"ResourceTagsComponent"}},{path:"settings",component:Ai,children:[{path:"",component:Fi,data:{animation:"ResourceSettingsOverviewPage"}},{path:"managers",component:Ri,data:{animation:"ResourceSettingsManagersPage"}},{path:"bans",component:Oi,data:{animation:"ResourceSettingsBansPage"}}]}]}],fn=(()=>{let o=class o{};o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=Ee({type:o}),o.\u0275inj=Te({imports:[Ke.forChild(to),Ke]});let i=o;return i})();var Dp=(()=>{let o=class o{};o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=Ee({type:o}),o.\u0275inj=Te({providers:[Z],imports:[ht,fn,Hi,qt,ei,vi,Zt,Wi,zi]});let i=o;return i})();export{Dp as FacilitiesModule};
