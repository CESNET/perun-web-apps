import{a as Mo,b as Ro,c as Lo,d as Bo,e as Vo}from"./chunk-XOKHJJ7K.js";import{a as Eo,b as Do}from"./chunk-GY4TC635.js";import{a as Ao}from"./chunk-DF3H5TMN.js";import{a as No,b as Uo,c as ko}from"./chunk-5CQLDIJ7.js";import{a as vo,b as To,c as tn,d as pi,f as xo}from"./chunk-LOQGZPHC.js";import{b as Io}from"./chunk-NMYZ7ZF4.js";import{a as yo,b as wo,c as Oo}from"./chunk-YO2R2BOB.js";import{a as li,b as nn}from"./chunk-XJDSBCII.js";import{$a as De,$b as wi,$e as yt,$f as Zt,$g as ni,Aa as k,Ac as Ae,Ad as wn,B as bn,Ba as P,Bd as zt,Be as Gn,Bf as fi,Bg as ti,Ca as T,Cc as Y,Ce as jn,Cf as hi,Cg as ii,Da as C,Dc as y,Dd as ae,De as Hn,Df as cn,Ea as _,Ec as M,Ed as Rn,Ef as Kn,Eh as mn,Fd as Ln,Ff as Yn,Fh as oo,G as at,Gd as Mt,Gh as ao,H as se,Hd as Pi,Hh as ai,Ia as ve,Id as $t,Ih as ro,Ja as Te,Jc as me,Jd as Fi,Ji as fo,K as Nt,Ka as Ee,Kg as dn,Ki as ho,La as R,Ld as Bn,Li as go,Ma as Ge,Mb as We,Mc as Oi,Md as Gi,Mh as so,Na as Pe,Nc as Wt,Nd as ji,Ni as Co,Oa as d,Oi as Zi,Pa as A,Pc as qt,Pd as _t,Qa as f,Qc as be,Qd as On,Qe as Ze,Qf as j,Qi as bo,Ra as rt,Rb as qe,Rc as At,Rd as le,Re as et,Rh as lo,Ri as So,S as h,Sa as vn,Sb as ge,Sc as Dt,Se as tt,T as g,Ta as Tn,Tb as ze,Tc as ct,Td as Nn,Te as it,Ti as ri,Ua as Ct,Ub as Mi,Uc as xt,Ud as Bt,Ue as nt,Uf as Jt,V as Ut,Va as bt,Ve as Kt,Vi as si,W as Ii,Wa as St,Wc as An,We as Yt,Wi as en,Xa as fe,Xb as Lt,Xc as Ke,Xe as Wn,Xh as de,Ya as Ie,Yc as Dn,Ye as qn,Yf as Qn,Za as It,Zb as Ft,Zc as Ye,Ze as zn,Zf as ke,Zg as wt,Zh as po,_ as Sn,_a as he,_b as yi,_c as xn,_e as pn,aa as o,ab as ln,ac as Ri,ad as Mn,ah as ot,bc as Li,bd as Ni,be as _i,ca as Tt,cd as O,ce as Un,cg as Xn,d as G,db as l,dd as L,eb as p,ed as yn,ee as Hi,fb as je,fc as pt,fd as dt,fe as Ve,g as _n,ga as m,gb as Di,gd as mt,ge as re,h as ft,ha as D,hd as ut,he as J,ic as Bi,id as Qe,ie as pe,jb as B,jc as Gt,jd as Q,je as $,jf as $n,jh as Zn,k as ht,ka as Et,kb as xi,kc as $e,kd as X,ke as Z,kh as Ki,ki as co,l as fn,ld as H,le as ee,ma as S,mb as En,mc as jt,md as ue,me as te,mh as eo,mi as mo,nc as Ht,ne as ie,nf as V,nh as Yi,ni as uo,oa as gt,oc as K,og as Jn,oi as _o,pa as ui,pb as Pt,pc as xe,qb as He,qc as Me,qe as Vn,qf as Qt,r as Ot,ra as E,rc as ye,rf as Xt,sa as I,sc as we,sf as Fe,sg as zi,t as Ei,ta as Ai,tb as In,tc as Re,td as Ui,tf as st,th as to,ua as Vt,ub as x,uc as Le,ud as Xe,uf as qi,uh as io,va as kt,vc as Be,vd as Je,ve as Wi,w as hn,wa as u,wc as Oe,we as kn,wh as no,xa as r,xc as Ne,xd as Vi,xg as $i,xh as ce,xi as Qi,y as gn,ya as a,yc as Ue,yd as N,ye as Pn,yg as ei,yh as oi,yi as Xi,z as Cn,za as b,zc as Ce,zd as ki,ze as Fn,zi as Ji}from"./chunk-Q6VFHOR5.js";import{a as Ti}from"./chunk-TSRGIXR5.js";var wa=()=>({color:"black"}),Go=(()=>{class t{constructor(e){this.sideMenuService=e}ngOnInit(){this.sideMenuService.setAdminItems([])}static{this.\u0275fac=function(n){return new(n||t)(m(si))}}static{this.\u0275cmp=D({type:t,selectors:[["app-admin-page"]],decls:7,vars:5,consts:[[1,"container-fluid","ps-xl-5","pe-xl-5","admin-theme"],[1,"page-title","d-flex"],["svgIcon","perun-perun-admin",1,"perun-icon","icon-scale",3,"ngStyle"]],template:function(n,i){n&1&&(r(0,"div",0),b(1,"perun-web-apps-back-button"),r(2,"h1",1),b(3,"mat-icon",2),d(4),l(5,"translate"),a(),b(6,"app-animated-router-outlet"),a()),n&2&&(o(3),u("ngStyle",he(4,wa)),o(),f(" ",p(5,2,"ADMIN.TITLE")," "))},dependencies:[x,Pt,Qe,ut,ri,oi,li,M,y],encapsulation:2})}}return t})();var jo=(()=>{class t{constructor(){this.items=[{cssIcon:"perun-attributes",url:"/admin/attributes",label:"MENU_ITEMS.ADMIN.ATTRIBUTES",style:"admin-btn"},{cssIcon:"perun-user",url:"/admin/users",label:"MENU_ITEMS.ADMIN.USERS",style:"admin-btn"},{cssIcon:"perun-service",url:"/admin/services",label:"MENU_ITEMS.ADMIN.SERVICES",style:"admin-btn"},{cssIcon:"perun-external-sources",url:"/admin/ext_sources",label:"MENU_ITEMS.ADMIN.EXT_SOURCES",style:"admin-btn"},{cssIcon:"perun-audit-log",url:"/admin/audit_log",label:"MENU_ITEMS.ADMIN.AUDIT_LOG",style:"admin-btn"},{cssIcon:"perun-consent-hubs",url:"/admin/consent_hubs",label:"MENU_ITEMS.ADMIN.CONSENT_HUBS",style:"admin-btn"},{cssIcon:"perun-searcher",url:"/admin/searcher",label:"MENU_ITEMS.ADMIN.SEARCHER",style:"admin-btn"},{cssIcon:"perun-blocked-logins",url:"/admin/blocked_logins",label:"MENU_ITEMS.ADMIN.BLOCKED_LOGINS",style:"admin-btn"},{cssIcon:"perun-automated-tasks",url:"/admin/tasks",label:"MENU_ITEMS.ADMIN.TASKS",style:"admin-btn"}]}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=D({type:t,selectors:[["app-admin-overview"]],hostVars:2,hostBindings:function(n,i){n&2&&Ge("router-component",i.true)},decls:2,vars:1,consts:[[3,"items"]],template:function(n,i){n&1&&(r(0,"div"),b(1,"perun-web-apps-menu-buttons-field",0),a()),n&2&&(o(),u("items",i.items))},dependencies:[x,ai],encapsulation:2})}}return t})();function Ra(t,c){t&1&&b(0,"perun-web-apps-loading-dialog")}function La(t,c){t&1&&b(0,"th",15)}function Ba(t,c){if(t&1&&(r(0,"td",16),d(1),a()),t&2){let e=c.$implicit;o(),A(e.friendlyName)}}function Oa(t,c){t&1&&b(0,"tr",17)}function Na(t,c){t&1&&b(0,"tr",18)}function Ua(t,c){if(t&1){let e=T();r(0,"div")(1,"h1",2),d(2),l(3,"translate"),a(),r(4,"div",3)(5,"div"),d(6),l(7,"translate"),a(),r(8,"div",4),d(9),l(10,"translate"),a(),r(11,"table",5),k(12,6),S(13,La,1,0,"th",7)(14,Ba,2,1,"td",8),P(),S(15,Oa,1,0,"tr",9)(16,Na,1,0,"tr",10),a(),r(17,"perun-web-apps-alert",11),d(18),l(19,"translate"),a()(),r(20,"div",12)(21,"button",13),C("click",function(){h(e);let i=_();return g(i.onCancel())}),d(22),l(23,"translate"),a(),r(24,"button",14),C("click",function(){h(e);let i=_();return g(i.onSubmit())}),d(25),l(26,"translate"),a()()()}if(t&2){let e=_();o(2),A(p(3,10,"DIALOGS.DELETE_ATTRIBUTE_DEFINITION.TITLE")),o(4),f(" ",p(7,12,"DIALOGS.DELETE_ATTRIBUTE_DEFINITION.TEXT_LINE1")," "),o(3),f(" ",p(10,14,"DIALOGS.DELETE_ATTRIBUTE_DEFINITION.TEXT_LINE2")," "),o(2),u("dataSource",e.dataSource),o(4),u("matHeaderRowDef",e.displayedColumns),o(),u("matRowDefColumns",e.displayedColumns),o(2),f(" ",p(19,16,"DIALOGS.DELETE_ATTRIBUTE_DEFINITION.WARNING")," "),o(4),f(" ",p(23,18,"DIALOGS.DELETE_ATTRIBUTE_DEFINITION.CANCEL")," "),o(2),u("disabled",e.loading),o(),f(" ",p(26,20,"DIALOGS.DELETE_ATTRIBUTE_DEFINITION.CONFIRM")," ")}}var Ho=(()=>{class t{constructor(e,n,i,s,v){this.dialogRef=e,this.data=n,this.notificator=i,this.translate=s,this.attributesManager=v,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.dataSource=new Ae(this.data.attributes)}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0;let e=[];for(let n of this.data.attributes)e.push(n.id);this.attributesManager.deleteAttributeDefinitions(e).subscribe(()=>{this.translate.get("DIALOGS.DELETE_ATTRIBUTE_DEFINITION.SUCCESS").subscribe(n=>{this.notificator.showSuccess(n),this.dialogRef.close(!0)})},()=>this.loading=!1)}static{this.\u0275fac=function(n){return new(n||t)(m(J),m(pe),m(j),m(Y),m(ae))}}static{this.\u0275cmp=D({type:t,selectors:[["app-delete-attribute-definition-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",1,"mt-3"],["mat-dialog-actions","",1,"mt-3"],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","","data-cy","confirm-delete-attr-definition-button",1,"ms-2",3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(n,i){if(n&1&&(S(0,Ra,1,0,"ng-template",null,0,B),r(2,"div"),S(3,Ua,27,22,"div",1),a()),n&2){let s=R(1);o(2),Pe(Ie("",i.theme," position-relative")),o(),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,ie,Z,te,ee,X,Q,ue,Ce,xe,ye,Be,we,Me,Oe,Re,Le,Ne,Ue,M,N,y],encapsulation:2})}}return t})();var an=(()=>{class t{transform(e){if(e===null)return null;let n=e;return n.substring(n.lastIndexOf(".")+1,n.length)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275pipe=Et({name:"attributeTypeClean",type:t,pure:!0})}}return t})();function ka(t,c){t&1&&b(0,"perun-web-apps-loading-dialog")}function Pa(t,c){t&1&&(r(0,"mat-error"),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"DIALOGS.NAME_SPACE_ERROR")," "))}function Fa(t,c){t&1&&(r(0,"mat-error"),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"DIALOGS.CREATE_ATTRIBUTE_DEFINITION.ERROR_FIELD_EMPTY")," "))}function Ga(t,c){t&1&&(r(0,"mat-error"),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"DIALOGS.NAME_SPACE_ERROR")," "))}function ja(t,c){t&1&&(r(0,"mat-error"),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"DIALOGS.CREATE_ATTRIBUTE_DEFINITION.ERROR_FIELD_EMPTY")," "))}function Ha(t,c){t&1&&(r(0,"mat-error"),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"DIALOGS.CREATE_ATTRIBUTE_DEFINITION.ERROR_FIELD_EMPTY")," "))}function Wa(t,c){if(t&1&&(r(0,"mat-option",10),d(1),a()),t&2){let e=c.$implicit;u("value",e),o(),A(e)}}function qa(t,c){t&1&&(r(0,"mat-error"),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"DIALOGS.CREATE_ATTRIBUTE_DEFINITION.ERROR_FIELD_EMPTY")," "))}function za(t,c){if(t&1&&(r(0,"mat-option",10),d(1),a()),t&2){let e=c.$implicit;u("value",e),o(),f("",e," ")}}function $a(t,c){t&1&&(r(0,"mat-error"),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"DIALOGS.CREATE_ATTRIBUTE_DEFINITION.ERROR_FIELD_EMPTY")," "))}function Ka(t,c){if(t&1&&(r(0,"mat-option",10),d(1),l(2,"attributeTypeClean"),a()),t&2){let e=c.$implicit;u("value",e),o(),f(" ",p(2,2,e)," ")}}function Ya(t,c){t&1&&(r(0,"mat-error"),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"DIALOGS.CREATE_ATTRIBUTE_DEFINITION.ERROR_FIELD_EMPTY")," "))}function Qa(t,c){if(t&1){let e=T();r(0,"div")(1,"h1",3),d(2),l(3,"translate"),a(),r(4,"div",4)(5,"form",5)(6,"mat-form-field")(7,"mat-label"),d(8),l(9,"translate"),a(),b(10,"input",6),E(11,Pa,3,3,"mat-error"),E(12,Fa,3,3,"mat-error"),a(),r(13,"mat-form-field")(14,"mat-label"),d(15),l(16,"translate"),a(),b(17,"input",7),E(18,Ga,3,3,"mat-error"),E(19,ja,3,3,"mat-error"),a(),r(20,"mat-form-field")(21,"mat-label"),d(22),l(23,"translate"),a(),r(24,"textarea",8),d(25,"          "),a(),E(26,Ha,3,3,"mat-error"),a(),r(27,"mat-form-field")(28,"mat-label"),d(29),l(30,"translate"),a(),r(31,"mat-select",9),Vt(32,Wa,2,2,"mat-option",10,Ai),a(),E(34,qa,3,3,"mat-error"),a(),r(35,"mat-form-field")(36,"mat-label"),d(37),l(38,"translate"),a(),r(39,"mat-select",11),Vt(40,za,2,2,"mat-option",10,Ai),a(),E(42,$a,3,3,"mat-error"),a(),r(43,"mat-form-field")(44,"mat-label"),d(45),l(46,"translate"),a(),r(47,"mat-select",12),Vt(48,Ka,3,4,"mat-option",10,Ai),a(),E(50,Ya,3,3,"mat-error"),a()(),b(51,"perun-web-apps-attribute-unique-checkbox",13),l(52,"async"),r(53,"perun-web-apps-attribute-critical-operations-checkboxes",14),C("readOperationChanged",function(i){h(e);let s=_();return g(s.finalReadOperations=i)})("readGlobalChanged",function(i){h(e);let s=_();return g(s.finalReadGlobal=i)})("writeOperationChanged",function(i){h(e);let s=_();return g(s.finalWriteOperations=i)})("writeGlobalChanged",function(i){h(e);let s=_();return g(s.finalWriteGlobal=i)}),a(),b(54,"perun-web-apps-attribute-rights-tab-group",15),a(),r(55,"div",16)(56,"button",17),C("click",function(){h(e);let i=_();return g(i.cancel())}),d(57),l(58,"translate"),a(),r(59,"button",18),C("click",function(){h(e);let i=_();return g(i.submit())}),d(60),l(61,"translate"),a()()()}if(t&2){let e=_();o(2),A(p(3,22,"DIALOGS.CREATE_ATTRIBUTE_DEFINITION.TITLE")),o(3),u("formGroup",e.attributeControl),o(3),A(p(9,24,"DIALOGS.CREATE_ATTRIBUTE_DEFINITION.FRIENDLY_NAME")),o(3),I(e.attributeControl.hasError("spaceName","friendlyName")?11:-1),o(),I(e.attributeControl.hasError("required","friendlyName")?12:-1),o(3),A(p(16,26,"DIALOGS.CREATE_ATTRIBUTE_DEFINITION.DISPLAY_NAME")),o(3),I(e.attributeControl.hasError("spaceName","displayName")?18:-1),o(),I(e.attributeControl.hasError("required","displayName")?19:-1),o(3),A(p(23,28,"DIALOGS.CREATE_ATTRIBUTE_DEFINITION.DESCRIPTION")),o(4),I(e.attributeControl.hasError("required","description")?26:-1),o(3),A(p(30,30,"DIALOGS.CREATE_ATTRIBUTE_DEFINITION.ENTITY")),o(3),kt(e.entities),o(2),I(e.attributeControl.hasError("required","entity")?34:-1),o(3),A(p(38,32,"DIALOGS.CREATE_ATTRIBUTE_DEFINITION.DEFINITION")),o(3),kt(e.definitionTypes),o(2),I(e.attributeControl.hasError("required","definitionType")?42:-1),o(3),A(p(46,34,"DIALOGS.CREATE_ATTRIBUTE_DEFINITION.VALUE_TYPE")),o(3),kt(e.valueTypes),o(2),I(e.attributeControl.hasError("required","valueType")?50:-1),o(),u("attDef",p(52,36,e.attDef)),o(2),u("attDef",e.attDef),o(),u("collections",e.collections),o(3),f(" ",p(58,38,"DIALOGS.CREATE_ATTRIBUTE_DEFINITION.CANCEL")," "),o(2),u("disabled",e.loading||e.attributeControl.invalid),o(),f(" ",p(61,40,"DIALOGS.CREATE_ATTRIBUTE_DEFINITION.CONFIRM")," ")}}var Wo=(()=>{class t{constructor(e,n,i,s,v,w,q){this.dialogRef=e,this.formBuilder=n,this.attributeService=i,this.attributeRightsService=s,this.notificator=v,this.translate=w,this.uniqueAttPipe=q,this.loading=!1,this.attributeControl=this.formBuilder.group({friendlyName:["",[ge.required,fi()]],displayName:["",[ge.required,fi()]],description:["",ge.required],entity:["",ge.required],definitionType:["",ge.required],valueType:["",ge.required]}),this.entities=["facility","resource","group","group_resource","host","member","member_group","member_resource","user","ues","user_facility","vo","entityless"],this.definitionTypes=["def","opt","virt","core"],this.valueTypes=["java.lang.String","java.lang.Integer","java.lang.Boolean","java.util.ArrayList","java.util.LinkedHashMap"],this.attDef=new G({id:0,beanName:"",namespace:"",unique:!1}),this.collections=[],this.finalReadGlobal=!1,this.finalWriteGlobal=!1,this.attributeControl.valueChanges.pipe(Cn(200)).subscribe(_e=>{this.setAttribute(_e)})}submit(){this.loading=!0,this.attributeService.createAttributeDefinition({attribute:this.attDef.getValue()}).pipe(se(e=>(this.attDefCreated=e,Ei(ft(e.id),ft(this.collections)))),this.attributeRightsService.addAttributeId(),this.attributeRightsService.filterNullInPolicy(),se(e=>this.attributeService.setAttributePolicyCollections({policyCollections:e})),se(()=>this.attributeRightsService.updateAttributeAction(this.finalReadOperations,!1,this.finalReadGlobal,!1,this.attDefCreated.id,Bt.READ)),se(()=>this.attributeRightsService.updateAttributeAction(this.finalWriteOperations,!0,this.finalWriteGlobal,!1,this.attDefCreated.id,Bt.WRITE))).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.CREATE_ATTRIBUTE_DEFINITION.SUCCESS")),this.dialogRef.close(!0)},error:()=>this.loading=!1})}cancel(){this.dialogRef.close(!1)}setAttribute(e){let n={id:0,beanName:"",friendlyName:e.friendlyName,displayName:e.displayName,description:e.description,type:e.valueType,namespace:this.createNamespace(e.entity,e.definitionType)};n.unique=this.attDef.getValue().unique&&!this.uniqueAttPipe.transform(n),this.attDef.next(n)}createNamespace(e,n){return"urn:perun:"+e+":attribute-def:"+n}static{this.\u0275fac=function(n){return new(n||t)(m(J),m(Bi),m(ae),m(Zt),m(j),m(Y),m($i))}}static{this.\u0275cmp=D({type:t,selectors:[["app-create-attribute-definition-dialog"]],features:[It([$i])],decls:4,vars:2,consts:[["spinner",""],[1,"admin-theme","position-relative"],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"dialog-container",3,"formGroup"],["matInput","","formControlName","friendlyName","data-cy","attribute-friendly-name-input","required",""],["matInput","","formControlName","displayName","data-cy","attribute-display-name-input","required",""],["matInput","","formControlName","description","cdkTextareaAutosize","","data-cy","attribute-description-input","required",""],["formControlName","entity","data-cy","attribute-entity-input","required",""],[3,"value"],["formControlName","definitionType","data-cy","attribute-definition-type-input","required",""],["formControlName","valueType","data-cy","attribute-value-type-input","required",""],[3,"attDef"],[3,"readOperationChanged","readGlobalChanged","writeOperationChanged","writeGlobalChanged","attDef"],[3,"collections"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","data-cy","create-attr-definition-button","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(n,i){if(n&1&&(S(0,ka,1,0,"ng-template",null,0,B),r(2,"div",1),S(3,Qa,62,42,"div",2),a()),n&2){let s=R(1);o(3),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,Ye,Ke,ct,xt,Je,Xe,Ui,Mn,xn,Dn,$e,yi,qe,ze,Mi,pt,Ri,Li,ie,Z,te,ee,ue,M,Qi,Ji,Xi,N,He,y,an],encapsulation:2})}}return t})();function Xa(t,c){t&1&&b(0,"perun-web-apps-loading-dialog")}function Ja(t,c){if(t&1){let e=T();r(0,"div")(1,"h1",3),d(2),l(3,"translate"),a(),r(4,"div",4)(5,"perun-web-apps-alert",5),d(6),l(7,"translate"),a(),r(8,"mat-form-field",6)(9,"mat-label"),d(10),l(11,"translate"),a(),r(12,"input",7),St("ngModelChange",function(i){h(e);let s=_();return bt(s.value,i)||(s.value=i),g(i)}),a()()(),r(13,"div",8)(14,"button",9),C("click",function(){h(e);let i=_();return g(i.dialogRef.close())}),d(15),l(16,"translate"),a(),r(17,"button",10),C("click",function(){h(e);let i=_();return g(i.create())}),d(18),l(19,"translate"),a()()()}if(t&2){let e=_();o(2),f(" ",p(3,7,"DIALOGS.IMPORT_ATTRIBUTE.TITLE")," "),o(4),f(" ",p(7,9,"DIALOGS.IMPORT_ATTRIBUTE.INFO")," "),o(4),A(p(11,11,"DIALOGS.IMPORT_ATTRIBUTE.HINT")),o(2),Ct("ngModel",e.value),o(3),f(" ",p(16,13,"DIALOGS.IMPORT_ATTRIBUTE.CANCEL")," "),o(2),u("disabled",e.value.trim().length===0||e.loading),o(),f(" ",p(19,15,"DIALOGS.IMPORT_ATTRIBUTE.CREATE")," ")}}var qo=(()=>{class t{constructor(e,n,i,s,v){this.dialogRef=e,this.notificator=n,this.translate=i,this.attributesManager=s,this.attributesRightsService=v,this.value="",this.loading=!1}create(){this.loading=!0,this.attributeData=JSON.parse(this.value),this.attributesManager.createAttributeDefinition({attribute:this.attributeData.attributeDefinition}).pipe(se(e=>Ei(ft(e.id),ft(this.attributeData.attributeRights))),this.attributesRightsService.addAttributeId(),se(e=>this.attributesManager.setAttributePolicyCollections({policyCollections:e}))).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.IMPORT_ATTRIBUTE_DEFINITION.SUCCESS")),this.dialogRef.close(!0)},()=>this.loading=!1)}static{this.\u0275fac=function(n){return new(n||t)(m(J),m(j),m(Y),m(ae),m(Zt))}}static{this.\u0275cmp=D({type:t,selectors:[["app-attribute-import-dialog"]],decls:4,vars:2,consts:[["spinner",""],[1,"admin-theme","position-relative"],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],["alert_type","info"],[1,"w-100"],["matInput","","required","",3,"ngModelChange","ngModel"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(n,i){if(n&1&&(S(0,Xa,1,0,"ng-template",null,0,B),r(2,"div",1),S(3,Ja,20,17,"div",2),a()),n&2){let s=R(1);o(3),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,Ye,Ke,ct,Je,Xe,Gt,qe,ze,pt,Ft,$e,ie,Z,te,ee,X,Q,ue,M,N,y],encapsulation:2})}}return t})();var Za=t=>({all:t}),er=t=>({name:t});function tr(t,c){t&1&&b(0,"perun-web-apps-loading-table")}function ir(t,c){if(t&1){let e=T();r(0,"th",23)(1,"mat-checkbox",24),l(2,"masterCheckboxLabel"),l(3,"translate"),C("change",function(i){h(e);let s=_(3);return g(i?s.masterToggle():null)}),a()()}if(t&2){let e=_(),n=_(2);o(),gt("aria-label",p(3,5,p(2,3,e.all))),u("checked",n.selection.hasValue()&&e.all)("indeterminate",n.selection.hasValue()&&!e.all)}}function nr(t,c){if(t&1){let e=T();r(0,"td",25)(1,"mat-checkbox",26),l(2,"checkboxLabel"),l(3,"translate"),C("change",function(i){let s=h(e).$implicit,v=_(3);return g(i?v.toggleRow(s):null)})("click",function(i){return h(e),g(i.stopPropagation())}),a()()}if(t&2){let e=c.$implicit,n=_(3);o(),gt("aria-label",je(3,4,p(2,2,n.selection.isSelected(e)),De(7,er,e.key))),u("checked",n.selection.isSelected(e))}}function or(t,c){t&1&&(k(0,13),S(1,ir,4,7,"th",21)(2,nr,4,9,"td",22),P())}function ar(t,c){t&1&&(r(0,"th",27),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"SHARED.COMPONENTS.ENTITYLESS_ATTRIBUTES_LIST.KEY")," "))}function rr(t,c){if(t&1){let e=T();r(0,"td",28)(1,"mat-form-field")(2,"input",29),C("ngModelChange",function(){let i=h(e).$implicit,s=_(2);return g(s.onValueChange(i))}),St("ngModelChange",function(i){let s=h(e).$implicit;return bt(s.key,i)||(s.key=i),g(i)}),a()()()}if(t&2){let e=c.$implicit;o(2),Ct("ngModel",e.key)}}function sr(t,c){t&1&&(r(0,"th",30),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"SHARED.COMPONENTS.ENTITYLESS_ATTRIBUTES_LIST.VALUE")," "))}function lr(t,c){if(t&1){let e=T();r(0,"td",28)(1,"perun-web-apps-attribute-value",31),C("sendEventToParent2",function(){let i=h(e).$implicit,s=_(2);return g(s.onValueChange(i))}),a()()}if(t&2){let e=c.$implicit;o(),u("attribute",e.value)}}function pr(t,c){t&1&&b(0,"tr",32)}function cr(t,c){t&1&&b(0,"tr",33)}function dr(t,c){if(t&1){let e=T();r(0,"div")(1,"div",10)(2,"perun-web-apps-table-wrapper",11),C("pageChanged",function(){h(e);let i=_();return g(i.pageChanged())}),r(3,"table",12),C("matSortChange",function(){h(e);let i=_();return g(i.pageChanged())}),E(4,or,3,0,"ng-container",13),l(5,"isAllSelected"),k(6,14),S(7,ar,3,3,"th",15)(8,rr,3,1,"td",16),P(),k(9,17),S(10,sr,3,3,"th",18)(11,lr,2,1,"td",16),P(),S(12,pr,1,0,"tr",19)(13,cr,1,0,"tr",20),a()()()()}if(t&2){let e,n=_();o(),u("hidden",n.dataSource.filteredData===0||n.records.length===0),o(),u("pageSizeOptions",n.pageSizeOptions)("dataLength",n.dataSource.filteredData.length)("hideExport",!0)("tableId",n.tableId),o(),u("dataSource",n.dataSource),o(),I((e=De(12,Za,je(5,9,n.dataSource,n.selection.selected.length)))?4:-1,e),o(8),u("matHeaderRowDef",n.displayedColumns),o(),u("matRowDefColumns",n.displayedColumns)}}function mr(t,c){t&1&&(r(0,"perun-web-apps-alert",9),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"SHARED.COMPONENTS.ENTITYLESS_ATTRIBUTES_LIST.NO_KEYS_WARNING")," "))}var $o=(()=>{class t{constructor(e,n,i,s,v,w,q){this.dialogRef=e,this.data=n,this.notificator=i,this.translate=s,this.attributesManager=v,this.cd=w,this.tableCheckbox=q,this.switchView=new Tt,this.records=[],this.displayedColumns=["select","key","value"],this.dataSource=new Ae,this.selection=new K(!0,[],!0,(_e,Se)=>_e.key===Se.key),this.cachedSelection=new K(this.selection.isMultipleSelection(),[],!0,this.selection.compareWith),this.isAddButtonDisabled=!1,this.pageSizeOptions=yt,this.tableId="app-entityless-attribute-keys-list"}ngOnInit(){this.loading=!0,this.attDef=this.data.attDef,this.refreshTable()}refreshTable(){this.loading=!0,this.attributesManager.getEntitylessAttributesWithKeys(`${this.attDef.namespace}:${this.attDef.friendlyName}`).subscribe(e=>{this.records=[];let n=Object.keys(e);for(let i of n)this.records.push({key:i,value:e[i]});this.dataSource=new Ae(this.records),this.setDataSource(),this.loading=!1})}setDataSource(){this.dataSource&&(this.dataSource.sort=this.sort,this.child&&(this.dataSource.paginator=this.child.paginator))}onSave(){this.updateMapAttributes();let e=0,n=this.selection.selected.length;for(let i of this.selection.selected)this.loading=!0,this.attributesManager.setEntitylessAttribute({key:i.key,attribute:i.value}).subscribe({next:()=>{e+=1,e===n&&this.translate.get("SHARED.COMPONENTS.ENTITYLESS_ATTRIBUTES_LIST.SAVE_SUCCESS").subscribe(s=>{this.notificator.showSuccess(s),this.refreshTable()})},error:()=>{this.refreshTable()}});this.selection.clear(),this.cachedSelection.clear(),this.isAddButtonDisabled=!1,this.cd.detectChanges()}onRemove(){this.loading=!0;let e=0,n=this.selection.selected.length;for(let i of this.selection.selected)this.attributesManager.removeEntitylessAttribute(i.key,i.value.id).subscribe(()=>{e+=1,e===n&&this.translate.get("SHARED.COMPONENTS.ENTITYLESS_ATTRIBUTES_LIST.REMOVE_SUCCESS").subscribe(s=>{this.notificator.showSuccess(s),this.refreshTable()})});this.selection.clear(),this.cachedSelection.clear(),this.isAddButtonDisabled=!1,this.cd.detectChanges()}onAdd(){let e={key:"",value:this.attDef};e.value.value=void 0,this.records.unshift(e),this.dataSource.data=this.records,this.setDataSource(),this.selection.clear(),this.cachedSelection.clear(),this.selection.select(e),this.cachedSelection.select(e),this.isAddButtonDisabled=!0,this.cd.detectChanges()}onCancel(){this.dialogRef.close(!1)}isAllSelected(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.dataSource)}masterToggle(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.cachedSelection,"",this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}onValueChange(e){this.selection.select(e),this.cachedSelection.select(e)}updateMapAttributes(){for(let e of this.items.toArray())e.attribute.type==="java.util.LinkedHashMap"&&e.updateMapAttribute()}ngAfterViewInit(){this.setDataSource()}toggleRow(e){this.selection.toggle(e),this.cachedSelection.toggle(e)}pageChanged(){this.dataSource.paginator&&this.tableCheckbox.selectCachedDataOnPage(this.dataSource,this.selection,this.cachedSelection,this.selection.compareWith)}static{this.\u0275fac=function(n){return new(n||t)(m(J),m(pe),m(j),m(Y),m(ae),m(xi),m(Jt))}}static{this.\u0275cmp=D({type:t,selectors:[["app-entityless-attribute-keys-list"]],viewQuery:function(n,i){if(n&1&&(ve(ot,5),ve(be,5),ve(mn,5)),n&2){let s;Te(s=Ee())&&(i.child=s.first),Te(s=Ee())&&(i.sort=s.first),Te(s=Ee())&&(i.items=s)}},inputs:{attDef:"attDef"},outputs:{switchView:"switchView"},decls:20,vars:19,consts:[["spinner",""],["mat-dialog-title",""],["mat-dialog-actions","",1,"mt-3"],["mat-stroked-button","",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click"],["color","accent","matTooltip","save or remove new attribute first","mat-flat-button","","matTooltipPosition","above",1,"ms-2",3,"click","disabled","matTooltipDisabled"],["color","warn","mat-flat-button","",1,"ms-2",3,"click","disabled"],["mat-dialog-content","",1,"mt-3"],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["alert_type","warn",1,"mt-3"],[1,"card","mt-3",3,"hidden"],[3,"pageChanged","pageSizeOptions","dataLength","hideExport","tableId"],["mat-table","","matSort","","matSortActive","key","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"matSortChange","dataSource"],["matColumnDef","select"],["matColumnDef","key"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","value"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["class","align-checkbox","mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size align-checkbox","mat-cell","",4,"matCellDef"],["mat-header-cell","",1,"align-checkbox"],["color","primary",3,"change","aria-label","checked","indeterminate"],["mat-cell","",1,"static-column-size","align-checkbox"],["color","primary",3,"change","click","aria-label","checked"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["matInput","","placeholder","New key",3,"ngModelChange","ngModel"],["mat-header-cell",""],[3,"sendEventToParent2","attribute"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"]],template:function(n,i){if(n&1){let s=T();r(0,"h1",1),d(1),a(),r(2,"div",2)(3,"button",3),C("click",function(){return h(s),g(i.switchView.emit())}),d(4),l(5,"translate"),a(),r(6,"button",4),C("click",function(){return h(s),g(i.onSave())}),d(7),l(8,"translate"),a(),r(9,"button",5),C("click",function(){return h(s),g(i.onAdd())}),d(10),l(11,"translate"),a(),r(12,"button",6),C("click",function(){return h(s),g(i.onRemove())}),d(13),l(14,"translate"),a()(),r(15,"div",7),S(16,tr,1,0,"ng-template",null,0,B)(18,dr,14,14,"div",8),E(19,mr,3,3,"perun-web-apps-alert",9),a()}if(n&2){let s=R(17);o(),A(i.attDef.namespace+":"+i.attDef.friendlyName),o(3),f(" ",p(5,11,"SHARED.COMPONENTS.ENTITYLESS_ATTRIBUTES_LIST.CANCEL")," "),o(3),f(" ",p(8,13,"SHARED.COMPONENTS.ENTITYLESS_ATTRIBUTES_LIST.SAVE")," "),o(2),u("disabled",i.isAddButtonDisabled)("matTooltipDisabled",!i.isAddButtonDisabled),o(),f(" ",p(11,15,"SHARED.COMPONENTS.ENTITYLESS_ATTRIBUTES_LIST.ADD")," "),o(2),u("disabled",i.loading||i.selection.selected.length===0),o(),f(" ",p(14,17,"SHARED.COMPONENTS.ENTITYLESS_ATTRIBUTES_LIST.REMOVE")," "),o(5),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s),o(),I(!i.loading&&i.records.length===0?19:-1)}},dependencies:[x,L,O,Ye,Ke,Je,Xe,Ht,jt,Gt,qe,ze,Ft,$e,ie,Z,te,ee,X,Q,ot,Ce,xe,ye,Be,we,Me,Oe,Re,Le,Ne,Ue,Dt,be,At,M,We,N,mn,H,ei,y,ii,ti],styles:[".mat-mdc-cell[_ngcontent-%COMP%]{padding:8px 8px 8px 0}"]})}}return t})();var _r=()=>["id","name","enabled","script"];function fr(t,c){t&1&&b(0,"perun-web-apps-loading-dialog")}function hr(t,c){t&1&&(r(0,"mat-error"),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"DIALOGS.NAME_SPACE_ERROR")," "))}function gr(t,c){t&1&&(r(0,"mat-error"),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"DIALOGS.EDIT_ATTRIBUTE_DEFINITION.ERROR_FIELD_EMPTY")," "))}function Cr(t,c){t&1&&(r(0,"mat-error"),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"DIALOGS.EDIT_ATTRIBUTE_DEFINITION.ERROR_FIELD_EMPTY")," "))}function br(t,c){if(t&1){let e=T();r(0,"button",21),C("click",function(){h(e);let i=_(3);return g(i.switchShowKeys())}),d(1),l(2,"translate"),a()}t&2&&(o(),f(" ",p(2,1,"DIALOGS.EDIT_ATTRIBUTE_DEFINITION.SHOW_KEYS")," "))}function Sr(t,c){if(t&1){let e=T();r(0,"div")(1,"h1",3),d(2),l(3,"translate"),a(),r(4,"div",4)(5,"form",5)(6,"mat-form-field")(7,"mat-label"),d(8),l(9,"translate"),a(),b(10,"input",6),E(11,hr,3,3,"mat-error"),E(12,gr,3,3,"mat-error"),a(),r(13,"mat-form-field")(14,"mat-label"),d(15),l(16,"translate"),a(),b(17,"textarea",7),E(18,Cr,3,3,"mat-error"),a()(),r(19,"label",8),d(20),l(21,"translate"),a(),r(22,"div",9),d(23),r(24,"mat-icon",10),l(25,"translate"),C("click",function(){h(e);let i=_(2);return g(i.copyUrn())}),d(26,"content_copy"),a()(),b(27,"perun-web-apps-attribute-unique-checkbox",11),r(28,"perun-web-apps-attribute-critical-operations-checkboxes",12),C("readOperationChanged",function(i){h(e);let s=_(2);return g(s.finalReadOperations=i)})("readGlobalChanged",function(i){h(e);let s=_(2);return g(s.finalReadGlobal=i)})("writeOperationChanged",function(i){h(e);let s=_(2);return g(s.finalWriteOperations=i)})("writeGlobalChanged",function(i){h(e);let s=_(2);return g(s.finalWriteGlobal=i)}),a(),b(29,"perun-web-apps-attribute-rights-tab-group",13),l(30,"async"),r(31,"mat-accordion")(32,"mat-expansion-panel",14)(33,"mat-expansion-panel-header")(34,"mat-panel-title"),d(35),l(36,"translate"),a()(),b(37,"app-services-list",15),l(38,"async"),a()()(),r(39,"div",16),E(40,br,3,3,"button",17),r(41,"button",18),C("click",function(){h(e);let i=_(2);return g(i.onCancel())}),d(42),l(43,"translate"),a(),r(44,"button",19),C("click",function(){h(e);let i=_(2);return g(i.onCopy())}),d(45),l(46,"translate"),a(),r(47,"button",20),C("click",function(){h(e);let i=_(2);return g(i.onSubmit())}),d(48),l(49,"translate"),a()()()}if(t&2){let e=_(2);o(2),A(p(3,29,"DIALOGS.EDIT_ATTRIBUTE_DEFINITION.TITLE")),o(3),u("formGroup",e.attributeControl),o(3),A(p(9,31,"DIALOGS.EDIT_ATTRIBUTE_DEFINITION.DISPLAY_NAME")),o(3),I(e.attributeControl.hasError("spaceName","name")?11:-1),o(),I(e.attributeControl.hasError("required","name")?12:-1),o(3),A(p(16,33,"DIALOGS.EDIT_ATTRIBUTE_DEFINITION.DESCRIPTION")),o(3),I(e.attributeControl.hasError("required","description")?18:-1),o(2),f(" ",p(21,35,"DIALOGS.EDIT_ATTRIBUTE_DEFINITION.URN")," "),o(3),f(" ",e.urn," "),o(),u("matTooltip",fe(p(25,37,"DIALOGS.EDIT_ATTRIBUTE_DEFINITION.URN_TOOLTIP"))),o(3),u("attDef",e.attDef),o(),u("attDef",e.attDef)("readOperation",e.initReadOperations)("readGlobal",e.initReadGlobal)("writeOperation",e.initWriteOperations)("writeGlobal",e.initWriteGlobal),o(),u("attDef",e.attDef)("collections",p(30,39,e.collections$)),o(6),f(" ",p(36,41,"DIALOGS.EDIT_ATTRIBUTE_DEFINITION.SERVICES")," "),o(2),u("loading",e.loading)("disableRouting",!0)("displayColumns",he(51,_r))("services",p(38,43,e.services$)),o(3),I((e.attDef==null?null:e.attDef.entity)==="entityless"?40:-1),o(2),f(" ",p(43,45,"DIALOGS.EDIT_ATTRIBUTE_DEFINITION.CANCEL")," "),o(3),f(" ",p(46,47,"DIALOGS.EDIT_ATTRIBUTE_DEFINITION.COPY_FOR_IMPORT")," "),o(2),u("disabled",e.loading||e.attributeControl.invalid),o(),f(" ",p(49,49,"DIALOGS.EDIT_ATTRIBUTE_DEFINITION.CONFIRM")," ")}}function vr(t,c){if(t&1){let e=T();r(0,"div")(1,"app-entityless-attribute-keys-list",22),C("switchView",function(){h(e);let i=_(2);return g(i.switchShowKeys())}),a()()}if(t&2){let e=_(2);o(),u("attDef",e.attDef)}}function Tr(t,c){if(t&1&&(r(0,"div"),E(1,Sr,50,52,"div"),E(2,vr,2,1,"div"),a()),t&2){let e=_();o(),I(e.showKeys?-1:1),o(),I(e.showKeys?2:-1)}}var Ko=(()=>{class t{constructor(e,n,i,s,v,w,q,_e,Se){this.dialogRef=e,this.data=n,this.notificator=i,this.translate=s,this.clipboard=v,this.attributesManager=w,this.serviceService=q,this.formBuilder=_e,this.attributeRightsService=Se,this.loading=!1,this.showKeys=!1,this.attDef=this.data.attDef,this.attributeControl=this.formBuilder.group({name:[this.attDef.displayName,[ge.required,fi()]],description:[this.attDef.description,ge.required]}),this.urn=`${this.attDef.namespace}:${this.attDef.friendlyName}`,this.collections$=new G([]),this.emptyCollections=[{id:-1,attributeId:this.data.attDef.id,action:Bt.READ,policies:[]}],this.services$=this.serviceService.getServicesByAttributeDefinition(this.attDef.id).pipe(at([]))}ngOnInit(){this.loading=!0,this.dialogRef.addPanelClass("mat-dialog-height-transition"),this.initUnique=this.attDef.unique,this.attributesManager.getAttributeRules(this.attDef.id).subscribe(e=>{this.collections$=new G(e.attributePolicyCollections),this.initReadOperations="READ"in e.criticalActions,this.initWriteOperations="WRITE"in e.criticalActions,this.initReadGlobal=e.criticalActions.READ||!1,this.initWriteGlobal=e.criticalActions.WRITE||!1,this.loading=!1})}onSubmit(){this.loading=!0,this.updateAttribute();let e=Ti({},this.attDef);e.unique=this.initUnique,this.attributesManager.updateAttributeDefinition({attributeDefinition:e}).pipe(se(()=>ft(this.collections$.getValue())),this.attributeRightsService.filterNullInPolicy(),se(n=>this.attributesManager.setAttributePolicyCollections(n.length>0?{policyCollections:n}:{policyCollections:this.emptyCollections})),se(()=>this.attributeRightsService.updateAttributeAction(this.finalReadOperations,this.initReadOperations,this.finalReadGlobal,this.initReadGlobal,this.attDef.id,Bt.READ)),se(()=>this.attributeRightsService.updateAttributeAction(this.finalWriteOperations,this.initWriteOperations,this.finalWriteGlobal,this.initWriteGlobal,this.attDef.id,Bt.WRITE)),se(()=>this.initUnique===this.attDef.unique?ft(null):this.attDef.unique?this.attributesManager.convertAttributeToUnique(this.attDef.id):this.attributesManager.convertAttributeToNonunique(this.attDef.id))).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.EDIT_ATTRIBUTE_DEFINITION.SUCCESS")),this.dialogRef.close(!0)},error:n=>{this.attDef.unique=this.initUnique,this.loading=!1,console.error(n)}})}onCancel(){this.dialogRef.close(!1)}switchShowKeys(){this.showKeys=!this.showKeys,this.showKeys?this.dialogRef.updateSize("800px"):this.dialogRef.updateSize("700px")}copyUrn(){this.clipboard.copy(this.urn)?this.notificator.showSuccess(this.translate.instant("DIALOGS.EDIT_ATTRIBUTE_DEFINITION.COPIED")):this.notificator.showError(this.translate.instant("DIALOGS.EDIT_ATTRIBUTE_DEFINITION.COPY_FAILED"))}onCopy(){this.updateAttribute();let e={attributeDefinition:this.attDef,attributeRights:this.collections$.getValue()};this.clipboard.copy(JSON.stringify(e))?this.notificator.showSuccess(this.translate.instant("DIALOGS.EDIT_ATTRIBUTE_DEFINITION.COPIED")):this.notificator.showError(this.translate.instant("DIALOGS.EDIT_ATTRIBUTE_DEFINITION.COPY_FAILED"))}updateAttribute(){this.attDef.displayName=this.attributeControl.value.name,this.attDef.description=this.attributeControl.value.description}static{this.\u0275fac=function(n){return new(n||t)(m(J),m(pe),m(j),m(Y),m(Ki),m(ae),m(_t),m(Bi),m(Zt))}}static{this.\u0275cmp=D({type:t,selectors:[["app-edit-attribute-definition-dialog"]],decls:4,vars:2,consts:[["spinner",""],[1,"admin-theme","position-relative"],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fields-container",3,"formGroup"],["matInput","","data-cy","display-name-input","formControlName","name","required",""],["matInput","","formControlName","description","cdkTextareaAutosize","","required",""],[1,"urn-name"],[1,"urn-row"],["matSuffix","",1,"copy-urn",3,"click","matTooltip"],[3,"attDef"],[3,"readOperationChanged","readGlobalChanged","writeOperationChanged","writeGlobalChanged","attDef","readOperation","readGlobal","writeOperation","writeGlobal"],[3,"attDef","collections"],[1,"mt-4","mb-4"],[3,"loading","disableRouting","displayColumns","services"],["mat-dialog-actions",""],["mat-stroked-button",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["mat-stroked-button","",1,"ms-2",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"],["mat-stroked-button","",3,"click"],[3,"switchView","attDef"]],template:function(n,i){if(n&1&&(S(0,fr,1,0,"ng-template",null,0,B),r(2,"div",1),S(3,Tr,3,2,"div",2),a()),n&2){let s=R(1);o(3),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,Qe,ut,Ye,Ke,ct,xt,An,Je,Xe,Ui,$e,yi,qe,ze,Mi,pt,Ri,Li,ie,Z,te,ee,ue,Hn,jn,Pn,Fn,Gn,M,We,Io,Xi,Qi,Ji,$o,N,He,y],styles:[".fields-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.urn-name[_ngcontent-%COMP%]{color:#0000008a;margin-bottom:0;font-size:small}.urn-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.copy-urn[_ngcontent-%COMP%]{cursor:pointer}"],data:{animation:[mo,uo,_o]}})}}return t})();var Si=(()=>{class t{constructor(e){this.storeService=e,this.USER_CONSENT_RELATED_ATT_NAMESPACE=["urn:perun:user_facility:attribute-def","urn:perun:user:attribute-def","urn:perun:member:attribute-def","urn:perun:member_group:attribute-def","urn:perun:member_resource:attribute-def","urn:perun:ues:attribute-def"]}transform(e,n,i){return!this.storeService.getProperty("enforce_consents")||!i||!n?!1:this.USER_CONSENT_RELATED_ATT_NAMESPACE.reduce((v,w)=>v||e.startsWith(w),!1)}static{this.\u0275fac=function(n){return new(n||t)(m(Ve,16))}}static{this.\u0275pipe=Et({name:"consentRelatedAttribute",type:t,pure:!0})}}return t})();var Yo=(()=>{class t{transform(e){if(e===null)return null;let n=e;return n.substring(n.lastIndexOf(":")+1,n.length)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275pipe=Et({name:"nameSpaceToDef",type:t,pure:!0})}}return t})();var Ir=t=>({all:t}),Ar=t=>({name:t});function Dr(t,c){if(t&1){let e=T();r(0,"mat-checkbox",22),l(1,"masterCheckboxLabel"),l(2,"translate"),C("change",function(i){h(e);let s=_(3);return g(i?s.masterToggle():null)}),a()}if(t&2){let e=_(2),n=_();gt("aria-label",p(2,6,p(1,4,e.all))),u("checked",n.selection.hasValue()&&e.all)("indeterminate",n.selection.hasValue()&&!e.all)("disabled",!n.isMasterCheckboxEnabled)}}function xr(t,c){if(t&1&&(r(0,"th",19)(1,"span",20),l(2,"translate"),E(3,Dr,3,8,"mat-checkbox",21),a()()),t&2){let e=_(2);o(),u("matTooltipDisabled",e.isMasterCheckboxEnabled)("matTooltip",p(2,3,"ADMIN.ATTRIBUTES.MASTER_CHECKBOX_TOOLTIP")),o(2),I(e.selection.isMultipleSelection()?3:-1)}}function Mr(t,c){if(t&1){let e=T();r(0,"td",23)(1,"mat-checkbox",24),l(2,"multiWordDataCy"),l(3,"checkboxLabel"),l(4,"translate"),l(5,"consentRelatedAttribute"),l(6,"translate"),l(7,"consentRelatedAttribute"),C("change",function(i){let s=h(e).$implicit,v=_(2);return g(i?v.toggleRow(s):null)})("click",function(i){return h(e),g(i.stopPropagation())}),a()()}if(t&2){let e=c.$implicit,n=_(2);o(),ui("data-cy",Ie("",p(2,7,e.displayName),"-checkbox")),gt("aria-label",je(4,11,p(3,9,n.selection.isSelected(e)),De(24,Ar,e.displayName))),u("checked",n.selection.isSelected(e))("disabled",Di(5,14,e.namespace,n.serviceEnabled,n.consentRequired))("matTooltip",p(6,18,"ADMIN.ATTRIBUTES.CONSENT_RELATED_DISABLED"))("matTooltipDisabled",!Di(7,20,e.namespace,n.serviceEnabled,n.consentRequired))}}function yr(t,c){t&1&&(k(0,3),S(1,xr,4,5,"th",17)(2,Mr,8,26,"td",18),P())}function wr(t,c){t&1&&(r(0,"th",25),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"ADMIN.ATTRIBUTES.TABLE_ATTR_ID")," "))}function Rr(t,c){if(t&1&&(r(0,"td",26),d(1),a()),t&2){let e=c.$implicit;o(),A(e.id)}}function Lr(t,c){t&1&&(r(0,"th",25),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"ADMIN.ATTRIBUTES.TABLE_ATTR_FRIENDLY_NAME")," "))}function Br(t,c){if(t&1&&(r(0,"td",27),l(1,"multiWordDataCy"),d(2),a()),t&2){let e=c.$implicit;ui("data-cy",Ie("",p(1,3,e.friendlyName),"-friendly-name")),o(2),f(" ",e.friendlyName," ")}}function Or(t,c){t&1&&(r(0,"th",25),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"ADMIN.ATTRIBUTES.TABLE_ATTR_DISPLAY_NAME")," "))}function Nr(t,c){if(t&1&&(r(0,"td",27),d(1),a()),t&2){let e=c.$implicit;o(),f(" ",e.displayName," ")}}function Ur(t,c){t&1&&(r(0,"th",25),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"ADMIN.ATTRIBUTES.TABLE_ATTR_ENTITY")," "))}function Vr(t,c){if(t&1&&(r(0,"td",27),d(1),a()),t&2){let e=c.$implicit;o(),A(e.entity)}}function kr(t,c){t&1&&(r(0,"th",25),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"ADMIN.ATTRIBUTES.TABLE_ATTR_DEF")," "))}function Pr(t,c){if(t&1&&(r(0,"td",27),d(1),l(2,"nameSpaceToDef"),a()),t&2){let e=c.$implicit;o(),A(p(2,1,e.namespace))}}function Fr(t,c){t&1&&(r(0,"th",25),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"ADMIN.ATTRIBUTES.TABLE_ATTR_TYPE")," "))}function Gr(t,c){if(t&1&&(r(0,"td",27),d(1),l(2,"attributeTypeClean"),a()),t&2){let e=c.$implicit;o(),A(p(2,1,e.type))}}function jr(t,c){t&1&&(r(0,"th",25),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"ADMIN.ATTRIBUTES.TABLE_ATTR_UNIQUE")," "))}function Hr(t,c){if(t&1&&(r(0,"td",27),d(1),a()),t&2){let e=c.$implicit;o(),A(e.unique)}}function Wr(t,c){t&1&&b(0,"tr",28)}function qr(t,c){if(t&1){let e=T();r(0,"tr",29),C("click",function(){let i=h(e).$implicit,s=_();return g(s.onRowClick(i))}),a()}if(t&2){let e=_();Ge("cursor-pointer",!e.disableRouting)}}function zr(t,c){t&1&&(r(0,"perun-web-apps-alert",16),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"ADMIN.ATTRIBUTES.NO_ATTRIBUTES")," "))}function $r(t,c){t&1&&(r(0,"perun-web-apps-alert",16),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT")," "))}var di=(()=>{class t{constructor(e,n,i,s,v,w){this.dialog=e,this.authResolver=n,this.tableCheckbox=i,this.consentRelatedPipe=s,this.destroyRef=v,this.tableConfigService=w,this.selection=new K(!0,[]),this.disableRouting=!1,this.consentRequired=!1,this.serviceEnabled=!1,this.refreshEvent=new Tt,this.tableId="app-attr-def-list",this.pageSizeOptions=yt,this.isMasterCheckboxEnabled=!0,this.displayedColumns=["select","id","friendlyName","displayName","entity","namespace","type","unique"],this.unfilteredColumns=this.displayedColumns,this.canBeSelected=q=>!this.consentRelatedPipe.transform(q.namespace,this.serviceEnabled,this.consentRequired)}set displayColumns(e){this.unfilteredColumns=e,localStorage.getItem("showIds")!=="true"&&(e=e.filter(n=>n!=="id")),this.displayedColumns=e}set matSort(e){this.sort=e,this.setDataSource()}static getDataForColumn(e,n){switch(n){case"id":return e.id.toString();case"friendlyName":return e.friendlyName;case"displayName":return e.displayName;case"entity":return e.entity;case"namespace":if(e.namespace){let i=e.namespace;return i.substring(i.lastIndexOf(":")+1,i.length)}return"";case"type":if(e.type){let i=e.type;return i.substring(i.lastIndexOf(".")+1,i.length)}return"";case"unique":return e.unique?"true":"false";default:return""}}ngOnInit(){this.selection&&(this.cachedSelection=new K(this.selection.isMultipleSelection(),[],!0,this.selection.compareWith),this.cachedSubject?.pipe(wt(this.destroyRef)).subscribe(e=>{e&&this.cachedSelection.clear()})),this.watchForIdColumnChanges()}ngOnChanges(){this.dataSource=new Ae(this.definitions),this.setDataSource(),this.isMasterCheckboxEnabled=this.tableCheckbox.anySelectableRows(this.dataSource,this.canBeSelected)}ngAfterViewInit(){this.dataSource.paginator=this.child.paginator}exportAllData(e){st(Fe(this.dataSource.filteredData,this.displayedColumns,t.getDataForColumn),e)}exportDisplayedData(e){let n=this.dataSource.paginator.pageIndex*this.dataSource.paginator.pageSize,i=n+this.dataSource.paginator.pageSize;st(Fe(this.dataSource.sortData(this.dataSource.filteredData,this.dataSource.sort).slice(n,i),this.displayedColumns,t.getDataForColumn),e)}setDataSource(){this.dataSource&&(this.dataSource.filter=this.filterValue,this.dataSource.sort=this.sort,this.dataSource.filterPredicate=(e,n)=>Xt(e,n,this.displayedColumns,t.getDataForColumn),this.dataSource.sortData=(e,n)=>Qt(e,n,t.getDataForColumn),this.dataSource.paginator=this.child.paginator)}isAllSelected(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.dataSource,this.canBeSelected)}masterToggle(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.cachedSelection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!0,this.canBeSelected)}onRowClick(e){if(!this.disableRouting){let n=V();n.width="700px",n.data={attDef:Ti({},e)},this.dialog.open(Ko,n).afterClosed().subscribe(s=>{s&&(this.selection.clear(),this.refreshEvent.emit())})}}toggleRow(e){this.selection.toggle(e),this.cachedSelection.toggle(e)}pageChanged(){this.cachedSelection&&(this.isMasterCheckboxEnabled=this.tableCheckbox.anySelectableRows(this.dataSource,this.canBeSelected),this.tableCheckbox.selectCachedDataOnPage(this.dataSource,this.selection,this.cachedSelection,this.selection.compareWith))}watchForIdColumnChanges(){this.tableConfigService.showIdsChanged.pipe(wt(this.destroyRef)).subscribe(e=>{e?this.displayedColumns=this.unfilteredColumns:this.displayedColumns=this.unfilteredColumns.filter(n=>n!=="id")}),localStorage.getItem("showIds")!=="true"&&(this.displayedColumns=this.displayedColumns.filter(e=>e!=="id"))}static{this.\u0275fac=function(n){return new(n||t)(m($),m(re),m(Jt),m(Si),m(Ut),m(ni))}}static{this.\u0275cmp=D({type:t,selectors:[["app-attr-def-list"]],viewQuery:function(n,i){if(n&1&&(ve(ot,7),ve(be,7)),n&2){let s;Te(s=Ee())&&(i.child=s.first),Te(s=Ee())&&(i.matSort=s.first)}},inputs:{definitions:"definitions",selection:"selection",cachedSubject:"cachedSubject",filterValue:"filterValue",disableRouting:"disableRouting",consentRequired:"consentRequired",serviceEnabled:"serviceEnabled",loading:"loading",displayColumns:"displayColumns"},outputs:{refreshEvent:"refreshEvent"},features:[It([Si]),Ii],decls:30,vars:16,consts:[[1,"card","mt-2",3,"hidden"],[3,"exportDisplayedData","exportAllData","pageChanged","pageSizeOptions","dataLength","tableId"],["mat-table","","matSort","","matSortActive","displayName","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"matSortChange","dataSource"],["matColumnDef","select"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","friendlyName"],["mat-cell","",4,"matCellDef"],["matColumnDef","displayName"],["matColumnDef","entity"],["matColumnDef","namespace"],["matColumnDef","type"],["matColumnDef","unique"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",3,"cursor-pointer","click",4,"matRowDef","matRowDefColumns"],["alert_type","warn"],["class","align-checkbox","mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size align-checkbox","mat-cell","",4,"matCellDef"],["mat-header-cell","",1,"align-checkbox"],[3,"matTooltipDisabled","matTooltip"],["color","primary",3,"aria-label","checked","indeterminate","disabled"],["color","primary",3,"change","aria-label","checked","indeterminate","disabled"],["mat-cell","",1,"static-column-size","align-checkbox"],["matTooltipPosition","left","color","primary",3,"change","click","aria-label","checked","disabled","matTooltip","matTooltipDisabled"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"static-column-size"],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item",3,"click"]],template:function(n,i){if(n&1&&(r(0,"div",0)(1,"perun-web-apps-table-wrapper",1),C("exportDisplayedData",function(v){return i.exportDisplayedData(v)})("exportAllData",function(v){return i.exportAllData(v)})("pageChanged",function(){return i.pageChanged()}),r(2,"table",2),C("matSortChange",function(){return i.pageChanged()}),E(3,yr,3,0,"ng-container",3),l(4,"isAllSelected"),k(5,4),S(6,wr,3,3,"th",5)(7,Rr,2,1,"td",6),P(),k(8,7),S(9,Lr,3,3,"th",5)(10,Br,3,5,"td",8),P(),k(11,9),S(12,Or,3,3,"th",5)(13,Nr,2,1,"td",8),P(),k(14,10),S(15,Ur,3,3,"th",5)(16,Vr,2,1,"td",8),P(),k(17,11),S(18,kr,3,3,"th",5)(19,Pr,3,3,"td",8),P(),k(20,12),S(21,Fr,3,3,"th",5)(22,Gr,3,3,"td",8),P(),k(23,13),S(24,jr,3,3,"th",5)(25,Hr,2,1,"td",8),P(),S(26,Wr,1,0,"tr",14)(27,qr,1,2,"tr",15),a()()(),E(28,zr,3,3,"perun-web-apps-alert",16),E(29,$r,3,3,"perun-web-apps-alert",16)),n&2){let s;u("hidden",i.dataSource.filteredData.length===0||i.definitions.length===0),o(),u("pageSizeOptions",i.pageSizeOptions)("dataLength",i.dataSource.filteredData.length)("tableId",i.tableId),o(),u("dataSource",i.dataSource),o(),I((s=De(14,Ir,Di(4,10,i.dataSource,i.selection.selected.length,i.canBeSelected)))?3:-1,s),o(23),u("matHeaderRowDef",i.displayedColumns),o(),u("matRowDefColumns",i.displayedColumns),o(),I(!i.loading&&i.definitions.length===0?28:-1),o(),I(i.dataSource.filteredData.length===0&&i.definitions.length!==0?29:-1)}},dependencies:[x,Ht,jt,X,Q,ot,Ce,xe,ye,Be,we,Me,Oe,Re,Le,Ne,Ue,Dt,be,At,M,We,ei,y,ti,Si,zi,Yo,ii,an],styles:[".cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}"]})}}return t})();function Kr(t,c){if(t&1){let e=T();r(0,"button",9),C("click",function(){h(e);let i=_();return g(i.onCreate())}),d(1),l(2,"translate"),a()}t&2&&(o(),f(" ",p(2,1,"ADMIN.ATTRIBUTES.CREATE")," "))}function Yr(t,c){if(t&1){let e=T();r(0,"button",10),C("click",function(){h(e);let i=_();return g(i.onImport())}),d(1),l(2,"translate"),a()}t&2&&(o(),f(" ",p(2,1,"ADMIN.ATTRIBUTES.IMPORT")," "))}function Qr(t,c){if(t&1){let e=T();r(0,"button",11),C("click",function(){h(e);let i=_();return g(i.onDelete())}),d(1),l(2,"translate"),a()}if(t&2){let e=_();u("disabled",e.loading||e.selected.selected.length===0),o(),f(" ",p(2,2,"ADMIN.ATTRIBUTES.DELETE")," ")}}function Xr(t,c){t&1&&b(0,"perun-web-apps-loading-table")}function Jr(t,c){if(t&1){let e=T();r(0,"app-attr-def-list",12),C("refreshEvent",function(){h(e);let i=_();return g(i.refreshTable())}),a()}if(t&2){let e=_();u("loading",e.loading)("definitions",e.attrDefinitions)("disableRouting",!e.authResolver.isPerunAdminOrObserver())("filterValue",e.filterValue)("selection",e.selected)("cachedSubject",e.cachedSubject)}}var Xo=(()=>{class t{constructor(e,n,i){this.dialog=e,this.attributesManager=n,this.authResolver=i,this.attrDefinitions=[],this.selected=new K(!0,[],!0,(s,v)=>s.id===v.id),this.cachedSubject=new G(!0),this.filterValue=""}ngOnInit(){this.refreshTable()}onCreate(){let e=V();e.width="650px",this.dialog.open(Wo,e).afterClosed().subscribe(i=>{i&&this.refreshTable()})}onDelete(){let e=V();e.width="450px",e.data={attributes:this.selected.selected,theme:"admin-theme"},this.dialog.open(Ho,e).afterClosed().subscribe(i=>{i&&this.refreshTable()})}refreshTable(){this.loading=!0,this.attributesManager.getAllAttributeDefinitions().subscribe(e=>{this.attrDefinitions=e,this.selected.clear(),this.cachedSubject.next(!0),this.loading=!1})}applyFilter(e){this.filterValue=e,this.refreshTable()}onImport(){let e=V();e.width="700px",this.dialog.open(qo,e).afterClosed().subscribe(i=>{i===!0&&this.refreshTable()})}static{this.\u0275fac=function(n){return new(n||t)(m($),m(ae),m(re))}}static{this.\u0275cmp=D({type:t,selectors:[["app-admin-attributes"]],hostVars:2,hostBindings:function(n,i){n&2&&Ge("router-component",i.true)},decls:13,vars:9,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["color","accent","data-cy","new-attr-definition-button","mat-flat-button","",1,"me-2","action-button"],["color","accent","mat-flat-button","",1,"me-2","action-button"],["color","warn","data-cy","delete-attr-definition-button","mat-flat-button","",1,"me-2",3,"disabled"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","definitions","disableRouting","filterValue","selection","cachedSubject","refreshEvent",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","data-cy","new-attr-definition-button","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","data-cy","delete-attr-definition-button","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"refreshEvent","loading","definitions","disableRouting","filterValue","selection","cachedSubject"]],template:function(n,i){if(n&1){let s=T();r(0,"div")(1,"h1",1),d(2),l(3,"translate"),a(),r(4,"perun-web-apps-refresh-button",2),C("refresh",function(){return h(s),g(i.refreshTable())}),a(),E(5,Kr,3,3,"button",3),E(6,Yr,3,3,"button",4),E(7,Qr,3,4,"button",5),r(8,"perun-web-apps-debounce-filter",6),C("filter",function(w){return h(s),g(i.applyFilter(w))}),a(),S(9,Xr,1,0,"ng-template",null,0,B),r(11,"div",7),S(12,Jr,1,6,"app-attr-def-list",8),a()()}if(n&2){let s=R(10);o(2),A(p(3,7,"ADMIN.ATTRIBUTES.TITLE")),o(3),I(i.authResolver.isPerunAdmin()?5:-1),o(),I(i.authResolver.isPerunAdmin()?6:-1),o(),I(i.authResolver.isPerunAdmin()?7:-1),o(),u("placeholder","ADMIN.ATTRIBUTES.SEARCH"),o(4),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,de,ce,M,di,N,H,y],encapsulation:2})}}return t})();var ts=()=>({color:"black"}),is=t=>["/admin/users",t];function ns(t,c){t&1&&b(0,"mat-spinner",1)}function os(t,c){if(t&1){let e=T();r(0,"button",12),l(1,"translate"),C("click",function(){h(e);let i=_(3);return g(i.editUser())}),r(2,"mat-icon"),d(3,"edit"),a()()}t&2&&u("matTooltip",fe(p(1,2,"ADMIN_USER.EDIT")))}function as(t,c){if(t&1){let e=T();r(0,"button",13),l(1,"translate"),C("click",function(){h(e);let i=_(3);return g(i.anonymizeUser())}),r(2,"mat-icon"),d(3,"no_accounts"),a()()}t&2&&u("matTooltip",fe(p(1,2,"ADMIN_USER.ANONYMIZE")))}function rs(t,c){if(t&1){let e=T();r(0,"button",13),l(1,"translate"),C("click",function(){h(e);let i=_(3);return g(i.deleteUser())}),r(2,"mat-icon"),d(3,"delete_forever"),a()()}t&2&&u("matTooltip",fe(p(1,2,"ADMIN_USER.DELETE")))}function ss(t,c){t&1&&(r(0,"mat-icon",11),l(1,"translate"),d(2," blur_off "),a()),t&2&&u("matTooltip",fe(p(1,2,"USER_DETAIL.DASHBOARD.ANONYMIZED")))}function ls(t,c){if(t&1&&(r(0,"span"),E(1,os,4,4,"button",9),E(2,as,4,4,"button",10),E(3,rs,4,4,"button",10),E(4,ss,3,4,"mat-icon",11),a()),t&2){let e=_(2);o(),I(e.anonymized?-1:1),o(),I(!e.anonymized&&!e.userDeletionForced?2:-1),o(),I(e.userDeletionForced?3:-1),o(),I(e.anonymized?4:-1)}}function ps(t,c){if(t&1&&(r(0,"div",2),b(1,"mat-icon",3),l(2,"translate"),r(3,"div",4)(4,"div",5)(5,"a",6),d(6),l(7,"userFullName"),a(),r(8,"span",7),d(9),a(),E(10,ls,5,4,"span"),a(),r(11,"div"),d(12),l(13,"translate"),a(),r(14,"span",8),d(15),l(16,"translate"),l(17,"translate"),a()()()),t&2){let e=_();o(),u("matTooltip",fe(p(2,13,"ADMIN_USER.ENTITY")))("ngStyle",he(23,ts))("svgIcon",e.svgIcon),o(4),u("routerLink",De(24,is,e.user.id)),o(),f(" ",p(7,15,e.user)," "),o(3),f(" \xA0#",e.user.id," "),o(),I(e.authResolver.isPerunAdmin()?10:-1),o(2),rt("",p(13,17,"ADMIN_USER.UUID"),": ",e.user.uuid),o(3),vn(" ",p(16,19,"ADMIN_USER.ENTITY"),", ",p(17,21,"ADMIN_USER.USER_TYPE"),": ",e.getUserType()," ")}}var Jo=(()=>{class t{constructor(e,n,i,s,v,w,q,_e,Se,mi){this.route=e,this.attributesService=n,this.usersService=i,this.sideMenuService=s,this.sideMenuItemService=v,this.dialog=w,this.authResolver=q,this.entityStorageService=_e,this.router=Se,this.store=mi,this.loading=!1,this.svgIcon="perun-user-dark"}ngOnInit(){this.loading=!0,this.userDeletionForced=this.store.getProperty("user_deletion_forced"),this.route.params.subscribe(e=>{let n=Number(e.userId);this.entityStorageService.setEntityAndPathParam({id:Number(n),beanName:"User"},Hi.User),this.path=`/admin/users/${n}`,this.regex="/admin/users/\\d+",this.usersService.getUserById(n).subscribe({next:s=>{this.user=s,this.svgIcon=this.user.serviceUser?"perun-service-identity":"perun-user-dark";let v=this.sideMenuItemService.parseUser(s,this.path,this.regex);this.sideMenuService.setAdminItems([v]),this.loading=!1},error:()=>this.loading=!1}),this.attributesService.getAttribute("urn:perun:user:attribute-def:virt:anonymized",void 0,void 0,n).subscribe(s=>{this.anonymized=!!s.value})})}editUser(){let e=V();e.width="450px",e.data={theme:"admin-theme",user:this.user},this.dialog.open(yo,e).afterClosed().subscribe(i=>{i&&this.usersService.getUserById(this.user.id).subscribe(s=>{this.user=s})})}getUserType(){return this.user.serviceUser?"Service":"Person"}anonymizeUser(){this.openDialog(to)}deleteUser(){this.openDialog(io)}openDialog(e){let n=V();n.width="550px",n.data={theme:"admin-theme",user:this.user},this.dialog.open(e,n).afterClosed().subscribe(s=>{s&&this.router.navigate(["/admin","users"],{queryParamsHandling:"merge"})})}static{this.\u0275fac=function(n){return new(n||t)(m(me),m(ae),m(le),m(si),m(en),m($),m(re),m(ke),m(Oi),m(Ve))}}static{this.\u0275cmp=D({type:t,selectors:[["app-admin-user-detail-page"]],decls:5,vars:2,consts:[[1,"container-fluid","ps-xl-5","pe-xl-5","user-theme"],[1,"me-auto","ms-auto"],[1,"d-flex","page-title-headtitle"],[1,"perun-icon","perun-icon-detail",3,"ngStyle","svgIcon","matTooltip"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],["data-cy","user-name-link",1,"user-link",3,"routerLink"],[1,"text-muted"],[1,"mt-1","entity-info"],["mat-icon-button","","data-cy","edit-user-button",3,"matTooltip"],["mat-icon-button","",3,"matTooltip"],[1,"mat-icon-war","ms-2",3,"matTooltip"],["mat-icon-button","","data-cy","edit-user-button",3,"click","matTooltip"],["mat-icon-button","",3,"click","matTooltip"]],template:function(n,i){n&1&&(r(0,"div",0),b(1,"perun-web-apps-back-button"),E(2,ns,1,0,"mat-spinner",1),E(3,ps,18,26,"div",2),b(4,"app-animated-router-outlet"),a()),n&2&&(o(2),I(i.loading?2:-1),o(),I(!i.loading&&i.user!==void 0?3:-1))},dependencies:[x,Pt,L,Ni,Qe,ut,ri,oi,ki,li,qt,Wt,mt,dt,M,We,y,wn],encapsulation:2})}}return t})();var Zo=(()=>{class t{constructor(e,n){this.userService=e,this.route=n,this.items=[],this.isServiceUser=!1,this.displayedColumns=["name","value"]}ngOnInit(){this.route.params.subscribe(e=>{this.userService.getUserById(Number(e.userId)).subscribe(n=>{this.user=n,this.isServiceUser=n.serviceUser,this.setItems(`/admin/users/${this.user.id}`)})})}setItems(e){this.items=[],this.items.push({cssIcon:"perun-user",url:`${e}/accounts`,label:"MENU_ITEMS.USER.ACCOUNTS",style:"user-btn"},{cssIcon:"perun-facility-white",url:`${e}/assignments`,label:"MENU_ITEMS.USER.ASSIGNMENTS",style:"user-btn"},{cssIcon:"perun-identity",url:`${e}/identities`,label:"MENU_ITEMS.USER.IDENTITIES",style:"user-btn"},{cssIcon:"perun-applications",url:`${e}/applications`,label:"MENU_ITEMS.USER.APPLICATIONS",style:"user-btn"}),this.items.push({cssIcon:"perun-attributes",url:`${e}/attributes`,label:"MENU_ITEMS.USER.ATTRIBUTES",style:"user-btn"}),this.items.push({cssIcon:"perun-roles",url:`${e}/roles`,label:"MENU_ITEMS.USER.ROLES",style:"user-btn"}),this.isServiceUser?this.items.push({cssIcon:"perun-manager",url:`${e}/associated-users`,label:"MENU_ITEMS.USER.ASSOCIATED_USERS",style:"user-btn"}):this.items.push({cssIcon:"perun-service-identity",url:`${e}/service-identities`,label:"MENU_ITEMS.USER.SERVICE_IDENTITIES",style:"user-btn"}),this.items.push({cssIcon:"perun-ban",url:"bans",label:"MENU_ITEMS.USER.BANS",style:"user-btn"})}static{this.\u0275fac=function(n){return new(n||t)(m(le),m(me))}}static{this.\u0275cmp=D({type:t,selectors:[["app-user-overview"]],hostVars:2,hostBindings:function(n,i){n&2&&Ge("router-component",i.true)},decls:1,vars:1,consts:[[3,"items"]],template:function(n,i){n&1&&b(0,"perun-web-apps-menu-buttons-field",0),n&2&&u("items",i.items)},dependencies:[x,L,Qe,ai,Wi,Ce,M],styles:[".align-cards[_ngcontent-%COMP%]{margin:1rem 0;display:inline-block;vertical-align:top}"]})}}return t})();function cs(t,c){t&1&&(d(0),l(1,"translate")),t&2&&f(" ",p(1,1,"ADMIN_USER.ENTITY")," ")}function ds(t,c){if(t&1&&b(0,"app-one-entity-attribute-page",5),t&2){let e=_();u("entityId",e.userId)("entity","user")}}function ms(t,c){t&1&&(d(0),l(1,"translate"),l(2,"translate")),t&2&&rt(" ",p(1,2,"ADMIN_USER.ENTITY")," - ",p(2,4,"FACILITY_DETAIL.ENTITY")," ")}function us(t,c){if(t&1&&b(0,"app-two-entity-attribute-page",6),t&2){let e=_(2);u("firstEntity","user")("firstEntityId",e.userId)("secondEntity","facility")}}function _s(t,c){t&1&&(r(0,"mat-tab"),S(1,ms,3,6,"ng-template",3)(2,us,1,3,"ng-template",4),a())}var ea=(()=>{class t{constructor(e,n,i){this.route=e,this.store=n,this.authResolver=i}ngOnInit(){this.route.parent.params.subscribe(e=>{this.userId=Number(e.userId),this.userId||(this.userId=this.store.getPerunPrincipal().userId);let n={id:this.userId,beanName:"User"};this.userFacilityAttAuth=this.authResolver.isAuthorized("getAssignedFacilities_User_policy",[n])})}static{this.\u0275fac=function(n){return new(n||t)(m(me),m(Ve),m(re))}}static{this.\u0275cmp=D({type:t,selectors:[["app-user-settings-attributes"]],hostVars:2,hostBindings:function(n,i){n&2&&Ge("router-component",i.true)},decls:8,vars:4,consts:[[1,"page-subtitle"],["mat-stretch-tabs","false"],[1,"mb-2"],["matTabLabel",""],["matTabContent",""],[3,"entityId","entity"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(n,i){n&1&&(r(0,"h1",0),d(1),l(2,"translate"),a(),r(3,"mat-tab-group",1)(4,"mat-tab",2),S(5,cs,2,3,"ng-template",3)(6,ds,1,2,"ng-template",4),a(),E(7,_s,3,0,"mat-tab"),a()),n&2&&(o(),A(p(2,2,"USER_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),o(6),I(i.userFacilityAttAuth?7:-1))},dependencies:[x,tn,pi,nt,Ze,et,tt,it,M,y],encapsulation:2})}}return t})();var fs=()=>["id","name","type"];function hs(t,c){t&1&&b(0,"perun-web-apps-loading-table")}function gs(t,c){if(t&1&&b(0,"app-ext-sources-list",7),t&2){let e=_();u("loading",e.loading)("extSources",e.extSources)("filterValue",e.filterValue)("displayColumns",he(4,fs))}}var ta=(()=>{class t{constructor(e,n){this.extSourceService=e,this.authResolver=n,this.extSources=[],this.filterValue="",this.loading=!1}ngOnInit(){this.refreshTable()}applyFilter(e){this.filterValue=e}loadConfigExtSources(){this.loading=!0,this.extSourceService.loadExtSourcesDefinitions().subscribe(()=>{this.refreshTable()})}refreshTable(){this.loading=!0,this.extSourceService.getExtSources().subscribe(e=>{this.extSources=e,this.loading=!1})}static{this.\u0275fac=function(n){return new(n||t)(m(Pi),m(re))}}static{this.\u0275cmp=D({type:t,selectors:[["app-admin-ext-sources"]],decls:13,vars:9,consts:[["spinner",""],[1,"page-subtitle"],[3,"click"],["mat-stroked-button","",1,"me-2",3,"click"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","extSources","filterValue","displayColumns",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","extSources","filterValue","displayColumns"]],template:function(n,i){if(n&1){let s=T();r(0,"div")(1,"h1",1),d(2),l(3,"translate"),a(),r(4,"perun-web-apps-refresh-button",2),C("click",function(){return h(s),g(i.refreshTable())}),a(),r(5,"button",3),C("click",function(){return h(s),g(i.loadConfigExtSources())}),d(6),l(7,"translate"),a(),r(8,"perun-web-apps-debounce-filter",4),C("filter",function(w){return h(s),g(i.applyFilter(w))}),a(),S(9,hs,1,0,"ng-template",null,0,B),r(11,"div",5),S(12,gs,1,5,"app-ext-sources-list",6),a()()}if(n&2){let s=R(10);o(2),A(p(3,5,"ADMIN.EXT_SOURCES.TITLE")),o(4),f(" ",p(7,7,"ADMIN.EXT_SOURCES.LOAD")," "),o(2),u("placeholder","ADMIN.EXT_SOURCES.SEARCH"),o(4),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,de,ce,M,Eo,N,H,y],encapsulation:2})}}return t})();function Cs(t,c){t&1&&(d(0),l(1,"translate")),t&2&&f(" ",p(1,1,"USER_DETAIL.DASHBOARD.DIRECT_ROLES")," ")}function bs(t,c){if(t&1){let e=T();r(0,"app-perun-web-apps-roles-page",4),St("currentlyOpenPanelChange",function(i){h(e);let s=_();return bt(s.userBasedOpenPanel,i)||(s.userBasedOpenPanel=i),g(i)}),C("reload",function(){h(e);let i=_();return g(i.getData())})("startLoading",function(){h(e);let i=_();return g(i.outerLoading=!0)}),a()}if(t&2){let e=_();u("outerLoading",e.outerLoading)("roles",e.roles)("entityId",e.userId)("showDescription",e.showDescription)("entityType",e.entityType)("editable",!0),Ct("currentlyOpenPanel",e.userBasedOpenPanel)}}function Ss(t,c){t&1&&(d(0),l(1,"translate")),t&2&&f(" ",p(1,1,"USER_DETAIL.DASHBOARD.AUTHORIZED_GROUP_BASED_ROLES")," ")}function vs(t,c){if(t&1){let e=T();r(0,"app-perun-web-apps-roles-page",5),St("currentlyOpenPanelChange",function(i){h(e);let s=_();return bt(s.groupBasedOpenPanel,i)||(s.groupBasedOpenPanel=i),g(i)}),C("reload",function(){h(e);let i=_();return g(i.getData())})("startLoading",function(){h(e);let i=_();return g(i.outerLoading=!0)}),a()}if(t&2){let e=_();u("outerLoading",e.outerLoading)("roles",e.indirectRoles)("entityId",e.userId)("showDescription",e.showDescription)("entityType",e.entityType)("editable",!1)("complementaryObjectsWithAuthzGroups",e.rolesComplementaryObjectsWithAuthzGroups),Ct("currentlyOpenPanel",e.groupBasedOpenPanel)}}var ia=(()=>{class t{constructor(e,n,i,s){this.authzResolverService=e,this.route=n,this.store=i,this.roleService=s,this.roles=new Map,this.indirectRoles=new Map,this.rolesComplementaryObjectsWithAuthzGroups=new Map,this.showDescription=!0,this.userBasedOpenPanel=null,this.groupBasedOpenPanel=null}ngOnInit(){this.outerLoading=!0,this.route.parent.params.subscribe(e=>{e.userId?(this.entityType="USER",this.userId=Number(e.userId)):(this.userId=this.store.getPerunPrincipal().userId,this.entityType="SELF"),this.getData()})}getData(){this.outerLoading=!0,this.roles.clear(),this.authzResolverService.getUserDirectRoles(this.userId).subscribe({next:e=>{let n=Object.keys(e).map(i=>i.toUpperCase());this.roles=this.roleService.prepareRoles(e,n),this.indirectRoles.clear(),this.authzResolverService.getUserRolesObtainedFromAuthorizedGroupMemberships(this.userId).subscribe({next:i=>{let s=Object.keys(i).map(v=>v.toUpperCase());this.indirectRoles=this.roleService.prepareRoles(i,s),this.rolesComplementaryObjectsWithAuthzGroups.clear(),this.authzResolverService.getRoleComplementaryObjectsWithAuthorizedGroups(this.userId).subscribe({next:v=>{this.rolesComplementaryObjectsWithAuthzGroups=this.roleService.prepareComplementaryObjects(Object.keys(v),v),this.outerLoading=!1},error:()=>this.outerLoading=!1})},error:()=>this.outerLoading=!1})},error:()=>this.outerLoading=!1})}static{this.\u0275fac=function(n){return new(n||t)(m(Ln),m(me),m(Ve),m(Xn))}}static{this.\u0275cmp=D({type:t,selectors:[["app-user-roles"]],hostVars:2,hostBindings:function(n,i){n&2&&Ge("router-component",i.true)},decls:10,vars:3,consts:[[1,"page-subtitle","d-flex"],["mat-stretch-tabs","false"],["matTabLabel",""],["matTabContent",""],[3,"currentlyOpenPanelChange","reload","startLoading","outerLoading","roles","entityId","showDescription","entityType","editable","currentlyOpenPanel"],[3,"currentlyOpenPanelChange","reload","startLoading","outerLoading","roles","entityId","showDescription","entityType","editable","complementaryObjectsWithAuthzGroups","currentlyOpenPanel"]],template:function(n,i){n&1&&(r(0,"h1",0),d(1),l(2,"translate"),a(),r(3,"mat-tab-group",1)(4,"mat-tab"),S(5,Cs,2,3,"ng-template",2)(6,bs,1,7,"ng-template",3),a(),r(7,"mat-tab"),S(8,Ss,2,3,"ng-template",2)(9,vs,1,8,"ng-template",3),a()()),n&2&&(o(),A(p(2,1,"ROLES.TITLE")))},dependencies:[x,Ao,nt,Ze,et,tt,it,M,y],encapsulation:2})}}return t})();function Ts(t,c){t&1&&b(0,"perun-web-apps-loading-dialog")}function Es(t,c){if(t&1){let e=T();r(0,"div")(1,"h1",3),d(2),l(3,"translate"),a(),r(4,"div",4)(5,"mat-form-field",5)(6,"mat-label"),d(7),l(8,"translate"),a(),b(9,"input",6),r(10,"mat-error"),d(11),l(12,"translate"),a()(),r(13,"perun-web-apps-ext-source-search-select",7),C("extSourceSelected",function(i){h(e);let s=_();return g(s.selectedExtSource=i)}),a()(),r(14,"div",8)(15,"button",9),C("click",function(){h(e);let i=_();return g(i.onCancel())}),d(16),l(17,"translate"),a(),r(18,"button",10),C("click",function(){h(e);let i=_();return g(i.onAdd())}),d(19),l(20,"translate"),a()()()}if(t&2){let e=_();o(2),A(p(3,8,"DIALOGS.ADD_USER_EXT_SOURCE.TITLE")),o(5),A(p(8,10,"DIALOGS.ADD_USER_EXT_SOURCE.LOGIN")),o(2),u("formControl",e.loginControl),o(2),f(" ",p(12,12,"DIALOGS.ADD_USER_EXT_SOURCE.EMPTY_LOGIN")," "),o(2),u("extSources",e.extSources),o(3),f(" ",p(17,14,"DIALOGS.ADD_USER_EXT_SOURCE.CANCEL")," "),o(2),u("disabled",e.loginControl.invalid||e.selectedExtSource===null||e.loading),o(),f(" ",p(20,16,"DIALOGS.ADD_USER_EXT_SOURCE.ADD")," ")}}var na=(()=>{class t{constructor(e,n,i,s,v,w){this.dialogRef=e,this.data=n,this.extSourcesManagerService=i,this.usersManagerService=s,this.translate=v,this.notificator=w,this.loginControl=new Lt("",[ge.required,ge.pattern(".*[\\S]+.*")]),this.selectedExtSource=null,this.extSources=[],v.get("DIALOGS.ADD_USER_EXT_SOURCE.SUCCESS").subscribe(q=>this.successMessage=q)}ngOnInit(){this.loading=!0,this.loginControl.markAllAsTouched(),this.extSourcesManagerService.getExtSources().subscribe({next:e=>{this.extSources=e,this.loading=!1},error:()=>this.loading=!1})}onCancel(){this.dialogRef.close(!1)}onAdd(){this.loading=!0;let e={beanName:"",extSource:this.selectedExtSource,id:0,login:this.loginControl.value,userId:this.data.userId};this.usersManagerService.addUserExtSource({user:this.data.userId,userExtSource:e}).subscribe({next:()=>{this.loading=!1,this.notificator.showSuccess(this.successMessage),this.dialogRef.close(!0)},error:()=>this.loading=!1})}static{this.\u0275fac=function(n){return new(n||t)(m(J),m(pe),m(Pi),m(le),m(Y),m(j))}}static{this.\u0275cmp=D({type:t,selectors:[["app-add-user-ext-source-dialog"]],decls:4,vars:2,consts:[["spinner",""],[1,"position-relative"],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container","user-theme"],[1,"center-self","w-100"],["matInput","","required","",3,"formControl"],[3,"extSourceSelected","extSources"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(n,i){if(n&1&&(S(0,Ts,1,0,"ng-template",null,0,B),r(2,"div",1),S(3,Es,21,18,"div",2),a()),n&2){let s=R(1);o(3),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,Ye,Ke,ct,xt,Je,Xe,$e,qe,ze,pt,wi,ie,Z,te,ee,ue,M,So,N,y],styles:[".column-size[_ngcontent-%COMP%]{width:10rem!important;font-weight:700}.center-self[_ngcontent-%COMP%]{margin-top:auto;margin-bottom:auto}.pre-wrap[_ngcontent-%COMP%]{white-space:pre-wrap}"]})}}return t})();function Is(t,c){if(t&1){let e=T();r(0,"button",8),C("click",function(){h(e);let i=_();return g(i.addIdentity())}),d(1),l(2,"translate"),a()}t&2&&(o(),f(" ",p(2,1,"USER_DETAIL.IDENTITIES.ADD")," "))}function As(t,c){if(t&1){let e=T();r(0,"button",9),C("click",function(){h(e);let i=_();return g(i.removeIdentity())}),d(1),l(2,"translate"),a()}if(t&2){let e=_();u("disabled",e.loading||e.selection.selected.length===0),o(),f(" ",p(2,2,"USER_DETAIL.IDENTITIES.REMOVE")," ")}}function Ds(t,c){t&1&&b(0,"perun-web-apps-loading-table")}function xs(t,c){if(t&1&&b(0,"perun-web-apps-user-ext-sources-list",10),t&2){let e=_();u("loading",e.loading)("displayColumns",e.displayedColumns)("filterValue",e.filterValue)("selection",e.selection)("cachedSubject",e.cachedSubject)("userExtSources",e.userExtSources)}}var oa=(()=>{class t{constructor(e,n,i,s,v,w){this.usersManagerService=e,this.storage=n,this.registrarManagerService=i,this.dialog=s,this.route=v,this.authResolver=w,this.userExtSources=[],this.selection=new K(!1,[],!0,(q,_e)=>q.userExtSource.id===_e.userExtSource.id),this.displayedColumns=["select","id","extSourceName","login","lastAccess"],this.filterValue="",this.cachedSubject=new G(!0)}ngOnInit(){this.route.parent.params.subscribe(e=>{this.userId=Number(e.userId)}),this.refreshTable()}refreshTable(){this.loading=!0,this.selection.clear(),this.cachedSubject.next(!0),this.usersManagerService.getRichUserExtSources(this.userId).subscribe({next:e=>{this.userExtSources=e,this.loading=!1},error:()=>{this.loading=!1}})}addIdentity(){let e=V();e.width="1000px",e.data={userId:this.userId},this.dialog.open(na,e).afterClosed().subscribe(i=>{i&&this.refreshTable()})}removeIdentity(){let e=V();e.width="450px",e.data={showSuccess:!0,theme:"user-theme",userId:this.userId,extSources:this.selection.selected},this.dialog.open(Zn,e).afterClosed().subscribe(i=>{i&&this.refreshTable()})}applyFilter(e){this.filterValue=e,this.refreshTable()}static{this.\u0275fac=function(n){return new(n||t)(m(le),m(Ve),m(Gi),m($),m(me),m(re))}}static{this.\u0275cmp=D({type:t,selectors:[["app-user-identities"]],decls:11,vars:8,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","displayColumns","filterValue","selection","cachedSubject","userExtSources",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"loading","displayColumns","filterValue","selection","cachedSubject","userExtSources"]],template:function(n,i){if(n&1){let s=T();r(0,"h1",1),d(1),l(2,"translate"),a(),r(3,"perun-web-apps-refresh-button",2),C("refresh",function(){return h(s),g(i.refreshTable())}),a(),E(4,Is,3,3,"button",3),E(5,As,3,4,"button",4),r(6,"perun-web-apps-debounce-filter",5),C("filter",function(w){return h(s),g(i.applyFilter(w))}),a(),S(7,Ds,1,0,"ng-template",null,0,B),r(9,"div",6),S(10,xs,1,6,"perun-web-apps-user-ext-sources-list",7),a()}if(n&2){let s=R(8);o(),A(p(2,6,"USER_DETAIL.IDENTITIES.TITLE")),o(3),I(i.authResolver.isPerunAdmin()?4:-1),o(),I(i.authResolver.isPerunAdmin()?5:-1),o(),u("placeholder","USER_DETAIL.IDENTITIES.FILTER_PLACEHOLDER"),o(4),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,de,ce,M,ro,N,H,y],encapsulation:2})}}return t})();var Ms=["list"];function ys(t,c){t&1&&b(0,"perun-web-apps-loading-table")}function ws(t,c){if(t&1&&b(0,"perun-web-apps-attributes-list",10,1),t&2){let e=_();u("loading",e.loading)("selection",e.selection)("cachedSubject",e.cachedSubject)("attributes",e.attributes)}}var aa=(()=>{class t{constructor(e,n,i,s){this.dialog=e,this.attributesManager=n,this.userService=i,this.route=s,this.loading=!1,this.selection=new K(!0,[],!0,(v,w)=>v.id===w.id),this.cachedSubject=new G(!0),this.attributes=[]}ngOnInit(){this.route.params.subscribe(e=>{let n=Number(e.identityId);this.userService.getUserExtSourceById(n).subscribe(i=>{this.userExtSource=i,this.refreshTable()})})}refreshTable(){this.loading=!0,this.attributesManager.getUserExtSourceAttributes(this.userExtSource.id).subscribe(e=>{this.attributes=$n(e),this.selection.clear(),this.cachedSubject.next(!0),this.loading=!1})}onAdd(){let e=V();e.width="1050px",e.data={entityId:this.userExtSource.id,entity:"ues",notEmptyAttributes:this.attributes,style:"user-theme"},this.dialog.open(vo,e).afterClosed().subscribe(i=>{i==="saved"&&this.refreshTable()})}onSave(){this.list.updateMapAttributes();let e=V();e.width="450px",e.data={entityId:this.userExtSource.id,entity:"ues",attributes:this.selection.selected},this.dialog.open(eo,e).afterClosed().subscribe(i=>{i&&this.refreshTable()})}onRemove(){let e=V();e.width="450px",e.data={entityId:this.userExtSource.id,entity:"ues",attributes:this.selection.selected},this.dialog.open(To,e).afterClosed().subscribe(i=>{i&&this.refreshTable()})}static{this.\u0275fac=function(n){return new(n||t)(m($),m(ae),m(le),m(me))}}static{this.\u0275cmp=D({type:t,selectors:[["app-identity-detail"]],viewQuery:function(n,i){if(n&1&&ve(Ms,5),n&2){let s;Te(s=Ee())&&(i.list=s.first)}},decls:28,vars:32,consts:[["spinner",""],["list",""],[1,"page-subtitle"],[1,"mb-2"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2",3,"click","disabled"],["color","accent","mat-flat-button","",1,"me-2",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[1,"position-relative","table-min-height"],[3,"loading","selection","cachedSubject","attributes",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","selection","cachedSubject","attributes"]],template:function(n,i){if(n&1){let s=T();r(0,"div")(1,"h1",2),d(2),l(3,"translate"),a(),r(4,"div"),d(5),l(6,"translate"),a(),r(7,"div"),d(8),l(9,"translate"),a(),r(10,"div",3),d(11),l(12,"translate"),l(13,"date"),a(),r(14,"perun-web-apps-refresh-button",4),C("refresh",function(){return h(s),g(i.refreshTable())}),a(),r(15,"button",5),C("click",function(){return h(s),g(i.onSave())}),d(16),l(17,"translate"),a(),r(18,"button",6),C("click",function(){return h(s),g(i.onAdd())}),d(19),l(20,"translate"),a(),r(21,"button",7),C("click",function(){return h(s),g(i.onRemove())}),d(22),l(23,"translate"),a(),S(24,ys,1,0,"ng-template",null,0,B),r(26,"div",8),S(27,ws,2,4,"perun-web-apps-attributes-list",9),a()()}if(n&2){let s=R(25);o(2),rt(" ",p(3,15,"SHARED.IDENTITY_DETAIL.TITLE")," - ",i.userExtSource?i.userExtSource.extSource.name:""," "),o(3),rt(" ",p(6,17,"SHARED.IDENTITY_DETAIL.TYPE"),": ",i.userExtSource?i.userExtSource.extSource.type:""," "),o(3),rt(" ",p(9,19,"SHARED.IDENTITY_DETAIL.LOGIN"),": ",i.userExtSource?i.userExtSource.login:""," "),o(3),rt(" ",p(12,21,"SHARED.IDENTITY_DETAIL.LAST_ACCESS"),": ",i.userExtSource?je(13,23,i.userExtSource.lastAccess,"d.M.y H:mm:ss"):""," "),o(4),u("disabled",i.loading||i.selection.selected.length===0),o(),f(" ",p(17,26,"SHARED.IDENTITY_DETAIL.SAVE")," "),o(3),f(" ",p(20,28,"SHARED.IDENTITY_DETAIL.ADD")," "),o(2),u("disabled",i.loading||i.selection.selected.length===0),o(),f(" ",p(23,30,"SHARED.IDENTITY_DETAIL.REMOVE")," "),o(5),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,ce,M,oo,N,H,In,y],encapsulation:2})}}return t})();var Rs=()=>({color:"black"}),ra=t=>["/admin/services",t];function Ls(t,c){t&1&&b(0,"mat-spinner",1)}function Bs(t,c){if(t&1){let e=T();r(0,"button",16),l(1,"translate"),C("click",function(){h(e);let i=_(2);return g(i.editService())}),r(2,"mat-icon"),d(3,"edit"),a()()}t&2&&u("matTooltip",fe(p(1,2,"SERVICE_DETAIL.EDIT")))}function Os(t,c){if(t&1){let e=T();r(0,"button",17),l(1,"translate"),C("click",function(){h(e);let i=_(2);return g(i.removeService())}),r(2,"mat-icon"),d(3,"delete_forever"),a()()}t&2&&u("matTooltip",fe(p(1,2,"SERVICE_DETAIL.DELETE")))}function Ns(t,c){if(t&1){let e=T();r(0,"button",18),C("click",function(){h(e);let i=_(2);return g(i.evaluateConsents())}),d(1),l(2,"translate"),a()}t&2&&(o(),f(" ",p(2,1,"SERVICE_DETAIL.EVALUATE_CONSENTS")," "))}function Us(t,c){if(t&1){let e=T();r(0,"div",2),b(1,"mat-icon",3),l(2,"translate"),r(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7)(7,"a",8),C("auxclick",function(i){return h(e),g(i.preventDefault())}),d(8),a(),r(9,"span",9),d(10),a(),E(11,Bs,4,4,"button",10),E(12,Os,4,4,"button",11),a(),r(13,"span",12),d(14),l(15,"translate"),a()()(),r(16,"div",13)(17,"mat-slide-toggle",14),C("toggleChange",function(){h(e);let i=_();return g(i.changeServiceStatus())}),d(18),l(19,"translate"),a(),r(20,"mat-slide-toggle",14),C("toggleChange",function(){h(e);let i=_();return g(i.groupPropagationChange())}),d(21),l(22,"translate"),a(),r(23,"mat-slide-toggle",14),C("toggleChange",function(){h(e);let i=_();return g(i.voPropagationChange())}),d(24),l(25,"translate"),a(),r(26,"mat-slide-toggle",14),C("toggleChange",function(){h(e);let i=_();return g(i.bannedPropagationChange())}),d(27),l(28,"translate"),a(),E(29,Ns,3,3,"button",15),a()()()}if(t&2){let e=_();o(),u("matTooltip",fe(p(2,20,"SERVICE_DETAIL.ENTITY")))("ngStyle",he(32,Rs)),o(6),u("perunWebAppsMiddleClickRouterLink",De(33,ra,e.service.id.toString()))("routerLink",De(35,ra,e.service.id)),o(),f(" ",e.service.name," "),o(2),f(" \xA0 #",e.service.id," "),o(),I(e.authResolver.isPerunAdmin()?11:-1),o(),I(e.authResolver.isPerunAdmin()?12:-1),o(2),rt(" ",p(15,22,"SERVICE_DETAIL.DESCRIPTION"),": ",e.service.description," "),o(3),u("checked",e.service.enabled),o(),f(" ",p(19,24,"SERVICE_DETAIL.ENABLE")," "),o(2),u("checked",e.service.useExpiredMembers),o(),f(" ",p(22,26,"SERVICE_DETAIL.PROPAGATE_GROUP")," "),o(2),u("checked",e.service.useExpiredVoMembers),o(),f(" ",p(25,28,"SERVICE_DETAIL.PROPAGATE_VO")," "),o(2),u("checked",e.service.useBannedMembers),o(),f(" ",p(28,30,"SERVICE_DETAIL.PROPAGATE_BANNED")," "),o(2),I(e.authResolver.isPerunAdmin()?29:-1)}}var la=(()=>{class t{constructor(e,n,i,s,v,w,q,_e,Se,mi,ya){this.route=e,this.router=n,this.consentsManager=i,this.serviceManager=s,this.sideMenuService=v,this.sideMenuItemService=w,this.dialog=q,this.authResolver=_e,this.translate=Se,this.notificator=mi,this.entityStorageService=ya,this.loading=!1}ngOnInit(){this.loading=!0,this.route.params.subscribe(e=>{this.serviceId=Number(e.serviceId),this.entityStorageService.setEntityAndPathParam({id:this.serviceId,beanName:"Service"},Hi.Service),this.refresh()})}editService(){let e=V();e.width="600px",e.data={theme:"service-theme",service:this.service},this.dialog.open(Ro,e).afterClosed().subscribe(i=>{i&&this.refresh()})}removeService(){let e=V();e.width="600px",e.data={theme:"service-theme",services:[this.service]},this.dialog.open(Lo,e).afterClosed().subscribe(i=>{i&&this.router.navigate(["/admin/services"],{queryParamsHandling:"preserve"})})}changeServiceStatus(){this.service.enabled=!this.service.enabled,this.serviceManager.updateService({service:this.service}).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("SERVICE_DETAIL.STATUS_CHANGE_SUCCESS"))},()=>this.service.enabled=!this.service.enabled)}groupPropagationChange(){this.service.useExpiredMembers=!this.service.useExpiredMembers,this.serviceManager.updateService({service:this.service}).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("SERVICE_DETAIL.PROPAGATION_CHANGE_SUCCESS"))},error:()=>this.service.useExpiredMembers=!this.service.useExpiredMembers})}voPropagationChange(){this.service.useExpiredVoMembers=!this.service.useExpiredVoMembers,this.serviceManager.updateService({service:this.service}).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("SERVICE_DETAIL.PROPAGATION_CHANGE_SUCCESS"))},error:()=>this.service.useExpiredVoMembers=!this.service.useExpiredVoMembers})}bannedPropagationChange(){this.service.useBannedMembers=!this.service.useBannedMembers,this.serviceManager.updateService({service:this.service}).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("SERVICE_DETAIL.PROPAGATION_CHANGE_SUCCESS_BANNED"))},error:()=>this.service.useBannedMembers=!this.service.useBannedMembers})}evaluateConsents(){let e=V();e.width="500px",e.data={title:this.translate.instant("SERVICE_DETAIL.CONFIRM_DIALOG_TITLE"),theme:"service-theme",description:this.translate.instant("SERVICE_DETAIL.CONFIRM_DIALOG_DESCRIPTION"),items:[this.service.name],type:"confirmation",showAsk:!1},this.dialog.open(Yi,e).afterClosed().subscribe(i=>{i&&this.consentsManager.evaluateConsentsForService(this.service.id).subscribe(()=>this.notificator.showSuccess(this.translate.instant("SERVICE_DETAIL.EVALUATION_FINISH")))})}refresh(){this.serviceManager.getServiceById(this.serviceId).subscribe(e=>{this.service=e;let n=this.sideMenuItemService.parseService(this.service);this.sideMenuService.setAdminItems([n]),this.loading=!1},()=>this.loading=!1)}static{this.\u0275fac=function(n){return new(n||t)(m(me),m(Oi),m(Mt),m(_t),m(si),m(en),m($),m(re),m(Y),m(j),m(ke))}}static{this.\u0275cmp=D({type:t,selectors:[["app-service-detail-page"]],decls:5,vars:2,consts:[[1,"container-fluid","ps-xl-5","pe-xl-5","service-theme"],[1,"ms-auto","me-auto"],[1,"page-title-headtitle","detail-layout"],["svgIcon","perun-service",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"wrap-container"],[1,"detail-info"],[1,"flex-column"],[1,"page-title-headline","d-flex","align-items-center"],["data-cy","service-name-link",1,"service-link",3,"auxclick","perunWebAppsMiddleClickRouterLink","routerLink"],[1,"text-muted"],["aria-label","Edit service","data-cy","service-edit-button","mat-icon-button","",3,"matTooltip"],["aria-label","Remove service","mat-icon-button","",3,"matTooltip"],[1,"mt-1","entity-info"],[1,"detail-actions"],["labelPosition","before",1,"mb-25",3,"toggleChange","checked"],["mat-stroked-button","",1,"action-button","evaluate-button"],["aria-label","Edit service","data-cy","service-edit-button","mat-icon-button","",3,"click","matTooltip"],["aria-label","Remove service","mat-icon-button","",3,"click","matTooltip"],["mat-stroked-button","",1,"action-button","evaluate-button",3,"click"]],template:function(n,i){n&1&&(r(0,"div",0),b(1,"perun-web-apps-back-button"),E(2,Ls,1,0,"mat-spinner",1),E(3,Us,30,37,"div",2),b(4,"app-animated-router-outlet"),a()),n&2&&(o(2),I(i.loading?2:-1),o(),I(i.loading?-1:3))},dependencies:[x,Pt,L,O,Ni,Qe,ut,Yt,Kt,Vi,ri,oi,ki,li,qt,Wt,mt,dt,M,We,y],styles:[".detail-layout[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:1.2em}.detail-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-right:1.2em}.wrap-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;gap:.3em}.detail-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-left:1px solid rgba(0,0,0,.2);padding-left:.5em}.evaluate-button[_ngcontent-%COMP%]{width:fit-content}"],data:{animation:[co]}})}}return t})();var pa=(()=>{class t{constructor(e){this.entityStorageService=e,this.navItems=[]}ngOnInit(){this.service=this.entityStorageService.getEntity(),this.initNavItems()}initNavItems(){this.navItems=[{cssIcon:"perun-attributes",url:`/admin/services/${this.service.id}/required-attributes`,label:"MENU_ITEMS.SERVICE.REQUIRED_ATTRIBUTES",style:"service-btn"},{cssIcon:"perun-service_destination",url:`/admin/services/${this.service.id}/destinations`,label:"MENU_ITEMS.SERVICE.DESTINATIONS",style:"service-btn"}]}static{this.\u0275fac=function(n){return new(n||t)(m(ke))}}static{this.\u0275cmp=D({type:t,selectors:[["app-service-overview"]],decls:1,vars:1,consts:[[3,"items"]],template:function(n,i){n&1&&b(0,"perun-web-apps-menu-buttons-field",0),n&2&&u("items",i.navItems)},dependencies:[x,ai],encapsulation:2})}}return t})();function Vs(t,c){t&1&&b(0,"perun-web-apps-loading-dialog")}function ks(t,c){t&1&&(r(0,"perun-web-apps-alert",4),d(1),l(2,"translate"),a()),t&2&&(u("alert_type","warn"),o(),A(p(2,2,"DIALOGS.ADD_REQUIRED_ATTRIBUTES.ACTIVE_WARN")))}function Ps(t,c){if(t&1){let e=T();r(0,"div")(1,"h1",2),d(2),l(3,"translate"),a(),r(4,"div",3),E(5,ks,3,4,"perun-web-apps-alert",4),l(6,"async"),r(7,"perun-web-apps-debounce-filter",5),C("filter",function(i){h(e);let s=_();return g(s.applyFilter(i))}),a(),b(8,"app-attr-def-list",6),l(9,"async"),l(10,"async"),a(),r(11,"div",7)(12,"button",8),C("click",function(){h(e);let i=_();return g(i.onCancel())}),d(13),l(14,"translate"),a(),r(15,"button",9),C("click",function(){h(e);let i=_();return g(i.onAdd())}),d(16),l(17,"translate"),a()()()}if(t&2){let e=_();o(2),A(p(3,13,"DIALOGS.ADD_REQUIRED_ATTRIBUTES.TITLE")),o(3),I(p(6,15,e.serviceEnabled$)?5:-1),o(2),u("placeholder","DIALOGS.ADD_REQUIRED_ATTRIBUTES.FILTER"),o(),u("selection",e.selection)("definitions",e.attrDefinitions)("disableRouting",!0)("filterValue",e.filterValue)("serviceEnabled",p(9,17,e.serviceEnabled$))("consentRequired",p(10,19,e.consentRequired$))("loading",e.loading),o(5),f(" ",p(14,21,"DIALOGS.ADD_REQUIRED_ATTRIBUTES.CANCEL")," "),o(2),u("disabled",e.selection.selected.length===0),o(),f(" ",p(17,23,"DIALOGS.ADD_REQUIRED_ATTRIBUTES.ADD")," ")}}var ca=(()=>{class t{constructor(e,n,i,s,v,w,q,_e){this.dialogRef=e,this.data=n,this.serviceManager=i,this.attributesManager=s,this.facilitiesService=v,this.consentHubService=w,this.notificator=q,this.translate=_e,this.consentRequired$=this.facilitiesService.getAssignedFacilitiesByService(this.data.serviceId).pipe(gn(_n),ht(Se=>Se.id),bn(),fn(Se=>this.consentHubService.getConsentHubByFacility(Se)),hn((Se,mi)=>Se||mi.enforceConsents,!1),at(!0)),this.serviceEnabled$=this.serviceManager.getServiceById(this.data.serviceId).pipe(ht(Se=>Se.enabled),at(!0)),this.attrDefinitions=[],this.selection=new K(!0,[]),this.filterValue="",this.loading=!1}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.serviceId=this.data.serviceId,this.attributesManager.getAllAttributeDefinitions().subscribe(e=>{this.attrDefinitions=e,this.loading=!1})}onAdd(){this.loading=!0;let e=this.selection.selected.map(n=>n.id);this.serviceManager.addRequiredAttributes(this.serviceId,e).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.ADD_REQUIRED_ATTRIBUTES.SUCCESS")),this.dialogRef.close(!0),this.loading=!1},()=>this.loading=!1)}onCancel(){this.dialogRef.close(!1)}applyFilter(e){this.filterValue=e}static{this.\u0275fac=function(n){return new(n||t)(m(J),m(pe),m(_t),m(ae),m($t),m(Mt),m(j),m(Y))}}static{this.\u0275cmp=D({type:t,selectors:[["app-add-required-attributes"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],[3,"alert_type"],[3,"filter","placeholder"],[3,"selection","definitions","disableRouting","filterValue","serviceEnabled","consentRequired","loading"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","mat-flat-button","",1,"ms-2",3,"click","disabled"]],template:function(n,i){if(n&1&&(S(0,Vs,1,0,"ng-template",null,0,B),r(2,"div"),S(3,Ps,18,25,"div",1),a()),n&2){let s=R(1);o(2),Pe(Ie("",i.theme," position-relative")),o(),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,ie,Z,te,ee,X,Q,ue,de,M,di,N,He,y],encapsulation:2})}}return t})();function Fs(t,c){t&1&&b(0,"perun-web-apps-loading-dialog")}function Gs(t,c){t&1&&b(0,"th",14)}function js(t,c){if(t&1&&(r(0,"td",15),d(1),a()),t&2){let e=c.$implicit;o(),A(e.friendlyName)}}function Hs(t,c){t&1&&b(0,"tr",16)}function Ws(t,c){t&1&&b(0,"tr",17)}function qs(t,c){if(t&1){let e=T();r(0,"div")(1,"h1",2),d(2),l(3,"translate"),a(),r(4,"div",3)(5,"p"),d(6),l(7,"translate"),a(),r(8,"div",4),d(9),l(10,"translate"),a(),r(11,"table",5),k(12,6),S(13,Gs,1,0,"th",7)(14,js,2,1,"td",8),P(),S(15,Hs,1,0,"tr",9)(16,Ws,1,0,"tr",10),a()(),r(17,"div",11)(18,"button",12),C("click",function(){h(e);let i=_();return g(i.onCancel())}),d(19),l(20,"translate"),a(),r(21,"button",13),C("click",function(){h(e);let i=_();return g(i.onConfirm())}),d(22),l(23,"translate"),a()()()}if(t&2){let e=_();o(2),A(p(3,9,"DIALOGS.REMOVE_REQUIRED_ATTRIBUTES.TITLE")),o(4),A(p(7,11,"DIALOGS.REMOVE_REQUIRED_ATTRIBUTES.DESCRIPTION")),o(3),f(" ",p(10,13,"DIALOGS.REMOVE_REQUIRED_ATTRIBUTES.ASK")," "),o(2),u("dataSource",e.dataSource),o(4),u("matHeaderRowDef",e.displayedColumns),o(),u("matRowDefColumns",e.displayedColumns),o(3),f(" ",p(20,15,"DIALOGS.REMOVE_REQUIRED_ATTRIBUTES.CANCEL")," "),o(2),u("disabled",e.loading),o(),f(" ",p(23,17,"DIALOGS.REMOVE_REQUIRED_ATTRIBUTES.REMOVE")," ")}}var da=(()=>{class t{constructor(e,n,i,s,v){this.dialogRef=e,this.data=n,this.serviceManager=i,this.notificator=s,this.translate=v,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.serviceId=this.data.serviceId,this.dataSource=new Ae(this.data.attrDefinitions)}onConfirm(){this.loading=!0;let e=this.dataSource.data.map(n=>n.id);this.serviceManager.removeRequiredAttributes(this.serviceId,e).subscribe(()=>{this.notificator.showSuccess(this.translate.instant("DIALOGS.REMOVE_REQUIRED_ATTRIBUTES.SUCCESS")),this.dialogRef.close(!0),this.loading=!1},()=>this.loading=!1)}onCancel(){this.dialogRef.close(!1)}static{this.\u0275fac=function(n){return new(n||t)(m(J),m(pe),m(_t),m(j),m(Y))}}static{this.\u0275cmp=D({type:t,selectors:[["app-remove-required-attributes"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","",1,"ms-2",3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(n,i){if(n&1&&(S(0,Fs,1,0,"ng-template",null,0,B),r(2,"div"),S(3,qs,24,19,"div",1),a()),n&2){let s=R(1);o(2),Pe(Ie("",i.theme," position-relative")),o(),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,ie,Z,te,ee,ue,Ce,xe,ye,Be,we,Me,Oe,Re,Le,Ne,Ue,M,N,y],encapsulation:2})}}return t})();function zs(t,c){if(t&1){let e=T();r(0,"button",8),C("click",function(){h(e);let i=_();return g(i.onAdd())}),d(1),l(2,"translate"),a()}t&2&&(o(),f(" ",p(2,1,"SERVICE_DETAIL.REQUIRED_ATTRIBUTES.ADD")," "))}function $s(t,c){if(t&1){let e=T();r(0,"button",9),C("click",function(){h(e);let i=_();return g(i.onRemove())}),d(1),l(2,"translate"),a()}if(t&2){let e=_();u("disabled",e.loading||e.selection.selected.length===0),o(),f(" ",p(2,2,"SERVICE_DETAIL.REQUIRED_ATTRIBUTES.REMOVE")," ")}}function Ks(t,c){t&1&&b(0,"perun-web-apps-loading-table")}function Ys(t,c){if(t&1){let e=T();r(0,"app-attr-def-list",10),C("refreshEvent",function(){h(e);let i=_();return g(i.refreshTable())}),a()}if(t&2){let e=_();u("loading",e.loading)("definitions",e.attrDefinitions)("filterValue",e.filterValue)("selection",e.selection)("cachedSubject",e.cachedSubject)("disableRouting",!e.authResolver.isPerunAdmin())}}var ma=(()=>{class t{constructor(e,n,i,s){this.attributeManager=e,this.dialog=n,this.authResolver=i,this.entityStorageService=s,this.loading=!1,this.filterValue="",this.selection=new K(!0,[],!0,(v,w)=>v.id===w.id),this.cachedSubject=new G(!0),this.attrDefinitions=[]}ngOnInit(){this.loading=!0,this.service=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.attributeManager.getRequiredAttributesDefinition(this.service.id).subscribe(e=>{this.selection.clear(),this.cachedSubject.next(!0),this.attrDefinitions=e,this.loading=!1})}onAdd(){let e=V();e.width="950px",e.data={serviceId:this.service.id,theme:"service-theme"},this.dialog.open(ca,e).afterClosed().subscribe(i=>{i&&this.refreshTable()})}onRemove(){let e=V();e.width="650px",e.data={serviceId:this.service.id,attrDefinitions:this.selection.selected,theme:"service-theme"},this.dialog.open(da,e).afterClosed().subscribe(i=>{i&&this.refreshTable()})}applyFilter(e){this.filterValue=e,this.refreshTable()}static{this.\u0275fac=function(n){return new(n||t)(m(ae),m($),m(re),m(ke))}}static{this.\u0275cmp=D({type:t,selectors:[["app-service-required-attributes"]],decls:12,vars:8,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",1,"me-2","action-button"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","definitions","filterValue","selection","cachedSubject","disableRouting","refreshEvent",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"refreshEvent","loading","definitions","filterValue","selection","cachedSubject","disableRouting"]],template:function(n,i){if(n&1){let s=T();r(0,"div")(1,"h1",1),d(2),l(3,"translate"),a(),r(4,"perun-web-apps-refresh-button",2),C("refresh",function(){return h(s),g(i.refreshTable())}),a(),E(5,zs,3,3,"button",3),E(6,$s,3,4,"button",4),r(7,"perun-web-apps-debounce-filter",5),C("filter",function(w){return h(s),g(i.applyFilter(w))}),a(),S(8,Ks,1,0,"ng-template",null,0,B),r(10,"div",6),S(11,Ys,1,6,"app-attr-def-list",7),a()()}if(n&2){let s=R(9);o(2),A(p(3,6,"SERVICE_DETAIL.REQUIRED_ATTRIBUTES.TITLE")),o(3),I(i.authResolver.isPerunAdmin()?5:-1),o(),I(i.authResolver.isPerunAdmin()?6:-1),o(),u("placeholder","SERVICE_DETAIL.REQUIRED_ATTRIBUTES.FILTER"),o(4),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,de,ce,M,di,N,H,y],encapsulation:2})}}return t})();var Qs=()=>["select","destinationId","facility","destination","type","status","propagationType"];function Xs(t,c){if(t&1){let e=T();r(0,"button",8),C("click",function(){h(e);let i=_();return g(i.onRemove())}),d(1),l(2,"translate"),a()}if(t&2){let e=_();u("disabled",e.loading||e.selection.selected.length===0),o(),f(" ",p(2,2,"SERVICE_DETAIL.DESTINATIONS.REMOVE")," ")}}function Js(t,c){if(t&1){let e=T();r(0,"button",9),C("click",function(){h(e);let i=_();return g(i.onAllow())}),d(1),l(2,"translate"),a()}if(t&2){let e=_();u("disabled",e.loading||e.selection.selected.length===0),o(),f(" ",p(2,2,"SERVICE_DETAIL.DESTINATIONS.ALLOW")," ")}}function Zs(t,c){if(t&1){let e=T();r(0,"button",8),C("click",function(){h(e);let i=_();return g(i.onBlock())}),d(1),l(2,"translate"),a()}if(t&2){let e=_();u("disabled",e.loading||e.selection.selected.length===0),o(),f(" ",p(2,2,"SERVICE_DETAIL.DESTINATIONS.BLOCK")," ")}}function el(t,c){t&1&&b(0,"perun-web-apps-loading-table")}function tl(t,c){if(t&1&&b(0,"app-perun-web-apps-destination-list",10),t&2){let e=_();u("loading",e.loading)("destinations",e.destinations)("filterValue",e.filterValue)("selection",e.selection)("cachedSubject",e.cachedSubject)("displayColumns",he(6,Qs))}}var ua=(()=>{class t{constructor(e,n,i,s,v,w){this.serviceManager=e,this.notificator=n,this.translate=i,this.dialog=s,this.authResolver=v,this.entityStorageService=w,this.loading=!1,this.filterValue="",this.destinations=[],this.selection=new K(!0,[],!0,(q,_e)=>q.id===_e.id),this.cachedSubject=new G(!0)}ngOnInit(){this.loading=!0,this.service=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.serviceManager.getAllRichDestinationsForService(this.service.id).subscribe(e=>{this.selection.clear(),this.cachedSubject.next(!0),this.filterValue="",this.destinations=e,this.loading=!1})}onBlock(){this.loading=!0,this.blockServiceOnDestinations(this.selection.selected)}onAllow(){this.loading=!0,this.allowServiceOnDestinations(this.selection.selected)}onRemove(){let e=V();e.width="500px",e.data={destinations:this.selection.selected,theme:"admin-theme"},this.dialog.open(Uo,e).afterClosed().subscribe(i=>{i&&this.refreshTable()})}applyFilter(e){this.filterValue=e,this.refreshTable()}blockServiceOnDestinations(e){this.serviceManager.blockServicesOnDestinations({richDestinations:e}).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("SERVICE_DETAIL.DESTINATIONS.BLOCK_SUCCESS")),this.refreshTable()},error:()=>this.loading=!1})}allowServiceOnDestinations(e){this.serviceManager.unblockServicesOnDestinations({richDestinations:e}).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("SERVICE_DETAIL.DESTINATIONS.ALLOW_SUCCESS")),this.refreshTable()},error:()=>this.loading=!1})}static{this.\u0275fac=function(n){return new(n||t)(m(_t),m(j),m(zt),m($),m(re),m(ke))}}static{this.\u0275cmp=D({type:t,selectors:[["app-service-destinations"]],decls:13,vars:9,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["color","warn","mat-flat-button","",1,"me-2",3,"disabled"],["color","accent","mat-flat-button","",1,"me-2",3,"disabled"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","destinations","filterValue","selection","cachedSubject","displayColumns",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","warn","mat-flat-button","",1,"me-2",3,"click","disabled"],["color","accent","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"loading","destinations","filterValue","selection","cachedSubject","displayColumns"]],template:function(n,i){if(n&1){let s=T();r(0,"div")(1,"h1",1),d(2),l(3,"translate"),a(),r(4,"perun-web-apps-refresh-button",2),C("refresh",function(){return h(s),g(i.refreshTable())}),a(),E(5,Xs,3,4,"button",3),E(6,Js,3,4,"button",4),E(7,Zs,3,4,"button",3),r(8,"perun-web-apps-debounce-filter",5),C("filter",function(w){return h(s),g(i.applyFilter(w))}),a(),S(9,el,1,0,"ng-template",null,0,B),r(11,"div",6),S(12,tl,1,7,"app-perun-web-apps-destination-list",7),a()()}if(n&2){let s=R(10);o(2),A(p(3,7,"SERVICE_DETAIL.DESTINATIONS.TITLE")),o(3),I(i.authResolver.isPerunAdmin()?5:-1),o(),I(i.authResolver.isPerunAdmin()?6:-1),o(),I(i.authResolver.isPerunAdmin()?7:-1),o(),u("placeholder","SERVICE_DETAIL.DESTINATIONS.FILTER"),o(4),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,de,ce,M,No,N,H,y],encapsulation:2})}}return t})();var _a=(t,c)=>["/organizations",t,"members",c],il=()=>["id","recent","name","description","expiration","groupStatus"];function nl(t,c){t&1&&b(0,"perun-web-apps-loading-table")}function ol(t,c){if(t&1){let e=T();r(0,"perun-web-apps-vo-search-select",7),C("voSelected",function(i){h(e);let s=_(2);return g(s.loadMember(i))}),a()}if(t&2){let e=_(2);u("vos",e.vos)}}function al(t,c){t&1&&(d(0),l(1,"translate")),t&2&&f(" ",p(1,1,"USER_DETAIL.ACCOUNTS.STATUS")," ")}function rl(t,c){t&1&&b(0,"mat-spinner",10)}function sl(t,c){if(t&1){let e=T();r(0,"div")(1,"div",11)(2,"span",12),d(3),l(4,"translate"),a(),r(5,"a",13),C("auxclick",function(i){return h(e),g(i.preventDefault())}),d(6),a()(),r(7,"mat-card",14),b(8,"perun-web-apps-member-overview-membership",15),a(),r(9,"p",16),d(10),l(11,"translate"),a(),r(12,"perun-web-apps-groups-list",17),C("refreshTable",function(){h(e);let i=_(4);return g(i.loadMember(i.selectedVo))}),a()()}if(t&2){let e=_(4);o(3),f("",p(4,12,"USER_DETAIL.ACCOUNTS.MEMBER"),":"),o(2),u("perunWebAppsMiddleClickRouterLink",ln(16,_a,e.selectedVo.id.toString(),e.member.id.toString()))("routerLink",ln(19,_a,e.selectedVo.id,e.member.id)),o(),f("",e.member.id," "),o(2),u("member",e.member)("voId",e.selectedVo.id),o(2),A(p(11,14,"USER_DETAIL.ACCOUNTS.GROUPS")),o(2),u("loading",e.loading)("groups",e.groups)("memberId",e.member==null?null:e.member.id)("memberGroupStatus",e.member.groupStatus)("displayColumns",he(22,il))}}function ll(t,c){if(t&1&&(E(0,rl,1,0,"mat-spinner",10),E(1,sl,13,23,"div")),t&2){let e=_(3);I(e.loading?0:-1),o(),I(e.loading?-1:1)}}function pl(t,c){t&1&&(d(0),l(1,"translate")),t&2&&f(" ",p(1,1,"USER_DETAIL.ACCOUNTS.MEMBER_ATT")," ")}function cl(t,c){t&1&&b(0,"mat-spinner",10)}function dl(t,c){if(t&1&&b(0,"app-one-entity-attribute-page",18),t&2){let e=_(5);u("entity","member")("entityId",e.member.id)}}function ml(t,c){if(t&1&&(E(0,cl,1,0,"mat-spinner",10),E(1,dl,1,2,"app-one-entity-attribute-page",18)),t&2){let e=_(4);I(e.loading?0:-1),o(),I(e.loading?-1:1)}}function ul(t,c){t&1&&(r(0,"mat-tab"),S(1,pl,2,3,"ng-template",8)(2,ml,2,2,"ng-template",9),a())}function _l(t,c){t&1&&(d(0),l(1,"translate")),t&2&&f(" ",p(1,1,"USER_DETAIL.ACCOUNTS.MEMBER_GROUP_ATT")," ")}function fl(t,c){t&1&&b(0,"mat-spinner",10)}function hl(t,c){if(t&1&&b(0,"app-two-entity-attribute-page",19),t&2){let e=_(5);u("firstEntity","member")("firstEntityId",e.member.id)("secondEntity","group")}}function gl(t,c){if(t&1&&(E(0,fl,1,0,"mat-spinner",10),E(1,hl,1,3,"app-two-entity-attribute-page",19)),t&2){let e=_(4);I(e.loading?0:-1),o(),I(e.loading?-1:1)}}function Cl(t,c){t&1&&(r(0,"mat-tab"),S(1,_l,2,3,"ng-template",8)(2,gl,2,2,"ng-template",9),a())}function bl(t,c){t&1&&(d(0),l(1,"translate")),t&2&&f(" ",p(1,1,"USER_DETAIL.ACCOUNTS.MEMBER_RESOURCE_ATT")," ")}function Sl(t,c){t&1&&b(0,"mat-spinner",10)}function vl(t,c){if(t&1&&b(0,"app-two-entity-attribute-page",19),t&2){let e=_(4);u("firstEntity","member")("firstEntityId",e.member.id)("secondEntity","resource")}}function Tl(t,c){if(t&1&&(E(0,Sl,1,0,"mat-spinner",10),E(1,vl,1,3,"app-two-entity-attribute-page",19)),t&2){let e=_(3);I(e.loading?0:-1),o(),I(e.loading?-1:1)}}function El(t,c){if(t&1&&(r(0,"mat-tab-group",5)(1,"mat-tab"),S(2,al,2,3,"ng-template",8)(3,ll,2,2,"ng-template",9),a(),S(4,ul,3,0,"mat-tab",2)(5,Cl,3,0,"mat-tab",2),r(6,"mat-tab"),S(7,bl,2,3,"ng-template",8)(8,Tl,2,2,"ng-template",9),a()()),t&2){let e=_(2),n=R(4);o(4),u("perunWebAppsLoader",e.loading)("perunWebAppsLoaderIndicator",n),o(),u("perunWebAppsLoader",e.loading)("perunWebAppsLoaderIndicator",n)}}function Il(t,c){t&1&&(r(0,"perun-web-apps-alert",6),d(1),l(2,"translate"),a()),t&2&&(o(),A(p(2,1,"USER_DETAIL.ACCOUNTS.NO_VOS")))}function Al(t,c){if(t&1&&(r(0,"div")(1,"div",3),E(2,ol,1,1,"perun-web-apps-vo-search-select",4),a(),E(3,El,9,4,"mat-tab-group",5),E(4,Il,3,3,"perun-web-apps-alert",6),a()),t&2){let e=_();o(2),I(e.initLoading||e.vos.length===0?-1:2),o(),I(e.initLoading||e.vos.length===0?-1:3),o(),I(!e.initLoading&&e.vos.length===0?4:-1)}}var fa=(()=>{class t{constructor(e,n,i,s){this.route=e,this.usersService=n,this.membersService=i,this.groupService=s,this.initLoading=!1,this.loading=!1,this.vos=[],this.selectedVo=null,this.member=null,this.groups=[]}ngOnInit(){this.initLoading=!0,this.route.parent.params.subscribe(e=>{this.userId=Number(e.userId),this.usersService.getVosWhereUserIsMember(this.userId).subscribe({next:n=>{this.vos=n,this.vos.length&&this.loadMember(this.vos.sort(qi)[0]),this.initLoading=!1},error:()=>this.initLoading=!1})})}loadMember(e){this.loading=!0,this.selectedVo=e,this.membersService.getMemberByUser(this.selectedVo.id,this.userId).subscribe({next:n=>{this.membersService.getRichMemberWithAttributes(n.id).subscribe({next:i=>{this.member=i,this.groupService.getMemberRichGroupsWithAttributesByNames(this.member.id,[pn.MEMBER_DEF_GROUP_EXPIRATION,pn.MEMBER_GROUP_STATUS]).subscribe({next:s=>{this.groups=s,this.loading=!1},error:()=>this.loading=!1})},error:()=>this.loading=!1})},error:()=>this.loading=!1})}static{this.\u0275fac=function(n){return new(n||t)(m(me),m(le),m(Bn),m(Fi))}}static{this.\u0275cmp=D({type:t,selectors:[["app-perun-web-apps-user-accounts"]],decls:6,vars:5,consts:[["spinner1",""],[1,"page-title"],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[1,"d-flex"],[1,"w-50",3,"vos"],["mat-stretch-tabs","false"],["alert_type","warn"],[1,"w-50",3,"voSelected","vos"],["matTabLabel",""],["matTabContent",""],[1,"ms-auto","me-auto"],[1,"mt-4","mb-4"],[1,"subtitle","me-2"],[1,"member-link",3,"auxclick","perunWebAppsMiddleClickRouterLink","routerLink"],["appearance","outlined",1,"mat-elevation-z3","membership-card"],[3,"member","voId"],[1,"mt-4","subtitle"],[3,"refreshTable","loading","groups","memberId","memberGroupStatus","displayColumns"],[3,"entity","entityId"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(n,i){if(n&1&&(r(0,"h1",1),d(1),l(2,"translate"),a(),S(3,nl,1,0,"ng-template",null,0,B)(5,Al,5,3,"div",2)),n&2){let s=R(4);o(),A(p(2,3,"USER_DETAIL.ACCOUNTS.TITLE")),o(4),u("perunWebAppsLoader",i.initLoading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,X,Q,Vi,tn,pi,nt,Ze,et,tt,it,qt,Wt,Wi,Vn,mt,dt,M,no,po,so,N,H,y],styles:[".subtitle[_ngcontent-%COMP%]{font-size:1.2rem}.membership-card[_ngcontent-%COMP%]{max-width:400px}"]})}}return t})();var sn=(()=>{class t{transform(e){if(e)return e.split(".").pop()}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275pipe=Et({name:"parseEventName",type:t,pure:!0})}}return t})();function Dl(t,c){t&1&&(d(0),l(1,"translate")),t&2&&f(" ",p(1,1,"DIALOGS.AUDIT_MESSAGE_DETAIL.OBJECTS")," ")}function xl(t,c){if(t&1&&b(0,"pre",10),t&2){let e=_();u("innerHTML",e.syntaxHighlight(e.eventData),Sn)}}function Ml(t,c){t&1&&(d(0),l(1,"translate")),t&2&&f(" ",p(1,1,"DIALOGS.AUDIT_MESSAGE_DETAIL.MESSAGE")," ")}function yl(t,c){if(t&1&&(r(0,"div",11),d(1),a()),t&2){let e=_();o(),A(e.message)}}var ha=(()=>{class t{constructor(e,n,i){this.dialogRef=e,this.data=n,this.clipboard=i,this.tabIndex=0,this.eventData={}}ngOnInit(){let e=this.data.message.event;this.actor=this.data.message.actor,this.createdAt=this.data.message.createdAt,e.message&&(this.message=e.message,delete e.message),e.name&&(this.title=e.name,delete e.name),this.eventData=e}tabChanged(e){this.tabIndex=e.index}copyObjects(){this.clipboard.copy(JSON.stringify(this.eventData,null,2))}copyMessage(){this.clipboard.copy(this.message)}syntaxHighlight(e){return typeof e!="string"&&(e=JSON.stringify(e,void 0,2)),e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),e.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?)/g,function(n){let i="number";return n.startsWith('"')?n.endsWith(":")?i="key":i="string":/true|false/.test(n)?i="boolean":n.includes("null")&&(i="null"),'<span class="'+i+'">'+n+"</span>"})}onClose(){this.dialogRef.close()}static{this.\u0275fac=function(n){return new(n||t)(m(J),m(pe),m(Ki))}}static{this.\u0275cmp=D({type:t,selectors:[["app-audit-message-detail-dialog"]],decls:26,vars:19,consts:[[1,"admin-theme"],["mat-dialog-title",""],["mat-dialog-content",""],["mat-stretch-tabs","false",3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["mat-button","",3,"click"],["iconPositionEnd",""],[3,"innerHTML"],["data-cy","audit-message-text"]],template:function(n,i){n&1&&(r(0,"div",0)(1,"h1",1),d(2),l(3,"parseEventName"),l(4,"translate"),a(),r(5,"div",2)(6,"div"),d(7),l(8,"translate"),l(9,"translate"),a(),r(10,"mat-tab-group",3),C("selectedTabChange",function(v){return i.tabChanged(v)}),r(11,"mat-tab"),S(12,Dl,2,3,"ng-template",4)(13,xl,1,1,"ng-template",5),a(),r(14,"mat-tab"),S(15,Ml,2,3,"ng-template",4)(16,yl,2,1,"ng-template",5),a()()(),r(17,"div",6)(18,"button",7),C("click",function(){return i.onClose()}),d(19),l(20,"translate"),a(),r(21,"button",8),C("click",function(){return i.tabIndex===0?i.copyObjects():i.copyMessage()}),d(22),l(23,"translate"),r(24,"mat-icon",9),d(25,"content_copy"),a()()()()),n&2&&(o(2),f(" ",p(4,9,p(3,7,i.title)??"DIALOGS.AUDIT_MESSAGE_DETAIL.TITLE")," "),o(5),Tn(" ",p(8,11,"DIALOGS.AUDIT_MESSAGE_DETAIL.ACTOR"),": ",i.actor,", ",p(9,13,"DIALOGS.AUDIT_MESSAGE_DETAIL.CREATED_AT"),": ",i.createdAt," "),o(12),f(" ",p(20,15,"DIALOGS.AUDIT_MESSAGE_DETAIL.CLOSE")," "),o(3),f(" ",p(23,17,"DIALOGS.AUDIT_MESSAGE_DETAIL.COPY")," "))},dependencies:[x,L,O,Qe,ut,ie,Z,te,ee,nt,Ze,et,tt,it,M,y,sn],styles:[`.key{color:brown}.string{color:green}.number{color:#ff8c00}.boolean{color:#00f}.null{color:#f0f}
`],encapsulation:2})}}return t})();function wl(t,c){t&1&&(r(0,"th",15),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"AUDIT_MESSAGES_LIST.ID")," "))}function Rl(t,c){if(t&1&&(r(0,"td",16),d(1),a()),t&2){let e=c.$implicit;o(),f(" ",e.id," ")}}function Ll(t,c){t&1&&(r(0,"th",15),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"AUDIT_MESSAGES_LIST.TIMESTAMP")," "))}function Bl(t,c){if(t&1&&(r(0,"td",16),d(1),l(2,"parseDate"),a()),t&2){let e=c.$implicit;o(),f(" ",je(2,1,e.createdAt,!0)," ")}}function Ol(t,c){t&1&&(r(0,"th",17),d(1),l(2,"translate"),a()),t&2&&(o(),A(p(2,1,"AUDIT_MESSAGES_LIST.EVENT_NAME")))}function Nl(t,c){if(t&1&&(r(0,"td",16),d(1),l(2,"parseEventName"),a()),t&2){let e=c.$implicit;o(),f(" ",p(2,1,e.event.name)," ")}}function Ul(t,c){t&1&&(r(0,"th",17),d(1),l(2,"translate"),a()),t&2&&(o(),A(p(2,1,"AUDIT_MESSAGES_LIST.ACTOR")))}function Vl(t,c){if(t&1&&(r(0,"td",16),d(1),a()),t&2){let e=c.$implicit;o(),f(" ",e.actor," ")}}function kl(t,c){t&1&&(r(0,"th",17),d(1),l(2,"translate"),a()),t&2&&(o(),A(p(2,1,"AUDIT_MESSAGES_LIST.MESSAGE")))}function Pl(t,c){if(t&1&&(r(0,"td",16),d(1),a()),t&2){let e=c.$implicit;o(),f(" ",e.event.message," ")}}function Fl(t,c){t&1&&b(0,"th",17)}function Gl(t,c){if(t&1){let e=T();r(0,"td",16)(1,"button",18),C("click",function(){let i=h(e).$implicit,s=_();return g(s.viewDetails(i))}),d(2),l(3,"translate"),a()()}t&2&&(o(2),f(" ",p(3,1,"AUDIT_MESSAGES_LIST.VIEW_DETAIL")," "))}function jl(t,c){t&1&&b(0,"tr",19)}function Hl(t,c){t&1&&b(0,"tr",20)}function Wl(t,c){if(t&1&&(r(0,"perun-web-apps-alert",14),d(1),l(2,"translate"),a()),t&2){let e=_();o(),f(" ",p(2,1,e.noMessagesAlert)," ")}}var ga=(()=>{class t{constructor(e,n,i){this.dialog=e,this.tableConfigService=n,this.destroyRef=i,this.noMessagesAlert="SHARED_LIB.UI.ALERTS.NO_AUDIT_MESSAGES",this.loading$=new Tt,this.queryChanged=new Tt,this.downloadAll=new Tt,this.pageSizeOptions=yt,this.displayedColumns=["id","timestamp","name","actor","event.message","detail"],this.unfilteredColumns=this.displayedColumns,this.tableId="app-audit-messages-list"}set auditMessages(e){this.dataSource||this.dataSourceInit(e);let n=this.isPaginated(e);_i(this.dataSource)&&n?(this.dataSource.data=e.data,this.dataSource.count=e.totalCount):!_i(this.dataSource)&&!n&&(this.dataSource.data=e)}set displayColumns(e){this.unfilteredColumns=e,localStorage.getItem("showIds")!=="true"&&(e=e.filter(n=>n!=="id")),this.displayedColumns=e}static getExportDataForColumn(e,n){switch(n){case"id":return e.id.toString();case"timestamp":return En(e.createdAt,"d.M.y H.mm.ss","en");case"name":return e.event.name.split(".").pop();case"actor":return e.actor;case"event.message":return e.event.message;default:return""}}ngOnInit(){this.resetPagination?.subscribe(e=>{e&&this.tableWrapper.paginator.firstPage()}),this.watchForIdColumnChanges()}viewDetails(e){let n=V(),i=JSON.parse(JSON.stringify(e));n.minWidth="700px",n.maxWidth="1000px",n.data={message:i},this.dialog.open(ha,n)}exportDisplayedData(e){if(_i(this.dataSource))st(Fe(this.dataSource.data,this.displayedColumns,t.getExportDataForColumn),e);else{let n=this.dataSource.paginator.pageIndex*this.dataSource.paginator.pageSize,i=n+this.dataSource.paginator.pageSize;st(Fe(this.dataSource.sortData(this.dataSource.filteredData,this.dataSource.sort).slice(n,i),this.displayedColumns,t.getExportDataForColumn),e)}}isPaginated(e){return"data"in e}dataSourceInit(e){let n=this.isPaginated(e);this.dataSource=n?new Un(e.data,e.totalCount,this.sort,this.tableWrapper.paginator):new Ae(e),_i(this.dataSource)?this.dataSource.pageQuery$.subscribe(i=>this.queryChanged.emit(i)):(this.dataSource.sort=this.sort,this.dataSource.paginator=this.tableWrapper.paginator,this.dataSource.filterPredicate=(i,s)=>Xt(i,s,this.displayedColumns,t.getExportDataForColumn,!0),this.dataSource.sortData=(i,s)=>Qt(i,s,t.getExportDataForColumn))}watchForIdColumnChanges(){this.tableConfigService.showIdsChanged.pipe(wt(this.destroyRef)).subscribe(e=>{e?this.displayedColumns=this.unfilteredColumns:this.displayedColumns=this.unfilteredColumns.filter(n=>n!=="id")}),localStorage.getItem("showIds")!=="true"&&(this.displayedColumns=this.displayedColumns.filter(e=>e!=="id"))}static{this.\u0275fac=function(n){return new(n||t)(m($),m(ni),m(Ut))}}static{this.\u0275cmp=D({type:t,selectors:[["app-audit-messages-list"]],viewQuery:function(n,i){if(n&1&&(ve(ot,7),ve(be,7)),n&2){let s;Te(s=Ee())&&(i.tableWrapper=s.first),Te(s=Ee())&&(i.sort=s.first)}},inputs:{refresh:"refresh",loading:"loading",noMessagesAlert:"noMessagesAlert",resetPagination:"resetPagination",pageSizeOptions:"pageSizeOptions",auditMessages:"auditMessages",displayColumns:"displayColumns"},outputs:{loading$:"loading$",queryChanged:"queryChanged",downloadAll:"downloadAll"},features:[It([{provide:yn,useClass:Qn}])],decls:24,vars:8,consts:[[1,"card","mt-2",3,"hidden"],[3,"exportDisplayedData","dataLength","pageSizeOptions","tableId"],["mat-table","","matSort","","matSortActive","id","matSortDirection","desc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","timestamp"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","actor"],["matColumnDef","event.message"],["matColumnDef","detail"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"static-column-size"],["mat-header-cell",""],["data-cy","audit-message-detail-button","color","accent","mat-flat-button","",3,"click"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"]],template:function(n,i){n&1&&(r(0,"div",0)(1,"perun-web-apps-table-wrapper",1),C("exportDisplayedData",function(v){return i.exportDisplayedData(v)}),r(2,"table",2),k(3,3),S(4,wl,3,3,"th",4)(5,Rl,2,1,"td",5),P(),k(6,6),S(7,Ll,3,3,"th",4)(8,Bl,3,4,"td",5),P(),k(9,7),S(10,Ol,3,3,"th",8)(11,Nl,3,3,"td",5),P(),k(12,9),S(13,Ul,3,3,"th",8)(14,Vl,2,1,"td",5),P(),k(15,10),S(16,kl,3,3,"th",8)(17,Pl,2,1,"td",5),P(),k(18,11),S(19,Fl,1,0,"th",8)(20,Gl,4,3,"td",5),P(),S(21,jl,1,0,"tr",12)(22,Hl,1,0,"tr",13),a()()(),E(23,Wl,3,3,"perun-web-apps-alert",14)),n&2&&(u("hidden",i.dataSource.filteredData.length===0),o(),u("dataLength",i.dataSource.count??i.dataSource.filteredData.length)("pageSizeOptions",i.pageSizeOptions)("tableId",i.tableId),o(),u("dataSource",i.dataSource),o(19),u("matHeaderRowDef",i.displayedColumns),o(),u("matRowDefColumns",i.displayedColumns),o(),I(!i.loading&&i.dataSource.filteredData.length===0?23:-1))},dependencies:[x,L,O,X,Q,ot,Ce,xe,ye,Be,we,Me,Oe,Re,Le,Ne,Ue,Dt,be,At,M,Jn,y,sn],encapsulation:2})}}return t})();function ql(t,c){t&1&&b(0,"perun-web-apps-loading-table")}function zl(t,c){if(t&1){let e=T();r(0,"app-audit-messages-list",7),l(1,"async"),l(2,"async"),C("queryChanged",function(i){h(e);let s=_();return g(s.nextPage.next(i))}),a()}if(t&2){let e=_();u("loading",p(1,4,e.loading$))("resetPagination",e.resetPagination)("displayColumns",e.displayedColumns)("auditMessages",p(2,6,e.messagesPage$))}}var Ca=(()=>{class t{constructor(e){this.auditMessagesManagerService=e,this.displayedColumns=["id","timestamp","name","actor","event.message","detail"],this.selectedEvents=[],this.eventOptions=[],this.eventOptionsForSearchSelect=[],this.nextPage=new G({}),this.resetPagination=new G(!1),this.messagesPage$=this.nextPage.pipe(se(n=>this.auditMessagesManagerService.getMessagesPage({query:{offset:n.offset,pageSize:n.pageSize,order:n.order,selectedEvents:this.selectedEvents}})),Nt(n=>{this.auditMessages=n.data,setTimeout(()=>this.loadingSubject$.next(!1),200)}),at({data:[],totalCount:0,offset:0,pageSize:0})),this.loadingSubject$=new G(!1),this.loading$=Ot(this.loadingSubject$,this.nextPage.pipe(ht(()=>!0)))}ngOnInit(){this.auditMessagesManagerService.findAllPossibleEvents().subscribe(e=>{this.eventOptions=e.sort(),this.eventOptionsForSearchSelect=this.eventOptions})}refreshTable(){this.resetPagination.next(!0),this.nextPage.next(this.nextPage.value)}toggleEvent(e){this.selectedEvents.splice(0,this.selectedEvents.length,...e)}refreshOnClosed(){this.selectedEvents=[...this.selectedEvents];let e=this.eventOptions.filter(n=>!this.selectedEvents.includes(n));this.eventOptionsForSearchSelect=[...this.selectedEvents,...e],this.refreshTable()}static{this.\u0275fac=function(n){return new(n||t)(m(Rn))}}static{this.\u0275cmp=D({type:t,selectors:[["app-admin-audit-log"]],decls:11,vars:9,consts:[["spinner",""],[1,"page-subtitle"],[1,"align-elements"],[3,"refresh"],[3,"auditLogsSelected","selectClosed","disableDeselectButton","auditLogs"],[1,"position-relative","w-100","table-min-height"],[3,"loading","resetPagination","displayColumns","auditMessages","queryChanged",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"queryChanged","loading","resetPagination","displayColumns","auditMessages"]],template:function(n,i){if(n&1){let s=T();r(0,"h1",1),d(1),l(2,"translate"),a(),r(3,"div",2)(4,"perun-web-apps-refresh-button",3),C("refresh",function(){return h(s),g(i.refreshTable())}),a(),r(5,"perun-web-apps-audit-log-search-select",4),C("auditLogsSelected",function(w){return h(s),g(i.toggleEvent(w))})("selectClosed",function(){return h(s),g(i.refreshOnClosed())}),a(),S(6,ql,1,0,"ng-template",null,0,B),r(8,"div",5),S(9,zl,3,8,"app-audit-messages-list",6),l(10,"async"),a()()}if(n&2){let s=R(7);o(),A(p(2,5,"ADMIN.AUDIT_LOG.TITLE")),o(4),u("disableDeselectButton",!1)("auditLogs",i.eventOptionsForSearchSelect),o(4),u("perunWebAppsLoader",p(10,7,i.loading$))("perunWebAppsLoaderIndicator",s)}},dependencies:[x,ce,M,ho,H,ga,N,He,y],encapsulation:2})}}return t})();var ba=(()=>{class t{constructor(e,n){this.dialogRef=e,this.data=n}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.dialogRef.close(!0)}static{this.\u0275fac=function(n){return new(n||t)(m(J),m(pe))}}static{this.\u0275cmp=D({type:t,selectors:[["app-perun-web-apps-edit-enforce-consents-dialog"]],decls:26,vars:26,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"mt-2","mb-2"],["alert_type","warn"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["mat-flat-button","","color","accent",1,"ms-2",3,"click"]],template:function(n,i){n&1&&(r(0,"div")(1,"h1",0),d(2),l(3,"translate"),l(4,"translate"),a(),r(5,"div",1)(6,"p"),d(7),l(8,"translate"),l(9,"translate"),a(),b(10,"mat-divider"),r(11,"p",2),d(12),a(),b(13,"mat-divider"),r(14,"perun-web-apps-alert",3),d(15),l(16,"translate"),l(17,"translate"),a()(),r(18,"div",4)(19,"button",5),C("click",function(){return i.onCancel()}),d(20),l(21,"translate"),a(),r(22,"button",6),C("click",function(){return i.onSubmit()}),d(23),l(24,"translate"),l(25,"translate"),a()()()),n&2&&(Pe(i.data.theme),o(2),f(" ",i.data.enforceConsents?p(3,8,"DIALOGS.EDIT_ENFORCE_CONSENTS_FLAG.DISABLE_TITLE"):p(4,10,"DIALOGS.EDIT_ENFORCE_CONSENTS_FLAG.ENFORCE_TITLE")," "),o(5),f(" ",i.data.enforceConsents?p(8,12,"DIALOGS.EDIT_ENFORCE_CONSENTS_FLAG.DISABLE_DESCRIPTION"):p(9,14,"DIALOGS.EDIT_ENFORCE_CONSENTS_FLAG.ENFORCE_DESCRIPTION")," "),o(5),A(i.data.consentHubName),o(3),f(" ",i.data.enforceConsents?p(16,16,"DIALOGS.EDIT_ENFORCE_CONSENTS_FLAG.DISABLE_BOLD_DESCRIPTION"):p(17,18,"DIALOGS.EDIT_ENFORCE_CONSENTS_FLAG.ENFORCE_BOLD_DESCRIPTION")," "),o(5),f(" ",p(21,20,"DIALOGS.EDIT_ENFORCE_CONSENTS_FLAG.CANCEL_BUTTON")," "),o(3),f(" ",i.data.enforceConsents?p(24,22,"DIALOGS.EDIT_ENFORCE_CONSENTS_FLAG.DISABLE_BUTTON"):p(25,24,"DIALOGS.EDIT_ENFORCE_CONSENTS_FLAG.ENFORCE_BUTTON")," "))},dependencies:[x,L,O,ie,Z,te,ee,X,Q,kn,M,y],encapsulation:2})}}return t})();var $l=t=>({all:t}),Kl=t=>({name:t}),Yl=(t,c)=>c.id;function Ql(t,c){if(t&1){let e=T();r(0,"th",16)(1,"mat-checkbox",17),l(2,"masterCheckboxLabel"),l(3,"translate"),C("change",function(i){h(e);let s=_(2);return g(i?s.masterToggle():null)}),a()()}if(t&2){let e=_(),n=_();o(),gt("aria-label",p(3,5,p(2,3,e.all))),u("checked",n.selection.hasValue()&&e.all)("indeterminate",n.selection.hasValue()&&!e.all)}}function Xl(t,c){if(t&1){let e=T();r(0,"td",18)(1,"mat-checkbox",19),l(2,"checkboxLabel"),l(3,"translate"),C("change",function(i){let s=h(e).$implicit,v=_(2);return g(i?v.toggleRow(s):null)})("click",function(i){return h(e),g(i.stopPropagation())}),a()()}if(t&2){let e=c.$implicit,n=_(2);o(),gt("aria-label",je(3,4,p(2,2,n.selection.isSelected(e)),De(7,Kl,e.name))),u("checked",n.selection.isSelected(e))}}function Jl(t,c){t&1&&(k(0,3),S(1,Ql,4,7,"th",14)(2,Xl,4,9,"td",15),P())}function Zl(t,c){t&1&&(r(0,"th",20),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"SHARED.COMPONENTS.CONSENT_HUBS_LIST.ID")," "))}function ep(t,c){if(t&1&&(r(0,"td",21),d(1),a()),t&2){let e=c.$implicit;o(),A(e.id)}}function tp(t,c){t&1&&(r(0,"th",20),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"SHARED.COMPONENTS.CONSENT_HUBS_LIST.NAME")," "))}function ip(t,c){if(t&1&&(r(0,"td",22),l(1,"multiWordDataCy"),d(2),a()),t&2){let e=c.$implicit;ui("data-cy",Ie("",p(1,3,e.name),"-name-td")),o(2),f(" ",e.name," ")}}function np(t,c){t&1&&(r(0,"th",20),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"SHARED.COMPONENTS.CONSENT_HUBS_LIST.ENFORCE_CONSENTS")," "))}function op(t,c){if(t&1){let e=T();r(0,"td",22)(1,"mat-slide-toggle",23),C("change",function(i){let s=h(e).$implicit,v=_();return g(v.changeEnforceFlag(s,i))}),a()()}if(t&2){let e=c.$implicit;o(),u("checked",e.enforceConsents)}}function ap(t,c){t&1&&(r(0,"th",20),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"SHARED.COMPONENTS.CONSENT_HUBS_LIST.FACILITIES")," "))}function rp(t,c){if(t&1&&(r(0,"span"),d(1),r(2,"span",24),d(3),a(),b(4,"br"),a()),t&2){let e=c.$implicit;o(),f(" ",e.name," "),o(2),f(" #",e.id)}}function sp(t,c){if(t&1&&(r(0,"td",22),Vt(1,rp,5,2,"span",null,Yl),a()),t&2){let e=c.$implicit;o(),kt(e.facilities)}}function lp(t,c){t&1&&b(0,"tr",25)}function pp(t,c){t&1&&b(0,"tr",26)}function cp(t,c){t&1&&(r(0,"perun-web-apps-alert",13),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"SHARED.COMPONENTS.CONSENT_HUBS_LIST.NO_CONSENT_HUBS")," "))}function dp(t,c){t&1&&(r(0,"perun-web-apps-alert",13),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"SHARED.COMPONENTS.CONSENT_HUBS_LIST.NO_FILTER_RESULTS")," "))}var Sa=(()=>{class t{constructor(e,n,i,s,v,w,q){this.tableCheckbox=e,this.dialog=n,this.notificator=i,this.translate=s,this.consentsManager=v,this.tableConfigService=w,this.destroyRef=q,this.filterValue="",this.selection=new K(!0,[]),this.exporting=!1,this.pageSizeOptions=yt,this.displayedColumns=["select","id","name","enforceConsents","facilities"],this.unfilteredColumns=this.displayedColumns,this.tableId="app-perun-web-apps-consent-hubs-list"}set displayColumns(e){this.unfilteredColumns=e,localStorage.getItem("showIds")!=="true"&&(e=e.filter(n=>n!=="id")),this.displayedColumns=e}set matSort(e){this.sort=e,this.setDataSource()}static getDataForColumn(e,n){switch(n){case"id":return e.id.toString();case"name":return e.name;case"enforceConsents":return e.enforceConsents?"true":"false";case"facilities":{let i="";return e.facilities.forEach(s=>i+=s.name+" #"+String(s.id)+";"),i.slice(0,-1)}default:return""}}ngOnInit(){this.selection&&(this.cachedSelection=new K(this.selection.isMultipleSelection(),[],!0,this.selection.compareWith),this.cachedSubject?.pipe(wt(this.destroyRef)).subscribe(e=>{e&&this.cachedSelection.clear()})),this.watchForIdColumnChanges()}ngOnChanges(){this.dataSource=new Ae(this.consentHubs),this.setDataSource()}exportAllData(e){st(Fe(this.dataSource.filteredData,this.displayedColumns,t.getDataForColumn),e)}exportDisplayedData(e){let n=this.dataSource.paginator.pageIndex*this.dataSource.paginator.pageSize,i=n+this.dataSource.paginator.pageSize;st(Fe(this.dataSource.sortData(this.dataSource.filteredData,this.dataSource.sort).slice(n,i),this.displayedColumns,t.getDataForColumn),e)}isAllSelected(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.dataSource)}masterToggle(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.cachedSelection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}setDataSource(){this.dataSource&&(this.dataSource.filterPredicate=(e,n)=>Xt(e,n,this.displayedColumns,t.getDataForColumn),this.dataSource.sortData=(e,n)=>Qt(e,n,t.getDataForColumn),this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue)}toggleRow(e){this.selection.toggle(e),this.cachedSelection.toggle(e)}pageChanged(){this.cachedSelection&&this.tableCheckbox.selectCachedDataOnPage(this.dataSource,this.selection,this.cachedSelection,this.selection.compareWith)}changeEnforceFlag(e,n){n.source.checked=e.enforceConsents;let i=V();i.width="550px",i.data={theme:"admin-theme",enforceConsents:e.enforceConsents,consentHubName:e.name},this.dialog.open(ba,i).afterClosed().subscribe(v=>{v&&(e.enforceConsents=!e.enforceConsents,this.consentsManager.updateConsentHub({consentHub:e}).subscribe(w=>{n.source.checked=w.enforceConsents,e.enforceConsents=w.enforceConsents,this.translate.get("SHARED.COMPONENTS.CONSENT_HUBS_LIST.CHANGE_ENFORCE_CONSENTS_SUCCESS").subscribe(q=>{this.notificator.showSuccess(q)})},()=>e.enforceConsents=!e.enforceConsents))})}watchForIdColumnChanges(){this.tableConfigService.showIdsChanged.pipe(wt(this.destroyRef)).subscribe(e=>{e?this.displayedColumns=this.unfilteredColumns:this.displayedColumns=this.unfilteredColumns.filter(n=>n!=="id")}),localStorage.getItem("showIds")!=="true"&&(this.displayedColumns=this.displayedColumns.filter(e=>e!=="id"))}static{this.\u0275fac=function(n){return new(n||t)(m(Jt),m($),m(j),m(Y),m(Mt),m(ni),m(Ut))}}static{this.\u0275cmp=D({type:t,selectors:[["app-perun-web-apps-consent-hubs-list"]],viewQuery:function(n,i){if(n&1&&(ve(ot,7),ve(be,7)),n&2){let s;Te(s=Ee())&&(i.child=s.first),Te(s=Ee())&&(i.matSort=s.first)}},inputs:{consentHubs:"consentHubs",filterValue:"filterValue",selection:"selection",cachedSubject:"cachedSubject",loading:"loading",displayColumns:"displayColumns"},features:[Ii],decls:21,vars:15,consts:[[1,"card","mt-2",3,"hidden"],[3,"exportDisplayedData","exportAllData","pageChanged","tableId","dataLength","pageSizeOptions"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"matSortChange","dataSource"],["matColumnDef","select"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-cell","",4,"matCellDef"],["matColumnDef","enforceConsents"],["matColumnDef","facilities"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn"],["mat-header-cell","","class","align-checkbox",4,"matHeaderCellDef"],["class","static-column-size align-checkbox","mat-cell","",4,"matCellDef"],["mat-header-cell","",1,"align-checkbox"],["color","primary",3,"change","aria-label","checked","indeterminate"],["mat-cell","",1,"static-column-size","align-checkbox"],["color","primary",3,"change","click","aria-label","checked"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"static-column-size"],["mat-cell",""],[3,"change","checked"],[1,"text-muted"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"]],template:function(n,i){if(n&1&&(r(0,"div",0)(1,"perun-web-apps-table-wrapper",1),C("exportDisplayedData",function(v){return i.exportDisplayedData(v)})("exportAllData",function(v){return i.exportAllData(v)})("pageChanged",function(){return i.pageChanged()}),r(2,"table",2),C("matSortChange",function(){return i.pageChanged()}),E(3,Jl,3,0,"ng-container",3),l(4,"isAllSelected"),k(5,4),S(6,Zl,3,3,"th",5)(7,ep,2,1,"td",6),P(),k(8,7),S(9,tp,3,3,"th",5)(10,ip,3,5,"td",8),P(),k(11,9),S(12,np,3,3,"th",5)(13,op,2,1,"td",8),P(),k(14,10),S(15,ap,3,3,"th",5)(16,sp,3,0,"td",8),P(),S(17,lp,1,0,"tr",11)(18,pp,1,0,"tr",12),a()()(),E(19,cp,3,3,"perun-web-apps-alert",13),E(20,dp,3,3,"perun-web-apps-alert",13)),n&2){let s;u("hidden",i.consentHubs.length===0||i.dataSource.filteredData.length===0),o(),u("tableId",i.tableId)("dataLength",i.dataSource.filteredData.length)("pageSizeOptions",i.pageSizeOptions),o(),u("dataSource",i.dataSource),o(),I((s=De(13,$l,je(4,10,i.dataSource,i.selection.selected.length)))?3:-1,s),o(14),u("matHeaderRowDef",i.displayedColumns),o(),u("matRowDefColumns",i.displayedColumns),o(),I(!i.loading&&i.consentHubs.length===0?19:-1),o(),I(i.dataSource.filteredData.length===0&&i.consentHubs.length!==0?20:-1)}},dependencies:[x,Ht,jt,Yt,Kt,X,Q,ot,Ce,xe,ye,Be,we,Me,Oe,Re,Le,Ne,Ue,Dt,be,At,M,ei,y,ti,ii,zi],encapsulation:2})}}return t})();function mp(t,c){t&1&&(r(0,"perun-web-apps-alert",2),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"ADMIN.CONSENT_HUBS.GLOBAL_DISABLED")," "))}function up(t,c){if(t&1){let e=T();r(0,"button",9),C("click",function(){h(e);let i=_();return g(i.evaluateConsents())}),d(1),l(2,"translate"),a()}if(t&2){let e=_();u("disabled",!e.globalForceConsents||e.loading||e.selection.selected.length===0),o(),f(" ",p(2,2,"ADMIN.CONSENT_HUBS.EVALUATE_CONSENTS")," ")}}function _p(t,c){t&1&&b(0,"perun-web-apps-loading-table")}function fp(t,c){if(t&1&&b(0,"app-perun-web-apps-consent-hubs-list",10),t&2){let e=_();u("loading",e.loading)("consentHubs",e.consentHubs)("selection",e.selection)("cachedSubject",e.cachedSubject)("filterValue",e.filterValue)}}var va=(()=>{class t{constructor(e,n,i,s,v,w){this.consentsManager=e,this.authResolver=n,this.notificator=i,this.translate=s,this.store=v,this.dialog=w,this.loading=!1,this.selection=new K(!0,[],!0,(q,_e)=>q.id===_e.id),this.filterValue="",this.consentHubs=[],this.cachedSubject=new G(!0)}ngOnInit(){this.globalForceConsents=this.store.getProperty("enforce_consents"),this.refreshTable()}applyFilter(e){this.filterValue=e,this.refreshTable()}refreshTable(){this.loading=!0,this.selection.clear(),this.cachedSubject.next(!0),this.consentsManager.getAllConsentHubs().subscribe(e=>{this.consentHubs=e,this.loading=!1})}evaluateConsents(){let e=V();e.width="500px",e.data={title:this.translate.instant("ADMIN.CONSENT_HUBS.CONFIRM_DIALOG_TITLE"),theme:"admin-theme",description:this.translate.instant("ADMIN.CONSENT_HUBS.CONFIRM_DIALOG_DESCRIPTION"),items:this.selection.selected.map(i=>i.name),type:"confirmation",showAsk:!1},this.dialog.open(Yi,e).afterClosed().subscribe(i=>{i&&this.evaluateConsentsForConsentHubs()})}evaluateConsentsForConsentHubs(){this.loading=!0;let e=this.selection.selected.map(n=>n.id);this.consentsManager.evaluateConsentsForConsentHubs(e).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("ADMIN.CONSENT_HUBS.EVALUATION_FINISH")),this.refreshTable()},error:()=>this.loading=!1})}static{this.\u0275fac=function(n){return new(n||t)(m(Mt),m(re),m(j),m(zt),m(Ve),m($))}}static{this.\u0275cmp=D({type:t,selectors:[["app-perun-web-apps-admin-consent-hubs"]],decls:14,vars:13,consts:[["spinner",""],[1,"page-subtitle"],["alert_type","warn"],[3,"refresh"],[3,"matTooltipDisabled","matTooltip"],["color","accent","mat-flat-button","",1,"action-button","me-2",3,"disabled"],[3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","consentHubs","selection","cachedSubject","filterValue",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","mat-flat-button","",1,"action-button","me-2",3,"click","disabled"],[3,"loading","consentHubs","selection","cachedSubject","filterValue"]],template:function(n,i){if(n&1){let s=T();r(0,"div")(1,"h1",1),d(2),l(3,"translate"),a(),E(4,mp,3,3,"perun-web-apps-alert",2),r(5,"perun-web-apps-refresh-button",3),C("refresh",function(){return h(s),g(i.refreshTable())}),a(),r(6,"span",4),l(7,"translate"),E(8,up,3,4,"button",5),a(),r(9,"perun-web-apps-debounce-filter",6),C("filter",function(w){return h(s),g(i.applyFilter(w))}),a(),S(10,_p,1,0,"ng-template",null,0,B),r(12,"div",7),S(13,fp,1,5,"app-perun-web-apps-consent-hubs-list",8),a()()}if(n&2){let s=R(11);o(2),A(p(3,9,"ADMIN.CONSENT_HUBS.TITLE")),o(2),I(i.globalForceConsents?-1:4),o(2),u("matTooltip",fe(p(7,11,"ADMIN.CONSENT_HUBS.TOOLTIP")))("matTooltipDisabled",i.globalForceConsents),o(2),I(i.authResolver.isPerunAdmin()?8:-1),o(),u("placeholder","ADMIN.CONSENT_HUBS.SEARCH"),o(4),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,X,Q,de,ce,M,We,Sa,N,H,y],encapsulation:2})}}return t})();function hp(t,c){t&1&&(d(0),l(1,"translate")),t&2&&f(" ",p(1,1,"USER_DETAIL.BANS.VO")," ")}function gp(t,c){if(t&1){let e=T();r(0,"perun-web-apps-ban-on-entity-list",8),C("updateBan",function(i){h(e);let s=_(2);return g(s.updateVoBan(i))}),a()}if(t&2){let e=_(2);u("loading",e.loading)("bans",e.voBans)("displayedColumns",e.displayedColumns)("filter",e.filter)("updatePolicy","updateBan_BanOnVo_policy")}}function Cp(t,c){if(t&1){let e=T();r(0,"perun-web-apps-debounce-filter",5),C("filter",function(i){h(e);let s=_();return g(s.filter=i)}),a(),r(1,"div",6),S(2,gp,1,5,"perun-web-apps-ban-on-entity-list",7),a()}if(t&2){let e=_(),n=R(14);u("placeholder","USER_DETAIL.BANS.FILTER"),o(2),u("perunWebAppsLoader",e.loading)("perunWebAppsLoaderIndicator",n)}}function bp(t,c){t&1&&(d(0),l(1,"translate")),t&2&&f(" ",p(1,1,"USER_DETAIL.BANS.RESOURCE")," ")}function Sp(t,c){if(t&1){let e=T();r(0,"perun-web-apps-ban-on-entity-list",8),C("updateBan",function(i){h(e);let s=_(2);return g(s.updateResourceBan(i))}),a()}if(t&2){let e=_(2);u("loading",e.loading)("bans",e.resourceBans)("displayedColumns",e.displayedColumns)("filter",e.filter)("updatePolicy","updateBan_BanOnResource_policy")}}function vp(t,c){if(t&1){let e=T();r(0,"perun-web-apps-debounce-filter",5),C("filter",function(i){h(e);let s=_();return g(s.filter=i)}),a(),r(1,"div",6),S(2,Sp,1,5,"perun-web-apps-ban-on-entity-list",7),a()}if(t&2){let e=_(),n=R(14);u("placeholder","USER_DETAIL.BANS.FILTER"),o(2),u("perunWebAppsLoader",e.loading)("perunWebAppsLoaderIndicator",n)}}function Tp(t,c){t&1&&(d(0),l(1,"translate")),t&2&&f(" ",p(1,1,"USER_DETAIL.BANS.FACILITY")," ")}function Ep(t,c){if(t&1){let e=T();r(0,"perun-web-apps-ban-on-entity-list",8),C("updateBan",function(i){h(e);let s=_(2);return g(s.updateFacilityBan(i))}),a()}if(t&2){let e=_(2);u("loading",e.loading)("bans",e.facilityBans)("displayedColumns",e.displayedColumns)("filter",e.filter)("updatePolicy","updateBan_BanOnFacility_policy")}}function Ip(t,c){if(t&1){let e=T();r(0,"perun-web-apps-debounce-filter",5),C("filter",function(i){h(e);let s=_();return g(s.filter=i)}),a(),r(1,"div",6),S(2,Ep,1,5,"perun-web-apps-ban-on-entity-list",7),a()}if(t&2){let e=_(),n=R(14);u("placeholder","USER_DETAIL.BANS.FILTER"),o(2),u("perunWebAppsLoader",e.loading)("perunWebAppsLoaderIndicator",n)}}function Ap(t,c){t&1&&b(0,"perun-web-apps-loading-table")}var Ta=(()=>{class t{constructor(e,n,i,s,v){this.voService=e,this.resourceService=n,this.facilityService=i,this.entityService=s,this.dialog=v,this.loading=!1,this.voBans=[],this.resourceBans=[],this.facilityBans=[],this.filter="",this.displayedColumns=["banId","targetId","targetName","description","expiration","edit"]}ngOnInit(){this.loading=!0,this.user=this.entityService.getEntity(),this.refreshVoBans()}refreshVoBans(){this.loading=!0,this.voService.getEnrichedVoBansForUser(this.user.id).subscribe({next:e=>{this.voBans=e,this.loading=!1},error:()=>this.loading=!1})}refreshResourceBans(){this.loading=!0,this.resourceService.getEnrichedBansForUser(this.user.id).subscribe({next:e=>{this.resourceBans=e,this.loading=!1},error:()=>this.loading=!1})}refreshFacilityBans(){this.loading=!0,this.facilityService.getEnricheFacilitydBansForUser(this.user.id).subscribe({next:e=>{this.facilityBans=e,this.loading=!1},error:()=>this.loading=!1})}updateVoBan(e){this.dialog.open(Do,this.getConfig(e)).afterClosed().subscribe(i=>{i&&this.refreshVoBans()})}updateResourceBan(e){this.dialog.open(xo,this.getConfig(e)).afterClosed().subscribe(i=>{i&&this.refreshResourceBans()})}updateFacilityBan(e){this.dialog.open(ko,this.getConfig(e)).afterClosed().subscribe(i=>{i&&this.refreshFacilityBans()})}getConfig(e){let n=V();return n.width="600px",n.data={ban:e.ban,theme:"user-theme"},n}refresh(e){e.index===0?this.refreshVoBans():e.index===1?this.refreshResourceBans():this.refreshFacilityBans()}static{this.\u0275fac=function(n){return new(n||t)(m(Nn),m(ji),m($t),m(ke),m($))}}static{this.\u0275cmp=D({type:t,selectors:[["app-user-bans"]],decls:15,vars:3,consts:[["spinner",""],[1,"page-subtitle"],["mat-stretch-tabs","false",1,"mt-3",3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],[1,"mt-2","search-field",3,"filter","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","bans","displayedColumns","filter","updatePolicy","updateBan",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"updateBan","loading","bans","displayedColumns","filter","updatePolicy"]],template:function(n,i){if(n&1){let s=T();r(0,"h1",1),d(1),l(2,"translate"),a(),r(3,"mat-tab-group",2),C("selectedTabChange",function(w){return h(s),g(i.refresh(w))}),r(4,"mat-tab"),S(5,hp,2,3,"ng-template",3)(6,Cp,3,3,"ng-template",4),a(),r(7,"mat-tab"),S(8,bp,2,3,"ng-template",3)(9,vp,3,3,"ng-template",4),a(),r(10,"mat-tab"),S(11,Tp,2,3,"ng-template",3)(12,Ip,3,3,"ng-template",4),a()(),S(13,Ap,1,0,"ng-template",null,0,B)}n&2&&(o(),f(" ",p(2,1,"USER_DETAIL.BANS.TITLE"),`
`))},dependencies:[x,de,nt,Ze,et,tt,it,M,fo,N,H,y],encapsulation:2})}}return t})();function Dp(t,c){t&1&&b(0,"perun-web-apps-loading-dialog")}function xp(t,c){t&1&&b(0,"th",18)}function Mp(t,c){if(t&1&&(r(0,"td",19),d(1),a()),t&2){let e=c.$implicit;o(),A(e.id)}}function yp(t,c){t&1&&b(0,"th",18)}function wp(t,c){if(t&1&&(r(0,"td",20),d(1),a()),t&2){let e=c.$implicit;o(),f(" ",e.login," ")}}function Rp(t,c){t&1&&b(0,"th",18)}function Lp(t,c){if(t&1&&(r(0,"td",19),d(1),l(2,"globalNamespace"),a()),t&2){let e=c.$implicit;Pe(e.namespace?"":"fst-italic"),o(),f(" ",p(2,3,e.namespace)," ")}}function Bp(t,c){t&1&&b(0,"tr",21)}function Op(t,c){t&1&&b(0,"tr",22)}function Np(t,c){if(t&1){let e=T();r(0,"div")(1,"h1",2),d(2),l(3,"translate"),a(),r(4,"div",3)(5,"p"),d(6),l(7,"translate"),a(),r(8,"div",4),d(9),l(10,"translate"),a(),r(11,"table",5),k(12,6),S(13,xp,1,0,"th",7)(14,Mp,2,1,"td",8),P(),k(15,9),S(16,yp,1,0,"th",7)(17,wp,2,1,"td",10),P(),k(18,11),S(19,Rp,1,0,"th",7)(20,Lp,3,5,"td",12),P(),S(21,Bp,1,0,"tr",13)(22,Op,1,0,"tr",14),a()(),r(23,"div",15)(24,"button",16),C("click",function(){h(e);let i=_();return g(i.onCancel())}),d(25),l(26,"translate"),a(),r(27,"button",17),C("click",function(){h(e);let i=_();return g(i.onSubmit())}),d(28),l(29,"translate"),a()()()}if(t&2){let e=_();o(2),A(p(3,8,"DIALOGS.UNBLOCK_LOGINS.TITLE")),o(4),f(" ",p(7,10,"DIALOGS.UNBLOCK_LOGINS.DESCRIPTION")," "),o(3),f(" ",p(10,12,"DIALOGS.UNBLOCK_LOGINS.ASK")," "),o(2),u("dataSource",e.dataSource),o(10),u("matHeaderRowDef",e.displayedColumns),o(),u("matRowDefColumns",e.displayedColumns),o(3),f(" ",p(26,14,"DIALOGS.UNBLOCK_LOGINS.CANCEL")," "),o(3),f(" ",p(29,16,"DIALOGS.UNBLOCK_LOGINS.UNBLOCK")," ")}}var Ea=(()=>{class t{constructor(e,n,i,s,v){this.dialogRef=e,this.data=n,this.notificator=i,this.translate=s,this.usersService=v,this.displayedColumns=["login","namespace"]}ngOnInit(){this.theme=this.data.theme,this.dataSource=new Ae(this.data.logins)}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.usersService.unblockLoginsByIdBodyParams({logins:this.data.logins.map(e=>e.id)}).subscribe({next:()=>{this.notificator.showInstantSuccess("ADMIN.BLOCKED_LOGINS.UNBLOCK_SUCCESS"),this.dialogRef.close(!0),this.loading=!1},error:()=>{this.loading=!1}})}static{this.\u0275fac=function(n){return new(n||t)(m(J),m(pe),m(j),m(Y),m(le))}}static{this.\u0275cmp=D({type:t,selectors:[["app-unblock-logins-dialog"]],features:[It([dn])],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"fw-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","login"],["mat-cell","","class","trim-login",4,"matCellDef"],["matColumnDef","namespace"],["mat-cell","",3,"class",4,"matCellDef"],["class","fw-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","warn","mat-flat-button","","data-cy","unblock-button-dialog",1,"ms-2",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"trim-login"],["mat-header-row","",1,"fw-bolder"],["mat-row",""]],template:function(n,i){if(n&1&&(S(0,Dp,1,0,"ng-template",null,0,B),r(2,"div"),S(3,Np,30,18,"div",1),a()),n&2){let s=R(1);o(2),Pe(Ie("",i.theme," position-relative")),o(),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,ie,Z,te,ee,ue,Ce,xe,ye,Be,we,Me,Oe,Re,Le,Ne,Ue,M,N,y,dn],styles:[".trim-login[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;max-width:250px}"]})}}return t})();function Up(t,c){t&1&&b(0,"perun-web-apps-loading-dialog")}function Vp(t,c){if(t&1&&(r(0,"mat-radio-button",5),d(1),l(2,"translate"),a()),t&2){let e=_(2);u("value",!1)("checked",!e.isGlobal),o(),f(" ",p(2,3,"DIALOGS.BLOCK_LOGINS.SPECIFIC")," ")}}function kp(t,c){if(t&1){let e=T();r(0,"perun-web-apps-namespace-search-select",12),C("namespaceSelected",function(i){h(e);let s=_(2);return g(s.selectedNamespace=i)}),a()}if(t&2){let e=_(2);u("namespaceOptions",e.data.namespaceOptions)("namespace",e.selectedNamespace)("disableAutoSelect",!0)("customFindPlaceholder","DIALOGS.BLOCK_LOGINS.FIND_PLACEHOLDER")}}function Pp(t,c){t&1&&(r(0,"mat-error"),d(1),l(2,"translate"),a()),t&2&&(o(),f(" ",p(2,1,"DIALOGS.BLOCK_LOGINS.LOGINS_ERROR")," "))}function Fp(t,c){if(t&1){let e=T();r(0,"div")(1,"h1",2),d(2),l(3,"translate"),a(),r(4,"div",3)(5,"mat-radio-group",4),St("ngModelChange",function(i){h(e);let s=_();return bt(s.isGlobal,i)||(s.isGlobal=i),g(i)}),r(6,"mat-radio-button",5),d(7),l(8,"translate"),a(),E(9,Vp,3,5,"mat-radio-button",5),a(),E(10,kp,1,4,"perun-web-apps-namespace-search-select",6),r(11,"mat-form-field",7)(12,"mat-label"),d(13),l(14,"translate"),a(),b(15,"textarea",8),l(16,"translate"),E(17,Pp,3,3,"mat-error"),a()(),r(18,"div",9)(19,"button",10),C("click",function(){h(e);let i=_();return g(i.onCancel())}),d(20),l(21,"translate"),a(),r(22,"button",11),C("click",function(){h(e);let i=_();return g(i.onSubmit())}),d(23),l(24,"translate"),a()()()}if(t&2){let e=_();o(2),A(p(3,15,"DIALOGS.BLOCK_LOGINS.TITLE")),o(3),Ct("ngModel",e.isGlobal),o(),u("value",!0)("checked",e.isGlobal),o(),f(" ",p(8,17,"DIALOGS.BLOCK_LOGINS.GLOBAL")," "),o(2),I(e.data.namespaceOptions.length>0?9:-1),o(),I(e.data.namespaceOptions.length>0&&!e.isGlobal?10:-1),o(3),A(p(14,19,"DIALOGS.BLOCK_LOGINS.INSERT_HERE")),o(2),u("placeholder",fe(p(16,21,"DIALOGS.BLOCK_LOGINS.PLACEHOLDER")))("formControl",e.blockLogins),o(2),I(e.blockLogins.hasError("required")?17:-1),o(3),f(" ",p(21,23,"DIALOGS.BULK_INVITE_MEMBERS.CANCEL")," "),o(2),u("disabled",e.loading||e.blockLogins.invalid||!e.isGlobal&&e.selectedNamespace===null),o(),f(" ",p(24,25,"DIALOGS.BLOCK_LOGINS.BLOCK")," ")}}var Ia=(()=>{class t{constructor(e,n,i,s,v){this.dialogRef=e,this.data=n,this.store=i,this.usersService=s,this.notificator=v,this.loading=!1,this.blockLogins=new Lt("",ge.required),this.namespace=new Lt("",ge.required),this.isGlobal=!0,this.selectedNamespace=null}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.usersService.blockLoginsBodyParams({logins:this.blockLogins.value.split(`
`).map(e=>e.trim()),namespace:this.isGlobal?null:this.selectedNamespace}).subscribe({next:()=>{this.notificator.showInstantSuccess("ADMIN.BLOCKED_LOGINS.BLOCK_SUCCESS"),this.dialogRef.close(!0),this.loading=!1},error:()=>{this.loading=!1}})}static{this.\u0275fac=function(n){return new(n||t)(m(J),m(pe),m(Ve),m(le),m(j))}}static{this.\u0275cmp=D({type:t,selectors:[["app-block-logins-dialog"]],decls:4,vars:5,consts:[["spinner",""],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-dialog-title",""],["mat-dialog-content","",1,"dialog-container"],[1,"d-flex","flex-column",3,"ngModelChange","ngModel"],["color","primary",1,"me-3",3,"value","checked"],[3,"namespaceOptions","namespace","disableAutoSelect","customFindPlaceholder"],[1,"pt-2","d-flex","flex-column"],["cols","50","data-cy","logins-input","required","","matInput","","rows","8",1,"md-textarea","form-control",3,"formControl","placeholder"],["mat-dialog-actions",""],["mat-stroked-button","",1,"ms-auto",3,"click"],["color","accent","data-cy","submit-blocked-logins-button","mat-flat-button","",1,"ms-2",3,"click","disabled"],[3,"namespaceSelected","namespaceOptions","namespace","disableAutoSelect","customFindPlaceholder"]],template:function(n,i){if(n&1&&(S(0,Up,1,0,"ng-template",null,0,B),r(2,"div"),S(3,Fp,25,27,"div",1),a()),n&2){let s=R(1);o(2),Pe(Ie("",i.data.theme," position-relative")),o(),u("perunWebAppsLoader",i.loading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,Ye,Ke,ct,xt,Je,Xe,zn,Wn,qn,$e,qe,ze,pt,wi,Gt,Ft,ie,Z,te,ee,ue,M,N,Zi,y],encapsulation:2})}}return t})();function Gp(t,c){if(t&1){let e=T();r(0,"button",10),C("click",function(){h(e);let i=_();return g(i.block())}),d(1),l(2,"translate"),a()}t&2&&(o(),f(" ",p(2,1,"ADMIN.BLOCKED_LOGINS.BLOCK")," "))}function jp(t,c){if(t&1){let e=T();r(0,"button",11),l(1,"async"),C("click",function(){h(e);let i=_();return g(i.unblock())}),d(2),l(3,"translate"),a()}if(t&2){let e=_();u("disabled",p(1,2,e.loading$)||e.selection.selected.length===0),o(2),f(" ",p(3,4,"ADMIN.BLOCKED_LOGINS.UNBLOCK")," ")}}function Hp(t,c){t&1&&b(0,"perun-web-apps-loading-table")}function Wp(t,c){if(t&1){let e=T();r(0,"perun-web-apps-logins-list",12),l(1,"async"),l(2,"async"),C("queryChanged",function(i){h(e);let s=_();return g(s.nextPage.next(i))})("downloadAll",function(i){h(e);let s=_();return g(s.downloadAll(i))}),a()}if(t&2){let e=_();u("loading",p(1,7,e.loading$))("blockedLogins",p(2,9,e.blockedLoginsPage$))("displayedColumns",e.displayedColumns)("selection",e.selection)("filter",e.searchString)("cacheSubject",e.cacheSubject)("resetPagination",e.resetPagination)}}var Aa=(()=>{class t{constructor(e,n,i,s,v){this.cd=e,this.dialog=n,this.attributesService=i,this.authResolver=s,this.userManager=v,this.isAdmin=!1,this.selection=new K(!0,[],!0,(w,q)=>w.id===q.id),this.logins=[],this.namespaceOptions=[],this.filterOptions=[],this.selectedNamespaces=[],this.namespaces=new Lt,this.displayedColumns=["checkbox","login","namespace"],this.blockedLogins=[],this.nextPage=new G({}),this.resetPagination=new G(!1),this.blockedLoginsPage$=this.nextPage.pipe(se(w=>this.userManager.getBlockedLoginsPage({query:{order:w.order,pageSize:w.pageSize,offset:w.offset,sortColumn:w.sortColumn,searchString:w.searchString,namespaces:this.selectedNamespaces}})),Nt(w=>{this.blockedLogins=w.data,this.selection.clear(),setTimeout(()=>this.loadingSubject$.next(!1),200)}),at({data:[],totalCount:0,offset:0,pageSize:0})),this.loadingSubject$=new G(!1),this.cacheSubject=new G(!0),this.loading$=Ot(this.loadingSubject$,this.nextPage.pipe(ht(()=>!0)))}refreshTable(){this.cacheSubject.next(!0),this.resetPagination.next(!0),this.nextPage.next(this.nextPage.value)}onSearchByString(e){this.searchString=e,this.cd.detectChanges()}ngOnInit(){this.namespaces.setValue(this.selectedNamespaces),this.isAdmin=this.authResolver.isPerunAdmin(),this.attributesService.getAllNamespaces().subscribe(e=>{this.namespaceOptions=e,this.filterOptions=[""].concat(e)})}block(){let e=V();e.width="450px",e.data={theme:"admin-theme",namespaceOptions:this.namespaceOptions},this.dialog.open(Ia,e).afterClosed().subscribe(i=>{i&&this.refreshTable()})}unblock(){let e=V();e.width="650px",e.data={logins:this.selection.selected,theme:"admin-theme"},this.dialog.open(Ea,e).afterClosed().subscribe(i=>{i&&this.refreshTable()})}toggleEvent(e){this.selectedNamespaces.splice(0,this.selectedNamespaces.length,...e.map(n=>n===""?null:n))}refreshOnClosed(){this.selectedNamespaces=[...this.selectedNamespaces],this.refreshTable()}downloadAll(e){let n=this.nextPage.getValue();this.userManager.getBlockedLoginsPage({query:{order:n.order,pageSize:e.length,offset:0,sortColumn:n.sortColumn,searchString:n.searchString,namespaces:this.selectedNamespaces}}).subscribe({next:i=>{st(Fe(i.data,this.displayedColumns,e.getDataForColumnFun),e.format)}})}static{this.\u0275fac=function(n){return new(n||t)(m(xi),m($),m(ae),m(re),m(le))}}static{this.\u0275cmp=D({type:t,selectors:[["app-perun-web-apps-admin-blocked-logins"]],decls:16,vars:18,consts:[["spinner",""],[1,"page-subtitle"],[1,"align-elements"],[3,"refresh"],["color","accent","data-cy","block-logins-button","mat-flat-button","",1,"me-2","action-button"],["color","warn","data-cy","unblock-logins-button","mat-flat-button","",1,"me-2",3,"disabled"],[1,"pr-2","me-2","flex-grow-1",3,"namespaceSelected","selectClosed","namespaceOptions","multiple","disableAutoSelect","disableDeselectButton","customSelectPlaceholder"],[1,"search-field","flex-grow-1",3,"filter","autoFocus","placeholder"],[1,"position-relative","table-min-height"],[3,"loading","blockedLogins","displayedColumns","selection","filter","cacheSubject","resetPagination","queryChanged","downloadAll",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["color","accent","data-cy","block-logins-button","mat-flat-button","",1,"me-2","action-button",3,"click"],["color","warn","data-cy","unblock-logins-button","mat-flat-button","",1,"me-2",3,"click","disabled"],[3,"queryChanged","downloadAll","loading","blockedLogins","displayedColumns","selection","filter","cacheSubject","resetPagination"]],template:function(n,i){if(n&1){let s=T();r(0,"h1",1),d(1),l(2,"translate"),a(),r(3,"div",2)(4,"div")(5,"perun-web-apps-refresh-button",3),C("refresh",function(){return h(s),g(i.refreshTable())}),a(),E(6,Gp,3,3,"button",4),E(7,jp,4,6,"button",5),a(),r(8,"perun-web-apps-namespace-search-select",6),l(9,"translate"),C("namespaceSelected",function(w){return h(s),g(i.toggleEvent(w))})("selectClosed",function(){return h(s),g(i.refreshOnClosed())}),a(),r(10,"perun-web-apps-debounce-filter",7),C("filter",function(w){return h(s),g(i.onSearchByString(w))}),a()(),S(11,Hp,1,0,"ng-template",null,0,B),r(13,"div",8),S(14,Wp,3,11,"perun-web-apps-logins-list",9),l(15,"async"),a()}if(n&2){let s=R(12);o(),A(p(2,12,"ADMIN.BLOCKED_LOGINS.TITLE")),o(5),I(i.isAdmin?6:-1),o(),I(i.isAdmin?7:-1),o(),u("namespaceOptions",i.filterOptions)("multiple",!0)("disableAutoSelect",!0)("disableDeselectButton",!1)("customSelectPlaceholder",p(9,14,"ADMIN.BLOCKED_LOGINS.FILTER_NAMESPACE")),o(2),u("autoFocus",!0)("placeholder","ADMIN.BLOCKED_LOGINS.SEARCH_PLACEHOLDER"),o(4),u("perunWebAppsLoader",p(15,16,i.loading$))("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,de,ce,M,Zi,Co,H,N,He,y],encapsulation:2})}}return t})();var qp=()=>["id","name","vo","description"];function zp(t,c){t&1&&b(0,"perun-web-apps-loading-table")}function $p(t,c){if(t&1){let e=T();r(0,"perun-web-apps-facility-search-select",7),C("facilitySelected",function(i){h(e);let s=_(2);return g(s.loadFacility(i))}),a()}if(t&2){let e=_(2);u("facilities",e.facilities)}}function Kp(t,c){t&1&&(d(0),l(1,"translate")),t&2&&f(" ",p(1,1,"USER_DETAIL.ASSIGNMENTS.OVERVIEW")," ")}function Yp(t,c){if(t&1&&b(0,"perun-web-apps-resources-list",13),t&2){let e=_(4);u("loading",e.loading)("resources",e.resources)("displayColumns",he(3,qp))}}function Qp(t,c){if(t&1&&(r(0,"p",10),d(1),l(2,"translate"),a(),r(3,"div",11),S(4,Yp,1,4,"perun-web-apps-resources-list",12),a()),t&2){let e=_(3),n=R(4);o(),A(p(2,3,"USER_DETAIL.ASSIGNMENTS.RESOURCES")),o(3),u("perunWebAppsLoader",e.loading)("perunWebAppsLoaderIndicator",n)}}function Xp(t,c){t&1&&(d(0),l(1,"translate")),t&2&&f(" ",p(1,1,"USER_DETAIL.ASSIGNMENTS.USER_FACILITY_ATT")," ")}function Jp(t,c){t&1&&b(0,"mat-spinner",14)}function Zp(t,c){if(t&1&&b(0,"app-two-entity-attribute-page",15),t&2){let e=_(4);u("firstEntity","user")("firstEntityId",e.userId)("secondEntity","facility")("specificSecondEntity",e.selectedFacility)}}function ec(t,c){if(t&1&&(E(0,Jp,1,0,"mat-spinner",14),E(1,Zp,1,4,"app-two-entity-attribute-page",15)),t&2){let e=_(3);I(e.loading?0:-1),o(),I(e.loading?-1:1)}}function tc(t,c){t&1&&(d(0),l(1,"translate")),t&2&&f(" ",p(1,1,"USER_DETAIL.ASSIGNMENTS.MEMBER_RESOURCE_ATT")," ")}function ic(t,c){t&1&&b(0,"mat-spinner",14)}function nc(t,c){if(t&1&&b(0,"app-two-entity-attribute-page",16),t&2){let e=_(4);u("firstEntity","user")("firstEntityId",e.userId)("secondEntity","resource")("facilityId",e.selectedFacility.id)}}function oc(t,c){if(t&1&&(E(0,ic,1,0,"mat-spinner",14),E(1,nc,1,4,"app-two-entity-attribute-page",16)),t&2){let e=_(3);I(e.loading?0:-1),o(),I(e.loading?-1:1)}}function ac(t,c){t&1&&(r(0,"mat-tab-group",5)(1,"mat-tab"),S(2,Kp,2,3,"ng-template",8)(3,Qp,5,5,"ng-template",9),a(),r(4,"mat-tab"),S(5,Xp,2,3,"ng-template",8)(6,ec,2,2,"ng-template",9),a(),r(7,"mat-tab"),S(8,tc,2,3,"ng-template",8)(9,oc,2,2,"ng-template",9),a()())}function rc(t,c){t&1&&(r(0,"perun-web-apps-alert",6),d(1),l(2,"translate"),a()),t&2&&(o(),A(p(2,1,"USER_DETAIL.ASSIGNMENTS.NO_FACILITIES")))}function sc(t,c){if(t&1&&(r(0,"div")(1,"div",3),E(2,$p,1,1,"perun-web-apps-facility-search-select",4),a(),E(3,ac,10,0,"mat-tab-group",5),E(4,rc,3,3,"perun-web-apps-alert",6),a()),t&2){let e=_();o(2),I(e.initLoading||e.facilities.length===0?-1:2),o(),I(e.initLoading||e.facilities.length===0?-1:3),o(),I(!e.initLoading&&e.facilities.length===0?4:-1)}}var Da=(()=>{class t{constructor(e,n,i,s){this.route=e,this.facilityService=n,this.usersService=i,this.resourcesService=s,this.initLoading=!0,this.loading=!1,this.facilities=[],this.selectedFacility=null,this.member=null,this.resources=[]}ngOnInit(){this.initLoading=!0,this.route.parent.params.subscribe(e=>{this.userId=Number(e.userId),this.facilityService.getAssignedFacilitiesByUser(this.userId).subscribe({next:n=>{this.facilities=n,this.facilities.length&&this.loadFacility(this.facilities.sort(qi)[0]),this.initLoading=!1},error:()=>this.initLoading=!1})})}loadFacility(e){this.loading=!0,this.selectedFacility=e,this.usersService.getAssociatedResourcesForUser(this.selectedFacility.id,this.userId).subscribe({next:n=>{this.resourcesService.getRichResourcesByIds(n.map(i=>i.id)).subscribe({next:i=>{this.resources=i,this.loading=!1},error:()=>this.loading=!1})},error:()=>this.loading=!1})}static{this.\u0275fac=function(n){return new(n||t)(m(me),m($t),m(le),m(ji))}}static{this.\u0275cmp=D({type:t,selectors:[["app-perun-web-apps-user-assignments"]],decls:6,vars:5,consts:[["spinner1",""],[1,"page-title"],[4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[1,"d-flex"],[1,"w-50",3,"facilities"],["mat-stretch-tabs","false"],["alert_type","warn"],[1,"w-50",3,"facilitySelected","facilities"],["matTabLabel",""],["matTabContent",""],[1,"mt-4","subtitle"],[1,"position-relative","table-min-height"],[3,"loading","resources","displayColumns",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],[3,"loading","resources","displayColumns"],[1,"ms-auto","me-auto"],[3,"firstEntity","firstEntityId","secondEntity","specificSecondEntity"],[3,"firstEntity","firstEntityId","secondEntity","facilityId"]],template:function(n,i){if(n&1&&(r(0,"h1",1),d(1),l(2,"translate"),a(),S(3,zp,1,0,"ng-template",null,0,B)(5,sc,5,3,"div",2)),n&2){let s=R(4);o(),A(p(2,3,"USER_DETAIL.ASSIGNMENTS.TITLE")),o(4),u("perunWebAppsLoader",i.initLoading)("perunWebAppsLoaderIndicator",s)}},dependencies:[x,X,Q,pi,nt,Ze,et,tt,it,mt,dt,M,lo,N,ao,H,y],styles:[".subtitle[_ngcontent-%COMP%]{font-size:1.2rem}"]})}}return t})();function lc(t,c){t&1&&b(0,"mat-spinner",6)}function pc(t,c){if(t&1&&(r(0,"div",3),E(1,lc,1,0,"mat-spinner",6),a()),t&2){let e=_();o(),I(e.loading?1:-1)}}var xa=(()=>{class t{constructor(e,n,i,s){this.groupsManager=e,this.tasksManager=n,this.notificator=i,this.translate=s,this.loading=!0}ngOnInit(){this.loading=!0,this.groupsManager.isSuspendedGroupSynchronization().subscribe({next:e=>{this.groupSyncSuspended=e,this.tasksManager.isSuspendedTasksPropagation().subscribe({next:n=>{this.tasksPropSuspended=n,this.loading=!1},error:()=>{this.loading=!1}})},error:()=>{this.loading=!1}})}toggleGroupSuspension(){this.groupSyncSuspended=!this.groupSyncSuspended,this.groupSyncSuspended?this.groupsManager.suspendGroupSynchronization().subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("ADMIN.TASKS.SYNC_SUSPENDED_SUCCESS"))},error:()=>{this.groupSyncSuspended=!this.groupSyncSuspended}}):this.groupsManager.resumeGroupSynchronization().subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("ADMIN.TASKS.SYNC_RESUMED_SUCCESS"))},error:()=>{this.groupSyncSuspended=!this.groupSyncSuspended}})}toggleTaskSuspension(){this.tasksPropSuspended=!this.tasksPropSuspended,this.tasksPropSuspended?this.tasksManager.suspendTasksPropagation(!0).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("ADMIN.TASKS.PROPAGATION_SUSPENDED_SUCCESS"))},error:()=>{this.tasksPropSuspended=!this.tasksPropSuspended}}):this.tasksManager.resumeTasksPropagation(!0).subscribe({next:()=>{this.notificator.showSuccess(this.translate.instant("ADMIN.TASKS.PROPAGATION_RESUMED_SUCCESS"))},error:()=>{this.tasksPropSuspended=!this.tasksPropSuspended}})}static{this.\u0275fac=function(n){return new(n||t)(m(Fi),m(On),m(j),m(Y))}}static{this.\u0275cmp=D({type:t,selectors:[["app-admin-tasks"]],decls:16,vars:17,consts:[[1,"page-subtitle"],["alert_type","info"],[1,"toggles"],[1,"spinner-container"],["labelPosition","before",1,"mb-2",3,"change","disabled","checked"],["labelPosition","before",3,"change","disabled","checked"],[1,"ms-auto","me-auto"]],template:function(n,i){n&1&&(r(0,"div")(1,"h1",0),d(2),l(3,"translate"),a(),r(4,"div")(5,"perun-web-apps-alert",1),d(6),l(7,"translate"),a()(),r(8,"div",2),E(9,pc,2,1,"div",3),r(10,"mat-slide-toggle",4),C("change",function(){return i.toggleGroupSuspension()}),d(11),l(12,"translate"),a(),r(13,"mat-slide-toggle",5),C("change",function(){return i.toggleTaskSuspension()}),d(14),l(15,"translate"),a()()()),n&2&&(o(2),A(p(3,9,"ADMIN.TASKS.TITLE")),o(4),A(p(7,11,"ADMIN.TASKS.INFO")),o(3),I(i.loading?9:-1),o(),u("disabled",i.loading)("checked",i.groupSyncSuspended),o(),A(p(12,13,"ADMIN.TASKS.GROUP")),o(2),u("disabled",i.loading)("checked",i.tasksPropSuspended),o(),A(p(15,15,"ADMIN.TASKS.TASKS")))},dependencies:[x,Yt,Kt,X,Q,mt,dt,M,y],styles:[".toggles[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-left:1em}"]})}}return t})();function cc(t,c){if(t&1){let e=T();r(0,"button",8),C("click",function(){h(e);let i=_();return g(i.showDetails())}),d(1),l(2,"translate"),a()}t&2&&(o(),f(" ",p(2,1,"MEMBER_DETAIL.APPLICATIONS.SHOW_ALL_DETAILS")," "))}function dc(t,c){if(t&1){let e=T();r(0,"button",8),C("click",function(){h(e);let i=_();return g(i.showDetails())}),d(1),l(2,"translate"),a()}t&2&&(o(),f(" ",p(2,1,"MEMBER_DETAIL.APPLICATIONS.SHOW_LESS_DETAILS")," "))}function mc(t,c){t&1&&b(0,"perun-web-apps-loading-table")}function uc(t,c){if(t&1){let e=T();r(0,"perun-web-apps-applications-list",9),l(1,"async"),l(2,"async"),C("queryChanged",function(i){h(e);let s=_();return g(s.nextPage.next(i))})("downloadAll",function(i){h(e);let s=_();return g(s.downloadAll(i))}),a()}if(t&2){let e=_();u("loading",p(1,6,e.loading$))("user",e.user)("displayColumns",e.showAllDetails?e.detailedDisplayedColumns:e.displayedColumns)("applications",p(2,8,e.applicationsPage$))("filter",e.filterValue)("resetPagination",e.resetPagination)}}var Ma=(()=>{class t{constructor(e,n,i){this.entityStorageService=e,this.registrarService=n,this.translate=i,this.displayedColumns=["id","voName","groupName","createdAt","type","state","modifiedBy"],this.detailedDisplayedColumns=["id","createdAt","voId","voName","groupId","groupName","type","state","extSourceName","extSourceType","createdBy","modifiedBy","modifiedAt","fedInfo"],this.filterValue="",this.showAllDetails=!1,this.dateFrom=new Date("1970-01-01"),this.currentStates=["NEW","VERIFIED"],this.applications=[],this.nextPage=new G({}),this.applicationsPage$=this.nextPage.pipe(se(s=>this.registrarService.getApplicationsPage({query:{pageSize:s.pageSize,offset:s.offset,order:s.order,sortColumn:cn(s.sortColumn),searchString:s.searchString,getDetails:this.showAllDetails,dateFrom:hi(this.dateFrom),dateTo:hi(new Date),userId:this.user.id,states:this.currentStates}})),Nt(s=>{this.applications=s.data,setTimeout(()=>this.loadingSubject$.next(!1),200)}),at({data:[],totalCount:0,offset:0,pageSize:0})),this.loadingSubject$=new G(!1),this.resetPagination=new G(!1),this.loading$=Ot(this.loadingSubject$,this.nextPage.pipe(ht(()=>!0)))}ngOnInit(){this.user=this.entityStorageService.getEntity()}applyFilter(e){this.filterValue=e,this.refreshTable()}showDetails(){this.showAllDetails=!this.showAllDetails}refreshTable(){this.resetPagination.next(!0),this.nextPage.next(this.nextPage.value)}statesChanged(e){this.currentStates=e,this.refreshTable()}downloadAll(e){let n=this.nextPage.getValue();this.registrarService.getApplicationsPage({query:{order:n.order,pageSize:e.length,offset:0,searchString:n.searchString,sortColumn:cn(n.sortColumn),getDetails:this.showAllDetails,dateFrom:hi(this.dateFrom),dateTo:hi(new Date),userId:this.user.id,states:this.currentStates}}).subscribe({next:i=>{Yn(Fe(i.data,this.showAllDetails?this.detailedDisplayedColumns:this.displayedColumns,Kn),this.translate,e.format)}})}static{this.\u0275fac=function(n){return new(n||t)(m(ke),m(Gi),m(zt))}}static{this.\u0275cmp=D({type:t,selectors:[["app-user-applications"]],decls:14,vars:10,consts:[["spinner",""],[1,"page-subtitle"],[3,"refresh"],["mat-stroked-button","",1,"me-2"],[3,"filter","placeholder"],[3,"stateChanged"],[1,"position-relative","table-min-height"],[3,"loading","user","displayColumns","applications","filter","resetPagination","queryChanged","downloadAll",4,"perunWebAppsLoader","perunWebAppsLoaderIndicator"],["mat-stroked-button","",1,"me-2",3,"click"],[3,"queryChanged","downloadAll","loading","user","displayColumns","applications","filter","resetPagination"]],template:function(n,i){if(n&1){let s=T();r(0,"h1",1),d(1),l(2,"translate"),a(),r(3,"div")(4,"perun-web-apps-refresh-button",2),C("refresh",function(){return h(s),g(i.refreshTable())}),a(),E(5,cc,3,3,"button",3),E(6,dc,3,3,"button",3),r(7,"perun-web-apps-debounce-filter",4),C("filter",function(w){return h(s),g(i.applyFilter(w))}),a(),r(8,"perun-web-apps-application-state-selector",5),C("stateChanged",function(w){return h(s),g(i.statesChanged(w))}),a()(),S(9,mc,1,0,"ng-template",null,0,B),r(11,"div",6),S(12,uc,3,10,"perun-web-apps-applications-list",7),l(13,"async"),a()}if(n&2){let s=R(10);o(),A(p(2,6,"MEMBER_DETAIL.APPLICATIONS.TITLE")),o(4),I(i.showAllDetails?-1:5),o(),I(i.showAllDetails?6:-1),o(),u("placeholder","MEMBER_DETAIL.APPLICATIONS.FILTER"),o(5),u("perunWebAppsLoader",p(13,8,i.loading$))("perunWebAppsLoaderIndicator",s)}},dependencies:[x,L,O,de,ce,M,go,H,bo,N,He,y],encapsulation:2})}}return t})();var iv=[{path:"",component:Go,canActivateChild:[nn],children:[{path:"",component:jo,data:{animation:"AdminOverviewPage"}},{path:"attributes",component:Xo,data:{animation:"AdminAttributesPage"}},{path:"users",component:Mo,data:{animation:"AdminUsersPage"}},{path:"services",component:Bo,data:{animation:"AdminServicesPage"}},{path:"audit_log",component:Ca,data:{animation:"AdminAuditLogPage"}},{path:"ext_sources",component:ta,data:{animation:"AdminExtSourcesPage"}},{path:"consent_hubs",component:va,data:{animation:"AdminConsentHubsPage"}},{path:"searcher",component:Vo,data:{animation:"AdminSearcherPage"}},{path:"blocked_logins",component:Aa,data:{animation:"AdminBlockedLoginsPage"}},{path:"tasks",component:xa,data:{animation:"AdminTasksComponent"}}]},{path:"users/:userId",component:Jo,canActivateChild:[nn],children:[{path:"",component:Zo,data:{animation:"UserOverviewPage"}},{path:"accounts",component:fa,data:{animation:"UserAccountsPage"}},{path:"assignments",component:Da,data:{animation:"UserAssignmentsPage"}},{path:"attributes",component:ea,data:{animation:"UserAttributesPage"}},{path:"identities",component:oa,data:{animation:"UserIdentitiesPage"}},{path:"identities/:identityId",component:aa,data:{animation:"UserIdentityDetailPage"}},{path:"roles",component:ia,data:{animation:"UserRolesPage"}},{path:"service-identities",component:wo,data:{animation:"UserServiceIdentities"}},{path:"associated-users",component:Oo,data:{animation:"AssociatedUsersPage"}},{path:"bans",component:Ta,data:{animation:"UserBansPage"}},{path:"applications",component:Ma,data:{animation:"UserApplicationsPage"}}]},{path:"services/:serviceId",component:la,canActivateChild:[nn],children:[{path:"",component:pa,data:{animation:"ServiceOverviewPage"}},{path:"required-attributes",component:ma,data:{animation:"ServiceRequiredAttributesPage"}},{path:"destinations",component:ua,data:{animation:"ServiceDestinationsPage"}}]}];export{iv as adminRoutes};
