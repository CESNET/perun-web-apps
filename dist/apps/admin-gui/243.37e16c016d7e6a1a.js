"use strict";(self.webpackChunkadmin_gui=self.webpackChunkadmin_gui||[]).push([[243],{15003:($,Q,i)=>{i.d(Q,{G:()=>h});var b=i(5e3);let h=(()=>{class o{constructor(){this.entityDetailChange=new b.vpe}reloadEntityDetail(){this.entityDetailChange.emit()}}return o.\u0275fac=function(S){return new(S||o)},o.\u0275prov=b.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()},76023:($,Q,i)=>{i.d(Q,{y:()=>V});var b=i(112),h=i(10036),o=i(36908),p=i(5e3),S=i(11735),s=i(96214),t=i(64901),e=i(69808),a=i(20773),P=i(38383),Z=i(51062);function Y(y,J){1&y&&p._UZ(0,"mat-spinner",5)}const O=function(){return["id","fullName"]};function I(y,J){if(1&y){const f=p.EpF();p.TgZ(0,"perun-web-apps-members-list",6),p.NdJ("updateTable",function(){return p.CHM(f),p.oxw().refreshTable()}),p.qZA()}if(2&y){const f=p.oxw();p.Q6J("tableId",f.tableId)("disableRouting",!f.routeAuth)("filter",f.filterValue)("displayedColumns",p.DdM(5,O))("members",f.members)}}let V=(()=>{class y{constructor(f,L,N,H){this.route=f,this.resourceService=L,this.authResolver=N,this.entityStorageService=H,this.loading=!1,this.filterValue="",this.tableId=h.iQ}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.resourceService.getAssignedRichMembers(this.resource.id).subscribe(f=>{this.members=f,this.setAuthRights(),this.loading=!1})}setAuthRights(){0!==this.members.length&&(this.routeAuth=this.authResolver.isAuthorized("getMemberById_int_policy",[this.members[0]]))}applyFilter(f){this.filterValue=f}}return y.\u0275fac=function(f){return new(f||y)(p.Y36(S.gz),p.Y36(b.xk),p.Y36(o.x4),p.Y36(o.fb))},y.\u0275cmp=p.Xpm({type:y,selectors:[["app-resource-assigned-members"]],decls:7,vars:6,consts:[[1,"page-subtitle"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","disableRouting","filter","displayedColumns","members","updateTable",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"tableId","disableRouting","filter","displayedColumns","members","updateTable"]],template:function(f,L){1&f&&(p.TgZ(0,"h1",0),p._uU(1),p.ALo(2,"translate"),p.qZA(),p.TgZ(3,"perun-web-apps-refresh-button",1),p.NdJ("refresh",function(){return L.refreshTable()}),p.qZA(),p.TgZ(4,"perun-web-apps-debounce-filter",2),p.NdJ("filter",function(H){return L.applyFilter(H)}),p.qZA(),p.YNc(5,Y,1,0,"mat-spinner",3),p.YNc(6,I,1,6,"perun-web-apps-members-list",4)),2&f&&(p.xp6(1),p.Oqu(p.lcZ(2,4,"RESOURCE_DETAIL.ASSIGNED_MEMBERS.TITLE")),p.xp6(3),p.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_MEMBERS.FILTER"),p.xp6(1),p.Q6J("ngIf",L.loading),p.xp6(1),p.Q6J("ngIf",!L.loading))},directives:[s.t,t.P,e.O5,a.$g,P.O],pipes:[Z.X$],styles:[""]}),y})()},49546:($,Q,i)=>{i.d(Q,{D:()=>d});var b=i(112),h=i(10036),o=i(20449),p=i(9244),S=i(48966),s=i(36908),t=i(5e3),e=i(51062),a=i(69808),P=i(20773),Z=i(53251),Y=i(64901),O=i(60205),I=i(90439),V=i(47423);function y(l,g){1&l&&t._UZ(0,"mat-spinner",6)}const J=function(){return["id","name","enabled","description"]};function f(l,g){if(1&l&&t._UZ(0,"app-services-list",16),2&l){const u=t.oxw(2);t.Q6J("tableId",u.tableId)("disableRouting",!0)("displayedColumns",t.DdM(5,J))("selection",u.selection)("services",u.filteredServices)}}const L=function(){return["select","id","name","enabled","description"]};function N(l,g){if(1&l){const u=t.EpF();t.TgZ(0,"div",7),t.TgZ(1,"mat-tab-group",8),t.NdJ("selectedTabChange",function(){return t.CHM(u),t.oxw().tabChanged()}),t.TgZ(2,"mat-tab",9),t.ALo(3,"translate"),t.TgZ(4,"div",10),t.TgZ(5,"perun-web-apps-debounce-filter",11),t.NdJ("filter",function(G){return t.CHM(u),t.oxw().applyFilter(G)}),t.ALo(6,"translate"),t.qZA(),t.qZA(),t._UZ(7,"app-services-list",12),t.qZA(),t.TgZ(8,"mat-tab",9),t.ALo(9,"translate"),t.TgZ(10,"div",13),t.TgZ(11,"perun-web-apps-service-package-search-select",14),t.NdJ("packageSelected",function(G){return t.CHM(u),t.oxw().servicePackageSelected(G)}),t.qZA(),t.qZA(),t.YNc(12,f,1,6,"app-services-list",15),t.qZA(),t.qZA(),t.qZA()}if(2&l){const u=t.oxw();t.xp6(2),t.s9C("label",t.lcZ(3,12,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SELECT_SERVICE")),t.xp6(3),t.s9C("placeholder",t.lcZ(6,14,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.FILTER_DESCRIPTION")),t.xp6(2),t.Q6J("tableId",u.tableId)("disableRouting",!0)("displayedColumns",t.DdM(18,L))("filterValue",u.filterValue)("selection",u.selection)("services",u.unAssignedServices),t.xp6(1),t.s9C("label",t.lcZ(9,16,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SELECT_PACKAGE")),t.xp6(3),t.Q6J("selectedPackage",u.selectedPackage)("servicePackages",u.servicePackages),t.xp6(1),t.Q6J("ngIf",-1!==u.selectedPackage.id)}}let H=(()=>{class l{constructor(u,A,G,q,X,ce){this.dialogRef=u,this.data=A,this.notificator=G,this.translate=q,this.resourceManager=X,this.servicesManager=ce,this.loading=!1,this.unAssignedServices=[],this.filteredServices=[],this.servicePackages=[],this.selectedPackage={name:"Not selected",description:"",id:-1,beanName:"ServicePackage"},this.selection=new o.Ov(!0,[]),this.tableId=h.DR,this.filterValue=""}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resourceManager.getAssignedServicesToResource(this.data.resourceId).subscribe(u=>{this.servicesManager.getServices().subscribe(A=>{this.servicesManager.getServicesPackages().subscribe(G=>{this.servicePackages.push(this.selectedPackage),this.servicePackages=this.servicePackages.concat(G),this.unAssignedServices=A;for(const q of u)for(const X of A)q.id===X.id&&this.unAssignedServices.splice(this.unAssignedServices.indexOf(X),1);this.loading=!1})})})}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0,-1!==this.selectedPackage.id?this.addServicePackage():this.addServices()}addServicePackage(){this.resourceManager.assignServicesPackage(this.data.resourceId,this.selectedPackage.id).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.PACKAGE_SUCCESS_MESSAGE").subscribe(u=>{this.notificator.showSuccess(u),0!==this.selection.selected.length?this.addServices():this.dialogRef.close(!0)})},()=>this.loading=!1)}addServices(){const u=[];for(const A of this.selection.selected)u.push(A.id);this.resourceManager.assignServices(this.data.resourceId,u).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SERVICE_SUCCESS_MESSAGE").subscribe(A=>{this.notificator.showSuccess(A),this.dialogRef.close(!0)})},()=>this.loading=!1)}applyFilter(u){this.filterValue=u}servicePackageSelected(u){this.selectedPackage=u,-1!==u.id?this.servicesManager.getServicesFromServicesPackage(u.id).subscribe(A=>{this.filteredServices=A}):this.filteredServices=[]}tabChanged(){this.selection.clear(),this.filterValue="",this.selectedPackage=this.servicePackages[0]}}return l.\u0275fac=function(u){return new(u||l)(t.Y36(S.so),t.Y36(S.WI),t.Y36(s.V6),t.Y36(e.sK),t.Y36(b.xk),t.Y36(b.KK))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-perun-web-apps-assign-service-to-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[3,"selectedTabChange"],[3,"label"],[1,"mt-2"],[3,"placeholder","filter"],[3,"tableId","disableRouting","displayedColumns","filterValue","selection","services"],[1,"mt-3"],[3,"selectedPackage","servicePackages","packageSelected"],[3,"tableId","disableRouting","displayedColumns","selection","services",4,"ngIf"],[3,"tableId","disableRouting","displayedColumns","selection","services"]],template:function(u,A){1&u&&(t.TgZ(0,"div"),t.TgZ(1,"h1",0),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.YNc(4,y,1,0,"mat-spinner",1),t.YNc(5,N,13,19,"div",2),t.TgZ(6,"div",3),t.TgZ(7,"button",4),t.NdJ("click",function(){return A.onCancel()}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"button",5),t.NdJ("click",function(){return A.onAdd()}),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.qZA(),t.qZA()),2&u&&(t.Tol(A.theme),t.xp6(2),t.Oqu(t.lcZ(3,9,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.TITLE")),t.xp6(2),t.Q6J("ngIf",A.loading),t.xp6(1),t.Q6J("ngIf",!A.loading),t.xp6(3),t.hij(" ",t.lcZ(9,11,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.CANCEL_BUTTON")," "),t.xp6(2),t.Q6J("disabled",0===A.selection.selected.length&&-1===A.selectedPackage.id||A.loading),t.xp6(1),t.hij(" ",t.lcZ(12,13,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE."+(-1===A.selectedPackage.id?"ADD_SERVICES":"ADD_PACKAGE"))," "))},directives:[S.uh,a.O5,P.$g,S.xY,Z.SP,Z.uX,Y.P,O.Q,I.F,S.H8,V.lW],pipes:[e.X$],styles:[""]}),l})();var W=i(32075);function ee(l,g){1&l&&t._UZ(0,"mat-spinner",6)}function se(l,g){1&l&&t._UZ(0,"th",15)}function oe(l,g){if(1&l&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&l){const u=g.$implicit;t.xp6(1),t.Oqu(u.name)}}function U(l,g){1&l&&t._UZ(0,"tr",17)}function j(l,g){1&l&&t._UZ(0,"tr",18)}function m(l,g){if(1&l&&(t.TgZ(0,"div",7),t.TgZ(1,"p"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",8),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"table",9),t.ynx(8,10),t.YNc(9,se,1,0,"th",11),t.YNc(10,oe,2,1,"td",12),t.BQk(),t.YNc(11,U,1,0,"tr",13),t.YNc(12,j,1,0,"tr",14),t.qZA(),t.qZA()),2&l){const u=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,5,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DESCRIPTION")," "),t.xp6(3),t.hij(" ",t.lcZ(6,7,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.ASK")," "),t.xp6(2),t.Q6J("dataSource",u.dataSource),t.xp6(4),t.Q6J("matHeaderRowDef",u.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",u.displayedColumns)}}let C=(()=>{class l{constructor(u,A,G,q,X){this.dialogRef=u,this.data=A,this.notificator=G,this.translate=q,this.resourcesManager=X,this.displayedColumns=["name"]}ngOnInit(){this.theme=this.data.theme,this.dataSource=new W.by(this.data.services)}onSubmit(){this.loading=!0;const u=[];for(const A of this.data.services)u.push(A.id);this.resourcesManager.removeServices(this.data.resourceId,u).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.SUCCESS").subscribe(A=>{this.notificator.showSuccess(A),this.dialogRef.close(!0)})},()=>this.loading=!1)}onCancel(){this.dialogRef.close()}}return l.\u0275fac=function(u){return new(u||l)(t.Y36(S.so),t.Y36(S.WI),t.Y36(s.V6),t.Y36(e.sK),t.Y36(b.xk))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-perun-web-apps-remove-service-from-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(u,A){1&u&&(t.TgZ(0,"div"),t.TgZ(1,"h1",0),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.YNc(4,ee,1,0,"mat-spinner",1),t.YNc(5,m,13,9,"div",2),t.TgZ(6,"div",3),t.TgZ(7,"button",4),t.NdJ("click",function(){return A.onCancel()}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"button",5),t.NdJ("click",function(){return A.onSubmit()}),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.qZA(),t.qZA()),2&u&&(t.Tol(A.theme),t.xp6(2),t.Oqu(t.lcZ(3,9,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.TITLE")),t.xp6(2),t.Q6J("ngIf",A.loading),t.xp6(1),t.Q6J("ngIf",!A.loading),t.xp6(3),t.hij(" ",t.lcZ(9,11,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.CANCEL")," "),t.xp6(2),t.Q6J("disabled",A.loading),t.xp6(1),t.hij(" ",t.lcZ(12,13,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DELETE")," "))},directives:[S.uh,a.O5,P.$g,S.xY,W.BZ,W.w1,W.fO,W.ge,W.Dz,W.ev,W.as,W.XQ,W.nj,W.Gk,S.H8,V.lW],pipes:[e.X$],styles:[""]}),l})();var F=i(11735),z=i(96214),ie=i(7434);function ne(l,g){if(1&l){const u=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){return t.CHM(u),t.oxw().addService()}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&l&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_SERVICES.ADD_SERVICE"),"\n"))}function re(l,g){if(1&l){const u=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){return t.CHM(u),t.oxw().removeServices()}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&l){const u=t.oxw();t.Q6J("disabled",0===u.selected.selected.length),t.xp6(1),t.hij(" ",t.lcZ(2,2,"RESOURCE_DETAIL.ASSIGNED_SERVICES.REMOVE_SERVICE"),"\n")}}function x(l,g){1&l&&t._UZ(0,"mat-spinner",9)}function T(l,g){if(1&l&&t._UZ(0,"app-services-list",10),2&l){const u=t.oxw();t.Q6J("tableId",u.tableId)("services",u.assignedServices)("selection",u.selected)("filterValue",u.filterValue)("displayedColumns",u.displayedColumns)("disableRouting",!u.serviceRoutingAuth)}}let d=(()=>{class l{constructor(u,A,G,q,X){this.route=u,this.resourcesManager=A,this.dialog=G,this.guiAuthResolver=q,this.entityStorageService=X,this.assignedServices=[],this.selected=new o.Ov(!0,[]),this.tableId=h.uC,this.filterValue="",this.displayedColumns=["select","id","name","enabled","script","description"]}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.getDataForAuthorization(),this.loadAllServices()}loadAllServices(){this.loading=!0,this.resourcesManager.getAssignedServicesToResource(this.resource.id).subscribe(u=>{this.assignedServices=u,this.selected.clear(),this.loading=!1})}addService(){const u=(0,p.kZ)();u.width="800px",u.data={theme:"resource-theme",resourceId:this.resource.id},this.dialog.open(H,u).afterClosed().subscribe(G=>{G&&this.loadAllServices()})}removeServices(){const u=(0,p.kZ)();u.width="500px",u.data={theme:"resource-theme",resourceId:this.resource.id,services:this.selected.selected},this.dialog.open(C,u).afterClosed().subscribe(G=>{G&&this.loadAllServices()})}applyFilter(u){this.filterValue=u}getDataForAuthorization(){this.assignServiceAuth=this.guiAuthResolver.isAuthorized("assignServices_Resource_List<Service>_policy",[this.resource]),this.removeServiceAuth=this.guiAuthResolver.isAuthorized("removeServices_Resource_List<Service>_policy",[this.resource]),this.displayedColumns=this.removeServiceAuth?["select","id","name","enabled","script","description"]:["id","name","enabled","script","description"],this.serviceRoutingAuth=this.guiAuthResolver.isPerunAdminOrObserver()}}return l.\u0275fac=function(u){return new(u||l)(t.Y36(F.gz),t.Y36(b.xk),t.Y36(S.uw),t.Y36(s.x4),t.Y36(s.fb))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-perun-web-apps-resource-assigned-services"]],decls:9,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["class","action-button mr-2","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","services","selection","filterValue","displayedColumns","disableRouting",4,"ngIf"],["color","accent","mat-flat-button","",1,"action-button","mr-2",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"tableId","services","selection","filterValue","displayedColumns","disableRouting"]],template:function(u,A){1&u&&(t.TgZ(0,"h1",0),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.TgZ(3,"perun-web-apps-refresh-button",1),t.NdJ("refresh",function(){return A.loadAllServices()}),t.qZA(),t.YNc(4,ne,3,3,"button",2),t.YNc(5,re,3,4,"button",3),t.TgZ(6,"perun-web-apps-immediate-filter",4),t.NdJ("filter",function(q){return A.applyFilter(q)}),t.qZA(),t.YNc(7,x,1,0,"mat-spinner",5),t.YNc(8,T,1,6,"app-services-list",6)),2&u&&(t.xp6(1),t.Oqu(t.lcZ(2,6,"RESOURCE_DETAIL.ASSIGNED_SERVICES.TITLE")),t.xp6(3),t.Q6J("ngIf",A.assignServiceAuth),t.xp6(1),t.Q6J("ngIf",A.removeServiceAuth),t.xp6(1),t.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_SERVICES.FILTER_SERVICES"),t.xp6(1),t.Q6J("ngIf",A.loading),t.xp6(1),t.Q6J("ngIf",!A.loading))},directives:[z.t,a.O5,V.lW,ie.L,P.$g,O.Q],pipes:[e.X$],styles:[""]}),l})()},92090:($,Q,i)=>{i.d(Q,{X:()=>J});var b=i(36908),h=i(112),o=i(5e3),p=i(53251),S=i(12651),s=i(69808),t=i(19191),e=i(51062);function a(f,L){1&f&&(o._uU(0),o.ALo(1,"translate")),2&f&&o.hij(" ",o.lcZ(1,1,"RESOURCE_DETAIL.ENTITY")," ")}function P(f,L){if(1&f&&o._UZ(0,"app-one-entity-attribute-page",4),2&f){const N=o.oxw();o.Q6J("entity","resource")("entityId",N.resource.id)}}function Z(f,L){1&f&&(o._uU(0),o.ALo(1,"translate"),o.ALo(2,"translate")),2&f&&o.AsE(" ",o.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",o.lcZ(2,4,"MEMBER_DETAIL.ENTITY")," ")}function Y(f,L){if(1&f&&o._UZ(0,"app-two-entity-attribute-page",5),2&f){const N=o.oxw(2);o.Q6J("firstEntity","resource")("firstEntityId",N.resource.id)("secondEntity","member")}}function O(f,L){1&f&&(o.TgZ(0,"mat-tab"),o.YNc(1,Z,3,6,"ng-template",1),o.YNc(2,Y,1,3,"ng-template",2),o.qZA())}function I(f,L){1&f&&(o._uU(0),o.ALo(1,"translate"),o.ALo(2,"translate")),2&f&&o.AsE(" ",o.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",o.lcZ(2,4,"GROUP_DETAIL.ENTITY")," ")}function V(f,L){if(1&f&&o._UZ(0,"app-two-entity-attribute-page",5),2&f){const N=o.oxw(2);o.Q6J("firstEntity","resource")("firstEntityId",N.resource.id)("secondEntity","group")}}function y(f,L){1&f&&(o.TgZ(0,"mat-tab"),o.YNc(1,I,3,6,"ng-template",1),o.YNc(2,V,1,3,"ng-template",2),o.qZA())}let J=(()=>{class f{constructor(N,H,W){this.authResolver=N,this.resourceManager=H,this.entityStorageService=W}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.resourceGroupAttAuth=this.authResolver.isAuthorized("getGroupAssignments_Resource_policy",[this.resource]),this.resourceMemberAttAuth=this.authResolver.isAuthorized("getAssignedMembersWithStatus_Resource_policy",[this.resource])}}return f.\u0275fac=function(N){return new(N||f)(o.Y36(b.x4),o.Y36(h.xk),o.Y36(b.fb))},f.\u0275cmp=o.Xpm({type:f,selectors:[["app-resource-attributes"]],hostVars:2,hostBindings:function(N,H){2&N&&o.ekj("router-component",H.true)},decls:10,vars:5,consts:[[1,"page-subtitle"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entity","entityId"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(N,H){1&N&&(o.TgZ(0,"div"),o.TgZ(1,"h1",0),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"mat-tab-group"),o.TgZ(5,"mat-tab"),o.YNc(6,a,2,3,"ng-template",1),o.YNc(7,P,1,2,"ng-template",2),o.qZA(),o.YNc(8,O,3,0,"mat-tab",3),o.YNc(9,y,3,0,"mat-tab",3),o.qZA(),o.qZA()),2&N&&(o.xp6(2),o.Oqu(o.lcZ(3,3,"RESOURCE_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),o.xp6(6),o.Q6J("ngIf",H.resourceMemberAttAuth),o.xp6(1),o.Q6J("ngIf",H.resourceGroupAttAuth))},directives:[p.SP,p.uX,p.uD,p.Vc,S.t,s.O5,t.Y],pipes:[e.X$],styles:[""]}),f})()},98918:($,Q,i)=>{i.d(Q,{b:()=>re});var b=i(36769),h=i(69024),o=i(112),p=i(9244),S=i(36908),s=i(19516),t=i(84379),e=i(533),a=i(5e3),P=i(11735),Z=i(77968),Y=i(48966),O=i(15003),I=i(4235),V=i(69808),y=i(20773),J=i(25245),f=i(29772),L=i(47423),N=i(61283),H=i(51062);function W(x,T){1&x&&a._UZ(0,"mat-spinner",3)}function ee(x,T){if(1&x){const d=a.EpF();a.TgZ(0,"button",15),a.NdJ("click",function(){return a.CHM(d),a.oxw(2).editResource()}),a.TgZ(1,"mat-icon"),a._uU(2,"edit"),a.qZA(),a.qZA()}}function se(x,T){if(1&x){const d=a.EpF();a.TgZ(0,"button",16),a.NdJ("click",function(){return a.CHM(d),a.oxw(2).deleteResource()}),a.TgZ(1,"mat-icon"),a._uU(2,"delete_forever"),a.qZA(),a.qZA()}}const oe=function(x){return["/organizations",x]};function U(x,T){if(1&x&&(a.TgZ(0,"a",8),a._uU(1),a.qZA()),2&x){const d=a.oxw(2);a.Q6J("routerLink",a.VKq(2,oe,d.resource.vo.id)),a.xp6(1),a.Oqu(d.resource.vo.name)}}function j(x,T){if(1&x&&(a.TgZ(0,"span"),a._uU(1),a.qZA()),2&x){const d=a.oxw(2);a.xp6(1),a.hij(" ",d.resource.vo.name," ")}}const m=function(x){return["/facilities",x]};function C(x,T){if(1&x&&(a.TgZ(0,"a",8),a._uU(1),a.qZA()),2&x){const d=a.oxw(2);a.Q6J("routerLink",a.VKq(2,m,d.resource.facilityId)),a.xp6(1),a.Oqu(d.resource.facility.name)}}function F(x,T){if(1&x&&(a.TgZ(0,"span"),a._uU(1),a.qZA()),2&x){const d=a.oxw(2);a.xp6(1),a.hij(" ",d.resource.facility.name," ")}}const z=function(){return{color:"black"}},ie=function(x){return[x]};function ne(x,T){if(1&x&&(a.TgZ(0,"div"),a.TgZ(1,"div",4),a._UZ(2,"mat-icon",5),a.ALo(3,"translate"),a.TgZ(4,"div",6),a.TgZ(5,"div",7),a.TgZ(6,"a",8),a._uU(7),a.qZA(),a.TgZ(8,"span",9),a._uU(9),a.qZA(),a.YNc(10,ee,3,0,"button",10),a.YNc(11,se,3,0,"button",11),a.qZA(),a.TgZ(12,"div"),a._uU(13),a.ALo(14,"translate"),a.qZA(),a.TgZ(15,"span",12),a._uU(16),a.ALo(17,"translate"),a.ALo(18,"translate"),a.YNc(19,U,2,4,"a",13),a.YNc(20,j,2,1,"span",2),a._uU(21),a.ALo(22,"translate"),a.YNc(23,C,2,4,"a",14),a.YNc(24,F,2,1,"span",2),a._uU(25),a.ALo(26,"translate"),a.qZA(),a.qZA(),a.qZA(),a._UZ(27,"app-animated-router-outlet"),a.qZA()),2&x){const d=a.oxw();a.xp6(2),a.s9C("matTooltip",a.lcZ(3,20,"RESOURCE_DETAIL.ENTITY")),a.Q6J("ngStyle",a.DdM(32,z)),a.xp6(4),a.Q6J("routerLink",a.VKq(33,ie,d.baseUrl)),a.xp6(1),a.hij(" ",d.resource.name," "),a.xp6(2),a.hij(" \xa0#",d.resource.id," "),a.xp6(1),a.Q6J("ngIf",d.editResourceAuth),a.xp6(1),a.Q6J("ngIf",d.deleteAuth),a.xp6(2),a.AsE("",a.lcZ(14,22,"RESOURCE_DETAIL.UUID"),": ",d.resource.uuid,""),a.xp6(3),a.AsE(" ",a.lcZ(17,24,"RESOURCE_DETAIL.ENTITY"),", ",a.lcZ(18,26,"RESOURCE_DETAIL.VO"),": "),a.xp6(3),a.Q6J("ngIf",d.voLinkAuth),a.xp6(1),a.Q6J("ngIf",!d.voLinkAuth),a.xp6(1),a.AsE(" #",d.resource.voId,", ",a.lcZ(22,28,"RESOURCE_DETAIL.FACILITY"),": "),a.xp6(2),a.Q6J("ngIf",d.facilityLinkAuth),a.xp6(1),a.Q6J("ngIf",!d.facilityLinkAuth),a.xp6(1),a.lnq(" #",d.resource.facilityId,", ",a.lcZ(26,30,"RESOURCE_DETAIL.DESCRIPTION"),": ",d.resource.description," ")}}let re=(()=>{class x{constructor(d,l,g,u,A,G,q,X,ce,R,w){this.route=d,this.facilityManager=l,this.vosManagerService=g,this.resourcesManager=u,this.sideMenuService=A,this.sideMenuItemService=G,this.dialog=q,this.guiAuthResolver=X,this.router=ce,this.entityStorageService=R,this.reloadEntityDetail=w,this.underVoUrl=!1,this.deleteAuth=!1,this.baseUrl="",this.loading=!1}ngOnInit(){this.reloadData(),this.reloadEntityDetail.entityDetailChange.subscribe(()=>{this.reloadData()})}reloadData(){this.loading=!0,this.route.params.subscribe(d=>{this.resourcesManager.getRichResourceById(d.resourceId).subscribe(g=>{this.resource=g,this.entityStorageService.setEntity({id:g.id,voId:g.voId,facilityId:g.facilityId,beanName:"Resource"}),this.setAuth(),"facilities"===this.route.parent.snapshot.url[0].path?(this.baseUrl=(new s.r5).transform(g,!1),this.facilityManager.getFacilityById(g.facilityId).subscribe(u=>{this.facility=u,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)):(this.baseUrl=(new s.r5).transform(g,!0),this.vosManagerService.getVoById(g.voId).subscribe(u=>{this.vo=u,this.underVoUrl=!0,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)),(0,p.sF)("resources",this.resource)})})}setMenuItems(){let d;const l=this.sideMenuItemService.parseResource(this.resource,this.underVoUrl);d=this.underVoUrl?this.sideMenuItemService.parseVo(this.vo):this.sideMenuItemService.parseFacility(this.facility),this.sideMenuService.setAccessMenuItems([d,l])}setAuth(){this.facilityLinkAuth=this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.resource]),this.editResourceAuth=this.guiAuthResolver.isAuthorized("updateResource_Resource_policy",[this.resource]),this.voLinkAuth=this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.resource]),this.deleteAuth=this.guiAuthResolver.isAuthorized("deleteResource_Resource_policy",[this.resource])}editResource(){let d;this.resourcesManager.getResourceById(this.resource.id).subscribe(l=>{d=l;const g=(0,p.kZ)();g.width="450px",g.data={theme:"resource-theme",resource:d,dialogType:t.Eg.RESOURCE},this.dialog.open(t.rd,g).afterClosed().subscribe(A=>{A&&this.resourcesManager.getRichResourceById(this.resource.id).subscribe(G=>{this.resource=G,this.setMenuItems()})})})}deleteResource(){const d=(0,p.kZ)();d.width="500px",d.data={theme:"resource-theme",resources:[this.resource]},this.dialog.open(e.f,d).afterClosed().subscribe(g=>{g&&this.router.navigate(["../"],{relativeTo:this.route})})}}return x.\u0275fac=function(d){return new(d||x)(a.Y36(P.gz),a.Y36(o.IQ),a.Y36(o.YF),a.Y36(o.xk),a.Y36(Z.D),a.Y36(h.V),a.Y36(Y.uw),a.Y36(S.x4),a.Y36(P.F0),a.Y36(S.fb),a.Y36(O.G))},x.\u0275cmp=a.Xpm({type:x,selectors:[["app-resource-detail-page"]],decls:4,vars:2,consts:[[1,"container-fluid","pl-xl-5","pr-xl-5","resource-theme"],["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-resource-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],["queryParamsHandling","merge",1,"resource-link",3,"routerLink"],[1,"text-muted"],["mat-icon-button","","aria-label","Edit resource",3,"click",4,"ngIf"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"mt-1","entity-info"],["queryParamsHandling","merge","class","resource-link",3,"routerLink",4,"ngIf"],["class","resource-link","queryParamsHandling","merge",3,"routerLink",4,"ngIf"],["mat-icon-button","","aria-label","Edit resource",3,"click"],["mat-icon-button","",3,"click"]],template:function(d,l){1&d&&(a.TgZ(0,"div",0),a._UZ(1,"perun-web-apps-back-button"),a.YNc(2,W,1,0,"mat-spinner",1),a.YNc(3,ne,28,35,"div",2),a.qZA()),2&d&&(a.xp6(2),a.Q6J("ngIf",l.loading),a.xp6(1),a.Q6J("ngIf",!l.loading&&void 0!==l.resource))},directives:[I.W,V.O5,y.$g,J.Hw,f.gM,V.PC,P.yS,L.lW,N.A],pipes:[H.X$],styles:[".break-line[_ngcontent-%COMP%]{display:inline-block}"],data:{animation:[b.Ji]}}),x})()},258:($,Q,i)=>{i.d(Q,{K:()=>ce});var b=i(112),h=i(20449),o=i(48966),p=i(32075),S=i(36908),s=i(5e3),t=i(51062),e=i(69808),a=i(20773),P=i(47423);function Z(R,w){1&R&&s._UZ(0,"mat-spinner",6)}function Y(R,w){1&R&&s._UZ(0,"th",15)}function O(R,w){if(1&R&&(s.TgZ(0,"td",16),s._uU(1),s.qZA()),2&R){const c=w.$implicit;s.xp6(1),s.Oqu(c.name)}}function I(R,w){1&R&&s._UZ(0,"tr",17)}function V(R,w){1&R&&s._UZ(0,"tr",18)}function y(R,w){if(1&R&&(s.TgZ(0,"div",7),s.TgZ(1,"p"),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.TgZ(4,"div",8),s._uU(5),s.ALo(6,"translate"),s.qZA(),s.TgZ(7,"table",9),s.ynx(8,10),s.YNc(9,Y,1,0,"th",11),s.YNc(10,O,2,1,"td",12),s.BQk(),s.YNc(11,I,1,0,"tr",13),s.YNc(12,V,1,0,"tr",14),s.qZA(),s.qZA()),2&R){const c=s.oxw();s.xp6(2),s.hij(" ",s.lcZ(3,5,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DESCRIPTION")," "),s.xp6(3),s.hij(" ",s.lcZ(6,7,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.ASK")," "),s.xp6(2),s.Q6J("dataSource",c.dataSource),s.xp6(4),s.Q6J("matHeaderRowDef",c.displayedColumns),s.xp6(1),s.Q6J("matRowDefColumns",c.displayedColumns)}}let J=(()=>{class R{constructor(c,E,M,k,B){this.dialogRef=c,this.data=E,this.notificator=M,this.translate=k,this.resourceManager=B,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.dataSource=new p.by(this.data.groups)}onCancel(){this.dialogRef.close()}onSubmit(){const c=[];for(const E of this.data.groups)c.push(E.id);this.loading=!0,this.resourceManager.removeGroupsFromResource(c,this.data.resourceId).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUP_FROM_RESOURCE.SUCCESS").subscribe(E=>{this.notificator.showSuccess(E),this.dialogRef.close(!0)})},()=>this.loading=!1)}}return R.\u0275fac=function(c){return new(c||R)(s.Y36(o.so),s.Y36(o.WI),s.Y36(S.V6),s.Y36(t.sK),s.Y36(b.xk))},R.\u0275cmp=s.Xpm({type:R,selectors:[["app-perun-web-apps-remove-group-from-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(c,E){1&c&&(s.TgZ(0,"div"),s.TgZ(1,"h1",0),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.YNc(4,Z,1,0,"mat-spinner",1),s.YNc(5,y,13,9,"div",2),s.TgZ(6,"div",3),s.TgZ(7,"button",4),s.NdJ("click",function(){return E.onCancel()}),s._uU(8),s.ALo(9,"translate"),s.qZA(),s.TgZ(10,"button",5),s.NdJ("click",function(){return E.onSubmit()}),s._uU(11),s.ALo(12,"translate"),s.qZA(),s.qZA(),s.qZA()),2&c&&(s.Tol(E.theme),s.xp6(2),s.Oqu(s.lcZ(3,9,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.TITLE")),s.xp6(2),s.Q6J("ngIf",E.loading),s.xp6(1),s.Q6J("ngIf",!E.loading),s.xp6(3),s.hij(" ",s.lcZ(9,11,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.CANCEL")," "),s.xp6(2),s.Q6J("disabled",E.loading),s.xp6(1),s.hij(" ",s.lcZ(12,13,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DELETE")," "))},directives:[o.uh,e.O5,a.$g,o.xY,p.BZ,p.w1,p.fO,p.ge,p.Dz,p.ev,p.as,p.XQ,p.nj,p.Gk,o.H8,P.lW],pipes:[t.X$],styles:[""]}),R})();var f=i(10036),L=i(92081),N=i(64901),H=i(24179),W=i(32368),ee=i(93075);const se=["stepper"];function oe(R,w){1&R&&s._UZ(0,"mat-spinner",4)}function U(R,w){1&R&&(s._uU(0),s.ALo(1,"translate")),2&R&&s.Oqu(s.lcZ(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.GROUPS"))}function j(R,w){1&R&&(s._uU(0),s.ALo(1,"translate")),2&R&&s.Oqu(s.lcZ(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.OPTIONS"))}const m=function(){return["select","id","name","description"]};function C(R,w){if(1&R){const c=s.EpF();s.TgZ(0,"div",5),s.TgZ(1,"mat-stepper",6,7),s.TgZ(3,"mat-step",8),s.YNc(4,U,2,3,"ng-template",9),s.TgZ(5,"perun-web-apps-debounce-filter",10),s.NdJ("filter",function(M){return s.CHM(c),s.oxw().applyFilter(M)}),s.ALo(6,"translate"),s.qZA(),s._UZ(7,"perun-web-apps-groups-list",11),s.qZA(),s.TgZ(8,"mat-step"),s.YNc(9,j,2,3,"ng-template",9),s.TgZ(10,"mat-slide-toggle",12),s.NdJ("toggleChange",function(){return s.CHM(c),s.oxw().changeSubgroupsMessage()})("ngModelChange",function(M){return s.CHM(c),s.oxw().autoAssignSubgroups=M}),s._uU(11),s.ALo(12,"translate"),s.qZA(),s.TgZ(13,"div",13),s._UZ(14,"i",14),s.qZA(),s.TgZ(15,"mat-slide-toggle",12),s.NdJ("toggleChange",function(){return s.CHM(c),s.oxw().changeInactiveMessage()})("ngModelChange",function(M){return s.CHM(c),s.oxw().asActive=M}),s._uU(16),s.ALo(17,"translate"),s.qZA(),s.TgZ(18,"div",13),s._uU(19),s.qZA(),s.TgZ(20,"mat-slide-toggle",12),s.NdJ("toggleChange",function(){return s.CHM(c),s.oxw().changeAsyncMessage()})("ngModelChange",function(M){return s.CHM(c),s.oxw().async=M}),s._uU(21),s.ALo(22,"translate"),s.qZA(),s.TgZ(23,"div",13),s._uU(24),s.qZA(),s.qZA(),s.qZA(),s.qZA()}if(2&R){const c=s.oxw();s.xp6(1),s.Q6J("linear",!0),s.xp6(2),s.Q6J("completed",0!==c.selection.selected.length&&c.canAddGroups()),s.xp6(2),s.s9C("placeholder",s.lcZ(6,19,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.FILTER_DESCRIPTION")),s.xp6(2),s.Q6J("tableId",c.tableId)("groups",c.unAssignedGroups)("selection",c.selection)("filter",c.filterValue)("displayedColumns",s.DdM(27,m))("disableRouting",!0)("disableMembers",!1),s.xp6(3),s.Q6J("ngModel",c.autoAssignSubgroups),s.xp6(1),s.hij(" ",s.lcZ(12,21,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS")," "),s.xp6(3),s.Q6J("innerHTML",c.autoAssignHint,s.oJD),s.xp6(1),s.Q6J("ngModel",c.asActive),s.xp6(1),s.hij(" ",s.lcZ(17,23,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AS_ACTIVE")," "),s.xp6(3),s.hij(" ",c.asActiveHint," "),s.xp6(1),s.Q6J("ngModel",c.async),s.xp6(1),s.hij(" ",s.lcZ(22,25,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OPT")," "),s.xp6(3),s.hij(" ",c.asyncHint," ")}}function F(R,w){if(1&R){const c=s.EpF();s.TgZ(0,"button",20),s.NdJ("click",function(){return s.CHM(c),s.oxw(2).stepperPrevious()}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&R&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.BACK")," "))}function z(R,w){if(1&R){const c=s.EpF();s.TgZ(0,"button",21),s.NdJ("click",function(){return s.CHM(c),s.oxw(2).stepperNext()}),s._uU(1),s.ALo(2,"translate"),s.qZA()}if(2&R){const c=s.oxw(2);s.ekj("ml-2",void 0!==c.stepper&&0!==c.stepper.selectedIndex)("ml-auto",!(void 0!==c.stepper&&0!==c.stepper.selectedIndex)),s.Q6J("disabled",0===c.selection.selected.length||!c.canAddGroups()),s.xp6(1),s.hij(" ",s.lcZ(2,6,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.NEXT")," ")}}function ie(R,w){if(1&R){const c=s.EpF();s.TgZ(0,"button",22),s.NdJ("click",function(){return s.CHM(c),s.oxw(2).onAdd()}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&R&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ADD_BUTTON")," "))}function ne(R,w){if(1&R){const c=s.EpF();s.TgZ(0,"div",15),s.TgZ(1,"button",16),s.NdJ("click",function(){return s.CHM(c),s.oxw().onCancel()}),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.YNc(4,F,3,3,"button",17),s.YNc(5,z,3,8,"button",18),s.YNc(6,ie,3,3,"button",19),s.qZA()}if(2&R){const c=s.oxw();s.xp6(2),s.hij(" ",s.lcZ(3,4,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.CANCEL_BUTTON")," "),s.xp6(2),s.Q6J("ngIf",void 0!==c.stepper&&0!==c.stepper.selectedIndex),s.xp6(1),s.Q6J("ngIf",void 0!==c.stepper&&c.stepper.selectedIndex!==c.stepper._steps.length-1),s.xp6(1),s.Q6J("ngIf",void 0!==c.stepper&&c.stepper.selectedIndex===c.stepper._steps.length-1)}}let re=(()=>{class R{constructor(c,E,M,k,B,te,pe,me){this.dialogRef=c,this.data=E,this.notificator=M,this.translate=k,this.resourceManager=B,this.groupService=te,this.guiAuthResolver=pe,this.cd=me,this.loading=!1,this.unAssignedGroups=this.data.onlyAutoAssignedGroups,this.async=!0,this.autoAssignSubgroups=!1,this.asActive=!0,this.selection=new h.Ov(!0,[]),this.filterValue="",this.tableId=f.cL}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resource=this.data.resource,this.autoAssignHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT"),this.asActiveHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT"),this.asyncHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT"),this.resourceManager.getAssignedGroups(this.resource.id).subscribe(c=>{this.groupService.getAllGroups(this.resource.voId).subscribe(E=>{for(const M of E)-1===c.findIndex(k=>k.id===M.id)&&this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,M])&&this.unAssignedGroups.push(M);this.loading=!1,this.cd.detectChanges()},()=>this.loading=!1)},()=>this.loading=!1)}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0;const c=[];for(const E of this.selection.selected)c.push(E.id);this.resourceManager.assignGroupsToResource(c,this.resource.id,this.async,!this.asActive,this.autoAssignSubgroups).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.SUCCESS_MESSAGE").subscribe(E=>{this.notificator.showSuccess(E),this.dialogRef.close(!0)})},()=>this.loading=!1)}applyFilter(c){this.filterValue=c}canAddGroups(){let c=!0;return this.selection.selected.forEach(E=>{this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,E])||(c=!1)}),c}changeSubgroupsMessage(){this.autoAssignHint=this.translate.instant(this.autoAssignSubgroups?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_ON_HINT")}changeInactiveMessage(){this.asActiveHint=this.translate.instant(this.asActive?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT")}changeAsyncMessage(){this.asyncHint=this.translate.instant(this.async?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT")}stepperPrevious(){this.stepper.previous()}stepperNext(){this.stepper.next()}}return R.\u0275fac=function(c){return new(c||R)(s.Y36(o.so),s.Y36(o.WI),s.Y36(S.V6),s.Y36(t.sK),s.Y36(b.xk),s.Y36(b.ff),s.Y36(S.x4),s.Y36(s.sBO))},R.\u0275cmp=s.Xpm({type:R,selectors:[["app-perun-web-apps-assign-group-to-resource-dialog"]],viewQuery:function(c,E){if(1&c&&s.Gf(se,5),2&c){let M;s.iGM(M=s.CRH())&&(E.stepper=M.first)}},decls:7,vars:9,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","","class","dialog-container",4,"ngIf"],["mat-dialog-actions","",4,"ngIf"],[1,"mr-auto","ml-auto"],["mat-dialog-content","",1,"dialog-container"],[3,"linear"],["stepper",""],[3,"completed"],["matStepLabel",""],[3,"placeholder","filter"],[3,"tableId","groups","selection","filter","displayedColumns","disableRouting","disableMembers"],["labelPosition","before",1,"mt-3","slide-text",3,"ngModel","toggleChange","ngModelChange"],[1,"text-muted","new-line","mt-2"],[3,"innerHTML"],["mat-dialog-actions",""],["mat-flat-button","",3,"click"],["class","ml-auto","mat-flat-button","",3,"click",4,"ngIf"],["color","accent","mat-flat-button","","type","button",3,"ml-2","ml-auto","disabled","click",4,"ngIf"],["class","ml-2","color","accent","mat-flat-button","","type","button",3,"click",4,"ngIf"],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","","type","button",3,"disabled","click"],["color","accent","mat-flat-button","","type","button",1,"ml-2",3,"click"]],template:function(c,E){1&c&&(s.TgZ(0,"div"),s.TgZ(1,"h1",0),s._uU(2),s.ALo(3,"translate"),s.qZA(),s.YNc(4,oe,1,0,"mat-spinner",1),s.YNc(5,C,25,28,"div",2),s.YNc(6,ne,7,6,"div",3),s.qZA()),2&c&&(s.Tol(E.theme),s.xp6(2),s.Oqu(s.lcZ(3,7,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.TITLE")),s.xp6(2),s.Q6J("ngIf",E.loading),s.xp6(1),s.Q6J("ngIf",!E.loading),s.xp6(1),s.Q6J("ngIf",!E.loading&&E.stepper))},directives:[o.uh,e.O5,a.$g,o.xY,L.Vq,L.C0,L.VY,N.P,H.W,W.Rr,ee.JJ,ee.On,o.H8,P.lW],pipes:[t.X$],styles:[".slide-text[_ngcontent-%COMP%]{font-size:1.1rem}"]}),R})();var x=i(9244),T=i(64080),d=i(11735),l=i(96214),g=i(29772);function u(R,w){if(1&R){const c=s.EpF();s.TgZ(0,"button",8),s.NdJ("click",function(){return s.CHM(c),s.oxw().addGroup()}),s._uU(1),s.ALo(2,"translate"),s.qZA()}2&R&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_GROUPS.ADD_GROUP"),"\n"))}function A(R,w){1&R&&s._UZ(0,"mat-spinner",9)}const G=function(R){return[R]},q=function(){return["select","id","indirectGroupAssigment","name","status","description"]};function X(R,w){if(1&R){const c=s.EpF();s.TgZ(0,"perun-web-apps-groups-list",10),s.NdJ("refreshTable",function(){return s.CHM(c),s.oxw().loadAllGroups()}),s.qZA()}if(2&R){const c=s.oxw();s.Q6J("disableGroups",!0)("groupsToDisableCheckbox",c.groupsToDisable)("tableId",c.tableId)("groups",c.assignedGroups)("filter",c.filteredValue)("selection",c.selected)("disableMembers",!1)("resourceId",c.resource.id)("disableRouting",!!c.assignedGroups[0]&&!c.guiAuthResolver.isAuthorized("getGroupById_int_policy",s.VKq(10,G,c.assignedGroups[0])))("displayedColumns",s.DdM(12,q))}}let ce=(()=>{class R{constructor(c,E,M,k,B){this.route=c,this.resourcesManager=E,this.dialog=M,this.guiAuthResolver=k,this.entityStorageService=B,this.assignedGroups=[],this.selected=new h.Ov(!0,[]),this.filteredValue="",this.tableId=f.Ad}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.loadAllGroups()}loadAllGroups(){this.loading=!0,this.resourcesManager.getGroupAssignments(this.resource.id,[T.r.GROUP_SYNC_ENABLED]).subscribe(c=>{this.assignedGroups=c.map(B=>{const te=B.enrichedGroup.group;return te.status=B.status,te.failureCause=B.failureCause,te.sourceGroupId=B.sourceGroupId,te});const E=this.assignedGroups.map(B=>B.id),M=this.assignedGroups.filter((B,te)=>E.indexOf(B.id)===te),k=this.assignedGroups.filter((B,te)=>{const pe=E.indexOf(B.id);return pe!==te&&(null===B.sourceGroupId||null===this.assignedGroups[pe].sourceGroupId)}).map(B=>B.id);M.forEach(B=>{k.includes(B.id)&&(B.moreTypesOfAssignment=!0)}),this.assignedGroups=M,this.groupsToDisable=new Set(this.assignedGroups.filter(B=>!!B.sourceGroupId&&!B.moreTypesOfAssignment).map(B=>B.id)),this.selected.clear(),this.loading=!1})}addGroup(){const c=(0,x.kZ)();c.width="1000px",c.data={theme:"resource-theme",resource:this.resource,onlyAutoAssignedGroups:this.assignedGroups.filter(M=>this.groupsToDisable.has(M.id))},this.dialog.open(re,c).afterClosed().subscribe(M=>{M&&this.loadAllGroups()})}removeGroups(){const c=(0,x.kZ)();c.width="500px",c.data={resourceId:this.resource.id,groups:this.selected.selected,theme:"resource-theme"},this.dialog.open(J,c).afterClosed().subscribe(M=>{M&&this.loadAllGroups()})}canRemoveGroups(){let c=!0;return this.selected.selected.forEach(E=>{this.guiAuthResolver.isAuthorized("removeGroupsFromResource_List<Group>_Resource_policy",[this.resource,E])||(c=!1)}),c}applyFilter(c){this.filteredValue=c}}return R.\u0275fac=function(c){return new(c||R)(s.Y36(d.gz),s.Y36(b.xk),s.Y36(o.uw),s.Y36(S.x4),s.Y36(S.fb))},R.\u0275cmp=s.Xpm({type:R,selectors:[["app-perun-web-apps-resource-groups"]],decls:13,vars:17,consts:[[1,"page-subtitle"],[3,"refresh"],["class","action-button","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","mat-flat-button","",1,"ml-2","mr-2",3,"disabled","click"],[3,"matTooltipDisabled","matTooltip"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"disableGroups","groupsToDisableCheckbox","tableId","groups","filter","selection","disableMembers","resourceId","disableRouting","displayedColumns","refreshTable",4,"ngIf"],["color","accent","mat-flat-button","",1,"action-button",3,"click"],[1,"ml-auto","mr-auto"],[3,"disableGroups","groupsToDisableCheckbox","tableId","groups","filter","selection","disableMembers","resourceId","disableRouting","displayedColumns","refreshTable"]],template:function(c,E){1&c&&(s.TgZ(0,"h1",0),s._uU(1),s.ALo(2,"translate"),s.qZA(),s.TgZ(3,"perun-web-apps-refresh-button",1),s.NdJ("refresh",function(){return E.loadAllGroups()}),s.qZA(),s.YNc(4,u,3,3,"button",2),s.TgZ(5,"button",3),s.NdJ("click",function(){return E.removeGroups()}),s.TgZ(6,"span",4),s.ALo(7,"translate"),s._uU(8),s.ALo(9,"translate"),s.qZA(),s.qZA(),s.TgZ(10,"perun-web-apps-debounce-filter",5),s.NdJ("filter",function(k){return E.applyFilter(k)}),s.qZA(),s.YNc(11,A,1,0,"mat-spinner",6),s.YNc(12,X,1,13,"perun-web-apps-groups-list",7)),2&c&&(s.xp6(1),s.Oqu(s.lcZ(2,9,"RESOURCE_DETAIL.ASSIGNED_GROUPS.TITLE")),s.xp6(3),s.Q6J("ngIf",E.guiAuthResolver.isAuthorized("getAllGroups_Vo_policy",s.VKq(15,G,E.resource))),s.xp6(1),s.Q6J("disabled",0===E.selected.selected.length||!E.canRemoveGroups()),s.xp6(1),s.s9C("matTooltip",s.lcZ(7,11,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_TOOLTIP")),s.Q6J("matTooltipDisabled",E.canRemoveGroups()),s.xp6(2),s.hij(" ",s.lcZ(9,13,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_GROUP")," "),s.xp6(2),s.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_GROUPS.FILTER_GROUPS"),s.xp6(1),s.Q6J("ngIf",E.loading),s.xp6(1),s.Q6J("ngIf",!E.loading))},directives:[l.t,e.O5,P.lW,g.gM,N.P,a.$g,H.W],pipes:[t.X$],styles:[""]}),R})()},4675:($,Q,i)=>{i.d(Q,{H:()=>P});var b=i(112),h=i(36908),o=i(5e3),p=i(11735),S=i(69808),s=i(20773),t=i(71135);function e(Z,Y){1&Z&&o._UZ(0,"mat-spinner",2)}function a(Z,Y){if(1&Z&&(o.TgZ(0,"div"),o._UZ(1,"perun-web-apps-menu-buttons-field",3),o.qZA()),2&Z){const O=o.oxw();o.xp6(1),o.Q6J("items",O.navItems)("size","small")}}let P=(()=>{class Z{constructor(O,I,V,y){this.resourcesManager=O,this.route=I,this.guiAuthResolver=V,this.entityStorageService=y,this.navItems=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.initItems("facilities"!==this.route.parent.parent.snapshot.url[0].path),this.loading=!1}initItems(O){const I=O?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`;this.navItems=[],this.guiAuthResolver.isAuthorized("getAssignedGroups_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-group",url:`${I}/resources/${this.resource.id}/groups`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_GROUPS",style:"resource-btn"}),this.guiAuthResolver.isAuthorized("getAssignedServices_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-service",url:`/${I}/resources/${this.resource.id}/services`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_SERVICES",style:"resource-btn"}),this.guiAuthResolver.isAuthorized("getAssignedMembers_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-user",url:`${I}/resources/${this.resource.id}/members`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_MEMBERS",style:"resource-btn"}),this.guiAuthResolver.isAuthorized("getAllResourcesTagsForResource_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-resource-tags",url:`${I}/resources/${this.resource.id}/tags`,label:"MENU_ITEMS.RESOURCE.RESOURCE_TAGS",style:"resource-btn"}),this.navItems.push({cssIcon:"perun-attributes",url:`${I}/resources/${this.resource.id}/attributes`,label:"MENU_ITEMS.RESOURCE.ATTRIBUTES",style:"resource-btn"}),this.guiAuthResolver.isManagerPagePrivileged(this.resource)&&this.navItems.push({cssIcon:"perun-settings2",url:`${I}/resources/${this.resource.id}/settings`,label:"MENU_ITEMS.RESOURCE.SETTINGS",style:"resource-btn"})}}return Z.\u0275fac=function(O){return new(O||Z)(o.Y36(b.xk),o.Y36(p.gz),o.Y36(h.x4),o.Y36(h.fb))},Z.\u0275cmp=o.Xpm({type:Z,selectors:[["app-resource-overview"]],hostVars:2,hostBindings:function(O,I){2&O&&o.ekj("router-component",I.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(O,I){1&O&&(o.YNc(0,e,1,0,"mat-spinner",0),o.YNc(1,a,2,2,"div",1)),2&O&&(o.Q6J("ngIf",I.loading),o.xp6(1),o.Q6J("ngIf",!I.loading))},directives:[S.O5,s.$g,t.L],styles:[""]}),Z})()},20057:($,Q,i)=>{i.d(Q,{O:()=>p});var b=i(36908),h=i(5e3),o=i(69815);let p=(()=>{class S{constructor(t,e){this.guiAuthResolver=t,this.entityStorageService=e,this.availableRoles=[],this.type="Resource",this.theme="resource-theme"}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Resource")}}return S.\u0275fac=function(t){return new(t||S)(h.Y36(b.x4),h.Y36(b.fb))},S.\u0275cmp=h.Xpm({type:S,selectors:[["app-resource-settings-managers"]],decls:1,vars:4,consts:[[3,"complementaryObject","complementaryObjectType","theme","availableRoles"]],template:function(t,e){1&t&&h._UZ(0,"app-managers-page",0),2&t&&h.Q6J("complementaryObject",e.resource)("complementaryObjectType",e.type)("theme",e.theme)("availableRoles",e.availableRoles)},directives:[o.s],styles:[""]}),S})()},16500:($,Q,i)=>{i.d(Q,{h:()=>P});var b=i(112),h=i(36908),o=i(5e3),p=i(11735),S=i(69808),s=i(20773),t=i(71135);function e(Z,Y){1&Z&&o._UZ(0,"mat-spinner",2)}function a(Z,Y){if(1&Z&&(o.TgZ(0,"div"),o._UZ(1,"perun-web-apps-menu-buttons-field",3),o.qZA()),2&Z){const O=o.oxw();o.xp6(1),o.Q6J("items",O.items)("size","small")}}let P=(()=>{class Z{constructor(O,I,V,y){this.route=O,this.resourceManager=I,this.authResolver=V,this.entityStorageService=y,this.items=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.initItems("facilities"!==this.route.parent.parent.parent.snapshot.url[0].path),this.loading=!1}initItems(O){this.items=[],this.authResolver.isManagerPagePrivileged(this.resource)&&this.items.push({cssIcon:"perun-manager",url:`${O?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/managers`,label:"MENU_ITEMS.RESOURCE.MANAGERS",style:"resource-btn"})}}return Z.\u0275fac=function(O){return new(O||Z)(o.Y36(p.gz),o.Y36(b.xk),o.Y36(h.x4),o.Y36(h.fb))},Z.\u0275cmp=o.Xpm({type:Z,selectors:[["app-resource-settings-overview"]],hostVars:2,hostBindings:function(O,I){2&O&&o.ekj("router-component",I.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(O,I){1&O&&(o.YNc(0,e,1,0,"mat-spinner",0),o.YNc(1,a,2,2,"div",1)),2&O&&(o.Q6J("ngIf",I.loading),o.xp6(1),o.Q6J("ngIf",!I.loading))},directives:[S.O5,s.$g,t.L],styles:[""]}),Z})()},60113:($,Q,i)=>{i.d(Q,{t:()=>p});var b=i(36769),h=i(5e3),o=i(61283);let p=(()=>{class S{constructor(){}}return S.\u0275fac=function(t){return new(t||S)},S.\u0275cmp=h.Xpm({type:S,selectors:[["app-resource-settings"]],hostVars:2,hostBindings:function(t,e){2&t&&h.ekj("router-component",e.true)},decls:1,vars:0,template:function(t,e){1&t&&h._UZ(0,"app-animated-router-outlet")},directives:[o.A],styles:[""],data:{animation:[b.Ji]}}),S})()},20872:($,Q,i)=>{i.d(Q,{v:()=>oe});var b=i(112),h=i(20449),o=i(10036),p=i(9244),S=i(36908),s=i(84379),t=i(48966),e=i(5e3),a=i(69808),P=i(20773),Z=i(17672),Y=i(47423),O=i(51062);function I(U,j){1&U&&e._UZ(0,"mat-spinner",8)}function V(U,j){if(1&U&&e._UZ(0,"app-resources-tags-list",9),2&U){const m=e.oxw();e.Q6J("selection",m.selection)("tableId",m.tableId)("resourceTags",m.resourceTags)("filterValue",m.filterValue)("displayedColumns",m.displayedColumns)("entity","resource")}}let y=(()=>{class U{constructor(m,C,F){this.dialogRef=m,this.data=C,this.resourcesManager=F,this.tableId=o.g,this.selection=new h.Ov(!0,[]),this.resourceTags=[],this.displayedColumns=["select","id","name"]}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.voId=this.data.voId,this.resourceId=this.data.resourceId,this.assignedTags=this.data.assignedTags,this.resourcesManager.getAllResourcesTagsForVo(this.voId).subscribe(m=>{this.resourceTags=m.filter(C=>this.assignedTags.map(F=>F.id).indexOf(C.id)<=-1),this.loading=!1})}onCancel(){this.dialogRef.close(!1)}onSubmit(m){if(0===m.length)return this.dialogRef.close(!0);const C=m.pop();this.resourcesManager.assignResourceTagToResource({resource:this.resourceId,resourceTag:C}).subscribe(()=>{this.onSubmit(m)})}applyFilter(m){this.filterValue=m}}return U.\u0275fac=function(m){return new(m||U)(e.Y36(t.so),e.Y36(t.WI),e.Y36(b.xk))},U.\u0275cmp=e.Xpm({type:U,selectors:[["app-add-resource-tag-to-resource-dialog"]],decls:15,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],[3,"selection","tableId","resourceTags","filterValue","displayedColumns","entity",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],[3,"selection","tableId","resourceTags","filterValue","displayedColumns","entity"]],template:function(m,C){1&m&&(e.TgZ(0,"div"),e.TgZ(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1),e.TgZ(5,"div",2),e.YNc(6,I,1,0,"mat-spinner",3),e.qZA(),e.YNc(7,V,1,6,"app-resources-tags-list",4),e.qZA(),e.TgZ(8,"div",5),e.TgZ(9,"button",6),e.NdJ("click",function(){return C.onCancel()}),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"button",7),e.NdJ("click",function(){return C.onSubmit(C.selection.selected)}),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.qZA(),e.qZA()),2&m&&(e.Tol(C.theme),e.xp6(2),e.Oqu(e.lcZ(3,9,"RESOURCE_DETAIL.TAGS.ADD_TAGS")),e.xp6(4),e.Q6J("ngIf",C.loading),e.xp6(1),e.Q6J("ngIf",!C.loading),e.xp6(3),e.hij(" ",e.lcZ(11,11,"RESOURCE_DETAIL.TAGS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",C.loading||0===C.resourceTags.length),e.xp6(1),e.hij(" ",e.lcZ(14,13,"RESOURCE_DETAIL.TAGS.ADD_BUTTON")," "))},directives:[t.uh,t.xY,a.O5,P.$g,Z.o,t.H8,Y.lW],pipes:[O.X$],styles:[""]}),U})();var J=i(17584),f=i(96214),L=i(7434);function N(U,j){if(1&U){const m=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){return e.CHM(m),e.oxw().create()}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&U&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.CREATE_BUTTON"),"\n"))}function H(U,j){if(1&U){const m=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(){return e.CHM(m),e.oxw().addTag()}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&U&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"RESOURCE_DETAIL.TAGS.ADD_BUTTON"),"\n"))}function W(U,j){if(1&U){const m=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){return e.CHM(m),e.oxw().removeTags()}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&U){const m=e.oxw();e.Q6J("disabled",0===m.selection.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"RESOURCE_DETAIL.TAGS.REMOVE_BUTTON"),"\n")}}function ee(U,j){1&U&&e._UZ(0,"mat-spinner",9)}function se(U,j){if(1&U&&e._UZ(0,"app-resources-tags-list",10),2&U){const m=e.oxw();e.Q6J("selection",m.selection)("tableId",m.tableId)("resourceTags",m.resourceTags)("filterValue",m.filterValue)("displayedColumns",m.displayedColumns)("entity","resource")}}let oe=(()=>{class U{constructor(m,C,F,z,ie,ne){this.authResolver=m,this.resourcesManager=C,this.dialog=F,this.notificator=z,this.translate=ie,this.entityStorageService=ne,this.loading=!1,this.resourceTags=[],this.selection=new h.Ov(!0,[]),this.tableId=o.M8,this.displayedColumns=[]}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.setAuthRights(),this.updateData()}removeTags(){const m=(0,p.kZ)();m.width="450px",m.data={items:this.selection.selected.map(F=>F.tagName),title:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_TITLE",description:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_DESCRIPTION",theme:"resource-theme"},this.dialog.open(s.Tf,m).afterClosed().subscribe(F=>{F&&this.removeTag(this.selection.selected)})}removeTag(m){if(0===m.length)return this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.REMOVED_SUCCESSFULLY")),this.updateData();const C=m.pop();this.resourcesManager.removeResourceTagFromResource({resource:this.resource.id,resourceTag:C}).subscribe(()=>{this.removeTag(m)})}addTag(){const m=(0,p.kZ)();m.width="600px",m.data={voId:this.resource.voId,resourceId:this.resource.id,assignedTags:this.resourceTags,theme:"resource-theme"},this.dialog.open(y,m).afterClosed().subscribe(F=>{F&&(this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.ADDED_SUCCESSFULLY")),this.updateData())})}create(){const m=(0,p.kZ)();m.width="450px",m.data={voId:this.resource.voId,theme:"resource-theme"},this.dialog.open(J.p,m).afterClosed().subscribe(F=>{F&&(this.translate.get("VO_DETAIL.RESOURCES.TAGS.CREATE_SUCCESS").subscribe(z=>{this.notificator.showSuccess(z)}),this.updateData())})}updateData(){this.loading=!0,this.selection.clear(),this.resourcesManager.getAllResourcesTagsForResource(this.resource.id).subscribe(m=>{this.resourceTags=m,this.selection.clear(),this.loading=!1})}setAuthRights(){const m={id:this.resource.voId,beanName:"Vo"};this.displayedColumns=[],this.createAuth=this.authResolver.isAuthorized("createResourceTag_ResourceTag_Vo_policy",[m]),this.addAuth=this.authResolver.isAuthorized("assignResourceTagToResource_ResourceTag_Resource_policy",[this.resource]),this.removeAuth=this.authResolver.isAuthorized("removeResourceTagFromResource_ResourceTag_Resource_policy",[this.resource]),this.displayedColumns=this.removeAuth?["select","id","name"]:["id","name"]}applyFilter(m){this.filterValue=m}}return U.\u0275fac=function(m){return new(m||U)(e.Y36(S.x4),e.Y36(b.xk),e.Y36(t.uw),e.Y36(S.V6),e.Y36(O.sK),e.Y36(S.fb))},U.\u0275cmp=e.Xpm({type:U,selectors:[["app-perun-web-apps-resource-tags"]],decls:10,vars:9,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","class","mr-2 action-button","color","accent",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"selection","tableId","resourceTags","filterValue","displayedColumns","entity",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2","action-button",3,"click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"selection","tableId","resourceTags","filterValue","displayedColumns","entity"]],template:function(m,C){1&m&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"perun-web-apps-refresh-button",1),e.NdJ("refresh",function(){return C.updateData()}),e.qZA(),e.YNc(4,N,3,3,"button",2),e.YNc(5,H,3,3,"button",2),e.YNc(6,W,3,4,"button",3),e.TgZ(7,"perun-web-apps-immediate-filter",4),e.NdJ("filter",function(z){return C.applyFilter(z)}),e.qZA(),e.YNc(8,ee,1,0,"mat-spinner",5),e.YNc(9,se,1,6,"app-resources-tags-list",6)),2&m&&(e.xp6(1),e.Oqu(e.lcZ(2,7,"RESOURCE_DETAIL.TAGS.TITLE")),e.xp6(3),e.Q6J("ngIf",C.createAuth),e.xp6(1),e.Q6J("ngIf",C.addAuth),e.xp6(1),e.Q6J("ngIf",C.removeAuth),e.xp6(1),e.Q6J("placeholder","RESOURCE_DETAIL.TAGS.SEARCH"),e.xp6(1),e.Q6J("ngIf",C.loading),e.xp6(1),e.Q6J("ngIf",!C.loading))},directives:[f.t,a.O5,Y.lW,L.L,P.$g,Z.o],pipes:[O.X$],styles:[""]}),U})()},17584:($,Q,i)=>{i.d(Q,{p:()=>O});var b=i(48966),h=i(112),o=i(5e3),p=i(69808),S=i(20773),s=i(67322),t=i(98833),e=i(93075),a=i(47423),P=i(51062);function Z(I,V){1&I&&o._UZ(0,"mat-spinner",6)}function Y(I,V){if(1&I){const y=o.EpF();o.TgZ(0,"div",7),o.TgZ(1,"mat-form-field"),o.TgZ(2,"input",8),o.NdJ("ngModelChange",function(f){return o.CHM(y),o.oxw().name=f}),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"mat-error"),o._uU(5),o.ALo(6,"translate"),o.qZA(),o.qZA(),o.qZA()}if(2&I){const y=o.oxw();o.xp6(2),o.s9C("placeholder",o.lcZ(3,3,"DIALOGS.CREATE_RESOURCE_TAG.NAME")),o.Q6J("ngModel",y.name),o.xp6(3),o.Oqu(o.lcZ(6,5,"DIALOGS.CREATE_RESOURCE_TAG.EMPTY_NAME"))}}let O=(()=>{class I{constructor(y,J,f){this.dialogRef=y,this.data=J,this.resourceManager=f,this.name="",this.loading=!1}ngOnInit(){this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){""!==this.name&&(this.loading=!0,this.resourceManager.createResourceTagWithTagName(this.name,this.data.voId).subscribe(()=>{this.dialogRef.close(!0)},()=>this.loading=!1))}}return I.\u0275fac=function(y){return new(y||I)(o.Y36(b.so),o.Y36(b.WI),o.Y36(h.xk))},I.\u0275cmp=o.Xpm({type:I,selectors:[["app-create-resource-tag-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-content","","class","dialog-container",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content","",1,"dialog-container"],["matInput","","required","",3,"placeholder","ngModel","ngModelChange"]],template:function(y,J){1&y&&(o.TgZ(0,"div"),o.TgZ(1,"h1",0),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.YNc(4,Z,1,0,"mat-spinner",1),o.YNc(5,Y,7,7,"div",2),o.TgZ(6,"div",3),o.TgZ(7,"button",4),o.NdJ("click",function(){return J.onCancel()}),o._uU(8),o.ALo(9,"translate"),o.qZA(),o.TgZ(10,"button",5),o.NdJ("click",function(){return J.onSubmit()}),o._uU(11),o.ALo(12,"translate"),o.qZA(),o.qZA(),o.qZA()),2&y&&(o.Tol(J.theme),o.xp6(2),o.Oqu(o.lcZ(3,9,"DIALOGS.CREATE_RESOURCE_TAG.TITLE")),o.xp6(2),o.Q6J("ngIf",J.loading),o.xp6(1),o.Q6J("ngIf",!J.loading),o.xp6(3),o.hij(" ",o.lcZ(9,11,"DIALOGS.CREATE_RESOURCE_TAG.CANCEL")," "),o.xp6(2),o.Q6J("disabled",J.loading),o.xp6(1),o.hij(" ",o.lcZ(12,13,"DIALOGS.CREATE_RESOURCE_TAG.CREATE")," "))},directives:[b.uh,p.O5,S.$g,b.xY,s.KE,t.Nt,e.Fj,e.Q7,e.JJ,e.On,s.TO,b.H8,a.lW],pipes:[P.X$],styles:[""]}),I})()},69815:($,Q,i)=>{i.d(Q,{s:()=>Ne});var b=i(20449),h=i(48966),o=i(36908),p=i(112),S=i(10036),s=i(64080),t=i(93075),e=i(5e3),a=i(51062),P=i(11735),Z=i(67322),Y=i(74107),O=i(69808),I=i(90508),V=i(98833),y=i(50301),J=i(47423),f=i(20773),L=i(98380),N=i(64877);let H=(()=>{class r{constructor(n){this.translate=n,this.prefix="ROLES."}transform(n){const _=this.prefix.concat(n);return this.translate.instant(_)}}return r.\u0275fac=function(n){return new(n||r)(e.Y36(a.sK,16))},r.\u0275pipe=e.Yjl({name:"displayedRole",type:r,pure:!0}),r})();function W(r,v){if(1&r&&(e.TgZ(0,"mat-option",15),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&r){const n=v.$implicit;e.Q6J("value",n),e.xp6(1),e.Oqu(e.lcZ(2,2,n))}}function ee(r,v){1&r&&e._UZ(0,"mat-spinner",16)}function se(r,v){1&r&&(e.TgZ(0,"app-alert",20),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"DIALOGS.ADD_MANAGERS.NO_USERS_FOUND")," "))}const oe=function(){return["select","id","name","email","logins","organization"]};function U(r,v){if(1&r&&e._UZ(0,"app-users-list",21),2&r){const n=e.oxw(2);e.Q6J("tableId",n.tableId)("disableRouting",!0)("selection",n.selection)("displayedColumns",e.DdM(5,oe))("users",n.users)}}function j(r,v){if(1&r&&(e.TgZ(0,"div",17),e.YNc(1,se,3,3,"app-alert",18),e.YNc(2,U,1,6,"app-users-list",19),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",0===n.users.length&&n.firstSearchDone),e.xp6(1),e.Q6J("ngIf",0!==n.users.length)}}let m=(()=>{class r{constructor(n,_,D,K,ae,le,ue,he,fe){this.dialogRef=n,this.data=_,this.authzService=D,this.usersService=K,this.translate=ae,this.notificator=le,this.storeService=ue,this.route=he,this.router=fe,this.selection=new b.Ov(!0,[]),this.users=[],this.firstSearchDone=!1,this.tableId=S.H2,ae.get("DIALOGS.ADD_MANAGERS.TITLE").subscribe(_e=>this.title=_e),ae.get("DIALOGS.ADD_MANAGERS.SUCCESS").subscribe(_e=>this.successMessage=_e)}ngOnInit(){this.theme=this.data.theme,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.searchCtrl=new t.NI("",[t.kI.required,t.kI.pattern(".*[\\S]+.*")])}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.setRoleWithUserComplementaryObject({role:this.selectedRole,users:this.selection.selected.map(n=>n.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)}onSearchByString(){if(this.searchCtrl.invalid)return void this.searchCtrl.markAllAsTouched();this.loading=!0,this.selection.clear();let n=[s.r.USER_DEF_ORGANIZATION,s.r.USER_DEF_PREFERRED_MAIL];n=n.concat(this.storeService.getLoginAttributeNames()),this.usersService.findRichUsersWithAttributes(this.searchCtrl.value,n).subscribe(_=>{this.users=_,this.loading=!1,this.firstSearchDone=!0},()=>this.loading=!1)}}return r.\u0275fac=function(n){return new(n||r)(e.Y36(h.so),e.Y36(h.WI),e.Y36(p.Ct),e.Y36(p.Fv),e.Y36(a.sK),e.Y36(o.V6),e.Y36(o.d6),e.Y36(P.gz),e.Y36(P.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-add-manager-dialog"]],decls:32,vars:31,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"mr-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"mr-2","w-100"],["matInput","","autocomplete","false","data-cy","search-manager-input","perunWebAppsAutoFocus","",3,"placeholder","formControl","keyup.enter"],["mat-flat-button","","color","accent","data-cy","search-manager-button",1,"ml-auto",3,"disabled","click"],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent","data-cy","add-manager-button-dialog",1,"ml-2",3,"disabled","click"],[3,"value"],[1,"mr-auto","ml-auto"],[1,"mt-3"],["alert_type","warn",4,"ngIf"],[3,"tableId","disableRouting","selection","displayedColumns","users",4,"ngIf"],["alert_type","warn"],[3,"tableId","disableRouting","selection","displayedColumns","users"]],template:function(n,_){1&n&&(e.TgZ(0,"div"),e.TgZ(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1),e.TgZ(5,"div",2),e.TgZ(6,"mat-form-field",3),e.TgZ(7,"mat-label"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"mat-select",4),e.NdJ("valueChange",function(K){return _.selectedRole=K}),e.YNc(11,W,3,4,"mat-option",5),e.qZA(),e.qZA(),e.TgZ(12,"mat-form-field",6),e.TgZ(13,"label"),e.TgZ(14,"input",7),e.NdJ("keyup.enter",function(){return _.onSearchByString()}),e.ALo(15,"translate"),e.qZA(),e.qZA(),e.TgZ(16,"mat-error"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"button",8),e.NdJ("click",function(){return _.onSearchByString()}),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"div",9),e.YNc(23,ee,1,0,"mat-spinner",10),e.qZA(),e.YNc(24,j,3,2,"div",11),e.qZA(),e.TgZ(25,"div",12),e.TgZ(26,"button",13),e.NdJ("click",function(){return _.onCancel()}),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"button",14),e.NdJ("click",function(){return _.onSubmit()}),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.Tol(_.theme),e.xp6(2),e.Oqu(e.lcZ(3,17,"DIALOGS.ADD_MANAGERS.TITLE")),e.xp6(6),e.Oqu(e.lcZ(9,19,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",_.selectedRole),e.xp6(1),e.Q6J("ngForOf",_.availableRoles),e.xp6(3),e.s9C("placeholder",e.lcZ(15,21,"DIALOGS.ADD_MANAGERS.DESCRIPTION")),e.Q6J("formControl",_.searchCtrl),e.xp6(3),e.hij(" ",e.lcZ(18,23,"DIALOGS.ADD_MANAGERS.EMPTY_SEARCH_MESSAGE")," "),e.xp6(2),e.Q6J("disabled",_.loading),e.xp6(1),e.hij(" ",e.lcZ(21,25,"DIALOGS.ADD_MANAGERS.SEARCH")," "),e.xp6(3),e.Q6J("ngIf",_.loading),e.xp6(1),e.Q6J("ngIf",null!==_.users&&!_.loading),e.xp6(3),e.hij(" ",e.lcZ(28,27,"DIALOGS.ADD_MANAGERS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",0===_.selection.selected.length||void 0===_.selectedRole||_.loading),e.xp6(1),e.hij(" ",e.lcZ(31,29,"DIALOGS.ADD_MANAGERS.CREATE")," "))},directives:[h.uh,h.xY,Z.KE,Z.hX,Y.gD,O.sg,I.ey,V.Nt,t.Fj,y.hT,t.JJ,t.oH,Z.TO,J.lW,O.O5,f.$g,L.w,N.C,h.H8],pipes:[a.X$,H],styles:[".inline-dialog-items[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]}),r})();var C=i(32075);function F(r,v){1&r&&e._UZ(0,"th",15)}function z(r,v){if(1&r&&(e.TgZ(0,"td",16),e._uU(1),e.qZA()),2&r){const n=v.$implicit;e.xp6(1),e.AsE("",n.firstName," ",n.lastName,"")}}function ie(r,v){1&r&&e._UZ(0,"tr",17)}function ne(r,v){1&r&&e._UZ(0,"tr",18)}const re=function(r){return{role:r}};function x(r,v){if(1&r&&(e.TgZ(0,"app-alert",19),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"displayedRole"),e.qZA()),2&r){const n=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,"DIALOGS.REMOVE_MANAGERS.WARNING_REMOVE_YOURSELF",e.VKq(6,re,e.lcZ(3,4,n.data.role)))," ")}}function T(r,v){if(1&r&&(e.TgZ(0,"div",6),e.TgZ(1,"p"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",7),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"table",8),e.ynx(8,9),e.YNc(9,F,1,0,"th",10),e.YNc(10,z,2,2,"td",11),e.BQk(),e.YNc(11,ie,1,0,"tr",12),e.YNc(12,ne,1,0,"tr",13),e.qZA(),e.YNc(13,x,4,8,"app-alert",14),e.qZA()),2&r){const n=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,6,"DIALOGS.REMOVE_MANAGERS.DESCRIPTION")," "),e.xp6(3),e.hij(" ",e.lcZ(6,8,"DIALOGS.REMOVE_MANAGERS.ASK")," "),e.xp6(2),e.Q6J("dataSource",n.dataSource),e.xp6(4),e.Q6J("matHeaderRowDef",n.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",n.displayedColumns),e.xp6(1),e.Q6J("ngIf",n.removeSelf)}}function d(r,v){1&r&&e._UZ(0,"mat-spinner",20)}let l=(()=>{class r{constructor(n,_,D,K,ae,le,ue){this.dialogRef=n,this.data=_,this.notificator=D,this.translate=K,this.authzService=ae,this.store=le,this.authService=ue,this.displayedColumns=["name"]}ngOnInit(){this.dataSource=new C.by(this.data.managers),this.theme=this.data.theme,this.removeSelf=this.data.managers.map(n=>n.id).includes(this.store.getPerunPrincipal().userId)&&!this.authService.isPerunAdmin()}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithUserComplementaryObject({role:this.data.role,users:this.data.managers.map(n=>n.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_MANAGERS.SUCCESS").subscribe(n=>{this.notificator.showSuccess(n),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)},()=>this.loading=!1)}}return r.\u0275fac=function(n){return new(n||r)(e.Y36(h.so),e.Y36(h.WI),e.Y36(o.V6),e.Y36(a.sK),e.Y36(p.Ct),e.Y36(o.d6),e.Y36(o.x4))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-remove-manager-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content","",4,"ngIf"],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn","data-cy","remove-manager-button-dialog",1,"ml-2",3,"disabled","click"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""],["alert_type","warn"],[1,"mr-auto","ml-auto"]],template:function(n,_){1&n&&(e.TgZ(0,"div"),e.TgZ(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,T,14,10,"div",1),e.YNc(5,d,1,0,"mat-spinner",2),e.TgZ(6,"div",3),e.TgZ(7,"button",4),e.NdJ("click",function(){return _.onCancel()}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",5),e.NdJ("click",function(){return _.onSubmit()}),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.Tol(_.theme),e.xp6(2),e.Oqu(e.lcZ(3,9,"DIALOGS.REMOVE_MANAGERS.TITLE")),e.xp6(2),e.Q6J("ngIf",!_.loading),e.xp6(1),e.Q6J("ngIf",_.loading),e.xp6(3),e.hij(" ",e.lcZ(9,11,"DIALOGS.REMOVE_MANAGERS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",_.loading),e.xp6(1),e.hij(" ",e.lcZ(12,13,"DIALOGS.REMOVE_MANAGERS.DELETE")," "))},directives:[h.uh,O.O5,h.xY,C.BZ,C.w1,C.fO,C.ge,C.Dz,C.ev,C.as,C.XQ,C.nj,C.Gk,L.w,f.$g,h.H8,J.lW],pipes:[a.X$,H],styles:[""]}),r})();function g(r,v){1&r&&e._UZ(0,"mat-spinner",6)}function u(r,v){1&r&&e._UZ(0,"th",15)}function A(r,v){if(1&r&&(e.TgZ(0,"td",16),e._uU(1),e.qZA()),2&r){const n=v.$implicit;e.xp6(1),e.Oqu(n.name)}}function G(r,v){1&r&&e._UZ(0,"tr",17)}function q(r,v){1&r&&e._UZ(0,"tr",18)}function X(r,v){if(1&r&&(e.TgZ(0,"div",7),e.TgZ(1,"p"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",8),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"table",9),e.ynx(8,10),e.YNc(9,u,1,0,"th",11),e.YNc(10,A,2,1,"td",12),e.BQk(),e.YNc(11,G,1,0,"tr",13),e.YNc(12,q,1,0,"tr",14),e.qZA(),e.qZA()),2&r){const n=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,5,"DIALOGS.REMOVE_GROUPS.DESCRIPTION")," "),e.xp6(3),e.hij(" ",e.lcZ(6,7,"DIALOGS.REMOVE_GROUPS.ASK")," "),e.xp6(2),e.Q6J("dataSource",n.dataSource),e.xp6(4),e.Q6J("matHeaderRowDef",n.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",n.displayedColumns)}}let ce=(()=>{class r{constructor(n,_,D,K,ae){this.dialogRef=n,this.data=_,this.notificator=D,this.translate=K,this.authzService=ae,this.displayedColumns=["name"]}ngOnInit(){this.dataSource=new C.by(this.data.groups),this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithGroupComplementaryObject({role:this.data.role,authorizedGroups:this.data.groups.map(n=>n.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUPS.SUCCESS").subscribe(n=>{this.notificator.showSuccess(n),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)},()=>this.loading=!1)}}return r.\u0275fac=function(n){return new(n||r)(e.Y36(h.so),e.Y36(h.WI),e.Y36(o.V6),e.Y36(a.sK),e.Y36(p.Ct))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-remove-group-manager-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(n,_){1&n&&(e.TgZ(0,"div"),e.TgZ(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,g,1,0,"mat-spinner",1),e.YNc(5,X,13,9,"div",2),e.TgZ(6,"div",3),e.TgZ(7,"button",4),e.NdJ("click",function(){return _.onCancel()}),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",5),e.NdJ("click",function(){return _.onSubmit()}),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.qZA(),e.qZA()),2&n&&(e.Tol(_.theme),e.xp6(2),e.Oqu(e.lcZ(3,9,"DIALOGS.REMOVE_GROUPS.TITLE")),e.xp6(2),e.Q6J("ngIf",_.loading),e.xp6(1),e.Q6J("ngIf",!_.loading),e.xp6(3),e.hij(" ",e.lcZ(9,11,"DIALOGS.REMOVE_GROUPS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",_.loading),e.xp6(1),e.hij(" ",e.lcZ(12,13,"DIALOGS.REMOVE_GROUPS.DELETE")," "))},directives:[h.uh,O.O5,f.$g,h.xY,C.BZ,C.w1,C.fO,C.ge,C.Dz,C.ev,C.as,C.XQ,C.nj,C.Gk,h.H8,J.lW],pipes:[a.X$],styles:[""]}),r})();var R=i(1059),w=i(24850),c=i(91079),E=i(64901),M=i(24179);function k(r,v){if(1&r&&(e.TgZ(0,"mat-option",17),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&r){const n=v.$implicit;e.Q6J("value",n),e.xp6(1),e.Oqu(e.lcZ(2,2,n))}}function B(r,v){if(1&r&&(e.TgZ(0,"mat-option",17),e._uU(1),e.qZA()),2&r){const n=v.$implicit;e.Q6J("value",n),e.xp6(1),e.hij(" ",n.name," ")}}function te(r,v){if(1&r){const n=e.EpF();e.TgZ(0,"perun-web-apps-debounce-filter",18),e.NdJ("filter",function(D){return e.CHM(n),e.oxw().applyFilter(D)}),e.ALo(1,"translate"),e.qZA()}2&r&&e.s9C("placeholder",e.lcZ(1,1,"DIALOGS.ADD_GROUPS.FILTER_GROUPS"))}function pe(r,v){1&r&&e._UZ(0,"mat-spinner",19)}const me=function(){return["select","id","name","description"]};function Ae(r,v){if(1&r&&(e.TgZ(0,"div",20),e._UZ(1,"perun-web-apps-groups-list",21),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.Q6J("tableId",n.tableId)("disableRouting",!0)("displayedColumns",e.DdM(7,me))("selection",n.selection)("filter",n.filterValue)("groups",n.groups)("disableMembers",!1)}}let Re=(()=>{class r{constructor(n,_,D,K,ae,le,ue,he,fe){this.dialogRef=n,this.data=_,this.authzService=D,this.voService=K,this.groupService=ae,this.translate=le,this.notificator=ue,this.route=he,this.router=fe,this.searchString="",this.selection=new b.Ov(!0,[]),this.groups=[],this.vos=[],this.filterValue="",this.myControl=new t.NI,this.firstSearchDone=!1,this.tableId=S.kZ,le.get("DIALOGS.ADD_GROUPS.TITLE").subscribe(_e=>this.title=_e),le.get("DIALOGS.ADD_GROUPS.SUCCESS").subscribe(_e=>this.successMessage=_e)}displayFn(n){return n?n.name:null}onCancel(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.authzService.setRoleWithGroupComplementaryObject({role:this.selectedRole,authorizedGroups:this.selection.selected.map(n=>n.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)}ngOnInit(){this.loading=!0,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.theme=this.data.theme,this.voService.getMyVos().subscribe(n=>{this.filteredOptions=this.myControl.valueChanges.pipe((0,R.O)(""),(0,w.U)(_=>this._filter(_))),this.vos=n,this.loading=!1},()=>this.loading=!1)}_filter(n){const _="string"==typeof n?n.toLowerCase():n.name.toLowerCase;return this.vos.filter(D=>D.name.toLowerCase().includes(_))}showVoGroups(n){this.loading=!0,this.groupService.getAllGroups(n.option.value.id).subscribe(_=>{this.groups=_,this.loading=!1,this.firstSearchDone=!0},()=>this.loading=!1)}applyFilter(n){this.filterValue=n}}return r.\u0275fac=function(n){return new(n||r)(e.Y36(h.so),e.Y36(h.WI),e.Y36(p.Ct),e.Y36(p.YF),e.Y36(p.ff),e.Y36(a.sK),e.Y36(o.V6),e.Y36(P.gz),e.Y36(P.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-add-group-manager-dialog"]],decls:33,vars:33,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"mr-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"mr-2","w-75"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"placeholder","filter",4,"ngIf"],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[3,"value"],[3,"placeholder","filter"],[1,"mr-auto","ml-auto"],[1,"mt-3"],[3,"tableId","disableRouting","displayedColumns","selection","filter","groups","disableMembers"]],template:function(n,_){if(1&n&&(e.TgZ(0,"div"),e.TgZ(1,"h1",0),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",1),e.TgZ(5,"div",2),e.TgZ(6,"mat-form-field",3),e.TgZ(7,"mat-label"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"mat-select",4),e.NdJ("valueChange",function(K){return _.selectedRole=K}),e.YNc(11,k,3,4,"mat-option",5),e.qZA(),e.qZA(),e.TgZ(12,"mat-form-field",6),e.TgZ(13,"mat-label"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e._UZ(16,"input",7),e.ALo(17,"translate"),e.TgZ(18,"mat-autocomplete",8,9),e.NdJ("optionSelected",function(K){return _.showVoGroups(K)}),e.YNc(20,B,2,2,"mat-option",5),e.ALo(21,"async"),e.qZA(),e.qZA(),e.qZA(),e.YNc(22,te,2,3,"perun-web-apps-debounce-filter",10),e.TgZ(23,"div",11),e.YNc(24,pe,1,0,"mat-spinner",12),e.qZA(),e.YNc(25,Ae,2,8,"div",13),e.qZA(),e.TgZ(26,"div",14),e.TgZ(27,"button",15),e.NdJ("click",function(){return _.onCancel()}),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"button",16),e.NdJ("click",function(){return _.onSubmit()}),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.qZA(),e.qZA()),2&n){const D=e.MAs(19);e.Tol(_.theme),e.xp6(2),e.Oqu(e.lcZ(3,19,"DIALOGS.ADD_GROUPS.TITLE")),e.xp6(6),e.Oqu(e.lcZ(9,21,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",_.selectedRole),e.xp6(1),e.Q6J("ngForOf",_.availableRoles),e.xp6(3),e.Oqu(e.lcZ(15,23,"DIALOGS.ADD_GROUPS.SELECT_VO")),e.xp6(2),e.s9C("placeholder",e.lcZ(17,25,"DIALOGS.ADD_GROUPS.SELECT_VO")),e.Q6J("formControl",_.myControl)("matAutocomplete",D),e.xp6(2),e.Q6J("displayWith",_.displayFn),e.xp6(2),e.Q6J("ngForOf",e.lcZ(21,27,_.filteredOptions)),e.xp6(2),e.Q6J("ngIf",null!==_.groups&&_.groups.length>0&&!_.loading),e.xp6(2),e.Q6J("ngIf",_.loading),e.xp6(1),e.Q6J("ngIf",null!==_.groups&&!_.loading),e.xp6(3),e.hij(" ",e.lcZ(29,29,"DIALOGS.ADD_MANAGERS.CANCEL")," "),e.xp6(2),e.Q6J("disabled",0===_.selection.selected.length||_.loading),e.xp6(1),e.hij(" ",e.lcZ(32,31,"DIALOGS.ADD_MANAGERS.CREATE")," ")}},directives:[h.uh,h.xY,Z.KE,Z.hX,Y.gD,O.sg,I.ey,V.Nt,t.Fj,c.ZL,t.JJ,t.oH,c.XC,O.O5,E.P,f.$g,M.W,h.H8,J.lW],pipes:[a.X$,H,O.Ov],styles:[""]}),r})();var ge=i(9244),Te=i(15003),de=i(53251),Ee=i(96214);function Ce(r,v){1&r&&(e._uU(0),e.ALo(1,"translate")),2&r&&e.hij(" ",e.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.USER")," ")}function ve(r,v){if(1&r){const n=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){return e.CHM(n),e.oxw(2).addManager()}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function Se(r,v){if(1&r){const n=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){return e.CHM(n),e.oxw(2).removeManager()}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&r){const n=e.oxw(2);e.Q6J("disabled",0===n.selectionUsers.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function be(r,v){if(1&r&&(e.TgZ(0,"mat-option",15),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&r){const n=v.$implicit;e.Q6J("value",n),e.xp6(1),e.Oqu(e.lcZ(2,2,n))}}function Oe(r,v){1&r&&e._UZ(0,"mat-spinner",16)}function Ie(r,v){if(1&r&&e._UZ(0,"app-users-list",17),2&r){const n=e.oxw(2);e.Q6J("tableId",n.tableId)("users",n.managers)("disableRouting",!n.routeAuth||n.disableRouting)("displayedColumns",n.displayedUserColumns)("selection",n.selectionUsers)("disableSelf",n.disableSelf)}}function De(r,v){if(1&r){const n=e.EpF();e.TgZ(0,"perun-web-apps-refresh-button",5),e.NdJ("refresh",function(){return e.CHM(n),e.oxw().refreshUsers()}),e.qZA(),e.YNc(1,ve,3,3,"button",6),e.YNc(2,Se,3,4,"button",7),e.TgZ(3,"mat-form-field",8),e.TgZ(4,"mat-label"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"mat-select",9),e.NdJ("valueChange",function(D){return e.CHM(n),e.oxw().selectedRole=D})("selectionChange",function(){return e.CHM(n),e.oxw().refreshUsers()}),e.YNc(8,be,3,4,"mat-option",10),e.qZA(),e.qZA(),e.YNc(9,Oe,1,0,"mat-spinner",11),e.YNc(10,Ie,1,6,"app-users-list",12)}if(2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.manageAuth&&!n.configMode),e.xp6(1),e.Q6J("ngIf",n.manageAuth&&!n.configMode),e.xp6(3),e.Oqu(e.lcZ(6,7,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",n.selectedRole),e.xp6(1),e.Q6J("ngForOf",n.availableRoles),e.xp6(1),e.Q6J("ngIf",n.loading),e.xp6(1),e.Q6J("ngIf",!n.loading&&n.managers)}}function Ze(r,v){1&r&&(e._uU(0),e.ALo(1,"translate")),2&r&&e.hij(" ",e.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.GROUP")," ")}function Me(r,v){if(1&r){const n=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){return e.CHM(n),e.oxw(2).addGroup()}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function xe(r,v){if(1&r){const n=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){return e.CHM(n),e.oxw(2).removeGroup()}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&r){const n=e.oxw(2);e.Q6J("disabled",0===n.selectionGroups.selected.length),e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function Ue(r,v){if(1&r&&(e.TgZ(0,"mat-option",15),e._uU(1),e.ALo(2,"displayedRole"),e.qZA()),2&r){const n=v.$implicit;e.Q6J("value",n),e.xp6(1),e.Oqu(e.lcZ(2,2,n))}}function ye(r,v){1&r&&e._UZ(0,"mat-spinner",16)}function Le(r,v){if(1&r&&e._UZ(0,"perun-web-apps-groups-list",23),2&r){const n=e.oxw(2);e.Q6J("tableId",n.tableId)("disableRouting",n.disableRouting)("displayedColumns",n.displayedGroupColumns)("groups",n.groups)("selection",n.selectionGroups)("disableMembers",!1)}}function Ge(r,v){if(1&r){const n=e.EpF();e.TgZ(0,"perun-web-apps-refresh-button",5),e.NdJ("refresh",function(){return e.CHM(n),e.oxw().refreshGroups()}),e.qZA(),e.YNc(1,Me,3,3,"button",18),e.YNc(2,xe,3,4,"button",19),e.TgZ(3,"mat-form-field",8),e.TgZ(4,"mat-label"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"mat-select",9),e.NdJ("valueChange",function(D){return e.CHM(n),e.oxw().selectedRole=D})("selectionChange",function(){return e.CHM(n),e.oxw().refreshGroups()}),e.YNc(8,Ue,3,4,"mat-option",10),e.qZA(),e.qZA(),e.YNc(9,ye,1,0,"mat-spinner",11),e.YNc(10,Le,1,6,"perun-web-apps-groups-list",20)}if(2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.manageAuth&&!n.configMode),e.xp6(1),e.Q6J("ngIf",n.manageAuth&&!n.configMode),e.xp6(3),e.Oqu(e.lcZ(6,7,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),e.xp6(2),e.Q6J("value",n.selectedRole),e.xp6(1),e.Q6J("ngForOf",n.availableRoles),e.xp6(1),e.Q6J("ngIf",n.loading),e.xp6(1),e.Q6J("ngIf",!n.loading&&n.groups)}}function Pe(r,v){1&r&&(e.TgZ(0,"app-alert",24),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.NO_AVAILABLE_ROLES"),"\n"))}let Ne=(()=>{class r{constructor(n,_,D,K,ae,le,ue){this.dialog=n,this.authzService=_,this.storeService=D,this.guiAuthResolver=K,this.router=ae,this.reloadEntityDetail=le,this.route=ue,this.groups=null,this.managers=null,this.configMode=!1,this.disableRouting=!1,this.disableSelf=!1,this.displayedUserColumns=["select","id","name","email","logins","organization"],this.displayedGroupColumns=["select","id","vo","name","description"],this.selectionUsers=new b.Ov(!0,[]),this.selectionGroups=new b.Ov(!0,[]),this.selectedMode="",this.loading=!1,this.tableId=S.HC,this.availableRolesPrivileges=new Map}ngOnInit(){this.loading=!0,this.routeAuth=this.guiAuthResolver.isPerunAdminOrObserver(),this.guiAuthResolver.getRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(n=>this.availableRolesPrivileges.get(n).readAuth),0!==this.availableRoles.length&&(this.selectedRole=this.availableRoles[0]),this.refreshUsers()}changeRolePrivileges(){this.guiAuthResolver.getRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(_=>this.availableRolesPrivileges.get(_).readAuth),this.manageAuth=this.availableRolesPrivileges.get(this.selectedRole).manageAuth,this.displayedUserColumns=this.manageAuth?this.displayedUserColumns:this.displayedUserColumns.filter(_=>"select"!==_),this.displayedGroupColumns=this.manageAuth?this.displayedGroupColumns:this.displayedGroupColumns.filter(_=>"select"!==_),this.roleModes=this.availableRolesPrivileges.get(this.selectedRole).modes;let n=!1;for(const _ of this.roleModes)if(this.selectedMode===_.toLowerCase()){n=!0;break}n||(this.selectedMode=this.roleModes[0].toLowerCase())}tabChanged(n){this.loading=!0,0===n.index?(this.selectedMode="user",this.refreshUsers()):(this.selectedMode="group",this.refreshGroups())}refreshUsers(){this.loading=!0,this.changeRolePrivileges();let n=[s.r.USER_DEF_ORGANIZATION,s.r.USER_DEF_PREFERRED_MAIL];n=n.concat(this.storeService.getLoginAttributeNames()),this.authzService.getAuthzRichAdmins(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType,n,!1,!0).subscribe(_=>{this.managers=_,this.selectionUsers.clear(),this.loading=!1},()=>{this.loading=!1})}refreshGroups(){this.loading=!0,this.changeRolePrivileges(),this.authzService.getAuthzAdminGroups(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType).subscribe(n=>{this.groups=n,this.selectionGroups.clear(),this.loading=!1},()=>{this.loading=!1})}addManager(){const n=(0,ge.kZ)();n.width="1000px",n.data={complementaryObject:this.complementaryObject,theme:this.theme,availableRoles:this.availableRoles,selectedRole:this.selectedRole},this.dialog.open(m,n).afterClosed().subscribe(D=>{D&&this.refreshUsers()})}removeManager(){const n=(0,ge.kZ)();n.width="450px",n.data={managers:this.selectionUsers.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(l,n).afterClosed().subscribe(D=>{D&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?this.reloadEntityDetail.reloadEntityDetail():this.redirectToAuthRoute())})}removeGroup(){const n=(0,ge.kZ)();n.width="450px",n.data={groups:this.selectionGroups.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(ce,n).afterClosed().subscribe(D=>{D&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?(this.reloadEntityDetail.reloadEntityDetail(),this.refreshGroups()):this.redirectToAuthRoute())})}addGroup(){const n=(0,ge.kZ)();n.width="1000px",n.data={complementaryObject:this.complementaryObject,availableRoles:this.availableRoles,theme:this.theme,selectedRole:this.selectedRole},this.dialog.open(Re,n).afterClosed().subscribe(D=>{D&&this.refreshGroups()})}redirectToAuthRoute(){if("Group"===this.complementaryObjectType&&(this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])||this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])))this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])?this.router.navigate(["/organizations",this.complementaryObject.voId,"groups",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"}):this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])&&this.router.navigate(["/organizations",this.complementaryObject.voId],{queryParamsHandling:"merge"});else if("Facility"===this.complementaryObjectType&&this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.complementaryObject]))this.router.navigate(["/facilities",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else if("Vo"===this.complementaryObjectType&&this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject]))this.router.navigate(["/organizations",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else{if("Resource"!==this.complementaryObjectType||!this.guiAuthResolver.isAuthorized("getRichResourceById_int_policy",[this.complementaryObject]))return void this.router.navigate(["/home"],{queryParamsHandling:"merge"});this.router.navigate(["../../"],{relativeTo:this.route,queryParamsHandling:"merge"})}this.reloadEntityDetail.reloadEntityDetail()}}return r.\u0275fac=function(n){return new(n||r)(e.Y36(h.uw),e.Y36(p.Ct),e.Y36(o.d6),e.Y36(o.x4),e.Y36(P.F0),e.Y36(Te.G),e.Y36(P.gz))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-managers-page"]],hostVars:2,hostBindings:function(n,_){2&n&&e.ekj("router-component",_.true)},inputs:{complementaryObject:"complementaryObject",availableRoles:"availableRoles",complementaryObjectType:"complementaryObjectType",theme:"theme",configMode:"configMode",disableRouting:"disableRouting",disableSelf:"disableSelf",displayedUserColumns:"displayedUserColumns",displayedGroupColumns:"displayedGroupColumns"},decls:11,vars:4,consts:[[1,"page-subtitle"],[3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["alert_type","warn",4,"ngIf"],[1,"mt-2",3,"refresh"],["mat-flat-button","","color","accent","class","mr-2 mt-2 action-button","data-cy","add-manager-button",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2 mt-2","data-cy","remove-manager-button",3,"disabled","click",4,"ngIf"],[1,"mr-2","mt-2"],[3,"value","valueChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","users","disableRouting","displayedColumns","selection","disableSelf",4,"ngIf"],["mat-flat-button","","color","accent","data-cy","add-manager-button",1,"mr-2","mt-2","action-button",3,"click"],["mat-flat-button","","color","warn","data-cy","remove-manager-button",1,"mr-2","mt-2",3,"disabled","click"],[3,"value"],[1,"ml-auto","mr-auto"],[3,"tableId","users","disableRouting","displayedColumns","selection","disableSelf"],["mat-flat-button","","color","accent","class","mr-2 mt-2 action-button",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2 mt-2",3,"disabled","click",4,"ngIf"],[3,"tableId","disableRouting","displayedColumns","groups","selection","disableMembers",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2","mt-2","action-button",3,"click"],["mat-flat-button","","color","warn",1,"mr-2","mt-2",3,"disabled","click"],[3,"tableId","disableRouting","displayedColumns","groups","selection","disableMembers"],["alert_type","warn"]],template:function(n,_){1&n&&(e.TgZ(0,"h1",0),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"mat-tab-group",1),e.NdJ("selectedTabChange",function(K){return _.tabChanged(K)}),e.TgZ(4,"mat-tab"),e.YNc(5,Ce,2,3,"ng-template",2),e.YNc(6,De,11,9,"ng-template",3),e.qZA(),e.TgZ(7,"mat-tab"),e.YNc(8,Ze,2,3,"ng-template",2),e.YNc(9,Ge,11,9,"ng-template",3),e.qZA(),e.qZA(),e.YNc(10,Pe,3,3,"app-alert",4)),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.TITLE"),"\n"),e.xp6(9),e.Q6J("ngIf",0===_.availableRoles.length))},directives:[de.SP,de.uX,de.uD,de.Vc,Ee.t,O.O5,J.lW,Z.KE,Z.hX,Y.gD,O.sg,I.ey,f.$g,N.C,M.W,L.w],pipes:[a.X$,H],styles:[""]}),r})()},17672:($,Q,i)=>{i.d(Q,{o:()=>x});var b=i(84847),h=i(32075),o=i(20449),p=i(36908),S=i(112),s=i(9244),t=i(5e3),e=i(51062),a=i(18750),P=i(77446),Z=i(69808),Y=i(67322),O=i(98833),I=i(93075),V=i(47423),y=i(29772),J=i(25245),f=i(98380);function L(T,d){if(1&T){const l=t.EpF();t.TgZ(0,"th",16),t.TgZ(1,"mat-checkbox",17),t.NdJ("change",function(u){t.CHM(l);const A=t.oxw();return u?A.masterToggle():null}),t.qZA(),t.qZA()}if(2&T){const l=t.oxw();t.xp6(1),t.Q6J("aria-label",l.checkboxLabel())("checked",l.selection.hasValue()&&l.isAllSelected())("indeterminate",l.selection.hasValue()&&!l.isAllSelected())}}function N(T,d){if(1&T){const l=t.EpF();t.TgZ(0,"td",18),t.TgZ(1,"mat-checkbox",19),t.NdJ("change",function(u){const G=t.CHM(l).$implicit,q=t.oxw();return u?q.selection.toggle(G):null})("click",function(u){return u.stopPropagation()}),t.qZA(),t.qZA()}if(2&T){const l=d.$implicit,g=t.oxw();t.xp6(1),t.Q6J("aria-label",g.checkboxLabel(l))("checked",g.selection.isSelected(l))}}function H(T,d){1&T&&(t.TgZ(0,"th",20),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&T&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_ID")," "))}function W(T,d){if(1&T&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&T){const l=d.$implicit;t.xp6(1),t.Oqu(l.id)}}function ee(T,d){1&T&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&T&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_NAME")," "))}function se(T,d){if(1&T&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&T){const l=t.oxw().$implicit;t.xp6(1),t.hij(" ",l.tagName," ")}}function oe(T,d){if(1&T){const l=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"mat-form-field"),t.TgZ(2,"input",25),t.NdJ("ngModelChange",function(u){return t.CHM(l),t.oxw().$implicit.tagName=u}),t.qZA(),t.qZA(),t.qZA()}if(2&T){const l=t.oxw().$implicit;t.xp6(2),t.Q6J("ngModel",l.tagName)}}function U(T,d){if(1&T&&(t.TgZ(0,"td",23),t.YNc(1,se,2,1,"div",24),t.YNc(2,oe,3,1,"div",24),t.qZA()),2&T){const l=d.$implicit,g=t.oxw();t.xp6(1),t.Q6J("ngIf",!g.isChanging.isSelected(l)),t.xp6(1),t.Q6J("ngIf",g.isChanging.isSelected(l))}}function j(T,d){1&T&&t._UZ(0,"th",22)}function m(T,d){if(1&T){const l=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(l);const u=t.oxw().$implicit;return t.oxw().edit(u)}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA(),t.qZA()}2&T&&t.s9C("matTooltip",t.lcZ(1,1,"VO_DETAIL.RESOURCES.TAGS.EDIT_BUTTON"))}function C(T,d){if(1&T){const l=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(l);const u=t.oxw().$implicit;return t.oxw().save(u)}),t.ALo(1,"translate"),t.TgZ(2,"mat-icon"),t._uU(3,"save"),t.qZA(),t.qZA()}2&T&&t.s9C("matTooltip",t.lcZ(1,1,"VO_DETAIL.RESOURCES.TAGS.SAVE_BUTTON"))}function F(T,d){if(1&T&&(t.TgZ(0,"td",23),t.TgZ(1,"div",26),t.YNc(2,m,4,3,"button",27),t.YNc(3,C,4,3,"button",27),t.qZA(),t.qZA()),2&T){const l=d.$implicit,g=t.oxw();t.xp6(2),t.Q6J("ngIf",!g.isChanging.isSelected(l)),t.xp6(1),t.Q6J("ngIf",g.isChanging.isSelected(l))}}function z(T,d){1&T&&t._UZ(0,"tr",29)}function ie(T,d){1&T&&t._UZ(0,"tr",30)}function ne(T,d){if(1&T&&(t.TgZ(0,"app-alert",31),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&T){const l=t.oxw();t.xp6(1),t.hij(" ","vo"===l.entity?t.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.NO_TAGS"):t.lcZ(3,3,"RESOURCE_DETAIL.TAGS.NO_TAGS"),"\n")}}function re(T,d){1&T&&(t.TgZ(0,"app-alert",31),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&T&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}let x=(()=>{class T{constructor(l,g,u,A,G){this.resourceManager=l,this.notificator=g,this.translator=u,this.authResolver=A,this.tableCheckbox=G,this.resourceTags=[],this.selection=new o.Ov(!0,[]),this.displayedColumns=["select","id","name","edit"],this.isChanging=new o.Ov(!0,[]),this.pageSizeOptions=s.f7}set matSort(l){this.sort=l,this.setDataSource()}ngOnChanges(){this.authResolver.isPerunAdminOrObserver()||(this.displayedColumns=this.displayedColumns.filter(l=>"id"!==l)),this.dataSource=new h.by(this.resourceTags),this.setDataSource()}ngAfterViewInit(){this.dataSource.paginator=this.child.paginator}getDataForColumn(l,g){switch(g){case"id":return l.id.toString();case"name":return l.tagName;default:return""}}exportData(l){(0,s.O6)((0,s.Xn)(this.dataSource.filteredData,this.displayedColumns,this.getDataForColumn,this),l)}setDataSource(){this.dataSource&&(this.dataSource.filterPredicate=(l,g)=>(0,s.Sd)(l,g,this.displayedColumns,this.getDataForColumn,this),this.dataSource.sortData=(l,g)=>(0,s.pR)(l,g,this.getDataForColumn,this),this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue)}isAllSelected(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.child.paginator.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}masterToggle(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}checkboxLabel(l){return l?`${this.selection.isSelected(l)?"deselect":"select"} row ${l.id+1}`:(this.isAllSelected()?"select":"deselect")+" all"}save(l){this.resourceManager.updateResourceTag({resourceTag:l}).subscribe(()=>{this.translator.get("SHARED.COMPONENTS.RESOURCES_TAGS_LIST.EDIT_SUCCESS").subscribe(g=>{this.notificator.showSuccess(g)}),this.isChanging.deselect(l)})}edit(l){this.isChanging.select(l)}}return T.\u0275fac=function(l){return new(l||T)(t.Y36(S.xk),t.Y36(p.V6),t.Y36(e.sK),t.Y36(p.x4),t.Y36(p.UA))},T.\u0275cmp=t.Xpm({type:T,selectors:[["app-resources-tags-list"]],viewQuery:function(l,g){if(1&l&&(t.Gf(b.YE,7),t.Gf(s.l9,7)),2&l){let u;t.iGM(u=t.CRH())&&(g.matSort=u.first),t.iGM(u=t.CRH())&&(g.child=u.first)}},inputs:{resourceTags:"resourceTags",filterValue:"filterValue",selection:"selection",tableId:"tableId",displayedColumns:"displayedColumns",entity:"entity"},features:[t.TTD],decls:19,vars:9,consts:[[1,"card","mt-2",3,"hidden"],[3,"tableId","dataLength","pageSizeOptions","exportData"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","","class","align-checkbox",4,"matHeaderCellDef"],["class","static-column-size align-checkbox","mat-cell","",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","edit"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell","",1,"align-checkbox"],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size","align-checkbox"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"static-column-size"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],["matInput","",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-end"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","",3,"matTooltip","click"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"],["alert_type","warn"]],template:function(l,g){1&l&&(t.TgZ(0,"div",0),t.TgZ(1,"perun-web-apps-table-wrapper",1),t.NdJ("exportData",function(A){return g.exportData(A)}),t.TgZ(2,"table",2),t.ynx(3,3),t.YNc(4,L,2,3,"th",4),t.YNc(5,N,2,2,"td",5),t.BQk(),t.ynx(6,6),t.YNc(7,H,3,3,"th",7),t.YNc(8,W,2,1,"td",8),t.BQk(),t.ynx(9,9),t.YNc(10,ee,3,3,"th",10),t.YNc(11,U,3,2,"td",11),t.BQk(),t.ynx(12,12),t.YNc(13,j,1,0,"th",10),t.YNc(14,F,4,2,"td",11),t.BQk(),t.YNc(15,z,1,0,"tr",13),t.YNc(16,ie,1,0,"tr",14),t.qZA(),t.qZA(),t.qZA(),t.YNc(17,ne,4,5,"app-alert",15),t.YNc(18,re,3,3,"app-alert",15)),2&l&&(t.Q6J("hidden",0===g.resourceTags.length||0===g.dataSource.filteredData.length),t.xp6(1),t.Q6J("tableId",g.tableId)("dataLength",g.dataSource.filteredData.length)("pageSizeOptions",g.pageSizeOptions),t.xp6(1),t.Q6J("dataSource",g.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",g.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",g.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===g.resourceTags.length),t.xp6(1),t.Q6J("ngIf",0===g.dataSource.filteredData.length&&0!==g.resourceTags.length))},directives:[a.l,h.BZ,b.YE,h.w1,h.fO,h.ge,P.oG,h.Dz,h.ev,b.nU,Z.O5,Y.KE,O.Nt,I.Fj,I.JJ,I.On,V.lW,y.gM,J.Hw,h.as,h.XQ,h.nj,h.Gk,f.w],pipes:[e.X$],styles:[""]}),T})()},90439:($,Q,i)=>{i.d(Q,{F:()=>p});var b=i(5e3),h=i(42377),o=i(51062);let p=(()=>{class S{constructor(){this.servicePackages=[],this.selectedPackage=null,this.multiple=!1,this.disableAutoSelect=!1,this.theme="",this.packageSelected=new b.vpe,this.nameFunction=t=>t.name,this.shortNameFunction=t=>t.description,this.searchFunction=t=>t.name+t.description}}return S.\u0275fac=function(t){return new(t||S)},S.\u0275cmp=b.Xpm({type:S,selectors:[["perun-web-apps-service-package-search-select"]],inputs:{servicePackages:"servicePackages",selectedPackage:"selectedPackage",multiple:"multiple",disableAutoSelect:"disableAutoSelect",theme:"theme"},outputs:{packageSelected:"packageSelected"},decls:4,vars:17,consts:[[3,"entities","entity","multiple","disableAutoSelect","searchFunction","mainTextFunction","secondaryTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","theme","entitySelected"]],template:function(t,e){1&t&&(b.TgZ(0,"perun-web-apps-entity-search-select",0),b.NdJ("entitySelected",function(P){return e.packageSelected.emit(P)}),b.ALo(1,"translate"),b.ALo(2,"translate"),b.ALo(3,"translate"),b.qZA()),2&t&&b.Q6J("entities",e.servicePackages)("entity",e.selectedPackage)("multiple",e.multiple)("disableAutoSelect",e.disableAutoSelect)("searchFunction",e.searchFunction)("mainTextFunction",e.nameFunction)("secondaryTextFunction",e.shortNameFunction)("selectPlaceholder",b.lcZ(1,11,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.SELECT_PACKAGE"))("findPlaceholder",b.lcZ(2,13,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.FIND_PACKAGE"))("noEntriesText",b.lcZ(3,15,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.NO_PACKAGE_FOUND"))("theme",e.theme)},directives:[h.i],pipes:[o.X$],styles:[""]}),S})()}}]);