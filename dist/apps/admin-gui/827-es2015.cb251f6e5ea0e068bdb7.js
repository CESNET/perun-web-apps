(self.webpackChunkperun_web_apps=self.webpackChunkperun_web_apps||[]).push([[827],{24820:function(e,t,s){"use strict";s.d(t,{G:function(){return a}});var i=s(31572);let a=(()=>{class e{constructor(){this.entityDetailChange=new i.vpe}reloadEntityDetail(){this.entityDetailChange.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},95142:function(e,t,s){"use strict";s.d(t,{y:function(){return A}});var i=s(65249),a=s(60611),o=s(68416),n=s(31572),r=s(57629),l=s(59403),c=s(91058),u=s(61511),d=s(67806),h=s(4252),g=s(48160);function p(e,t){1&e&&n._UZ(0,"mat-spinner",5)}const m=function(){return["id","fullName"]};function f(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"perun-web-apps-members-list",6),n.NdJ("updateTable",function(){return n.CHM(e),n.oxw().refreshTable()}),n.qZA()}if(2&e){const e=n.oxw();n.Q6J("tableId",e.tableId)("disableRouting",!e.routeAuth)("filter",e.filterValue)("displayedColumns",n.DdM(5,m))("members",e.members)}}let A=(()=>{class e{constructor(e,t,s,i){this.route=e,this.resourceService=t,this.authResolver=s,this.entityStorageService=i,this.loading=!1,this.filterValue="",this.tableId=a.iQ}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.refreshTable()}refreshTable(){this.loading=!0,this.resourceService.getAssignedRichMembers(this.resource.id).subscribe(e=>{this.members=e,this.setAuthRights(),this.loading=!1})}setAuthRights(){0!==this.members.length&&(this.routeAuth=this.authResolver.isAuthorized("getMemberById_int_policy",[this.members[0]]))}applyFilter(e){this.filterValue=e}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(r.gz),n.Y36(i.xk),n.Y36(o.x4),n.Y36(o.fb))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-resource-assigned-members"]],decls:7,vars:6,consts:[[1,"page-subtitle"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","disableRouting","filter","displayedColumns","members","updateTable",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"tableId","disableRouting","filter","displayedColumns","members","updateTable"]],template:function(e,t){1&e&&(n.TgZ(0,"h1",0),n._uU(1),n.ALo(2,"translate"),n.qZA(),n.TgZ(3,"perun-web-apps-refresh-button",1),n.NdJ("refresh",function(){return t.refreshTable()}),n.qZA(),n.TgZ(4,"perun-web-apps-debounce-filter",2),n.NdJ("filter",function(e){return t.applyFilter(e)}),n.qZA(),n.YNc(5,p,1,0,"mat-spinner",3),n.YNc(6,f,1,6,"perun-web-apps-members-list",4)),2&e&&(n.xp6(1),n.Oqu(n.lcZ(2,4,"RESOURCE_DETAIL.ASSIGNED_MEMBERS.TITLE")),n.xp6(3),n.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_MEMBERS.FILTER"),n.xp6(1),n.Q6J("ngIf",t.loading),n.xp6(1),n.Q6J("ngIf",!t.loading))},directives:[l.t,c.P,u.O5,d.$g,h.O],pipes:[g.X$],styles:[""]}),e})()},75374:function(e,t,s){"use strict";s.d(t,{D:function(){return q}});var i=s(65249),a=s(60611),o=s(4230),n=s(84140),r=s(84608),l=s(68416),c=s(31572),u=s(48160),d=s(61511),h=s(15980),g=s(67806),p=s(55109),m=s(91058),f=s(91721),A=s(65267);function S(e,t){1&e&&c._UZ(0,"mat-spinner",6)}const b=function(){return["id","name","enabled","description"]};function E(e,t){if(1&e&&c._UZ(0,"app-services-list",16),2&e){const e=c.oxw(2);c.Q6J("tableId",e.tableId)("disableRouting",!0)("displayedColumns",c.DdM(5,b))("selection",e.selection)("services",e.filteredServices)}}const R=function(){return["select","id","name","enabled","description"]};function T(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",7),c.TgZ(1,"mat-tab-group",8),c.NdJ("selectedTabChange",function(){return c.CHM(e),c.oxw().tabChanged()}),c.TgZ(2,"mat-tab",9),c.ALo(3,"translate"),c.TgZ(4,"div",10),c.TgZ(5,"perun-web-apps-debounce-filter",11),c.NdJ("filter",function(t){return c.CHM(e),c.oxw().applyFilter(t)}),c.ALo(6,"translate"),c.qZA(),c.qZA(),c._UZ(7,"app-services-list",12),c.qZA(),c.TgZ(8,"mat-tab",9),c.ALo(9,"translate"),c.TgZ(10,"div",13),c.TgZ(11,"perun-web-apps-service-package-search-select",14),c.NdJ("packageSelected",function(t){return c.CHM(e),c.oxw().servicePackageSelected(t)}),c.qZA(),c.qZA(),c.YNc(12,E,1,6,"app-services-list",15),c.qZA(),c.qZA(),c.qZA()}if(2&e){const e=c.oxw();c.xp6(2),c.s9C("label",c.lcZ(3,12,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SELECT_SERVICE")),c.xp6(3),c.s9C("placeholder",c.lcZ(6,14,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.FILTER_DESCRIPTION")),c.xp6(2),c.Q6J("tableId",e.tableId)("disableRouting",!0)("displayedColumns",c.DdM(18,R))("filterValue",e.filterValue)("selection",e.selection)("services",e.unAssignedServices),c.xp6(1),c.s9C("label",c.lcZ(9,16,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SELECT_PACKAGE")),c.xp6(3),c.Q6J("selectedPackage",e.selectedPackage)("servicePackages",e.servicePackages),c.xp6(1),c.Q6J("ngIf",-1!==e.selectedPackage.id)}}let I=(()=>{class e{constructor(e,t,s,i,n,r){this.dialogRef=e,this.data=t,this.notificator=s,this.translate=i,this.resourceManager=n,this.servicesManager=r,this.loading=!1,this.unAssignedServices=[],this.filteredServices=[],this.servicePackages=[],this.selectedPackage={name:"Not selected",description:"",id:-1,beanName:"ServicePackage"},this.selection=new o.Ov(!0,[]),this.tableId=a.DR,this.filterValue=""}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resourceManager.getAssignedServicesToResource(this.data.resourceId).subscribe(e=>{this.servicesManager.getServices().subscribe(t=>{this.servicesManager.getServicesPackages().subscribe(s=>{this.servicePackages.push(this.selectedPackage),this.servicePackages=this.servicePackages.concat(s),this.unAssignedServices=t;for(const i of e)for(const e of t)i.id===e.id&&this.unAssignedServices.splice(this.unAssignedServices.indexOf(e),1);this.loading=!1})})})}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0,-1!==this.selectedPackage.id?this.addServicePackage():this.addServices()}addServicePackage(){this.resourceManager.assignServicesPackage(this.data.resourceId,this.selectedPackage.id).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.PACKAGE_SUCCESS_MESSAGE").subscribe(e=>{this.notificator.showSuccess(e),0!==this.selection.selected.length?this.addServices():this.dialogRef.close(!0)})},()=>this.loading=!1)}addServices(){const e=[];for(const t of this.selection.selected)e.push(t.id);this.resourceManager.assignServices(this.data.resourceId,e).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SERVICE_SUCCESS_MESSAGE").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close(!0)})},()=>this.loading=!1)}applyFilter(e){this.filterValue=e}servicePackageSelected(e){this.selectedPackage=e,-1!==e.id?this.servicesManager.getServicesFromServicesPackage(e.id).subscribe(e=>{this.filteredServices=e}):this.filteredServices=[]}tabChanged(){this.selection.clear(),this.filterValue="",this.selectedPackage=this.servicePackages[0]}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(r.so),c.Y36(r.WI),c.Y36(l.V6),c.Y36(u.sK),c.Y36(i.xk),c.Y36(i.KK))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-perun-web-apps-assign-service-to-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[3,"selectedTabChange"],[3,"label"],[1,"mt-2"],[3,"placeholder","filter"],[3,"tableId","disableRouting","displayedColumns","filterValue","selection","services"],[1,"mt-3"],[3,"selectedPackage","servicePackages","packageSelected"],[3,"tableId","disableRouting","displayedColumns","selection","services",4,"ngIf"],[3,"tableId","disableRouting","displayedColumns","selection","services"]],template:function(e,t){1&e&&(c.TgZ(0,"div"),c.TgZ(1,"h1",0),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.YNc(4,S,1,0,"mat-spinner",1),c.YNc(5,T,13,19,"div",2),c.TgZ(6,"div",3),c.TgZ(7,"button",4),c.NdJ("click",function(){return t.onCancel()}),c._uU(8),c.ALo(9,"translate"),c.qZA(),c.TgZ(10,"button",5),c.NdJ("click",function(){return t.onAdd()}),c._uU(11),c.ALo(12,"translate"),c.qZA(),c.qZA(),c.qZA()),2&e&&(c.Tol(t.theme),c.xp6(2),c.Oqu(c.lcZ(3,9,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.TITLE")),c.xp6(2),c.Q6J("ngIf",t.loading),c.xp6(1),c.Q6J("ngIf",!t.loading),c.xp6(3),c.hij(" ",c.lcZ(9,11,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.CANCEL_BUTTON")," "),c.xp6(2),c.Q6J("disabled",0===t.selection.selected.length&&-1===t.selectedPackage.id||t.loading),c.xp6(1),c.hij(" ",c.lcZ(12,13,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE."+(-1===t.selectedPackage.id?"ADD_SERVICES":"ADD_PACKAGE"))," "))},directives:[r.uh,d.O5,r.H8,h.lW,g.$g,r.xY,p.SP,p.uX,m.P,f.Q,A.F],pipes:[u.X$],styles:[""]}),e})();var Z=s(67033);function _(e,t){1&e&&c._UZ(0,"mat-spinner",6)}function O(e,t){1&e&&c._UZ(0,"th",15)}function v(e,t){if(1&e&&(c.TgZ(0,"td",16),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.xp6(1),c.Oqu(e.name)}}function C(e,t){1&e&&c._UZ(0,"tr",17)}function y(e,t){1&e&&c._UZ(0,"tr",18)}function x(e,t){if(1&e&&(c.TgZ(0,"div",7),c.TgZ(1,"p"),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"div",8),c._uU(5),c.ALo(6,"translate"),c.qZA(),c.TgZ(7,"table",9),c.ynx(8,10),c.YNc(9,O,1,0,"th",11),c.YNc(10,v,2,1,"td",12),c.BQk(),c.YNc(11,C,1,0,"tr",13),c.YNc(12,y,1,0,"tr",14),c.qZA(),c.qZA()),2&e){const e=c.oxw();c.xp6(2),c.hij(" ",c.lcZ(3,5,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DESCRIPTION")," "),c.xp6(3),c.hij(" ",c.lcZ(6,7,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.ASK")," "),c.xp6(2),c.Q6J("dataSource",e.dataSource),c.xp6(4),c.Q6J("matHeaderRowDef",e.displayedColumns),c.xp6(1),c.Q6J("matRowDefColumns",e.displayedColumns)}}let U=(()=>{class e{constructor(e,t,s,i,a){this.dialogRef=e,this.data=t,this.notificator=s,this.translate=i,this.resourcesManager=a,this.displayedColumns=["name"]}ngOnInit(){this.theme=this.data.theme,this.dataSource=new Z.by(this.data.services)}onSubmit(){this.loading=!0;const e=[];for(const t of this.data.services)e.push(t.id);this.resourcesManager.removeServices(this.data.resourceId,e).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close(!0)})},()=>this.loading=!1)}onCancel(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(r.so),c.Y36(r.WI),c.Y36(l.V6),c.Y36(u.sK),c.Y36(i.xk))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-perun-web-apps-remove-service-from-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(c.TgZ(0,"div"),c.TgZ(1,"h1",0),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.YNc(4,_,1,0,"mat-spinner",1),c.YNc(5,x,13,9,"div",2),c.TgZ(6,"div",3),c.TgZ(7,"button",4),c.NdJ("click",function(){return t.onCancel()}),c._uU(8),c.ALo(9,"translate"),c.qZA(),c.TgZ(10,"button",5),c.NdJ("click",function(){return t.onSubmit()}),c._uU(11),c.ALo(12,"translate"),c.qZA(),c.qZA(),c.qZA()),2&e&&(c.Tol(t.theme),c.xp6(2),c.Oqu(c.lcZ(3,9,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.TITLE")),c.xp6(2),c.Q6J("ngIf",t.loading),c.xp6(1),c.Q6J("ngIf",!t.loading),c.xp6(3),c.hij(" ",c.lcZ(9,11,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.CANCEL")," "),c.xp6(2),c.Q6J("disabled",t.loading),c.xp6(1),c.hij(" ",c.lcZ(12,13,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DELETE")," "))},directives:[r.uh,d.O5,r.H8,h.lW,g.$g,r.xY,Z.BZ,Z.w1,Z.fO,Z.Dz,Z.as,Z.nj,Z.ge,Z.ev,Z.XQ,Z.Gk],pipes:[u.X$],styles:[""]}),e})();var N=s(57629),G=s(59403),D=s(19139);function L(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",7),c.NdJ("click",function(){return c.CHM(e),c.oxw().addService()}),c._uU(1),c.ALo(2,"translate"),c.qZA()}2&e&&(c.xp6(1),c.hij(" ",c.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_SERVICES.ADD_SERVICE"),"\n"))}function w(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",8),c.NdJ("click",function(){return c.CHM(e),c.oxw().removeServices()}),c._uU(1),c.ALo(2,"translate"),c.qZA()}if(2&e){const e=c.oxw();c.Q6J("disabled",0===e.selected.selected.length),c.xp6(1),c.hij(" ",c.lcZ(2,2,"RESOURCE_DETAIL.ASSIGNED_SERVICES.REMOVE_SERVICE"),"\n")}}function M(e,t){1&e&&c._UZ(0,"mat-spinner",9)}function Y(e,t){if(1&e&&c._UZ(0,"app-services-list",10),2&e){const e=c.oxw();c.Q6J("tableId",e.tableId)("services",e.assignedServices)("selection",e.selected)("filterValue",e.filterValue)("displayedColumns",e.displayedColumns)("disableRouting",!e.serviceRoutingAuth)}}let q=(()=>{class e{constructor(e,t,s,i,n){this.route=e,this.resourcesManager=t,this.dialog=s,this.guiAuthResolver=i,this.entityStorageService=n,this.assignedServices=[],this.selected=new o.Ov(!0,[]),this.tableId=a.uC,this.filterValue="",this.displayedColumns=["select","id","name","enabled","script","description"]}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.getDataForAuthorization(),this.loadAllServices()}loadAllServices(){this.loading=!0,this.resourcesManager.getAssignedServicesToResource(this.resource.id).subscribe(e=>{this.assignedServices=e,this.selected.clear(),this.loading=!1})}addService(){const e=(0,n.kZ)();e.width="800px",e.data={theme:"resource-theme",resourceId:this.resource.id},this.dialog.open(I,e).afterClosed().subscribe(e=>{e&&this.loadAllServices()})}removeServices(){const e=(0,n.kZ)();e.width="500px",e.data={theme:"resource-theme",resourceId:this.resource.id,services:this.selected.selected},this.dialog.open(U,e).afterClosed().subscribe(e=>{e&&this.loadAllServices()})}applyFilter(e){this.filterValue=e}getDataForAuthorization(){this.assignServiceAuth=this.guiAuthResolver.isAuthorized("assignServices_Resource_List<Service>_policy",[this.resource]),this.removeServiceAuth=this.guiAuthResolver.isAuthorized("removeServices_Resource_List<Service>_policy",[this.resource]),this.displayedColumns=this.removeServiceAuth?["select","id","name","enabled","script","description"]:["id","name","enabled","script","description"],this.serviceRoutingAuth=this.guiAuthResolver.isPerunAdminOrObserver()}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(N.gz),c.Y36(i.xk),c.Y36(r.uw),c.Y36(l.x4),c.Y36(l.fb))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-perun-web-apps-resource-assigned-services"]],decls:9,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["class","action-button mr-2","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","services","selection","filterValue","displayedColumns","disableRouting",4,"ngIf"],["color","accent","mat-flat-button","",1,"action-button","mr-2",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"tableId","services","selection","filterValue","displayedColumns","disableRouting"]],template:function(e,t){1&e&&(c.TgZ(0,"h1",0),c._uU(1),c.ALo(2,"translate"),c.qZA(),c.TgZ(3,"perun-web-apps-refresh-button",1),c.NdJ("refresh",function(){return t.loadAllServices()}),c.qZA(),c.YNc(4,L,3,3,"button",2),c.YNc(5,w,3,4,"button",3),c.TgZ(6,"perun-web-apps-immediate-filter",4),c.NdJ("filter",function(e){return t.applyFilter(e)}),c.qZA(),c.YNc(7,M,1,0,"mat-spinner",5),c.YNc(8,Y,1,6,"app-services-list",6)),2&e&&(c.xp6(1),c.Oqu(c.lcZ(2,6,"RESOURCE_DETAIL.ASSIGNED_SERVICES.TITLE")),c.xp6(3),c.Q6J("ngIf",t.assignServiceAuth),c.xp6(1),c.Q6J("ngIf",t.removeServiceAuth),c.xp6(1),c.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_SERVICES.FILTER_SERVICES"),c.xp6(1),c.Q6J("ngIf",t.loading),c.xp6(1),c.Q6J("ngIf",!t.loading))},directives:[G.t,d.O5,D.L,h.lW,g.$g,f.Q],pipes:[u.X$],styles:[""]}),e})()},79472:function(e,t,s){"use strict";s.d(t,{X:function(){return b}});var i=s(68416),a=s(65249),o=s(31572),n=s(55109),r=s(61511),l=s(541),c=s(3417),u=s(48160);function d(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"RESOURCE_DETAIL.ENTITY")," ")}function h(e,t){if(1&e&&o._UZ(0,"app-one-entity-attribute-page",4),2&e){const e=o.oxw();o.Q6J("entity","resource")("entityId",e.resource.id)}}function g(e,t){1&e&&(o._uU(0),o.ALo(1,"translate"),o.ALo(2,"translate")),2&e&&o.AsE(" ",o.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",o.lcZ(2,4,"MEMBER_DETAIL.ENTITY")," ")}function p(e,t){if(1&e&&o._UZ(0,"app-two-entity-attribute-page",5),2&e){const e=o.oxw(2);o.Q6J("firstEntity","resource")("firstEntityId",e.resource.id)("secondEntity","member")}}function m(e,t){1&e&&(o.TgZ(0,"mat-tab"),o.YNc(1,g,3,6,"ng-template",1),o.YNc(2,p,1,3,"ng-template",2),o.qZA())}function f(e,t){1&e&&(o._uU(0),o.ALo(1,"translate"),o.ALo(2,"translate")),2&e&&o.AsE(" ",o.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",o.lcZ(2,4,"GROUP_DETAIL.ENTITY")," ")}function A(e,t){if(1&e&&o._UZ(0,"app-two-entity-attribute-page",5),2&e){const e=o.oxw(2);o.Q6J("firstEntity","resource")("firstEntityId",e.resource.id)("secondEntity","group")}}function S(e,t){1&e&&(o.TgZ(0,"mat-tab"),o.YNc(1,f,3,6,"ng-template",1),o.YNc(2,A,1,3,"ng-template",2),o.qZA())}let b=(()=>{class e{constructor(e,t,s){this.authResolver=e,this.resourceManager=t,this.entityStorageService=s}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.resourceGroupAttAuth=this.authResolver.isAuthorized("getGroupAssignments_Resource_policy",[this.resource]),this.resourceMemberAttAuth=this.authResolver.isAuthorized("getAssignedMembersWithStatus_Resource_policy",[this.resource])}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(i.x4),o.Y36(a.xk),o.Y36(i.fb))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-resource-attributes"]],hostVars:2,hostBindings:function(e,t){2&e&&o.ekj("router-component",t.true)},decls:10,vars:5,consts:[[1,"page-subtitle"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entity","entityId"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(e,t){1&e&&(o.TgZ(0,"div"),o.TgZ(1,"h1",0),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"mat-tab-group"),o.TgZ(5,"mat-tab"),o.YNc(6,d,2,3,"ng-template",1),o.YNc(7,h,1,2,"ng-template",2),o.qZA(),o.YNc(8,m,3,0,"mat-tab",3),o.YNc(9,S,3,0,"mat-tab",3),o.qZA(),o.qZA()),2&e&&(o.xp6(2),o.Oqu(o.lcZ(3,3,"RESOURCE_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),o.xp6(6),o.Q6J("ngIf",t.resourceMemberAttAuth),o.xp6(1),o.Q6J("ngIf",t.resourceGroupAttAuth))},directives:[n.SP,n.uX,n.uD,n.Vc,r.O5,l.t,c.Y],pipes:[u.X$],styles:[""]}),e})()},72920:function(e,t,s){"use strict";s.d(t,{b:function(){return w}});var i=s(17),a=s(75585),o=s(65249),n=s(84140),r=s(68416),l=s(22280),c=s(6527),u=s(95909),d=s(31572),h=s(57629),g=s(48958),p=s(84608),m=s(24820),f=s(66297),A=s(61511),S=s(67806),b=s(43691),E=s(36922),R=s(21575),T=s(15980),I=s(48160);function Z(e,t){1&e&&d._UZ(0,"mat-spinner",3)}function _(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"button",15),d.NdJ("click",function(){return d.CHM(e),d.oxw(2).editResource()}),d.TgZ(1,"mat-icon"),d._uU(2,"edit"),d.qZA(),d.qZA()}}function O(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"button",16),d.NdJ("click",function(){return d.CHM(e),d.oxw(2).deleteResource()}),d.TgZ(1,"mat-icon"),d._uU(2,"delete_forever"),d.qZA(),d.qZA()}}const v=function(e){return["/organizations",e]};function C(e,t){if(1&e&&(d.TgZ(0,"a",8),d._uU(1),d.qZA()),2&e){const e=d.oxw(2);d.Q6J("routerLink",d.VKq(2,v,e.resource.vo.id)),d.xp6(1),d.Oqu(e.resource.vo.name)}}function y(e,t){if(1&e&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&e){const e=d.oxw(2);d.xp6(1),d.hij(" ",e.resource.vo.name," ")}}const x=function(e){return["/facilities",e]};function U(e,t){if(1&e&&(d.TgZ(0,"a",8),d._uU(1),d.qZA()),2&e){const e=d.oxw(2);d.Q6J("routerLink",d.VKq(2,x,e.resource.facilityId)),d.xp6(1),d.Oqu(e.resource.facility.name)}}function N(e,t){if(1&e&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&e){const e=d.oxw(2);d.xp6(1),d.hij(" ",e.resource.facility.name," ")}}const G=function(){return{color:"black"}},D=function(e){return[e]};function L(e,t){if(1&e&&(d.TgZ(0,"div"),d.TgZ(1,"div",4),d._UZ(2,"mat-icon",5),d.ALo(3,"translate"),d.TgZ(4,"div",6),d.TgZ(5,"div",7),d.TgZ(6,"a",8),d._uU(7),d.qZA(),d.TgZ(8,"span",9),d._uU(9),d.qZA(),d.YNc(10,_,3,0,"button",10),d.YNc(11,O,3,0,"button",11),d.qZA(),d.TgZ(12,"div"),d._uU(13),d.ALo(14,"translate"),d.qZA(),d.TgZ(15,"span",12),d._uU(16),d.ALo(17,"translate"),d.ALo(18,"translate"),d.YNc(19,C,2,4,"a",13),d.YNc(20,y,2,1,"span",2),d._uU(21),d.ALo(22,"translate"),d.YNc(23,U,2,4,"a",14),d.YNc(24,N,2,1,"span",2),d._uU(25),d.ALo(26,"translate"),d.qZA(),d.qZA(),d.qZA(),d._UZ(27,"app-animated-router-outlet"),d.qZA()),2&e){const e=d.oxw();d.xp6(2),d.s9C("matTooltip",d.lcZ(3,20,"RESOURCE_DETAIL.ENTITY")),d.Q6J("ngStyle",d.DdM(32,G)),d.xp6(4),d.Q6J("routerLink",d.VKq(33,D,e.baseUrl)),d.xp6(1),d.hij(" ",e.resource.name," "),d.xp6(2),d.hij(" \xa0#",e.resource.id," "),d.xp6(1),d.Q6J("ngIf",e.editResourceAuth),d.xp6(1),d.Q6J("ngIf",e.deleteAuth),d.xp6(2),d.AsE("",d.lcZ(14,22,"RESOURCE_DETAIL.UUID"),": ",e.resource.uuid,""),d.xp6(3),d.AsE(" ",d.lcZ(17,24,"RESOURCE_DETAIL.ENTITY"),", ",d.lcZ(18,26,"RESOURCE_DETAIL.VO"),": "),d.xp6(3),d.Q6J("ngIf",e.voLinkAuth),d.xp6(1),d.Q6J("ngIf",!e.voLinkAuth),d.xp6(1),d.AsE(" #",e.resource.voId,", ",d.lcZ(22,28,"RESOURCE_DETAIL.FACILITY"),": "),d.xp6(2),d.Q6J("ngIf",e.facilityLinkAuth),d.xp6(1),d.Q6J("ngIf",!e.facilityLinkAuth),d.xp6(1),d.lnq(" #",e.resource.facilityId,", ",d.lcZ(26,30,"RESOURCE_DETAIL.DESCRIPTION"),": ",e.resource.description," ")}}let w=(()=>{class e{constructor(e,t,s,i,a,o,n,r,l,c,u){this.route=e,this.facilityManager=t,this.vosManagerService=s,this.resourcesManager=i,this.sideMenuService=a,this.sideMenuItemService=o,this.dialog=n,this.guiAuthResolver=r,this.router=l,this.entityStorageService=c,this.reloadEntityDetail=u,this.underVoUrl=!1,this.deleteAuth=!1,this.baseUrl="",this.loading=!1}ngOnInit(){this.reloadData(),this.reloadEntityDetail.entityDetailChange.subscribe(()=>{this.reloadData()})}reloadData(){this.loading=!0,this.route.params.subscribe(e=>{this.resourcesManager.getRichResourceById(e.resourceId).subscribe(e=>{this.resource=e,this.entityStorageService.setEntity({id:e.id,voId:e.voId,facilityId:e.facilityId,beanName:"Resource"}),this.setAuth(),"facilities"===this.route.parent.snapshot.url[0].path?(this.baseUrl=(new l.r5).transform(e,!1),this.facilityManager.getFacilityById(e.facilityId).subscribe(e=>{this.facility=e,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)):(this.baseUrl=(new l.r5).transform(e,!0),this.vosManagerService.getVoById(e.voId).subscribe(e=>{this.vo=e,this.underVoUrl=!0,this.setMenuItems(),this.loading=!1},()=>this.loading=!1)),(0,n.sF)("resources",this.resource)})})}setMenuItems(){let e;const t=this.sideMenuItemService.parseResource(this.resource,this.underVoUrl);e=this.underVoUrl?this.sideMenuItemService.parseVo(this.vo):this.sideMenuItemService.parseFacility(this.facility),this.sideMenuService.setAccessMenuItems([e,t])}setAuth(){this.facilityLinkAuth=this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.resource]),this.editResourceAuth=this.guiAuthResolver.isAuthorized("updateResource_Resource_policy",[this.resource]),this.voLinkAuth=this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.resource]),this.deleteAuth=this.guiAuthResolver.isAuthorized("deleteResource_Resource_policy",[this.resource])}editResource(){let e;this.resourcesManager.getResourceById(this.resource.id).subscribe(t=>{e=t;const s=(0,n.kZ)();s.width="450px",s.data={theme:"resource-theme",resource:e,dialogType:c.Eg.RESOURCE},this.dialog.open(c.rd,s).afterClosed().subscribe(e=>{e&&this.resourcesManager.getRichResourceById(this.resource.id).subscribe(e=>{this.resource=e,this.setMenuItems()})})})}deleteResource(){const e=(0,n.kZ)();e.width="500px",e.data={theme:"resource-theme",resources:[this.resource]},this.dialog.open(u.f,e).afterClosed().subscribe(e=>{e&&this.router.navigate(["../"],{relativeTo:this.route})})}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(h.gz),d.Y36(o.IQ),d.Y36(o.YF),d.Y36(o.xk),d.Y36(g.D),d.Y36(a.V),d.Y36(p.uw),d.Y36(r.x4),d.Y36(h.F0),d.Y36(r.fb),d.Y36(m.G))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-resource-detail-page"]],decls:4,vars:2,consts:[[1,"container-fluid","pl-xl-5","pr-xl-5","resource-theme"],["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-resource-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],["queryParamsHandling","merge",1,"resource-link",3,"routerLink"],[1,"text-muted"],["mat-icon-button","","aria-label","Edit resource",3,"click",4,"ngIf"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"mt-1","entity-info"],["queryParamsHandling","merge","class","resource-link",3,"routerLink",4,"ngIf"],["class","resource-link","queryParamsHandling","merge",3,"routerLink",4,"ngIf"],["mat-icon-button","","aria-label","Edit resource",3,"click"],["mat-icon-button","",3,"click"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d._UZ(1,"perun-web-apps-back-button"),d.YNc(2,Z,1,0,"mat-spinner",1),d.YNc(3,L,28,35,"div",2),d.qZA()),2&e&&(d.xp6(2),d.Q6J("ngIf",t.loading),d.xp6(1),d.Q6J("ngIf",!t.loading&&void 0!==t.resource))},directives:[f.W,A.O5,S.$g,b.Hw,E.gM,A.PC,h.yS,R.A,T.lW],pipes:[I.X$],styles:[".break-line[_ngcontent-%COMP%]{display:inline-block}"],data:{animation:[i.Ji]}}),e})()},42473:function(e,t,s){"use strict";s.d(t,{K:function(){return H}});var i=s(65249),a=s(4230),o=s(84608),n=s(67033),r=s(68416),l=s(31572),c=s(48160),u=s(61511),d=s(15980),h=s(67806);function g(e,t){1&e&&l._UZ(0,"mat-spinner",6)}function p(e,t){1&e&&l._UZ(0,"th",15)}function m(e,t){if(1&e&&(l.TgZ(0,"td",16),l._uU(1),l.qZA()),2&e){const e=t.$implicit;l.xp6(1),l.Oqu(e.name)}}function f(e,t){1&e&&l._UZ(0,"tr",17)}function A(e,t){1&e&&l._UZ(0,"tr",18)}function S(e,t){if(1&e&&(l.TgZ(0,"div",7),l.TgZ(1,"p"),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.TgZ(4,"div",8),l._uU(5),l.ALo(6,"translate"),l.qZA(),l.TgZ(7,"table",9),l.ynx(8,10),l.YNc(9,p,1,0,"th",11),l.YNc(10,m,2,1,"td",12),l.BQk(),l.YNc(11,f,1,0,"tr",13),l.YNc(12,A,1,0,"tr",14),l.qZA(),l.qZA()),2&e){const e=l.oxw();l.xp6(2),l.hij(" ",l.lcZ(3,5,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DESCRIPTION")," "),l.xp6(3),l.hij(" ",l.lcZ(6,7,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.ASK")," "),l.xp6(2),l.Q6J("dataSource",e.dataSource),l.xp6(4),l.Q6J("matHeaderRowDef",e.displayedColumns),l.xp6(1),l.Q6J("matRowDefColumns",e.displayedColumns)}}let b=(()=>{class e{constructor(e,t,s,i,a){this.dialogRef=e,this.data=t,this.notificator=s,this.translate=i,this.resourceManager=a,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.dataSource=new n.by(this.data.groups)}onCancel(){this.dialogRef.close()}onSubmit(){const e=[];for(const t of this.data.groups)e.push(t.id);this.loading=!0,this.resourceManager.removeGroupsFromResource(e,this.data.resourceId).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUP_FROM_RESOURCE.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close(!0)})},()=>this.loading=!1)}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(o.so),l.Y36(o.WI),l.Y36(r.V6),l.Y36(c.sK),l.Y36(i.xk))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-perun-web-apps-remove-group-from-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(l.TgZ(0,"div"),l.TgZ(1,"h1",0),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.YNc(4,g,1,0,"mat-spinner",1),l.YNc(5,S,13,9,"div",2),l.TgZ(6,"div",3),l.TgZ(7,"button",4),l.NdJ("click",function(){return t.onCancel()}),l._uU(8),l.ALo(9,"translate"),l.qZA(),l.TgZ(10,"button",5),l.NdJ("click",function(){return t.onSubmit()}),l._uU(11),l.ALo(12,"translate"),l.qZA(),l.qZA(),l.qZA()),2&e&&(l.Tol(t.theme),l.xp6(2),l.Oqu(l.lcZ(3,9,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.TITLE")),l.xp6(2),l.Q6J("ngIf",t.loading),l.xp6(1),l.Q6J("ngIf",!t.loading),l.xp6(3),l.hij(" ",l.lcZ(9,11,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.CANCEL")," "),l.xp6(2),l.Q6J("disabled",t.loading),l.xp6(1),l.hij(" ",l.lcZ(12,13,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DELETE")," "))},directives:[o.uh,u.O5,o.H8,d.lW,h.$g,o.xY,n.BZ,n.w1,n.fO,n.Dz,n.as,n.nj,n.ge,n.ev,n.XQ,n.Gk],pipes:[c.X$],styles:[""]}),e})();var E=s(60611),R=s(70663),T=s(91058),I=s(78364),Z=s(27521),_=s(16073);const O=["stepper"];function v(e,t){1&e&&l._UZ(0,"mat-spinner",4)}function C(e,t){1&e&&(l._uU(0),l.ALo(1,"translate")),2&e&&l.Oqu(l.lcZ(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.GROUPS"))}function y(e,t){1&e&&(l._uU(0),l.ALo(1,"translate")),2&e&&l.Oqu(l.lcZ(1,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.OPTIONS"))}const x=function(){return["select","id","name","description"]};function U(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",5),l.TgZ(1,"mat-stepper",6,7),l.TgZ(3,"mat-step",8),l.YNc(4,C,2,3,"ng-template",9),l.TgZ(5,"perun-web-apps-debounce-filter",10),l.NdJ("filter",function(t){return l.CHM(e),l.oxw().applyFilter(t)}),l.ALo(6,"translate"),l.qZA(),l._UZ(7,"perun-web-apps-groups-list",11),l.qZA(),l.TgZ(8,"mat-step"),l.YNc(9,y,2,3,"ng-template",9),l.TgZ(10,"mat-slide-toggle",12),l.NdJ("toggleChange",function(){return l.CHM(e),l.oxw().changeSubgroupsMessage()})("ngModelChange",function(t){return l.CHM(e),l.oxw().autoAssignSubgroups=t}),l._uU(11),l.ALo(12,"translate"),l.qZA(),l.TgZ(13,"div",13),l._UZ(14,"i",14),l.qZA(),l.TgZ(15,"mat-slide-toggle",12),l.NdJ("toggleChange",function(){return l.CHM(e),l.oxw().changeInactiveMessage()})("ngModelChange",function(t){return l.CHM(e),l.oxw().asActive=t}),l._uU(16),l.ALo(17,"translate"),l.qZA(),l.TgZ(18,"div",13),l._uU(19),l.qZA(),l.TgZ(20,"mat-slide-toggle",12),l.NdJ("toggleChange",function(){return l.CHM(e),l.oxw().changeAsyncMessage()})("ngModelChange",function(t){return l.CHM(e),l.oxw().async=t}),l._uU(21),l.ALo(22,"translate"),l.qZA(),l.TgZ(23,"div",13),l._uU(24),l.qZA(),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=l.oxw();l.xp6(1),l.Q6J("linear",!0),l.xp6(2),l.Q6J("completed",0!==e.selection.selected.length&&e.canAddGroups()),l.xp6(2),l.s9C("placeholder",l.lcZ(6,19,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.FILTER_DESCRIPTION")),l.xp6(2),l.Q6J("tableId",e.tableId)("groups",e.unAssignedGroups)("selection",e.selection)("filter",e.filterValue)("displayedColumns",l.DdM(27,x))("disableRouting",!0)("disableMembers",!1),l.xp6(3),l.Q6J("ngModel",e.autoAssignSubgroups),l.xp6(1),l.hij(" ",l.lcZ(12,21,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS")," "),l.xp6(3),l.Q6J("innerHTML",e.autoAssignHint,l.oJD),l.xp6(1),l.Q6J("ngModel",e.asActive),l.xp6(1),l.hij(" ",l.lcZ(17,23,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AS_ACTIVE")," "),l.xp6(3),l.hij(" ",e.asActiveHint," "),l.xp6(1),l.Q6J("ngModel",e.async),l.xp6(1),l.hij(" ",l.lcZ(22,25,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OPT")," "),l.xp6(3),l.hij(" ",e.asyncHint," ")}}function N(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"button",20),l.NdJ("click",function(){return l.CHM(e),l.oxw(2).stepperPrevious()}),l._uU(1),l.ALo(2,"translate"),l.qZA()}2&e&&(l.xp6(1),l.hij(" ",l.lcZ(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.BACK")," "))}function G(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"button",21),l.NdJ("click",function(){return l.CHM(e),l.oxw(2).stepperNext()}),l._uU(1),l.ALo(2,"translate"),l.qZA()}if(2&e){const e=l.oxw(2);l.ekj("ml-2",void 0!==e.stepper&&0!==e.stepper.selectedIndex)("ml-auto",!(void 0!==e.stepper&&0!==e.stepper.selectedIndex)),l.Q6J("disabled",0===e.selection.selected.length||!e.canAddGroups()),l.xp6(1),l.hij(" ",l.lcZ(2,6,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.NEXT")," ")}}function D(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"button",22),l.NdJ("click",function(){return l.CHM(e),l.oxw(2).onAdd()}),l._uU(1),l.ALo(2,"translate"),l.qZA()}2&e&&(l.xp6(1),l.hij(" ",l.lcZ(2,1,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ADD_BUTTON")," "))}function L(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",15),l.TgZ(1,"button",16),l.NdJ("click",function(){return l.CHM(e),l.oxw().onCancel()}),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.YNc(4,N,3,3,"button",17),l.YNc(5,G,3,8,"button",18),l.YNc(6,D,3,3,"button",19),l.qZA()}if(2&e){const e=l.oxw();l.xp6(2),l.hij(" ",l.lcZ(3,4,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.CANCEL_BUTTON")," "),l.xp6(2),l.Q6J("ngIf",void 0!==e.stepper&&0!==e.stepper.selectedIndex),l.xp6(1),l.Q6J("ngIf",void 0!==e.stepper&&e.stepper.selectedIndex!==e.stepper._steps.length-1),l.xp6(1),l.Q6J("ngIf",void 0!==e.stepper&&e.stepper.selectedIndex===e.stepper._steps.length-1)}}let w=(()=>{class e{constructor(e,t,s,i,o,n,r,l){this.dialogRef=e,this.data=t,this.notificator=s,this.translate=i,this.resourceManager=o,this.groupService=n,this.guiAuthResolver=r,this.cd=l,this.loading=!1,this.unAssignedGroups=this.data.onlyAutoAssignedGroups,this.async=!0,this.autoAssignSubgroups=!1,this.asActive=!0,this.selection=new a.Ov(!0,[]),this.filterValue="",this.tableId=E.cL}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.resource=this.data.resource,this.autoAssignHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT"),this.asActiveHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT"),this.asyncHint=this.translate.instant("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT"),this.resourceManager.getAssignedGroups(this.resource.id).subscribe(e=>{this.groupService.getAllGroups(this.resource.voId).subscribe(t=>{for(const s of t)-1===e.findIndex(e=>e.id===s.id)&&this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,s])&&this.unAssignedGroups.push(s);this.loading=!1,this.cd.detectChanges()},()=>this.loading=!1)},()=>this.loading=!1)}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0;const e=[];for(const t of this.selection.selected)e.push(t.id);this.resourceManager.assignGroupsToResource(e,this.resource.id,this.async,!this.asActive,this.autoAssignSubgroups).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.SUCCESS_MESSAGE").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close(!0)})},()=>this.loading=!1)}applyFilter(e){this.filterValue=e}canAddGroups(){let e=!0;return this.selection.selected.forEach(t=>{this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,t])||(e=!1)}),e}changeSubgroupsMessage(){this.autoAssignHint=this.translate.instant(this.autoAssignSubgroups?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.AUTO_SUBGROUPS_ON_HINT")}changeInactiveMessage(){this.asActiveHint=this.translate.instant(this.asActive?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ACTIVE_ON_HINT")}changeAsyncMessage(){this.asyncHint=this.translate.instant(this.async?"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_OFF_HINT":"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ASYNC_ON_HINT")}stepperPrevious(){this.stepper.previous()}stepperNext(){this.stepper.next()}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(o.so),l.Y36(o.WI),l.Y36(r.V6),l.Y36(c.sK),l.Y36(i.xk),l.Y36(i.ff),l.Y36(r.x4),l.Y36(l.sBO))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-perun-web-apps-assign-group-to-resource-dialog"]],viewQuery:function(e,t){if(1&e&&l.Gf(O,5),2&e){let e;l.iGM(e=l.CRH())&&(t.stepper=e.first)}},decls:7,vars:9,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","","class","dialog-container",4,"ngIf"],["mat-dialog-actions","",4,"ngIf"],[1,"mr-auto","ml-auto"],["mat-dialog-content","",1,"dialog-container"],[3,"linear"],["stepper",""],[3,"completed"],["matStepLabel",""],[3,"placeholder","filter"],[3,"tableId","groups","selection","filter","displayedColumns","disableRouting","disableMembers"],["labelPosition","before",1,"mt-3","slide-text",3,"ngModel","toggleChange","ngModelChange"],[1,"text-muted","new-line","mt-2"],[3,"innerHTML"],["mat-dialog-actions",""],["mat-flat-button","",3,"click"],["class","ml-auto","mat-flat-button","",3,"click",4,"ngIf"],["color","accent","mat-flat-button","","type","button",3,"ml-2","ml-auto","disabled","click",4,"ngIf"],["class","ml-2","color","accent","mat-flat-button","","type","button",3,"click",4,"ngIf"],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","","type","button",3,"disabled","click"],["color","accent","mat-flat-button","","type","button",1,"ml-2",3,"click"]],template:function(e,t){1&e&&(l.TgZ(0,"div"),l.TgZ(1,"h1",0),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.YNc(4,v,1,0,"mat-spinner",1),l.YNc(5,U,25,28,"div",2),l.YNc(6,L,7,6,"div",3),l.qZA()),2&e&&(l.Tol(t.theme),l.xp6(2),l.Oqu(l.lcZ(3,7,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.TITLE")),l.xp6(2),l.Q6J("ngIf",t.loading),l.xp6(1),l.Q6J("ngIf",!t.loading),l.xp6(1),l.Q6J("ngIf",!t.loading&&t.stepper))},directives:[o.uh,u.O5,h.$g,o.xY,R.Vq,R.C0,R.VY,T.P,I.W,Z.Rr,_.JJ,_.On,o.H8,d.lW],pipes:[c.X$],styles:[".slide-text[_ngcontent-%COMP%]{font-size:1.1rem}"]}),e})();var M=s(84140),Y=s(67004),q=s(57629),J=s(59403),k=s(36922);function P(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"button",8),l.NdJ("click",function(){return l.CHM(e),l.oxw().addGroup()}),l._uU(1),l.ALo(2,"translate"),l.qZA()}2&e&&(l.xp6(1),l.hij(" ",l.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_GROUPS.ADD_GROUP"),"\n"))}function Q(e,t){1&e&&l._UZ(0,"mat-spinner",9)}const V=function(e){return[e]},F=function(){return["select","id","indirectGroupAssigment","name","status","description"]};function j(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"perun-web-apps-groups-list",10),l.NdJ("refreshTable",function(){return l.CHM(e),l.oxw().loadAllGroups()}),l.qZA()}if(2&e){const e=l.oxw();l.Q6J("disableGroups",!0)("groupsToDisableCheckbox",e.groupsToDisable)("tableId",e.tableId)("groups",e.assignedGroups)("filter",e.filteredValue)("selection",e.selected)("disableMembers",!1)("resourceId",e.resource.id)("disableRouting",!!e.assignedGroups[0]&&!e.guiAuthResolver.isAuthorized("getGroupById_int_policy",l.VKq(10,V,e.assignedGroups[0])))("displayedColumns",l.DdM(12,F))}}let H=(()=>{class e{constructor(e,t,s,i,o){this.route=e,this.resourcesManager=t,this.dialog=s,this.guiAuthResolver=i,this.entityStorageService=o,this.assignedGroups=[],this.selected=new a.Ov(!0,[]),this.filteredValue="",this.tableId=E.Ad}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.loadAllGroups()}loadAllGroups(){this.loading=!0,this.resourcesManager.getGroupAssignments(this.resource.id,[Y.r.GROUP_SYNC_ENABLED]).subscribe(e=>{this.assignedGroups=e.map(e=>{const t=e.enrichedGroup.group;return t.status=e.status,t.failureCause=e.failureCause,t.sourceGroupId=e.sourceGroupId,t});const t=this.assignedGroups.map(e=>e.id),s=this.assignedGroups.filter((e,s)=>t.indexOf(e.id)===s),i=this.assignedGroups.filter((e,s)=>{const i=t.indexOf(e.id);return i!==s&&(null===e.sourceGroupId||null===this.assignedGroups[i].sourceGroupId)}).map(e=>e.id);s.forEach(e=>{i.includes(e.id)&&(e.moreTypesOfAssignment=!0)}),this.assignedGroups=s,this.groupsToDisable=new Set(this.assignedGroups.filter(e=>!!e.sourceGroupId&&!e.moreTypesOfAssignment).map(e=>e.id)),this.selected.clear(),this.loading=!1})}addGroup(){const e=(0,M.kZ)();e.width="1000px",e.data={theme:"resource-theme",resource:this.resource,onlyAutoAssignedGroups:this.assignedGroups.filter(e=>this.groupsToDisable.has(e.id))},this.dialog.open(w,e).afterClosed().subscribe(e=>{e&&this.loadAllGroups()})}removeGroups(){const e=(0,M.kZ)();e.width="500px",e.data={resourceId:this.resource.id,groups:this.selected.selected,theme:"resource-theme"},this.dialog.open(b,e).afterClosed().subscribe(e=>{e&&this.loadAllGroups()})}canRemoveGroups(){let e=!0;return this.selected.selected.forEach(t=>{this.guiAuthResolver.isAuthorized("removeGroupsFromResource_List<Group>_Resource_policy",[this.resource,t])||(e=!1)}),e}applyFilter(e){this.filteredValue=e}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(q.gz),l.Y36(i.xk),l.Y36(o.uw),l.Y36(r.x4),l.Y36(r.fb))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-perun-web-apps-resource-groups"]],decls:13,vars:17,consts:[[1,"page-subtitle"],[3,"refresh"],["class","action-button","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","mat-flat-button","",1,"ml-2","mr-2",3,"disabled","click"],[3,"matTooltipDisabled","matTooltip"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"disableGroups","groupsToDisableCheckbox","tableId","groups","filter","selection","disableMembers","resourceId","disableRouting","displayedColumns","refreshTable",4,"ngIf"],["color","accent","mat-flat-button","",1,"action-button",3,"click"],[1,"ml-auto","mr-auto"],[3,"disableGroups","groupsToDisableCheckbox","tableId","groups","filter","selection","disableMembers","resourceId","disableRouting","displayedColumns","refreshTable"]],template:function(e,t){1&e&&(l.TgZ(0,"h1",0),l._uU(1),l.ALo(2,"translate"),l.qZA(),l.TgZ(3,"perun-web-apps-refresh-button",1),l.NdJ("refresh",function(){return t.loadAllGroups()}),l.qZA(),l.YNc(4,P,3,3,"button",2),l.TgZ(5,"button",3),l.NdJ("click",function(){return t.removeGroups()}),l.TgZ(6,"span",4),l.ALo(7,"translate"),l._uU(8),l.ALo(9,"translate"),l.qZA(),l.qZA(),l.TgZ(10,"perun-web-apps-debounce-filter",5),l.NdJ("filter",function(e){return t.applyFilter(e)}),l.qZA(),l.YNc(11,Q,1,0,"mat-spinner",6),l.YNc(12,j,1,13,"perun-web-apps-groups-list",7)),2&e&&(l.xp6(1),l.Oqu(l.lcZ(2,9,"RESOURCE_DETAIL.ASSIGNED_GROUPS.TITLE")),l.xp6(3),l.Q6J("ngIf",t.guiAuthResolver.isAuthorized("getAllGroups_Vo_policy",l.VKq(15,V,t.resource))),l.xp6(1),l.Q6J("disabled",0===t.selected.selected.length||!t.canRemoveGroups()),l.xp6(1),l.s9C("matTooltip",l.lcZ(7,11,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_TOOLTIP")),l.Q6J("matTooltipDisabled",t.canRemoveGroups()),l.xp6(2),l.hij(" ",l.lcZ(9,13,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_GROUP")," "),l.xp6(2),l.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_GROUPS.FILTER_GROUPS"),l.xp6(1),l.Q6J("ngIf",t.loading),l.xp6(1),l.Q6J("ngIf",!t.loading))},directives:[J.t,u.O5,d.lW,k.gM,T.P,h.$g,I.W],pipes:[c.X$],styles:[""]}),e})()},76527:function(e,t,s){"use strict";s.d(t,{H:function(){return h}});var i=s(65249),a=s(68416),o=s(31572),n=s(57629),r=s(61511),l=s(67806),c=s(8557);function u(e,t){1&e&&o._UZ(0,"mat-spinner",2)}function d(e,t){if(1&e&&(o.TgZ(0,"div"),o._UZ(1,"perun-web-apps-menu-buttons-field",3),o.qZA()),2&e){const e=o.oxw();o.xp6(1),o.Q6J("items",e.navItems)("size","small")}}let h=(()=>{class e{constructor(e,t,s,i){this.resourcesManager=e,this.route=t,this.guiAuthResolver=s,this.entityStorageService=i,this.navItems=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.initItems("facilities"!==this.route.parent.parent.snapshot.url[0].path),this.loading=!1}initItems(e){const t=e?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`;this.navItems=[],this.guiAuthResolver.isAuthorized("getAssignedGroups_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-group",url:`${t}/resources/${this.resource.id}/groups`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_GROUPS",style:"resource-btn"}),this.guiAuthResolver.isAuthorized("getAssignedServices_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-service",url:`/${t}/resources/${this.resource.id}/services`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_SERVICES",style:"resource-btn"}),this.guiAuthResolver.isAuthorized("getAssignedMembers_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-user",url:`${t}/resources/${this.resource.id}/members`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_MEMBERS",style:"resource-btn"}),this.guiAuthResolver.isAuthorized("getAllResourcesTagsForResource_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-resource-tags",url:`${t}/resources/${this.resource.id}/tags`,label:"MENU_ITEMS.RESOURCE.RESOURCE_TAGS",style:"resource-btn"}),this.navItems.push({cssIcon:"perun-attributes",url:`${t}/resources/${this.resource.id}/attributes`,label:"MENU_ITEMS.RESOURCE.ATTRIBUTES",style:"resource-btn"}),this.guiAuthResolver.isManagerPagePrivileged(this.resource)&&this.navItems.push({cssIcon:"perun-settings2",url:`${t}/resources/${this.resource.id}/settings`,label:"MENU_ITEMS.RESOURCE.SETTINGS",style:"resource-btn"})}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(i.xk),o.Y36(n.gz),o.Y36(a.x4),o.Y36(a.fb))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-resource-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&o.ekj("router-component",t.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(o.YNc(0,u,1,0,"mat-spinner",0),o.YNc(1,d,2,2,"div",1)),2&e&&(o.Q6J("ngIf",t.loading),o.xp6(1),o.Q6J("ngIf",!t.loading))},directives:[r.O5,l.$g,c.L],styles:[""]}),e})()},64359:function(e,t,s){"use strict";s.d(t,{O:function(){return n}});var i=s(68416),a=s(31572),o=s(489);let n=(()=>{class e{constructor(e,t){this.guiAuthResolver=e,this.entityStorageService=t,this.availableRoles=[],this.type="Resource",this.theme="resource-theme"}ngOnInit(){this.resource=this.entityStorageService.getEntity(),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Resource")}}return e.\u0275fac=function(t){return new(t||e)(a.Y36(i.x4),a.Y36(i.fb))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-resource-settings-managers"]],decls:1,vars:4,consts:[[3,"complementaryObject","complementaryObjectType","theme","availableRoles"]],template:function(e,t){1&e&&a._UZ(0,"app-managers-page",0),2&e&&a.Q6J("complementaryObject",t.resource)("complementaryObjectType",t.type)("theme",t.theme)("availableRoles",t.availableRoles)},directives:[o.s],styles:[""]}),e})()},22927:function(e,t,s){"use strict";s.d(t,{h:function(){return h}});var i=s(65249),a=s(68416),o=s(31572),n=s(57629),r=s(61511),l=s(67806),c=s(8557);function u(e,t){1&e&&o._UZ(0,"mat-spinner",2)}function d(e,t){if(1&e&&(o.TgZ(0,"div"),o._UZ(1,"perun-web-apps-menu-buttons-field",3),o.qZA()),2&e){const e=o.oxw();o.xp6(1),o.Q6J("items",e.items)("size","small")}}let h=(()=>{class e{constructor(e,t,s,i){this.route=e,this.resourceManager=t,this.authResolver=s,this.entityStorageService=i,this.items=[],this.loading=!1}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.initItems("facilities"!==this.route.parent.parent.parent.snapshot.url[0].path),this.loading=!1}initItems(e){this.items=[],this.authResolver.isManagerPagePrivileged(this.resource)&&this.items.push({cssIcon:"perun-manager",url:`${e?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/managers`,label:"MENU_ITEMS.RESOURCE.MANAGERS",style:"resource-btn"})}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(n.gz),o.Y36(i.xk),o.Y36(a.x4),o.Y36(a.fb))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-resource-settings-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&o.ekj("router-component",t.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(o.YNc(0,u,1,0,"mat-spinner",0),o.YNc(1,d,2,2,"div",1)),2&e&&(o.Q6J("ngIf",t.loading),o.xp6(1),o.Q6J("ngIf",!t.loading))},directives:[r.O5,l.$g,c.L],styles:[""]}),e})()},77968:function(e,t,s){"use strict";s.d(t,{t:function(){return n}});var i=s(17),a=s(31572),o=s(21575);let n=(()=>{class e{constructor(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-resource-settings"]],hostVars:2,hostBindings:function(e,t){2&e&&a.ekj("router-component",t.true)},decls:1,vars:0,template:function(e,t){1&e&&a._UZ(0,"app-animated-router-outlet")},directives:[o.A],styles:[""],data:{animation:[i.Ji]}}),e})()},53134:function(e,t,s){"use strict";s.d(t,{v:function(){return v}});var i=s(65249),a=s(4230),o=s(60611),n=s(84140),r=s(68416),l=s(6527),c=s(84608),u=s(31572),d=s(61511),h=s(15980),g=s(67806),p=s(4196),m=s(48160);function f(e,t){1&e&&u._UZ(0,"mat-spinner",8)}function A(e,t){if(1&e&&u._UZ(0,"app-resources-tags-list",9),2&e){const e=u.oxw();u.Q6J("selection",e.selection)("tableId",e.tableId)("resourceTags",e.resourceTags)("filterValue",e.filterValue)("displayedColumns",e.displayedColumns)("entity","resource")}}let S=(()=>{class e{constructor(e,t,s){this.dialogRef=e,this.data=t,this.resourcesManager=s,this.tableId=o.g,this.selection=new a.Ov(!0,[]),this.resourceTags=[],this.displayedColumns=["select","id","name"]}ngOnInit(){this.loading=!0,this.theme=this.data.theme,this.voId=this.data.voId,this.resourceId=this.data.resourceId,this.assignedTags=this.data.assignedTags,this.resourcesManager.getAllResourcesTagsForVo(this.voId).subscribe(e=>{this.resourceTags=e.filter(e=>this.assignedTags.map(e=>e.id).indexOf(e.id)<=-1),this.loading=!1})}onCancel(){this.dialogRef.close(!1)}onSubmit(e){if(0===e.length)return this.dialogRef.close(!0);const t=e.pop();this.resourcesManager.assignResourceTagToResource({resource:this.resourceId,resourceTag:t}).subscribe(()=>{this.onSubmit(e)})}applyFilter(e){this.filterValue=e}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(c.so),u.Y36(c.WI),u.Y36(i.xk))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-add-resource-tag-to-resource-dialog"]],decls:15,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],[3,"selection","tableId","resourceTags","filterValue","displayedColumns","entity",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],[3,"selection","tableId","resourceTags","filterValue","displayedColumns","entity"]],template:function(e,t){1&e&&(u.TgZ(0,"div"),u.TgZ(1,"h1",0),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"div",1),u.TgZ(5,"div",2),u.YNc(6,f,1,0,"mat-spinner",3),u.qZA(),u.YNc(7,A,1,6,"app-resources-tags-list",4),u.qZA(),u.TgZ(8,"div",5),u.TgZ(9,"button",6),u.NdJ("click",function(){return t.onCancel()}),u._uU(10),u.ALo(11,"translate"),u.qZA(),u.TgZ(12,"button",7),u.NdJ("click",function(){return t.onSubmit(t.selection.selected)}),u._uU(13),u.ALo(14,"translate"),u.qZA(),u.qZA(),u.qZA()),2&e&&(u.Tol(t.theme),u.xp6(2),u.Oqu(u.lcZ(3,9,"RESOURCE_DETAIL.TAGS.ADD_TAGS")),u.xp6(4),u.Q6J("ngIf",t.loading),u.xp6(1),u.Q6J("ngIf",!t.loading),u.xp6(3),u.hij(" ",u.lcZ(11,11,"RESOURCE_DETAIL.TAGS.CANCEL")," "),u.xp6(2),u.Q6J("disabled",t.loading||0===t.resourceTags.length),u.xp6(1),u.hij(" ",u.lcZ(14,13,"RESOURCE_DETAIL.TAGS.ADD_BUTTON")," "))},directives:[c.uh,c.xY,d.O5,c.H8,h.lW,g.$g,p.o],pipes:[m.X$],styles:[""]}),e})();var b=s(24923),E=s(59403),R=s(19139);function T(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",7),u.NdJ("click",function(){return u.CHM(e),u.oxw().create()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}2&e&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.CREATE_BUTTON"),"\n"))}function I(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",7),u.NdJ("click",function(){return u.CHM(e),u.oxw().addTag()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}2&e&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"RESOURCE_DETAIL.TAGS.ADD_BUTTON"),"\n"))}function Z(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",8),u.NdJ("click",function(){return u.CHM(e),u.oxw().removeTags()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}if(2&e){const e=u.oxw();u.Q6J("disabled",0===e.selection.selected.length),u.xp6(1),u.hij(" ",u.lcZ(2,2,"RESOURCE_DETAIL.TAGS.REMOVE_BUTTON"),"\n")}}function _(e,t){1&e&&u._UZ(0,"mat-spinner",9)}function O(e,t){if(1&e&&u._UZ(0,"app-resources-tags-list",10),2&e){const e=u.oxw();u.Q6J("selection",e.selection)("tableId",e.tableId)("resourceTags",e.resourceTags)("filterValue",e.filterValue)("displayedColumns",e.displayedColumns)("entity","resource")}}let v=(()=>{class e{constructor(e,t,s,i,n,r){this.authResolver=e,this.resourcesManager=t,this.dialog=s,this.notificator=i,this.translate=n,this.entityStorageService=r,this.loading=!1,this.resourceTags=[],this.selection=new a.Ov(!0,[]),this.tableId=o.M8,this.displayedColumns=[]}ngOnInit(){this.loading=!0,this.resource=this.entityStorageService.getEntity(),this.setAuthRights(),this.updateData()}removeTags(){const e=(0,n.kZ)();e.width="450px",e.data={items:this.selection.selected.map(e=>e.tagName),title:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_TITLE",description:"RESOURCE_DETAIL.TAGS.REMOVE_TAGS_DIALOG_DESCRIPTION",theme:"resource-theme"},this.dialog.open(l.Tf,e).afterClosed().subscribe(e=>{e&&this.removeTag(this.selection.selected)})}removeTag(e){if(0===e.length)return this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.REMOVED_SUCCESSFULLY")),this.updateData();const t=e.pop();this.resourcesManager.removeResourceTagFromResource({resource:this.resource.id,resourceTag:t}).subscribe(()=>{this.removeTag(e)})}addTag(){const e=(0,n.kZ)();e.width="600px",e.data={voId:this.resource.voId,resourceId:this.resource.id,assignedTags:this.resourceTags,theme:"resource-theme"},this.dialog.open(S,e).afterClosed().subscribe(e=>{e&&(this.notificator.showSuccess(this.translate.instant("RESOURCE_DETAIL.TAGS.ADDED_SUCCESSFULLY")),this.updateData())})}create(){const e=(0,n.kZ)();e.width="450px",e.data={voId:this.resource.voId,theme:"resource-theme"},this.dialog.open(b.p,e).afterClosed().subscribe(e=>{e&&(this.translate.get("VO_DETAIL.RESOURCES.TAGS.CREATE_SUCCESS").subscribe(e=>{this.notificator.showSuccess(e)}),this.updateData())})}updateData(){this.loading=!0,this.selection.clear(),this.resourcesManager.getAllResourcesTagsForResource(this.resource.id).subscribe(e=>{this.resourceTags=e,this.selection.clear(),this.loading=!1})}setAuthRights(){const e={id:this.resource.voId,beanName:"Vo"};this.displayedColumns=[],this.createAuth=this.authResolver.isAuthorized("createResourceTag_ResourceTag_Vo_policy",[e]),this.addAuth=this.authResolver.isAuthorized("assignResourceTagToResource_ResourceTag_Resource_policy",[this.resource]),this.removeAuth=this.authResolver.isAuthorized("removeResourceTagFromResource_ResourceTag_Resource_policy",[this.resource]),this.displayedColumns=this.removeAuth?["select","id","name"]:["id","name"]}applyFilter(e){this.filterValue=e}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(r.x4),u.Y36(i.xk),u.Y36(c.uw),u.Y36(r.V6),u.Y36(m.sK),u.Y36(r.fb))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-perun-web-apps-resource-tags"]],decls:10,vars:9,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","class","mr-2 action-button","color","accent",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"selection","tableId","resourceTags","filterValue","displayedColumns","entity",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2","action-button",3,"click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"selection","tableId","resourceTags","filterValue","displayedColumns","entity"]],template:function(e,t){1&e&&(u.TgZ(0,"h1",0),u._uU(1),u.ALo(2,"translate"),u.qZA(),u.TgZ(3,"perun-web-apps-refresh-button",1),u.NdJ("refresh",function(){return t.updateData()}),u.qZA(),u.YNc(4,T,3,3,"button",2),u.YNc(5,I,3,3,"button",2),u.YNc(6,Z,3,4,"button",3),u.TgZ(7,"perun-web-apps-immediate-filter",4),u.NdJ("filter",function(e){return t.applyFilter(e)}),u.qZA(),u.YNc(8,_,1,0,"mat-spinner",5),u.YNc(9,O,1,6,"app-resources-tags-list",6)),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,7,"RESOURCE_DETAIL.TAGS.TITLE")),u.xp6(3),u.Q6J("ngIf",t.createAuth),u.xp6(1),u.Q6J("ngIf",t.addAuth),u.xp6(1),u.Q6J("ngIf",t.removeAuth),u.xp6(1),u.Q6J("placeholder","RESOURCE_DETAIL.TAGS.SEARCH"),u.xp6(1),u.Q6J("ngIf",t.loading),u.xp6(1),u.Q6J("ngIf",!t.loading))},directives:[E.t,d.O5,R.L,h.lW,g.$g,p.o],pipes:[m.X$],styles:[""]}),e})()},24923:function(e,t,s){"use strict";s.d(t,{p:function(){return m}});var i=s(84608),a=s(65249),o=s(31572),n=s(61511),r=s(15980),l=s(67806),c=s(66283),u=s(80340),d=s(16073),h=s(48160);function g(e,t){1&e&&o._UZ(0,"mat-spinner",6)}function p(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"div",7),o.TgZ(1,"mat-form-field"),o.TgZ(2,"input",8),o.NdJ("ngModelChange",function(t){return o.CHM(e),o.oxw().name=t}),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"mat-error"),o._uU(5),o.ALo(6,"translate"),o.qZA(),o.qZA(),o.qZA()}if(2&e){const e=o.oxw();o.xp6(2),o.s9C("placeholder",o.lcZ(3,3,"DIALOGS.CREATE_RESOURCE_TAG.NAME")),o.Q6J("ngModel",e.name),o.xp6(3),o.Oqu(o.lcZ(6,5,"DIALOGS.CREATE_RESOURCE_TAG.EMPTY_NAME"))}}let m=(()=>{class e{constructor(e,t,s){this.dialogRef=e,this.data=t,this.resourceManager=s,this.name="",this.loading=!1}ngOnInit(){this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){""!==this.name&&(this.loading=!0,this.resourceManager.createResourceTagWithTagName(this.name,this.data.voId).subscribe(()=>{this.dialogRef.close(!0)},()=>this.loading=!1))}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(i.so),o.Y36(i.WI),o.Y36(a.xk))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-create-resource-tag-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-content","","class","dialog-container",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content","",1,"dialog-container"],["matInput","","required","",3,"placeholder","ngModel","ngModelChange"]],template:function(e,t){1&e&&(o.TgZ(0,"div"),o.TgZ(1,"h1",0),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.YNc(4,g,1,0,"mat-spinner",1),o.YNc(5,p,7,7,"div",2),o.TgZ(6,"div",3),o.TgZ(7,"button",4),o.NdJ("click",function(){return t.onCancel()}),o._uU(8),o.ALo(9,"translate"),o.qZA(),o.TgZ(10,"button",5),o.NdJ("click",function(){return t.onSubmit()}),o._uU(11),o.ALo(12,"translate"),o.qZA(),o.qZA(),o.qZA()),2&e&&(o.Tol(t.theme),o.xp6(2),o.Oqu(o.lcZ(3,9,"DIALOGS.CREATE_RESOURCE_TAG.TITLE")),o.xp6(2),o.Q6J("ngIf",t.loading),o.xp6(1),o.Q6J("ngIf",!t.loading),o.xp6(3),o.hij(" ",o.lcZ(9,11,"DIALOGS.CREATE_RESOURCE_TAG.CANCEL")," "),o.xp6(2),o.Q6J("disabled",t.loading),o.xp6(1),o.hij(" ",o.lcZ(12,13,"DIALOGS.CREATE_RESOURCE_TAG.CREATE")," "))},directives:[i.uh,n.O5,i.H8,r.lW,l.$g,i.xY,c.KE,u.Nt,d.Fj,d.Q7,d.JJ,d.On,c.TO],pipes:[h.X$],styles:[""]}),e})()},489:function(e,t,s){"use strict";s.d(t,{s:function(){return _e}});var i=s(4230),a=s(84608),o=s(68416),n=s(65249),r=s(60611),l=s(67004),c=s(16073),u=s(31572),d=s(48160),h=s(57629),g=s(66283),p=s(4786),m=s(61511),f=s(80340),A=s(84534),S=s(15980),b=s(71522),E=s(67806),R=s(39571),T=s(77889);let I=(()=>{class e{constructor(e){this.translate=e,this.prefix="ROLES."}transform(e){const t=this.prefix.concat(e);return this.translate.instant(t)}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(d.sK,16))},e.\u0275pipe=u.Yjl({name:"displayedRole",type:e,pure:!0}),e})();function Z(e,t){if(1&e&&(u.TgZ(0,"mat-option",15),u._uU(1),u.ALo(2,"displayedRole"),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e),u.xp6(1),u.Oqu(u.lcZ(2,2,e))}}function _(e,t){1&e&&u._UZ(0,"mat-spinner",16)}function O(e,t){1&e&&(u.TgZ(0,"app-alert",20),u._uU(1),u.ALo(2,"translate"),u.qZA()),2&e&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"DIALOGS.ADD_MANAGERS.NO_USERS_FOUND")," "))}const v=function(){return["select","id","name","email","logins","organization"]};function C(e,t){if(1&e&&u._UZ(0,"app-users-list",21),2&e){const e=u.oxw(2);u.Q6J("tableId",e.tableId)("disableRouting",!0)("selection",e.selection)("displayedColumns",u.DdM(5,v))("users",e.users)}}function y(e,t){if(1&e&&(u.TgZ(0,"div",17),u.YNc(1,O,3,3,"app-alert",18),u.YNc(2,C,1,6,"app-users-list",19),u.qZA()),2&e){const e=u.oxw();u.xp6(1),u.Q6J("ngIf",0===e.users.length&&e.firstSearchDone),u.xp6(1),u.Q6J("ngIf",0!==e.users.length)}}let x=(()=>{class e{constructor(e,t,s,a,o,n,l,c,u){this.dialogRef=e,this.data=t,this.authzService=s,this.usersService=a,this.translate=o,this.notificator=n,this.storeService=l,this.route=c,this.router=u,this.selection=new i.Ov(!0,[]),this.users=[],this.firstSearchDone=!1,this.tableId=r.H2,o.get("DIALOGS.ADD_MANAGERS.TITLE").subscribe(e=>this.title=e),o.get("DIALOGS.ADD_MANAGERS.SUCCESS").subscribe(e=>this.successMessage=e)}ngOnInit(){this.theme=this.data.theme,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.searchCtrl=new c.NI("",[c.kI.required,c.kI.pattern(".*[\\S]+.*")])}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.setRoleWithUserComplementaryObject({role:this.selectedRole,users:this.selection.selected.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)}onSearchByString(){if(this.searchCtrl.invalid)return void this.searchCtrl.markAllAsTouched();this.loading=!0,this.selection.clear();let e=[l.r.USER_DEF_ORGANIZATION,l.r.USER_DEF_PREFERRED_MAIL];e=e.concat(this.storeService.getLoginAttributeNames()),this.usersService.findRichUsersWithAttributes(this.searchCtrl.value,e).subscribe(e=>{this.users=e,this.loading=!1,this.firstSearchDone=!0},()=>this.loading=!1)}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(a.so),u.Y36(a.WI),u.Y36(n.Ct),u.Y36(n.Fv),u.Y36(d.sK),u.Y36(o.V6),u.Y36(o.d6),u.Y36(h.gz),u.Y36(h.F0))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-add-manager-dialog"]],decls:32,vars:31,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"mr-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"mr-2","w-100"],["matInput","","autocomplete","false","data-cy","search-manager-input","perunWebAppsAutoFocus","",3,"placeholder","formControl","keyup.enter"],["mat-flat-button","","color","accent","data-cy","search-manager-button",1,"ml-auto",3,"disabled","click"],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent","data-cy","add-manager-button-dialog",1,"ml-2",3,"disabled","click"],[3,"value"],[1,"mr-auto","ml-auto"],[1,"mt-3"],["alert_type","warn",4,"ngIf"],[3,"tableId","disableRouting","selection","displayedColumns","users",4,"ngIf"],["alert_type","warn"],[3,"tableId","disableRouting","selection","displayedColumns","users"]],template:function(e,t){1&e&&(u.TgZ(0,"div"),u.TgZ(1,"h1",0),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"div",1),u.TgZ(5,"div",2),u.TgZ(6,"mat-form-field",3),u.TgZ(7,"mat-label"),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.TgZ(10,"mat-select",4),u.NdJ("valueChange",function(e){return t.selectedRole=e}),u.YNc(11,Z,3,4,"mat-option",5),u.qZA(),u.qZA(),u.TgZ(12,"mat-form-field",6),u.TgZ(13,"label"),u.TgZ(14,"input",7),u.NdJ("keyup.enter",function(){return t.onSearchByString()}),u.ALo(15,"translate"),u.qZA(),u.qZA(),u.TgZ(16,"mat-error"),u._uU(17),u.ALo(18,"translate"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(19,"button",8),u.NdJ("click",function(){return t.onSearchByString()}),u._uU(20),u.ALo(21,"translate"),u.qZA(),u.TgZ(22,"div",9),u.YNc(23,_,1,0,"mat-spinner",10),u.qZA(),u.YNc(24,y,3,2,"div",11),u.qZA(),u.TgZ(25,"div",12),u.TgZ(26,"button",13),u.NdJ("click",function(){return t.onCancel()}),u._uU(27),u.ALo(28,"translate"),u.qZA(),u.TgZ(29,"button",14),u.NdJ("click",function(){return t.onSubmit()}),u._uU(30),u.ALo(31,"translate"),u.qZA(),u.qZA(),u.qZA()),2&e&&(u.Tol(t.theme),u.xp6(2),u.Oqu(u.lcZ(3,17,"DIALOGS.ADD_MANAGERS.TITLE")),u.xp6(6),u.Oqu(u.lcZ(9,19,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),u.xp6(2),u.Q6J("value",t.selectedRole),u.xp6(1),u.Q6J("ngForOf",t.availableRoles),u.xp6(3),u.s9C("placeholder",u.lcZ(15,21,"DIALOGS.ADD_MANAGERS.DESCRIPTION")),u.Q6J("formControl",t.searchCtrl),u.xp6(3),u.hij(" ",u.lcZ(18,23,"DIALOGS.ADD_MANAGERS.EMPTY_SEARCH_MESSAGE")," "),u.xp6(2),u.Q6J("disabled",t.loading),u.xp6(1),u.hij(" ",u.lcZ(21,25,"DIALOGS.ADD_MANAGERS.SEARCH")," "),u.xp6(3),u.Q6J("ngIf",t.loading),u.xp6(1),u.Q6J("ngIf",null!==t.users&&!t.loading),u.xp6(3),u.hij(" ",u.lcZ(28,27,"DIALOGS.ADD_MANAGERS.CANCEL")," "),u.xp6(2),u.Q6J("disabled",0===t.selection.selected.length||void 0===t.selectedRole||t.loading),u.xp6(1),u.hij(" ",u.lcZ(31,29,"DIALOGS.ADD_MANAGERS.CREATE")," "))},directives:[a.uh,a.xY,g.KE,g.hX,p.gD,m.sg,f.Nt,c.Fj,A.hT,c.JJ,c.oH,g.TO,S.lW,m.O5,a.H8,b.ey,E.$g,R.w,T.C],pipes:[d.X$,I],styles:[".inline-dialog-items[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]}),e})();var U=s(67033);function N(e,t){1&e&&u._UZ(0,"th",15)}function G(e,t){if(1&e&&(u.TgZ(0,"td",16),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.xp6(1),u.AsE("",e.firstName," ",e.lastName,"")}}function D(e,t){1&e&&u._UZ(0,"tr",17)}function L(e,t){1&e&&u._UZ(0,"tr",18)}const w=function(e){return{role:e}};function M(e,t){if(1&e&&(u.TgZ(0,"app-alert",19),u._uU(1),u.ALo(2,"translate"),u.ALo(3,"displayedRole"),u.qZA()),2&e){const e=u.oxw(2);u.xp6(1),u.hij(" ",u.xi3(2,1,"DIALOGS.REMOVE_MANAGERS.WARNING_REMOVE_YOURSELF",u.VKq(6,w,u.lcZ(3,4,e.data.role)))," ")}}function Y(e,t){if(1&e&&(u.TgZ(0,"div",6),u.TgZ(1,"p"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"div",7),u._uU(5),u.ALo(6,"translate"),u.qZA(),u.TgZ(7,"table",8),u.ynx(8,9),u.YNc(9,N,1,0,"th",10),u.YNc(10,G,2,2,"td",11),u.BQk(),u.YNc(11,D,1,0,"tr",12),u.YNc(12,L,1,0,"tr",13),u.qZA(),u.YNc(13,M,4,8,"app-alert",14),u.qZA()),2&e){const e=u.oxw();u.xp6(2),u.hij(" ",u.lcZ(3,6,"DIALOGS.REMOVE_MANAGERS.DESCRIPTION")," "),u.xp6(3),u.hij(" ",u.lcZ(6,8,"DIALOGS.REMOVE_MANAGERS.ASK")," "),u.xp6(2),u.Q6J("dataSource",e.dataSource),u.xp6(4),u.Q6J("matHeaderRowDef",e.displayedColumns),u.xp6(1),u.Q6J("matRowDefColumns",e.displayedColumns),u.xp6(1),u.Q6J("ngIf",e.removeSelf)}}function q(e,t){1&e&&u._UZ(0,"mat-spinner",20)}let J=(()=>{class e{constructor(e,t,s,i,a,o,n){this.dialogRef=e,this.data=t,this.notificator=s,this.translate=i,this.authzService=a,this.store=o,this.authService=n,this.displayedColumns=["name"]}ngOnInit(){this.dataSource=new U.by(this.data.managers),this.theme=this.data.theme,this.removeSelf=this.data.managers.map(e=>e.id).includes(this.store.getPerunPrincipal().userId)&&!this.authService.isPerunAdmin()}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithUserComplementaryObject({role:this.data.role,users:this.data.managers.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_MANAGERS.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)},()=>this.loading=!1)}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(a.so),u.Y36(a.WI),u.Y36(o.V6),u.Y36(d.sK),u.Y36(n.Ct),u.Y36(o.d6),u.Y36(o.x4))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-remove-manager-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content","",4,"ngIf"],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn","data-cy","remove-manager-button-dialog",1,"ml-2",3,"disabled","click"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""],["alert_type","warn"],[1,"mr-auto","ml-auto"]],template:function(e,t){1&e&&(u.TgZ(0,"div"),u.TgZ(1,"h1",0),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.YNc(4,Y,14,10,"div",1),u.YNc(5,q,1,0,"mat-spinner",2),u.TgZ(6,"div",3),u.TgZ(7,"button",4),u.NdJ("click",function(){return t.onCancel()}),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.TgZ(10,"button",5),u.NdJ("click",function(){return t.onSubmit()}),u._uU(11),u.ALo(12,"translate"),u.qZA(),u.qZA(),u.qZA()),2&e&&(u.Tol(t.theme),u.xp6(2),u.Oqu(u.lcZ(3,9,"DIALOGS.REMOVE_MANAGERS.TITLE")),u.xp6(2),u.Q6J("ngIf",!t.loading),u.xp6(1),u.Q6J("ngIf",t.loading),u.xp6(3),u.hij(" ",u.lcZ(9,11,"DIALOGS.REMOVE_MANAGERS.CANCEL")," "),u.xp6(2),u.Q6J("disabled",t.loading),u.xp6(1),u.hij(" ",u.lcZ(12,13,"DIALOGS.REMOVE_MANAGERS.DELETE")," "))},directives:[a.uh,m.O5,a.H8,S.lW,a.xY,U.BZ,U.w1,U.fO,U.Dz,U.as,U.nj,U.ge,U.ev,U.XQ,U.Gk,R.w,E.$g],pipes:[d.X$,I],styles:[""]}),e})();function k(e,t){1&e&&u._UZ(0,"mat-spinner",6)}function P(e,t){1&e&&u._UZ(0,"th",15)}function Q(e,t){if(1&e&&(u.TgZ(0,"td",16),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.xp6(1),u.Oqu(e.name)}}function V(e,t){1&e&&u._UZ(0,"tr",17)}function F(e,t){1&e&&u._UZ(0,"tr",18)}function j(e,t){if(1&e&&(u.TgZ(0,"div",7),u.TgZ(1,"p"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"div",8),u._uU(5),u.ALo(6,"translate"),u.qZA(),u.TgZ(7,"table",9),u.ynx(8,10),u.YNc(9,P,1,0,"th",11),u.YNc(10,Q,2,1,"td",12),u.BQk(),u.YNc(11,V,1,0,"tr",13),u.YNc(12,F,1,0,"tr",14),u.qZA(),u.qZA()),2&e){const e=u.oxw();u.xp6(2),u.hij(" ",u.lcZ(3,5,"DIALOGS.REMOVE_GROUPS.DESCRIPTION")," "),u.xp6(3),u.hij(" ",u.lcZ(6,7,"DIALOGS.REMOVE_GROUPS.ASK")," "),u.xp6(2),u.Q6J("dataSource",e.dataSource),u.xp6(4),u.Q6J("matHeaderRowDef",e.displayedColumns),u.xp6(1),u.Q6J("matRowDefColumns",e.displayedColumns)}}let H=(()=>{class e{constructor(e,t,s,i,a){this.dialogRef=e,this.data=t,this.notificator=s,this.translate=i,this.authzService=a,this.displayedColumns=["name"]}ngOnInit(){this.dataSource=new U.by(this.data.groups),this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithGroupComplementaryObject({role:this.data.role,authorizedGroups:this.data.groups.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUPS.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)},()=>this.loading=!1)}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(a.so),u.Y36(a.WI),u.Y36(o.V6),u.Y36(d.sK),u.Y36(n.Ct))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-remove-group-manager-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(u.TgZ(0,"div"),u.TgZ(1,"h1",0),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.YNc(4,k,1,0,"mat-spinner",1),u.YNc(5,j,13,9,"div",2),u.TgZ(6,"div",3),u.TgZ(7,"button",4),u.NdJ("click",function(){return t.onCancel()}),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.TgZ(10,"button",5),u.NdJ("click",function(){return t.onSubmit()}),u._uU(11),u.ALo(12,"translate"),u.qZA(),u.qZA(),u.qZA()),2&e&&(u.Tol(t.theme),u.xp6(2),u.Oqu(u.lcZ(3,9,"DIALOGS.REMOVE_GROUPS.TITLE")),u.xp6(2),u.Q6J("ngIf",t.loading),u.xp6(1),u.Q6J("ngIf",!t.loading),u.xp6(3),u.hij(" ",u.lcZ(9,11,"DIALOGS.REMOVE_GROUPS.CANCEL")," "),u.xp6(2),u.Q6J("disabled",t.loading),u.xp6(1),u.hij(" ",u.lcZ(12,13,"DIALOGS.REMOVE_GROUPS.DELETE")," "))},directives:[a.uh,m.O5,a.H8,S.lW,E.$g,a.xY,U.BZ,U.w1,U.fO,U.Dz,U.as,U.nj,U.ge,U.ev,U.XQ,U.Gk],pipes:[d.X$],styles:[""]}),e})();var z=s(56238),$=s(79996),B=s(40084),X=s(91058),W=s(78364);function K(e,t){if(1&e&&(u.TgZ(0,"mat-option",17),u._uU(1),u.ALo(2,"displayedRole"),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e),u.xp6(1),u.Oqu(u.lcZ(2,2,e))}}function ee(e,t){if(1&e&&(u.TgZ(0,"mat-option",17),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e),u.xp6(1),u.hij(" ",e.name," ")}}function te(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"perun-web-apps-debounce-filter",18),u.NdJ("filter",function(t){return u.CHM(e),u.oxw().applyFilter(t)}),u.ALo(1,"translate"),u.qZA()}2&e&&u.s9C("placeholder",u.lcZ(1,1,"DIALOGS.ADD_GROUPS.FILTER_GROUPS"))}function se(e,t){1&e&&u._UZ(0,"mat-spinner",19)}const ie=function(){return["select","id","name","description"]};function ae(e,t){if(1&e&&(u.TgZ(0,"div",20),u._UZ(1,"perun-web-apps-groups-list",21),u.qZA()),2&e){const e=u.oxw();u.xp6(1),u.Q6J("tableId",e.tableId)("disableRouting",!0)("displayedColumns",u.DdM(7,ie))("selection",e.selection)("filter",e.filterValue)("groups",e.groups)("disableMembers",!1)}}let oe=(()=>{class e{constructor(e,t,s,a,o,n,l,u,d){this.dialogRef=e,this.data=t,this.authzService=s,this.voService=a,this.groupService=o,this.translate=n,this.notificator=l,this.route=u,this.router=d,this.searchString="",this.selection=new i.Ov(!0,[]),this.groups=[],this.vos=[],this.filterValue="",this.myControl=new c.NI,this.firstSearchDone=!1,this.tableId=r.kZ,n.get("DIALOGS.ADD_GROUPS.TITLE").subscribe(e=>this.title=e),n.get("DIALOGS.ADD_GROUPS.SUCCESS").subscribe(e=>this.successMessage=e)}displayFn(e){return e?e.name:null}onCancel(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.authzService.setRoleWithGroupComplementaryObject({role:this.selectedRole,authorizedGroups:this.selection.selected.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)}ngOnInit(){this.loading=!0,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.theme=this.data.theme,this.voService.getMyVos().subscribe(e=>{this.filteredOptions=this.myControl.valueChanges.pipe((0,z.O)(""),(0,$.U)(e=>this._filter(e))),this.vos=e,this.loading=!1},()=>this.loading=!1)}_filter(e){const t="string"==typeof e?e.toLowerCase():e.name.toLowerCase;return this.vos.filter(e=>e.name.toLowerCase().includes(t))}showVoGroups(e){this.loading=!0,this.groupService.getAllGroups(e.option.value.id).subscribe(e=>{this.groups=e,this.loading=!1,this.firstSearchDone=!0},()=>this.loading=!1)}applyFilter(e){this.filterValue=e}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(a.so),u.Y36(a.WI),u.Y36(n.Ct),u.Y36(n.YF),u.Y36(n.ff),u.Y36(d.sK),u.Y36(o.V6),u.Y36(h.gz),u.Y36(h.F0))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-add-group-manager-dialog"]],decls:33,vars:33,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"mr-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"mr-2","w-75"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"placeholder","filter",4,"ngIf"],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[3,"value"],[3,"placeholder","filter"],[1,"mr-auto","ml-auto"],[1,"mt-3"],[3,"tableId","disableRouting","displayedColumns","selection","filter","groups","disableMembers"]],template:function(e,t){if(1&e&&(u.TgZ(0,"div"),u.TgZ(1,"h1",0),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"div",1),u.TgZ(5,"div",2),u.TgZ(6,"mat-form-field",3),u.TgZ(7,"mat-label"),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.TgZ(10,"mat-select",4),u.NdJ("valueChange",function(e){return t.selectedRole=e}),u.YNc(11,K,3,4,"mat-option",5),u.qZA(),u.qZA(),u.TgZ(12,"mat-form-field",6),u.TgZ(13,"mat-label"),u._uU(14),u.ALo(15,"translate"),u.qZA(),u._UZ(16,"input",7),u.ALo(17,"translate"),u.TgZ(18,"mat-autocomplete",8,9),u.NdJ("optionSelected",function(e){return t.showVoGroups(e)}),u.YNc(20,ee,2,2,"mat-option",5),u.ALo(21,"async"),u.qZA(),u.qZA(),u.qZA(),u.YNc(22,te,2,3,"perun-web-apps-debounce-filter",10),u.TgZ(23,"div",11),u.YNc(24,se,1,0,"mat-spinner",12),u.qZA(),u.YNc(25,ae,2,8,"div",13),u.qZA(),u.TgZ(26,"div",14),u.TgZ(27,"button",15),u.NdJ("click",function(){return t.onCancel()}),u._uU(28),u.ALo(29,"translate"),u.qZA(),u.TgZ(30,"button",16),u.NdJ("click",function(){return t.onSubmit()}),u._uU(31),u.ALo(32,"translate"),u.qZA(),u.qZA(),u.qZA()),2&e){const e=u.MAs(19);u.Tol(t.theme),u.xp6(2),u.Oqu(u.lcZ(3,19,"DIALOGS.ADD_GROUPS.TITLE")),u.xp6(6),u.Oqu(u.lcZ(9,21,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),u.xp6(2),u.Q6J("value",t.selectedRole),u.xp6(1),u.Q6J("ngForOf",t.availableRoles),u.xp6(3),u.Oqu(u.lcZ(15,23,"DIALOGS.ADD_GROUPS.SELECT_VO")),u.xp6(2),u.s9C("placeholder",u.lcZ(17,25,"DIALOGS.ADD_GROUPS.SELECT_VO")),u.Q6J("formControl",t.myControl)("matAutocomplete",e),u.xp6(2),u.Q6J("displayWith",t.displayFn),u.xp6(2),u.Q6J("ngForOf",u.lcZ(21,27,t.filteredOptions)),u.xp6(2),u.Q6J("ngIf",null!==t.groups&&t.groups.length>0&&!t.loading),u.xp6(2),u.Q6J("ngIf",t.loading),u.xp6(1),u.Q6J("ngIf",null!==t.groups&&!t.loading),u.xp6(3),u.hij(" ",u.lcZ(29,29,"DIALOGS.ADD_MANAGERS.CANCEL")," "),u.xp6(2),u.Q6J("disabled",0===t.selection.selected.length||t.loading),u.xp6(1),u.hij(" ",u.lcZ(32,31,"DIALOGS.ADD_MANAGERS.CREATE")," ")}},directives:[a.uh,a.xY,g.KE,g.hX,p.gD,m.sg,f.Nt,c.Fj,B.ZL,c.JJ,c.oH,B.XC,m.O5,a.H8,S.lW,b.ey,X.P,E.$g,W.W],pipes:[d.X$,m.Ov,I],styles:[""]}),e})();var ne=s(84140),re=s(24820),le=s(55109),ce=s(59403);function ue(e,t){1&e&&(u._uU(0),u.ALo(1,"translate")),2&e&&u.hij(" ",u.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.USER")," ")}function de(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",13),u.NdJ("click",function(){return u.CHM(e),u.oxw(2).addManager()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}2&e&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function he(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",14),u.NdJ("click",function(){return u.CHM(e),u.oxw(2).removeManager()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}if(2&e){const e=u.oxw(2);u.Q6J("disabled",0===e.selectionUsers.selected.length),u.xp6(1),u.hij(" ",u.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function ge(e,t){if(1&e&&(u.TgZ(0,"mat-option",15),u._uU(1),u.ALo(2,"displayedRole"),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e),u.xp6(1),u.Oqu(u.lcZ(2,2,e))}}function pe(e,t){1&e&&u._UZ(0,"mat-spinner",16)}function me(e,t){if(1&e&&u._UZ(0,"app-users-list",17),2&e){const e=u.oxw(2);u.Q6J("tableId",e.tableId)("users",e.managers)("disableRouting",!e.routeAuth||e.disableRouting)("displayedColumns",e.displayedUserColumns)("selection",e.selectionUsers)("disableSelf",e.disableSelf)}}function fe(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"perun-web-apps-refresh-button",5),u.NdJ("refresh",function(){return u.CHM(e),u.oxw().refreshUsers()}),u.qZA(),u.YNc(1,de,3,3,"button",6),u.YNc(2,he,3,4,"button",7),u.TgZ(3,"mat-form-field",8),u.TgZ(4,"mat-label"),u._uU(5),u.ALo(6,"translate"),u.qZA(),u.TgZ(7,"mat-select",9),u.NdJ("valueChange",function(t){return u.CHM(e),u.oxw().selectedRole=t})("selectionChange",function(){return u.CHM(e),u.oxw().refreshUsers()}),u.YNc(8,ge,3,4,"mat-option",10),u.qZA(),u.qZA(),u.YNc(9,pe,1,0,"mat-spinner",11),u.YNc(10,me,1,6,"app-users-list",12)}if(2&e){const e=u.oxw();u.xp6(1),u.Q6J("ngIf",e.manageAuth&&!e.configMode),u.xp6(1),u.Q6J("ngIf",e.manageAuth&&!e.configMode),u.xp6(3),u.Oqu(u.lcZ(6,7,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),u.xp6(2),u.Q6J("value",e.selectedRole),u.xp6(1),u.Q6J("ngForOf",e.availableRoles),u.xp6(1),u.Q6J("ngIf",e.loading),u.xp6(1),u.Q6J("ngIf",!e.loading&&e.managers)}}function Ae(e,t){1&e&&(u._uU(0),u.ALo(1,"translate")),2&e&&u.hij(" ",u.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.GROUP")," ")}function Se(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",21),u.NdJ("click",function(){return u.CHM(e),u.oxw(2).addGroup()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}2&e&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function be(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",22),u.NdJ("click",function(){return u.CHM(e),u.oxw(2).removeGroup()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}if(2&e){const e=u.oxw(2);u.Q6J("disabled",0===e.selectionGroups.selected.length),u.xp6(1),u.hij(" ",u.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function Ee(e,t){if(1&e&&(u.TgZ(0,"mat-option",15),u._uU(1),u.ALo(2,"displayedRole"),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e),u.xp6(1),u.Oqu(u.lcZ(2,2,e))}}function Re(e,t){1&e&&u._UZ(0,"mat-spinner",16)}function Te(e,t){if(1&e&&u._UZ(0,"perun-web-apps-groups-list",23),2&e){const e=u.oxw(2);u.Q6J("tableId",e.tableId)("disableRouting",e.disableRouting)("displayedColumns",e.displayedGroupColumns)("groups",e.groups)("selection",e.selectionGroups)("disableMembers",!1)}}function Ie(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"perun-web-apps-refresh-button",5),u.NdJ("refresh",function(){return u.CHM(e),u.oxw().refreshGroups()}),u.qZA(),u.YNc(1,Se,3,3,"button",18),u.YNc(2,be,3,4,"button",19),u.TgZ(3,"mat-form-field",8),u.TgZ(4,"mat-label"),u._uU(5),u.ALo(6,"translate"),u.qZA(),u.TgZ(7,"mat-select",9),u.NdJ("valueChange",function(t){return u.CHM(e),u.oxw().selectedRole=t})("selectionChange",function(){return u.CHM(e),u.oxw().refreshGroups()}),u.YNc(8,Ee,3,4,"mat-option",10),u.qZA(),u.qZA(),u.YNc(9,Re,1,0,"mat-spinner",11),u.YNc(10,Te,1,6,"perun-web-apps-groups-list",20)}if(2&e){const e=u.oxw();u.xp6(1),u.Q6J("ngIf",e.manageAuth&&!e.configMode),u.xp6(1),u.Q6J("ngIf",e.manageAuth&&!e.configMode),u.xp6(3),u.Oqu(u.lcZ(6,7,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),u.xp6(2),u.Q6J("value",e.selectedRole),u.xp6(1),u.Q6J("ngForOf",e.availableRoles),u.xp6(1),u.Q6J("ngIf",e.loading),u.xp6(1),u.Q6J("ngIf",!e.loading&&e.groups)}}function Ze(e,t){1&e&&(u.TgZ(0,"app-alert",24),u._uU(1),u.ALo(2,"translate"),u.qZA()),2&e&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.NO_AVAILABLE_ROLES"),"\n"))}let _e=(()=>{class e{constructor(e,t,s,a,o,n,l){this.dialog=e,this.authzService=t,this.storeService=s,this.guiAuthResolver=a,this.router=o,this.reloadEntityDetail=n,this.route=l,this.groups=null,this.managers=null,this.configMode=!1,this.disableRouting=!1,this.disableSelf=!1,this.displayedUserColumns=["select","id","name","email","logins","organization"],this.displayedGroupColumns=["select","id","vo","name","description"],this.selectionUsers=new i.Ov(!0,[]),this.selectionGroups=new i.Ov(!0,[]),this.selectedMode="",this.loading=!1,this.tableId=r.HC,this.availableRolesPrivileges=new Map}ngOnInit(){this.loading=!0,this.routeAuth=this.guiAuthResolver.isPerunAdminOrObserver(),this.guiAuthResolver.getRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(e=>this.availableRolesPrivileges.get(e).readAuth),0!==this.availableRoles.length&&(this.selectedRole=this.availableRoles[0]),this.refreshUsers()}changeRolePrivileges(){this.guiAuthResolver.getRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(e=>this.availableRolesPrivileges.get(e).readAuth),this.manageAuth=this.availableRolesPrivileges.get(this.selectedRole).manageAuth,this.displayedUserColumns=this.manageAuth?this.displayedUserColumns:this.displayedUserColumns.filter(e=>"select"!==e),this.displayedGroupColumns=this.manageAuth?this.displayedGroupColumns:this.displayedGroupColumns.filter(e=>"select"!==e),this.roleModes=this.availableRolesPrivileges.get(this.selectedRole).modes;let e=!1;for(const t of this.roleModes)if(this.selectedMode===t.toLowerCase()){e=!0;break}e||(this.selectedMode=this.roleModes[0].toLowerCase())}tabChanged(e){this.loading=!0,0===e.index?(this.selectedMode="user",this.refreshUsers()):(this.selectedMode="group",this.refreshGroups())}refreshUsers(){this.loading=!0,this.changeRolePrivileges();let e=[l.r.USER_DEF_ORGANIZATION,l.r.USER_DEF_PREFERRED_MAIL];e=e.concat(this.storeService.getLoginAttributeNames()),this.authzService.getAuthzRichAdmins(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType,e,!1,!0).subscribe(e=>{this.managers=e,this.selectionUsers.clear(),this.loading=!1},()=>{this.loading=!1})}refreshGroups(){this.loading=!0,this.changeRolePrivileges(),this.authzService.getAuthzAdminGroups(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType).subscribe(e=>{this.groups=e,this.selectionGroups.clear(),this.loading=!1},()=>{this.loading=!1})}addManager(){const e=(0,ne.kZ)();e.width="1000px",e.data={complementaryObject:this.complementaryObject,theme:this.theme,availableRoles:this.availableRoles,selectedRole:this.selectedRole},this.dialog.open(x,e).afterClosed().subscribe(e=>{e&&this.refreshUsers()})}removeManager(){const e=(0,ne.kZ)();e.width="450px",e.data={managers:this.selectionUsers.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(J,e).afterClosed().subscribe(e=>{e&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?(this.reloadEntityDetail.reloadEntityDetail(),this.refreshUsers()):this.redirectToAuthRoute())})}removeGroup(){const e=(0,ne.kZ)();e.width="450px",e.data={groups:this.selectionGroups.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(H,e).afterClosed().subscribe(e=>{e&&(this.guiAuthResolver.isManagerPagePrivileged(this.complementaryObject)?(this.reloadEntityDetail.reloadEntityDetail(),this.refreshGroups()):this.redirectToAuthRoute())})}addGroup(){const e=(0,ne.kZ)();e.width="1000px",e.data={complementaryObject:this.complementaryObject,availableRoles:this.availableRoles,theme:this.theme,selectedRole:this.selectedRole},this.dialog.open(oe,e).afterClosed().subscribe(e=>{e&&this.refreshGroups()})}redirectToAuthRoute(){if("Group"===this.complementaryObjectType&&(this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])||this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])))this.guiAuthResolver.isAuthorized("getGroupById_int_policy",[this.complementaryObject])?this.router.navigate(["/organizations",this.complementaryObject.voId,"groups",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"}):this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject])&&this.router.navigate(["/organizations",this.complementaryObject.voId],{queryParamsHandling:"merge"});else if("Facility"===this.complementaryObjectType&&this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.complementaryObject]))this.router.navigate(["/facilities",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else if("Vo"===this.complementaryObjectType&&this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.complementaryObject]))this.router.navigate(["/organizations",this.complementaryObject.id],{relativeTo:this.route,queryParamsHandling:"merge"});else{if("Resource"!==this.complementaryObjectType||!this.guiAuthResolver.isAuthorized("getRichResourceById_int_policy",[this.complementaryObject]))return void this.router.navigate(["/home"],{queryParamsHandling:"merge"});this.router.navigate(["../../"],{relativeTo:this.route,queryParamsHandling:"merge"})}this.reloadEntityDetail.reloadEntityDetail()}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(a.uw),u.Y36(n.Ct),u.Y36(o.d6),u.Y36(o.x4),u.Y36(h.F0),u.Y36(re.G),u.Y36(h.gz))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-managers-page"]],hostVars:2,hostBindings:function(e,t){2&e&&u.ekj("router-component",t.true)},inputs:{complementaryObject:"complementaryObject",availableRoles:"availableRoles",complementaryObjectType:"complementaryObjectType",theme:"theme",configMode:"configMode",disableRouting:"disableRouting",disableSelf:"disableSelf",displayedUserColumns:"displayedUserColumns",displayedGroupColumns:"displayedGroupColumns"},decls:11,vars:4,consts:[[1,"page-subtitle"],[3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["alert_type","warn",4,"ngIf"],[1,"mt-2",3,"refresh"],["mat-flat-button","","color","accent","class","mr-2 mt-2 action-button","data-cy","add-manager-button",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2 mt-2","data-cy","remove-manager-button",3,"disabled","click",4,"ngIf"],[1,"mr-2","mt-2"],[3,"value","valueChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","users","disableRouting","displayedColumns","selection","disableSelf",4,"ngIf"],["mat-flat-button","","color","accent","data-cy","add-manager-button",1,"mr-2","mt-2","action-button",3,"click"],["mat-flat-button","","color","warn","data-cy","remove-manager-button",1,"mr-2","mt-2",3,"disabled","click"],[3,"value"],[1,"ml-auto","mr-auto"],[3,"tableId","users","disableRouting","displayedColumns","selection","disableSelf"],["mat-flat-button","","color","accent","class","mr-2 mt-2 action-button",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2 mt-2",3,"disabled","click",4,"ngIf"],[3,"tableId","disableRouting","displayedColumns","groups","selection","disableMembers",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2","mt-2","action-button",3,"click"],["mat-flat-button","","color","warn",1,"mr-2","mt-2",3,"disabled","click"],[3,"tableId","disableRouting","displayedColumns","groups","selection","disableMembers"],["alert_type","warn"]],template:function(e,t){1&e&&(u.TgZ(0,"h1",0),u._uU(1),u.ALo(2,"translate"),u.qZA(),u.TgZ(3,"mat-tab-group",1),u.NdJ("selectedTabChange",function(e){return t.tabChanged(e)}),u.TgZ(4,"mat-tab"),u.YNc(5,ue,2,3,"ng-template",2),u.YNc(6,fe,11,9,"ng-template",3),u.qZA(),u.TgZ(7,"mat-tab"),u.YNc(8,Ae,2,3,"ng-template",2),u.YNc(9,Ie,11,9,"ng-template",3),u.qZA(),u.qZA(),u.YNc(10,Ze,3,3,"app-alert",4)),2&e&&(u.xp6(1),u.hij(" ",u.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.TITLE"),"\n"),u.xp6(9),u.Q6J("ngIf",0===t.availableRoles.length))},directives:[le.SP,le.uX,le.uD,le.Vc,m.O5,ce.t,g.KE,g.hX,p.gD,m.sg,S.lW,b.ey,E.$g,T.C,W.W,R.w],pipes:[d.X$,I],styles:[""]}),e})()},4196:function(e,t,s){"use strict";s.d(t,{o:function(){return M}});var i=s(58623),a=s(67033),o=s(4230),n=s(68416),r=s(65249),l=s(84140),c=s(31572),u=s(48160),d=s(82819),h=s(61511),g=s(29236),p=s(66283),m=s(80340),f=s(16073),A=s(15980),S=s(36922),b=s(43691),E=s(39571);function R(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"th",16),c.TgZ(1,"mat-checkbox",17),c.NdJ("change",function(t){c.CHM(e);const s=c.oxw();return t?s.masterToggle():null}),c.qZA(),c.qZA()}if(2&e){const e=c.oxw();c.xp6(1),c.Q6J("aria-label",e.checkboxLabel())("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())}}function T(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"td",18),c.TgZ(1,"mat-checkbox",19),c.NdJ("change",function(t){const s=c.CHM(e).$implicit,i=c.oxw();return t?i.selection.toggle(s):null})("click",function(e){return e.stopPropagation()}),c.qZA(),c.qZA()}if(2&e){const e=t.$implicit,s=c.oxw();c.xp6(1),c.Q6J("aria-label",s.checkboxLabel(e))("checked",s.selection.isSelected(e))}}function I(e,t){1&e&&(c.TgZ(0,"th",20),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&e&&(c.xp6(1),c.hij(" ",c.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_ID")," "))}function Z(e,t){if(1&e&&(c.TgZ(0,"td",21),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.xp6(1),c.Oqu(e.id)}}function _(e,t){1&e&&(c.TgZ(0,"th",22),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&e&&(c.xp6(1),c.hij(" ",c.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.TAG_NAME")," "))}function O(e,t){if(1&e&&(c.TgZ(0,"div"),c._uU(1),c.qZA()),2&e){const e=c.oxw().$implicit;c.xp6(1),c.hij(" ",e.tagName," ")}}function v(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div"),c.TgZ(1,"mat-form-field"),c.TgZ(2,"input",25),c.NdJ("ngModelChange",function(t){return c.CHM(e),c.oxw().$implicit.tagName=t}),c.qZA(),c.qZA(),c.qZA()}if(2&e){const e=c.oxw().$implicit;c.xp6(2),c.Q6J("ngModel",e.tagName)}}function C(e,t){if(1&e&&(c.TgZ(0,"td",23),c.YNc(1,O,2,1,"div",24),c.YNc(2,v,3,1,"div",24),c.qZA()),2&e){const e=t.$implicit,s=c.oxw();c.xp6(1),c.Q6J("ngIf",!s.isChanging.isSelected(e)),c.xp6(1),c.Q6J("ngIf",s.isChanging.isSelected(e))}}function y(e,t){1&e&&c._UZ(0,"th",22)}function x(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",28),c.NdJ("click",function(){c.CHM(e);const t=c.oxw().$implicit;return c.oxw().edit(t)}),c.ALo(1,"translate"),c.TgZ(2,"mat-icon"),c._uU(3,"edit"),c.qZA(),c.qZA()}2&e&&c.s9C("matTooltip",c.lcZ(1,1,"VO_DETAIL.RESOURCES.TAGS.EDIT_BUTTON"))}function U(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",28),c.NdJ("click",function(){c.CHM(e);const t=c.oxw().$implicit;return c.oxw().save(t)}),c.ALo(1,"translate"),c.TgZ(2,"mat-icon"),c._uU(3,"save"),c.qZA(),c.qZA()}2&e&&c.s9C("matTooltip",c.lcZ(1,1,"VO_DETAIL.RESOURCES.TAGS.SAVE_BUTTON"))}function N(e,t){if(1&e&&(c.TgZ(0,"td",23),c.TgZ(1,"div",26),c.YNc(2,x,4,3,"button",27),c.YNc(3,U,4,3,"button",27),c.qZA(),c.qZA()),2&e){const e=t.$implicit,s=c.oxw();c.xp6(2),c.Q6J("ngIf",!s.isChanging.isSelected(e)),c.xp6(1),c.Q6J("ngIf",s.isChanging.isSelected(e))}}function G(e,t){1&e&&c._UZ(0,"tr",29)}function D(e,t){1&e&&c._UZ(0,"tr",30)}function L(e,t){if(1&e&&(c.TgZ(0,"app-alert",31),c._uU(1),c.ALo(2,"translate"),c.ALo(3,"translate"),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.hij(" ","vo"===e.entity?c.lcZ(2,1,"VO_DETAIL.RESOURCES.TAGS.NO_TAGS"):c.lcZ(3,3,"RESOURCE_DETAIL.TAGS.NO_TAGS"),"\n")}}function w(e,t){1&e&&(c.TgZ(0,"app-alert",31),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&e&&(c.xp6(1),c.hij(" ",c.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}let M=(()=>{class e{constructor(e,t,s,i,a){this.resourceManager=e,this.notificator=t,this.translator=s,this.authResolver=i,this.tableCheckbox=a,this.resourceTags=[],this.selection=new o.Ov(!0,[]),this.displayedColumns=["select","id","name","edit"],this.isChanging=new o.Ov(!0,[]),this.pageSizeOptions=l.f7}set matSort(e){this.sort=e,this.setDataSource()}ngOnChanges(){this.authResolver.isPerunAdminOrObserver()||(this.displayedColumns=this.displayedColumns.filter(e=>"id"!==e)),this.dataSource=new a.by(this.resourceTags),this.setDataSource()}ngAfterViewInit(){this.dataSource.paginator=this.child.paginator}getDataForColumn(e,t){switch(t){case"id":return e.id.toString();case"name":return e.tagName;default:return""}}exportData(e){(0,l.O6)((0,l.Xn)(this.dataSource.filteredData,this.displayedColumns,this.getDataForColumn,this),e)}setDataSource(){this.dataSource&&(this.dataSource.filterPredicate=(e,t)=>(0,l.Sd)(e,t,this.displayedColumns,this.getDataForColumn,this),this.dataSource.sortData=(e,t)=>(0,l.pR)(e,t,this.getDataForColumn,this),this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue)}isAllSelected(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.child.paginator.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}masterToggle(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}checkboxLabel(e){return e?`${this.selection.isSelected(e)?"deselect":"select"} row ${e.id+1}`:(this.isAllSelected()?"select":"deselect")+" all"}save(e){this.resourceManager.updateResourceTag({resourceTag:e}).subscribe(()=>{this.translator.get("SHARED.COMPONENTS.RESOURCES_TAGS_LIST.EDIT_SUCCESS").subscribe(e=>{this.notificator.showSuccess(e)}),this.isChanging.deselect(e)})}edit(e){this.isChanging.select(e)}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(r.xk),c.Y36(n.V6),c.Y36(u.sK),c.Y36(n.x4),c.Y36(n.UA))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-resources-tags-list"]],viewQuery:function(e,t){if(1&e&&(c.Gf(i.YE,7),c.Gf(l.l9,7)),2&e){let e;c.iGM(e=c.CRH())&&(t.matSort=e.first),c.iGM(e=c.CRH())&&(t.child=e.first)}},inputs:{resourceTags:"resourceTags",filterValue:"filterValue",selection:"selection",tableId:"tableId",displayedColumns:"displayedColumns",entity:"entity"},features:[c.TTD],decls:19,vars:9,consts:[[1,"card","mt-2",3,"hidden"],[3,"tableId","dataLength","pageSizeOptions","exportData"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","","class","align-checkbox",4,"matHeaderCellDef"],["class","static-column-size align-checkbox","mat-cell","",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","edit"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell","",1,"align-checkbox"],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size","align-checkbox"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"static-column-size"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],["matInput","",3,"ngModel","ngModelChange"],[1,"d-flex","justify-content-end"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","",3,"matTooltip","click"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"],["alert_type","warn"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c.TgZ(1,"perun-web-apps-table-wrapper",1),c.NdJ("exportData",function(e){return t.exportData(e)}),c.TgZ(2,"table",2),c.ynx(3,3),c.YNc(4,R,2,3,"th",4),c.YNc(5,T,2,2,"td",5),c.BQk(),c.ynx(6,6),c.YNc(7,I,3,3,"th",7),c.YNc(8,Z,2,1,"td",8),c.BQk(),c.ynx(9,9),c.YNc(10,_,3,3,"th",10),c.YNc(11,C,3,2,"td",11),c.BQk(),c.ynx(12,12),c.YNc(13,y,1,0,"th",10),c.YNc(14,N,4,2,"td",11),c.BQk(),c.YNc(15,G,1,0,"tr",13),c.YNc(16,D,1,0,"tr",14),c.qZA(),c.qZA(),c.qZA(),c.YNc(17,L,4,5,"app-alert",15),c.YNc(18,w,3,3,"app-alert",15)),2&e&&(c.Q6J("hidden",0===t.resourceTags.length||0===t.dataSource.filteredData.length),c.xp6(1),c.Q6J("tableId",t.tableId)("dataLength",t.dataSource.filteredData.length)("pageSizeOptions",t.pageSizeOptions),c.xp6(1),c.Q6J("dataSource",t.dataSource),c.xp6(13),c.Q6J("matHeaderRowDef",t.displayedColumns),c.xp6(1),c.Q6J("matRowDefColumns",t.displayedColumns),c.xp6(1),c.Q6J("ngIf",0===t.resourceTags.length),c.xp6(1),c.Q6J("ngIf",0===t.dataSource.filteredData.length&&0!==t.resourceTags.length))},directives:[d.l,a.BZ,i.YE,a.w1,a.fO,a.Dz,a.as,a.nj,h.O5,a.ge,g.oG,a.ev,i.nU,p.KE,m.Nt,f.Fj,f.JJ,f.On,A.lW,S.gM,b.Hw,a.XQ,a.Gk,E.w],pipes:[u.X$],styles:[""]}),e})()},65267:function(e,t,s){"use strict";s.d(t,{F:function(){return n}});var i=s(31572),a=s(44973),o=s(48160);let n=(()=>{class e{constructor(){this.servicePackages=[],this.selectedPackage=null,this.multiple=!1,this.disableAutoSelect=!1,this.theme="",this.packageSelected=new i.vpe,this.nameFunction=e=>e.name,this.shortNameFunction=e=>e.description,this.searchFunction=e=>e.name+e.description}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Xpm({type:e,selectors:[["perun-web-apps-service-package-search-select"]],inputs:{servicePackages:"servicePackages",selectedPackage:"selectedPackage",multiple:"multiple",disableAutoSelect:"disableAutoSelect",theme:"theme"},outputs:{packageSelected:"packageSelected"},decls:4,vars:17,consts:[[3,"entities","entity","multiple","disableAutoSelect","searchFunction","mainTextFunction","secondaryTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","theme","entitySelected"]],template:function(e,t){1&e&&(i.TgZ(0,"perun-web-apps-entity-search-select",0),i.NdJ("entitySelected",function(e){return t.packageSelected.emit(e)}),i.ALo(1,"translate"),i.ALo(2,"translate"),i.ALo(3,"translate"),i.qZA()),2&e&&i.Q6J("entities",t.servicePackages)("entity",t.selectedPackage)("multiple",t.multiple)("disableAutoSelect",t.disableAutoSelect)("searchFunction",t.searchFunction)("mainTextFunction",t.nameFunction)("secondaryTextFunction",t.shortNameFunction)("selectPlaceholder",i.lcZ(1,11,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.SELECT_PACKAGE"))("findPlaceholder",i.lcZ(2,13,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.FIND_PACKAGE"))("noEntriesText",i.lcZ(3,15,"SHARED_LIB.PERUN.COMPONENTS.SERVICE_PACKAGE_SEARCH_SELECT.NO_PACKAGE_FOUND"))("theme",t.theme)},directives:[a.i],pipes:[o.X$],styles:[""]}),e})()}}]);