"use strict";(self.webpackChunkadmin_gui=self.webpackChunkadmin_gui||[]).push([[357],{61283:(w,D,s)=>{s.d(D,{A:()=>v});var r=s(36769),m=s(5e3),S=s(11735);let v=(()=>{class i{constructor(){}prepareRoute(n){return n&&n.activatedRouteData&&n.activatedRouteData.animation}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=m.Xpm({type:i,selectors:[["app-animated-router-outlet"]],decls:3,vars:0,consts:[["outlet","outlet"]],template:function(n,A){1&n&&(m.TgZ(0,"div"),m._UZ(1,"router-outlet",null,0),m.qZA())},directives:[S.lC],styles:[""],data:{animation:[r.Ji]}}),i})()},71103:(w,D,s)=>{s.d(D,{n:()=>_});var r=s(48966),m=s(20449),S=s(36908),v=s(112),i=s(10036),n=(s(80255),s(5e3)),A=s(51062),t=s(7434),L=s(69808),R=s(98380),f=s(20773),O=s(53984),E=s(47423);const P=["list"];function U(d,C){1&d&&(n.TgZ(0,"app-alert",10),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&d&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"DIALOGS.CREATE_ATTRIBUTE.ERROR_EMPTY_VALUE")," "))}function h(d,C){1&d&&n._UZ(0,"mat-spinner",11)}function M(d,C){if(1&d&&n._UZ(0,"perun-web-apps-attributes-list",12,13),2&d){const u=n.oxw();n.Q6J("tableId",u.tableId)("attributes",u.attributes)("filterValue",u.filterValue)("inDialog",!0)("emptyListText","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.EMPTY_ATTRIBUTES")("selection",u.selected)}}let _=(()=>{class d{constructor(u,p,o,b,g){this.dialogRef=u,this.data=p,this.attributesManager=o,this.notificator=b,this.translate=g,this.attributes=[],this.selected=new m.Ov(!0,[]),this.showError=!1,this.filterValue="",this.tableId=i.rF,this.translate.get("DIALOGS.CREATE_ATTRIBUTE.SUCCESS_SAVE").subscribe(x=>this.saveSuccessMessage=x)}ngOnInit(){const u=new Array;let p,o,b,g,x,Z,N,B;switch(this.data.notEmptyAttributes.forEach(F=>{u.push(F.id)}),this.data.entity){case"member":p=this.data.entityId;break;case"user":o=this.data.entityId;break;case"vo":b=this.data.entityId;break;case"group":g=this.data.entityId;break;case"resource":x=this.data.entityId;break;case"facility":Z=this.data.entityId;break;case"host":N=this.data.entityId;break;case"ues":B=this.data.entityId}switch(this.data.secondEntity){case"member":p=this.data.secondEntityId;break;case"user":o=this.data.secondEntityId;break;case"vo":b=this.data.secondEntityId;break;case"group":g=this.data.secondEntityId;break;case"resource":x=this.data.secondEntityId;break;case"facility":Z=this.data.secondEntityId;break;case"host":N=this.data.secondEntityId;break;case"ues":B=this.data.secondEntityId}this.loading=!0,this.attributesManager.getAttributesDefinitionWithRights(p,o,b,g,x,Z,N,B).subscribe(F=>{this.attributes=F,this.attributes=this.attributes.filter(W=>!u.includes(W.id)&&this.twoEntityValid(W)),this.loading=!1})}onCancel(){this.dialogRef.close()}onSave(){this.list.updateMapAttributes();let u=!1;for(const p of this.selected.selected)"java.util.ArrayList"===p.type&&0===p.value.length&&(u=!0),void 0===p.value&&(u=!0);if(u)return this.showError=!0,void setTimeout(()=>{this.showError=!1},5e3);switch(this.data.entity){case"facility":this.attributesManager.setFacilityAttributes({facility:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"group":"resource"===this.data.secondEntity?this.attributesManager.setGroupResourceAttributes({group:this.data.entityId,resource:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()}):this.attributesManager.setGroupAttributes({group:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"member":switch(this.data.secondEntity){case"resource":this.attributesManager.setMemberResourceAttributes({member:this.data.entityId,resource:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"group":this.attributesManager.setMemberGroupAttributes({member:this.data.entityId,group:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;default:this.attributesManager.setMemberAttributes({member:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()})}break;case"resource":this.attributesManager.setResourceAttributes({resource:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"user":"facility"===this.data.secondEntity?this.attributesManager.setUserFacilityAttributes({user:this.data.entityId,facility:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()}):this.attributesManager.setUserAttributes({user:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"vo":this.attributesManager.setVoAttributes({vo:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"host":this.attributesManager.setHostAttributes({host:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"ues":this.attributesManager.setUserExtSourceAttributes({userExtSource:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()})}}applyFilter(u){this.filterValue=u}handleSuccess(){this.notificator.showSuccess(this.saveSuccessMessage),this.selected.clear(),this.dialogRef.close("saved")}twoEntityValid(u){return!this.data.secondEntity||u.entity===`${this.data.entity}_${this.data.secondEntity}`}}return d.\u0275fac=function(u){return new(u||d)(n.Y36(r.so),n.Y36(r.WI),n.Y36(v.H8),n.Y36(S.V6),n.Y36(A.sK))},d.\u0275cmp=n.Xpm({type:d,selectors:[["app-create-attribute-dialog"]],viewQuery:function(u,p){if(1&u&&n.Gf(P,5),2&u){let o;n.iGM(o=n.CRH())&&(p.list=o.first)}},decls:17,vars:17,consts:[["mat-dialog-title",""],[1,"page-subtitle"],["data-cy","filter-attributes",1,"font-size-1rem",3,"placeholder","filter"],["class","ml-3 font-size-1rem","alert_type","error",4,"ngIf"],["mat-dialog-content",""],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","attributes","filterValue","inDialog","emptyListText","selection",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","data-cy","save-selected-attributes","mat-flat-button","",1,"ml-2",3,"disabled","click"],["alert_type","error",1,"ml-3","font-size-1rem"],[1,"ml-auto","mr-auto"],[3,"tableId","attributes","filterValue","inDialog","emptyListText","selection"],["list",""]],template:function(u,p){1&u&&(n.TgZ(0,"div"),n.TgZ(1,"div",0),n.TgZ(2,"h1",1),n._uU(3),n.ALo(4,"translate"),n.qZA(),n.TgZ(5,"perun-web-apps-immediate-filter",2),n.NdJ("filter",function(b){return p.applyFilter(b)}),n.qZA(),n.YNc(6,U,3,3,"app-alert",3),n.qZA(),n.TgZ(7,"div",4),n.YNc(8,h,1,0,"mat-spinner",5),n.YNc(9,M,2,6,"perun-web-apps-attributes-list",6),n.qZA(),n.TgZ(10,"div",7),n.TgZ(11,"button",8),n.NdJ("click",function(){return p.onCancel()}),n._uU(12),n.ALo(13,"translate"),n.qZA(),n.TgZ(14,"button",9),n.NdJ("click",function(){return p.onSave()}),n._uU(15),n.ALo(16,"translate"),n.qZA(),n.qZA(),n.qZA()),2&u&&(n.Tol(p.data.style),n.xp6(3),n.Oqu(n.lcZ(4,11,"DIALOGS.CREATE_ATTRIBUTE.SET_NEW")),n.xp6(2),n.Q6J("placeholder","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.FILTER"),n.xp6(1),n.Q6J("ngIf",p.showError),n.xp6(2),n.Q6J("ngIf",p.loading),n.xp6(1),n.Q6J("ngIf",!p.loading),n.xp6(3),n.hij(" ",n.lcZ(13,13,"DIALOGS.CREATE_ATTRIBUTE.CANCEL")," "),n.xp6(2),n.Q6J("disabled",0===p.selected.selected.length),n.xp6(1),n.hij(" ",n.lcZ(16,15,"DIALOGS.CREATE_ATTRIBUTE.SAVE")," "))},directives:[r.uh,t.L,L.O5,R.w,r.xY,f.$g,O.p,r.H8,E.lW],pipes:[A.X$],styles:[".font-size-1rem[_ngcontent-%COMP%]{font-size:1rem!important}"]}),d})()},61365:(w,D,s)=>{s.d(D,{k:()=>U});var r=s(48966),m=s(32075),S=s(36908),v=s(112),i=s(5e3),T=s(51062),n=s(69808),A=s(20773),t=s(47423);function L(h,M){1&h&&i._UZ(0,"mat-spinner",6)}function R(h,M){1&h&&i._UZ(0,"th",15)}function f(h,M){if(1&h&&(i.TgZ(0,"td",16),i._uU(1),i.qZA()),2&h){const _=M.$implicit;i.xp6(1),i.Oqu(_.displayName)}}function O(h,M){1&h&&i._UZ(0,"tr",17)}function E(h,M){1&h&&i._UZ(0,"tr",18)}function P(h,M){if(1&h&&(i.TgZ(0,"div",7),i.TgZ(1,"div"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"div",8),i._uU(5),i.ALo(6,"translate"),i.qZA(),i.TgZ(7,"table",9),i.ynx(8,10),i.YNc(9,R,1,0,"th",11),i.YNc(10,f,2,1,"td",12),i.BQk(),i.YNc(11,O,1,0,"tr",13),i.YNc(12,E,1,0,"tr",14),i.qZA(),i.qZA()),2&h){const _=i.oxw();i.xp6(2),i.hij(" ",i.lcZ(3,5,"DIALOGS.DELETE_ATTRIBUTES.DESCRIPTION")," "),i.xp6(3),i.hij(" ",i.lcZ(6,7,"DIALOGS.DELETE_ATTRIBUTES.ASK")," "),i.xp6(2),i.Q6J("dataSource",_.dataSource),i.xp6(4),i.Q6J("matHeaderRowDef",_.displayedColumns),i.xp6(1),i.Q6J("matRowDefColumns",_.displayedColumns)}}let U=(()=>{class h{constructor(_,d,C,u,p){this.dialogRef=_,this.data=d,this.notificator=C,this.translate=u,this.attributesManager=p,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.dataSource=new m.by(this.data.attributes),this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){const _=[];for(const C of this.data.attributes)_.push(C.id);const d={};switch(d[this.data.entity]=this.data.entityId,d.attributes=_,void 0!==this.data.secondEntity&&(d[this.data.secondEntity]=this.data.secondEntityId),this.loading=!0,this.data.entity){case"vo":this.attributesManager.removeVoAttributes(this.data.entityId,_).subscribe(()=>{this.onSuccess()},()=>this.loading=!1);break;case"group":"resource"===this.data.secondEntity?this.attributesManager.removeGroupResourceAttributes(this.data.entityId,this.data.secondEntityId,_).subscribe(()=>{this.onSuccess()},()=>this.loading=!1):this.attributesManager.removeGroupAttributes(this.data.entityId,_).subscribe(()=>{this.onSuccess()},()=>this.loading=!1);break;case"user":"facility"===this.data.secondEntity?this.attributesManager.removeUserFacilityAttributes(this.data.entityId,this.data.secondEntityId,_).subscribe(()=>{this.onSuccess()},()=>this.loading=!1):this.attributesManager.removeUserAttributes(this.data.entityId,_).subscribe(()=>{this.onSuccess()},()=>this.loading=!1);break;case"member":switch(this.data.secondEntity){case"resource":this.attributesManager.removeMemberResourceAttributes(this.data.entityId,this.data.secondEntityId,_).subscribe(()=>{this.onSuccess()},()=>this.loading=!1);break;case"group":this.attributesManager.removeMemberGroupAttributes(this.data.entityId,this.data.secondEntityId,_).subscribe(()=>{this.onSuccess()},()=>this.loading=!1);break;default:this.attributesManager.removeMemberAttributes(this.data.entityId,_).subscribe(()=>{this.onSuccess()},()=>this.loading=!1)}break;case"facility":this.attributesManager.removeFacilityAttributes(this.data.entityId,_).subscribe(()=>{this.onSuccess()},()=>this.loading=!1);break;case"host":this.attributesManager.removeHostAttributes(this.data.entityId,_).subscribe(()=>{this.onSuccess()},()=>this.loading=!1);break;case"ues":this.attributesManager.removeUesAttributes(this.data.entityId,_).subscribe(()=>{this.onSuccess()});break;case"resource":this.attributesManager.removeResourceAttributes(this.data.entityId,_).subscribe(()=>this.onSuccess())}}onSuccess(){this.translate.get("DIALOGS.DELETE_ATTRIBUTES.SUCCESS").subscribe(_=>{this.notificator.showSuccess(_),this.dialogRef.close(!0)})}}return h.\u0275fac=function(_){return new(_||h)(i.Y36(r.so),i.Y36(r.WI),i.Y36(S.V6),i.Y36(T.sK),i.Y36(v.H8))},h.\u0275cmp=i.Xpm({type:h,selectors:[["app-delete-attribute-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn","data-cy","delete-attributes",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(_,d){1&_&&(i.TgZ(0,"div"),i.TgZ(1,"h1",0),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.YNc(4,L,1,0,"mat-spinner",1),i.YNc(5,P,13,9,"div",2),i.TgZ(6,"div",3),i.TgZ(7,"button",4),i.NdJ("click",function(){return d.onCancel()}),i._uU(8),i.ALo(9,"translate"),i.qZA(),i.TgZ(10,"button",5),i.NdJ("click",function(){return d.onSubmit()}),i._uU(11),i.ALo(12,"translate"),i.qZA(),i.qZA(),i.qZA()),2&_&&(i.Tol(d.theme),i.xp6(2),i.Oqu(i.lcZ(3,9,"DIALOGS.DELETE_ATTRIBUTES.TITLE")),i.xp6(2),i.Q6J("ngIf",d.loading),i.xp6(1),i.Q6J("ngIf",!d.loading),i.xp6(3),i.hij(" ",i.lcZ(9,11,"DIALOGS.DELETE_ATTRIBUTES.CANCEL")," "),i.xp6(2),i.Q6J("disabled",d.loading),i.xp6(1),i.hij(" ",i.lcZ(12,13,"DIALOGS.DELETE_ATTRIBUTES.DELETE")," "))},directives:[r.uh,n.O5,A.$g,r.xY,m.BZ,m.w1,m.fO,m.ge,m.Dz,m.ev,m.as,m.XQ,m.nj,m.Gk,r.H8,t.lW],pipes:[T.X$],styles:[""]}),h})()},12651:(w,D,s)=>{s.d(D,{t:()=>C});var r=s(112),m=s(20449),S=s(9244),v=s(71103),i=s(40071),T=s(61365),A=(s(80255),s(10036)),t=s(5e3),L=s(48966),R=s(96214),f=s(47423),O=s(7434),E=s(69808),P=s(20773),U=s(53984),h=s(51062);const M=["list"];function _(u,p){1&u&&t._UZ(0,"mat-spinner",7)}function d(u,p){if(1&u&&t._UZ(0,"perun-web-apps-attributes-list",8,9),2&u){const o=t.oxw();t.Q6J("tableId",o.tableId)("filterValue",o.filterValue)("attributes",o.attributes)("selection",o.selection)}}let C=(()=>{class u{constructor(o,b){this.attributesManagerService=o,this.dialog=b,this.attributes=[],this.selection=new m.Ov(!0,[]),this.filterValue="",this.tableId=A.rF,this.loading=!1}ngOnInit(){this.refreshTable()}refreshTable(){switch(this.loading=!0,this.entity){case"member":this.attributesManagerService.getMemberAttributes(this.entityId).subscribe(o=>{this.attributes=o,this.selection.clear(),this.loading=!1});break;case"group":this.attributesManagerService.getGroupAttributes(this.entityId).subscribe(o=>{this.attributes=o,this.selection.clear(),this.loading=!1});break;case"user":this.attributesManagerService.getUserAttributes(this.entityId).subscribe(o=>{this.attributes=o,this.selection.clear(),this.loading=!1});break;case"resource":this.attributesManagerService.getResourceAttributes(this.entityId).subscribe(o=>{this.attributes=o,this.selection.clear(),this.loading=!1});break;case"facility":this.attributesManagerService.getFacilityAttributes(this.entityId).subscribe(o=>{this.attributes=o,this.selection.clear(),this.loading=!1});break;case"vo":this.attributesManagerService.getVoAttributes(this.entityId).subscribe(o=>{this.attributes=o,this.selection.clear(),this.loading=!1})}}applyFilter(o){this.filterValue=o}onCreate(){const o=(0,S.kZ)();o.width="1050px",o.data={entityId:this.entityId,entity:this.entity,notEmptyAttributes:this.attributes,style:this.entity+"-theme"},this.dialog.open(v.n,o).afterClosed().subscribe(g=>{g&&this.refreshTable()})}onSave(){this.list.updateMapAttributes();const o=(0,S.kZ)();o.width="450px",o.data={entityId:this.entityId,entity:this.entity,attributes:this.selection.selected},this.dialog.open(i.wA,o).afterClosed().subscribe(g=>{g&&this.refreshTable()})}onDelete(){const o=(0,S.kZ)();o.width="450px",o.data={entityId:this.entityId,entity:this.entity,attributes:this.selection.selected},this.dialog.open(T.k,o).afterClosed().subscribe(g=>{g&&this.refreshTable()})}}return u.\u0275fac=function(o){return new(o||u)(t.Y36(r.H8),t.Y36(L.uw))},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-one-entity-attribute-page"]],viewQuery:function(o,b){if(1&o&&t.Gf(M,5),2&o){let g;t.iGM(g=t.CRH())&&(b.list=g.first)}},inputs:{entity:"entity",entityId:"entityId"},decls:13,vars:14,consts:[[1,"mt-2",3,"refresh"],["mat-flat-button","","color","accent","data-cy","add-attributes",1,"mr-2","mt-2","action-button",3,"click"],["mat-flat-button","","color","accent",1,"mr-2","mt-2",3,"disabled","click"],["color","warn","mat-flat-button","","data-cy","remove-attributes",1,"mt-2","mr-2",3,"disabled","click"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"tableId","filterValue","attributes","selection",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"tableId","filterValue","attributes","selection"],["list",""]],template:function(o,b){1&o&&(t.TgZ(0,"perun-web-apps-refresh-button",0),t.NdJ("refresh",function(){return b.refreshTable()}),t.qZA(),t.TgZ(1,"button",1),t.NdJ("click",function(){return b.onCreate()}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",2),t.NdJ("click",function(){return b.onSave()}),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"button",3),t.NdJ("click",function(){return b.onDelete()}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"perun-web-apps-immediate-filter",4),t.NdJ("filter",function(x){return b.applyFilter(x)}),t.qZA(),t.YNc(11,_,1,0,"mat-spinner",5),t.YNc(12,d,2,4,"perun-web-apps-attributes-list",6)),2&o&&(t.xp6(2),t.hij(" ",t.lcZ(3,8,"USER_DETAIL.SETTINGS.ATTRIBUTES.CREATE"),"\n"),t.xp6(2),t.Q6J("disabled",0===b.selection.selected.length),t.xp6(1),t.hij(" ",t.lcZ(6,10,"USER_DETAIL.SETTINGS.ATTRIBUTES.SAVE"),"\n"),t.xp6(2),t.Q6J("disabled",0===b.selection.selected.length),t.xp6(1),t.hij(" ",t.lcZ(9,12,"USER_DETAIL.SETTINGS.ATTRIBUTES.DELETE"),"\n"),t.xp6(2),t.Q6J("placeholder","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.FILTER"),t.xp6(1),t.Q6J("ngIf",b.loading),t.xp6(1),t.Q6J("ngIf",!b.loading))},directives:[R.t,f.lW,O.L,E.O5,P.$g,U.p],pipes:[h.X$],styles:[""]}),u})()},19191:(w,D,s)=>{s.d(D,{Y:()=>Q});var r=s(112),S=(s(80255),s(20449)),v=s(61365),i=s(9244),T=s(40071),n=s(71103),A=s(64080),t=s(5e3),L=s(48966),R=s(69808),f=s(20773),O=s(98380),E=s(82322),P=s(45703),U=s(42377),h=s(51062);let M=(()=>{class c{constructor(){this.memberSelected=new t.vpe,this.memberFullNameFunction=e=>(0,i.bD)(e.user)}ngOnInit(){this.members=this.members.sort(i.fx)}}return c.\u0275fac=function(e){return new(e||c)},c.\u0275cmp=t.Xpm({type:c,selectors:[["perun-web-apps-member-search-select"]],inputs:{members:"members"},outputs:{memberSelected:"memberSelected"},decls:4,vars:12,consts:[[3,"entities","searchFunction","mainTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","entitySelected"]],template:function(e,a){1&e&&(t.TgZ(0,"perun-web-apps-entity-search-select",0),t.NdJ("entitySelected",function(I){return a.memberSelected.emit(I)}),t.ALo(1,"translate"),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&e&&t.Q6J("entities",a.members)("searchFunction",a.memberFullNameFunction)("mainTextFunction",a.memberFullNameFunction)("selectPlaceholder",t.lcZ(1,6,"SHARED_LIB.PERUN.COMPONENTS.MEMBER_SEARCH_SELECT.SELECT_MEMBER"))("findPlaceholder",t.lcZ(2,8,"SHARED_LIB.PERUN.COMPONENTS.MEMBER_SEARCH_SELECT.FIND_MEMBER"))("noEntriesText",t.lcZ(3,10,"SHARED_LIB.PERUN.COMPONENTS.MEMBER_SEARCH_SELECT.NO_MEMBER_FOUND"))},directives:[U.i],pipes:[h.X$],styles:[""]}),c})(),_=(()=>{class c{constructor(){this.facilitySelected=new t.vpe,this.nameFunction=e=>e.name}ngOnInit(){this.facilities=this.facilities.sort(i.aC)}}return c.\u0275fac=function(e){return new(e||c)},c.\u0275cmp=t.Xpm({type:c,selectors:[["perun-web-apps-facility-search-select"]],inputs:{facilities:"facilities"},outputs:{facilitySelected:"facilitySelected"},decls:4,vars:12,consts:[[3,"entities","searchFunction","mainTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","entitySelected"]],template:function(e,a){1&e&&(t.TgZ(0,"perun-web-apps-entity-search-select",0),t.NdJ("entitySelected",function(I){return a.facilitySelected.emit(I)}),t.ALo(1,"translate"),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&e&&t.Q6J("entities",a.facilities)("searchFunction",a.nameFunction)("mainTextFunction",a.nameFunction)("selectPlaceholder",t.lcZ(1,6,"SHARED_LIB.PERUN.COMPONENTS.FACILITY_SEARCH_SELECT.SELECT_FACILITY"))("findPlaceholder",t.lcZ(2,8,"SHARED_LIB.PERUN.COMPONENTS.FACILITY_SEARCH_SELECT.FIND_FACILITY"))("noEntriesText",t.lcZ(3,10,"SHARED_LIB.PERUN.COMPONENTS.FACILITY_SEARCH_SELECT.NO_FACILITY_FOUND"))},directives:[U.i],pipes:[h.X$],styles:[""]}),c})();var d=s(74250),C=s(96214),u=s(47423),p=s(7434),o=s(53984);const b=["list"];function g(c,y){1&c&&t._UZ(0,"mat-spinner",4)}function x(c,y){if(1&c&&(t.TgZ(0,"app-alert",5),t._uU(1),t.qZA()),2&c){const e=t.oxw();t.xp6(1),t.Oqu(e.noEntityMessage)}}function Z(c,y){if(1&c){const e=t.EpF();t.TgZ(0,"perun-web-apps-group-search-select",18),t.NdJ("groupSelected",function(l){return t.CHM(e),t.oxw(2).specifySecondEntity(l)}),t.qZA()}if(2&c){const e=t.oxw(2);t.Q6J("groups",e.entityValues)("firstSelectedGroup",e.specificSecondEntity)("displayStatus",!0)}}function N(c,y){if(1&c){const e=t.EpF();t.TgZ(0,"perun-web-apps-resource-search-select",19),t.NdJ("resourceSelected",function(l){return t.CHM(e),t.oxw(2).specifySecondEntity(l)}),t.qZA()}if(2&c){const e=t.oxw(2);t.Q6J("resources",e.entityValues)}}function B(c,y){if(1&c){const e=t.EpF();t.TgZ(0,"perun-web-apps-member-search-select",20),t.NdJ("memberSelected",function(l){return t.CHM(e),t.oxw(2).specifySecondEntity(l)}),t.qZA()}if(2&c){const e=t.oxw(2);t.Q6J("members",e.entityValues)}}function F(c,y){if(1&c){const e=t.EpF();t.TgZ(0,"perun-web-apps-facility-search-select",21),t.NdJ("facilitySelected",function(l){return t.CHM(e),t.oxw(2).specifySecondEntity(l)}),t.qZA()}if(2&c){const e=t.oxw(2);t.Q6J("facilities",e.entityValues)}}function W(c,y){if(1&c){const e=t.EpF();t.TgZ(0,"perun-web-apps-user-search-select",22),t.NdJ("userSelected",function(l){return t.CHM(e),t.oxw(2).specifySecondEntity(l)}),t.qZA()}if(2&c){const e=t.oxw(2);t.Q6J("users",e.entityValues)}}function J(c,y){1&c&&t._UZ(0,"mat-spinner",4)}function K(c,y){if(1&c&&t._UZ(0,"perun-web-apps-attributes-list",23,24),2&c){const e=t.oxw(2);t.Q6J("attributes",e.attributes)("filterValue",e.filterValue)("selection",e.selection)}}function Y(c,y){if(1&c){const e=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"div",6),t.YNc(2,Z,1,3,"perun-web-apps-group-search-select",7),t.YNc(3,N,1,1,"perun-web-apps-resource-search-select",8),t.YNc(4,B,1,1,"perun-web-apps-member-search-select",9),t.YNc(5,F,1,1,"perun-web-apps-facility-search-select",10),t.YNc(6,W,1,1,"perun-web-apps-user-search-select",11),t.qZA(),t.TgZ(7,"perun-web-apps-refresh-button",12),t.NdJ("refresh",function(){t.CHM(e);const l=t.oxw();return l.getAttributes(l.specificSecondEntity.id)}),t.qZA(),t.TgZ(8,"button",13),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return l.onAdd(l.specificSecondEntity.id)}),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"button",14),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return l.onSave(l.specificSecondEntity.id)}),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"button",15),t.NdJ("click",function(){t.CHM(e);const l=t.oxw();return l.onDelete(l.specificSecondEntity.id)}),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"perun-web-apps-immediate-filter",16),t.NdJ("filter",function(l){return t.CHM(e),t.oxw().applyFilter(l)}),t.qZA(),t.YNc(18,J,1,0,"mat-spinner",1),t.YNc(19,K,2,3,"perun-web-apps-attributes-list",17),t.qZA()}if(2&c){const e=t.oxw();t.xp6(2),t.Q6J("ngIf","group"===e.secondEntity),t.xp6(1),t.Q6J("ngIf","resource"===e.secondEntity),t.xp6(1),t.Q6J("ngIf","member"===e.secondEntity),t.xp6(1),t.Q6J("ngIf","facility"===e.secondEntity),t.xp6(1),t.Q6J("ngIf","user"===e.secondEntity),t.xp6(3),t.hij(" ",t.lcZ(10,13,"MEMBER_DETAIL.SETTINGS.ATTRIBUTES.CREATE")," "),t.xp6(2),t.Q6J("disabled",0===e.selection.selected.length),t.xp6(1),t.hij(" ",t.lcZ(13,15,"MEMBER_DETAIL.SETTINGS.ATTRIBUTES.SAVE")," "),t.xp6(2),t.Q6J("disabled",0===e.selection.selected.length),t.xp6(1),t.hij(" ",t.lcZ(16,17,"MEMBER_DETAIL.SETTINGS.ATTRIBUTES.DELETE")," "),t.xp6(2),t.Q6J("placeholder","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.FILTER"),t.xp6(1),t.Q6J("ngIf",e.innerLoading),t.xp6(1),t.Q6J("ngIf",!e.innerLoading)}}let Q=(()=>{class c{constructor(e,a,l,I,V,k){this.attributesManagerService=e,this.resourcesManagerService=a,this.facilitiesManagerService=l,this.groupsManagerService=I,this.membersManager=V,this.dialog=k,this.entityValues=[],this.attributes=[],this.selection=new S.Ov(!0,[]),this.allowedStatuses=["INVALID","VALID"],this.loading=!1,this.innerLoading=!1,this.filterValue=""}ngOnInit(){this.loadEntityValues(),this.setMessages(this.secondEntity.toLowerCase())}loadEntityValues(){switch(this.loading=!0,this.firstEntity){case"member":switch(this.secondEntity){case"resource":this.resourcesManagerService.getAssignedResourcesWithStatus(this.firstEntityId).subscribe(e=>{this.entityValues=e.map(a=>a.enrichedResource.resource),this.preselectEntity(),this.loading=!1});break;case"group":this.groupsManagerService.getMemberGroups(this.firstEntityId).subscribe(e=>{this.entityValues=e,this.preselectEntity(),this.loading=!1})}break;case"group":switch(this.secondEntity){case"resource":this.resourcesManagerService.getResourceAssignments(this.firstEntityId).subscribe(e=>{this.entityValues=e.map(a=>{const l=a.enrichedResource.resource;return l.status=a.status,l}),this.preselectEntity(),this.loading=!1});break;case"member":this.membersManager.getCompleteRichMembersForGroup(this.firstEntityId,!1,this.allowedStatuses,null,[A.r.MEMBER_CORE_ID]).subscribe(e=>{this.entityValues=e,this.preselectEntity(),this.loading=!1})}break;case"user":this.facilitiesManagerService.getAssignedFacilitiesByUser(this.firstEntityId).subscribe(e=>{this.entityValues=e,this.preselectEntity(),this.loading=!1});break;case"resource":switch(this.secondEntity){case"member":this.resourcesManagerService.getAssignedMembersWithStatus(this.firstEntityId).subscribe(e=>{this.entityValues=e.map(a=>a.richMember),this.preselectEntity(),this.loading=!1});break;case"group":this.resourcesManagerService.getGroupAssignments(this.firstEntityId).subscribe(e=>{this.entityValues=e.map(a=>{const l=a.enrichedGroup.group;return l.status=a.status,l}),this.preselectEntity(),this.loading=!1})}break;case"facility":this.facilitiesManagerService.getAssignedUsers(this.firstEntityId).subscribe(e=>{this.entityValues=e,this.preselectEntity(),this.loading=!1})}}preselectEntity(){0!==this.entityValues.length&&this.findInitiallySelectedEntity()}findInitiallySelectedEntity(){let e=this.entityValues[0];const a=(0,i.vL)(this.entityKey());if(a)for(const l of this.entityValues)if(l.id===a[0]){e=l;break}this.specifySecondEntity(e)}entityKey(){return"group"===this.secondEntity?"groups":""}getAttributes(e){switch(this.innerLoading=!0,this.firstEntity){case"member":switch(this.secondEntity){case"resource":this.attributesManagerService.getMemberResourceAttributes(this.firstEntityId,e).subscribe(a=>{this.attributes=a,this.innerLoading=!1});break;case"group":this.attributesManagerService.getMemberGroupAttributes(this.firstEntityId,e).subscribe(a=>{this.attributes=a,this.innerLoading=!1})}break;case"group":switch(this.secondEntity){case"resource":this.attributesManagerService.getGroupResourceAttributes(this.firstEntityId,e).subscribe(a=>{this.attributes=a,this.innerLoading=!1});break;case"member":this.attributesManagerService.getMemberGroupAttributes(e,this.firstEntityId).subscribe(a=>{this.attributes=a,this.innerLoading=!1})}break;case"user":this.attributesManagerService.getUserFacilityAttributes(this.firstEntityId,e).subscribe(a=>{this.attributes=a,this.innerLoading=!1});break;case"resource":switch(this.secondEntity){case"member":this.attributesManagerService.getMemberResourceAttributes(e,this.firstEntityId).subscribe(a=>{this.attributes=a,this.innerLoading=!1});break;case"group":this.attributesManagerService.getGroupResourceAttributes(e,this.firstEntityId).subscribe(a=>{this.attributes=a,this.innerLoading=!1})}break;case"facility":this.attributesManagerService.getUserFacilityAttributes(e,this.firstEntityId).subscribe(a=>{this.attributes=a,this.innerLoading=!1})}}setMessages(e){this.noEntityMessage=`No ${e} assigned`}onSave(e){this.list.updateMapAttributes();const a=(0,i.kZ)();a.width="450px",a.data={entityId:this.firstEntityId,entity:this.firstEntity,secondEntity:this.secondEntity,secondEntityId:e,attributes:this.selection.selected},this.dialog.open(T.wA,a).afterClosed().subscribe(I=>{I&&(this.selection.clear(),this.getAttributes(e))})}onDelete(e){const a=(0,i.kZ)();a.width="450px",a.data={entityId:this.firstEntityId,entity:this.firstEntity,secondEntity:this.secondEntity,secondEntityId:e,attributes:this.selection.selected,theme:`${this.firstEntity}-theme`},this.dialog.open(v.k,a).afterClosed().subscribe(I=>{I&&(this.selection.clear(),this.getAttributes(e))})}onAdd(e){const a=(0,i.kZ)();a.width="1050px",a.data={entityId:this.firstEntityId,entity:this.firstEntity,secondEntity:this.secondEntity,secondEntityId:e,notEmptyAttributes:this.attributes,style:`${this.firstEntity}-theme`},this.dialog.open(n.n,a).afterClosed().subscribe(I=>{I&&(this.selection.clear(),this.getAttributes(e))})}specifySecondEntity(e){e&&(this.specificSecondEntity=e,this.getAttributes(this.specificSecondEntity.id))}applyFilter(e){this.filterValue=e}}return c.\u0275fac=function(e){return new(e||c)(t.Y36(r.H8),t.Y36(r.xk),t.Y36(r.IQ),t.Y36(r.ff),t.Y36(r.uq),t.Y36(L.uw))},c.\u0275cmp=t.Xpm({type:c,selectors:[["app-two-entity-attribute-page"]],viewQuery:function(e,a){if(1&e&&t.Gf(b,5),2&e){let l;t.iGM(l=t.CRH())&&(a.list=l.first)}},inputs:{firstEntityId:"firstEntityId",firstEntity:"firstEntity",secondEntity:"secondEntity"},decls:4,vars:3,consts:[[1,"mt-3"],["class","ml-auto mr-auto",4,"ngIf"],["alert_type","warn",4,"ngIf"],[4,"ngIf"],[1,"ml-auto","mr-auto"],["alert_type","warn"],[1,"flex-row"],[3,"groups","firstSelectedGroup","displayStatus","groupSelected",4,"ngIf"],[3,"resources","resourceSelected",4,"ngIf"],[3,"members","memberSelected",4,"ngIf"],[3,"facilities","facilitySelected",4,"ngIf"],[3,"users","userSelected",4,"ngIf"],[3,"refresh"],["mat-flat-button","","color","accent",1,"mr-2","action-button",3,"click"],["mat-flat-button","","color","accent",1,"mr-2",3,"disabled","click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],[3,"placeholder","filter"],[3,"attributes","filterValue","selection",4,"ngIf"],[3,"groups","firstSelectedGroup","displayStatus","groupSelected"],[3,"resources","resourceSelected"],[3,"members","memberSelected"],[3,"facilities","facilitySelected"],[3,"users","userSelected"],[3,"attributes","filterValue","selection"],["list",""]],template:function(e,a){1&e&&(t.TgZ(0,"div",0),t.YNc(1,g,1,0,"mat-spinner",1),t.YNc(2,x,2,1,"app-alert",2),t.YNc(3,Y,20,19,"div",3),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",a.loading),t.xp6(1),t.Q6J("ngIf",0===a.entityValues.length&&!a.loading),t.xp6(1),t.Q6J("ngIf",0!==a.entityValues.length))},directives:[R.O5,f.$g,O.w,E.h,P.L,M,_,d.S,C.t,u.lW,p.L,o.p],pipes:[h.X$],styles:[".w-35[_ngcontent-%COMP%]{width:35%}"]}),c})()},71135:(w,D,s)=>{s.d(D,{L:()=>R});var r=s(5e3),m=s(48966),S=s(11735),v=s(69808),i=s(90508),T=s(25245),n=s(64597),A=s(51062);function t(f,O){if(1&f&&(r.TgZ(0,"div",3),r.TgZ(1,"a",4),r.ALo(2,"multiWordDataCy"),r.ALo(3,"translate"),r._UZ(4,"mat-icon",5),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.qZA()),2&f){const E=O.$implicit;r.xp6(1),r.Gre("",E.style," item-itself"),r.Q6J("routerLink",E.url),r.uIk("data-cy",r.lcZ(2,7,r.lcZ(3,9,E.label))),r.xp6(3),r.Q6J("svgIcon",E.cssIcon),r.xp6(1),r.hij(" ",r.lcZ(6,11,E.label)," ")}}function L(f,O){if(1&f&&(r.TgZ(0,"div",1),r.YNc(1,t,7,13,"div",2),r.qZA()),2&f){const E=r.oxw();r.xp6(1),r.Q6J("ngForOf",E.items)}}let R=(()=>{class f{constructor(E,P){this.dialog=E,this.route=P,this.size="large"}ngOnInit(){this.route.params.subscribe(E=>{this.voId=E.voId})}}return f.\u0275fac=function(E){return new(E||f)(r.Y36(m.uw),r.Y36(S.gz))},f.\u0275cmp=r.Xpm({type:f,selectors:[["perun-web-apps-menu-buttons-field"]],inputs:{items:"items",size:"size"},decls:1,vars:1,consts:[["class","items-container",4,"ngIf"],[1,"items-container"],["class","item-itself-container","mat-ripple","",4,"ngFor","ngForOf"],["mat-ripple","",1,"item-itself-container"],["queryParamsHandling","merge",3,"routerLink"],[1,"item-pic","perun-icon",3,"svgIcon"]],template:function(E,P){1&E&&r.YNc(0,L,2,1,"div",0),2&E&&r.Q6J("ngIf","small"===P.size)},directives:[v.O5,v.sg,i.wG,S.yS,T.Hw],pipes:[n.R,A.X$],styles:[".items-container[_ngcontent-%COMP%]{display:grid;grid-gap:0;grid-template-columns:repeat(auto-fill,minmax(208px,1fr));margin:0 -8px}@media (max-width: 768px){.items-container[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(148px,1fr))}}.item-pic[_ngcontent-%COMP%]{color:currentColor;transform:scale(3);height:74px;margin-bottom:22px}.item-itself-container[_ngcontent-%COMP%]{margin:8px}.item-itself[_ngcontent-%COMP%]{text-align:center;min-height:186px;height:100%;padding:20px;display:flex;flex-direction:column;align-items:center;font-size:1.25rem}.item-itself[_ngcontent-%COMP%]:hover{text-decoration:none}.item-itself[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:120px;margin-bottom:10px}@media (max-width: 768px){.item-itself[_ngcontent-%COMP%]{min-height:150px;padding:10px}.item-itself[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:80px;margin-bottom:10px}}"]}),f})()},45703:(w,D,s)=>{s.d(D,{L:()=>i});var r=s(5e3),m=s(9244),S=s(42377),v=s(51062);let i=(()=>{class T{constructor(){this.resource=null,this.displayStatus=!0,this.resourceSelected=new r.vpe,this.nameFunction=A=>A.name,this.secondaryFunction=()=>null}ngOnInit(){this.resources=this.resources.sort(m.aC)}}return T.\u0275fac=function(A){return new(A||T)},T.\u0275cmp=r.Xpm({type:T,selectors:[["perun-web-apps-resource-search-select"]],inputs:{resource:"resource",resources:"resources",displayStatus:"displayStatus"},outputs:{resourceSelected:"resourceSelected"},decls:4,vars:15,consts:[[3,"entity","entities","displayStatus","searchFunction","mainTextFunction","secondaryTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","entitySelected"]],template:function(A,t){1&A&&(r.TgZ(0,"perun-web-apps-entity-search-select",0),r.NdJ("entitySelected",function(R){return t.resourceSelected.emit(R)}),r.ALo(1,"translate"),r.ALo(2,"translate"),r.ALo(3,"translate"),r.qZA()),2&A&&r.Q6J("entity",t.resource)("entities",t.resources)("displayStatus",t.displayStatus)("searchFunction",t.nameFunction)("mainTextFunction",t.nameFunction)("secondaryTextFunction",t.secondaryFunction)("selectPlaceholder",r.lcZ(1,9,"SHARED_LIB.PERUN.COMPONENTS.RESOURCE_SEARCH_SELECT.SELECT_RESOURCE"))("findPlaceholder",r.lcZ(2,11,"SHARED_LIB.PERUN.COMPONENTS.RESOURCE_SEARCH_SELECT.FIND_RESOURCE"))("noEntriesText",r.lcZ(3,13,"SHARED_LIB.PERUN.COMPONENTS.RESOURCE_SEARCH_SELECT.NO_RESOURCE_FOUND"))},directives:[S.i],pipes:[v.X$],styles:[""]}),T})()}}]);