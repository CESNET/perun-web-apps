"use strict";(self.webpackChunkadmin_gui=self.webpackChunkadmin_gui||[]).push([[228],{15935:(y,g,r)=>{r.d(g,{D:()=>B});var x=r(20449),E=r(84847),_=r(32075),l=r(9244),d=r(36908),t=r(5e3),e=r(18750),C=r(77446),v=r(69808),f=r(98380),T=r(51062),M=r(37677);function D(i,c){if(1&i){const a=t.EpF();t.TgZ(0,"th",15),t.TgZ(1,"mat-checkbox",16),t.NdJ("change",function(u){t.CHM(a);const o=t.oxw();return u?o.masterToggle():null}),t.qZA(),t.qZA()}if(2&i){const a=t.oxw();t.xp6(1),t.Q6J("aria-label",a.checkboxLabel())("checked",a.selection.hasValue()&&a.isAllSelected())("indeterminate",a.selection.hasValue()&&!a.isAllSelected())}}function O(i,c){if(1&i){const a=t.EpF();t.TgZ(0,"td",17),t.TgZ(1,"mat-checkbox",18),t.NdJ("change",function(u){const m=t.CHM(a).$implicit,n=t.oxw();return u?n.selection.toggle(m):null})("click",function(u){return u.stopPropagation()}),t.qZA(),t.qZA()}if(2&i){const a=c.$implicit,s=t.oxw();t.xp6(1),t.Q6J("aria-label",s.checkboxLabel(a))("checked",s.selection.isSelected(a))}}function S(i,c){1&i&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED.COMPONENTS.EXT_SOURCES_LIST.ID")," "))}function A(i,c){if(1&i&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&i){const a=c.$implicit;t.xp6(1),t.Oqu(a.id)}}function Z(i,c){1&i&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED.COMPONENTS.EXT_SOURCES_LIST.NAME")," "))}function P(i,c){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const a=c.$implicit;t.xp6(1),t.Oqu(a.name)}}function L(i,c){1&i&&(t.TgZ(0,"th",19),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED.COMPONENTS.EXT_SOURCES_LIST.TYPE")," "))}function I(i,c){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.ALo(2,"extSourceType"),t.qZA()),2&i){const a=c.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,a.type))}}function R(i,c){1&i&&t._UZ(0,"tr",22)}function w(i,c){1&i&&t._UZ(0,"tr",23)}function U(i,c){1&i&&(t.TgZ(0,"perun-web-apps-alert",24),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED.COMPONENTS.EXT_SOURCES_LIST.NO_EXT_SOURCES"),"\n"))}function N(i,c){1&i&&(t.TgZ(0,"perun-web-apps-alert",24),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED.COMPONENTS.EXT_SOURCES_LIST.NO_FILTER_RESULTS"),"\n"))}let B=(()=>{class i{constructor(a,s){this.authResolver=a,this.tableCheckbox=s,this.selection=new x.Ov,this.filterValue="",this.displayedColumns=["select","id","name","type"],this.exporting=!1,this.pageSizeOptions=l.f7}set matSort(a){this.sort=a,this.setDataSource()}static getDataForColumn(a,s){switch(s){case"id":return a.id.toString();case"type":return a.type.substring(40);case"name":return a.name;default:return""}}ngAfterViewInit(){this.setDataSource()}ngOnChanges(){this.authResolver.isPerunAdminOrObserver()||(this.displayedColumns=this.displayedColumns.filter(a=>"id"!==a)),this.dataSource=new _.by(this.extSources),this.setDataSource()}exportData(a){(0,l.O6)((0,l.Xn)(this.dataSource.filteredData,this.displayedColumns,i.getDataForColumn),a)}setDataSource(){this.dataSource&&(this.dataSource.filterPredicate=(a,s)=>(0,l.Sd)(a,s,this.displayedColumns,i.getDataForColumn),this.dataSource.sortData=(a,s)=>(0,l.pR)(a,s,i.getDataForColumn),this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue)}isAllSelected(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.child.paginator.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}masterToggle(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.child.paginator.pageSize,this.child.paginator.pageIndex,!1)}checkboxLabel(a){return a?`${this.selection.isSelected(a)?"deselect":"select"} row ${a.id+1}`:(this.isAllSelected()?"select":"deselect")+" all"}}return i.\u0275fac=function(a){return new(a||i)(t.Y36(d.x4),t.Y36(d.UA))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-ext-sources-list"]],viewQuery:function(a,s){if(1&a&&(t.Gf(l.l9,7),t.Gf(E.YE,7)),2&a){let u;t.iGM(u=t.CRH())&&(s.child=u.first),t.iGM(u=t.CRH())&&(s.matSort=u.first)}},inputs:{extSources:"extSources",selection:"selection",filterValue:"filterValue",displayedColumns:"displayedColumns",tableId:"tableId"},features:[t.TTD],decls:19,vars:9,consts:[[1,"card","mt-2",3,"hidden"],[3,"pageSizeOptions","dataLength","tableId","exportData"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["class","align-checkbox","mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size align-checkbox","mat-cell","",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-cell","",4,"matCellDef"],["matColumnDef","type"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell","",1,"align-checkbox"],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size","align-checkbox"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"static-column-size"],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"],["alert_type","warn"]],template:function(a,s){1&a&&(t.TgZ(0,"div",0),t.TgZ(1,"perun-web-apps-table-wrapper",1),t.NdJ("exportData",function(o){return s.exportData(o)}),t.TgZ(2,"table",2),t.ynx(3,3),t.YNc(4,D,2,3,"th",4),t.YNc(5,O,2,2,"td",5),t.BQk(),t.ynx(6,6),t.YNc(7,S,3,3,"th",7),t.YNc(8,A,2,1,"td",8),t.BQk(),t.ynx(9,9),t.YNc(10,Z,3,3,"th",7),t.YNc(11,P,2,1,"td",10),t.BQk(),t.ynx(12,11),t.YNc(13,L,3,3,"th",7),t.YNc(14,I,3,3,"td",10),t.BQk(),t.YNc(15,R,1,0,"tr",12),t.YNc(16,w,1,0,"tr",13),t.qZA(),t.qZA(),t.qZA(),t.YNc(17,U,3,3,"perun-web-apps-alert",14),t.YNc(18,N,3,3,"perun-web-apps-alert",14)),2&a&&(t.Q6J("hidden",0===s.extSources.length||0===s.dataSource.filteredData.length),t.xp6(1),t.Q6J("pageSizeOptions",s.pageSizeOptions)("dataLength",s.dataSource.filteredData.length)("tableId",s.tableId),t.xp6(1),t.Q6J("dataSource",s.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",s.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",s.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===s.extSources.length),t.xp6(1),t.Q6J("ngIf",0===s.dataSource.filteredData.length&&0!==s.extSources.length))},directives:[e.l,_.BZ,E.YE,_.w1,_.fO,_.ge,C.oG,_.Dz,_.ev,E.nU,_.as,_.XQ,_.nj,_.Gk,v.O5,f.w],pipes:[T.X$,M.A],styles:[""]}),i})()},60526:(y,g,r)=>{r.d(g,{b:()=>u});var x=r(32105),E=r(9244),_=r(16074),l=r(32075),d=r(36908),t=r(64080),e=r(5e3),C=r(48966),v=r(51062),f=r(9224),T=r(69808),M=r(20773),D=r(47423),O=r(25245),S=r(69773),A=r(21757),Z=r(21330),P=r(62383);function L(o,m){1&o&&e._UZ(0,"mat-spinner",4)}function I(o,m){1&o&&e._UZ(0,"th",12)}function R(o,m){if(1&o&&(e.TgZ(0,"td",13),e._uU(1),e.qZA()),2&o){const n=m.$implicit;e.xp6(1),e.hij("",n,":")}}function w(o,m){1&o&&e._UZ(0,"th",12)}function U(o,m){if(1&o){const n=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){return e.CHM(n),e.oxw(4).changeStatus()}),e.TgZ(1,"mat-icon"),e._uU(2,"edit"),e.qZA(),e.qZA()}}function N(o,m){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"i"),e.ALo(2,"memberStatusIconColor"),e._uU(3),e.ALo(4,"memberStatusIcon"),e.qZA(),e.TgZ(5,"b",15),e._uU(6),e.ALo(7,"transformMemberStatus"),e.qZA(),e.YNc(8,U,3,0,"button",16),e.qZA()),2&o){const n=e.oxw(3);e.xp6(1),e.Gre("material-icons vert-center mr-1 ",e.lcZ(2,6,n.member.status),""),e.xp6(2),e.hij(" ",e.lcZ(4,8,n.member.status)," "),e.xp6(3),e.hij(" ",e.lcZ(7,10,n.member.status)," "),e.xp6(2),e.Q6J("ngIf",n.authResolver.isThisVoAdmin(n.vo.id))}}function B(o,m){if(1&o){const n=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){return e.CHM(n),e.oxw(4).changeVoExpiration(!1)}),e.TgZ(1,"mat-icon"),e._uU(2,"edit"),e.qZA(),e.qZA()}}function i(o,m){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"i",18),e._uU(2),e.ALo(3,"parseDate"),e.qZA(),e.YNc(4,B,3,0,"button",16),e.qZA()),2&o){const n=e.oxw(3);e.xp6(2),e.hij(" ",e.lcZ(3,2,n.voExpiration)," "),e.xp6(2),e.Q6J("ngIf",n.authResolver.isThisVoAdmin(n.vo.id))}}function c(o,m){if(1&o&&(e.TgZ(0,"td",14),e.YNc(1,N,9,12,"div",3),e.YNc(2,i,5,4,"div",3),e.qZA()),2&o){const n=m.$implicit;e.xp6(1),e.Q6J("ngIf","Status"===n),e.xp6(1),e.Q6J("ngIf","Expiration"===n)}}function a(o,m){1&o&&e._UZ(0,"tr",19)}function s(o,m){if(1&o&&(e.TgZ(0,"div"),e.TgZ(1,"table",5),e.ynx(2,6),e.YNc(3,I,1,0,"th",7),e.YNc(4,R,2,1,"td",8),e.BQk(),e.ynx(5,9),e.YNc(6,w,1,0,"th",7),e.YNc(7,c,3,2,"td",10),e.BQk(),e.YNc(8,a,1,0,"tr",11),e.qZA(),e.qZA()),2&o){const n=e.oxw();e.xp6(1),e.Q6J("dataSource",n.voMembershipDataSource),e.xp6(7),e.Q6J("matRowDefColumns",n.displayedColumns)}}let u=(()=>{class o{constructor(n,p,b,h,Y,W){this.dialog=n,this.authResolver=p,this.apiRequest=b,this.attributesManager=h,this.translate=Y,this.notificator=W,this.voMembershipDataSource=new l.by,this.voExpiration="",this.displayedColumns=["attName","attValue"]}ngOnChanges(){this.voMembershipDataSource=new l.by(["Status","Expiration"]),this.refreshVoExpiration()}changeStatus(){const n=(0,E.kZ)();n.width="600px",n.data={member:this.member,voId:this.vo.id};const p=this.member.status;this.dialog.open(_.pf,n).afterClosed().subscribe(h=>{h&&(this.member=h,("VALID"===p&&("EXPIRED"===h.status||"DISABLED"===h.status)||"VALID"===h.status)&&this.changeVoExpiration(!0))})}changeVoExpiration(n){const p=(0,E.kZ)();p.width="400px",p.data={voId:this.vo.id,memberId:this.member.id,expirationAttr:this.voExpirationAtt,status:this.member.status,statusChanged:n},this.dialog.open(_.kZ,p).afterClosed().subscribe(h=>{h.success&&(h.member&&(this.member=h.member),this.refreshVoExpiration())})}refreshVoExpiration(){this.loading=!0,this.apiRequest.dontHandleErrorForNext(),this.attributesManager.getMemberAttributeByName(this.member.id,t.r.MEMBER_DEF_EXPIRATION).subscribe(n=>{this.voExpirationAtt=n,this.voExpiration=n.value?n.value:this.translate.instant("MEMBER_DETAIL.OVERVIEW.NEVER_EXPIRES"),this.loading=!1},n=>{const p=n.error;"PrivilegeException"!==p.name?this.notificator.showError(p.name):this.voMembershipDataSource=new l.by(["Status"]),this.loading=!1})}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(C.uw),e.Y36(d.x4),e.Y36(d.F5),e.Y36(x.H8),e.Y36(v.sK),e.Y36(d.V6))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-member-overview-membership"]],inputs:{member:"member",vo:"vo"},features:[e.TTD],decls:9,vars:5,consts:[[1,"mat-elevation-z3","membership-card"],[1,"page-subtitle"],["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],["mat-table","",1,"ml-auto","mr-auto",3,"dataSource"],["matColumnDef","attName"],["mat-header-cell","",4,"matHeaderCellDef"],["class","font-weight-bold","mat-cell","",4,"matCellDef"],["matColumnDef","attValue"],["class","column-center","mat-cell","",4,"matCellDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"font-weight-bold"],["mat-cell","",1,"column-center"],[1,"vert-top"],["mat-icon-button","",3,"click",4,"ngIf"],["mat-icon-button","",3,"click"],[1,"column-center"],["mat-row",""]],template:function(n,p){1&n&&(e.TgZ(0,"mat-card",0),e.TgZ(1,"mat-card-header"),e.TgZ(2,"mat-card-title"),e.TgZ(3,"h1",1),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"mat-card-content"),e.YNc(7,L,1,0,"mat-spinner",2),e.YNc(8,s,9,2,"div",3),e.qZA(),e.qZA()),2&n&&(e.xp6(4),e.hij(" ",e.lcZ(5,3,"MEMBER_DETAIL.OVERVIEW.ORGANIZATION_MEMBERSHIP")," "),e.xp6(3),e.Q6J("ngIf",p.loading),e.xp6(1),e.Q6J("ngIf",!p.loading))},directives:[f.a8,f.dk,f.n5,f.dn,T.O5,M.$g,l.BZ,l.w1,l.fO,l.ge,l.Dz,l.ev,D.lW,O.Hw,l.nj,l.Gk],pipes:[v.X$,S.u,A.f,Z.r,P.M],styles:[".membership-card[_ngcontent-%COMP%]{max-width:400px}.vert-center[_ngcontent-%COMP%]{vertical-align:middle!important}"]}),o})()},21330:(y,g,r)=>{r.d(g,{r:()=>E});var x=r(5e3);let E=(()=>{class _{transform(d,t){return"valid"!==d.toLowerCase()||t&&"valid"!==d.toLowerCase()?d:"ACTIVE"}}return _.\u0275fac=function(d){return new(d||_)},_.\u0275pipe=x.Yjl({name:"transformMemberStatus",type:_,pure:!0}),_})()}}]);