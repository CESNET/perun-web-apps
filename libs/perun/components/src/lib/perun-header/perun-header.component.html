<mat-toolbar
  [ngStyle]="{'background': bgColor}"
  class="sticky-top header-container mat-elevation-z3">
  <div id="nav-menu-icons">
    @if (showToggle) {
      <button
        (click)="onToggleSidenav()"
        [ngStyle]="{'color': iconColor}"
        aria-label="Menu"
        matTooltip="{{'NAV.MENU' | translate}}"
        mat-icon-button>
        <mat-icon>menu</mat-icon>
      </button>
    }

    <a
      [innerHTML]="logo"
      [routerLink]="disableLogo ? [] : ['/']"
      [queryParams]="route.snapshot.queryParams"
      class="logo-container mt-auto mb-auto"
      queryParamsHandling="merge"></a>

    <p [ngStyle]="{'color': textColor}" class="mt-auto mb-auto hide-label page-subtitle">
      {{label}}
    </p>
  </div>

  <div
    [ngStyle]="{'color': navTextColor, 'width': searchEnabled ? '60%' : 'none'}"
    id="nav-menu-user-info">
    @if (searchEnabled) {
      <perun-web-apps-global-search
        class="ms-4 global-search"
        [adminSearch]="searchAsAdmin"></perun-web-apps-global-search>
    }
    @if (showLanguageMenu) {
      <div id="nav-menu-language" [ngStyle]="{'color': textColor}">
        <button mat-button [matMenuTriggerFor]="menu">
          <mat-icon [ngStyle]="{'color': iconColor}"> language </mat-icon>
        </button>
        <mat-menu #menu="matMenu">
          <button mat-menu-item (click)="changeLanguage()">
            {{'HEADER.LANGUAGE' | translate}}
          </button>
        </mat-menu>
      </div>
    }

    @if (showUserName && principal?.user !== null) {
      <span [ngStyle]="{'color': textColor}" class="d-none d-lg-inline displayed-name me-1">
        {{principal.user | userFullName}}
      </span>
    }

    @if (showNotifications) {
      <button
        [matTooltip]="'NAV.NOTIFICATIONS_TOOLTIP'|translate"
        (click)="showNotificationHistory()"
        mat-icon-button>
        <mat-icon
          [ngStyle]="{'color': iconColor}"
          matBadge="{{getNewNotificationsCount() > 5 ? '5+' : getNewNotificationsCount()}}"
          [matBadgeHidden]="getNewNotificationsCount() === 0"
          matBadgeColor="warn">
          {{getNewNotificationsCount() ? 'notifications_active' : 'notifications'}}
        </mat-icon>
      </button>
    }

    @if (guiConfigPanelEnabled) {
      <button
        mat-icon-button
        [matMenuTriggerFor]="tableMenu"
        [matTooltip]="'NAV.GUI_CONFIG.TITLE' | translate">
        <mat-icon [ngStyle]="{'color': iconColor}"> settings </mat-icon>
      </button>
      <mat-menu #tableMenu="matMenu">
        <perun-web-apps-gui-configuration> </perun-web-apps-gui-configuration>
      </mat-menu>
    }
    <div class="d-flex flex-nowrap align-items-center">
      @if ((otherAppUrls | keyvalue)?.length && showOtherApps) {
        <button
          mat-icon-button
          [matMenuTriggerFor]="appsMenu"
          [matTooltip]="'NAV.OTHER_APPLICATIONS' | translate">
          <mat-icon [ngStyle]="{'color': iconColor}"> apps </mat-icon>
        </button>
      }
      <mat-menu #appsMenu="matMenu">
        @for (appLabel of this.otherAppLabels | keyvalue; track appLabel) {
          <button
            mat-menu-item
            (click)="redirectToUrl(this.otherAppUrls[appLabel.key])"
            (auxclick)="redirectToUrl(this.otherAppUrls[appLabel.key])">
            <span>{{appLabel.value}}</span>
          </button>
        }
        @for (appLabel of this.otherAppLabelsCustom | keyvalue; track appLabel) {
          <button
            mat-menu-item
            (click)="redirectToUrl(appLabel.key)"
            (auxclick)="redirectToUrl(appLabel.key)">
            <span>{{appLabel.value}}</span>
          </button>
        }
      </mat-menu>
      @if (logoutEnabled) {
        <button mat-icon-button (click)="onLogOut()" [matTooltip]="'NAV.LOGOUT'|translate">
          <mat-icon>logout</mat-icon>
        </button>
      }
    </div>
  </div>
</mat-toolbar>
