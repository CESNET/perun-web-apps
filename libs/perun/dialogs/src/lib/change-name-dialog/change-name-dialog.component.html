<h1 mat-dialog-title>{{'DIALOGS.CHANGE_NAME.TITLE'|customTranslate | translate}}</h1>
<div mat-dialog-content class="dialog-container user-theme d-flex flex-column">
  @if (loading) {
    <mat-spinner class="me-auto ms-auto" [diameter]="50"></mat-spinner>
  }
  @if (!loading) {
    <div>
      <mat-radio-group [(ngModel)]="selectedName">
        @if (data.enableLinkedName) {
          <div class="d-flex flex-column">
            @for (uesName of uesNames; track uesName) {
              <mat-radio-button class="me-3" color="primary" value="{{uesName}}">
                {{uesName}}
              </mat-radio-button>
            }
          </div>
        }
        @if (data.enableLinkedName && uesNames.length === 0) {
          <perun-web-apps-alert alert_type="info">
            {{'DIALOGS.CHANGE_NAME.NO_LINKED_ACCOUNTS' | translate}}
          </perun-web-apps-alert>
        }
        @if (data.enableCustomName && (data.enableLinkedName && uesNames.length > 0)) {
          <mat-radio-button color="primary" class="d-flex flex-wraps" value="{{CUSTOM_OPTION}}">
            <mat-form-field class="me-2">
              <mat-label>{{'DIALOGS.CHANGE_NAME.TITLE_BEFORE' | translate}}</mat-label>
              <input matInput [formControl]="titleBefore" />
              @if (titleBefore.invalid) {
                <mat-error>{{'DIALOGS.CHANGE_NAME.ERROR_LENGTH' | translate}}</mat-error>
              }
            </mat-form-field>
            <mat-form-field class="me-2">
              <mat-label>{{'DIALOGS.CHANGE_NAME.FIRST_NAME' | translate}}</mat-label>
              <input matInput [formControl]="firstName" data-cy="user-first-name-input" required />
              @if (firstName.invalid) {
                <mat-error>{{'DIALOGS.CHANGE_NAME.ERROR_FIRST_NAME' | translate}}</mat-error>
              }
            </mat-form-field>
            <mat-form-field class="me-2">
              <mat-label>{{'DIALOGS.CHANGE_NAME.MIDDLE_NAME' | translate}}</mat-label>
              <input matInput [formControl]="middleName" />
              @if (middleName.invalid) {
                <mat-error>{{'DIALOGS.CHANGE_NAME.CHANGE_NAME' | translate}}</mat-error>
              }
            </mat-form-field>
            <mat-form-field class="me-2">
              <mat-label>{{'DIALOGS.CHANGE_NAME.LAST_NAME' | translate}}</mat-label>
              <input matInput [formControl]="lastName" required />
              @if (lastName.invalid) {
                <mat-error>{{'DIALOGS.CHANGE_NAME.ERROR_LAST_NAME' | translate}}</mat-error>
              }
            </mat-form-field>
            <mat-form-field>
              <mat-label>{{'DIALOGS.CHANGE_NAME.TITLE_AFTER' | translate}}</mat-label>
              <input matInput [formControl]="titleAfter" />
              @if (titleAfter.invalid) {
                <mat-error>{{'DIALOGS.CHANGE_NAME.ERROR_LENGTH' | translate}}</mat-error>
              }
            </mat-form-field>
          </mat-radio-button>
        }
      </mat-radio-group>
      @if (
        data.enableCustomName && (!data.enableLinkedName || (data.enableLinkedName && uesNames.length === 0))
      ) {
        <div class="d-flex flex-column">
          <mat-form-field class="me-2">
            <mat-label>{{'DIALOGS.CHANGE_NAME.TITLE_BEFORE' | translate}}</mat-label>
            <input matInput [formControl]="titleBefore" />
            @if (titleBefore.invalid) {
              <mat-error>{{'DIALOGS.CHANGE_NAME.ERROR_LENGTH' | translate}}</mat-error>
            }
          </mat-form-field>
          <mat-form-field class="me-2">
            <mat-label>{{'DIALOGS.CHANGE_NAME.FIRST_NAME' | translate}}</mat-label>
            <input matInput [formControl]="firstName" data-cy="user-first-name-input" required />
            @if (firstName.invalid) {
              <mat-error>{{'DIALOGS.CHANGE_NAME.ERROR_FIRST_NAME' | translate}}</mat-error>
            }
          </mat-form-field>
          <mat-form-field class="me-2">
            <mat-label>{{'DIALOGS.CHANGE_NAME.MIDDLE_NAME' | translate}}</mat-label>
            <input matInput [formControl]="middleName" />
            @if (middleName.invalid) {
              <mat-error>{{'DIALOGS.CHANGE_NAME.CHANGE_NAME' | translate}}</mat-error>
            }
          </mat-form-field>
          <mat-form-field class="me-2">
            <mat-label>{{'DIALOGS.CHANGE_NAME.LAST_NAME' | translate}}</mat-label>
            <input matInput [formControl]="lastName" required />
            @if (lastName.invalid) {
              <mat-error>{{'DIALOGS.CHANGE_NAME.ERROR_LAST_NAME' | translate}}</mat-error>
            }
          </mat-form-field>
          <mat-form-field>
            <mat-label>{{'DIALOGS.CHANGE_NAME.TITLE_AFTER' | translate}}</mat-label>
            <input matInput [formControl]="titleAfter" />
            @if (titleAfter.invalid) {
              <mat-error>{{'DIALOGS.CHANGE_NAME.ERROR_LENGTH' | translate}}</mat-error>
            }
          </mat-form-field>
        </div>
      }
      @if (data.enableCustomName && data.customNameRequiresApprove) {
        <p class="pt-4 ps-3">
          {{'DIALOGS.CHANGE_NAME.NOTE' | translate}}
        </p>
      }
    </div>
  }
</div>
<div mat-dialog-actions>
  <button mat-stroked-button class="ms-auto" (click)="onCancel()">
    {{'DIALOGS.CHANGE_NAME.CANCEL'|customTranslate | translate}}
  </button>
  <button
    (click)="onSubmit()"
    [disabled]="loading || !selectedName || (selectedName === CUSTOM_OPTION && (firstName.errors || lastName.errors))"
    class="ms-2"
    color="accent"
    mat-flat-button>
    {{'DIALOGS.CHANGE_NAME.CHANGE'|customTranslate | translate}}
  </button>
</div>
