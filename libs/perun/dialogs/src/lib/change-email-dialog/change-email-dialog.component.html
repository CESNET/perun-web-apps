<h1 mat-dialog-title>{{'DIALOGS.CHANGE_EMAIL.TITLE'|customTranslate | translate}}</h1>
<div mat-dialog-content class="dialog-container user-theme">
  @if (loading) {
    <mat-spinner class="me-auto ms-auto" [diameter]="50"></mat-spinner>
  }
  @if (!loading) {
    <div>
      @if (pendingMails.length) {
        <perun-web-apps-alert alert_type="warn">{{pendingEmailsMessage}}</perun-web-apps-alert>
      }
      <mat-radio-group [(ngModel)]="selectedEmail">
        @if (data.enableLinkedEmail) {
          <div class="d-flex flex-column">
            @for (uesName of uesEmails; track uesName) {
              <mat-radio-button class="me-3" color="primary" value="{{uesName}}">
                {{uesName}}
              </mat-radio-button>
            }
          </div>
        }
        @if (data.enableLinkedEmail && uesEmails.length === 0) {
          <perun-web-apps-alert alert_type="info">
            {{'DIALOGS.CHANGE_EMAIL.NO_LINKED_ACCOUNTS' | translate}}
          </perun-web-apps-alert>
        }
        @if (data.enableCustomEmail) {
          <mat-radio-button color="primary" class="d-flex flex-wraps" value="{{CUSTOM_OPTION}}">
            <mat-form-field class="w-100">
              <mat-label
                >{{'DIALOGS.CHANGE_EMAIL.INPUT_PLACEHOLDER'|customTranslate | translate}}</mat-label
              >
              <input matInput required [formControl]="emailControl" />
              @if (emailControl.invalid) {
                <mat-error
                  >{{'DIALOGS.CHANGE_EMAIL.EMAIL_ERROR'|customTranslate | translate}}</mat-error
                >
              }
            </mat-form-field>
          </mat-radio-button>
        }
      </mat-radio-group>
      @if (data.enableCustomEmail && data.customEmailRequiresVerification) {
        <p class="pt-4 ps-3">
          {{'DIALOGS.CHANGE_EMAIL.NOTE' | translate}}
        </p>
      }
    </div>
  }
</div>
<div mat-dialog-actions>
  <button mat-stroked-button class="ms-auto" (click)="onCancel()">
    {{'DIALOGS.CHANGE_EMAIL.CANCEL'|customTranslate | translate}}
  </button>
  <button
    (click)="onSubmit()"
    [disabled]="loading || !selectedEmail || (selectedEmail === CUSTOM_OPTION && !emailControl.valid)"
    class="ms-2"
    color="accent"
    mat-flat-button>
    {{'DIALOGS.CHANGE_EMAIL.CHANGE'|customTranslate | translate}}
  </button>
</div>
