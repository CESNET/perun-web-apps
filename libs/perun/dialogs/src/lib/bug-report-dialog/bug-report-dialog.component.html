<ng-template #spinner>
  <perun-web-apps-loading-dialog></perun-web-apps-loading-dialog>
</ng-template>
<div class="position-relative">
  <div *perunWebAppsLoader="loading; indicator: spinner">
    @if (!bulkReport) {
      <h1 mat-dialog-title>
        {{'SHARED_LIB.PERUN.COMPONENTS.BUG_REPORT.TITLE' | translate}}
      </h1>
    }
    @if (bulkReport) {
      <h1 mat-dialog-title>
        {{'SHARED_LIB.PERUN.COMPONENTS.BUG_REPORT.BULK_TITLE' | translate}}
      </h1>
    }
    <div class="dialog-container" mat-dialog-content>
      <mat-form-field>
        <mat-label>{{'SHARED_LIB.PERUN.COMPONENTS.BUG_REPORT.SUBJECT' | translate}}</mat-label>
        <input #subjectModel="ngModel" [(ngModel)]="subject" matInput required />
        @if (subjectModel.invalid) {
          <mat-error
            >{{'SHARED_LIB.PERUN.COMPONENTS.BUG_REPORT.SUBJECT_ERROR' | translate}}</mat-error
          >
        }
      </mat-form-field>
      <mat-form-field>
        <mat-label>{{'SHARED_LIB.PERUN.COMPONENTS.BUG_REPORT.MESSAGE' | translate}}</mat-label>
        <textarea
          #messageModel="ngModel"
          [(ngModel)]="message"
          matInput
          placeholder="{{'SHARED_LIB.PERUN.COMPONENTS.BUG_REPORT.MESSAGE_PLACEHOLDER' | translate}}"
          required>
        </textarea>
        @if (messageModel.invalid) {
          <mat-error
            >{{'SHARED_LIB.PERUN.COMPONENTS.BUG_REPORT.MESSAGE_ERROR' | translate}}</mat-error
          >
        }
      </mat-form-field>
    </div>

    <div mat-dialog-actions>
      <div class="ms-auto">
        <button (click)="dialogRef.close()" mat-stroked-button>
          {{'SHARED_LIB.PERUN.COMPONENTS.BUG_REPORT.CANCEL' | translate}}
        </button>
        <button
          (click)="sendBugReport()"
          [disabled]="message === '' || subject === '' || loading"
          class="ms-2"
          color="accent"
          mat-flat-button>
          {{'SHARED_LIB.PERUN.COMPONENTS.BUG_REPORT.SEND' | translate}}
        </button>
      </div>
    </div>
  </div>
</div>
