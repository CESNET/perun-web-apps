<div class="mt-3">
  @if (loading) {
    <mat-spinner class="ms-auto me-auto"></mat-spinner>
  }
  @if (entityValues.length === 0 && !loading) {
    <perun-web-apps-alert alert_type="warn">{{noEntityMessage}}</perun-web-apps-alert>
  }

  @if (entityValues.length !== 0) {
    <div>
      @if (showSelect) {
        <div class="flex-row">
          @if (secondEntity === 'group') {
            <perun-web-apps-group-search-select
              (groupSelected)="specifySecondEntity($event)"
              [firstSelectedGroup]="specificSecondEntity"
              [displayStatus]="true"
              [groups]="entityValues">
            </perun-web-apps-group-search-select>
          }
          @if (secondEntity === 'resource') {
            <perun-web-apps-resource-search-select
              (resourceSelected)="specifySecondEntity($event)"
              [resources]="entityValues">
            </perun-web-apps-resource-search-select>
          }
          @if (secondEntity === 'member') {
            <perun-web-apps-member-search-select
              (memberSelected)="specifySecondEntity($event)"
              [members]="entityValues">
            </perun-web-apps-member-search-select>
          }
          @if (secondEntity === 'facility') {
            <perun-web-apps-facility-search-select
              (facilitySelected)="specifySecondEntity($event)"
              [facilities]="entityValues">
            </perun-web-apps-facility-search-select>
          }
          @if (secondEntity === 'user') {
            <perun-web-apps-user-search-select
              (userSelected)="specifySecondEntity($event)"
              [users]="entityValues">
            </perun-web-apps-user-search-select>
          }
        </div>
      }
      <perun-web-apps-refresh-button
        (refresh)="getAttributes(specificSecondEntity.id)"></perun-web-apps-refresh-button>
      <button
        (click)="onAdd(specificSecondEntity.id)"
        class="me-2 action-button"
        color="accent"
        mat-flat-button>
        {{'ATTRIBUTE_PAGE.CREATE' | translate}}
      </button>
      <button
        (click)="onSave(specificSecondEntity.id)"
        class="me-2"
        color="accent"
        [disabled]="loading || selection.selected.length === 0"
        mat-flat-button>
        {{'ATTRIBUTE_PAGE.SAVE' | translate}}
      </button>
      <button
        (click)="onDelete(specificSecondEntity.id)"
        color="warn"
        [disabled]="loading || selection.selected.length === 0"
        class="me-2"
        mat-flat-button>
        {{'ATTRIBUTE_PAGE.DELETE' | translate}}
      </button>
      <perun-web-apps-debounce-filter
        (filter)="applyFilter($event)"
        [placeholder]="'ATTRIBUTE_PAGE.FILTER'"
        class="me-2">
      </perun-web-apps-debounce-filter>
      <mat-slide-toggle [(ngModel)]="filterEmpty" labelPosition="before">
        {{'ATTRIBUTE_PAGE.FILTER_EMPTY' | translate}}
      </mat-slide-toggle>
      <ng-template #spinner>
        <perun-web-apps-loading-table></perun-web-apps-loading-table>
      </ng-template>
      <div class="position-relative table-min-height">
        <perun-web-apps-attributes-list
          #list
          *perunWebAppsLoader="innerLoading; indicator: spinner"
          [loading]="innerLoading"
          [attributes]="attributes"
          [filterValue]="filterValue"
          [filterEmpty]="filterEmpty"
          [selection]="selection"
          [cachedSubject]="cachedSubject">
        </perun-web-apps-attributes-list>
      </div>
    </div>
  }
</div>
