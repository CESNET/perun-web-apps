<div class="{{theme}}">
  <h1 mat-dialog-title>{{'DIALOGS.ADD_ROLE.TITLE' | translate}}</h1>
  <mat-spinner *ngIf="loading" class="me-auto ms-auto"></mat-spinner>
  <div *ngIf="!loading" mat-dialog-content class="dialog-container">
    <perun-web-apps-role-search-select
      [roles]="rules"
      (roleSelected)="selectedRule = $event; selectedEntity = null">
    </perun-web-apps-role-search-select>
    <perun-web-apps-vo-search-select
      *ngIf="selectedRule?.primaryObject === 'Vo'"
      [vos]="vos | manageableEntities: selectedRule | unassignedRole: roles : selectedRule"
      [disableAutoSelect]="true"
      (voSelected)="selectedEntity = $event">
    </perun-web-apps-vo-search-select>
    <perun-web-apps-group-search-select
      *ngIf="selectedRule?.primaryObject === 'Group'"
      [groups]="groups | manageableEntities: selectedRule | unassignedRole: roles : selectedRule"
      [disableAutoSelect]="true"
      (groupSelected)="selectedEntity = $event">
    </perun-web-apps-group-search-select>
    <perun-web-apps-facility-search-select
      *ngIf="selectedRule?.primaryObject === 'Facility'"
      [facilities]="facilities | manageableEntities: selectedRule| unassignedRole: roles : selectedRule"
      [disableAutoSelect]="true"
      (facilitySelected)="selectedEntity = $event">
    </perun-web-apps-facility-search-select>
    <perun-web-apps-resource-search-select
      *ngIf="selectedRule?.primaryObject === 'Resource'"
      [resources]="resources | manageableEntities: selectedRule | unassignedRole: roles : selectedRule"
      [disableAutoSelect]="true"
      (resourceSelected)="selectedEntity = $event">
    </perun-web-apps-resource-search-select>
  </div>
  <div *ngIf="!loading" mat-dialog-actions>
    <button (click)="cancel()" class="ms-auto" mat-flat-button>
      {{'DIALOGS.ADD_ROLE.CANCEL' | translate}}
    </button>
    <button
      (click)="addRole()"
      [disabled]="selectedRule === null || (selectedRule.primaryObject !== null && !selectedEntity)"
      class="ms-2"
      color="accent"
      mat-flat-button>
      {{'DIALOGS.ADD_ROLE.ADD' | translate}}
    </button>
  </div>
</div>
