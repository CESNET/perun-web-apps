<div class="{{theme}}">
  <h1 mat-dialog-title>{{'DIALOGS.ADD_GROUP_RESOURCES.TITLE'| translate}}</h1>
  <perun-web-apps-immediate-filter (filter)="applyFilter($event)" [placeholder]="'DIALOGS.ADD_GROUP_RESOURCES.FILTER' | translate"></perun-web-apps-immediate-filter>
  <mat-spinner class="ml-auto mr-auto" *ngIf="loading"></mat-spinner>
  <div *ngIf="!loading">
    <mat-horizontal-stepper [linear]="true">
      <mat-step>
        <ng-template matStepLabel>{{'DIALOGS.ADD_GROUP_RESOURCES.RESOURCES' | translate}}</ng-template>
        <perun-web-apps-debounce-filter
          placeholder="{{'DIALOGS.ADD_GROUP_RESOURCES.FILTER' | translate}}"
          (filter)="applyFilter($event)">
        </perun-web-apps-debounce-filter>
        <perun-web-apps-resources-list
          #list
          [resources]="resources"
          [disableRouting]="true"
          [selection]="selection"
          [groupToResource]="this.data.group"
          [displayedColumns]="['select', 'id', 'name', 'facility', 'tags', 'description']"
          [filterValue]="filterValue"
        ></perun-web-apps-resources-list>
        <div mat-dialog-actions>
          <button
            mat-flat-button
            (click)="onCancel()">
            {{'DIALOGS.ADD_GROUP_RESOURCES.CANCEL' | translate}}
          </button>
          <button
            [disabled]="selection.selected.length === 0 || (list !== undefined && !list.addAuth)"
            class="ml-auto"
            mat-flat-button
            type="button"
            color="accent"
            matStepperNext>
            {{'DIALOGS.ADD_GROUP_RESOURCES.NEXT' | translate}}
          </button>
        </div>
      </mat-step>
      <mat-step>
        <ng-template matStepLabel>{{'DIALOGS.ADD_GROUP_RESOURCES.OPTIONS' | translate}}</ng-template>

        <mat-slide-toggle
          (toggleChange)="changeSubgroupsMessage()"
          class="mt-3 slide-text"
          [(ngModel)]="autoAssignSubgroups"
          labelPosition="before">
          {{'DIALOGS.ADD_GROUP_RESOURCES.AUTO_SUBGROUPS' | translate}}
        </mat-slide-toggle>
        <div class="text-muted new-line mt-2">
          <i [innerHTML]="autoAssignHint"></i>
        </div>

        <mat-slide-toggle
          (toggleChange)="changeInactiveMessage()"
          class="mt-3 slide-text"
          [(ngModel)]="asInactive"
          labelPosition="before">
          {{'DIALOGS.ADD_GROUP_RESOURCES.AS_INACTIVE' | translate}}
        </mat-slide-toggle>
        <div class="text-muted new-line mt-2">
          {{asInactiveHint}}
        </div>

        <mat-slide-toggle
          (toggleChange)="changeAsyncMessage()"
          class="mt-3 slide-text"
          [(ngModel)]="async"
          labelPosition="before">
          {{'DIALOGS.ADD_GROUP_RESOURCES.ASYNC_OPT' | translate}}
        </mat-slide-toggle>
        <div class="text-muted new-line mt-2">
          {{asyncHint}}
        </div>

        <div mat-dialog-actions>
          <button
            mat-flat-button
            class="ml-auto"
            (click)="onCancel()">
            {{'DIALOGS.ADD_GROUP_RESOURCES.CANCEL' | translate}}
          </button>
          <button
            mat-flat-button
            class="ml-auto mr-2"
            matStepperPrevious>
            {{'DIALOGS.ADD_GROUP_RESOURCES.BACK' | translate}}
          </button>
          <span
            matTooltip="{{'DIALOGS.ADD_GROUP_RESOURCES.ADD_PERMISSION_TOOLTIP' | translate}}"
            [matTooltipDisabled]="list === undefined || list.addAuth">
            <button
              mat-flat-button
              class="ml-2"
              color="accent"
              [disabled]="selection.selected.length === 0 || loading"
              (click)="onSubmit()">
              {{'DIALOGS.ADD_GROUP_RESOURCES.ADD' | translate}}
            </button>
          </span>
        </div>
      </mat-step>
    </mat-horizontal-stepper>
  </div>
</div>
